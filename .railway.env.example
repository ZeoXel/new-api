# ========================================
# Railway 环境变量配置示例
# ========================================
# 复制此文件内容到 Railway Dashboard → Variables
# ========================================

# ========================================
# 数据库配置（三选一）
# ========================================

# 方案1: 使用 Railway PostgreSQL（推荐）
# Railway 会自动提供 DATABASE_URL，直接引用
SQL_DSN=${{DATABASE_URL}}

# 方案2: 使用外部 MySQL
# SQL_DSN=user:password@tcp(your-mysql.com:3306)/dbname?parseTime=true

# 方案3: 使用 SQLite + Volume（不推荐生产环境）
# 需要先创建 Volume 挂载到 /data
# SQLITE_PATH=/data/one-api.db


# ========================================
# 必需配置
# ========================================

# 会话密钥（必须修改为随机字符串，至少32位）
# 生成方法: openssl rand -base64 32
SESSION_SECRET=change_this_to_random_string_min_32_chars_please

# 端口（Railway 会自动分配，保持默认即可）
PORT=3000


# ========================================
# 推荐配置
# ========================================

# 前端访问 URL（替换为您的 Railway 域名）
FRONTEND_BASE_URL=https://your-app.railway.app

# 启用调试（开发环境 true，生产环境 false）
DEBUG=false

# 内存缓存（提升性能）
MEMORY_CACHE_ENABLED=true


# ========================================
# 数据库连接池配置
# ========================================

# 最大空闲连接数
SQL_MAX_IDLE_CONNS=50

# 最大打开连接数
SQL_MAX_OPEN_CONNS=500

# 连接最大生命周期（秒）
SQL_MAX_LIFETIME=60


# ========================================
# 超时配置
# ========================================

# 所有请求超时时间（秒，0表示不限制）
RELAY_TIMEOUT=300

# 流式响应超时时间（秒）
STREAMING_TIMEOUT=300


# ========================================
# 同步和更新配置
# ========================================

# 同步频率（秒）
SYNC_FREQUENCY=60

# 渠道更新频率（秒）
CHANNEL_UPDATE_FREQUENCY=30

# 批量更新启用
BATCH_UPDATE_ENABLED=true

# 批量更新间隔（秒）
BATCH_UPDATE_INTERVAL=5


# ========================================
# 可选配置
# ========================================

# 生成默认 Token
GENERATE_DEFAULT_TOKEN=false

# 日志配置启用
LOG_CONSUME_ENABLED=true

# 统计图片 Token
GET_MEDIA_TOKEN=true

# 非流式情况下统计图片 Token
GET_MEDIA_TOKEN_NOT_STREAM=true


# ========================================
# Redis 配置（可选，用于缓存）
# ========================================

# 如果需要 Redis 缓存，取消注释并配置
# REDIS_CONN_STRING=redis://user:password@redis-host:6379/0


# ========================================
# 节点类型（可选，分布式部署）
# ========================================

# 主节点: master（默认）
# 从节点: slave
NODE_TYPE=master


# ========================================
# 注意事项
# ========================================
# 1. SESSION_SECRET 必须修改为随机字符串
# 2. 使用 Railway PostgreSQL 时，SQL_DSN 使用 ${{DATABASE_URL}}
# 3. 生产环境建议 DEBUG=false
# 4. FRONTEND_BASE_URL 需要替换为实际域名
