(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["vchart-theme"] = {}));
})(this, (function (exports) { 'use strict';

    const getTokenValue = (token, defaultValue, chartContainer) => {
        const value = token
            ? getComputedStyle(chartContainer !== null && chartContainer !== void 0 ? chartContainer : document.body).getPropertyValue(token) || defaultValue
            : defaultValue;
        if (value && !isNaN(value[0])) {
            return `rgba(${value})`;
        }
        return value;
    };

    const observeAttribute = (element, attribute, callback) => {
        const observer = new MutationObserver(mutations => {
            mutations.forEach(mutation => {
                if (mutation.attributeName === attribute) {
                    callback(mutation);
                }
            });
        });
        observer.observe(element, { attributes: true });
    };

    const generateDataScheme = (mode, tokenMap, baseDataScheme, chartContainer) => {
        return tokenMap.map((item, i) => {
            const { scheme } = baseDataScheme[i];
            return Object.assign(Object.assign({}, item), { scheme: item.scheme.map((token, j) => {
                    return getTokenValue(typeof token === 'object' ? token[mode] : token, scheme === null || scheme === void 0 ? void 0 : scheme[j], chartContainer);
                }) });
        });
    };
    const generatePalette = (mode, tokenMap, basePalette, chartContainer) => {
        const newPalette = {};
        Object.keys(tokenMap).forEach(key => {
            const token = typeof tokenMap[key] === 'object' ? tokenMap[key][mode] : tokenMap[key];
            newPalette[key] = getTokenValue(token, basePalette[key], chartContainer);
        });
        return newPalette;
    };

    exports.generateDataScheme = generateDataScheme;
    exports.generatePalette = generatePalette;
    exports.getTokenValue = getTokenValue;
    exports.observeAttribute = observeAttribute;

}));
