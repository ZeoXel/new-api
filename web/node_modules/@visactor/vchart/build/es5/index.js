!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@babel/runtime/helpers/toConsumableArray")):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/toConsumableArray"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VChart={},t._toConsumableArray$1)}(this,(function(t,e){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */}var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){return o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},o.apply(this,arguments)};function a(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}function s(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function l(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function h(t,e,i){if(i||2===arguments.length)for(var n,r=0,o=e.length;r<o;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}var d,f,p=function(t){return t};function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function g(t,e){if(t){if("string"==typeof t)return y(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(t,e):void 0}}function m(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}t.RenderModeEnum=void 0,(d=t.RenderModeEnum||(t.RenderModeEnum={}))["desktop-browser"]="desktop-browser",d["mobile-browser"]="mobile-browser",d.node="node",d.worker="worker",d.miniApp="miniApp",d.wx="wx",d["desktop-miniApp"]="desktop-miniApp",d.lynx="lynx",function(t){t.cartesianAxis="cartesianAxis",t.cartesianBandAxis="cartesianAxis-band",t.cartesianLinearAxis="cartesianAxis-linear",t.cartesianTimeAxis="cartesianAxis-time",t.cartesianLogAxis="cartesianAxis-log",t.cartesianSymlogAxis="cartesianAxis-symlog",t.polarAxis="polarAxis",t.polarBandAxis="polarAxis-band",t.polarLinearAxis="polarAxis-linear",t.crosshair="crosshair",t.cartesianCrosshair="cartesianCrosshair",t.polarCrosshair="polarCrosshair",t.dataZoom="dataZoom",t.geoCoordinate="geoCoordinate",t.indicator="indicator",t.discreteLegend="discreteLegend",t.continuousLegend="continuousLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend",t.mapLabel="mapLabel",t.markLine="markLine",t.markArea="markArea",t.markPoint="markPoint",t.tooltip="tooltip",t.title="title",t.player="player",t.scrollBar="scrollBar",t.label="label",t.totalLabel="totalLabel",t.brush="brush",t.poptip="poptip",t.customMark="customMark"}(f||(f={}));var b={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function o(t,e,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new r(n,o||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),s.prototype.eventNames=function(){var t,n,r=[];if(0===this._eventsCount)return r;for(n in t=this._events)e.call(t,n)&&r.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},s.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,o),!0;case 6:return c.fn.call(c.context,e,n,r,o,a),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(t,e,i){return o(this,t,e,i,!1)},s.prototype.once=function(t,e,i){return o(this,t,e,i,!0)},s.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||r&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=i,s.EventEmitter=s,t.exports=s}(b);var x=_(b.exports),k=function(t,e){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")},S=function(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"boolean"==typeof t:!0===t||!1===t||k(t,"Boolean")},A=function(t){return"function"==typeof t},w=function(t){return null==t},T=function(t){return null!=t},M=function(t){var e=i(t);return null!==t&&"object"===e||"function"===e},C=function(t){return"object"==i(t)&&null!==t},E=function(t){if(!C(t)||!k(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},R=function(t){return void 0===t},P=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i(t);return e?"string"===n:"string"===n||k(t,"String")},B=function(t){return Array.isArray?Array.isArray(t):k(t,"Array")},L=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)},O=function(t){return k(t,"Date")},I=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i(t);return e?"number"===n:"number"===n||k(t,"Number")},D=function(t){return"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t))},F=function(t){return I(t)&&Number.isFinite(t)},z=function(t){return new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t)},j=function(t){return new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t)},H=function(t){return{}.toString.call(t).replace(/^\[object /,"").replace(/]$/,"")},N=Object.prototype,V=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||N)},G=Object.prototype.hasOwnProperty;function W(t){if(w(t))return!0;if(L(t))return!t.length;var e=H(t);if("Map"===e||"Set"===e)return!t.size;if(V(t))return!Object.keys(t).length;for(var i in t)if(G.call(t,i))return!1;return!0}var U=function(t,e,i){for(var n=P(e)?e.split("."):e,r=0;r<n.length;r++)t=t?t[n[r]]:void 0;return void 0===t?i:t},Y=Object.prototype.hasOwnProperty,K=function(t,e){return null!=t&&Y.call(t,e)};function X(t){var e;if(!T(t)||"object"!=i(t))return t;var n=B(t),r=t.length;e=n?new Array(r):"object"==i(t)?{}:S(t)||I(t)||P(t)?t:O(t)?new Date(+t):void 0;var o=n?void 0:Object.keys(Object(t)),a=-1;if(e)for(;++a<(o||t).length;){var s=o?o[a]:a,l=t[s];e[s]=X(l)}return e}function Z(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){if(t===e)return;if(T(e)&&"object"==i(e)){var r=Object(e),o=[];for(var a in r)o.push(a);for(var s=o.length,l=-1;s--;){var u=o[++l];T(r[u])&&"object"==i(r[u])?q(t,e,u,n):J(t,u,r[u])}}}}function q(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t[n],a=e[n],s=e[n],l=!0;if(B(a)){if(r)s=[];else if(B(o))s=o;else if(L(o)){s=new Array(o.length);for(var u=-1,c=o.length;++u<c;)s[u]=o[u]}}else E(a)?(s=o,"function"!=typeof o&&"object"==i(o)||(s={})):l=!1;l&&Z(s,a,r),J(t,n,s)}function J(t,e,i){(void 0!==i&&!function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i)||void 0===i&&!(e in t))&&(t[e]=i)}function Q(t){for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)Z(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1],!0);return t}function $(t,e){if(!t||!E(t))return t;var i={};return Object.keys(t).forEach((function(n){var r=t[n],o=!1;e.forEach((function(t){(P(t)&&t===n||t instanceof RegExp&&n.match(t))&&(o=!0)})),o||(i[n]=r)})),i}function et(t){return Object.prototype.toString.call(t)}function it(t){return Object.keys(t)}function nt(t,e,n){if(t===e)return!0;if(i(t)!=i(e))return!1;if(null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(et(t)!==et(e))return!1;if(A(t))return!!(null==n?void 0:n.skipFunction);if("object"!=i(t))return!1;if(B(t)){if(t.length!==e.length)return!1;for(var r=t.length-1;r>=0;r--)if(!nt(t[r],e[r],n))return!1;return!0}if(!E(t))return!1;var o=it(t),a=it(e);if(o.length!==a.length)return!1;o.sort(),a.sort();for(var s=o.length-1;s>=0;s--)if(o[s]!=a[s])return!1;for(var l=o.length-1;l>=0;l--){var u=o[l];if(!nt(t[u],e[u],n))return!1}return!0}function rt(t,e,i){for(var n=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}(e),r=0;r<n.length;r++){var o=n[r];(i?null!=e[o]:null==t[o])&&(t[o]=e[o])}return t}function ot(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var o=n[r];"constructor"!==o&&(i?null!=e[o]:null==t[o])&&(t[o]=e[o])}else rt(t,e,i)}function at(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return st(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return st(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function lt(t){return T(t)?B(t)?t:[t]:[]}function ut(t){if(L(t))return t[t.length-1]}var ct=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var o=t[r];(null!==(i=null==e?void 0:e(o,n))&&void 0!==i?i:o-n>0)&&(n=o)}return n}},ht=function(t,e){var i;if(0!==t.length){for(var n=t[0],r=1;r<t.length;r++){var o=t[r];(null!==(i=null==e?void 0:e(o,n))&&void 0!==i?i:o-n<0)&&(n=o)}return n}};function dt(t,e){if(!B(t)||!B(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function ft(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random,r=t.length;r;)e=Math.floor(n()*r),i=t[--r],t[r]=t[e],t[e]=i;return t}function pt(t){if(!B(t))return[t];var e,i=[],n=at(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;i.push.apply(i,m(pt(r)))}}catch(t){n.e(t)}finally{n.f()}return i}function vt(t,e,i){T(e)||(e=t,t=0),T(i)||(i=1);for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),o=new Array(r);++n<r;)o[n]=t+n*i;return o}function yt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function gt(t){return Number(t)}function mt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;for(w(n)&&(n=t.length);i<n;){var r=i+n>>>1;yt(t[r],e)>0?n=r:i=r+1}return i}var _t=function(t,e){var i=t;return!0!==e&&(i=t.sort(yt)),function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gt,n=t.length;if(n){if(e<=0||n<2)return i(t[0],0,t);if(e>=1)return i(t[n-1],n-1,t);var r=(n-1)*e,o=Math.floor(r),a=i(t[o],o,t);return a+(i(t[o+1],o+1,t)-a)*(r-o)}}(i,.5)},bt=1e-10,xt=1e-10;function kt(t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bt,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:xt)*Math.max(t,e);return Math.abs(t-e)<=Math.max(i,n)}function St(t,e,i,n){return t>e&&!kt(t,e,i,n)}function At(t,e,i,n){return t<e&&!kt(t,e,i,n)}var wt=function(t){var e=null,i=null;return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e&&r.every((function(t,i){return t===e[i]}))||(e=r,i=t.apply(void 0,r)),i}},Tt=function(t,e,i){return t<e?e:t>i?i:t};function Mt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,o=[],a=!0,s=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ct=function(t,e,i){var n=Mt(t,2),r=n[0],o=n[1];o<r&&(r=t[1],o=t[0]);var a=o-r;return a>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-a),r+a]};function Et(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}var Rt=!1;try{Rt="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){Rt=!1}function Pt(t,e,i){var n,r,o,a,s,l,u=0,c=!1,h=!1,d=!0,f=!e&&0!==e&&Rt;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var i=n,o=r;return n=r=void 0,u=e,a=t.apply(o,i)}function v(t,e){return f?(cancelAnimationFrame(s),requestAnimationFrame(t)):setTimeout(t,e)}function y(t){var i=t-l;return void 0===l||i>=e||i<0||h&&t-u>=o}function g(){var t=Date.now();if(y(t))return m(t);s=v(g,function(t){var i=t-u,n=e-(t-l);return h?Math.min(n,o-i):n}(t))}function m(t){return s=void 0,d&&n?p(t):(n=r=void 0,a)}function _(){for(var t=Date.now(),i=y(t),o=arguments.length,d=new Array(o),f=0;f<o;f++)d[f]=arguments[f];if(n=d,r=this,l=t,i){if(void 0===s)return function(t){return u=t,s=v(g,e),c?p(t):a}(l);if(h)return s=v(g,e),p(l)}return void 0===s&&(s=v(g,e)),a}return e=+e||0,M(i)&&(c=!!i.leading,(h="maxWait"in i)&&(o=Math.max(F(i.maxWait)?i.maxWait:0,e)),d="trailing"in i?!!i.trailing:d),_.cancel=function(){void 0!==s&&function(t){if(f)return cancelAnimationFrame(t);clearTimeout(t)}(s),u=0,n=l=r=s=void 0},_.flush=function(){return void 0===s?a:m(Date.now())},_.pending=function(){return void 0!==s},_}function Bt(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return M(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),Pt(t,e,{leading:n,trailing:r,maxWait:e})}function Lt(t,e){return function(i){return t*(1-i)+e*i}}function Ot(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}Rt=!1;var It=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dt=new RegExp(It.source,"g");function Ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zt(t,e,i){return e&&Ft(t.prototype,e),i&&Ft(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function jt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ht=1e-12,Nt=Math.PI,Vt=Nt/2,Gt=2*Nt,Wt=2*Math.PI,Ut=Math.abs,Yt=Math.atan2,Kt=Math.cos,Xt=Math.max,Zt=Math.min,qt=Math.sin,Jt=Math.sqrt,Qt=Math.pow;function $t(t){return t>1?0:t<-1?Nt:Math.acos(t)}function te(t){return t>=1?Vt:t<=-1?-Vt:Math.asin(t)}function ee(t,e,i,n,r){var o,a;return"number"==typeof t&&"number"==typeof i&&(o=(1-r)*t+r*i),"number"==typeof e&&"number"==typeof n&&(a=(1-r)*e+r*n),{x:o,y:a}}function ie(t,e){return t[0]*e[1]-t[1]*e[0]}function ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Math.round(t*e)/e}function re(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function oe(t,e){return ne(t+e,Math.pow(10,Math.max(re(t),re(e))))}var ae=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;jt(this,t),this.x=0,this.y=0,this.x=e,this.y=i,this.x1=n,this.y1=r}return zt(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"add",value:function(t){return I(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}},{key:"sub",value:function(t){return I(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}},{key:"multi",value:function(t){throw new Error("暂不支持")}},{key:"div",value:function(t){throw new Error("暂不支持")}}]),t}(),se=function(){function t(){jt(this,t)}return zt(t,null,[{key:"distancePP",value:function(t,e){return Jt(Qt(t.x-e.x,2)+Qt(t.y-e.y,2))}},{key:"distanceNN",value:function(t,e,i,n){return Jt(Qt(t-i,2)+Qt(e-n,2))}},{key:"distancePN",value:function(t,e,i){return Jt(Qt(e-t.x,2)+Qt(i-t.y,2))}},{key:"pointAtPP",value:function(t,e,i){return new ae((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}]),t}();function le(t,e){return le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},le(t,e)}function ue(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&le(t,e)}function ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function he(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ce(t)}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function pe(t,e,i){var n=e.x1,r=e.y1,o=e.x2,a=e.y2;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f),e):(t.clear(),t.add(i.a*n+i.c*r+i.e,i.b*n+i.d*r+i.f),t.add(i.a*o+i.c*r+i.e,i.b*o+i.d*r+i.f),t.add(i.a*o+i.c*a+i.e,i.b*o+i.d*a+i.f),t.add(i.a*n+i.c*a+i.e,i.b*n+i.d*a+i.f),e)}var ve=function(){function t(e){jt(this,t),e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}return zt(t,[{key:"clone",value:function(){return new t(this)}},{key:"clear",value:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}},{key:"empty",value:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}},{key:"equals",value:function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.x1=t,this.y1=e,this.x2=i,this.y2=n,this}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),n<e?(this.y2=e,this.y1=n):(this.y1=e,this.y2=n),this}},{key:"add",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return B(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}},{key:"round",value:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.rotatedPoints(t,e,i);return this.clear().add(n[0],n[1]).add(n[2],n[3]).add(n[4],n[5]).add(n[6],n[7])}},{key:"scale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.scalePoints(t,e,i,n);return this.clear().add(r[0],r[1]).add(r[2],r[3])}},{key:"union",value:function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}},{key:"intersect",value:function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}},{key:"encloses",value:function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}},{key:"alignsWith",value:function(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}},{key:"intersects",value:function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}},{key:"contains",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}},{key:"containsPoint",value:function(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}},{key:"width",value:function(){return this.empty()?0:this.x2-this.x1}},{key:"height",value:function(){return this.empty()?0:this.y2-this.y1}},{key:"scaleX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x1*=t,this.x2*=t,this}},{key:"scaleY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y1*=t,this.y2*=t,this}},{key:"transformWithMatrix",value:function(t){return pe(this,this,t),this}},{key:"copy",value:function(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}},{key:"rotatedPoints",value:function(t,e,i){var n=this.x1,r=this.y1,o=this.x2,a=this.y2,s=Math.cos(t),l=Math.sin(t),u=e-e*s+i*l,c=i-e*l-i*s;return[s*n-l*r+u,l*n+s*r+c,s*n-l*a+u,l*n+s*a+c,s*o-l*r+u,l*o+s*r+c,s*o-l*a+u,l*o+s*a+c]}},{key:"scalePoints",value:function(t,e,i,n){return[t*this.x1+(1-t)*i,e*this.y1+(1-e)*n,t*this.x2+(1-t)*i,e*this.y2+(1-e)*n]}}]),t}(),ye=function(t){ue(i,t);var e=fe(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i)}(ve);function ge(t){return t*(Math.PI/180)}function me(t){return 180*t/Math.PI}var _e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<-Gt;)t+=Gt;else if(t>0)for(;t>Gt;)t-=Gt;return t};function be(t,e,i){return{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}}function xe(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}var ke=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;jt(this,t),this.a=e,this.b=i,this.c=n,this.d=r,this.e=o,this.f=a}return zt(t,[{key:"equalToMatrix",value:function(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}},{key:"equalTo",value:function(t,e,i,n,r,o){return!(this.e!==r||this.f!==o||this.a!==t||this.d!==n||this.b!==e||this.c!==i)}},{key:"setValue",value:function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=o,this}},{key:"reset",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}},{key:"getInverse",value:function(){var e=this.a,i=this.b,n=this.c,r=this.d,o=this.e,a=this.f,s=new t,l=e*r-i*n;return s.a=r/l,s.b=-i/l,s.c=-n/l,s.d=e/l,s.e=(n*a-r*o)/l,s.f=-(e*a-i*o)/l,s}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.c*i,r=this.b*e+this.d*i,o=this.a*-i+this.c*e,a=this.b*-i+this.d*e;return this.a=n,this.b=r,this.c=o,this.d=a,this}},{key:"rotateByCenter",value:function(t,e,i){var n=Math.cos(t),r=Math.sin(t),o=(1-n)*e+r*i,a=(1-n)*i-r*e,s=n*this.a-r*this.b,l=r*this.a+n*this.b,u=n*this.c-r*this.d,c=r*this.c+n*this.d,h=n*this.e-r*this.f+o,d=r*this.e+n*this.f+a;return this.a=s,this.b=l,this.c=u,this.d=c,this.e=h,this.f=d,this}},{key:"scale",value:function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}},{key:"setScale",value:function(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}},{key:"transform",value:function(t,e,i,n,r,o){return this.multiply(t,e,i,n,r,o),this}},{key:"translate",value:function(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}},{key:"transpose",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.e,o=this.f;return this.a=e,this.b=t,this.c=n,this.d=i,this.e=o,this.f=r,this}},{key:"multiply",value:function(t,e,i,n,r,o){var a=this.a,s=this.b,l=this.c,u=this.d,c=a*t+l*e,h=s*t+u*e,d=a*i+l*n,f=s*i+u*n,p=a*r+l*o+this.e,v=s*r+u*o+this.f;return this.a=c,this.b=h,this.c=d,this.d=f,this.e=p,this.f=v,this}},{key:"interpolate",value:function(e,i){var n=new t;return n.a=this.a+(e.a-this.a)*i,n.b=this.b+(e.b-this.b)*i,n.c=this.c+(e.c-this.c)*i,n.d=this.d+(e.d-this.d)*i,n.e=this.e+(e.e-this.e)*i,n.f=this.f+(e.f-this.f)*i,n}},{key:"transformPoint",value:function(t,e){var i=this.a,n=this.b,r=this.c,o=this.d,a=this.e,s=this.f,l=i*o-n*r,u=o/l,c=-n/l,h=-r/l,d=i/l,f=(r*s-o*a)/l,p=-(i*s-n*a)/l,v=t.x,y=t.y;e.x=v*u+y*h+f,e.y=v*c+y*d+p}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.a===t&&0===this.b&&0===this.c&&this.d===t}},{key:"clone",value:function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"toTransformAttrs",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=t*n-e*i,o={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){var a=Math.sqrt(t*t+e*e);o.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),o.scaleX=a,o.scaleY=r/a,o.skewX=(t*i+e*n)/r,o.skewY=0}else if(0!==i||0!==n){var s=Math.sqrt(i*i+n*n);o.rotateDeg=Math.PI/2-(n>0?Math.acos(-i/s):-Math.acos(i/s)),o.scaleX=r/s,o.scaleY=s,o.skewX=0,o.skewY=(t*i+e*n)/r}return o.rotateDeg=me(o.rotateDeg),o}}]),t}();var Se=function(){function t(){jt(this,t),this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}return zt(t,[{key:"clearCache",value:function(t,e){var i=e.CLEAN_THRESHOLD,n=void 0===i?this.CLEAN_THRESHOLD:i,r=e.L_TIME,o=void 0===r?this.L_TIME:r,a=e.R_COUNT,s=void 0===a?this.R_COUNT:a;if(t.size<n)return 0;var l=0,u=function(e){l++,t.delete(e)},c=Date.now();return t.forEach((function(t,e){if(t.timestamp.length<s)return u(e);for(var i=0;c-t.timestamp[t.timestamp.length-1-i]<o&&!(++i>=s););if(i<s)return u(e);for(;c-t.timestamp[0]>o;)t.timestamp.shift()})),l}},{key:"addLimitedTimestamp",value:function(t,e,i){var n=i.R_TIMESTAMP_MAX_SIZE,r=void 0===n?this.R_TIMESTAMP_MAX_SIZE:n;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}},{key:"clearTimeStamp",value:function(t,e){var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();t.forEach((function(t){for(;r-t.timestamp[0]>n;)t.timestamp.shift()}))}},{key:"clearItemTimestamp",value:function(t,e){for(var i=e.L_TIME,n=void 0===i?this.L_TIME:i,r=Date.now();r-t.timestamp[0]>n;)t.timestamp.shift()}}]),t}();function Ae(t,e,i){e/=100,i/=100;var n=(1-Math.abs(2*i-1))*e,r=n*(1-Math.abs(t/60%2-1)),o=i-n/2,a=0,s=0,l=0;return 0<=t&&t<60?(a=n,s=r,l=0):60<=t&&t<120?(a=r,s=n,l=0):120<=t&&t<180?(a=0,s=n,l=r):180<=t&&t<240?(a=0,s=r,l=n):240<=t&&t<300?(a=r,s=0,l=n):300<=t&&t<360&&(a=n,s=0,l=r),{r:a=Math.round(255*(a+o)),g:s=Math.round(255*(s+o)),b:l=Math.round(255*(l+o))}}function we(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,e,i),r=Math.max(t,e,i),o=r-n,a=0,s=0;return a=0===o?0:r===t?(e-i)/o%6:r===e?(i-t)/o+2:(t-e)/o+4,(a=Math.round(60*a))<0&&(a+=360),s=(r+n)/2,{h:a,s:+(100*(0===o?0:o/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}var Te=/^#([0-9a-f]{3,8})$/,Me={transparent:4294967040},Ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ee(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Re(t){return I(t)?new Ke(t>>16,t>>8&255,255&t,1):B(t)?new Ke(t[0],t[1],t[2]):new Ke(255,255,255)}function Pe(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Be(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var Le,Oe,Ie,De,Fe,ze,je,He,Ne,Ve,Ge,We,Ue,Ye=function(){function t(e){jt(this,t);var i=t.parseColorString(e);i?this.color=i:(console.warn("Warn: 传入".concat(e,"无法解析为Color")),this.color=new Ke(255,255,255))}return zt(t,[{key:"toRGBA",value:function(){return this.color.formatRgb()}},{key:"toString",value:function(){return this.color.formatRgb()}},{key:"toHex",value:function(){return this.color.formatHex()}},{key:"toHsl",value:function(){return this.color.formatHsl()}},{key:"brighter",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}},{key:"add",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r+=Math.min(255,i+t.color.r),this.color.g+=Math.min(255,n+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}},{key:"sub",value:function(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}},{key:"multiply",value:function(t){var e=this.color,i=e.r,n=e.g,r=e.b;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}},{key:"getHSVBrightness",value:function(){return Math.max(this.color.r,this.color.g,this.color.b)/255}},{key:"getHSLBrightness",value:function(){return.5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}},{key:"setHsl",value:function(t,e,i){var n=this.color.opacity,r=we(this.color.r,this.color.g,this.color.b),o=Ae(w(t)?r.h:Tt(t,0,360),w(e)?r.s:e>=0&&e<=1?100*e:e,w(i)?r.l:i<=1&&i>=0?100*i:i);return this.color=new Ke(o.r,o.g,o.b,n),this}},{key:"setRGB",value:function(t,e,i){return!w(t)&&(this.color.r=t),!w(e)&&(this.color.g=e),!w(i)&&(this.color.b=i),this}},{key:"setHex",value:function(t){var e="".concat(t).trim().toLowerCase(),i=Te.exec(e),n=parseInt(i[1],16),r=i[1].length;return 3===r?new Ke((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):6===r?Re(n):8===r?new Ke(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):this}},{key:"setColorName",value:function(t){var e=Ce[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}},{key:"setScalar",value:function(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}},{key:"setOpacity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.color.opacity=t,this}},{key:"getLuminance",value:function(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}},{key:"getLuminance2",value:function(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}},{key:"getLuminance3",value:function(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}},{key:"clone",value:function(){return new t(this.color.toString())}},{key:"copyGammaToLinear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}},{key:"copyLinearToGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}},{key:"convertGammaToLinear",value:function(t){return this.copyGammaToLinear(this,t),this}},{key:"convertLinearToGamma",value:function(t){return this.copyLinearToGamma(this,t),this}},{key:"copySRGBToLinear",value:function(t){return this.color.r=Pe(t.color.r),this.color.g=Pe(t.color.g),this.color.b=Pe(t.color.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.color.r=Be(t.color.r),this.color.g=Be(t.color.g),this.color.b=Be(t.color.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}}],[{key:"Brighter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).brighter(i).toRGBA()}},{key:"SetOpacity",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===i?e:new t(e).setOpacity(i).toRGBA()}},{key:"getColorBrightness",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hsl",n=e instanceof t?e:new t(e);switch(i){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3()}}},{key:"parseColorString",value:function(t){if(T(Me[t]))return function(t){return I(t)?new Ke(t>>>24,t>>>16&255,t>>>8&255,255&t):B(t)?new Ke(t[0],t[1],t[2],t[3]):new Ke(255,255,255,1)}(Me[t]);if(T(Ce[t]))return Re(Ce[t]);var e="".concat(t).trim().toLowerCase(),i=Te.exec(e);if(i){var n=parseInt(i[1],16),r=i[1].length;return 3===r?new Ke((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):6===r?Re(n):8===r?new Ke(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):void 0}if(/^(rgb|RGB|rgba|RGBA)/.test(e)){var o=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Ke(parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10),parseFloat(o[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){var a=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),s=Ae(parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10));return new Ke(s.r,s.g,s.b,parseFloat(a[3]))}}}]),t}(),Ke=function(){function t(e,i,n,r){jt(this,t),this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),T(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}return zt(t,[{key:"formatHex",value:function(){return"#".concat(Ee(this.r)+Ee(this.g)+Ee(this.b)+(1===this.opacity?"":Ee(255*this.opacity)))}},{key:"formatRgb",value:function(){var t=this.opacity;return"".concat(1===t?"rgb(":"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b).concat(1===t?")":",".concat(t,")"))}},{key:"formatHsl",value:function(){var t=this.opacity,e=we(this.r,this.g,this.b),i=e.h,n=e.s,r=e.l;return"".concat(1===t?"hsl(":"hsla(").concat(i,",").concat(n,"%,").concat(r,"%").concat(1===t?")":",".concat(t,")"))}},{key:"toString",value:function(){return this.formatHex()}}]),t}();function Xe(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function Ze(t,e,i,n){var r,o=t[0],a=e[0],s=i[0],l=n[0];return a<o&&(r=a,a=o,o=r),l<s&&(r=l,l=s,s=r),!(a<s||l<o||(o=t[1],a=e[1],s=i[1],l=n[1],a<o&&(r=a,a=o,o=r),l<s&&(r=l,l=s,s=r),a<s||l<o))}function qe(t,e,i,n){if(!Ze(t,e,i,n))return!1;var r=[0,0],o=[0,0],a=[0,0];if(Xe(r,e,t),Xe(o,n,i),function(t,e){return Ut(t[0]-e[0])+Ut(t[1]-e[1])<1e-12}(r,o))return!0;Xe(a,i,t);var s=ie(a,o)/ie(r,o);return s>=0&&s<=1&&[t[0]+r[0]*s,t[1]+r[1]*s]}function Je(t,e,i){var n,r,o,a;return null===t?e:null===e?t:(Le=t.x1,Oe=t.x2,Ie=t.y1,De=t.y2,Fe=e.x1,ze=e.x2,je=e.y1,He=e.y2,i&&(Le>Oe&&(Le=(n=[Oe,Le])[0],Oe=n[1]),Ie>De&&(Ie=(r=[De,Ie])[0],De=r[1]),Fe>ze&&(Fe=(o=[ze,Fe])[0],ze=o[1]),je>He&&(je=(a=[He,je])[0],He=a[1])),Le>=ze||Oe<=Fe||Ie>=He||De<=je?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(Le,Fe),y1:Math.max(Ie,je),x2:Math.min(Oe,ze),y2:Math.min(De,He)})}function Qe(t,e,i){var n,r,o,a;return!(t&&e&&(i?(Le=t.x1,Oe=t.x2,Ie=t.y1,De=t.y2,Fe=e.x1,ze=e.x2,je=e.y1,He=e.y2,Le>Oe&&(n=[Oe,Le],Le=n[0],Oe=n[1]),Ie>De&&(r=[De,Ie],Ie=r[0],De=r[1]),Fe>ze&&(o=[ze,Fe],Fe=o[0],ze=o[1]),je>He&&(a=[He,je],je=a[0],He=a[1]),Le>ze||Oe<Fe||Ie>He||De<je):t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1))}function $e(t,e,i){var n,r;return!e||(i?(Le=e.x1,Oe=e.x2,Ie=e.y1,De=e.y2,Le>Oe&&(Le=(n=[Oe,Le])[0],Oe=n[1]),Ie>De&&(Ie=(r=[De,Ie])[0],De=r[1]),t.x>=Le&&t.x<=Oe&&t.y>=Ie&&t.y<=De):t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2)}function ti(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function ei(t,e){var i=t.x,n=t.y,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};return{x:(i-r.x)*Math.cos(e)+(n-r.y)*Math.sin(e)+r.x,y:(i-r.x)*Math.sin(e)+(r.y-n)*Math.cos(e)+r.y}}function ii(t){return t/180*Math.PI}function ni(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function ri(t,e){var i=e?t.angle:ii(t.angle),n=ni(t);return[ei({x:t.x1,y:t.y1},i,n),ei({x:t.x2,y:t.y1},i,n),ei({x:t.x2,y:t.y2},i,n),ei({x:t.x1,y:t.y2},i,n)]}function oi(t){return Ve=1/0,Ge=1/0,We=-1/0,Ue=-1/0,t.forEach((function(t){Ve>t.x&&(Ve=t.x),We<t.x&&(We=t.x),Ge>t.y&&(Ge=t.y),Ue<t.y&&(Ue=t.y)})),{x1:Ve,y1:Ge,x2:We,y2:Ue}}!function(t){t[t.NONE=0]="NONE",t[t.BBOX1=1]="BBOX1",t[t.BBOX2=2]="BBOX2"}(Ne||(Ne={}));var ai=1e-8;function si(t,e,i,n,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(Ze([t,e],[i,n],[s.x,s.y],[a.x,a.y]))return!0;a=s}return!1}function li(t,e,i){var n=0,r=t[0];if(!r)return!1;for(var o=1;o<t.length;o++){var a=t[o];n+=ui(r.x,r.y,a.x,a.y,e,i),r=a}var s=t[0];return ci(r.x,s.x)&&ci(r.y,s.y)||(n+=ui(r.x,r.y,s.x,s.y,e,i)),0!==n}function ui(t,e,i,n,r,o){if(o>e&&o>n||o<e&&o<n)return 0;if(n===e)return 0;var a=(o-e)/(n-e),s=n<e?1:-1;1!==a&&0!==a||(s=n<e?.5:-.5);var l=a*(i-t)+t;return l===r?1/0:l>r?s:0}function ci(t,e){return Math.abs(t-e)<ai}function hi(t,e){for(var i=0;i<e.length;i++){if(li(t,e[i].x,e[i].y))return!0;if(i>0&&si(e[i-1].x,e[i-1].y,e[i].x,e[i].y,t))return!0}return!1}var di=function(t){var e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,n=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(n=(e&=1023)<<10|(i&=1023),n+=65536),12288===n||65281<=n&&n<=65376||65504<=n&&n<=65510?"F":8361===n||65377<=n&&n<=65470||65474<=n&&n<=65479||65482<=n&&n<=65487||65490<=n&&n<=65495||65498<=n&&n<=65500||65512<=n&&n<=65518?"H":4352<=n&&n<=4447||4515<=n&&n<=4519||4602<=n&&n<=4607||9001<=n&&n<=9002||11904<=n&&n<=11929||11931<=n&&n<=12019||12032<=n&&n<=12245||12272<=n&&n<=12283||12289<=n&&n<=12350||12353<=n&&n<=12438||12441<=n&&n<=12543||12549<=n&&n<=12589||12593<=n&&n<=12686||12688<=n&&n<=12730||12736<=n&&n<=12771||12784<=n&&n<=12830||12832<=n&&n<=12871||12880<=n&&n<=13054||13056<=n&&n<=19903||19968<=n&&n<=42124||42128<=n&&n<=42182||43360<=n&&n<=43388||44032<=n&&n<=55203||55216<=n&&n<=55238||55243<=n&&n<=55291||63744<=n&&n<=64255||65040<=n&&n<=65049||65072<=n&&n<=65106||65108<=n&&n<=65126||65128<=n&&n<=65131||110592<=n&&n<=110593||127488<=n&&n<=127490||127504<=n&&n<=127546||127552<=n&&n<=127560||127568<=n&&n<=127569||131072<=n&&n<=194367||177984<=n&&n<=196605||196608<=n&&n<=262141?"W":32<=n&&n<=126||162<=n&&n<=163||165<=n&&n<=166||172===n||175===n||10214<=n&&n<=10221||10629<=n&&n<=10630?"Na":161===n||164===n||167<=n&&n<=168||170===n||173<=n&&n<=174||176<=n&&n<=180||182<=n&&n<=186||188<=n&&n<=191||198===n||208===n||215<=n&&n<=216||222<=n&&n<=225||230===n||232<=n&&n<=234||236<=n&&n<=237||240===n||242<=n&&n<=243||247<=n&&n<=250||252===n||254===n||257===n||273===n||275===n||283===n||294<=n&&n<=295||299===n||305<=n&&n<=307||312===n||319<=n&&n<=322||324===n||328<=n&&n<=331||333===n||338<=n&&n<=339||358<=n&&n<=359||363===n||462===n||464===n||466===n||468===n||470===n||472===n||474===n||476===n||593===n||609===n||708===n||711===n||713<=n&&n<=715||717===n||720===n||728<=n&&n<=731||733===n||735===n||768<=n&&n<=879||913<=n&&n<=929||931<=n&&n<=937||945<=n&&n<=961||963<=n&&n<=969||1025===n||1040<=n&&n<=1103||1105===n||8208===n||8211<=n&&n<=8214||8216<=n&&n<=8217||8220<=n&&n<=8221||8224<=n&&n<=8226||8228<=n&&n<=8231||8240===n||8242<=n&&n<=8243||8245===n||8251===n||8254===n||8308===n||8319===n||8321<=n&&n<=8324||8364===n||8451===n||8453===n||8457===n||8467===n||8470===n||8481<=n&&n<=8482||8486===n||8491===n||8531<=n&&n<=8532||8539<=n&&n<=8542||8544<=n&&n<=8555||8560<=n&&n<=8569||8585===n||8592<=n&&n<=8601||8632<=n&&n<=8633||8658===n||8660===n||8679===n||8704===n||8706<=n&&n<=8707||8711<=n&&n<=8712||8715===n||8719===n||8721===n||8725===n||8730===n||8733<=n&&n<=8736||8739===n||8741===n||8743<=n&&n<=8748||8750===n||8756<=n&&n<=8759||8764<=n&&n<=8765||8776===n||8780===n||8786===n||8800<=n&&n<=8801||8804<=n&&n<=8807||8810<=n&&n<=8811||8814<=n&&n<=8815||8834<=n&&n<=8835||8838<=n&&n<=8839||8853===n||8857===n||8869===n||8895===n||8978===n||9312<=n&&n<=9449||9451<=n&&n<=9547||9552<=n&&n<=9587||9600<=n&&n<=9615||9618<=n&&n<=9621||9632<=n&&n<=9633||9635<=n&&n<=9641||9650<=n&&n<=9651||9654<=n&&n<=9655||9660<=n&&n<=9661||9664<=n&&n<=9665||9670<=n&&n<=9672||9675===n||9678<=n&&n<=9681||9698<=n&&n<=9701||9711===n||9733<=n&&n<=9734||9737===n||9742<=n&&n<=9743||9748<=n&&n<=9749||9756===n||9758===n||9792===n||9794===n||9824<=n&&n<=9825||9827<=n&&n<=9829||9831<=n&&n<=9834||9836<=n&&n<=9837||9839===n||9886<=n&&n<=9887||9918<=n&&n<=9919||9924<=n&&n<=9933||9935<=n&&n<=9953||9955===n||9960<=n&&n<=9983||10045===n||10071===n||10102<=n&&n<=10111||11093<=n&&n<=11097||12872<=n&&n<=12879||57344<=n&&n<=63743||65024<=n&&n<=65039||65533===n||127232<=n&&n<=127242||127248<=n&&n<=127277||127280<=n&&n<=127337||127344<=n&&n<=127386||917760<=n&&n<=917999||983040<=n&&n<=1048573||1048576<=n&&n<=1114109?"A":"N"};var fi=function(){function t(e,i){jt(this,t),this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=e,this._userSpec=null!=i?i:{},this.textSpec=this._initSpec(),T(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=T(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}return zt(t,[{key:"initContext",value:function(){if(this._notSupportCanvas)return!1;if(w(this._canvas)&&(T(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),w(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&T(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),w(this._context)&&T(this._canvas)){var t=this._canvas.getContext("2d");T(t)&&(t.save(),t.font=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.fontStyle,n=void 0===i?e.fontStyle:i,r=t.fontVariant,o=void 0===r?e.fontVariant:r,a=t.fontWeight,s=void 0===a?e.fontWeight:a,l=t.fontSize,u=void 0===l?e.fontSize:l,c=t.fontFamily;return(n?n+" ":"")+(o?o+" ":"")+(s?s+" ":"")+u+"px "+((void 0===c?e.fontFamily:c)||"sans-serif")}(this.textSpec),this._contextSaved=!0,this._context=t)}return!w(this._context)||(this._notSupportCanvas=!0,!1)}},{key:"_initSpec",value:function(){var t,e,i,n=this._option.defaultFontParams,r=void 0===n?{}:n,o=this._userSpec,a=o.fontStyle,s=void 0===a?r.fontStyle:a,l=o.fontVariant,u=void 0===l?r.fontVariant:l,c=o.fontWeight,h=void 0===c?null!==(t=r.fontWeight)&&void 0!==t?t:"normal":c,d=o.fontSize,f=void 0===d?null!==(e=r.fontSize)&&void 0!==e?e:12:d,p=o.fontFamily,v=void 0===p?null!==(i=r.fontFamily)&&void 0!==i?i:"sans-serif":p,y=o.align,g=o.textAlign,m=void 0===g?null!=y?y:"center":g,_=o.baseline,b=o.textBaseline,x=void 0===b?null!=_?_:"middle":b,k=o.ellipsis,S=o.limit,A=this._userSpec.lineHeight,w=void 0===A?f:A;if(P(w)&&"%"===w[w.length-1]){var T=Number.parseFloat(w.substring(0,w.length-1))/100;w=f*T}return{fontStyle:s,fontVariant:u,fontFamily:v,fontSize:f,fontWeight:h,textAlign:m,textBaseline:x,ellipsis:k,limit:S,lineHeight:w}}},{key:"measure",value:function(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}},{key:"fullMeasure",value:function(t){if(w(t))return{width:0,height:0};if(w(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);var e,i=this.textSpec,n=i.fontFamily,r=i.fontSize,o=i.fontWeight,a=i.textAlign,s=i.textBaseline,l=i.ellipsis,u=i.limit,c=i.lineHeight;try{var h=this._option.getTextBounds({text:t,fontFamily:n,fontSize:r,fontWeight:o,textAlign:a,textBaseline:s,ellipsis:!!l,maxLineWidth:u||1/0,lineHeight:c});e={width:h.width(),height:h.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}},{key:"measureWithNaiveCanvas",value:function(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}},{key:"_measureWithNaiveCanvas",value:function(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);var i=this._context.measureText(t),n=this.textSpec,r=n.fontSize,o=n.lineHeight;return{width:i.width,height:null!==(e=o)&&void 0!==e?e:r}}},{key:"quickMeasure",value:function(t){return this._measureReduce(t,this._quickMeasure.bind(this))}},{key:"_quickMeasure",value:function(e){for(var i={width:0,height:0},n=0;n<e.length;n++){var r=e[n],o=this._measureSpecialChar(r);w(o)&&t.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),w(o)&&["F","W"].includes(di(r))&&(o=this._measureFullSizeChar()),w(o)&&(o=this._measureLetterChar()),i.width+=o.width,i.height=Math.max(i.height,o.height)}return i}},{key:"quickMeasureWithoutCanvas",value:function(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}},{key:"_quickMeasureWithoutCanvas",value:function(t){for(var e,i={width:0,height:0},n=this.textSpec,r=n.fontSize,o=n.lineHeight,a=0;a<t.length;a++){var s=t[a],l=["F","W"].includes(di(s))?1:.53;i.width+=l*r}return i.height=null!==(e=o)&&void 0!==e?e:r,i}},{key:"_measureReduce",value:function(t,e){var i,n=this.textSpec,r=n.fontSize,o=n.lineHeight,a={width:0,height:0};if(w(t))return a;if(B(t)){var s=t.filter(T).map((function(t){return t.toString()}));return 0===s.length?a:1===s.length?e(s[0]):{width:s.reduce((function(t,i){return Math.max(t,e(i).width)}),0),height:s.length*((null!==(i=o)&&void 0!==i?i:r)+1)+1}}return e(t.toString())}},{key:"_measureNumberChar",value:function(){if(w(this._numberCharSize)){var e=this._standardMethod(t.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/t.NUMBERS_CHAR_SET.length,height:e.height}}return this._numberCharSize}},{key:"_measureFullSizeChar",value:function(){return w(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(t.FULL_SIZE_CHAR)),this._fullCharSize}},{key:"_measureLetterChar",value:function(){if(w(this._letterCharSize)){var e=this._standardMethod(t.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/t.ALPHABET_CHAR_SET.length,height:e.height}}return this._letterCharSize}},{key:"_measureSpecialChar",value:function(t){return T(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}},{key:"release",value:function(){T(this._canvas)&&(this._canvas=null),T(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}]),t}();fi.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",fi.NUMBERS_CHAR_SET="0123456789",fi.FULL_SIZE_CHAR="字";var pi,vi="undefined"!=typeof console;function yi(t,e,i){var n=[e].concat([].slice.call(i));vi&&console[t].apply(console,n)}!function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"}(pi||(pi={}));var gi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pi.None,i=arguments.length>1?arguments[1]:void 0;jt(this,t),this._onErrorHandler=[],this._level=e,this._method=i}return zt(t,[{key:"addErrorHandler",value:function(t){this._onErrorHandler.find((function(e){return e===t}))||this._onErrorHandler.push(t)}},{key:"removeErrorHandler",value:function(t){var e=this._onErrorHandler.findIndex((function(e){return e===t}));e<0||this._onErrorHandler.splice(e,1)}},{key:"callErrorHandler",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this._onErrorHandler.forEach((function(t){return t.apply(void 0,e)}))}},{key:"canLogInfo",value:function(){return this._level>=pi.Info}},{key:"canLogDebug",value:function(){return this._level>=pi.Debug}},{key:"canLogError",value:function(){return this._level>=pi.Error}},{key:"canLogWarn",value:function(){return this._level>=pi.Warn}},{key:"level",value:function(t){return arguments.length?(this._level=+t,this):this._level}},{key:"error",value:function(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this._level>=pi.Error&&(this._onErrorHandler.length?this.callErrorHandler.apply(this,i):yi(null!==(t=this._method)&&void 0!==t?t:"error","ERROR",i)),this}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=pi.Warn&&yi(this._method||"warn","WARN",e),this}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=pi.Info&&yi(this._method||"log","INFO",e),this}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this._level>=pi.Debug&&yi(this._method||"log","DEBUG",e),this}}],[{key:"getInstance",value:function(e,i){return t._instance&&I(e)?t._instance.level(e):t._instance||(t._instance=new t(e,i)),t._instance}},{key:"setInstance",value:function(e){return t._instance=e}},{key:"setInstanceLevel",value:function(e){t._instance?t._instance.level(e):t._instance=new t(e)}},{key:"clearInstance",value:function(){t._instance=null}}]),t}();function mi(t){if(F(t))return[t,t,t,t];if(B(t)){var e=t.length;if(1===e){var i=t[0];return[i,i,i,i]}if(2===e){var n=Mt(t,2),r=n[0],o=n[1];return[r,o,r,o]}if(3===e){var a=Mt(t,3),s=a[0],l=a[1];return[s,l,a[2],l]}if(4===e)return t}if(M(t)){var u=t.top,c=void 0===u?0:u,h=t.right,d=void 0===h?0:h,f=t.bottom,p=void 0===f?0:f,v=t.left;return[c,d,p,void 0===v?0:v]}return[0,0,0,0]}function _i(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t)return{width:i,height:n};try{e=null===window||void 0===window?void 0:window.getComputedStyle}catch(t){e=function(){return{}}}var r=e(t);if(/^(\d*\.?\d+)(px)$/.exec(r.width)){var o=parseFloat(r.width)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)||t.clientWidth-1,a=parseFloat(r.height)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)||t.clientHeight-1;return{width:o<=0?i:o,height:a<=0?n:a}}return{width:i,height:n}}gi._instance=null;var bi=6371008.8,xi={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*bi,kilometers:6371.0088,kilometres:6371.0088,meters:bi,metres:bi,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:bi/1852,radians:1,yards:6967335.223679999};function ki(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function Si(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function Ai(t,e){if(!t)return!1;if(!e)return!1;var i,n="Feature"===(i=e).type?i.geometry:i,r=n.type,o=e.bbox,a=n.coordinates;if(o&&!0===$e(t,{x1:o[0],x2:o[1],y1:o[1],y2:o[3]},!0))return!1;"Polygon"===r&&(a=[a]);for(var s=!1,l=0;l<a.length;++l)for(var u=0;u<a[l].length;++u)if(li(a[l][u].map((function(t){return{x:t[0],y:t[1]}})),t.x,t.y))return s=!0;return s}function wi(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=ge(t[0]),o=ge(t[1]),a=ge(i),s=function(t,e){void 0===e&&(e="kilometers");var i=xi[e];if(!i)throw new Error(e+" units is invalid");return t/i}(e,n.units),l=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(a));return{x:me(r+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(l))),y:me(l)}}var Ti=function(t,e){var i=e.callback;return i&&(t=t.filter(i)),t};function Mi(){return new Ci}function Ci(){this.reset()}Ci.prototype={constructor:Ci,reset:function(){this.s=this.t=0},add:function(t){Ri(Ei,t,this.t),Ri(this,Ei.s,this.s),this.s?this.t+=Ei.t:this.s=Ei.t},valueOf:function(){return this.s}};var Ei=new Ci;function Ri(t,e,i){var n=t.s=e+i,r=n-e,o=n-r;t.t=e-o+(i-r)}var Pi=1e-6,Bi=Math.PI,Li=Bi/2,Oi=Bi/4,Ii=2*Bi,Di=180/Bi,Fi=Bi/180,zi=Math.abs,ji=Math.atan,Hi=Math.atan2,Ni=Math.cos,Vi=Math.exp,Gi=Math.log,Wi=Math.pow,Ui=Math.sin,Yi=Math.sign||function(t){return t>0?1:t<0?-1:0},Ki=Math.sqrt,Xi=Math.tan;function Zi(t){return t>1?0:t<-1?Bi:Math.acos(t)}function qi(t){return t>1?Li:t<-1?-Li:Math.asin(t)}function Ji(){}function Qi(t,e){t&&tn.hasOwnProperty(t.type)&&tn[t.type](t,e)}var $i={Feature:function(t,e){Qi(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)Qi(i[n].geometry,e)}},tn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){en(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)en(i[n],e,0)},Polygon:function(t,e){nn(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)nn(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)Qi(i[n],e)}};function en(t,e,i){var n,r=-1,o=t.length-i;for(e.lineStart();++r<o;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function nn(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)en(t[i],e,1);e.polygonEnd()}function rn(t,e){t&&$i.hasOwnProperty(t.type)?$i[t.type](t,e):Qi(t,e)}function on(t){return[Hi(t[1],t[0]),qi(t[2])]}function an(t){var e=t[0],i=t[1],n=Ni(i);return[n*Ni(e),n*Ui(e),Ui(i)]}function sn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ln(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function un(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function cn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function hn(t){var e=Ki(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function dn(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function fn(t,e){return[zi(t)>Bi?t+Math.round(-t/Ii)*Ii:t,e]}function pn(t,e,i){return(t%=Ii)?e||i?dn(yn(t),gn(e,i)):yn(t):e||i?gn(e,i):fn}function vn(t){return function(e,i){return[(e+=t)>Bi?e-Ii:e<-Bi?e+Ii:e,i]}}function yn(t){var e=vn(t);return e.invert=vn(-t),e}function gn(t,e){var i=Ni(t),n=Ui(t),r=Ni(e),o=Ui(e);function a(t,e){var a=Ni(e),s=Ni(t)*a,l=Ui(t)*a,u=Ui(e),c=u*i+s*n;return[Hi(l*r-c*o,s*i-u*n),qi(c*r+l*o)]}return a.invert=function(t,e){var a=Ni(e),s=Ni(t)*a,l=Ui(t)*a,u=Ui(e),c=u*r-l*o;return[Hi(l*r+u*o,s*i+c*n),qi(c*i-s*n)]},a}function mn(t,e){(e=an(e))[0]-=t,hn(e);var i=Zi(-e[1]);return((-e[2]<0?-i:i)+Ii-Pi)%Ii}function _n(){var t,e=[];return{point:function(e,i,n){t.push([e,i,n])},lineStart:function(){e.push(t=[])},lineEnd:Ji,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function bn(t,e){return zi(t[0]-e[0])<Pi&&zi(t[1]-e[1])<Pi}function xn(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function kn(t,e,i,n,r){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],a=t[e];if(bn(n,a)){if(!n[2]&&!a[2]){for(r.lineStart(),o=0;o<e;++o)r.point((n=t[o])[0],n[1]);return void r.lineEnd()}a[0]+=2*Pi}s.push(i=new xn(n,t,null,!0)),l.push(i.o=new xn(n,null,i,!1)),s.push(i=new xn(a,t,null,!1)),l.push(i.o=new xn(a,null,i,!0))}})),s.length){for(l.sort(e),Sn(s),Sn(l),o=0,a=l.length;o<a;++o)l[o].e=i=!i;for(var u,c,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,a=u.length;o<a;++o)r.point((c=u[o])[0],c[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(f)for(u=d.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else n(d.x,d.p.x,-1,r);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);r.lineEnd()}}}function Sn(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}fn.invert=fn;var An,wn,Tn=Mi();function Mn(t){return zi(t[0])<=Bi?t[0]:Yi(t[0])*((zi(t[0])+Bi)%Ii-Bi)}function Cn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function En(t){for(var e,i,n,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(i=new Array(a);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--a]=n[e];return i}function Rn(t,e,i,n){return function(r){var o,a,s,l=e(r),u=_n(),c=e(u),h=!1,d={point:f,lineStart:v,lineEnd:y,polygonStart:function(){d.point=g,d.lineStart=m,d.lineEnd=_,a=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=v,d.lineEnd=y,a=En(a);var t=function(t,e){var i=Mn(e),n=e[1],r=Ui(n),o=[Ui(i),-Ni(i),0],a=0,s=0;Tn.reset(),1===r?n=Li+Pi:-1===r&&(n=-Li-Pi);for(var l=0,u=t.length;l<u;++l)if(h=(c=t[l]).length)for(var c,h,d=c[h-1],f=Mn(d),p=d[1]/2+Oi,v=Ui(p),y=Ni(p),g=0;g<h;++g,f=_,v=x,y=k,d=m){var m=c[g],_=Mn(m),b=m[1]/2+Oi,x=Ui(b),k=Ni(b),S=_-f,A=S>=0?1:-1,w=A*S,T=w>Bi,M=v*x;if(Tn.add(Hi(M*A*Ui(w),y*k+M*Ni(w))),a+=T?S+A*Ii:S,T^f>=i^_>=i){var C=ln(an(d),an(m));hn(C);var E=ln(o,C);hn(E);var R=(T^S>=0?-1:1)*qi(E[2]);(n>R||n===R&&(C[0]||C[1]))&&(s+=T^S>=0?1:-1)}}return(a<-Pi||a<Pi&&Tn<-Pi)^1&s}(o,n);a.length?(h||(r.polygonStart(),h=!0),kn(a,Bn,t,i,r)):t&&(h||(r.polygonStart(),h=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),a=o=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function f(e,i){t(e,i)&&r.point(e,i)}function p(t,e){l.point(t,e)}function v(){d.point=p,l.lineStart()}function y(){d.point=f,l.lineEnd()}function g(t,e){s.push([t,e]),c.point(t,e)}function m(){c.lineStart(),s=[]}function _(){g(s[0][0],s[0][1]),c.lineEnd();var t,e,i,n,l=c.clean(),d=u.result(),f=d.length;if(s.pop(),o.push(s),s=null,f)if(1&l){if((e=(i=d[0]).length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),t=0;t<e;++t)r.point((n=i[t])[0],n[1]);r.lineEnd()}}else f>1&&2&l&&d.push(d.pop().concat(d.shift())),a.push(d.filter(Pn))}return d}}function Pn(t){return t.length>1}function Bn(t,e){return((t=t.x)[0]<0?t[1]-Li-Pi:Li-t[1])-((e=e.x)[0]<0?e[1]-Li-Pi:Li-e[1])}1===(An=Cn).length&&(wn=An,An=function(t,e){return Cn(wn(t),e)});var Ln=Rn((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?Bi:-Bi,l=zi(o-i);zi(l-Bi)<Pi?(t.point(i,n=(n+a)/2>0?Li:-Li),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(o,n),e=0):r!==s&&l>=Bi&&(zi(i-r)<Pi&&(i-=r*Pi),zi(o-s)<Pi&&(o-=s*Pi),n=function(t,e,i,n){var r,o,a=Ui(t-i);return zi(a)>Pi?ji((Ui(e)*(o=Ni(n))*Ui(i)-Ui(n)*(r=Ni(e))*Ui(t))/(r*o*a)):(e+n)/2}(i,n,o,a),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),e=0),t.point(i=o,n=a),r=s},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*Li,n.point(-Bi,r),n.point(0,r),n.point(Bi,r),n.point(Bi,0),n.point(Bi,-r),n.point(0,-r),n.point(-Bi,-r),n.point(-Bi,0),n.point(-Bi,r);else if(zi(t[0]-e[0])>Pi){var o=t[0]<e[0]?Bi:-Bi;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(e[0],e[1])}),[-Bi,-Li]);function On(t){var e=Ni(t),i=6*Fi,n=e>0,r=zi(e)>Pi;function o(t,i){return Ni(t)*Ni(i)>e}function a(t,i,n){var r=[1,0,0],o=ln(an(t),an(i)),a=sn(o,o),s=o[0],l=a-s*s;if(!l)return!n&&t;var u=e*a/l,c=-e*s/l,h=ln(r,o),d=cn(r,u);un(d,cn(o,c));var f=h,p=sn(d,f),v=sn(f,f),y=p*p-v*(sn(d,d)-1);if(!(y<0)){var g=Ki(y),m=cn(f,(-p-g)/v);if(un(m,d),m=on(m),!n)return m;var _,b=t[0],x=i[0],k=t[1],S=i[1];x<b&&(_=b,b=x,x=_);var A=x-b,w=zi(A-Bi)<Pi;if(!w&&S<k&&(_=k,k=S,S=_),w||A<Pi?w?k+S>0^m[1]<(zi(m[0]-b)<Pi?k:S):k<=m[1]&&m[1]<=S:A>Bi^(b<=m[0]&&m[0]<=x)){var T=cn(f,(-p+g)/v);return un(T,d),[m,on(T)]}}}function s(e,i){var r=n?t:Bi-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}return Rn(o,(function(t){var e,i,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var f,p=[h,d],v=o(h,d),y=n?v?0:s(h,d):v?s(h+(h<0?Bi:-Bi),d):0;if(!e&&(u=l=v)&&t.lineStart(),v!==l&&(!(f=a(e,p))||bn(e,f)||bn(p,f))&&(p[2]=1),v!==l)c=0,v?(t.lineStart(),f=a(p,e),t.point(f[0],f[1])):(f=a(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(r&&e&&n^v){var g;y&i||!(g=a(p,e,!0))||(c=0,n?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1],3)))}!v||e&&bn(e,p)||t.point(p[0],p[1]),e=p,l=v,i=y},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,n,r,o){!function(t,e,i,n,r,o){if(i){var a=Ni(e),s=Ui(e),l=n*i;null==r?(r=e+n*Ii,o=e-l/2):(r=mn(a,r),o=mn(a,o),(n>0?r<o:r>o)&&(r+=n*Ii));for(var u,c=r;n>0?c>o:c<o;c-=l)u=on([a,-s*Ni(c),-s*Ui(c)]),t.point(u[0],u[1])}}(o,t,i,r,e,n)}),n?[0,-t]:[-Bi,t-Bi])}var In=1e9,Dn=-In;function Fn(t,e,i,n){function r(r,o){return t<=r&&r<=i&&e<=o&&o<=n}function o(r,o,s,u){var c=0,h=0;if(null==r||(c=a(r,s))!==(h=a(o,s))||l(r,o)<0^s>0)do{u.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+s+4)%4)!==h);else u.point(o[0],o[1])}function a(n,r){return zi(n[0]-t)<Pi?r>0?0:3:zi(n[0]-i)<Pi?r>0?2:1:zi(n[1]-e)<Pi?r>0?1:0:r>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var i=a(t,1),n=a(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(a){var l,u,c,h,d,f,p,v,y,g,m,_=a,b=_n(),x={point:k,lineStart:function(){x.point=S,u&&u.push(c=[]);g=!0,y=!1,p=v=NaN},lineEnd:function(){l&&(S(h,d),f&&y&&b.rejoin(),l.push(b.result()));x.point=k,y&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=u.length;i<r;++i)for(var o,a,s=u[i],l=1,c=s.length,h=s[0],d=h[0],f=h[1];l<c;++l)o=d,a=f,d=(h=s[l])[0],f=h[1],a<=n?f>n&&(d-o)*(n-a)>(f-a)*(t-o)&&++e:f<=n&&(d-o)*(n-a)<(f-a)*(t-o)&&--e;return e}(),i=m&&e,r=(l=En(l)).length;(i||r)&&(a.polygonStart(),i&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),r&&kn(l,s,e,o,a),a.polygonEnd());_=a,l=u=c=null}};function k(t,e){r(t,e)&&_.point(t,e)}function S(o,a){var s=r(o,a);if(u&&c.push([o,a]),g)h=o,d=a,f=s,g=!1,s&&(_.lineStart(),_.point(o,a));else if(s&&y)_.point(o,a);else{var l=[p=Math.max(Dn,Math.min(In,p)),v=Math.max(Dn,Math.min(In,v))],b=[o=Math.max(Dn,Math.min(In,o)),a=Math.max(Dn,Math.min(In,a))];!function(t,e,i,n,r,o){var a,s=t[0],l=t[1],u=0,c=1,h=e[0]-s,d=e[1]-l;if(a=i-s,h||!(a>0)){if(a/=h,h<0){if(a<u)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>u&&(u=a)}if(a=r-s,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>u&&(u=a)}else if(h>0){if(a<u)return;a<c&&(c=a)}if(a=n-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*h,t[1]=l+u*d),c<1&&(e[0]=s+c*h,e[1]=l+c*d),!0}}}}}(l,b,t,e,i,n)?s&&(_.lineStart(),_.point(o,a),m=!1):(y||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),s||_.lineEnd(),m=!1)}p=o,v=a,y=s}return x}}function zn(t){return t}var jn,Hn,Nn,Vn,Gn=Mi(),Wn=Mi(),Un={point:Ji,lineStart:Ji,lineEnd:Ji,polygonStart:function(){Un.lineStart=Yn,Un.lineEnd=Zn},polygonEnd:function(){Un.lineStart=Un.lineEnd=Un.point=Ji,Gn.add(zi(Wn)),Wn.reset()},result:function(){var t=Gn/2;return Gn.reset(),t}};function Yn(){Un.point=Kn}function Kn(t,e){Un.point=Xn,jn=Nn=t,Hn=Vn=e}function Xn(t,e){Wn.add(Vn*t-Nn*e),Nn=t,Vn=e}function Zn(){Xn(jn,Hn)}var qn=Un,Jn=1/0,Qn=Jn,$n=-Jn,tr=$n;var er,ir,nr,rr,or={point:function(t,e){t<Jn&&(Jn=t);t>$n&&($n=t);e<Qn&&(Qn=e);e>tr&&(tr=e)},lineStart:Ji,lineEnd:Ji,polygonStart:Ji,polygonEnd:Ji,result:function(){var t=[[Jn,Qn],[$n,tr]];return $n=tr=-(Qn=Jn=1/0),t}},ar=0,sr=0,lr=0,ur=0,cr=0,hr=0,dr=0,fr=0,pr=0,vr={point:yr,lineStart:gr,lineEnd:br,polygonStart:function(){vr.lineStart=xr,vr.lineEnd=kr},polygonEnd:function(){vr.point=yr,vr.lineStart=gr,vr.lineEnd=br},result:function(){var t=pr?[dr/pr,fr/pr]:hr?[ur/hr,cr/hr]:lr?[ar/lr,sr/lr]:[NaN,NaN];return ar=sr=lr=ur=cr=hr=dr=fr=pr=0,t}};function yr(t,e){ar+=t,sr+=e,++lr}function gr(){vr.point=mr}function mr(t,e){vr.point=_r,yr(nr=t,rr=e)}function _r(t,e){var i=t-nr,n=e-rr,r=Ki(i*i+n*n);ur+=r*(nr+t)/2,cr+=r*(rr+e)/2,hr+=r,yr(nr=t,rr=e)}function br(){vr.point=yr}function xr(){vr.point=Sr}function kr(){Ar(er,ir)}function Sr(t,e){vr.point=Ar,yr(er=nr=t,ir=rr=e)}function Ar(t,e){var i=t-nr,n=e-rr,r=Ki(i*i+n*n);ur+=r*(nr+t)/2,cr+=r*(rr+e)/2,hr+=r,dr+=(r=rr*t-nr*e)*(nr+t),fr+=r*(rr+e),pr+=3*r,yr(nr=t,rr=e)}var wr=vr;function Tr(t){this._context=t}Tr.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Ii)}},result:Ji};var Mr,Cr,Er,Rr,Pr,Br=Mi(),Lr={point:Ji,lineStart:function(){Lr.point=Or},lineEnd:function(){Mr&&Ir(Cr,Er),Lr.point=Ji},polygonStart:function(){Mr=!0},polygonEnd:function(){Mr=null},result:function(){var t=+Br;return Br.reset(),t}};function Or(t,e){Lr.point=Ir,Cr=Rr=t,Er=Pr=e}function Ir(t,e){Rr-=t,Pr-=e,Br.add(Ki(Rr*Rr+Pr*Pr)),Rr=t,Pr=e}var Dr=Lr;function Fr(){this._string=[]}function zr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function jr(t,e){var i,n,r=4.5;function o(t){return t&&("function"==typeof r&&n.pointRadius(+r.apply(this,arguments)),rn(t,i(n))),n.result()}return o.area=function(t){return rn(t,i(qn)),qn.result()},o.measure=function(t){return rn(t,i(Dr)),Dr.result()},o.bounds=function(t){return rn(t,i(or)),or.result()},o.centroid=function(t){return rn(t,i(wr)),wr.result()},o.projection=function(e){return arguments.length?(i=null==e?(t=null,zn):(t=e).stream,o):t},o.context=function(t){return arguments.length?(n=null==t?(e=null,new Fr):new Tr(e=t),"function"!=typeof r&&n.pointRadius(r),o):e},o.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(n.pointRadius(+t),+t),o):r},o.projection(t).context(e)}function Hr(t){return function(e){var i=new Nr;for(var n in t)i[n]=t[n];return i.stream=e,i}}function Nr(){}function Vr(t,e,i){var n=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=n&&t.clipExtent(null),rn(i,t.stream(or)),e(or.result()),null!=n&&t.clipExtent(n),t}function Gr(t,e,i){return Vr(t,(function(i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(n/(i[1][0]-i[0][0]),r/(i[1][1]-i[0][1])),a=+e[0][0]+(n-o*(i[1][0]+i[0][0]))/2,s=+e[0][1]+(r-o*(i[1][1]+i[0][1]))/2;t.scale(150*o).translate([a,s])}),i)}function Wr(t,e,i){return Gr(t,[[0,0],e],i)}function Ur(t,e,i){return Vr(t,(function(i){var n=+e,r=n/(i[1][0]-i[0][0]),o=(n-r*(i[1][0]+i[0][0]))/2,a=-r*i[0][1];t.scale(150*r).translate([o,a])}),i)}function Yr(t,e,i){return Vr(t,(function(i){var n=+e,r=n/(i[1][1]-i[0][1]),o=-r*i[0][0],a=(n-r*(i[1][1]+i[0][1]))/2;t.scale(150*r).translate([o,a])}),i)}Fr.prototype={_radius:4.5,_circle:zr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=zr(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Nr.prototype={constructor:Nr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Kr=16,Xr=Ni(30*Fi);function Zr(t,e){return+e?function(t,e){function i(n,r,o,a,s,l,u,c,h,d,f,p,v,y){var g=u-n,m=c-r,_=g*g+m*m;if(_>4*e&&v--){var b=a+d,x=s+f,k=l+p,S=Ki(b*b+x*x+k*k),A=qi(k/=S),w=zi(zi(k)-1)<Pi||zi(o-h)<Pi?(o+h)/2:Hi(x,b),T=t(w,A),M=T[0],C=T[1],E=M-n,R=C-r,P=m*E-g*R;(P*P/_>e||zi((g*E+m*R)/_-.5)>.3||a*d+s*f+l*p<Xr)&&(i(n,r,o,a,s,l,M,C,w,b/=S,x/=S,k,v,y),y.point(M,C),i(M,C,w,b,x,k,u,c,h,d,f,p,v,y))}}return function(e){var n,r,o,a,s,l,u,c,h,d,f,p,v={point:y,lineStart:g,lineEnd:_,polygonStart:function(){e.polygonStart(),v.lineStart=b},polygonEnd:function(){e.polygonEnd(),v.lineStart=g}};function y(i,n){i=t(i,n),e.point(i[0],i[1])}function g(){c=NaN,v.point=m,e.lineStart()}function m(n,r){var o=an([n,r]),a=t(n,r);i(c,h,u,d,f,p,c=a[0],h=a[1],u=n,d=o[0],f=o[1],p=o[2],Kr,e),e.point(c,h)}function _(){v.point=y,e.lineEnd()}function b(){g(),v.point=x,v.lineEnd=k}function x(t,e){m(n=t,e),r=c,o=h,a=d,s=f,l=p,v.point=m}function k(){i(c,h,u,d,f,p,r,o,n,a,s,l,Kr,e),v.lineEnd=_,_()}return v}}(t,e):function(t){return Hr({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var qr=Hr({point:function(t,e){this.stream.point(t*Fi,e*Fi)}});function Jr(t,e,i,n,r){function o(o,a){return[e+t*(o*=n),i-t*(a*=r)]}return o.invert=function(o,a){return[(o-e)/t*n,(i-a)/t*r]},o}function Qr(t,e,i,n,r,o){var a=Ni(o),s=Ui(o),l=a*t,u=s*t,c=a/t,h=s/t,d=(s*i-a*e)/t,f=(s*e+a*i)/t;function p(t,o){return[l*(t*=n)-u*(o*=r)+e,i-u*t-l*o]}return p.invert=function(t,e){return[n*(c*t-h*e+d),r*(f-h*t-c*e)]},p}function $r(t){return to((function(){return t}))()}function to(t){var e,i,n,r,o,a,s,l,u,c,h=150,d=480,f=250,p=0,v=0,y=0,g=0,m=0,_=0,b=1,x=1,k=null,S=Ln,A=null,w=zn,T=.5;function M(t){return l(t[0]*Fi,t[1]*Fi)}function C(t){return(t=l.invert(t[0],t[1]))&&[t[0]*Di,t[1]*Di]}function E(){var t=Qr(h,0,0,b,x,_).apply(null,e(p,v)),n=(_?Qr:Jr)(h,d-t[0],f-t[1],b,x,_);return i=pn(y,g,m),s=dn(e,n),l=dn(i,s),a=Zr(s,T),R()}function R(){return u=c=null,M}return M.stream=function(t){return u&&c===t?u:u=qr(function(t){return Hr({point:function(e,i){var n=t(e,i);return this.stream.point(n[0],n[1])}})}(i)(S(a(w(c=t)))))},M.preclip=function(t){return arguments.length?(S=t,k=void 0,R()):S},M.postclip=function(t){return arguments.length?(w=t,A=n=r=o=null,R()):w},M.clipAngle=function(t){return arguments.length?(S=+t?On(k=t*Fi):(k=null,Ln),R()):k*Di},M.clipExtent=function(t){return arguments.length?(w=null==t?(A=n=r=o=null,zn):Fn(A=+t[0][0],n=+t[0][1],r=+t[1][0],o=+t[1][1]),R()):null==A?null:[[A,n],[r,o]]},M.scale=function(t){return arguments.length?(h=+t,E()):h},M.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],E()):[d,f]},M.center=function(t){return arguments.length?(p=t[0]%360*Fi,v=t[1]%360*Fi,E()):[p*Di,v*Di]},M.rotate=function(t){return arguments.length?(y=t[0]%360*Fi,g=t[1]%360*Fi,m=t.length>2?t[2]%360*Fi:0,E()):[y*Di,g*Di,m*Di]},M.angle=function(t){return arguments.length?(_=t%360*Fi,E()):_*Di},M.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},M.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},M.precision=function(t){return arguments.length?(a=Zr(s,T=t*t),R()):Ki(T)},M.fitExtent=function(t,e){return Gr(M,t,e)},M.fitSize=function(t,e){return Wr(M,t,e)},M.fitWidth=function(t,e){return Ur(M,t,e)},M.fitHeight=function(t,e){return Yr(M,t,e)},function(){return e=t.apply(this,arguments),M.invert=e.invert&&C,E()}}function eo(t){var e=0,i=Bi/3,n=to(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*Fi,i=t[1]*Fi):[e*Di,i*Di]},r}function io(t,e){var i=Ui(t),n=(i+Ui(e))/2;if(zi(n)<Pi)return function(t){var e=Ni(t);function i(t,i){return[t*e,Ui(i)/e]}return i.invert=function(t,i){return[t/e,qi(i*e)]},i}(t);var r=1+i*(2*n-i),o=Ki(r)/n;function a(t,e){var i=Ki(r-2*n*Ui(e))/n;return[i*Ui(t*=n),o-i*Ni(t)]}return a.invert=function(t,e){var i=o-e,a=Hi(t,zi(i))*Yi(i);return i*n<0&&(a-=Bi*Yi(t)*Yi(i)),[a/n,qi((r-(t*t+i*i)*n*n)/(2*n))]},a}function no(){return eo(io).scale(155.424).center([0,33.6442])}function ro(){return no().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function oo(t){return function(e,i){var n=Ni(e),r=Ni(i),o=t(n*r);return[o*r*Ui(e),o*Ui(i)]}}function ao(t){return function(e,i){var n=Ki(e*e+i*i),r=t(n),o=Ui(r),a=Ni(r);return[Hi(e*o,n*a),qi(n&&i*o/n)]}}var so=oo((function(t){return Ki(2/(1+t))}));so.invert=ao((function(t){return 2*qi(t/2)}));var lo=oo((function(t){return(t=Zi(t))&&t/Ui(t)}));function uo(t,e){return[t,Gi(Xi((Li+e)/2))]}function co(t){var e,i,n,r=$r(t),o=r.center,a=r.scale,s=r.translate,l=r.clipExtent,u=null;function c(){var o=Bi*a(),s=r(function(t){function e(e){return(e=t(e[0]*Fi,e[1]*Fi))[0]*=Di,e[1]*=Di,e}return t=pn(t[0]*Fi,t[1]*Fi,t.length>2?t[2]*Fi:0),e.invert=function(e){return(e=t.invert(e[0]*Fi,e[1]*Fi))[0]*=Di,e[1]*=Di,e},e}(r.rotate()).invert([0,0]));return l(null==u?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===uo?[[Math.max(s[0]-o,u),e],[Math.min(s[0]+o,i),n]]:[[u,Math.max(s[1]-o,e)],[i,Math.min(s[1]+o,n)]])}return r.scale=function(t){return arguments.length?(a(t),c()):a()},r.translate=function(t){return arguments.length?(s(t),c()):s()},r.center=function(t){return arguments.length?(o(t),c()):o()},r.clipExtent=function(t){return arguments.length?(null==t?u=e=i=n=null:(u=+t[0][0],e=+t[0][1],i=+t[1][0],n=+t[1][1]),c()):null==u?null:[[u,e],[i,n]]},c()}function ho(t){return Xi((Li+t)/2)}function fo(t,e){var i=Ni(t),n=t===e?Ui(t):Gi(i/Ni(e))/Gi(ho(e)/ho(t)),r=i*Wi(ho(t),n)/n;if(!n)return uo;function o(t,e){r>0?e<-Li+Pi&&(e=-Li+Pi):e>Li-Pi&&(e=Li-Pi);var i=r/Wi(ho(e),n);return[i*Ui(n*t),r-i*Ni(n*t)]}return o.invert=function(t,e){var i=r-e,o=Yi(n)*Ki(t*t+i*i),a=Hi(t,zi(i))*Yi(i);return i*n<0&&(a-=Bi*Yi(t)*Yi(i)),[a/n,2*ji(Wi(r/o,1/n))-Li]},o}function po(t,e){return[t,e]}function vo(t,e){var i=Ni(t),n=t===e?Ui(t):(i-Ni(e))/(e-t),r=i/n+t;if(zi(n)<Pi)return po;function o(t,e){var i=r-e,o=n*t;return[i*Ui(o),r-i*Ni(o)]}return o.invert=function(t,e){var i=r-e,o=Hi(t,zi(i))*Yi(i);return i*n<0&&(o-=Bi*Yi(t)*Yi(i)),[o/n,r-Yi(n)*Ki(t*t+i*i)]},o}lo.invert=ao((function(t){return t})),uo.invert=function(t,e){return[t,2*ji(Vi(e))-Li]},po.invert=po;var yo=1.340264,go=-.081106,mo=893e-6,_o=.003796,bo=Ki(3)/2;function xo(t,e){var i=qi(bo*Ui(e)),n=i*i,r=n*n*n;return[t*Ni(i)/(bo*(yo+3*go*n+r*(7*mo+9*_o*n))),i*(yo+go*n+r*(mo+_o*n))]}function ko(t,e){var i=Ni(e),n=Ni(t)*i;return[i*Ui(t)/n,Ui(e)/n]}function So(t,e){var i=e*e,n=i*i;return[t*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),e*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}function Ao(t,e){return[Ni(e)*Ui(t),Ui(e)]}function wo(t,e){var i=Ni(e),n=1+Ni(t)*i;return[i*Ui(t)/n,Ui(e)/n]}function To(t,e){return[Gi(Xi((Li+e)/2)),-t]}function Mo(t){return t}function Co(t,e){var i=e.id,n=e.bbox,r=null==e.properties?{}:e.properties,o=function(t,e){var i=function(t){if(null==t)return Mo;var e,i,n=t.scale[0],r=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=i=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*n+o,c[1]=(i+=t[1])*r+a;l<u;)c[l]=t[l],++l;return c}}(t.transform),n=t.arcs;function r(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],o=0,a=r.length;o<a;++o)e.push(i(r[o],o));t<0&&function(t,e){for(var i,n=t.length,r=n-e;r<--n;)i=t[r],t[r++]=t[n],t[n]=i}(e,a)}function o(t){return i(t)}function a(t){for(var e=[],i=0,n=t.length;i<n;++i)r(t[i],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(s)}function u(t){var e,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(u)};case"Point":e=o(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(o);break;case"LineString":e=a(t.arcs);break;case"MultiLineString":e=t.arcs.map(a);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:i,coordinates:e}}return u(e)}(t,e);return null==i&&null==n?{type:"Feature",properties:r,geometry:o}:null==n?{type:"Feature",id:i,properties:r,geometry:o}:{type:"Feature",id:i,bbox:n,properties:r,geometry:o}}xo.invert=function(t,e){for(var i,n=e,r=n*n,o=r*r*r,a=0;a<12&&(o=(r=(n-=i=(n*(yo+go*r+o*(mo+_o*r))-e)/(yo+3*go*r+o*(7*mo+9*_o*r)))*n)*r*r,!(zi(i)<1e-12));++a);return[bo*t*(yo+3*go*r+o*(7*mo+9*_o*r))/Ni(n),qi(Ui(n)/bo)]},ko.invert=ao(ji),So.invert=function(t,e){var i,n=e,r=25;do{var o=n*n,a=o*o;n-=i=(n*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(zi(i)>Pi&&--r>0);return[t/(.8707+(o=n*n)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),n]},Ao.invert=ao(qi),wo.invert=ao((function(t){return 2*ji(t)})),To.invert=function(t,e){return[-e,2*ji(Vi(t))-Li]};var Eo={exports:{}},Ro=function(t,e){this.p1=t,this.p2=e};Ro.prototype.rise=function(){return this.p2[1]-this.p1[1]},Ro.prototype.run=function(){return this.p2[0]-this.p1[0]},Ro.prototype.slope=function(){return this.rise()/this.run()},Ro.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},Ro.prototype.isVertical=function(){return!isFinite(this.slope())},Ro.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},Ro.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},Ro.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},Ro.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},Ro.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var Po=Ro,Bo=function t(e,i){for(var n=0,r=0,o=1;o<=e.length-2;o++){var a=new Po(e[0],e[e.length-1]).perpendicularDistance(e[o]);a>n&&(r=o,n=a)}if(n>i)var s=t(e.slice(0,r),i),l=t(e.slice(r,e.length),i),u=s.concat(l);else u=e.length>1?[e[0],e[e.length-1]]:[e[0]];return u};!function(t){var e=Bo;function i(e,i){var n=e.geometry,r=n.type;if("LineString"===r)n.coordinates=t.exports.simplify(n.coordinates,i);else if("Polygon"===r||"MultiLineString"===r)for(var o=0;o<n.coordinates.length;o++)n.coordinates[o]=t.exports.simplify(n.coordinates[o],i);else if("MultiPolygon"===r)for(var a=0;a<n.coordinates.length;a++)for(var s=0;s<n.coordinates[a].length;s++)n.coordinates[a][s]=t.exports.simplify(n.coordinates[a][s],i);return e}t.exports=function(t,e,n){return n||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,e){for(var n=0;n<t.features.length;n++)t.features[n]=i(t.features[n],e);return t}(t,e):t.type&&"Feature"===t.type?i(t,e):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,i){return e(t,i)}}(Eo);var Lo=_(Eo.exports),Oo=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Fo.apply(void 0,[X(t)].concat(i))};function Io(t,e,i){var n=e[i];if(void 0===n)t[i]=null;else if(M(n))for(var r in M(t[i])||(t[i]={}),n)Io(t[i],n,r);else t[i]=n}function Do(t,e){if(M(e)&&t!==e)for(var i in e)Io(t,e,i)}function Fo(t){t||(t={});for(var e=-1,i=arguments.length<=1?0:arguments.length-1;++e<i;)Do(t,e+1<1||arguments.length<=e+1?void 0:arguments[e+1]);return t}var zo,jo={tolerance:.01},Ho=function(t,e){var i=Oo(jo,e).tolerance;return Lo(t,i)};!function(t){t.DSV="dsv",t.TREE="tree",t.GEO="geo",t.BYTE="bytejson",t.HEX="hex",t.GRAPH="graph",t.TABLE="table",t.GEO_GRATICULE="geo-graticule"}(zo||(zo={}));var No=function(t,e){for(var i=e.fields,n=e.key,r=e.value,o=e.retains,a=[],s=function(e){i.forEach((function(s){var l={};if(l[n]=s,l[r]=t[e][s],o)o.forEach((function(i){l[i]=t[e][i]}));else for(var u in t[e])-1===i.indexOf(u)&&(l[u]=t[e][u]);a.push(l)}))},l=0;l<t.length;l++)s(l);return a},Vo=function(t,e){var i,n;if(!(null==e?void 0:e.fields))return t;if(0===t.length)return t;var r=e.fields,o=t[0],a={},s=[],l=function(e){if(Object.prototype.hasOwnProperty.call(r,e)){var l,u=r[e];if(!u.type){var c=o;e in o||(c=null!==(i=t.find((function(t){return e in t})))&&void 0!==i?i:o),u.type="number"==typeof c[e]?"linear":"ordinal"}if("number"==typeof u.sortIndex&&(l={key:e,type:u.type,index:u.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===u.sortReverse},s.push(l)),(null===(n=u.domain)||void 0===n?void 0:n.length)>0)if("ordinal"===u.type){u._domainCache={},a[e]=u;var h={};u.domain.forEach((function(t,e){h[t]=e,u._domainCache[t]=e})),l&&(l.sortIndex=h,l.sortIndexCount=u.domain.length)}else u.domain.length>=2&&(a[e]=u)}};for(var u in r)l(u);return Object.keys(a).length>0&&(t=t.filter((function(t){for(var e in a){var i=a[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0}))),s.sort((function(t,e){return t.index-e.index})),t.sort((function(t,e){return function(t,e,i){for(var n=0;n<i.length;n++){var r=i[n],o=0;if("ordinal"===r.type?(void 0===r.sortIndex[e[r.key]]&&(r.sortIndex[e[r.key]]=r.sortIndexCount++),void 0===r.sortIndex[t[r.key]]&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),o=r.sortIndex[t[r.key]]-r.sortIndex[e[r.key]]):"linear"===r.type&&(o=t[r.key]-e[r.key]),r.sortReverse&&(o=-o),0!==o)return o}return 0}(t,e,s)})),t};var Go={},Wo={};function Uo(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Yo(t){var e=Object.create(null),i=[];return t.forEach((function(t){for(var n in t)n in e||i.push(e[n]=n)})),i}function Ko(t,e){var i=t+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function Xo(t){var e,i=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Ko(-e,6):e>9999?"+"+Ko(e,6):Ko(e,4))+"-"+Ko(t.getUTCMonth()+1,2)+"-"+Ko(t.getUTCDate(),2)+(o?"T"+Ko(i,2)+":"+Ko(n,2)+":"+Ko(r,2)+"."+Ko(o,3)+"Z":r?"T"+Ko(i,2)+":"+Ko(n,2)+":"+Ko(r,2)+"Z":n||i?"T"+Ko(i,2)+":"+Ko(n,2)+"Z":"")}function Zo(t){var e=new RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function n(t,e){var n,r=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return Wo;if(u)return u=!1,Go;var e,n,r=a;if(34===t.charCodeAt(r)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?l=!0:10===(n=t.charCodeAt(a++))?u=!0:13===n&&(u=!0,10===t.charCodeAt(a)&&++a),t.slice(r+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(n=t.charCodeAt(e=a++)))u=!0;else if(13===n)u=!0,10===t.charCodeAt(a)&&++a;else if(n!==i)continue;return t.slice(r,e)}return l=!0,t.slice(r,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(n=c())!==Wo;){for(var h=[];n!==Go&&n!==Wo;)h.push(n),n=c();e&&null==(h=e(h,s++))||r.push(h)}return r}function r(e,i){return e.map((function(e){return i.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?Xo(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,r,o=n(t,(function(t,n){if(i)return i(t,n-1);r=t,i=e?function(t,e){var i=Uo(t);return function(n,r){return e(i(n),r,t)}}(t,e):Uo(t)}));return o.columns=r||[],o},parseRows:n,format:function(e,i){return null==i&&(i=Yo(e)),[i.map(a).join(t)].concat(r(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=Yo(t)),r(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var qo=Zo(",").parse,Jo=Zo("\t").parse,Qo={delimiter:","},$o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=zo.DSV;var i=Oo(Qo,e).delimiter;if(!P(i))throw new TypeError("Invalid delimiter: must be a string!");return Zo(i).parse(t)},ta=function(t){return(arguments.length>2?arguments[2]:void 0).type=zo.DSV,qo(t)},ea=function(t){return(arguments.length>2?arguments[2]:void 0).type=zo.DSV,Jo(t)};function ia(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return na(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return na(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return oa(t);default:throw new Error("unknown GeoJSON type")}}function na(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=ra(t.properties),e.geometry=oa(t.geometry),e}function ra(t){var e={};return t?(Object.keys(t).forEach((function(n){var r=t[n];"object"===i(r)?null===r?e[n]=null:Array.isArray(r)?e[n]=r.map((function(t){return t})):e[n]=ra(r):e[n]=r})),e):e}function oa(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return oa(t)})),e):(e.coordinates=aa(t.coordinates),e)}function aa(t){var e=t;return"object"!==i(e[0])?e.slice():e.map((function(t){return aa(t)}))}function sa(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function la(t){for(var e,i,n=sa(t),r=0,o=1;o<n.length;)e=i||n[0],r+=((i=n[o])[0]-e[0])*(i[1]+e[1]),o++;return r>0}function ua(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function ca(t,e){var i,n,r,o,a,s,l,u,c,h,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,v=f?t.features.length:1;for(i=0;i<v;i++){for(s=f?t.features[i].geometry:p?t.geometry:t,u=f?t.features[i].properties:p?t.properties:{},c=f?t.features[i].bbox:p?t.bbox:void 0,h=f?t.features[i].id:p?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<a;r++)if(null!==(o=l?s.geometries[r]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function ha(t,e){if(!(i=e=e||{})||i.constructor!==Object)throw new Error("options is invalid");var i,n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=ia(t));var o=[];switch(t.type){case"GeometryCollection":return ca(t,(function(t){da(t,n)})),t;case"FeatureCollection":return ua(t,(function(t){ua(da(t,n),(function(t){o.push(t)}))})),Si(o)}return da(t,n)}function da(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return ca(t,(function(t){da(t,e)})),t;case"LineString":return fa(sa(t),e),t;case"Polygon":return pa(sa(t),e),t;case"MultiLineString":return sa(t).forEach((function(t){fa(t,e)})),t;case"MultiPolygon":return sa(t).forEach((function(t){pa(t,e)})),t;case"Point":case"MultiPoint":return t}}function fa(t,e){la(t)===e&&t.reverse()}function pa(t,e){la(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)la(t[i])===e&&t[i].reverse()}function va(t){if(!t)throw new Error("geojson is required");var e=[];return function(t,e){ca(t,(function(t,i,n,r,o){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(ki(t,n,{bbox:r,id:o}),i,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(ki({type:a,coordinates:u},n),i,l))return!1}}))}(t,(function(t){e.push(t)})),Si(e)}var ya=jr(),ga={centroid:!1,name:!1,bbox:!1,rewind:!1},ma=function(t){if(t.geometry.type.startsWith("Multi")){var e=va(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},_a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2?arguments[2]:void 0).type=zo.GEO;var i=Oo(ga,e),n=i.centroid,r=i.name,o=i.bbox,a=i.rewind;if(Array.isArray(t))return function(t){var e=[];return t.forEach((function(t){"FeatureCollection"===t.type?t.features.forEach((function(t){e.push(ma(t))})):e.push(ma(t))})),e}(t);var s=t.features;return a&&(s=ha(t,{reverse:!M(a)||a.reverse}).features),s.forEach((function(t){if(n){var e=ya.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(r&&(t.name=t.properties.name),o){var i=ya.bounds(t);t.bbox=i}})),t.features=s,t},ba={},xa=function(t,e,i){i.type=zo.GEO;var n=Oo(ga,ba,e),r=n.object;if(!P(r))throw new TypeError("Invalid object: must be a string!");var o,a,s=(o=t,"string"==typeof(a=t.objects[r])&&(a=o.objects[a]),"GeometryCollection"===a.type?{type:"FeatureCollection",features:a.geometries.map((function(t){return Co(o,t)}))}:Co(o,a));return _a(s,n,i)},ka=function(t,e,i){var n=!S(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!B(t))throw new TypeError("Invalid data: must be DataView array!");return B(i.rawData)&&i.rawData.forEach((function(t){t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))})),n&&t.forEach((function(t){t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)})),t},Sa=0;function Aa(){return Sa>1e8&&(Sa=0),(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataset")+"_"+Sa++}var wa=function(){function t(e){var i,n;jt(this,t),this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new x,n=(null==e?void 0:e.name)?e.name:Aa("dataset"),this.name=n,this._logger=null!==(i=null==e?void 0:e.logger)&&void 0!==i?i:gi.getInstance()}return zt(t,[{key:"setLogger",value:function(t){this._logger=t}},{key:"getDataView",value:function(t){return this.dataViewMap[t]}},{key:"setDataView",value:function(t,e){var i;this.dataViewMap[t]&&(null===(i=this._logger)||void 0===i||i.error("Error: dataView ".concat(t," 之前已存在，请重新命名"))),this.dataViewMap[t]=e}},{key:"removeDataView",value:function(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}},{key:"registerParser",value:function(t,e){var i;this.parserMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.parserMap[t]=e}},{key:"removeParser",value:function(t){this.parserMap[t]=null,delete this.parserMap[t]}},{key:"getParser",value:function(t){return this.parserMap[t]||this.parserMap.default}},{key:"registerTransform",value:function(t,e){var i;this.transformMap[t]&&(null===(i=this._logger)||void 0===i||i.warn("Warn: transform ".concat(t," 之前已注册，执行覆盖逻辑"))),this.transformMap[t]=e}},{key:"removeTransform",value:function(t){this.transformMap[t]=null,delete this.transformMap[t]}},{key:"getTransform",value:function(t){return this.transformMap[t]}},{key:"multipleDataViewAddListener",value:function(t,e,i){this._callMap||(this._callMap=new Map);var n=this._callMap.get(i);n||(n=function(){t.some((function(t){return t.isRunning}))||i()}),t.forEach((function(t){t.target.addListener(e,n)})),this._callMap.set(i,n)}},{key:"allDataViewAddListener",value:function(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}},{key:"multipleDataViewRemoveListener",value:function(t,e,i){if(this._callMap){var n=this._callMap.get(i);n&&t.forEach((function(t){t.target.removeListener(e,n)})),this._callMap.delete(i)}}},{key:"multipleDataViewUpdateInParse",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.parseNewData(t.data,t.options)}))}},{key:"multipleDataViewUpdateInRawData",value:function(t){var e=this;t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.markRunning()})),t.forEach((function(t){var i;return null===(i=e.getDataView(t.name))||void 0===i?void 0:i.updateRawData(t.data,t.options)}))}},{key:"destroy",value:function(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}]),t}(),Ta="_data-view-diff-rank",Ma=function(){function t(e,i){var n,r=this;jt(this,t),this.dataSet=e,this.options=i,this.isDataView=!0,this.target=new x,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pushHistory:!0,emitMessage:!0};return r.isRunning=!0,r.resetTransformData(),r.transformsArr.forEach((function(e){r.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1}),r.isLastTransform(e)&&r.diffLastData()})),r.isRunning=!1,!1!==t.emitMessage&&r.target.emit("change",[]),r},this.markRunning=function(){r.isRunning=!0,r.target.emit("markRunning",[])},n=(null==i?void 0:i.name)?i.name:Aa("dataview"),this.name=n,(null==i?void 0:i.history)&&(this.history=i.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(null==i?void 0:i.fields)}return zt(t,[{key:"parse",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isRunning=!0,n&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);var r=this.cloneParseData(t,e);if(null==e?void 0:e.type){var o=(null!==(i=this.dataSet.getParser(e.type))&&void 0!==i?i:this.dataSet.getParser("bytejson"))(r,e.options,this);this.rawData=r,this.parserData=o,this.history&&this.historyData.push(r,o),this.latestData=o}else this.parserData=r,this.rawData=r,this.history&&this.historyData.push(r),this.latestData=r;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}},{key:"transform",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isRunning=!0,t&&t.type){var i=!0;if("fields"===t.type){this._fields=t.options.fields;var n=this.transformsArr.findIndex((function(e){return e.type===t.type}));n>=0&&(i=!1,this.transformsArr[n].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){var r=this.isLastTransform(t);this.executeTransform(t),r&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}},{key:"isLastTransform",value:function(t){return this.transformsArr[this.transformsArr.length-1]===t}},{key:"sortTransform",value:function(){this.transformsArr.length>=2&&this.transformsArr.sort((function(t,e){var i,n;return(null!==(i=t.level)&&void 0!==i?i:0)-(null!==(n=e.level)&&void 0!==n?n:0)}))}},{key:"executeTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{pushHistory:!0,emitMessage:!0},i=e.pushHistory,n=e.emitMessage,r=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&!1!==i&&this.historyData.push(r),this.latestData=r,!1!==n&&this.target.emit("change",[])}},{key:"resetTransformData",value:function(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}},{key:"enableDiff",value:function(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}},{key:"disableDiff",value:function(){this._diffData=!1,this._diffMap=null,this._diffRank=null}},{key:"resetDiff",value:function(){this._diffMap=new Map,this._diffRank=0}},{key:"diffLastData",value:function(){var t,e=this;if(this._diffData&&this.latestData.forEach&&(null===(t=this._diffKeys)||void 0===t?void 0:t.length)){var i,n=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach((function(t){t[Ta]=n,e._diffMap.set(e._diffKeys.reduce((function(e,i){return e+t[i]}),""),t)})),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach((function(t){t[Ta]=n,i=e._diffKeys.reduce((function(e,i){return e+t[i]}),""),e._diffMap.get(i)?e.latestDataAUD.update.push(t):e.latestDataAUD.add.push(t),e._diffMap.set(i,t)})),this._diffMap.forEach((function(t,i){t[Ta]<n&&(e.latestDataAUD.del.push(t),e._diffMap.delete(i))}));this._diffRank=n}}},{key:"cloneParseData",value:function(e,i){var n=!1;return e instanceof t||!0!==(null==i?void 0:i.clone)||(n=!0),n?X(e):e}},{key:"parseNewData",value:function(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}},{key:"updateRawData",value:function(t,e){var i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}},{key:"getFields",value:function(){var t;return this._fields?this._fields:"dataview"===(null===(t=this.parseOption)||void 0===t?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}},{key:"setFields",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._fields=t&&e?Q({},this._fields,t):t;var i=this.transformsArr.find((function(t){return"fields"===t.type}));!w(this._fields)&&w(i)?(this.dataSet.registerTransform("fields",Vo),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}},{key:"destroy",value:function(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}]),t}(),Ca=function(){function t(){var t=this;this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=function(e){return t.locale_shortWeekdays[e.getDay()]},this.formatWeekday=function(e){return t.locale_weekdays[e.getDay()]},this.formatShortMonth=function(e){return t.locale_shortMonths[e.getMonth()]},this.formatMonth=function(e){return t.locale_months[e.getMonth()]},this.formatDayOfMonth=function(e,i){return t.pad(e.getDate(),i,2)},this.formatHour24=function(e,i){return t.pad(e.getHours(),i,2)},this.formatHour12=function(e,i){return t.pad(e.getHours()%12||12,i,2)},this.formatMilliseconds=function(e,i){return t.pad(e.getMilliseconds(),i,3)},this.formatMonthNumber=function(e,i){return t.pad(e.getMonth()+1,i,2)},this.formatMinutes=function(e,i){return t.pad(e.getMinutes(),i,2)},this.formatPeriod=function(e){return t.locale_periods[+(e.getHours()>=12)]},this.formatSeconds=function(e,i){return t.pad(e.getSeconds(),i,2)},this.formatFullYear=function(e,i){return t.pad(e.getFullYear()%1e4,i,4)},this.formatUTCShortWeekday=function(e){return t.locale_shortWeekdays[e.getUTCDay()]},this.formatUTCWeekday=function(e){return t.locale_weekdays[e.getUTCDay()]},this.formatUTCShortMonth=function(e){return t.locale_shortMonths[e.getUTCMonth()]},this.formatUTCMonth=function(e){return t.locale_months[e.getUTCMonth()]},this.formatUTCDayOfMonth=function(e,i){return t.pad(e.getUTCDate(),i,2)},this.formatUTCHour24=function(e,i){return t.pad(e.getUTCHours(),i,2)},this.formatUTCHour12=function(e,i){return t.pad(e.getUTCHours()%12||12,i,2)},this.formatUTCMilliseconds=function(e,i){return t.pad(e.getUTCMilliseconds(),i,3)},this.formatUTCMonthNumber=function(e,i){return t.pad(e.getUTCMonth()+1,i,2)},this.formatUTCMinutes=function(e,i){return t.pad(e.getUTCMinutes(),i,2)},this.formatUTCPeriod=function(e){return t.locale_periods[+(e.getUTCHours()>=12)]},this.formatUTCSeconds=function(e,i){return t.pad(e.getUTCSeconds(),i,2)},this.formatUTCFullYear=function(e,i){return t.pad(e.getUTCFullYear()%1e4,i,4)},this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=function(e,i,n){var r=t.shortWeekdayRe.exec(i.slice(n));return r?(e.w=t.shortWeekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseWeekday=function(e,i,n){var r=t.weekdayRe.exec(i.slice(n));return r?(e.w=t.weekdayLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseShortMonth=function(e,i,n){var r=t.shortMonthRe.exec(i.slice(n));return r?(e.m=t.shortMonthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseMonth=function(e,i,n){var r=t.monthRe.exec(i.slice(n));return r?(e.m=t.monthLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseDayOfMonth=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1},this.parseHour24=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1},this.parseMilliseconds=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1},this.parseMonthNumber=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+2));return r?(e.m=r-1,n+r[0].length):-1},this.parseMinutes=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1},this.parsePeriod=function(e,i,n){var r=t.periodRe.exec(i.slice(n));return r?(e.p=t.periodLookup.get(r[0].toLowerCase()),n+r[0].length):-1},this.parseSeconds=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1},this.parseFullYear=function(e,i,n){var r=t.numberRe.exec(i.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=function(e,i){return t.newFormat(e,t.formats)(new Date(t.getFullTimeStamp(i)))},this.timeUTCFormat=function(e,i){return t.newFormat(e,t.utcFormats)(new Date(t.getFullTimeStamp(i)))},this.timeParse=function(e,i){return t.newParse(e,!1)(i+"")},this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.requote=function(t){return t.replace(this.requoteRe,"\\$&")},t.prototype.localDate=function(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)},t.prototype.utcDate=function(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))},t.prototype.newDate=function(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}},t.prototype.formatRe=function(t){return new RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")},t.prototype.formatLookup=function(t){return new Map(t.map((function(t,e){return[t.toLowerCase(),e]})))},t.prototype.pad=function(t,e,i){var n=t<0?"-":"",r=(n?-t:t)+"",o=r.length;return n+(o<i?new Array(i-o+1).join(e)+r:r)},t.prototype.parseSpecifier=function(t,e,i,n){for(var r,o,a=0,s=e.length,l=i.length;a<s;){if(n>=l)return-1;if(37===(r=e.charCodeAt(a++))){if(r=e.charAt(a++),!(o=this.parses[r in this.pads?e.charAt(a++):r])||(n=o(t,i,n))<0)return-1}else if(r!==i.charCodeAt(n++))return-1}return n},t.prototype.newParse=function(t,e){var i=this;return function(n){var r=i.newDate(1900,void 0,1);return i.parseSpecifier(r,t,n+="",0)!==n.length?null:"Q"in r?new Date(r.Q):"s"in r?new Date(1e3*r.s+("L"in r?r.L:0)):(e&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,i.utcDate(r)):i.localDate(r))}},t.prototype.newFormat=function(t,e){var i=this;return function(n){var r,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),(o=i.pads[r=t.charAt(++s)])?r=t.charAt(++s):o="e"===r?" ":"0",r=(0,e[r])(n,o),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}},t.prototype.getFullTimeStamp=function(t){var e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e},t}(),Ea=function(t,e){return A(Pa.warnHandler)&&Pa.warnHandler.call(null,t,e),e?gi.getInstance().warn("[VChart warn]: ".concat(t),e):gi.getInstance().warn("[VChart warn]: ".concat(t))},Ra=function(t,e,i){if(!A(Pa.errorHandler))throw new Error(t);Pa.errorHandler.call(null,t,e)},Pa={silent:!1,warnHandler:!1,errorHandler:!1},Ba=function(){function t(){jt(this,t)}return zt(t,null,[{key:"GenAutoIncrementId",value:function(){return t.auto_increment_id++}}]),t}();Ba.auto_increment_id=0;var La=zt((function t(e){jt(this,t),this.id=Ba.GenAutoIncrementId(),this.registry=e})),Oa="named",Ia="inject",Da="multi_inject",Fa="inversify:tagged",za="inversify:paramtypes",ja=function(){function t(e,i){jt(this,t),this.key=e,this.value=i}return zt(t,[{key:"toString",value:function(){return this.key===Oa?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")}}]),t}(),Ha=function(t){var e;return function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,l=!a&&!s,u={create:a?function(){return w(Object.create(null))}:s?function(){return w({__proto__:null})}:function(){return w({})},has:l?function(t,i){return e.call(t,i)}:function(t,e){return e in t},get:l?function(t,i){return e.call(t,i)?t[i]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),h="object"==("undefined"==typeof process?"undefined":i(process))&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],i=function(){function t(t,e,i){this._index=0,this._keys=t,this._values=e,this._selector=i}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var i=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var i=this._find(t,!0);return this._values[i]=e,this},e.prototype.delete=function(e){var i=this._find(e,!1);if(i>=0){for(var n=this._keys.length,r=i+1;r<n;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new i(this._keys,this._values,n)},e.prototype.values=function(){return new i(this._keys,this._values,r)},e.prototype.entries=function(){return new i(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function n(t,e){return t}function r(t,e){return e}function a(t,e){return[t,e]}}():Map,f=(h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new d}Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()}}():Set,new(h||"function"!=typeof WeakMap?function(){var t=16,i=u.create(),n=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var t;do{t="@@WeakMap@@"+s()}while(u.has(i,t));return i[t]=!0,t}function o(t,i){if(!e.call(t,n)){if(!i)return;Object.defineProperty(t,n,{value:u.create()})}return t[n]}function a(t,e){for(var i=0;i<e;++i)t[i]=255*Math.random()|0;return t}function s(){var e,i=(e=t,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e));i[6]=79&i[6]|64,i[8]=191&i[8]|128;for(var n="",r=0;r<t;++r){var o=i[r];4!==r&&6!==r&&8!==r||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}():WeakMap));function p(t,e,i){var n=f.get(t);if(m(n)){if(!i)return;n=new d,f.set(t,n)}var r=n.get(e);if(m(r)){if(!i)return;r=new d,n.set(e,r)}return r}function v(t,e,i){if(y(t,e,i))return!0;var n=A(e);return!_(n)&&v(t,n,i)}function y(t,e,i){var n=p(e,i,!1);return!m(n)&&!!n.has(t)}function g(t,e,i){if(y(t,e,i))return function(t,e,i){var n=p(e,i,!1);if(!m(n))return n.get(t)}(t,e,i);var n=A(e);return _(n)?void 0:g(t,n,i)}function m(t){return void 0===t}function _(t){return null===t}function b(t){return"object"==i(t)?null!==t:"function"==typeof t}function x(t,e){switch(function(t){if(null===t)return 1;switch(i(t)){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",o=function(t,e){var i=t[e];if(null!=i){if(!S(i))throw new TypeError;return i}}(t,r);if(void 0!==o){var a=o.call(t,n);if(b(a))throw new TypeError;return a}return function(t,e){if("string"===e){var i=t.toString;if(S(i)){var n=i.call(t);if(!b(n))return n}var r=t.valueOf;if(S(r)){var o=r.call(t);if(!b(o))return o}}else{var a=t.valueOf;if(S(a)){var s=a.call(t);if(!b(s))return s}var l=t.toString;if(S(l)){var u=l.call(t);if(!b(u))return u}}throw new TypeError}(t,"default"===n?"number":n)}function k(t){var e=x(t,3);return"symbol"==i(e)?e:function(t){return""+t}(e)}function S(t){return"function"==typeof t}function A(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c)return e;if(e!==c)return e;var i=t.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return e;var r=n.constructor;return"function"!=typeof r||r===t?e:r}function w(t){return t.__=void 0,delete t.__,t}t("defineMetadata",(function(t,e,i,n){if(!b(i))throw new TypeError;return r=t,o=e,void p(i,n,!0).set(r,o);var r,o})),t("hasMetadata",(function(t,e,i){if(!b(e))throw new TypeError;return m(i)||(i=k(i)),v(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!b(e))throw new TypeError;return m(i)||(i=k(i)),y(t,e,i)})),t("getMetadata",(function(t,e,i){if(!b(e))throw new TypeError;return m(i)||(i=k(i)),g(t,e,i)}))}((e=t,function(t,i){"function"!=typeof e[t]&&Object.defineProperty(e,t,{configurable:!0,writable:!0,value:i})})),t}({});function Na(t,e,i,n){!function(t,e,i,n){var r,o=[n],a={};Ha.hasOwnMetadata(t,e)&&(a=Ha.getMetadata(t,e));var s=a[i];void 0===s&&(s=[]),(r=s).push.apply(r,o),a[i]=s,Ha.defineMetadata(t,a,e)}(Fa,t,i.toString(),n)}function Va(t){return function(e,i,n){Na(e,0,n,t)}}function Ga(t){return function(e){return function(i,n,r){return Va(new ja(t,e))(i,n,r)}}}var Wa=Ga(Ia),Ua=Ga(Da);function Ya(){return function(t){return Ha.defineMetadata(za,null,t),t}}function Ka(t){return Va(new ja(Oa,t))}function Xa(t,e,i){return Xa=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&le(r,i.prototype),r},Xa.apply(null,arguments)}var Za,qa="Singleton",Ja="Transient",Qa="ConstantValue",$a="DynamicValue",ts="Factory",es="Function",is="Instance",ns="Invalid",rs=function(){function t(e,i){jt(this,t),this.id=Ba.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=i,this.type=ns,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}return zt(t,[{key:"clone",value:function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===qa&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}}]),t}(),os=function(){function t(){jt(this,t)}return zt(t,[{key:"getConstructorMetadata",value:function(t){return{compilerGeneratedMetadata:Ha.getMetadata(za,t),userGeneratedMetadata:Ha.getMetadata(Fa,t)||{}}}},{key:"getPropertiesMetadata",value:function(t){throw new Error("暂未实现")}}]),t}(),as=(Za=Oa,function(t){var e=function(e){if(null==e)return!1;if(e.key===Za&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;for(var i=e.constructorArgsMetadata,n=0;n<i.length;n++)if(i[n].key===Za&&i[n].value===t)return!0;return!1};return e.metaData=new ja(Za,t),e}),ss=function(){function t(e){jt(this,t),this._binding=e}return zt(t,[{key:"inRequestScope",value:function(){throw new Error("暂未实现")}},{key:"inSingletonScope",value:function(){return this._binding.scope=qa,this}},{key:"inTransientScope",value:function(){return this._binding.scope=Ja,this}},{key:"whenTargetNamed",value:function(t){return this._binding.constraint=as(t),this}}]),t}(),ls=function(){function t(e){jt(this,t),this._binding=e}return zt(t,[{key:"to",value:function(t){return this._binding.type=is,this._binding.implementationType=t,new ss(this._binding)}},{key:"toSelf",value:function(){var t=this._binding.serviceIdentifier;return this.to(t)}},{key:"toDynamicValue",value:function(t){return this._binding.type=$a,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new ss(this._binding)}},{key:"toConstantValue",value:function(t){return this._binding.type=Qa,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=qa,new ss(this._binding)}},{key:"toFactory",value:function(t){return this._binding.type=ts,this._binding.factory=t,this._binding.scope=qa,new ss(this._binding)}},{key:"toService",value:function(t){this.toDynamicValue((function(e){return e.container.get(t)}))}}]),t}(),us=function(){function t(e){jt(this,t);var i=e||{};i.defaultScope=i.defaultScope||Ja,this.options=i,this.id=Ba.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new os}return zt(t,[{key:"load",value:function(t){var e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}},{key:"get",value:function(t){var e=this._getNotAllArgs(t,!1);return this._get(e)}},{key:"getAll",value:function(t){var e=this._getAllArgs(t);return this._get(e)}},{key:"getTagged",value:function(t,e,i){var n=this._getNotAllArgs(t,!1,e,i);return this._get(n)}},{key:"getNamed",value:function(t,e){return this.getTagged(t,Oa,e)}},{key:"isBound",value:function(t){return this._bindingDictionary.has(t)}},{key:"bind",value:function(t){var e=this.options.defaultScope,i=new rs(t,e),n=this._bindingDictionary.get(t)||[];return n.push(i),this._bindingDictionary.set(t,n),new ls(i)}},{key:"unbind",value:function(t){this._bindingDictionary.delete(t)}},{key:"rebind",value:function(t){return this.unbind(t),this.bind(t)}},{key:"_getContainerModuleHelpersFactory",value:function(){var t=this,e=function(t,e){t._binding.moduleId=e},i=function(i){return function(n){var r=t.rebind(n);return e(r,i),r}};return function(n){return{bindFunction:(r=n,function(i){var n=t.bind(i);return e(n,r),n}),isboundFunction:function(e){return t.isBound(e)},rebindFunction:i(n),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(t){return null}};var r}}},{key:"_getNotAllArgs",value:function(t,e,i,n){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:n}}},{key:"_getAllArgs",value:function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}},{key:"_get",value:function(t){var e=this,i=[];return this._bindingDictionary.get(t.serviceIdentifier).filter((function(e){return e.constraint(t)})).forEach((function(t){i.push(e._resolveFromBinding(t))})),t.isMultiInject||1!==i.length?i:i[0]}},{key:"_getChildRequest",value:function(t){for(var e=this,i=t.implementationType,n=this._metadataReader.getConstructorMetadata(i).userGeneratedMetadata,r=Object.keys(n),o=[],a=function(){var t=n[s],i={};t.forEach((function(t){i[t.key]=t.value}));var r={inject:i[Ia],multiInject:i[Da]},a=r.inject||r.multiInject,l={serviceIdentifier:a,constructorArgsMetadata:t},u={injectIdentifier:a,metadata:t,bindings:e._bindingDictionary.get(a).filter((function(t){return t.constraint(l)}))};o.push(u)},s=0;s<r.length;s++)a();return o}},{key:"_resolveFromBinding",value:function(t){var e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}},{key:"_getResolvedFromBinding",value:function(t){var e;switch(t.type){case Qa:case es:e=t.cache;break;case is:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}},{key:"_resolveInstance",value:function(t,e){if(t.activated)return t.cache;var i=this._getChildRequest(t);return this._createInstance(e,i)}},{key:"_createInstance",value:function(t,e){return e.length?Xa(t,m(this._resolveRequests(e))):new t}},{key:"_resolveRequests",value:function(t){var e=this;return t.map((function(t){return t.bindings.length>1?t.bindings.map((function(t){return e._resolveFromBinding(t)})):e._resolveFromBinding(t.bindings[0])}))}},{key:"_saveToScope",value:function(t,e){t.scope===qa&&(t.cache=e,t.activated=!0)}}]),t}(),cs=Symbol("ContributionProvider"),hs=function(){function t(e,i){jt(this,t),this.serviceIdentifier=e,this.container=i}return zt(t,[{key:"getContributions",value:function(){var t;return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&(t=this.caches).push.apply(t,m(this.container.getAll(this.serviceIdentifier)))),this.caches}}]),t}();function ds(t,e){t(cs).toDynamicValue((function(t){var i=t.container;return new hs(e,i)})).inSingletonScope().whenTargetNamed(e)}var fs=function(){function t(e,i){jt(this,t),this._args=e,this.name=i,this.taps=[]}return zt(t,[{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"unTap",value:function(t,e){var i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter((function(t){return t.name!==i&&(!e||t.fn===e)})))}},{key:"_parseOptions",value:function(t,e,n){var r;if("string"==typeof e)r={name:e.trim()};else if("object"!=i(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof r.name||""===r.name)throw new Error("Missing name for tap");return r=Object.assign({type:t,fn:n},r)}},{key:"_tap",value:function(t,e,i){this._insert(this._parseOptions(t,e,i))}},{key:"_insert",value:function(t){var e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var i=0;"number"==typeof t.stage&&(i=t.stage);for(var n=this.taps.length;n>0;){n--;var r=this.taps[n];this.taps[n+1]=r;var o=r.stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(e.size>0)continue}if(!(o>i)){n++;break}}this.taps[n]=t}}]),t}();function ps(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var vs=function(t){ue(i,t);var e=ps(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.taps.map((function(t){return t.fn})).forEach((function(t){return t.apply(void 0,e)}))}}]),i}(fs),ys=Symbol.for("EnvContribution"),gs=Symbol.for("VGlobal"),ms=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},_s=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bs=function(t,e){return function(i,n){e(i,n,t)}},xs=function(){function t(e){jt(this,t),this.contributions=e,this.id=Ba.GenAutoIncrementId(),this.hooks={onSetEnv:new vs(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}return zt(t,[{key:"env",get:function(){return this._env}},{key:"devicePixelRatio",get:function(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}},{key:"supportEvent",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}},{key:"supportsTouchEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}},{key:"supportsPointerEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}},{key:"supportsMouseEvents",get:function(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents},set:function(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}},{key:"applyStyles",get:function(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles},set:function(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}},{key:"bindContribution",value:function(t){var e=this,i=[];if(this.contributions.getContributions().forEach((function(n){var r=n.configure(e,t);r&&r.then&&i.push(r)})),i.length)return Promise.all(i)}},{key:"getDynamicCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}},{key:"getStaticCanvasCount",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}},{key:"setEnv",value:function(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}},{key:"deactiveCurrentEnv",value:function(){this.envContribution&&this.envContribution.release()}},{key:"activeEnv",value:function(t,e){var i=this,n=this._env;this._env=t;var r=this.bindContribution(e);if(r&&r.then)return r.then((function(){i.envParams=e,i.hooks.onSetEnv.call(n,t,i)}));this.envParams=e,this.hooks.onSetEnv.call(n,t,this)}},{key:"setActiveEnvContribution",value:function(t){this.envContribution=t}},{key:"createCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}},{key:"createOffscreenCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}},{key:"releaseCanvas",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}},{key:"addEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}},{key:"getRequestAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}},{key:"getCancelAnimationFrame",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}},{key:"getElementById",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}},{key:"getRootElement",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}},{key:"getDocument",value:function(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}},{key:"mapToCanvasPoint",value:function(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}},{key:"loadImage",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}},{key:"loadSvg",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}},{key:"loadJson",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}},{key:"loadArrayBuffer",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}},{key:"loadBlob",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}},{key:"isChrome",value:function(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}},{key:"isSafari",value:function(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}},{key:"getNativeAABBBounds",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}},{key:"removeDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}},{key:"createDom",value:function(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}},{key:"getElementTop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}},{key:"getElementLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}},{key:"getElementTopLeft",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}}]),t}();xs=ms([Ya(),bs(0,Wa(cs)),bs(0,Ka(ys)),_s("design:paramtypes",[Object])],xs);var ks,Ss,As,ws,Ts,Ms,Cs,Es,Rs,Ps,Bs,Ls,Os,Is,Ds,Fs=Gt-1e-8,zs=function(){function t(e){jt(this,t),this.init(e)}return zt(t,[{key:"init",value:function(t){this.bounds=t}},{key:"arc",value:function(t,e,i,n,r,o){if(Math.abs(r-n)>Fs)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);var a,s,l,u,c=1/0,h=-1/0,d=1/0,f=-1/0;function p(t){l=i*Math.cos(t),u=i*Math.sin(t),l<c&&(c=l),l>h&&(h=l),u<d&&(d=u),u>f&&(f=u)}if(p(n),p(r),r!==n)if((n%=Gt)<0&&(n+=Gt),(r%=Gt)<0&&(r+=Gt),r<n&&(o=!o,a=n,n=r,r=a),o)for(r-=Gt,a=n-n%Vt,s=0;s<4&&a>r;++s,a-=Vt)p(a);else for(a=n-n%Vt+Vt,s=0;s<4&&a<r;++s,a+=Vt)p(a);this.bounds.add(t+c,e+d),this.bounds.add(t+h,e+f)}},{key:"arcTo",value:function(t,e,i,n,r){throw new Error("不支持arcTo")}},{key:"bezierCurveTo",value:function(t,e,i,n,r,o){this.bounds.add(t,e),this.bounds.add(i,n),this.bounds.add(r,o)}},{key:"closePath",value:function(){}},{key:"ellipse",value:function(){throw new Error("不支持ellipse")}},{key:"lineTo",value:function(t,e){this.bounds.add(t,e)}},{key:"moveTo",value:function(t,e){this.bounds.add(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(i,n)}},{key:"rect",value:function(t,e,i,n){this.bounds.add(t,e),this.bounds.add(t+i,e+n)}},{key:"clear",value:function(){this.bounds.clear()}},{key:"release",value:function(){}}]),t}(),js=function(){function t(){jt(this,t),this.curves=[],this.bounds=new ye}return zt(t,[{key:"getCurveLengths",value:function(){return this.curves.map((function(t){return t.getLength()}))}},{key:"getPointAt",value:function(t){return{x:0,y:0}}},{key:"getLength",value:function(){return 0}},{key:"getBounds",value:function(){return this.bounds}}]),t}(),Hs=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Ns={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},Vs={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function Gs(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=l*o,c=-s*a,h=s*o,d=l*a,f=Math.cos(n),p=Math.sin(n),v=Math.cos(r),y=Math.sin(r),g=.5*(r-n),m=Math.sin(.5*g),_=8/3*m*m/Math.sin(g),b=e+f-_*p,x=i+p+_*f,k=e+v,S=i+y,A=k+_*y,w=S-_*v;return[u*b+c*x,h*b+d*x,u*A+c*w,h*A+d*w,u*k+c*S,h*k+d*S]}function Ws(t,e,i,n){for(var r=function(t,e,i,n,r,o,a,s,l){var u=ge(a),c=Math.sin(u),h=Math.cos(u),d=h*(s-t)*.5+c*(l-e)*.5,f=h*(l-e)*.5-c*(s-t)*.5,p=d*d/((i=Math.abs(i))*i)+f*f/((n=Math.abs(n))*n);p>1&&(i*=p=Math.sqrt(p),n*=p);var v=h/i,y=c/i,g=-c/n,m=h/n,_=v*s+y*l,b=g*s+m*l,x=v*t+y*e,k=g*t+m*e,S=1/((x-_)*(x-_)+(k-b)*(k-b))-.25;S<0&&(S=0);var A=Math.sqrt(S);o===r&&(A=-A);var w=.5*(_+x)-A*(k-b),T=.5*(b+k)+A*(x-_),M=Math.atan2(b-T,_-w),C=Math.atan2(k-T,x-w)-M;C<0&&1===o?C+=Gt:C>0&&0===o&&(C-=Gt);for(var E=Math.ceil(Math.abs(C/(Vt+.001))),R=[],P=0;P<E;++P){var B=M+P*C/E,L=M+(P+1)*C/E;R[P]=[w,T,B,L,i,n,c,h]}return R}(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,i),o=0;o<r.length;++o){var a=Gs(r[o]);t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}!function(t){t[t.NONE=0]="NONE",t[t.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",t[t.UPDATE_SHAPE=2]="UPDATE_SHAPE",t[t.CLEAR_SHAPE=253]="CLEAR_SHAPE",t[t.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",t[t.INIT=179]="INIT",t[t.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",t[t.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",t[t.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",t[t.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",t[t.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",t[t.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",t[t.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",t[t.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"}(Cs||(Cs={})),function(t){t[t.GLOBAL=1]="GLOBAL",t[t.LOCAL=16]="LOCAL",t[t.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",t[t.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"}(Es||(Es={})),function(t){t[t.INIT=0]="INIT",t[t.DEFAULT=1]="DEFAULT",t[t.STATE=2]="STATE",t[t.ANIMATE_BIND=10]="ANIMATE_BIND",t[t.ANIMATE_PLAY=11]="ANIMATE_PLAY",t[t.ANIMATE_START=12]="ANIMATE_START",t[t.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",t[t.ANIMATE_END=14]="ANIMATE_END",t[t.TRANSLATE=20]="TRANSLATE",t[t.TRANSLATE_TO=21]="TRANSLATE_TO",t[t.SCALE=22]="SCALE",t[t.SCALE_TO=23]="SCALE_TO",t[t.ROTATE=24]="ROTATE",t[t.ROTATE_TO=25]="ROTATE_TO"}(Rs||(Rs={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSED=2]="PAUSED",t[t.END=3]="END"}(Ps||(Ps={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.SET_ATTR_IMMEDIATELY=1]="SET_ATTR_IMMEDIATELY"}(Bs||(Bs={})),function(t){t.wait="wait",t.from="from",t.to="to",t.customAnimate="customAnimate"}(Ls||(Ls={})),function(t){t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN"}(Os||(Os={})),function(t){t[t.CubicBezierCurve=0]="CubicBezierCurve",t[t.QuadraticBezierCurve=1]="QuadraticBezierCurve",t[t.ArcCurve=2]="ArcCurve",t[t.LineCurve=3]="LineCurve",t[t.EllipseCurve=4]="EllipseCurve",t[t.MoveCurve=5]="MoveCurve"}(Is||(Is={})),function(t){t[t.beforeFillStroke=0]="beforeFillStroke",t[t.afterFillStroke=1]="afterFillStroke"}(Ds||(Ds={}));var Us=function(t,e,i,n,r,o,a){var s=Math.abs(i-e),l=4*Math.tan(s/4)/3,u=i<e?-1:1,c=Math.cos(e),h=Math.sin(e),d=Math.cos(i),f=Math.sin(i),p=c*o+n,v=h*a+r,y=d*o+n,g=f*a+r,m=o*l*u,_=a*l*u;t.push(p-m*h,v+_*c,y+m*f,g-_*d,y,g)},Ys=[function(t,e,i,n,r,o,a){return e.arc(t[1]*r+i,t[2]*o+n,t[3]*(r+o)/2,t[4],t[5],t[6],a)},function(t,e,i,n,r,o,a){return e.arcTo(t[1]*r+i,t[2]*o+n,t[3]*r+i,t[4]*o+n,t[5]*(r+o)/2,a)},function(t,e,i,n,r,o,a){return e.bezierCurveTo(t[1]*r+i,t[2]*o+n,t[3]*r+i,t[4]*o+n,t[5]*r+i,t[6]*o+n,a)},function(t,e,i,n){return e.closePath()},function(t,e,i,n,r,o){return e.ellipse(t[1]*r+i,t[2]*o+n,t[3]*r,t[4]*o,t[5],t[6],t[7],t[8])},function(t,e,i,n,r,o,a){return e.lineTo(t[1]*r+i,t[2]*o+n,a)},function(t,e,i,n,r,o,a){return e.moveTo(t[1]*r+i,t[2]*o+n,a)},function(t,e,i,n,r,o,a){return e.quadraticCurveTo(t[1]*r+i,t[2]*o+n,t[3]*r+i,t[4]*o+n,a)},function(t,e,i,n,r,o,a){return e.rect(t[1]*r+i,t[2]*o+n,t[3]*r,t[4]*o,a)}];function Ks(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,s=0;s<t.length;s++){var l=t[s];Ys[l[0]](l,e,i,n,r,o,a)}}function Xs(){return Xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=de(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},Xs.apply(this,arguments)}var Zs=function(){function t(){jt(this,t)}return zt(t,[{key:"getLength",value:function(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}]),t}();function qs(t,e,i,n,r){return function(t,e){for(var i=0,n=t.length,r=0;r<n;r++){var o=t[r],a=e[r],s=t[(r+1)%n],l=e[(r+1)%n];i+=se.distanceNN(o,a,s,l)}return i/2}([t.x,e.x,i.x,n.x],[t.y,e.y,i.y,n.y])}function Js(t,e,i,n,r){var o=1-r;return o*o*o*t+3*e*r*o*o+3*i*r*r*o+n*r*r*r}function Qs(t,e,i,n,r){var o=Js(t.x,e.x,i.x,n.x,r),a=Js(t.y,e.y,i.y,n.y,r);return new ae(o,a)}function $s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function tl(t,e){var i=t.p0,n=t.p1,r=t.p2,o=t.p3,a=Qs(i,n,r,o,e),s=se.pointAtPP(i,n,e),l=se.pointAtPP(n,r,e),u=se.pointAtPP(r,o,e),c=se.pointAtPP(s,l,e),h=se.pointAtPP(l,u,e);return[new el(i,s,c,a),new el(a,h,u,o)]}var el=function(t){ue(i,t);var e=$s(i);function i(t,n,r,o){var a;return jt(this,i),(a=e.call(this)).type=Is.CubicBezierCurve,a.p0=t,a.p1=n,a.p2=r,a.p3=o,a}return zt(i,[{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}},{key:"getPointAt",value:function(t){if(!1!==this.defined)return Qs(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}},{key:"calcLength",value:function(){return this._validPoint()?qs(this.p0,this.p1,this.p2,this.p3):60}},{key:"calcProjLength",value:function(t){return t===Os.ROW?Ut(this.p0.x-this.p3.x):t===Os.COLUMN?Ut(this.p0.y-this.p3.y):0}},{key:"getAngleAt",value:function(t){var e=Xt(t-.01,0),i=Zt(t+.01,1),n=this.getPointAt(e),r=this.getPointAt(i);return Yt(r.y-n.y,r.x-n.x)}}]),i}(Zs);function il(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function nl(t,e){var i=t.p0,n=t.p1,r=se.pointAtPP(i,n,e);return[new rl(i,r),new rl(r,n)]}var rl=function(t){ue(i,t);var e=il(i);function i(t,n){var r;return jt(this,i),(r=e.call(this)).type=Is.LineCurve,r.p0=t,r.p1=n,r}return zt(i,[{key:"getPointAt",value:function(t){if(!1!==this.defined)return se.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}},{key:"getAngleAt",value:function(t){return null==this.angle&&(this.angle=Yt(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}},{key:"_validPoint",value:function(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}},{key:"calcLength",value:function(){return this._validPoint()?se.distancePP(this.p0,this.p1):60}},{key:"calcProjLength",value:function(t){return t===Os.ROW?Ut(this.p0.x-this.p1.x):t===Os.COLUMN?Ut(this.p0.y-this.p1.y):0}}]),i}(Zs);function ol(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var al=function(){function t(e,i){jt(this,t),this.init(e,i)}return zt(t,[{key:"endX",get:function(){return this._lastX}},{key:"endY",get:function(){return this._lastY}},{key:"init",value:function(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}},{key:"bezierCurveTo",value:function(t,e,i,n,r,o,a,s){var l=new el(new ae(this._lastX,this._lastY),new ae(t,e),new ae(i,n),new ae(r,o));l.originP1=this._lastOriginP,l.originP2=s,l.defined=a,this.curves.push(l),this._lastX=r,this._lastY=o,this._lastOriginP=s}},{key:"closePath",value:function(){if(!(this.curves.length<2)){var t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}}},{key:"ellipse",value:function(){throw new Error("SegContext不支持调用ellipse")}},{key:"lineTo",value:function(t,e,i,n){var r=this.addLinearCurve(t,e,i,this._lastOriginP,n);this.curves.push(r),this._lastX=t,this._lastY=e,this._lastOriginP=n}},{key:"moveTo",value:function(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}},{key:"quadraticCurveTo",value:function(t,e,i,n){throw new Error("SegContext不支持调用quadraticCurveTo")}},{key:"clear",value:function(){this.curves=[],this.length=NaN}},{key:"tryUpdateLength",value:function(t){return this.getLength(t)}},{key:"addLinearCurve",value:function(t,e,i,n,r){var o=new rl(new ae(this._lastX,this._lastY),new ae(t,e));return o.originP1=n,o.originP2=r,o.defined=i,o}},{key:"getPointAt",value:function(t){throw new Error("暂未实现")}},{key:"getCurveLengths",value:function(){return[]}},{key:"getLength",value:function(t){var e,i;if(t===Os.COLUMN){if(!this.curves.length)return 0;var n=this.curves[0],r=this.curves[this.curves.length-1],o=null!==(e=r.p3)&&void 0!==e?e:r.p1;return Ut(n.p0.y-o.y)}if(t===Os.ROW){if(!this.curves.length)return 0;var a=this.curves[0],s=this.curves[this.curves.length-1],l=null!==(i=s.p3)&&void 0!==i?i:s.p1;return Ut(a.p0.x-l.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((function(t,e){return t+e.getLength()}),0)),this.length}}]),t}(),sl=function(t){ue(i,t);var e=ol(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"bezierCurveTo",value:function(t,e,n,r,o,a,s,l){return Xs(de(i.prototype),"bezierCurveTo",this).call(this,e,t,r,n,a,o,s,l)}},{key:"lineTo",value:function(t,e,n,r){return Xs(de(i.prototype),"lineTo",this).call(this,e,t,n,r)}},{key:"moveTo",value:function(t,e,n){return Xs(de(i.prototype),"moveTo",this).call(this,e,t,n)}},{key:"clear",value:function(){return Xs(de(i.prototype),"clear",this).call(this)}}]),i}(al);function ll(t,e){for(var i=!1,n=0,r=e.length;n<=r;n++)n>=r===i&&((i=!i)?t.lineStart():t.lineEnd()),i&&t.point(e[n])}function ul(t,e,i){var n=null!=e?e:Ut(i[i.length-1].x-i[0].x)>Ut(i[i.length-1].y-i[0].y)?Os.ROW:Os.COLUMN;return"monotoneY"===t?new sl(t,n):new al(t,n)}var cl=function(){function t(e,i){jt(this,t),this.context=e,i&&(this.startPoint=i)}return zt(t,[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}]),t}();function hl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=ul("linear",i,t);return function(t,e){ll(t,e)}(new cl(r,n),t),r}function dl(t,e,i,n,r){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,n,t.lastPoint1)}var fl=function(){function t(e,i){jt(this,t),this.context=e,this.startPoint=i}return zt(t,[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){2===this._point&&dl(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:dl(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}]),t}();function pl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return hl(t,e);var r=ul("basis",i,t);return function(t,e){ll(t,e)}(new fl(r,n),t),r}function vl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function yl(t){return t<0?-1:1}function gl(t,e,i){var n=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(n||Number(r<0&&-0)),a=(i-t._y1)/(r||Number(n<0&&-0)),s=(o*r+a*n)/(n+r);return(yl(o)+yl(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function ml(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function _l(t,e,i,n,r){var o=t._x0,a=t._y0,s=t._x1,l=t._y1,u=(s-o)/3;t.context.bezierCurveTo(o+u,a+u*e,s-u,l-u*i,s,l,n,t.lastPoint1)}var bl=function(){function t(e,i){jt(this,t),this.context=e,this.startPoint=i}return zt(t,[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:_l(this,this._t0,ml(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}},{key:"point",value:function(t){var e=NaN,i=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,n,t);break;case 1:this._point=2;break;case 2:this._point=3,_l(this,ml(this,e=gl(this,i,n)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2);break;default:_l(this,this._t0,e=gl(this,i,n),!1!==this._lastDefined1&&!1!==this._lastDefined2)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}]),t}(),xl=function(t){ue(i,t);var e=vl(i);function i(t,n){return jt(this,i),e.call(this,t,n)}return zt(i,[{key:"point",value:function(t){return Xs(de(i.prototype),"point",this).call(this,{y:t.x,x:t.y,defined:t.defined})}}]),i}(bl);function kl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return hl(t,e);var r=ul("monotoneX",i,t);return function(t,e){ll(t,e)}(new bl(r,n),t),r}function Sl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;if(t.length<3-Number(!!n))return hl(t,e);var r=ul("monotoneY",i,t);return function(t,e){ll(t,e)}(new xl(r,n),t),r}var Al=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;jt(this,t),this.context=e,this._t=i,this.startPoint=n}return zt(t,[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}},{key:"lineEnd",value:function(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}},{key:"point",value:function(t){var e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{var n=this._x*(1-this._t)+e*this._t;this.context.lineTo(n,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(n,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}},{key:"tryUpdateLength",value:function(){return this.context.tryUpdateLength()}}]),t}();function wl(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.direction,r=i.startPoint;if(t.length<2-Number(!!r))return null;var o=new al("step",null!=n?n:Ut(t[t.length-1].x-t[0].x)>Ut(t[t.length-1].y-t[0].y)?Os.ROW:Os.COLUMN);return function(t,e){ll(t,e)}(new Al(o,e,r),t),o}function Tl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Ml=function(t){ue(i,t);var e=Tl(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"lineEnd",value:function(){this.context.closePath()}}]),i}(cl);function Cl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.direction,n=e.startPoint;if(t.length<2-Number(!!n))return null;var r=ul("linear",i,t);return function(t,e){ll(t,e)}(new Ml(r,n),t),r}function El(t,e,i){switch(e){case"linear":default:return hl(t,i);case"basis":return pl(t,i);case"monotoneX":return kl(t,i);case"monotoneY":return Sl(t,i);case"step":return wl(t,.5,i);case"stepBefore":return wl(t,0,i);case"stepAfter":return wl(t,1,i);case"linearClosed":return Cl(t,i)}}function Rl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Pl=function(t){ue(i,t);var e=Rl(i);function i(t){var n;return jt(this,i),(n=e.call(this)).commandList=[],t&&(n._ctx=t),n._boundsContext=new zs(n.bounds),n}return zt(i,[{key:"setCtx",value:function(t){this._ctx=t}},{key:"moveTo",value:function(t,e){return this.commandList.push([Vs.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}},{key:"lineTo",value:function(t,e){return this.commandList.push([Vs.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}},{key:"quadraticCurveTo",value:function(t,e,i,n){return this.commandList.push([Vs.Q,t,e,i,n]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,n),this}},{key:"bezierCurveTo",value:function(t,e,i,n,r,o){return this.commandList.push([Vs.C,t,e,i,n,r,o]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,n,r,o),this}},{key:"arcTo",value:function(t,e,i,n,r){return this.commandList.push([Vs.AT,t,e,i,n,r]),this._ctx&&this._ctx.arcTo(t,e,i,n,r),this}},{key:"ellipse",value:function(t,e,i,n,r,o,a,s){return this.commandList.push([Vs.E,t,e,i,n,r,o,a,s]),this._ctx&&this._ctx.ellipse(t,e,i,n,r,o,a,s),this}},{key:"rect",value:function(t,e,i,n){return this.commandList.push([Vs.R,t,e,i,n]),this._ctx&&this._ctx.rect(t,e,i,n),this}},{key:"arc",value:function(t,e,i,n,r,o){return this.commandList.push([Vs.A,t,e,i,n,r,o]),this._ctx&&this._ctx.arc(t,e,i,n,r,o),this}},{key:"closePath",value:function(){return this.commandList.push([Vs.Z]),this._ctx&&this._ctx.closePath(),this}},{key:"addCurve",value:function(t){this.curves.push(t)}},{key:"clear",value:function(){this.transformCbList=null,this.commandList.length=0,this.curves.length=0}},{key:"toString",value:function(){if(!this.toStringCbList){var t=[];t[Vs.M]=function(t){return"M".concat(t[1]," ").concat(t[2])},t[Vs.L]=function(t){return"L".concat(t[1]," ").concat(t[2])},t[Vs.Q]=function(t){return"Q".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4])},t[Vs.C]=function(t){return"C".concat(t[1]," ").concat(t[2]," ").concat(t[3]," ").concat(t[4]," ").concat(t[5]," ").concat(t[6])},t[Vs.A]=function(t){var e=[];Us(e,t[4],t[5],t[1],t[2],t[3],t[3]);for(var i="",n=0;n<e.length;n+=6)i+="C".concat(e[n]," ").concat(e[n+1]," ").concat(e[n+2]," ").concat(e[n+3]," ").concat(e[n+4]," ").concat(e[n+5]);return i},t[Vs.Z]=function(t){return"Z"},this.toStringCbList=t}var e=this.toStringCbList,i="";return this.commandList.forEach((function(t){i+=e[t[0]](t)})),i}},{key:"fromString",value:function(t,e,i,n,r){this.clear();var o=function(t){if(!t)return[];var e,i,n=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===n)return[];for(var r=[],o=0,a=n.length;o<a;o++)if(ks=n[o],Ss=ks.slice(1),e=[As=ks[0]],null!==(i=Ss.match(Hs))){for(var s=0,l=i.length;s<l;s++)ws=i[s],Ts=parseFloat(ws),Number.isNaN(Ts)||e.push(Ts);if(Ms=Ns[As],e.length-1>Ms)for(var u=void 0,c=1,h=e.length;c<h;c+=Ms){u=[As];for(var d=c,f=c+Ms;d<f;d++)u.push(e[d]);r.push(u)}else r.push(e)}else r.push(e);return r}(t);return this._runCommandStrList(o,e,i,n,r),this._updateBounds(),this}},{key:"fromLine",value:function(t){var e=t.attribute,i=e.points,n=e.curveType,r=e.clipRangeByDimension;if(i){var o=El(i,n);"x"===r?this.direction=Os.ROW:"y"===r?this.direction=Os.COLUMN:"auto"===r&&(this.direction=o.direction),this.curves=o.curves}}},{key:"fromCustomPath2D",value:function(t,e,i,n,r){return this.clear(),this._runCommandList(t.commandList,e,i,n,r),this._updateBounds(),this}},{key:"transform",value:function(t,e,i,n){var r=this,o=this.commandList;if(!this.transformCbList){var a=[];a[Vs.M]=this.moveToTransform,a[Vs.L]=this.lineToTransform,a[Vs.Q]=this.quadraticCurveToTransform,a[Vs.C]=this.bezierCurveToTransform,a[Vs.AT]=this.arcToTransform,a[Vs.E]=this.ellipseTransform,a[Vs.R]=this.rectTransform,a[Vs.A]=this.arcTransform,a[Vs.Z]=this.closePathTransform,this.transformCbList=a}o.forEach((function(o){r.transformCbList[o[0]](o,t,e,i,n)})),this._updateBounds()}},{key:"moveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"lineToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i}},{key:"quadraticCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i}},{key:"bezierCurveToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*n+e,t[6]=t[6]*r+i}},{key:"arcToTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n+e,t[4]=t[4]*r+i,t[5]=t[5]*(n+r)/2}},{key:"ellipseTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"rectTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*n,t[4]=t[4]*r}},{key:"arcTransform",value:function(t,e,i,n,r){t[1]=t[1]*n+e,t[2]=t[2]*r+i,t[3]=t[3]*(n+r)/2}},{key:"closePathTransform",value:function(){}},{key:"_runCommandStrList",value:function(t){for(var e,i,n,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=null,h=0,d=0,f=0,p=0,v=0,y=t.length;v<y;++v){switch(e=t[v],1===l&&1===u||(e=Ll(e,l,u)),e[0]){case"l":h+=e[1],d+=e[2],this.lineTo(h+a,d+s);break;case"L":h=e[1],d=e[2],this.lineTo(h+a,d+s);break;case"h":h+=e[1],this.lineTo(h+a,d+s);break;case"H":h=e[1],this.lineTo(h+a,d+s);break;case"v":d+=e[1],this.lineTo(h+a,d+s);break;case"V":d=e[1],this.lineTo(h+a,d+s);break;case"m":h+=e[1],d+=e[2],this.moveTo(h+a,d+s);break;case"M":h=e[1],d=e[2],this.moveTo(h+a,d+s);break;case"c":i=h+e[5],n=d+e[6],f=h+e[3],p=d+e[4],this.bezierCurveTo(h+e[1]+a,d+e[2]+s,f+a,p+s,i+a,n+s),h=i,d=n;break;case"C":h=e[5],d=e[6],f=e[3],p=e[4],this.bezierCurveTo(e[1]+a,e[2]+s,f+a,p+s,h+a,d+s);break;case"s":i=h+e[3],n=d+e[4],f=2*h-f,p=2*d-p,this.bezierCurveTo(f+a,p+s,h+e[1]+a,d+e[2]+s,i+a,n+s),f=h+e[1],p=d+e[2],h=i,d=n;break;case"S":i=e[3],n=e[4],f=2*h-f,p=2*d-p,this.bezierCurveTo(f+a,p+s,e[1]+a,e[2]+s,i+a,n+s),h=i,d=n,f=e[1],p=e[2];break;case"q":i=h+e[3],n=d+e[4],f=h+e[1],p=d+e[2],this.quadraticCurveTo(f+a,p+s,i+a,n+s),h=i,d=n;break;case"Q":i=e[3],n=e[4],this.quadraticCurveTo(e[1]+a,e[2]+s,i+a,n+s),h=i,d=n,f=e[1],p=e[2];break;case"t":i=h+e[1],n=d+e[2],null===c[0].match(/[QqTt]/)?(f=h,p=d):"t"===c[0]?(f=2*h-r,p=2*d-o):"q"===c[0]&&(f=2*h-f,p=2*d-p),r=f,o=p,this.quadraticCurveTo(f+a,p+s,i+a,n+s),d=n,f=(h=i)+e[1],p=d+e[2];break;case"T":i=e[1],n=e[2],f=2*h-f,p=2*d-p,this.quadraticCurveTo(f+a,p+s,i+a,n+s),h=i,d=n;break;case"a":Ws(this,h+a,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+h+a,e[7]+d+s]),h+=e[6],d+=e[7];break;case"A":Ws(this,h+a,d+s,[e[1],e[2],e[3],e[4],e[5],e[6]+a,e[7]+s]),h=e[6],d=e[7];break;case"z":case"Z":this.closePath()}c=e}}},{key:"_runCommandList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(0!==e||0!==i||1!==n||1!==r)for(var o=0,a=t.length;o<a;++o){var s=t[o].slice();switch(s[0]){case Vs.L:this.lineToTransform(s,e,i,n,r);break;case Vs.M:this.moveToTransform(s,e,i,n,r);break;case Vs.C:this.bezierCurveToTransform(s,e,i,n,r);break;case Vs.Q:this.quadraticCurveToTransform(s,e,i,n,r);break;case Vs.A:this.arcToTransform(s,e,i,n,r);break;case Vs.E:this.ellipseTransform(s,e,i,n,r);break;case Vs.R:this.rectTransform(s,e,i,n,r);break;case Vs.AT:this.arcToTransform(s,e,i,n,r);break;case Vs.Z:this.closePath()}}else this.commandList=t.map((function(t){return t.slice()}))}},{key:"_updateBounds",value:function(){this.bounds.clear(),Ks(this.commandList,this._boundsContext)}},{key:"release",value:function(){this.commandList=[],this._boundsContext=null,this._ctx=null}},{key:"getLength",value:function(){if(this.direction===Os.COLUMN){if(!this.curves.length)return 0;var t=this.curves[0],e=this.curves[this.curves.length-1];return Ut(t.p0.y-e.p1.y)}if(this.direction===Os.ROW){if(!this.curves.length)return 0;var i=this.curves[0],n=this.curves[this.curves.length-1];return Ut(i.p0.x-n.p1.x)}return this.curves.reduce((function(t,e){return t+e.getLength()}),0)}},{key:"getAttrAt",value:function(t){if(!this.curves)return{pos:{x:0,y:0},angle:0};for(var e,i=0,n=0;n<this.curves.length;n++){var r=(e=this.curves[n]).getLength(this.direction);if(i+r>=t)break;i+=r}var o=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(o),angle:e.getAngleAt(o)}}}]),i}(js),Bl=["l",0,0,0,0,0,0,0];function Ll(t,e,i){var n=Bl[0]=t[0];if("a"===n||"A"===n)Bl[1]=e*t[1],Bl[2]=i*t[2],Bl[3]=t[3],Bl[4]=t[4],Bl[5]=t[5],Bl[6]=e*t[6],Bl[7]=i*t[7];else if("h"===n||"H"===n)Bl[1]=e*t[1];else if("v"===n||"V"===n)Bl[1]=i*t[1];else for(var r=1,o=t.length;r<o;++r)Bl[r]=(r%2==1?e:i)*t[r];return Bl}var Ol={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new ke},Il={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},Dl={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},Fl=Object.assign({outerBorder:Object.assign(Object.assign({},Dl),{distance:0}),innerBorder:Object.assign(Object.assign({},Dl),{distance:0})},Dl),zl={text:"",maxLineWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",disableAutoClipedPoptip:void 0},jl=Object.assign(Object.assign(Object.assign(Object.assign({opacity:1,background:null,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,blur:0,cursor:null,html:null},Il),Fl),{alignSelf:"auto"}),{pickStrokeBuffer:0}),Hl={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},Nl=Object.assign(Object.assign(Object.assign({strokeSeg:null,pickable:!0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden"},{_debug_bounds:!1}),jl),Ol),Vl=Object.assign(Object.assign({},Nl),{startAngle:0,endAngle:Wt,innerRadius:0,outerRadius:1,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),Gl=Object.assign(Object.assign(Object.assign({},Nl),Hl),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1}),Wl=Object.assign(Object.assign({},Nl),{radius:1,startAngle:0,endAngle:Wt}),Ul=Object.assign(Object.assign({},Nl),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start"}),Yl=Object.assign(Object.assign({},Nl),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),Kl=Object.assign(Object.assign(Object.assign({},Nl),Hl),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1}),Xl=Object.assign(Object.assign({},Nl),{path:new Pl,customPath:function(){gi.getInstance().warn("空函数")}}),Zl=Object.assign(Object.assign({},Nl),{points:[],cornerRadius:0,closePath:!0}),ql=Object.assign(Object.assign({},Nl),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0}),Jl=Object.assign(Object.assign({},Nl),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0}),Ql=Object.assign(Object.assign({},Nl),{symbolType:"circle",size:10,keepDirIn3d:!0}),$l=Object.assign(Object.assign(Object.assign({},Nl),zl),{strokeBoundsBuffer:0,keepDirIn3d:!0}),tu=Object.assign(Object.assign({},Nl),{width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],maxHeight:void 0,maxWidth:void 0,singleLine:!1}),eu=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0},Nl),{fill:!0,cornerRadius:0}),iu=Object.assign(Object.assign({},eu),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),nu=new(zt((function t(){jt(this,t)}))),ru={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},ou=!0,au=!1,su=/\w|\(|\)|-/,lu=/[.?!,;:/，。？！、；：]/,uu=/\S/;function cu(t,e,i,n,r){if(!e||e<=0)return 0;for(var o=nu.graphicUtil.textMeasure,a=n,s=t.slice(0,a),l=Math.floor(o.measureText(s,i).width),u=t.slice(0,a+1),c=Math.floor(o.measureText(u,i).width);l>e||c<=e;){if(l>e?a--:a++,a>t.length){a=t.length;break}if(a<0){a=0;break}s=t.slice(0,a),l=Math.floor(o.measureText(s,i).width),u=t.slice(0,a+1),c=Math.floor(o.measureText(u,i).width)}return r&&(a=hu(t,a)),a}function hu(t,e){for(var i=e;su.test(t[i-1])&&su.test(t[i])||lu.test(t[i]);)if(--i<=0)return e;return i}function du(t,e){var i=nu.graphicUtil.textMeasure.measureText(t,e),n={ascent:0,height:0,descent:0,width:0};return"number"!=typeof i.actualBoundingBoxAscent||"number"!=typeof i.actualBoundingBoxDescent?(n.width=Math.floor(i.width),n.height=e.fontSize||0,n.ascent=n.height,n.descent=0):(n.width=Math.floor(i.width),n.height=Math.floor(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent),n.ascent=Math.floor(i.actualBoundingBoxAscent),n.descent=n.height-n.ascent),n}var fu=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},pu=function(){function t(){jt(this,t)}return zt(t,[{key:"configure",value:function(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}},{key:"measureTextWidth",value:function(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t).width):this.estimate(t,e).width}},{key:"estimate",value:function(t,e){for(var i=e.fontSize,n=void 0===i?$l.fontSize:i,r=0,o=0,a=0;a<t.length;a++)t.charCodeAt(a)<128?r++:o++;return{width:~~(.8*r*n+o*n),height:n}}},{key:"measureTextPixelHeight",value:function(t,e){var i;if(!this.context)return null!==(i=e.fontSize)&&void 0!==i?i:zl.fontSize;this.context.setTextStyleWithoutAlignBaseline(e);var n=this.context.measureText(t);return Math.abs(n.actualBoundingBoxAscent-n.actualBoundingBoxDescent)}},{key:"measureTextBoundHieght",value:function(t,e){var i;if(!this.context)return null!==(i=e.fontSize)&&void 0!==i?i:zl.fontSize;this.context.setTextStyleWithoutAlignBaseline(e);var n=this.context.measureText(t);return Math.abs(n.fontBoundingBoxAscent-n.fontBoundingBoxDescent)}},{key:"measureText",value:function(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}},{key:"clipTextVertical",value:function(t,e,i,n){var r=this;if(0===t.length)return{verticalList:t,width:0};var o=e.fontSize,a=void 0===o?12:o;t.forEach((function(t){t.width=0===t.direction?a:r.measureTextWidth(t.text,e)}));for(var s=[],l=0,u=0;u<t.length&&l+t[u].width<i;u++)l+=t[u].width,s.push(t[u]);if(t[u]&&t[u].text.length>1){var c=this._clipText(t[u].text,e,i-l,0,t[u].text.length-1,"end",!1);if(n&&c.str!==t[u].text){for(var h="",d=0,f=0;f<u;f++){var p=t[f];h+=p.text,d+=p.text.length}var v=hu(h+=t[u].text,d+c.str.length);(v-=d)!==c.str.length-1&&(c.str=c.str.substring(0,v),c.width=this.measureTextWidth(c.str,e))}s.push(Object.assign(Object.assign({},t[u]),{text:c.str,width:c.width})),l+=c.width}return{verticalList:s,width:l}}},{key:"clipText",value:function(t,e,i,n){if(0===t.length)return{str:"",width:0};var r=this.measureTextWidth(t,e);if(r<=i)return{str:t,width:r};if((r=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};var o=this._clipText(t,e,i,0,t.length-1,"end",!1);if(n&&o.str!==t){var a=hu(t,o.str.length);a!==o.str.length&&(o.str=t.substring(0,a),o.width=this.measureTextWidth(o.str,e))}return o}},{key:"_clipText",value:function(t,e,i,n,r,o,a){var s;if("start"===o)s=this._clipTextStart(t,e,i,n,r),a&&(s.result=a+s.str);else if("middle"===o){var l=this._clipTextMiddle(t,e,i,"","",0,0,1);s={str:"none",width:l.width,result:l.left+a+l.right}}else s=this._clipTextEnd(t,e,i,n,r),a&&(s.result=s.str+a);return s}},{key:"_clipTextEnd",value:function(t,e,i,n,r){var o,a=Math.floor((n+r)/2),s=t.substring(0,a+1),l=this.measureTextWidth(s,e);if(l>i){if(s.length<=1)return{str:"",width:0};var u=t.substring(0,a);return(o=this.measureTextWidth(u,e))<=i?{str:u,width:o}:this._clipTextEnd(t,e,i,n,a)}if(l<i){if(a>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};var c=t.substring(0,a+2);return(o=this.measureTextWidth(c,e))>=i?{str:s,width:l}:this._clipTextEnd(t,e,i,a,r)}return{str:s,width:l}}},{key:"_clipTextStart",value:function(t,e,i,n,r){var o,a=Math.ceil((n+r)/2),s=t.substring(a-1,t.length-1),l=this.measureTextWidth(s,e);if(l>i){if(s.length<=1)return{str:"",width:0};var u=t.substring(a,t.length-1);return(o=this.measureTextWidth(u,e))<=i?{str:u,width:o}:this._clipTextStart(t,e,i,a,t.length-1)}if(l<i){if(a<=0)return{str:t,width:this.measureTextWidth(t,e)};var c=t.substring(a-2,t.length-1);return(o=this.measureTextWidth(c,e))>=i?{str:s,width:l}:this._clipTextStart(t,e,i,n,a)}return{str:s,width:l}}},{key:"_clipTextMiddle",value:function(t,e,i,n,r,o,a,s){var l=t.substring(0,s),u=this.measureTextWidth(l,e);if(u+a>i)return{left:n,right:r,width:o+a};var c=t.substring(t.length-s,t.length),h=this.measureTextWidth(c,e);return u+h>i?{left:l,right:r,width:u+a}:this._clipTextMiddle(t,e,i,l,c,u,h,s+1)}},{key:"clipTextWithSuffixVertical",value:function(t,e,i,n,r,o){if(""===n)return this.clipTextVertical(t,e,i,r);if(0===t.length)return{verticalList:t,width:0};var a=this.clipTextVertical(t,e,i,r);if(a.verticalList.length===t.length&&a.verticalList[a.verticalList.length-1].width===t[t.length-1].width)return a;var s,l=this.measureTextWidth(n,e);if(l>i)return a;if(i-=l,"start"===o){var u=this.revertVerticalList(t);s=this.clipTextVertical(u,e,i,r);var c=this.revertVerticalList(s.verticalList);c.unshift({text:n,direction:1,width:l}),s.verticalList=c}else if("middle"===o){var h=this.clipTextVertical(t,e,i/2,r),d=this.revertVerticalList(t),f=this.clipTextVertical(d,e,i/2,r);h.verticalList.push({text:n,direction:1,width:l}),this.revertVerticalList(f.verticalList).forEach((function(t){return h.verticalList.push(t)})),s={verticalList:h.verticalList,width:h.width+f.width}}else(s=this.clipTextVertical(t,e,i,r)).verticalList.push({text:n,direction:1,width:l});return s.width+=l,s}},{key:"revertVerticalList",value:function(t){return t.reverse().map((function(t){var e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})}))}},{key:"clipTextWithSuffix",value:function(t,e,i,n,r,o){if(""===n)return this.clipText(t,e,i,r);if(0===t.length)return{str:"",width:0};var a=this.measureTextWidth(t,e);if(a<=i)return{str:t,width:a};var s=this.measureTextWidth(n,e);if(s>i)return{str:"",width:0};i-=s;var l=this._clipText(t,e,i,0,t.length-1,o,n);if(r&&l.str!==t){var u=hu(t,l.str.length);u!==l.str.length&&(l.str=t.substring(0,u),l.width=this.measureTextWidth(l.str,e))}return l.str=l.result,l.width+=s,l}}]),t}();function vu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}pu=fu([Ya()],pu);var yu=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},gu=Symbol.for("TextMeasureContribution"),mu=function(t){ue(i,t);var e=vu(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i)}(pu);mu=yu([Ya()],mu);var _u=new us,bu=Symbol.for("CanvasFactory"),xu=Symbol.for("Context2dFactory");function ku(t){return _u.getNamed(bu,nu.global.env)(t)}var Su=1e-4,Au=Math.sqrt(3),wu=1/3;function Tu(t){return t>-Hu&&t<Hu}function Mu(t){return t>Hu||t<-Hu}var Cu=[0,0],Eu=[0,0],Ru=[0,0];function Pu(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Bu(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i}function Lu(t,e,i,n,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*n+3*o*i)}function Ou(t){return(t%=Wt)<0&&(t+=Wt),t}function Iu(t,e,i,n,r,o){if(o>e&&o>n||o<e&&o<n)return 0;if(n===e)return 0;var a=(o-e)/(n-e),s=n<e?1:-1;1!==a&&0!==a||(s=n<e?.5:-.5);var l=a*(i-t)+t;return l===r?1/0:l>r?s:0}function Du(t,e,i,n,r,o,a,s,l){if(0===a)return!1;var u=a;return!(l>e+u&&l>n+u&&l>o+u||l<e-u&&l<n-u&&l<o-u||s>t+u&&s>i+u&&s>r+u||s<t-u&&s<i-u&&s<r-u)&&function(t,e,i,n,r,o,a,s,l){var u=0,c=.005,h=1/0;Cu[0]=a,Cu[1]=s;for(var d=0;d<1;d+=.05){Eu[0]=Bu(t,i,r,d),Eu[1]=Bu(e,n,o,d);var f=Pu(Cu,Eu);f<h&&(u=d,h=f)}h=1/0;for(var p=0;p<32&&!(c<Su);p++){var v=u-c,y=u+c;Eu[0]=Bu(t,i,r,v),Eu[1]=Bu(e,n,o,v);var g=Pu(Eu,Cu);if(v>=0&&g<h)u=v,h=g;else{Ru[0]=Bu(t,i,r,y),Ru[1]=Bu(e,n,o,y);var m=Pu(Ru,Cu);y<=1&&m<h?(u=y,h=m):c*=.5}}return l&&(l[0]=Bu(t,i,r,u),l[1]=Bu(e,n,o,u)),Math.sqrt(h)}(t,e,i,n,r,o,s,l,null)<=u/2}function Fu(t,e,i,n,r,o,a,s,l,u,c){if(0===l)return!1;var h=l;return!(c>e+h&&c>n+h&&c>o+h&&c>s+h||c<e-h&&c<n-h&&c<o-h&&c<s-h||u>t+h&&u>i+h&&u>r+h&&u>a+h||u<t-h&&u<i-h&&u<r-h&&u<a-h)&&function(t,e,i,n,r,o,a,s,l,u,c){var h,d,f,p,v=0,y=.005,g=1/0;Cu[0]=l,Cu[1]=u;for(var m=0;m<1;m+=.05)Eu[0]=Lu(t,i,r,a,m),Eu[1]=Lu(e,n,o,s,m),(f=Pu(Cu,Eu))<g&&(v=m,g=f);g=1/0;for(var _=0;_<32&&!(y<Su);_++)h=v-y,d=v+y,Eu[0]=Lu(t,i,r,a,h),Eu[1]=Lu(e,n,o,s,h),f=Pu(Eu,Cu),h>=0&&f<g?(v=h,g=f):(Ru[0]=Lu(t,i,r,a,d),Ru[1]=Lu(e,n,o,s,d),p=Pu(Ru,Cu),d<=1&&p<g?(v=d,g=p):y*=.5);return c&&(c[0]=Lu(t,i,r,a,v),c[1]=Lu(e,n,o,s,v)),Math.sqrt(g)}(t,e,i,n,r,o,a,s,u,c,null)<=h/2}function zu(t,e,i,n,r,o,a,s,l){if(0===a)return!1;var u=a;s-=t,l-=e;var c=Math.sqrt(s*s+l*l);if(c-u>i||c+u<i)return!1;if(Math.abs(n-r)%Wt<1e-4)return!0;if(o){var h=n;n=Ou(r),r=Ou(h)}else n=Ou(n),r=Ou(r);n>r&&(r+=Wt);var d=Math.atan2(l,s);return d<0&&(d+=Wt),d>=n&&d<=r||d+Wt>=n&&d+Wt<=r}function ju(t,e,i,n,r,o,a){if(0===r)return!1;var s,l=r,u=r/2;if(a>e+u&&a>n+u||a<e-u&&a<n-u||o>t+u&&o>i+u||o<t-u&&o<i-u)return!1;if(t===i)return Math.abs(o-t)<=l/2;var c=(s=(e-n)/(t-i))*o-a+(t*n-i*e)/(t-i);return c*c/(s*s+1)<=l/2*l/2}var Hu=1e-4;function Nu(t,e,i,n,r){var o=6*i-12*e+6*t,a=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(Tu(a)){if(Mu(o)){var u=-s/o;u>=0&&u<=1&&(r[l++]=u)}}else{var c=o*o-4*a*s;if(Tu(c))r[0]=-o/(2*a);else if(c>0){var h=Math.sqrt(c),d=(-o+h)/(2*a),f=(-o-h)/(2*a);d>=0&&d<=1&&(r[l++]=d),f>=0&&f<=1&&(r[l++]=f)}}return l}var Vu=[-1,-1,-1],Gu=[-1,-1];function Wu(t,e,i,n,r,o,a,s,l,u){if(u>e&&u>n&&u>o&&u>s||u<e&&u<n&&u<o&&u<s)return 0;var c=function(t,e,i,n,r,o){var a=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-r,c=s*s-3*a*l,h=s*l-9*a*u,d=l*l-3*s*u,f=0;if(Tu(c)&&Tu(h))if(Tu(s))o[0]=0;else{var p=-l/s;p>=0&&p<=1&&(o[f++]=p)}else{var v=h*h-4*c*d;if(Tu(v)){var y=h/c,g=-s/a+y,m=-y/2;g>=0&&g<=1&&(o[f++]=g),m>=0&&m<=1&&(o[f++]=m)}else if(v>0){var _=Math.sqrt(v),b=c*s+1.5*a*(-h+_),x=c*s+1.5*a*(-h-_),k=(-s-((b=b<0?-Math.pow(-b,wu):Math.pow(b,wu))+(x=x<0?-Math.pow(-x,wu):Math.pow(x,wu))))/(3*a);k>=0&&k<=1&&(o[f++]=k)}else{var S=(2*c*s-3*a*h)/(2*Math.sqrt(c*c*c)),A=Math.acos(S)/3,w=Math.sqrt(c),T=Math.cos(A),M=(-s-2*w*T)/(3*a),C=(-s+w*(T+Au*Math.sin(A)))/(3*a),E=(-s+w*(T-Au*Math.sin(A)))/(3*a);M>=0&&M<=1&&(o[f++]=M),C>=0&&C<=1&&(o[f++]=C),E>=0&&E<=1&&(o[f++]=E)}}return f}(e,n,o,s,u,Vu);if(0===c)return 0;for(var h,d=0,f=-1,p=0,v=0,y=0;y<c;y++){var g=Vu[y],m=0===g||1===g?.5:1;Lu(t,i,r,a,g)<l||(f<0&&(f=Nu(e,n,o,s,Gu),Gu[1]<Gu[0]&&f>1&&(h=void 0,h=Gu[0],Gu[0]=Gu[1],Gu[1]=h),p=Lu(e,n,o,s,Gu[0]),f>1&&(v=Lu(e,n,o,s,Gu[1]))),2===f?g<Gu[0]?d+=p<e?m:-m:g<Gu[1]?d+=v<p?m:-m:d+=s<v?m:-m:g<Gu[0]?d+=p<e?m:-m:d+=s<p?m:-m)}return d}function Uu(t,e,i,n,r,o,a,s){if(s>e&&s>n&&s>o||s<e&&s<n&&s<o)return 0;var l=function(t,e,i,n,r){var o=t-2*e+i,a=2*(e-t),s=t-n,l=0;if(Tu(o)){if(Mu(a)){var u=-s/a;u>=0&&u<=1&&(r[l++]=u)}}else{var c=a*a-4*o*s;if(Tu(c)){var h=-a/(2*o);h>=0&&h<=1&&(r[l++]=h)}else if(c>0){var d=Math.sqrt(c),f=(-a+d)/(2*o),p=(-a-d)/(2*o);f>=0&&f<=1&&(r[l++]=f),p>=0&&p<=1&&(r[l++]=p)}}return l}(e,n,o,s,Vu);if(0===l)return 0;var u,c,h,d=0===(h=(u=e)+o-2*(c=n))?.5:(u-c)/h;if(d>=0&&d<=1){for(var f=0,p=Bu(e,n,o,d),v=0;v<l;v++){var y=0===Vu[v]||1===Vu[v]?.5:1;Bu(t,i,r,Vu[v])<a||(Vu[v]<d?f+=p<e?y:-y:f+=o<p?y:-y)}return f}var g=0===Vu[0]||1===Vu[0]?.5:1;return Bu(t,i,r,Vu[0])<a?0:o<e?g:-g}function Yu(t,e,i,n,r,o,a,s){if((s-=e)>i||s<-i)return 0;var l=Math.sqrt(i*i-s*s);Vu[0]=-l,Vu[1]=l;var u=Math.abs(n-r);if(u<1e-4)return 0;if(u>=Wt-1e-4){n=0,r=Wt;var c=o?1:-1;return a>=Vu[0]+t&&a<=Vu[1]+t?c:0}if(n>r){var h=n;n=r,r=h}n<0&&(n+=Wt,r+=Wt);for(var d=0,f=0;f<2;f++){var p=Vu[f];if(p+t>a){var v=Math.atan2(s,p),y=o?1:-1;v<0&&(v=Wt+v),(v>=n&&v<=r||v+Wt>=n&&v+Wt<=r)&&(v>Nt/2&&v<1.5*Nt&&(y=-y),d+=y)}}return d}function Ku(t){return Math.round(t/Nt*1e8)/1e8%2*Nt}function Xu(t,e){var i=Ku(t[0]);i<0&&(i+=Wt);var n=i-t[0],r=t[1];r+=n,!e&&r-i>=Wt?r=i+Wt:e&&i-r>=Wt?r=i-Wt:!e&&i>r?r=i+(Wt-Ku(i-r)):e&&i<r&&(r=i-(Wt-Ku(r-i))),t[0]=i,t[1]=r}var Zu=[0,0];function qu(t,e,i,n,r){for(var o,a,s=t,l=t.length,u=0,c=0,h=0,d=0,f=0,p=0;p<l;p++){var v=s[p],y=0===p;v[0]===Vs.M&&p>1&&(i||(u+=Iu(c,h,d,f,n,r))),y&&(d=c=v[1],f=h=v[2]);var g=v[0],m=v[1],_=v[2],b=v[3],x=v[4],k=v[5],S=v[6],A=x,w=k;Zu[0]=A,Zu[1]=w,Xu(Zu,Boolean(v[6]));var T=A=Zu[0],M=(w=Zu[1])-A,C=!!(1-(v[6]?0:1)),E=(n-m)*b/b+m;switch(g){case Vs.M:c=d=m,h=f=_;break;case Vs.L:if(i){if(ju(c,h,m,_,e,n,r))return!0}else u+=Iu(c,h,m,_,n,r)||0;c=m,h=_;break;case Vs.C:if(i){if(Fu(c,h,m,_,b,x,k,S,e,n,r))return!0}else u+=Wu(c,h,m,_,b,x,k,S,n,r)||0;c=k,h=S;break;case Vs.Q:if(i){if(Du(c,h,m,_,b,x,e,n,r))return!0}else u+=Uu(c,h,m,_,b,x,n,r)||0;c=b,h=x;break;case Vs.A:if(o=Math.cos(T)*b+m,a=Math.sin(T)*b+_,y?(d=o,f=a):u+=Iu(c,h,o,a,n,r),i){if(zu(m,_,b,T,T+M,C,e,E,r))return!0}else u+=Yu(m,_,b,T,T+M,C,E,r);c=Math.cos(T+M)*b+m,h=Math.sin(T+M)*b+_;break;case Vs.R:if(o=(d=c=m)+b,a=(f=h=_)+x,i){if(ju(d,f,o,f,e,n,r)||ju(o,f,o,a,e,n,r)||ju(o,a,d,a,e,n,r)||ju(d,a,d,f,e,n,r))return!0}else u+=Iu(o,f,o,a,n,r),u+=Iu(d,a,d,f,n,r);break;case Vs.Z:if(i){if(ju(c,h,d,f,e,n,r))return!0}else u+=Iu(c,h,d,f,n,r);c=d,h=f}}return i||function(t,e){return Math.abs(t-e)<Hu}(h,f)||(u+=Iu(c,h,d,f,n,r)||0),0!==u}var Ju=function(){function t(){jt(this,t),this.pools=[],this.allocatedCanvas=[]}return zt(t,[{key:"shareCanvas",value:function(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}},{key:"getCommonCanvas",value:function(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}},{key:"allocate",value:function(t){if(!this.pools.length){var e=ku(Object.assign({nativeCanvas:nu.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}var i=this.pools.pop();return i.resize(t.width,t.height),i.dpr=t.dpr,i}},{key:"allocateByObj",value:function(t){if(!this.pools.length){var e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=ku(Object.assign({nativeCanvas:nu.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}var n=this.pools.pop();return n.width=t.width,n.height=t.height,n}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}]),t}(),Qu=new Ju,$u=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},tc=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ec=Symbol.for("VWindow"),ic=Symbol.for("WindowHandlerContribution"),nc=function(){function t(){jt(this,t),this.hooks={onChange:new vs(["x","y","width","height"])},this._uid=Ba.GenAutoIncrementId(),this.global=nu.global,this.postInit()}return zt(t,[{key:"width",get:function(){if(this._handler){var t=this._handler.getWH();return this._width=t.width}return this._width}},{key:"height",get:function(){if(this._handler){var t=this._handler.getWH();return this._height=t.height}return this._height}},{key:"dpr",get:function(){return this._handler.getDpr()}},{key:"postInit",value:function(){var t=this;this.global.hooks.onSetEnv.tap("window",(function(){t.active()})),this.active()}},{key:"active",value:function(){var t=this.global;t.env&&!this.actived&&(_u.getNamed(ic,t.env).configure(this,t),this.actived=!0)}},{key:"style",get:function(){return this._handler.getStyle()},set:function(t){this._handler.setStyle(t)}},{key:"create",value:function(t){this._handler.createWindow(t);var e=this._handler.getWH();this._width=e.width,this._height=e.height,this.title=this._handler.getTitle(),this.resizable=!0}},{key:"setWindowHandler",value:function(t){this._handler=t}},{key:"setDpr",value:function(t){return this._handler.setDpr(t)}},{key:"resize",value:function(t,e){return this._handler.resizeWindow(t,e)}},{key:"configure",value:function(){throw new Error("暂不支持")}},{key:"release",value:function(){return this._handler.releaseWindow()}},{key:"getContext",value:function(){return this._handler.getContext()}},{key:"getNativeHandler",value:function(){return this._handler.getNativeHandler()}},{key:"getImageBuffer",value:function(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}},{key:"addEventListener",value:function(t,e,i){return this._handler.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this._handler.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this._handler.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this._handler.getBoundingClientRect()}},{key:"getContainer",value:function(){return this._handler.container}},{key:"clearViewBox",value:function(t,e){this._handler.clearViewBox(t,e)}},{key:"isVisible",value:function(t){return this._handler.isVisible(t)}},{key:"onVisibleChange",value:function(t){return this._handler.onVisibleChange(t)}},{key:"getTopLeft",value:function(t){return this._handler.getTopLeft(t)}}]),t}();nc=$u([Ya(),tc("design:paramtypes",[])],nc);var rc,oc=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},ac=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sc=function(t,e){return function(i,n){e(i,n,t)}},lc=function(){function t(e){var i=this;jt(this,t),this.contributions=e,this.configured=!1,this.global=nu.global,this.global.hooks.onSetEnv.tap("graphic-util",(function(t,e,n){i.configured=!1,i.configure(n,e)}))}return zt(t,[{key:"canvas",get:function(){return this.tryInitCanvas(),this._canvas}},{key:"context",get:function(){return this.tryInitCanvas(),this._context}},{key:"textMeasure",get:function(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}},{key:"configure",value:function(t,e){var i=this;this.configured||(this.contributions.getContributions().forEach((function(t){t.configure(i,e)})),this.configured=!0)}},{key:"tryInitCanvas",value:function(){if(!this._canvas){var t=Qu.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}},{key:"bindTextMeasure",value:function(t){this._textMeasure=t}},{key:"measureText",value:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"native";this.configure(this.global,this.global.env);var r=this.global.measureTextMethod;this.global.measureTextMethod=n;var o={width:this._textMeasure.measureTextWidth(t,e),height:null!==(i=e.fontSize)&&void 0!==i?i:zl.fontSize};return this.global.measureTextMethod=r,o}},{key:"createTextMeasureInstance",value:function(t,e,i){var n=this;return this.configure(this.global,this.global.env),new fi(Object.assign({defaultFontParams:{fontFamily:zl.fontFamily,fontSize:zl.fontSize},getCanvasForMeasure:i||function(){return n.canvas},getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+fi.ALPHABET_CHAR_SET+fi.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}},{key:"drawGraphicToCanvas",value:function(t,e,i){if(!e.defaultLayer)return null;var n=_u.get(ec),r=t.AABBBounds,o=r.width(),a=r.height();n.create({width:o,height:a,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});var s=-r.x1,l=-r.y1,u=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(n,[t],{x:s,y:l,width:o,height:a,stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=u;var c=n.getNativeHandler();return c.nativeCanvas?c.nativeCanvas:null}}]),t}();lc=oc([Ya(),sc(0,Wa(cs)),sc(0,Ka(gu)),ac("design:paramtypes",[Object])],lc),function(t){t[t.transform=0]="transform",t[t.matrix=1]="matrix"}(rc||(rc={}));var uc=new ke,cc=function(){function t(){jt(this,t),this.matrix=new ke}return zt(t,[{key:"init",value:function(t){return this.mode=rc.transform,this.originTransform=t,this.matrix.reset(),this}},{key:"fromMatrix",value:function(t,e){return this.mode=rc.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}},{key:"scaleMatrix",value:function(t,e,i){var n=this.outSourceMatrix;if(uc.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),i){var r=i.x,o=i.y;this.outTargetMatrix.translate(r,o),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-o)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(uc.a,uc.b,uc.c,uc.d,uc.e,uc.f),this}},{key:"rotateMatrix",value:function(t,e){var i=this.outSourceMatrix;if(uc.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){var n=e.x,r=e.y;this.outTargetMatrix.translate(n,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-n,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(uc.a,uc.b,uc.c,uc.d,uc.e,uc.f),this}},{key:"scale",value:function(t,e,i){return this.mode===rc.matrix?this.scaleMatrix(t,e,i):this}},{key:"rotate",value:function(t,e){return this.mode===rc.matrix?this.rotateMatrix(t,e):this}},{key:"translateMatrix",value:function(t,e){var i=this.outSourceMatrix;return uc.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(uc.a,uc.b,uc.c,uc.d,uc.e,uc.f),this}},{key:"translate",value:function(t,e){return this.mode===rc.matrix?this.translateMatrix(t,e):this}},{key:"simplify",value:function(t){return this.mode===rc.matrix?this.simplifyMatrix(t):this}},{key:"simplifyMatrix",value:function(t){return this}}]),t}();cc=oc([Ya(),ac("design:paramtypes",[])],cc);var hc={arc:Vl,area:Gl,circle:Wl,line:Kl,path:Xl,symbol:Ql,text:$l,rect:ql,rect3d:Jl,polygon:Zl,richtext:tu,richtextIcon:iu,image:eu,group:Ul,glyph:Yl},dc=Object.keys(hc);function fc(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}var pc={arc:Object.assign({},hc.arc),area:Object.assign({},hc.area),circle:Object.assign({},hc.circle),line:Object.assign({},hc.line),path:Object.assign({},hc.path),symbol:Object.assign({},hc.symbol),text:Object.assign({},hc.text),rect:Object.assign({},hc.rect),rect3d:Object.assign({},hc.rect3d),polygon:Object.assign({},hc.polygon),richtext:Object.assign({},hc.richtext),richtextIcon:Object.assign({},hc.richtextIcon),image:Object.assign({},hc.image),group:Object.assign({},hc.group),glyph:Object.assign({},hc.glyph)},vc=function(){function t(){jt(this,t),this.initTheme(),this.dirty=!1}return zt(t,[{key:"initTheme",value:function(){var t=this;this._defaultTheme={},dc.forEach((function(e){t._defaultTheme[e]=Object.create(pc[e])})),this.combinedTheme=this._defaultTheme}},{key:"getTheme",value:function(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;var e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}},{key:"getParentWithTheme",value:function(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}},{key:"applyTheme",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.dirty){var n=this.getParentWithTheme(t);if(n){var r=n.theme;(r.dirty||i)&&r.applyTheme(n,e,!0)}this.userTheme?this.doCombine(n&&n.theme.combinedTheme):(n?this.combinedTheme=n.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,gi.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}},{key:"doCombine",value:function(t){var e=this,i=this.userTheme,n=this.combinedTheme;dc.forEach((function(r){var o=Object.create(pc[r]);t&&t[r]&&fc(o,t[r]),n[r]&&fc(o,n[r]),i[r]&&fc(o,i[r]),e.combinedTheme[r]=o})),i.common&&dc.forEach((function(t){fc(e.combinedTheme[t],i.common)})),this.dirty=!1}},{key:"setTheme",value:function(t,e){var i=this.userTheme;i?Object.keys(t).forEach((function(e){i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])})):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}},{key:"resetTheme",value:function(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}},{key:"dirtyChildren",value:function(t){var e=this;t.forEachChildren((function(t){t.isContainer&&(t.theme&&(t.theme.dirty=!0),e.dirtyChildren(t))}))}}]),t}(),yc=new vc;function gc(t,e){return t.glyphHost?gc(t.glyphHost):e?(t.isContainer,e):function(t){var e;if(e=t.isContainer?t:t.parent,e){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):yc.getTheme()}return null}(t)||yc.getTheme()}function mc(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */mc=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function _c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var bc=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},xc=function(t){ue(i,t);var e=_c(i);function i(){var t;return jt(this,i),(t=e.call(this))._uid=Ba.GenAutoIncrementId(),t._firstChild=null,t._lastChild=null,t.parent=null,t._count=1,t}return zt(i,[{key:"previousSibling",get:function(){return this._prev}},{key:"nextSibling",get:function(){return this._next}},{key:"children",get:function(){return this.getChildren()}},{key:"firstChild",get:function(){return this._firstChild}},{key:"lastChild",get:function(){return this._lastChild}},{key:"count",get:function(){return this._count}},{key:"childrenCount",get:function(){return this._idMap?this._idMap.size:0}},{key:"forEachChildren",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var e=this._lastChild,i=0;e;){if(t(e,i++))return;e=e._prev}else for(var n=this._firstChild,r=0;n;){if(t(n,r++))return;n=n._next}}},{key:"forEachChildrenAsync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return bc(this,void 0,void 0,mc().mark((function i(){var n,r,o,a,s,l;return mc().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=16;break}n=this._lastChild,r=0;case 2:if(!n){i.next=14;break}if(o=t(n,r++),i.t0=o.then,!i.t0){i.next=9;break}return i.next=8,o;case 8:o=i.sent;case 9:if(!o){i.next=11;break}return i.abrupt("return");case 11:n=n._prev;case 12:i.next=2;break;case 14:i.next=29;break;case 16:a=this._firstChild,s=0;case 17:if(!a){i.next=29;break}if(l=t(a,s++),i.t1=l.then,!i.t1){i.next=24;break}return i.next=23,l;case 23:l=i.sent;case 24:if(!l){i.next=26;break}return i.abrupt("return");case 26:a=a._next;case 27:i.next=17;break;case 29:case"end":return i.stop()}}),i,this)})))}},{key:"forEach",value:function(t){return this.forEachChildren(t)}},{key:"appendChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}},{key:"appendChildArrHighPerformance",value:function(t){return console.error("暂不支持该函数"),t}},{key:"insertBefore",value:function(t,e){if(!e)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertAfter",value:function(t,e){if(!e)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}},{key:"insertInto",value:function(t,e){if(!this._ignoreWarn&&this._nodeList&&gi.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{for(var i=this._firstChild,n=0;n<e;n++){if(!i)return null;n>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}},{key:"insertIntoKeepIdx",value:function(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){var i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}var n;this._nodeList[e]=t;for(var r=e-1;r>=0&&!(n=this._nodeList[r]);r--);if(n)return n._next?this.insertBefore(t,n._next):this.appendChild(t);this._ignoreWarn=!0;var o=this.insertInto(t,0);return this._ignoreWarn=!1,o}},{key:"removeChild",value:function(t){if(!this._idMap)return null;if(!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){var e=this._nodeList.findIndex((function(e){return e===t}));e>0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}},{key:"delete",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"removeAllChild",value:function(){if(this._idMap){for(var t=this._firstChild;t;)t.parent=null,t._prev=null,t._next=null,t=t._next;this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}}},{key:"replaceChild",value:function(t,e){throw new Error("暂不支持")}},{key:"find",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;return this.forEachChildren((function(i,r){return!(i===e||!t(i,r)||(n=i,0))})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.find(t,!0);if(i)return n=i,!0}return!1})),n}},{key:"findAll",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return this.forEachChildren((function(i,r){i!==e&&t(i,r)&&n.push(i)})),i&&this.forEachChildren((function(e){if(e.isContainer){var i=e.findAll(t,!0);i.length&&(n=n.concat(i))}})),n}},{key:"getElementById",value:function(t){return this.find((function(e){return e.id===t}),!0)}},{key:"findChildById",value:function(t){return this.getElementById(t)}},{key:"findChildByUid",value:function(t){return this._idMap&&this._idMap.get(t)||null}},{key:"getElementsByName",value:function(t){return this.findAll((function(e){return e.name===t}),!0)}},{key:"findChildrenByName",value:function(t){return this.getElementsByName(t)}},{key:"getElementsByType",value:function(t){return this.findAll((function(e){return e.type===t}),!0)}},{key:"getChildByName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.find((function(e){return e.name===t}),e)}},{key:"getChildAt",value:function(t){var e=this._firstChild;if(!e)return null;for(var i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}},{key:"at",value:function(t){return this.getChildAt(t)}},{key:"containNode",value:function(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;for(var e=this._firstChild;e;){if(e.containNode(t))return!0;e=e._next}return!1}},{key:"getRootNode",value:function(){for(var t=this.parent;null==t?void 0:t.parent;)t=t.parent;return t||this}},{key:"hasChildNodes",value:function(){return null!==this._firstChild}},{key:"addChild",value:function(t){return this.appendChild(t)}},{key:"add",value:function(t){return this.appendChild(t)}},{key:"getChildren",value:function(){for(var t=[],e=this._firstChild;e;)t.push(e),e=e._next;return t}},{key:"isChildOf",value:function(t){return!!this.parent&&this.parent._uid===t._uid}},{key:"isParentOf",value:function(t){return t.isChildOf(this)}},{key:"isDescendantsOf",value:function(t){var e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}},{key:"isAncestorsOf",value:function(t){return t.isDescendantsOf(this)}},{key:"getAncestor",value:function(t){throw new Error("暂不支持")}},{key:"setAllDescendantsProps",value:function(t,e){for(var i=this._firstChild;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}},{key:"setCount",value:function(t){this._count+=t;var e=this.parent;if(e)do{e._count+=t,e=e.parent}while(null!==e)}},{key:"clone",value:function(){throw new Error("暂不支持")}},{key:"cloneTo",value:function(t){throw new Error("暂不支持")}},{key:"getParent",value:function(){return this.parent}},{key:"del",value:function(t){return this.removeChild(t)}},{key:"addEventListener",value:function(t,e,n){var r=S(n,!0)&&n||M(n)&&n.capture,o=M(n)&&n.once,a=A(e)?void 0:e;return t=r?"".concat(t,"capture"):t,e=A(e)?e:e.handleEvent,o?Xs(de(i.prototype),"once",this).call(this,t,e,a):Xs(de(i.prototype),"on",this).call(this,t,e,a),this}},{key:"on",value:function(t,e,i){return this.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,n){var r=S(n,!0)&&n||M(n)&&n.capture,o=A(e)?void 0:e;t=r?"".concat(t,"capture"):t,e=A(e)?e:e.handleEvent;var a=M(n)&&n.once;return Xs(de(i.prototype),"off",this).call(this,t,e,o,a),this}},{key:"off",value:function(t,e,i){return this.removeEventListener(t,e,i)}},{key:"once",value:function(t,e,i){return M(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}},{key:"removeAllEventListeners",value:function(){return Xs(de(i.prototype),"removeAllListeners",this).call(this),this}},{key:"removeAllListeners",value:function(){return this.removeAllEventListeners()}},{key:"dispatchEvent",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(e=Xs(de(i.prototype),"emit",this)).call.apply(e,[this,t.type,t].concat(r)),!t.defaultPrevented}},{key:"emit",value:function(t,e){return this.dispatchEvent(t,e)}},{key:"release",value:function(){this.removeAllListeners()}}]),i}(x),kc=function(){function t(e){jt(this,t),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=t.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return zt(t,[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewX",get:function(){return this.viewport.x}},{key:"viewY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation(),this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error("Method not implemented.")}}]),t}();function Sc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Ac=function(t){ue(i,t);var e=Sc(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).client={x:0,y:0},t.movement={x:0,y:0},t.offset={x:0,y:0},t.global={x:0,y:0},t.screen={x:0,y:0},t}return zt(i,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d,f,p){throw new Error("Method not implemented.")}}]),i}(kc);function wc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Tc=function(t){ue(i,t);var e=wc(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).width=0,t.height=0,t.isPrimary=!1,t}return zt(i,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){var t,e,n,r=new i(this.manager);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyPointerData(this,r),null===(e=this.manager)||void 0===e||e.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice(),r.type=this.type,r}}]),i}(Ac);function Mc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Cc=function(t){ue(i,t);var e=Mc(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).DOM_DELTA_PIXEL=0,t.DOM_DELTA_LINE=1,t.DOM_DELTA_PAGE=2,t}return zt(i,[{key:"clone",value:function(){var t,e,n,r=new i(this.manager);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyWheelData(this,r),null===(e=this.manager)||void 0===e||e.copyMouseData(this,r),null===(n=this.manager)||void 0===n||n.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice(),r.type=this.type,r}}]),i}(Ac);function Ec(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Cc.DOM_DELTA_PIXEL=0,Cc.DOM_DELTA_LINE=1,Cc.DOM_DELTA_PAGE=2;var Rc=function(t){ue(i,t);var e=Ec(i);function i(t,n){var r;return jt(this,i),(r=e.call(this)).type=t,r.detail=n,r}return zt(i)}(kc),Pc="object"==("undefined"==typeof performance?"undefined":i(performance))&&performance.now?performance:Date;function Bc(t){return"mouse"===t||"pen"===t}var Lc,Oc=function(){function t(e,i){var n=this;jt(this,t),this.dispatch=new x,this.cursorTarget=null,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=function(t,e){if(t instanceof Tc){var i=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)n.dispatchEvent(i,"touchstart");else if(Bc(i.pointerType)){var r=2===i.button;n.dispatchEvent(i,r?"rightdown":"mousedown")}n.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),n.freeEvent(i)}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerMove=function(t,e){var i,r;if(t instanceof Tc){var o=n.createPointerEvent(t,t.type,e),a=Bc(o.pointerType),s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.overTargets);if(s.overTargets&&l&&l!==n.rootTarget&&l!==o.target){var u="mousemove"===t.type?"mouseout":"pointerout",c=n.createPointerEvent(t,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),a&&n.dispatchEvent(c,"mouseout"),!o.composedPath().includes(l)){var h=n.createPointerEvent(t,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!o.composedPath().includes(h.target);)h.currentTarget=h.target,n.notifyTarget(h),a&&n.notifyTarget(h,"mouseleave"),h.target=h.target.parent;n.freeEvent(h)}n.freeEvent(c)}if(l!==o.target){var d="mousemove"===t.type?"mouseover":"pointerover",f=n.clonePointerEvent(o,d);n.dispatchEvent(f,"pointerover"),a&&n.dispatchEvent(f,"mouseover");for(var p=null==l?void 0:l.parent;p&&p!==n.rootTarget.parent&&p!==o.target;)p=p.parent;if(!p||p===n.rootTarget.parent){var v=n.clonePointerEvent(o,"pointerenter");for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==l&&v.target!==n.rootTarget.parent;)v.currentTarget=v.target,n.notifyTarget(v),a&&n.notifyTarget(v,"mouseenter"),v.target=v.target.parent;n.freeEvent(v)}n.freeEvent(f)}n.dispatchEvent(o,"pointermove"),"touch"===o.pointerType&&n.dispatchEvent(o,"touchmove"),a&&(n.dispatchEvent(o,"mousemove"),n.cursorTarget=o.target,n.cursor=(null===(r=null===(i=o.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor()),s.overTargets=o.composedPath(),n.freeEvent(o)}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOver=function(t,e){var i,r;if(t instanceof Tc){var o=n.trackingData(t.pointerId),a=n.createPointerEvent(t,t.type,e),s=Bc(a.pointerType);n.dispatchEvent(a,"pointerover"),s&&n.dispatchEvent(a,"mouseover"),"mouse"===a.pointerType&&(n.cursorTarget=a.target,n.cursor=(null===(r=null===(i=a.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||n.rootTarget.getCursor());var l=n.clonePointerEvent(a,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==n.rootTarget.parent;)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseenter"),l.target=l.target.parent;o.overTargets=a.composedPath(),n.freeEvent(a),n.freeEvent(l)}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerOut=function(t,e){if(t instanceof Tc){var i=n.trackingData(t.pointerId);if(i.overTargets){var r=Bc(t.pointerType),o=n.findMountedTarget(i.overTargets),a=n.createPointerEvent(t,"pointerout",o||void 0);n.dispatchEvent(a),r&&n.dispatchEvent(a,"mouseout");var s=n.createPointerEvent(t,"pointerleave",o||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==n.rootTarget.parent;)s.currentTarget=s.target,n.notifyTarget(s),r&&n.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],n.freeEvent(a),n.freeEvent(s)}n.cursorTarget=null,n.cursor=""}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUp=function(t,e){var i;if(t instanceof Tc){var r=Pc.now(),o=n.createPointerEvent(t,t.type,e);if(n.dispatchEvent(o,"pointerup"),"touch"===o.pointerType)n.dispatchEvent(o,"touchend");else if(Bc(o.pointerType)){var a=2===o.button;n.dispatchEvent(o,a?"rightup":"mouseup")}var s=n.trackingData(t.pointerId),l=n.findMountedTarget(s.pressTargetsByButton[t.button]),u=l;if(l&&!o.composedPath().includes(l)){for(var c=l;c&&!o.composedPath().includes(c);){if(o.currentTarget=c,n.notifyTarget(o,"pointerupoutside"),"touch"===o.pointerType)n.notifyTarget(o,"touchendoutside");else if(Bc(o.pointerType)){var h=2===o.button;n.notifyTarget(o,h?"rightupoutside":"mouseupoutside")}c=c.parent}delete s.pressTargetsByButton[t.button],u=c}if(u){var d=n.clonePointerEvent(o,"click");d.target=u,d.path=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:d.target,timeStamp:r});var f=s.clicksByButton[t.button];f.target===d.target&&r-f.timeStamp<(null!==(i=n._config.clickInterval)&&void 0!==i?i:200)?++f.clickCount:f.clickCount=1,f.target=d.target,f.timeStamp=r,d.detail=f.clickCount,Bc(d.pointerType)?(n.dispatchEvent(d,"click"),2===f.clickCount&&n.dispatchEvent(d,"dblclick")):"touch"===d.pointerType&&(n.dispatchEvent(d,"tap"),2===f.clickCount&&n.dispatchEvent(d,"dbltap")),n.dispatchEvent(d,"pointertap"),n.freeEvent(d)}n.freeEvent(o)}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onPointerUpOutside=function(t,e){if(t instanceof Tc){var i=n.trackingData(t.pointerId),r=n.findMountedTarget(i.pressTargetsByButton[t.button]),o=n.createPointerEvent(t,t.type,e);if(r){for(var a=r;a;)o.currentTarget=a,n.notifyTarget(o,"pointerupoutside"),"touch"===o.pointerType?n.notifyTarget(o,"touchendoutside"):Bc(o.pointerType)&&n.notifyTarget(o,2===o.button?"rightupoutside":"mouseupoutside"),a=a.parent;delete i.pressTargetsByButton[t.button]}n.freeEvent(o)}else gi.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event")},this.onWheel=function(t,e){if(t instanceof Cc){var i=n.createWheelEvent(t,e);n.dispatchEvent(i),n.freeEvent(i)}else gi.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event")},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},i),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}return zt(t,[{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}},{key:"mapEvent",value:function(t){var e,i,n,r,o,a,s;if(this.rootTarget){var l,u=this.mappingTable[t.type],c="".concat(t.canvasX,"-").concat(t.canvasY);if((null===(e=this._prePointTargetCache)||void 0===e?void 0:e[c])&&(null===(n=null===(i=this._prePointTargetCache)||void 0===i?void 0:i[c])||void 0===n?void 0:n.stage)&&(null===(o=null===(r=this._prePointTargetCache)||void 0===r?void 0:r[c])||void 0===o?void 0:o.stage.renderCount)===(null===(a=this._prePointTargetCache)||void 0===a?void 0:a.stageRenderCount)?l=this._prePointTargetCache[c]:(l=this.pickTarget(t.canvasX,t.canvasY,t),t.pickParams||(this._prePointTargetCache=v(v({},c,l),"stageRenderCount",null!==(s=null==l?void 0:l.stage.renderCount)&&void 0!==s?s:-1))),u)for(var h=0,d=u.length;h<d;h++)u[h].fn(t,l);else gi.getInstance().warn("[EventManager]: Event mapping not defined for ".concat(t.type))}}},{key:"propagate",value:function(t,e){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var n=0,r=i.length-1;n<r;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(var o=i.length-2;o>=0;o--)if(t.currentTarget=i[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){for(var e=[t],i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[0],i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}},{key:"createPointerEvent",value:function(t,e,i){var n=this.allocateEvent(Tc);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i||this.pickTarget(n.global.x,n.global.y,n),"string"==typeof e&&(n.type=e),n}},{key:"createWheelEvent",value:function(t,e){var i=this.allocateEvent(Cc);return this.copyWheelData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=e||this.pickTarget(i.global.x,i.global.y,i),i}},{key:"clonePointerEvent",value:function(t,e){var i=this.allocateEvent(Tc);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=null!=e?e:i.type,i}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyPointerData",value:function(t,e){t instanceof Tc&&e instanceof Tc&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof Ac&&e instanceof Ac&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach((function(i){e[i].x=t[i].x,e[i].y=t[i].y})))}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=Pc.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"allocateEvent",value:function(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);var i=(null===(e=this.eventPool.get(t))||void 0===e?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.target=null,i}},{key:"freeEvent",value:function(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");var i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null===(e=this.eventPool.get(i))||void 0===e||e.push(t)}},{key:"notifyListeners",value:function(t,e){var i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeEventListener(e,i[n].fn,{once:!0}),i[n].fn.call(i[n].context,t);this.emitDelegation(t,e)}},{key:"emitDelegation",value:function(t,e){var i=t.currentTarget._events["*"];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(var n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,t,e)}},{key:"pickTarget",value:function(t,e,i){var n,r=this.rootTarget.pick(t,e);return n=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=r.params),n}}]),t}(),Ic={pickable:!0,visible:!0,dispatchEvent:function(t){var e;if(!(t instanceof kc))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.target=this,null===(e=null==t?void 0:t.manager)||void 0===e||e.dispatchEvent(t),!t.defaultPrevented},emit:function(t,e){return this.dispatchEvent(new Rc(t,e))}},Dc={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Fc=function(){function t(e){var i=this;jt(this,t),this.resolution=1,this.onPointerDown=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=i.normalizeToPointerData(t);i.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=0,r=e.length;n<r;n++){var o=e[n],a=i.bootstrapEvent(i.rootPointerEvent,o);i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget)}},this.onPointerMove=function(t){if(!(i.supportsTouchEvents&&"touch"===t.pointerType||i.isEventOutsideOfTargetElement(t))){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var o=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget)}},this.onPointerUp=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.isEventOutsideOfTargetElement(t)?"outside":"",n=i.normalizeToPointerData(t),r=0,o=n.length;r<o;r++){var a=i.bootstrapEvent(i.rootPointerEvent,n[r]);a.type+=e,i.manager.mapEvent(a)}i.setCursor(i.manager.cursor,i.manager.cursorTarget)}},this.onPointerOverOut=function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){for(var e=i.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var o=i.bootstrapEvent(i.rootPointerEvent,e[n]);i.manager.mapEvent(o)}i.setCursor(i.manager.cursor,i.manager.cursorTarget)}},this.onWheel=function(t){var e=i.normalizeWheelEvent(t);i.manager.mapEvent(e)};var n=e.targetElement,r=e.resolution,o=e.rootNode,a=e.global,s=e.viewport,l=e.autoPreventDefault,u=void 0!==l&&l,c=e.clickInterval,h=e.supportsTouchEvents,d=void 0===h?a.supportsTouchEvents:h,f=e.supportsPointerEvents,p=void 0===f?a.supportsPointerEvents:f;this.manager=new Oc(o,{clickInterval:c}),this.globalObj=a,this.supportsPointerEvents=p,this.supportsTouchEvents=d,this.supportsMouseEvents=a.supportsMouseEvents,this.applyStyles=a.applyStyles,this.autoPreventDefault=u,this.eventsAdded=!1,this.viewport=s,this.rootPointerEvent=new Tc,this.rootWheelEvent=new Cc,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=r,this.setTargetElement(n)}return zt(t,[{key:"release",value:function(){this.setTargetElement(null)}},{key:"setCursor",value:function(t,e){if(e||this.manager.rootTarget.window._handler.canvas.controled){t||(t="default");var n=this.applyStyles,r=this.domElement;if(this.currentCursor!==t){this.currentCursor=t;var o=this.cursorStyles[t];o?"string"==typeof o&&n?r.style.cursor=o:"function"==typeof o?o(t):"object"==i(o)&&n&&Object.assign(r.style,o):n&&P(t)&&!K(this.cursorStyles,t)&&(r.style.cursor=t)}}}},{key:"setTargetElement",value:function(t){this.removeEvents(),this.domElement=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().addEventListener("pointermove",this.onPointerMove,!0),t.getDocument().addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().addEventListener("mousemove",this.onPointerMove,!0),t.getDocument().addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.domElement){var t=this.globalObj,e=this.domElement;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().removeEventListener("pointermove",this.onPointerMove,!0),t.getDocument().removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().removeEventListener("mousemove",this.onPointerMove,!0),t.getDocument().removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapToViewportPoint",value:function(t){var e=this.viewport,i=t.x,n=t.y;return{x:i-e.x,y:n-e.y}}},{key:"mapToCanvasPoint",value:function(t){var e,i=null===(e=this.globalObj)||void 0===e?void 0:e.mapToCanvasPoint(t,this.domElement);if(i)return i;var n=t.clientX,r=t.clientY,o=this.domElement.getBoundingClientRect();return{x:n-o.left,y:r-o.top}}},{key:"normalizeToPointerData",value:function(t){var e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(var i=0,n=t.changedTouches.length;i<n;i++){var r=t.changedTouches[i];R(r.button)&&(r.button=0),R(r.buttons)&&(r.buttons=1),R(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),R(r.width)&&(r.width=r.radiusX||1),R(r.height)&&(r.height=r.radiusY||1),R(r.tiltX)&&(r.tiltX=0),R(r.tiltY)&&(r.tiltY=0),R(r.pointerType)&&(r.pointerType="touch"),R(r.pointerId)&&(r.pointerId=r.identifier||0),R(r.pressure)&&(r.pressure=r.force||.5),R(r.twist)&&(r.twist=0),R(r.tangentialPressure)&&(r.tangentialPressure=0),R(r.layerX)&&(r.layerX=r.offsetX=r.clientX),R(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!this.globalObj.supportsMouseEvents||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof PointerEvent)){var o=t;R(o.isPrimary)&&(o.isPrimary=!0),R(o.width)&&(o.width=1),R(o.height)&&(o.height=1),R(o.tiltX)&&(o.tiltX=0),R(o.tiltY)&&(o.tiltY=0),R(o.pointerType)&&(o.pointerType="mouse"),R(o.pointerId)&&(o.pointerId=1),R(o.pressure)&&(o.pressure=.5),R(o.twist)&&(o.twist=0),R(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}else e.push(t);return e}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var i=this.mapToCanvasPoint(t),n=i.x,r=i.y;e.canvas.x=n,e.canvas.y=r,e.global.x=n,e.global.y=r,e.offset.x=n,e.offset.y=r;var o=this.mapToViewportPoint(e),a=o.x,s=o.y;return e.viewport.x=a,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}},{key:"bootstrapEvent",value:function(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.mapToCanvasPoint(e),n=i.x,r=i.y;t.canvas.x=n,t.canvas.y=r,t.global.x=n,t.global.y=r,t.offset.x=n,t.offset.y=r;var o=this.mapToViewportPoint(t),a=o.x,s=o.y;return t.viewport.x=a,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Dc[t.type]||t.type),t}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=Pc.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}},{key:"isEventOutsideOfTargetElement",value:function(t){var e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}}]),t}(),zc=function(){function t(){jt(this,t),this.time=0}return zt(t,[{key:"avaliable",value:function(){return t.Avaliable()}},{key:"tick",value:function(t,e){this.time=Math.max(0,t+this.time),e(this,{once:!0})}},{key:"tickTo",value:function(t,e){this.time=Math.max(0,t),e(this,{once:!0})}},{key:"release",value:function(){this.timerId>0&&(this.timerId=-1)}},{key:"getTime",value:function(){return this.time}}],[{key:"Avaliable",value:function(){return!0}}]),t}(),jc=function(){function t(){jt(this,t)}return zt(t,[{key:"avaliable",value:function(){return t.Avaliable()}},{key:"tick",value:function(t,e){var i=this;this.timerId=setTimeout((function(){e(i)}),t)}},{key:"release",value:function(){this.timerId>0&&(clearTimeout(this.timerId),this.timerId=-1)}},{key:"getTime",value:function(){return Date.now()}}],[{key:"Avaliable",value:function(){return!0}}]),t}(),Hc=function(){function t(){jt(this,t)}return zt(t,[{key:"avaliable",value:function(){return t.Avaliable()}},{key:"tick",value:function(t,e){var i=this;nu.global.getRequestAnimationFrame()((function(){i.released||e(i)}))}},{key:"release",value:function(){this.released=!0}},{key:"getTime",value:function(){return Date.now()}}],[{key:"Avaliable",value:function(){return!!nu.global.getRequestAnimationFrame()}}]),t}();!function(t){t[t.INITIAL=0]="INITIAL",t[t.RUNNING=1]="RUNNING",t[t.PAUSE=2]="PAUSE"}(Lc||(Lc={}));var Nc=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];jt(this,t),this.handleTick=function(t,i){var n=(null!=i?i:{}).once,r=void 0!==n&&n;e.ifCanStop()?e.stop():(e._handlerTick(t),r||t.tick(e.interval,e.handleTick))},this._handlerTick=function(t){var i=e.tickerHandler.getTime(),n=0;e.lastFrameTime>=0&&(n=i-e.lastFrameTime),e.lastFrameTime=i,e.status===Lc.RUNNING&&(e.tickCounts++,e.timelines.forEach((function(t){t.tick(n)})))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.timelines=i,this.autoStop=!0}return zt(t,[{key:"mode",get:function(){return this._mode},set:function(t){this._mode!==t&&(this._mode=t,this.setupTickHandler())}},{key:"init",value:function(){var t=this;this.interval=NaN,this.status=Lc.INITIAL,nu.global.hooks.onSetEnv.tap("default-ticker",(function(){t.initHandler()})),nu.global.env&&this.initHandler()}},{key:"addTimeline",value:function(t){this.timelines.push(t)}},{key:"remTimeline",value:function(t){this.timelines=this.timelines.filter((function(e){return e!==t}))}},{key:"initHandler",value:function(){if(this._mode)return null;for(var t=[{mode:"raf",cons:Hc},{mode:"timeout",cons:jc},{mode:"manual",cons:zc}],e=0;e<t.length;e++)if(t[e].cons.Avaliable()){this.mode=t[e].mode;break}return null}},{key:"setupTickHandler",value:function(){var t;switch(this._mode){case"raf":t=new Hc;break;case"timeout":t=new jc;break;case"manual":t=new zc;break;default:gi.getInstance().warn("非法的计时器模式"),t=new Hc}return!!t.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0)}},{key:"setInterval",value:function(t){this.interval=t}},{key:"getInterval",value:function(){return this.interval}},{key:"setFPS",value:function(t){this.setInterval(1e3/t)}},{key:"getFPS",value:function(){return 1e3/this.interval}},{key:"tick",value:function(t){var e=this;this.tickerHandler.tick(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"tickTo",value:function(t){var e=this;this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,(function(t){e.handleTick(t,{once:!0})}))}},{key:"pause",value:function(){return this.status!==Lc.INITIAL&&(this.status=Lc.PAUSE,!0)}},{key:"resume",value:function(){return this.status!==Lc.INITIAL&&(this.status=Lc.RUNNING,!0)}},{key:"ifCanStop",value:function(){if(this.autoStop){if(!this.timelines.length)return!0;if(0===this.timelines.reduce((function(t,e){return t+e.animateCount}),0))return!0}return!1}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.status===Lc.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!t){if(this.status===Lc.PAUSE)return!1;if(!this.timelines.length)return!1;if(0===this.timelines.reduce((function(t,e){return t+e.animateCount}),0))return!1}return this.status=Lc.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0}},{key:"stop",value:function(){this.status=Lc.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}}]),t}(),Vc=function(){function t(){jt(this,t)}return zt(t,null,[{key:"linear",value:function(t){return t}},{key:"none",value:function(){return this.linear}},{key:"get",value:function(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}},{key:"getPowIn",value:function(t){return function(e){return Math.pow(e,t)}}},{key:"getPowOut",value:function(t){return function(e){return 1-Math.pow(1-e,t)}}},{key:"getPowInOut",value:function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}},{key:"getBackIn",value:function(t){return function(e){return e*e*((t+1)*e-t)}}},{key:"getBackOut",value:function(t){return function(e){return--e*e*((t+1)*e+t)+1}}},{key:"getBackInOut",value:function(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}},{key:"sineIn",value:function(t){return 1-Math.cos(t*Math.PI/2)}},{key:"sineOut",value:function(t){return Math.sin(t*Math.PI/2)}},{key:"sineInOut",value:function(t){return-(Math.cos(Math.PI*t)-1)/2}},{key:"expoIn",value:function(t){return 0===t?0:Math.pow(2,10*t-10)}},{key:"expoOut",value:function(t){return 1===t?1:1-Math.pow(2,-10*t)}},{key:"expoInOut",value:function(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}},{key:"circIn",value:function(t){return-(Math.sqrt(1-t*t)-1)}},{key:"circOut",value:function(t){return Math.sqrt(1- --t*t)}},{key:"circInOut",value:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"bounceOut",value:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},{key:"bounceIn",value:function(e){return 1-t.bounceOut(1-e)}},{key:"bounceInOut",value:function(e){return e<.5?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5}},{key:"getElasticIn",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/Wt*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*Wt/e)}}},{key:"getElasticOut",value:function(t,e){return function(i){if(0===i||1===i)return i;var n=e/Wt*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-n)*Wt/e)+1}}},{key:"getElasticInOut",value:function(t,e){return function(i){var n=e/Wt*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-n)*Wt/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-n)*Wt/e)*.5+1}}}]),t}();Vc.quadIn=Vc.getPowIn(2),Vc.quadOut=Vc.getPowOut(2),Vc.quadInOut=Vc.getPowInOut(2),Vc.cubicIn=Vc.getPowIn(3),Vc.cubicOut=Vc.getPowOut(3),Vc.cubicInOut=Vc.getPowInOut(3),Vc.quartIn=Vc.getPowIn(4),Vc.quartOut=Vc.getPowOut(4),Vc.quartInOut=Vc.getPowInOut(4),Vc.quintIn=Vc.getPowIn(5),Vc.quintOut=Vc.getPowOut(5),Vc.quintInOut=Vc.getPowInOut(5),Vc.backIn=Vc.getBackIn(1.7),Vc.backOut=Vc.getBackOut(1.7),Vc.backInOut=Vc.getBackInOut(1.7),Vc.elasticIn=Vc.getElasticIn(1,.3),Vc.elasticOut=Vc.getElasticOut(1,.3),Vc.elasticInOut=Vc.getElasticInOut(1,.3*1.5);var Gc=function(){function t(){jt(this,t),this.id=Ba.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}return zt(t,[{key:"addAnimate",value:function(t){this.animateTail?(this.animateTail.nextAnimate=t,t.prevAnimate=this.animateTail,this.animateTail=t,t.nextAnimate=null):(this.animateHead=t,this.animateTail=t),this.animateCount++}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"tick",value:function(t){if(!this.paused){var e=this.animateHead;for(this.animateCount=0;e;)e.status===Ps.END?this.removeAnimate(e):e.status===Ps.RUNNING||e.status===Ps.INITIAL?(this.animateCount++,e.advance(t)):e.status===Ps.PAUSED&&this.animateCount++,e=e.nextAnimate}}},{key:"clear",value:function(){for(var t=this.animateHead;t;)t.release(),t=t.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}},{key:"removeAnimate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t._onRemove&&t._onRemove.forEach((function(t){return t()})),t===this.animateHead?(this.animateHead=t.nextAnimate,t===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):t===this.animateTail?(this.animateTail=t.prevAnimate,this.animateTail.nextAnimate=null):(t.prevAnimate.nextAnimate=t.nextAnimate,t.nextAnimate.prevAnimate=t.prevAnimate),e&&t.release()}}]),t}(),Wc=new Gc;function Uc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Yc=function(){function t(e,i,n,r,o){jt(this,t),this.from=e,this.to=i,this.duration=n,this.easing=r,this.params=o,this.updateCount=0}return zt(t,[{key:"bind",value:function(t,e){this.target=t,this.subAnimate=e,this.onBind()}},{key:"onBind",value:function(){}},{key:"onFirstRun",value:function(){}},{key:"onStart",value:function(){}},{key:"onEnd",value:function(){}},{key:"getEndProps",value:function(){}},{key:"getFromProps",value:function(){return this.from}},{key:"getMergedEndProps",value:function(){var t,e=this.getEndProps();return e?this._endProps===e?this._mergedEndProps:(this._endProps=e,void(this._mergedEndProps=Object.assign({},null!==(t=this.step.prev.getLastProps())&&void 0!==t?t:{},e))):this.step.prev?this.step.prev.getLastProps():e}},{key:"update",value:function(t,e,i){var n=this;if(0===this.updateCount){this.onFirstRun();var r=this.step.getLastProps();Object.keys(r).forEach((function(t){n.subAnimate.animate.validAttr(t)&&(i[t]=r[t])}))}this.updateCount+=1,this.onUpdate(t,e,i),t&&this.onEnd()}}]),t}(),Kc=function(t){ue(i,t);var e=Uc(i);function i(t){var n;return jt(this,i),(n=e.call(this,null,null,0,"linear")).cb=t,n}return zt(i,[{key:"onUpdate",value:function(t,e,i){}},{key:"onStart",value:function(){this.cb()}}]),i}(Yc),Xc=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ba.GenAutoIncrementId(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wc;jt(this,t),this.id=e,this.timeline=i,this.status=Ps.INITIAL,this.tailAnimate=new qc(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this)}return zt(t,[{key:"setTimeline",value:function(t){t!==this.timeline&&(this.timeline.removeAnimate(this,!1),t.addAnimate(this))}},{key:"getStartTime",value:function(){return this._startTime}},{key:"getDuration",value:function(){return this.subAnimates.reduce((function(t,e){return t+e.totalDuration}),0)}},{key:"after",value:function(t){var e=t.getDuration();return this._startTime=e,this}},{key:"afterAll",value:function(t){var e=-1/0;return t.forEach((function(t){e=Xt(t.getDuration(),e)})),this._startTime=e,this}},{key:"parallel",value:function(t){return this._startTime=t.getStartTime(),this}},{key:"play",value:function(t){if(this.tailAnimate.play(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return 1===this.subAnimates.length&&this.tailAnimate.duration===t.duration&&this.trySetAttribute(t.getFromProps(),t.mode),this}},{key:"trySetAttribute",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.mode;e&&i&Bs.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(e,!1,{type:Rs.ANIMATE_PLAY})}},{key:"runCb",value:function(t){var e=this,i=new Kc((function(){t(e,i.step.prev)}));return this.tailAnimate.play(i),this}},{key:"customInterpolate",value:function(e,i,n,r,o,a){var s=t.interpolateMap.get(e)||t.interpolateMap.get("");return!!s&&s(e,i,n,r,o,a)}},{key:"pause",value:function(){this.status===Ps.RUNNING&&(this.status=Ps.PAUSED)}},{key:"resume",value:function(){this.status===Ps.PAUSED&&(this.status=Ps.RUNNING)}},{key:"to",value:function(t,e,i,n){if(this.tailAnimate.to(t,e,i,n),this.target){var r=this.target.stage;r&&r.renderNextFrame()}return this}},{key:"from",value:function(t,e,i,n){if(this.tailAnimate.from(t,e,i,n),this.target){var r=this.target.stage;r&&r.renderNextFrame()}return this}},{key:"wait",value:function(t){if(this.tailAnimate.wait(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"startAt",value:function(t){if(this.tailAnimate.startAt(t),this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"loop",value:function(t){if(this.tailAnimate.loop=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"reversed",value:function(t){if(this.tailAnimate.reversed=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"bounce",value:function(t){if(this.tailAnimate.bounce=t,this.target){var e=this.target.stage;e&&e.renderNextFrame()}return this}},{key:"subAnimate",value:function(){var t=new qc(this,this.tailAnimate);return this.tailAnimate=t,this.subAnimates.push(t),t.bind(this.target),this}},{key:"getStartProps",value:function(){return this.subAnimates[0].getStartProps()}},{key:"getEndProps",value:function(){return this.tailAnimate.getEndProps()}},{key:"depreventAttr",value:function(t){this._preventAttrs&&this._preventAttrs.delete(t)}},{key:"preventAttr",value:function(t){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(t)}},{key:"preventAttrs",value:function(t){var e=this;t.forEach((function(t){return e.preventAttr(t)}))}},{key:"validAttr",value:function(t){return!this._preventAttrs||!this._preventAttrs.has(t)}},{key:"bind",value:function(t){return this.target=t,this.target.onAnimateBind&&this.target.onAnimateBind(this),this.subAnimates.forEach((function(e){e.bind(t)})),this}},{key:"advance",value:function(t){if(this._duringTime<this._startTime){if(this._duringTime+t*this.timeScale<this._startTime)return void(this._duringTime+=t*this.timeScale);t=this._duringTime+t*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===Ps.INITIAL&&(this.status=Ps.RUNNING,this._onStart&&this._onStart.forEach((function(t){return t()}))),this.setPosition(this.rawPosition+t*this.timeScale)&&this.status===Ps.RUNNING&&(this.status=Ps.END,this._onEnd&&this._onEnd.forEach((function(t){return t()})))}},{key:"setPosition",value:function(t){var e,i=0,n=this.rawPosition,r=this.subAnimates.reduce((function(t,e){return t+e.totalDuration}),0);t<0&&(t=0);var o=t>=r;if(o&&(t=r),t===n)return o;for(var a=0;a<this.subAnimates.length&&!(i+(e=this.subAnimates[a]).totalDuration>=t);a++)i+=e.totalDuration,e=void 0;return this.rawPosition=t,e.setPosition(t-i),o}},{key:"onStart",value:function(t){this._onStart||(this._onStart=[]),this._onStart.push(t)}},{key:"onEnd",value:function(t){this._onEnd||(this._onEnd=[]),this._onEnd.push(t)}},{key:"onRemove",value:function(t){this._onRemove||(this._onRemove=[]),this._onRemove.push(t)}},{key:"onFrame",value:function(t){this._onFrame||(this._onFrame=[]),this._onFrame.push(t)}},{key:"release",value:function(){this.status=Ps.END}},{key:"stop",value:function(t){t||this.target.onStop(),"start"===t?this.target.onStop(this.getStartProps()):"end"===t?this.target.onStop(this.getEndProps()):this.target.onStop(t),this.release()}}],[{key:"AddInterpolate",value:function(e,i){t.interpolateMap.set(e,i)}}]),t}();Xc.mode=Bs.NORMAL,Xc.interpolateMap=new Map;var Zc,qc=function(){function t(e,i){jt(this,t),this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=e,this.stepHead=new Jc(0,0,i?Object.assign({},i.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}return zt(t,[{key:"totalDuration",get:function(){return this.calcAttr(),this._totalDuration+this._startAt}},{key:"calcAttr",value:function(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}},{key:"bind",value:function(t){return this.target=t,this}},{key:"play",value:function(t){var e=t.duration;(null==e||e<0)&&(e=0);var i=t.easing,n="string"==typeof i?Vc[i]:i,r=this._addStep(e,null,n);return r.type=Ls.customAnimate,this._appendProps(t.getEndProps(),r,!1),this._appendCustomAnimate(t,r),this}},{key:"to",value:function(t,e,i,n){var r=this;(null==e||e<0)&&(e=0);var o="string"==typeof i?Vc[i]:i,a=this._addStep(e,null,o);return a.type=Ls.to,this._appendProps(t,a,!!n&&n.tempProps),a.propKeys||(a.propKeys=Object.keys(a.props)),n&&n.noPreventAttrs||this.target.animates.forEach((function(t){t.id!==r.animate.id&&t.preventAttrs(a.propKeys)})),this}},{key:"from",value:function(t,e,i,n){var r=this;this.to(t,0,i,n);var o={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach((function(t){o[t]=r.getLastPropByName(t,r.stepTail)})),this.to(o,e,i,n),this.stepTail.type=Ls.from}},{key:"startAt",value:function(t){return t<0&&(t=0),this._startAt=t,this}},{key:"getStartProps",value:function(){var t;return null===(t=this.stepHead)||void 0===t?void 0:t.props}},{key:"getEndProps",value:function(){return this.stepTail.props}},{key:"getLastStep",value:function(){return this._lastStep}},{key:"wait",value:function(t){if(t>0){var e=this._addStep(+t,null);e.type=Ls.wait,e.prev.customAnimate?e.props=e.prev.customAnimate.getEndProps():e.props=e.prev.props,this.target.onAddStep&&this.target.onAddStep(e)}return this}},{key:"_addStep",value:function(t,e,i){var n=new Jc(this.duration,t,e,i);return this.duration+=t,this.stepTail.append(n),this.stepTail=n,n}},{key:"_appendProps",value:function(t,e,i){var n=this;e.props=i?t:Object.assign({},t);var r=e.prev,o=e.props;for(e.propKeys||(e.propKeys=Object.keys(e.props)),e.propKeys.forEach((function(t){void 0===e.props[t]&&(e.props[t]=n.target.getDefaultAttribute(t))}));r.prev;)r.props&&(r.propKeys||(r.propKeys=Object.keys(r.props)),r.propKeys.forEach((function(t){void 0===o[t]&&(o[t]=r.props[t])}))),e.propKeys=Object.keys(e.props),r=r.prev;var a=this.stepHead.props;e.propKeys||(e.propKeys=Object.keys(o)),e.propKeys.forEach((function(t){if(void 0===a[t]){var e=n.animate.getStartProps();a[t]=e[t]=n.target.getComputedAttribute(t)}})),this.target.onAddStep&&this.target.onAddStep(e)}},{key:"_appendCustomAnimate",value:function(t,e){e.customAnimate=t,t.step=e,t.bind(this.target,this)}},{key:"setPosition",value:function(t){var e,i,n,r=this.duration,o=this.loop,a=this.rawPosition,s=!1,l=null!==(e=this._startAt)&&void 0!==e?e:0;if(t<0&&(t=0),t<l)return this.rawPosition=t,!1;if(r<=0)return s=!0;if(n=(t-=l)-(i=Math.floor(t/r))*r,(s=t>=o*r+r)&&(t=(n=r)*(i=o)+r),t===a)return s;var u=!this.reversed!=!(this.bounce&&i%2);return u&&(n=r-n),this._deltaPosition=n-this.position,this.position=n,this.rawPosition=t+l,this.updatePosition(s,u),s}},{key:"updatePosition",value:function(t,e){if(this.stepHead){var i=this.stepHead.next,n=this.position,r=this.duration;if(this.target&&i){for(var o=i.next;o&&o.position<=n;)o=(i=o).next;var a=t?0===r?1:n/r:(n-i.position)/i.duration;i.easing&&(a=i.easing(a)),this.tryCallCustomAnimateLifeCycle(i,this._lastStep||(e?this.stepTail:this.stepHead),e),this.updateTarget(i,a,t),this._lastStep=i,this.animate._onFrame&&this.animate._onFrame.forEach((function(t){return t(i,a)}))}}}},{key:"tryCallCustomAnimateLifeCycle",value:function(t,e,i){if(t!==e)if(i){for(var n=e.prev;n&&n!==t;)n.customAnimate&&(n.customAnimate.onStart&&n.customAnimate.onStart(),n.customAnimate.onEnd&&n.customAnimate.onEnd()),n=t.prev;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}else{for(var r=e.next;r&&r!==t;)r.customAnimate&&(r.customAnimate.onStart&&r.customAnimate.onStart(),r.customAnimate.onEnd&&r.customAnimate.onEnd()),r=r.next;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}}},{key:"getLastPropByName",value:function(t,e){for(var i=e.prev;i;){if(i.props&&void 0!==i.props[t])return i.props[t];if(i.customAnimate){var n=i.customAnimate.getEndProps()[t];if(void 0!==n)return n}i=i.prev}return gi.getInstance().warn("未知错误，step中找不到属性"),e.props[t]}},{key:"updateTarget",value:function(t,e,i){null==t.props&&null==t.customAnimate||this.target.onStep(this,this.animate,t,e,i)}}]),t}(),Jc=function(){function t(e,i,n,r){jt(this,t),this.duration=i,this.position=e,this.props=n,this.easing=r}return zt(t,[{key:"append",value:function(t){t.prev=this,t.next=this.next,this.next=t}},{key:"getLastProps",value:function(){for(var t=this.prev;t;){if(t.props)return t.props;if(t.customAnimate)return t.customAnimate.getMergedEndProps();t=t.prev}return null}}]),t}(),Qc=200,$c="cubicOut",th=1e3,eh="quadInOut";!function(t){t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=4]="Bottom",t[t.Left=8]="Left",t[t.ALL=15]="ALL"}(Zc||(Zc={}));var ih=[!1,!1,!1,!1],nh=[0,0,0,0],rh=function(t){return t?B(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(nh[0]=t[0],nh[2]=t[0],nh[1]=t[1],nh[3]=t[1],nh):t:t:0},oh=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],ah=[1,2,3,0,1,2,3,0];function sh(t,e,i,n){for(;t>=Wt;)t-=Wt;for(;t<0;)t+=Wt;for(;t>e;)e+=Wt;oh[0].x=i,oh[1].y=i,oh[2].x=-i,oh[3].y=-i;var r=Math.ceil(t/Vt)%4,o=Math.ceil(e/Vt)%4;if(n.add(Kt(t)*i,qt(t)*i),n.add(Kt(e)*i,qt(e)*i),r!==o||e-t>Nt)for(var a=!1,s=0;s<ah.length;s++)if(a||r!==ah[s]){if(a&&o===ah[s])break;if(a){var l=oh[ah[s]];n.add(l.x,l.y)}}else{a=!0;var u=oh[r];n.add(u.x,u.y)}}function lh(t,e,i){var n=ee(t.x,t.y,e.x,e.y,i),r=n.x,o=n.y,a=ee(t.x1,t.y1,e.x1,e.y1,i),s=a.x,l=a.y,u=new ae(r,o,s,l);return u.defined=e.defined,u}function uh(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);var n=[];if(t.length>e.length){n=e.map((function(t){var e=new ae(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var r=0;r<e.length;r++)n[r]=lh(t[r],e[r],i)}else{n=e.map((function(t){var e=new ae(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e}));for(var o=0;o<t.length;o++)n[o]=lh(t[o],e[o],i)}return n}var ch=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"];function hh(t,e){if(B(t)){for(var i,n=0;n<t.length&&void 0===i;n++)i=t[n][e];return i}return t[e]}var dh=function(){function t(){jt(this,t),this.durations=[],this.timeout=t.TimeOut,this.lastDate=0,this.durationsListThreshold=30}return zt(t,[{key:"call",value:function(t){var e=this;return this.lastDate=Date.now(),setTimeout((function(){e.appendDuration(Date.now()-e.lastDate),t(0)}),this.timeout,!0)}},{key:"clear",value:function(t){clearTimeout(t)}},{key:"appendDuration",value:function(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((function(t,e){return t+e}),0)/this.durations.length,1e3/60),1e3/30)}}]),t}();dh.TimeOut=1e3/60;var fh=new dh,ph=function(t,e){return P(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t};function vh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var yh,gh=function(t){ue(i,t);var e=vh(i);function i(t,n,r,o,a){return jt(this,i),e.call(this,t,n,r,o,a)}return zt(i,[{key:"getEndProps",value:function(){return!1===this.valid?{}:{text:this.to}}},{key:"onBind",value:function(){var t,e,i,n,r,o,a,s;this.fromNumber=I(null===(t=this.from)||void 0===t?void 0:t.text)?null===(e=this.from)||void 0===e?void 0:e.text:Number.parseFloat(null===(i=this.from)||void 0===i?void 0:i.text),this.toNumber=I(null===(n=this.to)||void 0===n?void 0:n.text)?null===(r=this.to)||void 0===r?void 0:r.text:Number.parseFloat(null===(o=this.to)||void 0===o?void 0:o.text),Number.isFinite(this.toNumber)||(this.fromNumber=0),Number.isFinite(this.toNumber)||(this.valid=!1),!1!==this.valid&&(this.decimalLength=null!==(s=null===(a=this.params)||void 0===a?void 0:a.fixed)&&void 0!==s?s:Math.max(re(this.fromNumber),re(this.toNumber)))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){!1!==this.valid&&(i.text=t?this.toNumber:(this.fromNumber+(this.toNumber-this.fromNumber)*e).toFixed(this.decimalLength))}}]),i}(Yc);!function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",t[t.TOP_TO_BOTTOM=2]="TOP_TO_BOTTOM",t[t.BOTTOM_TO_TOP=3]="BOTTOM_TO_TOP",t[t.STROKE=4]="STROKE"}(yh||(yh={}));var mh=function(t){ue(i,t);var e=vh(i);function i(t,n,r,o,a){var s;return jt(this,i),(s=e.call(this,t,n,r,o,a)).newPointAnimateType="appear"===(null==a?void 0:a.newPointAnimateType)?"appear":"grow",s}return zt(i,[{key:"onBind",value:function(){var t,e,i=this,n=null===(t=this.from)||void 0===t?void 0:t.points,r=null===(e=this.to)||void 0===e?void 0:e.points;this.fromPoints=n?Array.isArray(n)?n:[n]:[],this.toPoints=r?Array.isArray(r)?r:[r]:[];var o=new Map;this.fromPoints.forEach((function(t){t.context&&o.set(t.context,t)}));for(var a,s,l=1/0,u=-1/0,c=0;c<this.toPoints.length;c+=1)if(o.has(this.toPoints[c].context)){l=c,a=o.get(this.toPoints[c].context);break}for(var h=this.toPoints.length-1;h>=0;h-=1)if(o.has(this.toPoints[h].context)){u=h,s=o.get(this.toPoints[h].context);break}var d=this.toPoints[0];this.interpolatePoints=this.toPoints.map((function(t,e){var n=o.get(t.context);return n?(d=n,[n,t]):"appear"===i.newPointAnimateType?[t,t]:e<l&&a?[a,t]:e>u&&s?[s,t]:[d,t]})),this.points=this.interpolatePoints.map((function(t){var e=t[0],i=t[1],n=new ae(e.x,e.y,e.x1,e.y1);return n.defined=i.defined,n.context=i.context,n}))}},{key:"onUpdate",value:function(t,e,i){var n=this;this.points=this.points.map((function(t,i){var r=lh(n.interpolatePoints[i][0],n.interpolatePoints[i][1],e);return r.context=t.context,r})),i.points=this.points}}]),i}(Yc),_h=function(t){ue(i,t);var e=vh(i);function i(t,n,r,o,a){var s;return jt(this,i),(s=e.call(this,null,null,r,o,a)).clipFromAttribute=t,s.clipToAttribute=n,s._group=null==a?void 0:a.group,s._clipGraphic=null==a?void 0:a.clipGraphic,s}return zt(i,[{key:"onBind",value:function(){this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:Rs.ANIMATE_BIND}))}},{key:"onEnd",value:function(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:Rs.ANIMATE_END})}},{key:"onUpdate",value:function(t,e,i){var n=this;if(this._clipGraphic){var r={};Object.keys(this.clipFromAttribute).forEach((function(t){r[t]=n.clipFromAttribute[t]+(n.clipToAttribute[t]-n.clipFromAttribute[t])*e})),this._clipGraphic.setAttributes(r,!1,{type:Rs.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}}]),i}(Yc),bh=function(t){ue(i,t);var e=vh(i);function i(t,n,r,o,a){var s,l,u,c,h,d,f,p,v,y,g,m;jt(this,i);var _=null!==(l=null===(s=null==a?void 0:a.group)||void 0===s?void 0:s.attribute)&&void 0!==l?l:{},b=null!==(u=_.width)&&void 0!==u?u:0,x=null!==(c=_.height)&&void 0!==c?c:0,k=null!==(h=null==a?void 0:a.animationType)&&void 0!==h?h:"in",S=null!==(d=null==a?void 0:a.startAngle)&&void 0!==d?d:0,A=null!==(f=null==a?void 0:a.orient)&&void 0!==f?f:"clockwise",w=0,T=0;"anticlockwise"===A?(T="in"===k?S+2*Math.PI:S,T=S+2*Math.PI):(w=S,T="out"===k?S+2*Math.PI:S);var M,C,E=nu.graphicService.creator.arc({x:null!==(v=null===(p=null==a?void 0:a.center)||void 0===p?void 0:p.x)&&void 0!==v?v:b/2,y:null!==(g=null===(y=null==a?void 0:a.center)||void 0===y?void 0:y.y)&&void 0!==g?g:x/2,outerRadius:null!==(m=null==a?void 0:a.radius)&&void 0!==m?m:(b+x)/2,innerRadius:0,startAngle:w,endAngle:T,fill:!0});return"anticlockwise"===A?(M={startAngle:S+2*Math.PI},C={startAngle:S}):(M={endAngle:S},C={endAngle:S+2*Math.PI}),e.call(this,"in"===k?M:C,"in"===k?C:M,r,o,{group:null==a?void 0:a.group,clipGraphic:E})}return zt(i)}(_h),xh=function(t){ue(i,t);var e=vh(i);function i(t,n,r,o,a){var s,l,u,c,h,d,f,p,v;jt(this,i);var y=null!==(l=null===(s=null==a?void 0:a.group)||void 0===s?void 0:s.attribute)&&void 0!==l?l:{},g=null!==(c=null!==(u=null==a?void 0:a.width)&&void 0!==u?u:y.width)&&void 0!==c?c:0,m=null!==(d=null!==(h=null==a?void 0:a.height)&&void 0!==h?h:y.height)&&void 0!==d?d:0,_=null!==(f=null==a?void 0:a.animationType)&&void 0!==f?f:"in",b=null!==(p=null==a?void 0:a.direction)&&void 0!==p?p:"x",x=null!==(v=null==a?void 0:a.orient)&&void 0!==v?v:"positive",k=nu.graphicService.creator.rect({x:0,y:0,width:"in"===_&&"x"===b?0:g,height:"in"===_&&"y"===b?0:m,fill:!0}),S={},A={};return"y"===b?"negative"===x?(S={y:m,height:0},A={y:0,height:m}):(S={height:0},A={height:m}):"negative"===x?(S={x:g,width:0},A={x:0,width:g}):(S={width:0},A={width:g}),e.call(this,"in"===_?S:A,"in"===_?A:S,r,o,{group:null==a?void 0:a.group,clipGraphic:k})}return zt(i)}(_h),kh=function(t){ue(i,t);var e=vh(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"onStart",value:function(){var t="function"==typeof this.params?this.params():this.params,e=t.center,i=t.r,n=this.target.getComputedAttribute("x"),r=this.target.getComputedAttribute("y"),o=this.target.getComputedAttribute("z"),a=Math.acos((r-e.y)/i),s=Math.acos((n-e.x)/i/Math.sin(a));o-e.z<0&&(s=Wt-s),this.theta=s,this.phi=a}},{key:"onBind",value:function(){}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){if(null!=this.phi&&null!=this.theta){var n="function"==typeof this.params?this.params():this.params,r=n.center,o=n.r,a=n.cb,s=2*Math.PI*e,l=this.theta+s,u=this.phi,c=o*Math.sin(u)*Math.cos(l)+r.x,h=o*Math.cos(u)+r.y,d=o*Math.sin(u)*Math.sin(l)+r.z;for(i.x=c,i.y=h,i.z=d,i.alpha=l+Nt/2;i.alpha>Wt;)i.alpha-=Wt;i.alpha=Wt-i.alpha,i.zIndex=-1e4*i.z,a&&a(i)}}}]),i}(Yc),Sh=function(t){ue(i,t);var e=vh(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.setTheme({common:{opacity:1}})}},{key:"onEnd",value:function(){this.target.setTheme({common:{opacity:0}})}},{key:"onUpdate",value:function(t,e,i){this.target.setTheme({common:{opacity:1-e}})}}]),i}(Yc),Ah=function(t){ue(i,t);var e=vh(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,null,null,t,"linear")).customAnimates=n,r}return zt(i,[{key:"initAnimates",value:function(){var t=this;this.customAnimates.forEach((function(e){e.step=t.step,e.subAnimate=t.subAnimate,e.target=t.target}))}},{key:"getEndProps",value:function(){var t={};return this.customAnimates.forEach((function(e){Object.assign(t,e.getEndProps())})),t}},{key:"onBind",value:function(){this.initAnimates(),this.customAnimates.forEach((function(t){t.onBind()}))}},{key:"onEnd",value:function(){this.customAnimates.forEach((function(t){t.onEnd()}))}},{key:"onStart",value:function(){this.customAnimates.forEach((function(t){t.onStart()}))}},{key:"onUpdate",value:function(t,e,i){this.updating||(this.updating=!0,this.customAnimates.forEach((function(n){var r=n.easing,o="string"==typeof r?Vc[r]:r;e=o(e),n.onUpdate(t,e,i)})),this.updating=!1)}}]),i}(Yc);function wh(t,e,i,n,r,o){var a=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-a)*r+a,c=(l-s)*r+s,h=(c-u)*r+u;o[0]=t,o[1]=a,o[2]=u,o[3]=h,o[4]=h,o[5]=c,o[6]=l,o[7]=n}function Th(t,e){var i=t.length,n=e.length;if(i===n)return[t,e];for(var r=[],o=[],a=i<n?t:e,s=Math.min(i,n),l=Math.abs(n-i)/6,u=(s-2)/6,c=Math.ceil(l/u),h=[a[0],a[1]],d=l,f=2;f<s;f+=6){var p=a[f-2],v=a[f-1],y=a[f],g=a[f+1],m=a[f+2],_=a[f+3],b=a[f+4],x=a[f+5];if(d<=0)h.push(y,g,m,_,b,x);else{for(var k=Math.min(d,c)+1,S=1;S<=k;S++){var A=S/k;wh(p,y,m,b,A,r),wh(v,g,_,x,A,o),p=r[3],v=o[3],h.push(r[1],o[1],r[2],o[2],p,v),y=r[5],g=o[5],m=r[6],_=o[6]}d-=k-1}}return a===t?[h,e]:[t,h]}function Mh(t,e){for(var i=t||e,n=i.length,r=i[n-2],o=i[n-1],a=[],s=0;s<e.length;s+=2)a[s]=r,a[s+1]=o;return a}function Ch(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[n]=t[i-n-2],e[n+1]=t[i-n-1];return e}function Eh(t){for(var e=0,i=0,n=0,r=t.length,o=0,a=r-2;o<r;a=o,o+=2){var s=t[a],l=t[a+1],u=t[o],c=t[o+1],h=s*c-u*l;e+=h,i+=(s+u)*h,n+=(l+c)*h}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,n/e/3,e]}function Rh(t,e,i,n){for(var r=(t.length-2)/6,o=1/0,a=0,s=t.length,l=s-2,u=0;u<r;u++){for(var c=6*u,h=0,d=0;d<s;d+=2){var f=0===d?c:(c+d-2)%l+2,p=t[f]-i[0],v=t[f+1]-i[1],y=e[d]-n[0]-p,g=e[d+1]-n[1]-v;h+=y*y+g*g}h<o&&(o=h,a=u)}return a}var Ph=function(t,e,i,n,r){kt(e,n)&&kt(i,r)||t.push(e,i,n,r,n,r)};function Bh(t){for(var e,i,n,r,o,a=t.commandList,s=[],l=0,u=0,c=0,h=0,d=function(t,i){e&&e.length>2&&s.push(e),e=[t,i]},f=0,p=a.length;f<p;f++){var v=a[f],y=0===f;switch(y&&(c=l=v[1],h=u=v[2],[Vs.L,Vs.C,Vs.Q].includes(v[0])&&(e=[c,h])),v[0]){case Vs.M:l=c=v[1],u=h=v[2],d(c,h);break;case Vs.L:i=v[1],n=v[2],Ph(e,l,u,i,n),l=i,u=n;break;case Vs.C:e.push(v[1],v[2],v[3],v[4],l=v[5],u=v[6]);break;case Vs.Q:i=v[1],n=v[2],r=v[3],o=v[4],e.push(l+2/3*(i-l),u+2/3*(n-u),r+2/3*(i-r),o+2/3*(n-o),r,o),l=r,u=o;break;case Vs.A:var g=v[1],m=v[2],_=v[3],b=_,x=v[4],k=v[5],S=!!v[6];i=Math.cos(x)*_+g,n=Math.sin(x)*_+m,y?d(c=i,h=n):Ph(e,l,u,i,n),l=Math.cos(k)*_+g,u=Math.sin(k)*_+m;for(var A=(S?-1:1)*Math.PI/2,w=x;S?w>k:w<k;w+=A){var T=S?Math.max(w+A,k):Math.min(w+A,k);Us(e,w,T,g,m,_,b)}break;case Vs.E:var M=v[1],C=v[2],E=v[3],R=v[4],P=v[5],B=v[6],L=v[7]+B,O=!!v[8],I=!kt(P,0),D=Math.cos(P),F=Math.sin(P),z=Math.cos(B)*E,j=Math.sin(B)*R;I?(i=z*D-j*F+M,n=z*F+j*D+C):(i=z+M,n=j+C),y?d(c=i,h=n):Ph(e,l,u,i,n),z=Math.cos(L)*E,j=Math.sin(L)*R,I?(l=z*D-j*F+M,u=z*F+j*D+C):(l=z+M,u=j+C);for(var H=(O?-1:1)*Math.PI/2,N=B;O?N>L:N<L;N+=H){var V=O?Math.max(N+H,L):Math.min(N+H,L);if(Us(e,N,V,M,C,E,R),I)for(var G=e.length,W=G-6;W<=G-1;W+=2)z=e[W],j=e[W+1],e[W]=(z-M)*D-(j-C)*F+M,e[W+1]=(z-M)*F+(j-C)*D+C}break;case Vs.R:c=l=v[1],h=u=v[2],i=c+v[3],n=h+v[4],d(i,h),Ph(e,i,h,i,n),Ph(e,i,n,c,n),Ph(e,c,n,c,h),Ph(e,c,h,i,h);break;case Vs.AT:var U=v[1],Y=v[2],K=v[3],X=v[4],Z=v[5],q=se.distancePP({x:l,y:u},{x:U,y:Y}),J=se.distancePP({x:K,y:X},{x:U,y:Y}),Q=((l-U)*(K-U)+(u-Y)*(X-Y))/(q*J),$=Z/Math.sin(Q/2),tt=(l+K-2*U)/2,et=(u+X-2*Y)/2,it=se.distancePP({x:tt,y:et},{x:0,y:0}),nt=U+$*tt/it,rt=K+$*et/it,ot=Math.sqrt($*$-Z*Z);Ph(e,l,u,c=U+ot*(l-U)/q,h=Y+ot*(u-Y)/q),l=U+ot*(K-U)/J,u=Y+ot*(X-Y)/J;var at=xe({x:nt,y:rt},{x:c,y:h}),st=xe({x:nt,y:rt},{x:l,y:u});Us(e,at,st,nt,rt,Z,Z);break;case Vs.Z:e&&Ph(e,l,u,c,h),l=c,u=h}}return e&&e.length>2&&s.push(e),s}function Lh(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r+=2){var o=n[r],a=n[r+1],s={x:o,y:a};e.transformPoint({x:o,y:a},s),n[r]=s.x,n[r+1]=s.y}}function Oh(t){for(var e=new Pl,i=0;i<t.length;i++){var n=t[i];if(n.length>2){e.moveTo(n[0],n[1]);for(var r=2;r<n.length;r+=6)e.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5])}}return e}var Ih=function(t){if(!t)return{x:0,y:0,width:0,height:0};var e=w(t.width)?t.x1-t.x:t.width,i=w(t.height)?t.y1-t.y:t.height,n=0,r=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(r=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:r,width:e,height:i}};function Dh(t,e,i){var n,r,o=t/e;t>=e?(r=Math.ceil(Math.sqrt(i*o)),0===(n=Math.floor(i/r))&&(n=1,r=i)):(n=Math.ceil(Math.sqrt(i/o)),0===(r=Math.floor(i/n))&&(r=1,n=i));for(var a=[],s=0;s<n;s++)a.push(r);var l=i-n*r;if(l>0)for(var u=0;u<l;u+=r)u+r<l?a.push(r):a.push(l-u);return a}var Fh=function(t,e){var i=t.filter((function(t){return!1!==t.defined&&I(t.x)&&I(t.y)}));if(0===i.length)return[];if(1===i.length)return new Array(e).fill(0).map((function(t){return i[0]}));var n=[];if(e<=i.length){for(var r=i.length/e,o=0,a=0;o<e;)n.push(i[Math.floor(a)]),a+=r,o++;return n}for(var s=e-i.length,l=1/(s/(i.length-1)+1),u=0,c=0,h=t.length;c<h;c++)if(n.push(t[c]),c<h-1)for(var d=l,f=t[c].x,p=t[c].y,v=t[c+1].x,y=t[c+1].y;d<1&&u<s;)n.push({x:f+(v-f)*d,y:p+(y-p)*d}),d+=l,u+=1;return n};var zh,jh=function(t){return t.map((function(t){return{x:t.x,y:t.y}}))},Hh=function(t,e,i){for(var n,r,o,a=t.length,s=[],l=0;l<a;l++){var u=t[l],c=l===a-1?t[0]:t[l+1],h=qe([e.x,e.y],[i.x,i.y],[u.x,u.y],[c.x,c.y]);h&&"boolean"!=typeof h&&s.push({dot:(r=[h[0]-e.x,h[1]-e.x],o=[i.x-e.x,i.y-e.x],r[0]*o[1]-r[1]*o[0]),point:{x:h[0],y:h[1]},edgeIndex:l})}if(s.length<2)return[jh(t),jh(t)];s.sort((function(t,e){return t.dot-e.dot}));var d=s[0],f=s[s.length-1];d.edgeIndex>f.edgeIndex&&(d=(n=[f,d])[0],f=n[1]);for(var p=d.point,v=f.point,y=[{x:p.x,y:p.y}],g=d.edgeIndex+1;g<=f.edgeIndex;g++)y.push({x:t[g].x,y:t[g].y});y.push({x:v.x,y:v.y});for(var m=[{x:v.x,y:v.y}],_=f.edgeIndex+1,b=d.edgeIndex+a;_<=b;_++){var x=t[_%a];m.push({x:x.x,y:x.y})}return m.push({x:p.x,y:p.y}),[y,m]},Nh=function t(e,i,n){if(1===i)n.push({points:e});else{var r=Math.floor(i/2),o=function(t){var e=new ve;t.forEach((function(t){e.add(t.x,t.y)}));var i=e.width(),n=e.height();if(i>=n){var r=e.x1+i/2;return Hh(t,{x:r,y:e.y1},{x:r,y:e.y2})}var o=e.y1+n/2;return Hh(t,{x:e.x1,y:o},{x:e.x2,y:o})}(e);t(o[0],r,n),t(o[1],i-r,n)}};!function(t){t[t.Color255=0]="Color255",t[t.Color1=1]="Color1"}(zh||(zh={}));var Vh=function(){function t(){jt(this,t)}return zt(t,null,[{key:"Get",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zh.Color1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1];if(i===zh.Color1){var r=t.store1[e];if(r)return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n;var o=Ye.parseColorString(e);if(o){var a=[o.r/255,o.g/255,o.b/255,o.opacity];t.store1[e]=a,t.store255[e]=[o.r,o.g,o.b,o.opacity],n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3]}return n}var s=t.store255[e];if(s)return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n;var l=Ye.parseColorString(e);return l&&(t.store1[e]=[l.r/255,l.g/255,l.b/255,l.opacity],t.store255[e]=[l.r,l.g,l.b,l.opacity],n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.opacity),n}},{key:"Set",value:function(e,i,n){if(i===zh.Color1){if(t.store1[e])return;t.store1[e]=n,t.store255[e]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(t.store255[e])return;t.store255[e]=n,t.store1[e]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}]),t}();function Gh(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(t)?e?"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),",").concat(t[3].toFixed(2),")"):"rgb(".concat(Math.round(t[0]),",").concat(Math.round(t[1]),",").concat(Math.round(t[2]),")"):t}function Wh(t,e,i,n,r){if(!t||!e)return t&&Gh(t)||e&&Gh(e)||!1;var o,a,s=!1,l=!1;if(Array.isArray(t)?o=t:"string"==typeof t?o=Vh.Get(t,zh.Color255):s=!0,Array.isArray(e)?a=e:"string"==typeof e?a=Vh.Get(e,zh.Color255):l=!0,s!==l){var u=s?t:e,c=s?e:t,h=Object.assign(Object.assign({},u),{stops:u.stops.map((function(t){return Object.assign(Object.assign({},t),{color:Gh(c)})}))});return s?Wh(u,h,i,n,r):Wh(h,u,i,n,r)}if(s){if(t.gradient===e.gradient){var d=t,f=e,p=d.stops,v=f.stops;if(p.length!==v.length)return!1;if("linear"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"linear",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Kh(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,f,i);if("radial"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"radial",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,r0:t.r0+(e.r0-t.r0)*i,r1:t.r1+(e.r1-t.r1)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Kh(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,f,i);if("conical"===d.gradient)return function(t,e,i){var n=t.stops,r=e.stops;return{gradient:"conical",startAngle:t.startAngle+(e.startAngle-t.startAngle)*i,endAngle:t.endAngle+(e.endAngle-t.endAngle)*i,x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i,stops:new Array(n.length).fill(0).map((function(t,e){return{color:Kh(n[e].color,r[e].color,i),offset:n[e].offset+(r[e].offset-n[e].offset)*i}}))}}(d,f,i)}return!1}return r&&r(o,a),Gh(function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i,t[2]+(e[2]-t[2])*i,t[3]+(e[3]-t[3])*i]}(o,a,i),n)}Vh.store255={},Vh.store1={};var Uh=[0,0,0,0],Yh=[0,0,0,0];function Kh(t,e,i){return Vh.Get(t,zh.Color255,Uh),Vh.Get(e,zh.Color255,Yh),"rgba(".concat(Math.round(Uh[0]+(Yh[0]-Uh[0])*i),",").concat(Math.round(Uh[1]+(Yh[1]-Uh[1])*i),",").concat(Math.round(Uh[2]+(Yh[2]-Uh[2])*i),",").concat(Uh[3]+(Yh[3]-Uh[3])*i,")")}function Xh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Zh=function(t,e,i){t.forEach((function(t){if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){var n=Wh(t.from,t.to,i,!1);n&&(e[t.key]=n)}}))},qh=function(t,e,i){var n=[],r=[];e.clear();for(var o=0;o<t.length;o++){var a=t[o],s=a.from,l=a.to,u=a.rotation*i,c=a.fromCp,h=a.toCp,d=Math.sin(u),f=Math.cos(u);r[0]=c[0]+(h[0]-c[0])*i,r[1]=c[1]+(h[1]-c[1])*i;for(var p=0;p<s.length;p+=2){var v=s[p],y=s[p+1],g=v*(1-i)+l[p]*i,m=y*(1-i)+l[p+1]*i;n[p]=g*f-m*d+r[0],n[p+1]=g*d+m*f+r[1]}var _=n[0],b=n[1];e.moveTo(_,b);for(var x=2;x<s.length;x+=6){var k=n[x],S=n[x+1],A=n[x+2],w=n[x+3],T=n[x+4],M=n[x+5];_===k&&b===S&&A===T&&w===M?e.lineTo(T,M):e.bezierCurveTo(k,S,A,w,T,M),_=T,b=M}}},Jh=function(t,e,i){var n=t?Bh(t):[],r=Bh(e);i&&n&&(i.fromTransform&&Lh(n,i.fromTransform.clone().getInverse()),Lh(n,i.toTransfrom));var o=function(t,e){for(var i,n,r=[],o=[],a=0;a<Math.max(t.length,e.length);a++){var s,l=t[a],u=e[a],c=void 0,h=void 0;l?u?(i=c=(s=Mt(Th(l,u),2))[0],n=h=s[1]):(h=Mh(n,l),c=l):(c=Mh(i,u),h=u),r.push(c),o.push(h)}return[r,o]}(n,r),a=Mt(o,2),s=a[0],l=a[1];return t?function(t,e,i,n){for(var r,o=[],a=0;a<t.length;a++){var s=t[a],l=e[a],u=Eh(s),c=Eh(l);null==r&&(r=u[2]<0!=c[2]<0);var h=[],d=[],f=0,p=1/0,v=[],y=s.length;r&&(s=Ch(s));for(var g=6*Rh(s,l,u,c),m=y-2,_=0;_<m;_+=2){var b=(g+_)%m+2;h[_+2]=s[b]-u[0],h[_+3]=s[b+1]-u[1]}if(h[0]=s[g]-u[0],h[1]=s[g+1]-u[1],i>0)for(var x=n/i,k=-n/2;k<=n/2;k+=x){for(var S=Math.sin(k),A=Math.cos(k),w=0,T=0;T<s.length;T+=2){var M=h[T],C=h[T+1],E=l[T]-c[0],R=l[T+1]-c[1],P=E*A-R*S,B=E*S+R*A;v[T]=P,v[T+1]=B;var L=P-M,O=B-C;w+=L*L+O*O}if(w<p){p=w,f=k;for(var I=0;I<v.length;I++)d[I]=v[I]}}else for(var D=0;D<y;D+=2)d[D]=l[D]-c[0],d[D+1]=l[D+1]-c[1];o.push({from:h,to:d,fromCp:u,toCp:c,rotation:-f})}return o}(s,l,10,Math.PI):l.map((function(t,e){return{from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}}))},Qh=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],$h=function(t,e){if(!t||!e)return null;var i=[],n=!1;return Object.keys(t).forEach((function(r){if(Qh.includes(r)){var o=e[r];w(o)||w(t[r])||o===t[r]||("fill"===r||"stroke"===r?i.push({from:"string"==typeof t[r]?Vh.Get(t[r],zh.Color255):t[r],to:"string"==typeof o?Vh.Get(o,zh.Color255):o,key:r}):i.push({from:t[r],to:o,key:r}),n=!0)}})),n?i:null},td=function(t){ue(i,t);var e=Xh(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,0,1,n,r)).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o.saveOnEnd=t.saveOnEnd,o}return zt(i,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this.target,r="function"==typeof n.pathProxy?n.pathProxy(n.attribute):n.pathProxy;qh(this.morphingData,r,e),this.otherAttrs&&this.otherAttrs.length&&Zh(this.otherAttrs,i,e),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}]),i}(Yc),ed=function(t,e,i,n){var r,o,a;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;var s=null==t?void 0:t.globalTransMatrix;n&&s&&(s=n.clone().multiply(s.a,s.b,s.c,s.d,s.e,s.f));var l=Jh(null===(r=null==t?void 0:t.toCustomPath)||void 0===r?void 0:r.call(t),e.toCustomPath(),{fromTransform:s,toTransfrom:e.globalTransMatrix}),u=$h(null==t?void 0:t.attribute,e.attribute),c=e.animate(i);return(null==i?void 0:i.delay)&&c.wait(i.delay),c.play(new td({morphingData:l,otherAttrs:u},null!==(o=null==i?void 0:i.duration)&&void 0!==o?o:th,null!==(a=null==i?void 0:i.easing)&&void 0!==a?a:eh)),c},id=function(t){ue(i,t);var e=Xh(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,0,1,n,r)).morphingData=t.morphingData,o.otherAttrs=t.otherAttrs,o}return zt(i,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.addPathProxy()}},{key:"addPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.createPathProxy()})),this.onUpdate(!1,0,this.target.attribute)}},{key:"clearPathProxy",value:function(){this.target.shadowRoot.forEachChildren((function(t){t.pathProxy=null}))}},{key:"onEnd",value:function(){}},{key:"onUpdate",value:function(t,e,i){var n=this;this.target.shadowRoot.forEachChildren((function(t,i){var r;qh(n.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null===(r=n.otherAttrs)||void 0===r?void 0:r[i])&&n.otherAttrs[i].length&&Zh(n.otherAttrs[i],t.attribute,e)})),t&&(this.clearPathProxy(),this.morphingData=null)}}]),i}(Yc),nd=function(t){var e={};return Object.keys(t).forEach((function(i){(function(t){return ch.includes(t)})(i)||(e[i]=t[i])})),e},rd=function(t,e,i){var n=nd(t.attribute),r=t.attachShadow();if(e.length)r.setTheme(v({},e[0].type,n)),e.forEach((function(t){r.appendChild(t)}));else{var o=t.AABBBounds,a=o.width(),s=o.height();r.setTheme({rect:n}),new Array(i).fill(0).forEach((function(t){var i=nu.graphicService.creator.rect({x:0,y:0,width:a,height:s});r.appendChild(i),e.push(i)}))}},od=function(t,e,i){for(var n=[],r=i?null:nd(t.attribute),o=t.toCustomPath(),a=0;a<e;a++){var s={path:(new Pl).fromCustomPath2D(o)};n.push(nu.graphicService.creator.path(i?s:Object.assign({},r,s)))}return i&&rd(t,n,e),n},ad=function(t,e,i){var n=[],r=i?null:nd(t.attribute);if("rect"===t.type)(function(t,e){for(var i=Ih(t.attribute),n=i.width,r=i.height,o=Dh(n,r,e),a=[],s=r/o.length,l=0,u=o.length;l<u;l++)for(var c=o[l],h=n/c,d=0;d<c;d++)a.push({x:0+d*h,y:0+l*s,width:h,height:s});return a})(t,e).forEach((function(t){n.push(nu.graphicService.creator.rect(i?t:Object.assign({},r,t)))}));else if("arc"===t.type)(function(t,e){for(var i=t.getParsedAngle(),n=i.startAngle,r=i.endAngle,o=t.getComputedAttribute("innerRadius"),a=t.getComputedAttribute("outerRadius"),s=Math.abs(n-r),l=Math.abs(a-o),u=Dh(s*(o+a)/2,l,e),c=[],h=l/u.length,d=a>=o?1:-1,f=r>=n?1:-1,p=0,v=u.length;p<v;p++)for(var y=u[p],g=s/y,m=0;m<y;m++)c.push({innerRadius:a-h*p*d,outerRadius:a-h*(p+1)*d,startAngle:n+g*m*f,endAngle:n+g*(m+1)*f});return c})(t,e).forEach((function(t){n.push(nu.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("circle"===t.type)(function(t,e){for(var i=t.getComputedAttribute("startAngle"),n=t.getComputedAttribute("endAngle"),r=t.getComputedAttribute("radius"),o=Math.abs(i-n),a=Dh(o*r,r,e),s=[],l=o/a[0],u=r/a.length,c=n>=i?1:-1,h=0,d=a.length;h<d;h++)for(var f=0,p=a[h];f<p;f++)s.push({innerRadius:u*h,outerRadius:u*(h+1),startAngle:i+l*f*c,endAngle:i+l*(f+1)*c});return s})(t,e).forEach((function(t){n.push(nu.graphicService.creator.arc(i?t:Object.assign({},r,t)))}));else if("line"===t.type){var o=function(t,e){var i=t.attribute,n=i.points;if(n)return Fh(n,e);if(i.segments){var r=i.segments.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]);return Fh(r,e)}return[]}(t,e),a={size:10,symbolType:"circle"};o.forEach((function(t){n.push(nu.graphicService.creator.symbol(i?Object.assign({},t,a):Object.assign({},r,t,a)))}))}else"polygon"===t.type?function(t,e){var i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:jh(i)}];var n=[];return Nh(i,e,n),n}(t,e).forEach((function(t){n.push(nu.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"area"===t.type?function(t,e){var i,n,r=t.attribute,o=r.points,a=r.segments;o||(o=a.reduce((function(t,e){var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])}),[]));var s=o.filter((function(t){return!1!==t.defined&&I(t.x)&&I(t.y)}));if(!s.length)return[];var l=[];s.forEach((function(t){l.push({x:t.x,y:t.y})}));for(var u=s.length-1;u>=0;u--){var c=s[u];l.push({x:null!==(i=c.x1)&&void 0!==i?i:c.x,y:null!==(n=c.y1)&&void 0!==n?n:c.y})}var h=[];return Nh(o,e,h),h}(t,e).forEach((function(t){n.push(nu.graphicService.creator.polygon(i?t:Object.assign({},r,t)))})):"path"===t.type&&function(t,e){var i=Bh(t.getParsedPathShape());if(!i.length||e<0)return[];var n=i.length;if(i.length>=e){for(var r=[],o=Math.floor(i.length/e),a=0;a<e;a++){var s=i.slice(a*o,a===e-1?n:(a+1)*o);r.push({path:Oh(s)})}return r}for(var l=[],u=Math.floor(e/n),c=e,h=0;h<n;h++){for(var d=[],f=2,p=i[h].length;f<p;f+=2)d.push({x:i[0][f],y:i[0][f+1]});Nh(d,h===n-1?c:u,l),c-=u}return l}(t,e).forEach((function(t){"path"in t?n.push(nu.graphicService.creator.path(i?t:Object.assign({},r,t))):n.push(nu.graphicService.creator.polygon(i?t:Object.assign({},r,t)))}));return i&&rd(t,n,e),n},sd=function(){function t(){jt(this,t)}return zt(t,null,[{key:"GetImage",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?nu.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&i.imageLoadSuccess(e,r.data):(r={type:"image",loadState:"init"},t.cache.set(e,r),r.dataPromise=nu.global.loadImage(e),r.dataPromise?(r.waitingMark=[i],r.dataPromise.then((function(t){var i;r.loadState=(null==t?void 0:t.data)?"success":"fail",r.data=null==t?void 0:t.data,null===(i=r.waitingMark)||void 0===i||i.map((function(i,n){(null==t?void 0:t.data)?(r.loadState="success",r.data=t.data,i.imageLoadSuccess(e,t.data)):(r.loadState="fail",i.imageLoadFail(e))}))}))):(r.loadState="fail",i.imageLoadFail(e)))}},{key:"GetSvg",value:function(e,i){var n,r=t.cache.get(e);r?"fail"===r.loadState?nu.global.getRequestAnimationFrame()((function(){i.imageLoadFail(e)})):"init"===r.loadState||"loading"===r.loadState?null===(n=r.waitingMark)||void 0===n||n.push(i):i&&nu.global.getRequestAnimationFrame()((function(){i.imageLoadSuccess(e,r.data)})):(r={type:"image",loadState:"init"},t.cache.set(e,r),r.dataPromise=nu.global.loadSvg(e),r.dataPromise?(r.waitingMark=[i],r.dataPromise.then((function(t){var i;r.loadState=(null==t?void 0:t.data)?"success":"fail",r.data=null==t?void 0:t.data,null===(i=r.waitingMark)||void 0===i||i.map((function(i,n){(null==t?void 0:t.data)?(r.loadState="success",r.data=t.data,i.imageLoadSuccess(e,t.data)):(r.loadState="fail",i.imageLoadFail(e))}))}))):(r.loadState="fail",i.imageLoadFail(e)))}},{key:"GetFile",value:function(e,i){var n=t.cache.get(e);return n?"init"===n.loadState||"fail"===n.loadState?Promise.reject():"loading"===n.loadState?n.dataPromise.then((function(t){return t.data})):Promise.resolve(n.data):(n={type:i,loadState:"init"},t.cache.set(e,n),"arrayBuffer"===i?n.dataPromise=nu.global.loadArrayBuffer(e):"blob"===i?n.dataPromise=nu.global.loadBlob(e):"json"===i&&(n.dataPromise=nu.global.loadJson(e)),n.dataPromise.then((function(t){return t.data})))}}]),t}();function ld(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}sd.cache=new Map;var ud=new ke,cd=new ye,hd=["lineWidth","scaleX","scaleY","angle","anchor","visible"],dd=["x","y"],fd=["scaleX","scaleY"],pd=["angle"],vd=new ae,yd={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1},gd=function(t){ue(i,t);var e=ld(i);function i(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jt(this,i),(t=e.call(this))._AABBBounds=new ye,t._updateTag=Cs.INIT,t.attribute=r,t.valid=t.isValid(),r.background&&t.loadImage(null!==(n=r.background.background)&&void 0!==n?n:r.background,!0),t}return zt(i,[{key:"AABBBounds",get:function(){return this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode)}},{key:"OBBBounds",get:function(){return this.tryUpdateOBBBounds()}},{key:"globalAABBBounds",get:function(){return this.tryUpdateGlobalAABBBounds()}},{key:"transMatrix",get:function(){return this.tryUpdateLocalTransMatrix(!0)}},{key:"globalTransMatrix",get:function(){return this.tryUpdateGlobalTransMatrix(!0)}},{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"getOffsetXY",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.attribute,o=r.dx,a=void 0===o?t.dx:o,s=r.dy,l=void 0===s?t.dy:s;if(n&&this.parent){var u=this.parent.attribute;vd.x=a+(null!==(e=u.scrollX)&&void 0!==e?e:0),vd.y=l+(null!==(i=u.scrollY)&&void 0!==i?i:0)}else vd.x=a,vd.y=l;return vd}},{key:"onAnimateBind",value:function(t){this._emitCustomEvent("animate-bind",t)}},{key:"tryUpdateAABBBounds",value:function(t){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;nu.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var e=this.doUpdateAABBBounds(t);return this.addUpdateLayoutTag(),nu.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),e}},{key:"combindShadowAABBBounds",value:function(t){if(this.shadowRoot){var e=this.shadowRoot.AABBBounds.clone();t.union(e)}}},{key:"tryUpdateGlobalAABBBounds",value:function(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this.AABBBounds.clone(),this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}},{key:"tryUpdateGlobalTransMatrix",value:function(){if(this._globalTransMatrix){if(this.parent){var t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!0}},{key:"tryUpdateLocalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._transMatrix||(this._transMatrix=new ke),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}},{key:"shouldUpdateAABBBounds",value:function(){return this.shadowRoot?!!(this._updateTag&Cs.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&Cs.UPDATE_BOUNDS)}},{key:"shouldSelfChangeUpdateAABBBounds",value:function(){return this.shadowRoot?!!(this._updateTag&Cs.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&Cs.UPDATE_BOUNDS)}},{key:"shouldUpdateLocalMatrix",value:function(){return!!(this._updateTag&Cs.UPDATE_LOCAL_MATRIX)}},{key:"isValid",value:function(){var t,e,i=this.attribute;return Number.isFinite((null!==(t=i.x)&&void 0!==t?t:0)+(null!==(e=i.y)&&void 0!==e?e:0))}},{key:"_validNumber",value:function(t){return null==t||Number.isFinite(t)}},{key:"shouldUpdateShape",value:function(){return!!(this._updateTag&Cs.UPDATE_SHAPE)}},{key:"clearUpdateShapeTag",value:function(){this._updateTag&=Cs.CLEAR_SHAPE}},{key:"containsPoint",value:function(t,e,i,n){if(!n)return!1;if(i===Es.GLOBAL){var r=new ae(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),t=r.x,e=r.y}return n.containsPoint(this,{x:t,y:e})}},{key:"setAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background&&this.loadImage(t.background,!0),this._setAttributes(t,e,i)}},{key:"_setAttributes",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];this.attribute[o]=t[o]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}},{key:"setAttribute",value:function(t,e,i,n){var r,o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(v({},t,e),this.attribute,t,n);o?this._setAttributes(o,i,n):w(null===(r=this.normalAttrs)||void 0===r?void 0:r[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)):this.normalAttrs[t]=e,"background"===t&&this.loadImage(e,!0)}},{key:"needUpdateTags",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd,i=0;i<e.length;i++){var n=e[i];if(-1!==t.indexOf(n))return!0}return!1}},{key:"needUpdateTag",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd,i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},{key:"initAttributes",value:function(t){var e={type:Rs.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background&&this.loadImage(t.background,!0),this._updateTag=Cs.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}},{key:"translate",value:function(t,e){var i,n;if(0===t&&0===e)return this;var r={type:Rs.TRANSLATE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,dd,r);o&&(t=o.x,e=o.y,delete o.x,delete o.y,this._setAttributes(o));var a=this.attribute,s=a.postMatrix;return s?nu.transformUtil.fromMatrix(s,s).translate(t,e):(a.x=(null!==(i=a.x)&&void 0!==i?i:Ol.x)+t,a.y=(null!==(n=a.y)&&void 0!==n?n:Ol.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}},{key:"translateTo",value:function(t,e){var i=this.attribute;if(i.x===t&&i.y===e)return this;var n={type:Rs.TRANSLATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,dd,n);return r?(this._setAttributes(r,!1,n),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"scale",value:function(t,e,i){var n,r;if(1===t&&1===e)return this;var o={type:Rs.SCALE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,fd,o);a&&(t=a.scaleX,e=a.scaleY,delete a.scaleX,delete a.scaleY,this._setAttributes(a));var s=this.attribute;if(i){var l=this.attribute.postMatrix;l||(l=new ke,s.postMatrix=l),nu.transformUtil.fromMatrix(l,l).scale(t,e,i)}else s.scaleX=(null!==(n=s.scaleX)&&void 0!==n?n:Ol.scaleX)*t,s.scaleY=(null!==(r=s.scaleY)&&void 0!==r?r:Ol.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this}},{key:"scaleTo",value:function(t,e){var i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;var n={type:Rs.SCALE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,fd,n);return r?(this._setAttributes(r,!1,n),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}},{key:"rotate",value:function(t,e){var i;if(0===t)return this;var n={type:Rs.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,pd,n);r&&(delete r.angle,this._setAttributes(r,!1,n));var o=this.attribute;if(e){var a=this.attribute.postMatrix;a||(a=new ke,o.postMatrix=a),nu.transformUtil.fromMatrix(a,a).rotate(t,e)}else o.angle=(null!==(i=o.angle)&&void 0!==i?i:Ol.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}},{key:"rotateTo",value:function(t){var e=this.attribute;if(e.angle===t)return this;var i={type:Rs.ROTATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,pd,i);return n?(this._setAttributes(n,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}},{key:"skewTo",value:function(t,e){return this}},{key:"animate",value:function(t){var e=this;this.animates||(this.animates=new Map);var i=new Xc(null==t?void 0:t.id).bind(this);if(t){var n=t.onStart,r=t.onFrame,o=t.onEnd,a=t.onRemove;null!=n&&i.onStart(n),null!=r&&i.onFrame(r),null!=o&&i.onEnd(o),null!=a&&i.onRemove(a),i.interpolateFunc=t.interpolate}return this.animates.set(i.id,i),i.onRemove((function(){e.animates.delete(i.id)})),i}},{key:"onAttributeUpdate",value:function(t){t&&t.skipUpdateCallback||(nu.graphicService.onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}},{key:"update",value:function(t){t?(t.bounds&&this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode),this.tryUpdateLocalTransMatrix())}},{key:"hasState",value:function(t){return!(!this.currentStates||!this.currentStates.length)&&(!!w(t)||this.currentStates.includes(t))}},{key:"getState",value:function(t){var e;return null===(e=this.states)||void 0===e?void 0:e[t]}},{key:"applyStateAttrs",value:function(t,e,i,n){var r,o,a,s,l=this;if(i){var u,c=Object.keys(t),h=this.getNoWorkAnimateAttr(),d={};n?c.forEach((function(e){h[e]?(u||(u={}),u[e]=t[e]):d[e]=void 0===t[e]?l.getDefaultAttribute(e):t[e]})):c.forEach((function(e){h[e]?(u||(u={}),u[e]=t[e]):d[e]=t[e]}));var f=this.animate();f.stateNames=e,f.to(d,null!==(o=null===(r=this.stateAnimateConfig)||void 0===r?void 0:r.duration)&&void 0!==o?o:Qc,null!==(s=null===(a=this.stateAnimateConfig)||void 0===a?void 0:a.easing)&&void 0!==s?s:$c),u&&this.setAttributes(u,!1,{type:Rs.STATE})}else this.setAttributes(t,!1,{type:Rs.STATE})}},{key:"updateNormalAttrs",value:function(t){var e=this,i={};this.normalAttrs?(Object.keys(t).forEach((function(t){t in e.normalAttrs?(i[t]=e.normalAttrs[t],delete e.normalAttrs[t]):i[t]=e.getNormalAttribute(t)})),Object.keys(this.normalAttrs).forEach((function(i){t[i]=e.normalAttrs[i]}))):Object.keys(t).forEach((function(t){i[t]=e.getNormalAttribute(t)})),this.normalAttrs=i}},{key:"getNormalAttribute",value:function(t){var e=this.attribute[t];return this.animates&&this.animates.forEach((function(i){if(i.stateNames){var n=i.getEndProps();K(n,t)&&(e=n[t])}})),e}},{key:"clearStates",value:function(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}},{key:"removeState",value:function(t,e){if((this.currentStates?this.currentStates.indexOf(t):-1)>=0){var i=this.currentStates.filter((function(e){return e!==t}));this.useStates(i,e)}}},{key:"toggleState",value:function(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){var i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}},{key:"addState",value:function(t,e,i){var n;if(!this.currentStates||!this.currentStates.includes(t)||!e&&1!==this.currentStates.length){var r=e&&(null===(n=this.currentStates)||void 0===n?void 0:n.length)?this.currentStates.concat([t]):[t];this.useStates(r,i)}}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){var r={};t.forEach((function(e){var i,o=n.stateProxy?n.stateProxy(e,t):null===(i=n.states)||void 0===i?void 0:i[e];o&&Object.assign(r,o)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=Cs.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"addUpdateShapeTag",value:function(){this._updateTag|=Cs.UPDATE_SHAPE}},{key:"addUpdateShapeAndBoundsTag",value:function(){this._updateTag|=Cs.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}},{key:"updateShapeAndBoundsTagSetted",value:function(){return(this._updateTag&Cs.UPDATE_SHAPE_AND_BOUNDS)===Cs.UPDATE_SHAPE_AND_BOUNDS}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=Cs.CLEAR_BOUNDS}},{key:"addUpdatePositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Cs.UPDATE_GLOBAL_LOCAL_MATRIX}},{key:"addUpdateGlobalPositionTag",value:function(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Cs.UPDATE_GLOBAL_MATRIX}},{key:"clearUpdateLocalPositionTag",value:function(){this._updateTag&=Cs.CLEAR_LOCAL_MATRIX}},{key:"clearUpdateGlobalPositionTag",value:function(){this._updateTag&=Cs.CLEAR_GLOBAL_MATRIX}},{key:"addUpdateLayoutTag",value:function(){this._updateTag|=Cs.UPDATE_LAYOUT}},{key:"clearUpdateLayoutTag",value:function(){this._updateTag&=Cs.CLEAR_LAYOUT}},{key:"needUpdateLayout",value:function(){return!!(this._updateTag&Cs.UPDATE_LAYOUT)}},{key:"getAnchor",value:function(t,e){var i=this,n=[0,0],r=function(){if(e.b)return e.b;var t=i.attribute,n=t.scaleX,r=t.scaleY,o=t.angle;return cd.copy(i._AABBBounds),i.setAttributes({scaleX:1,scaleY:1,angle:0}),e.b=i.AABBBounds.clone(),i._AABBBounds.copy(cd),i.setAttributes({scaleX:n,scaleY:r,angle:o}),e.b};if("string"==typeof t[0]){var o=parseFloat(t[0])/100,a=r();n[0]=a.x1+(a.x2-a.x1)*o}else n[0]=t[0];if("string"==typeof t[1]){var s=parseFloat(t[1])/100,l=r();n[1]=l.y1+(l.y2-l.y1)*s}else n[1]=t[1];return n}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,e=t.x,i=void 0===e?Ol.x:e,n=t.y,r=void 0===n?Ol.y:n,o=t.scaleX,a=void 0===o?Ol.scaleX:o,s=t.scaleY,l=void 0===s?Ol.scaleY:s,u=t.angle,c=void 0===u?Ol.angle:u,h=t.scaleCenter,d=t.anchor,f=t.postMatrix,p=[0,0],v={};if(d&&(p=this.getAnchor(d,v)),!h||1===a&&1===l)!function(t,e,i,n,r,o,a,s){var l,u,c=e.a,h=e.b,d=e.c,f=e.d,p=e.e,v=e.f,y=Kt(a),g=qt(a);s?(l=s[0],u=s[1]):(l=i,u=n);var m=l-i,_=u-n,b=c*y+d*g,x=h*y+f*g,k=d*y-c*g,S=f*y-h*g;t.a=r*b,t.b=r*x,t.c=o*k,t.d=o*S,t.e=p+c*l+d*u-b*m-k*_,t.f=v+h*l+f*u-x*m-S*_}(this._transMatrix,this._transMatrix.reset(),i,r,a,l,c,d&&p);else{var y=this._transMatrix;y.reset(),y.translate(p[0],p[1]),y.rotate(c),y.translate(-p[0],-p[1]),y.translate(i,r),p=this.getAnchor(h,v),nu.transformUtil.fromMatrix(y,y).scale(a,l,{x:p[0],y:p[1]})}var g=this.getOffsetXY(Ol);if(this._transMatrix.e+=g.x,this._transMatrix.f+=g.y,f){var m=ud.setValue(f.a,f.b,f.c,f.d,f.e,f.f),_=this._transMatrix;m.multiply(_.a,_.b,_.c,_.d,_.e,_.f),_.setValue(m.a,m.b,m.c,m.d,m.e,m.f)}}},{key:"doUpdateGlobalMatrix",value:function(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);var t=this.parent.attribute,e=t.scrollX,i=void 0===e?0:e,n=t.scrollY,r=void 0===n?0:n;this._globalTransMatrix.translate(i,r)}}},{key:"setStage",value:function(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){var i=t.getTimeline();this.animates.forEach((function(t){t.setTimeline(i)}))}this._onSetStage&&this._onSetStage(this,t,e),nu.graphicService.onSetStage(this,t)}}},{key:"setStageToShadowRoot",value:function(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}},{key:"onAddStep",value:function(t){}},{key:"onStop",value:function(t){t&&this.setAttributes(t,!1,{type:Rs.ANIMATE_END})}},{key:"onStep",value:function(t,e,i,n,r){var o={};if(i.customAnimate)i.customAnimate.update(r,n,o);else{var a=i.props,s=i.parsedProps,l=i.propKeys;this.stepInterpolate(t,e,o,i,n,r,a,void 0,s,l)}this.setAttributes(o,!1,{type:Rs.ANIMATE_UPDATE,animationState:{ratio:n,end:r,step:i,isFirstFrameOfStep:t.getLastStep()!==i}}),this.stage&&this.stage.renderNextFrame()}},{key:"stepInterpolate",value:function(t,e,i,n,r,o,a,s,l,u){var c=this;u||(u=Object.keys(a),n.propKeys=u),o?n.propKeys.forEach((function(t){e.validAttr(t)&&(i[t]=a[t])})):u.forEach((function(o){var u;if(e.validAttr(o)){var h=a[o],d=null!==(u=s&&s[o])&&void 0!==u?u:t.getLastPropByName(o,n);if(null!=h&&null!=d)e.interpolateFunc&&e.interpolateFunc(o,r,d,h,i)||(e.customInterpolate(o,r,d,h,c,i)||c.defaultInterpolate(h,d,o,i,l,r)||c._interpolate(o,r,d,h,i));else i[o]=h}})),n.parsedProps=l}},{key:"defaultInterpolate",value:function(t,e,i,n,r,o){if(Number.isFinite(t))return n[i]=e+(t-e)*o,!0;if("fill"===i){r||(r={});var a=r.fillColorArray,s=Wh(e,null!=a?a:t,o,!1,(function(t,e){r.fillColorArray=e}));return s&&(n[i]=s),!0}if("stroke"===i){r||(r={});var l=r.strokeColorArray,u=Wh(e,null!=l?l:t,o,!1,(function(t,e){r.strokeColorArray=e}));return u&&(n[i]=u),!0}if("shadowColor"===i){r||(r={});var c=r.shadowColorArray,h=Wh(e,null!=c?c:t,o,!0,(function(t,e){r.shadowColorArray=e}));return h&&(n[i]=h),!0}return!1}},{key:"_interpolate",value:function(t,e,i,n,r){}},{key:"getDefaultAttribute",value:function(t){return gc(this)[this.type][t]}},{key:"getComputedAttribute",value:function(t){var e;return null!==(e=this.attribute[t])&&void 0!==e?e:this.getDefaultAttribute(t)}},{key:"onSetStage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._onSetStage=t,e&&this.stage&&t(this,this.stage)}},{key:"attachShadow",value:function(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:nu.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}},{key:"detachShadow",value:function(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot=null)}},{key:"toJson",value:function(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map((function(t){return t.toJson()}))}}},{key:"createPathProxy",value:function(t){return P(t,!0)?this.pathProxy=(new Pl).fromString(t):this.pathProxy=new Pl,this.pathProxy}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(!t||e&&function(t){return!(!t.fill&&!t.stroke)}(t))){var i=t;this.resources||(this.resources=new Map);var n={data:"init",state:null};this.resources.set(i,n),"string"==typeof t?(n.state="loading",t.startsWith("<svg")?(sd.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(z(t)||t.includes("/")||j(t))&&(sd.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):(n.state="success",n.data=t,this.backgroundImg=this.backgroundImg||e)}}},{key:"imageLoadSuccess",value:function(t,e,i){if(this.resources){var n=this.resources.get(t);n&&(n.state="success",n.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}}},{key:"imageLoadFail",value:function(t,e){if(this.resources){var i=this.resources.get(t);i&&(i.state="fail",e&&e())}}},{key:"_stopAnimates",value:function(t){t&&t.forEach((function(t){t.stop()}))}},{key:"stopAnimates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren((function(e){e.stopAnimates(t)}))}},{key:"release",value:function(){this.releaseStatus="released",nu.graphicService.onRelease(this)}},{key:"_emitCustomEvent",value:function(t,e){var i,n;if(this._events&&t in this._events){var r=new Rc(t,e);r.bubbles=!1,r.manager=null===(n=null===(i=this.stage)||void 0===i?void 0:i.eventSystem)||void 0===n?void 0:n.manager,this.dispatchEvent(r)}}}],[{key:"mixin",value:function(t){for(var e=Object.keys(t),n=0;n<e.length;++n){var r=e[n];Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}}]),i}(xc);gd.mixin(Ic);var md=function(){function t(e){jt(this,t),this.tagname=e,this.child=[],this[":@"]={}}return zt(t,[{key:"add",value:function(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push(v({},t,e))}},{key:"addChild",value:function(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push(v(v({},t.tagname,t.child),":@",t[":@"])):this.child.push(v({},t.tagname,t.child))}}]),t}();function _d(t,e,i,n){var r=t.indexOf(e,i);if(-1===r)throw new Error(n);return r+e.length-1}function bd(t,e,i){var n=function(t,e){for(var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">",r="",o=e;o<t.length;o++){var a=t[o];if(i)a===i&&(i="");else if('"'===a||"'"===a)i=a;else if(a===n[0]){if(!n[1])return{data:r,index:o};if(t[o+1]===n[1])return{data:r,index:o}}else"\t"===a&&(a=" ");r+=a}}(t,e+1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:">");if(n){var r=n.data,o=n.index,a=r.search(/\s/),s=r,l=!0;-1!==a&&(s=r.substr(0,a).replace(/\s\s*$/,""),r=r.substr(a+1));var u=s;if(i){var c=s.indexOf(":");-1!==c&&(l=(s=s.substr(c+1))!==n.data.substr(c+1))}return{tagName:s,tagExp:r,closeIndex:o,attrExpPresent:l,rawTagName:u}}}var xd=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm"),kd=function(){function t(e){jt(this,t),this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}return zt(t,[{key:"addChild",value:function(t,e,i){var n=e.tagname;"string"==typeof n?(e.tagname=n,t.addChild(e)):t.addChild(e)}},{key:"buildAttributesMap",value:function(t,e,i){var n={};if(t){for(var r=function(t,e){for(var i=[],n=e.exec(t);n;){var r=[];r.startIndex=e.lastIndex-n[0].length;for(var o=n.length,a=0;a<o;a++)r.push(n[a]);i.push(r),n=e.exec(t)}return i}(t,xd),o=r.length,a=0;a<o;a++){var s=r[a][1],l=r[a][4];s&&(n[s]=void 0===l||(isNaN(l)?l:Number(l)))}return n}}},{key:"parseXml",value:function(t){t=t.replace(/\r\n?/g,"\n");for(var e=new md("!xml"),i=e,n="",r="",o=0;o<t.length;o++)if("<"===t[o])if("/"===t[o+1]){var a=_d(t,">",o,"Closing Tag is not closed."),s=r.lastIndexOf(".");r=r.substring(0,s),(i=this.tagsNodeStack.pop())&&i.child&&n&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=n),n="",o=a}else if("?"===t[o+1])o=bd(t,o,!1,"?>").closeIndex+1;else if("!--"===t.substr(o+1,3))o=_d(t,"--\x3e",o+4,"Comment is not closed.");else{var l=bd(t,o,!1),u=l.tagName,c=l.tagExp,h=l.attrExpPresent,d=l.closeIndex;if(u!==e.tagname&&(r+=r?"."+u:u),c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===u[u.length-1]?(u=u.substr(0,u.length-1),r=r.substr(0,r.length-1),c=u):c=c.substr(0,c.length-1);var f=new md(u);u!==c&&h&&(f[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,f,r),r=r.substr(0,r.lastIndexOf("."))}else{var p=new md(u);this.tagsNodeStack.push(i),u!==c&&h&&(p[":@"]=this.buildAttributesMap(c,r,u)),this.addChild(i,p,r),i=p}n="",o=d}else n+=t[o];return e.child}}]),t}();function Sd(t,e){return Ad(t)}function Ad(t,e){for(var i,n={},r=0;r<t.length;r++){var o=t[r],a=wd(o);if(void 0!==a&&o[a]){var s=Ad(o[a]);i=s,Object.keys(i).length,o[":@"]&&Td(s,o[":@"]),void 0!==n[a]&&n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(s)):n[a]=s}}return n}function wd(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(":@"!==n)return n}}function Td(t,e,i){if(e)for(var n=Object.keys(e),r=n.length,o=0;o<r;o++){var a=n[o];t[a]=e[a]}}var Md=function(){function t(e){jt(this,t),this.options=Object.assign({},t.defaultOptions,e)}return zt(t,[{key:"valid",value:function(t){return t.startsWith("<")}},{key:"parse",value:function(t){return!!this.valid&&Sd(new kd(this.options).parseXml(t),this.options)}}]),t}();function Cd(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Cd=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}Md.defaultOptions={};var Ed=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};function Rd(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.expand(e+(n/2+(i?function(t,e){return t?e:0}(i,e):0))),t}var Pd,Bd=0;function Ld(){return Bd++}function Od(t){for(var e=[],i=0,n="",r=0;r<t.length;r++)Fd(t[r])?i?n+=t[r]:(i=1,n=t[r]):(i&&(e.push({text:n,direction:Pd.VERTICAL}),n="",i=0),e.push({text:t[r],direction:Pd.HORIZONTAL}));return n&&e.push({text:n,direction:Pd.VERTICAL}),e}!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(Pd||(Pd={}));var Id=new Map;["…","（","）","—","【","】","「","」","《","》"].forEach((function(t){return Id.set(t,!0)}));var Dd=new Map;function Fd(t){if(Id.has(t))return!0;if(Dd.has(t))return!1;var e=!1;return t.codePointAt(0)<256&&(e=!0),e}[""].forEach((function(t){return Dd.set(t,!0)}));var zd,jd=Ld(),Hd=Ld(),Nd=Ld(),Vd=Ld(),Gd=Ld(),Wd=Ld(),Ud=Ld(),Yd=Ld(),Kd=Ld(),Xd=Ld(),Zd=Ld(),qd=Ld(),Jd=Ld(),Qd=Ld(),$d=Ld(),tf=Ld(),ef=Symbol.for("GraphicService"),nf=Symbol.for("GraphicCreator"),rf={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},of=Object.keys(rf);function af(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}!function(t){t[t.LESS_GROUP=0]="LESS_GROUP",t[t.MORE_GROUP=1]="MORE_GROUP"}(zd||(zd={}));var sf=function(t){ue(i,t);var e=af(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="group",n.parent=null,n.isContainer=!0,n.numberType=Wd,n._childUpdateTag=Cs.UPDATE_BOUNDS,n}return zt(i,[{key:"setMode",value:function(t){"3d"===t?this.set3dMode():this.set2dMode()}},{key:"set3dMode",value:function(){this.in3dMode=!0}},{key:"set2dMode",value:function(){this.in3dMode=!1}},{key:"setTheme",value:function(t){return this.theme||(this.theme=new vc),this.theme.setTheme(t,this)}},{key:"createTheme",value:function(){this.theme||(this.theme=new vc)}},{key:"hideAll",value:function(){this.setAttribute("visible",!1),this.forEachChildren((function(t){t.isContainer&&t.hideAll?t.hideAll():t.setAttribute("visible",!1)}))}},{key:"showAll",value:function(){this.setAttribute("visible",!0),this.forEachChildren((function(t){t.isContainer&&t.showAll?t.showAll():t.setAttribute("visible",!0)}))}},{key:"containsPoint",value:function(t,e,i){if(i===Es.GLOBAL){var n=new ae(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(n,n),this.AABBBounds.contains(n.x,n.y)}return this.AABBBounds.contains(t,e)}},{key:"shouldUpdateAABBBounds",value:function(){return!!Xs(de(i.prototype),"shouldUpdateAABBBounds",this).call(this)||!!(this._childUpdateTag&Cs.UPDATE_BOUNDS)}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;nu.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),nu.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),e}},{key:"doUpdateLocalMatrix",value:function(){var t=this.attribute,e=t.x,n=void 0===e?Ol.x:e,r=t.y,o=void 0===r?Ol.y:r,a=t.dx,s=void 0===a?Ol.dx:a,l=t.dy,u=void 0===l?Ol.dy:l,c=t.scaleX,h=void 0===c?Ol.scaleX:c,d=t.scaleY,f=void 0===d?Ol.scaleY:d,p=t.angle,v=void 0===p?Ol.angle:p,y=t.postMatrix;if(0!==n||0!==o||0!==s||0!==u||1!==h||1!==f||0!==v||y)return Xs(de(i.prototype),"doUpdateLocalMatrix",this).call(this);this._transMatrix.reset()}},{key:"doUpdateAABBBounds",value:function(){var t=this.attribute,e=gc(this).group;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var i=nu.graphicService.updateGroupAABBBounds(t,e,this._AABBBounds,this),n=t.boundsPadding,r=void 0===n?e.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),i}},{key:"clearUpdateBoundTag",value:function(){this._updateTag&=Cs.CLEAR_BOUNDS,this._childUpdateTag&=Cs.CLEAR_BOUNDS}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"addUpdateBoundTag",value:function(){this._updateTag|=Cs.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}},{key:"addChildUpdateBoundTag",value:function(){this._childUpdateTag&Cs.UPDATE_BOUNDS||(this._childUpdateTag|=Cs.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}},{key:"getTheme",value:function(){return this.theme.getTheme(this)}},{key:"incrementalAppendChild",value:function(t){var e=Xs(de(i.prototype),"appendChild",this).call(this,t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),nu.graphicService.onAddIncremental(t,this,this.stage),e}},{key:"incrementalClearChild",value:function(){Xs(de(i.prototype),"removeAllChild",this).call(this),this.addUpdateBoundTag(),nu.graphicService.onClearIncremental(this,this.stage)}},{key:"appendChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Xs(de(i.prototype),"appendChild",this).call(this,t);return e&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertBefore",value:function(t,e){var n=Xs(de(i.prototype),"insertBefore",this).call(this,t,e);return this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertAfter",value:function(t,e){var n=Xs(de(i.prototype),"insertAfter",this).call(this,t,e);return this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"insertInto",value:function(t,e){var n=Xs(de(i.prototype),"insertInto",this).call(this,t,e);return this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}},{key:"removeChild",value:function(t){var e=Xs(de(i.prototype),"removeChild",this).call(this,t);return t.stage=null,nu.graphicService.onRemove(t),this.addUpdateBoundTag(),e}},{key:"removeAllChild",value:function(){this.forEachChildren((function(t){nu.graphicService.onRemove(t)})),Xs(de(i.prototype),"removeAllChild",this).call(this),this.addUpdateBoundTag()}},{key:"setStage",value:function(t,e){var i=this;this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),nu.graphicService.onSetStage(this,t),this.forEachChildren((function(e){e.setStage(t,i.layer)})))}},{key:"addUpdatePositionTag",value:function(){Xs(de(i.prototype),"addUpdatePositionTag",this).call(this),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"addUpdateGlobalPositionTag",value:function(){Xs(de(i.prototype),"addUpdateGlobalPositionTag",this).call(this),this.forEachChildren((function(t){t.isContainer&&t.addUpdateGlobalPositionTag()}))}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){var e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"shouldUpdateGlobalMatrix",value:function(){return!!(this._updateTag&Cs.UPDATE_GLOBAL_MATRIX)}},{key:"_getChildByName",value:function(t,e){return this.find((function(e){return e.name===t}),e)}},{key:"createOrUpdateChild",value:function(t,e,i){var n=this._getChildByName(t);return n?n.setAttributes(e):((n=nu.graphicService.creator[i](e)).name=t,this.add(n)),n}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function lf(t){return new sf(t)}function uf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}sf.NOWORK_ANIMATE_ATTR=yd;var cf,hf=function(t){ue(i,t);var e=uf(i);function i(t,n,r,o){var a,s;return jt(this,i),(a=e.call(this,{})).stage=t,a.global=n,a.window=r,a.main=o.main,a.layerHandler=o.layerHandler,a.layerHandler.init(ce(a),r,{main:o.main,canvasId:o.canvasId,width:a.viewWidth,height:a.viewHeight,zIndex:null!==(s=o.zIndex)&&void 0!==s?s:0}),a.layer=ce(a),a.subLayers=new Map,a.theme=new vc,a.background="rgba(0, 0, 0, 0)",a.afterDrawCbs=[],a}return zt(i,[{key:"offscreen",get:function(){return this.layerHandler.offscreen}},{key:"layerMode",get:function(){return this.layerHandler.type}},{key:"width",get:function(){return this.stage?this.stage.width:0}},{key:"height",get:function(){return this.stage?this.stage.height:0}},{key:"viewWidth",get:function(){return this.stage?this.stage.viewWidth:0}},{key:"viewHeight",get:function(){return this.stage?this.stage.viewHeight:0}},{key:"dirtyBound",get:function(){throw new Error("暂不支持")}},{key:"dpr",get:function(){return this._dpr}},{key:"combineSubLayer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=Array.from(this.subLayers.values()).sort((function(t,e){return t.zIndex-e.zIndex}));this.layerHandler.merge(i.map((function(t){return t.layer.subLayers.size&&t.layer.combineSubLayer(e),t.layer.getNativeHandler()}))),e&&i.forEach((function(t){t.group&&(t.group.incremental=0)})),i.forEach((function(e){nu.layerService.releaseLayer(t.stage,e.layer)})),this.subLayers.clear()}},{key:"getNativeHandler",value:function(){return this.layerHandler}},{key:"setStage",value:function(t,e){Xs(de(i.prototype),"setStage",this).call(this,t,this)}},{key:"pick",value:function(t,e){throw new Error("暂不支持")}},{key:"tryRenderSecondaryLayer",value:function(t,e){var i=this;this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach((function(n){n.layer.renderCount=i.renderCount,n.layer.render(t,e)}))}},{key:"render",value:function(t,e){var i,n=this,r=this.stage;this.layerHandler.render([this],{renderService:t.renderService,x:r.x,y:r.y,width:this.viewWidth,height:this.viewHeight,stage:this.stage,layer:this,background:null!==(i=t.background)&&void 0!==i?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach((function(t){return t(n)})),this.tryRenderSecondaryLayer(t,e)}},{key:"resize",value:function(t,e){this.layerHandler.resize(t,e)}},{key:"resizeView",value:function(t,e){this.layerHandler.resizeView(t,e)}},{key:"setDpr",value:function(t){this.layerHandler.setDpr(t)}},{key:"afterDraw",value:function(t){this.afterDrawCbs.push(t)}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"prepare",value:function(t,e){}},{key:"combineTo",value:function(t,e){var i,n,r,o=this;this.offscreen&&(this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,x:null!==(n=e.x)&&void 0!==n?n:this.stage.x,y:null!==(r=e.y)&&void 0!==r?r:this.stage.y,width:this.viewWidth,height:this.viewHeight,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach((function(t){return t(o)})))}},{key:"release",value:function(){var t=this;Xs(de(i.prototype),"release",this).call(this),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach((function(e){nu.layerService.releaseLayer(t.stage,e.layer)}))}},{key:"drawTo",value:function(t,e){var i,n,r,o=this;this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,x:null!==(n=e.x)&&void 0!==n?n:this.stage.x,y:null!==(r=e.y)&&void 0!==r?r:this.stage.y,width:this.viewWidth,height:this.viewHeight,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach((function(t){return t(o)}))}}]),i}(sf),df=Symbol.for("TransformUtil"),ff=Symbol.for("GraphicUtil"),pf=Symbol.for("LayerService"),vf=Symbol.for("StaticLayerHandlerContribution"),yf=Symbol.for("DynamicLayerHandlerContribution"),gf=Symbol.for("VirtualLayerHandlerContribution"),mf=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},_f=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bf=cf=function(){function t(){jt(this,t),this.layerMap=new Map,this.global=nu.global}return zt(t,[{key:"tryInit",value:function(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}},{key:"getStageLayer",value:function(t){return this.layerMap.get(t)}},{key:"getRecommendedLayerType",value:function(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}},{key:"getLayerHandler",value:function(t){return"static"===t?_u.get(vf):"dynamic"===t?_u.get(yf):_u.get(gf)}},{key:"createLayer",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{main:!1};this.tryInit();var n=this.getRecommendedLayerType(i.layerMode);n=i.main||i.canvasId?"static":n;var r=this.getLayerHandler(n),o=new hf(t,this.global,t.window,Object.assign(Object.assign({main:!1},i),{layerMode:n,canvasId:null!==(e=i.canvasId)&&void 0!==e?e:cf.GenerateLayerId(),layerHandler:r})),a=this.layerMap.get(t)||[];return a.push(o),this.layerMap.set(t,a),this.staticLayerCountInEnv--,o}},{key:"prepareStageLayer",value:function(t){var e;t.forEachChildren((function(t){var i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]}))}},{key:"releaseLayer",value:function(t,e){e.release();var i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter((function(t){return t!==e})))}},{key:"layerCount",value:function(t){return(this.layerMap.get(t)||[]).length}},{key:"restLayerCount",value:function(t){return"browser"===this.global.env?10:0}}],[{key:"GenerateLayerId",value:function(){return"".concat(cf.idprefix,"_").concat(cf.prefix_count++)}}]),t}();bf.idprefix="visactor_layer",bf.prefix_count=0,bf=cf=mf([Ya(),_f("design:paramtypes",[])],bf);var xf=new La((function(t){t(gs).to(xs).inSingletonScope(),t(ec).to(nc),t(ff).to(lc).inSingletonScope(),t(df).to(cc).inSingletonScope(),t(pf).to(bf).inSingletonScope()}));function kf(t,e){return!(!t&&!e)}function Sf(t,e){return(B(t)?t.some((function(t){return t||void 0===t})):!!t)&&e>0}function Af(t,e,i){return i&&t*e>0}function wf(t,e,i,n,r){return r&&t*e>0&&0!==i&&0!==n}function Tf(t,e){return t*e>0}function Mf(t,e,i,n){return t*e>0&&0!==i&&0!==n}function Cf(t,e,i,n,r,o,a,s){var l=i-t,u=n-e,c=a-r,h=s-o,d=h*l-c*u;return d*d<Ht?[]:[t+(d=(c*(e-o)-h*(t-r))/d)*l,e+d*u]}function Ef(t,e,i,n,r,o,a){var s=t-i,l=e-n,u=(a?o:-o)/Math.sqrt(s*s+l*l),c=u*l,h=-u*s,d=t+c,f=e+h,p=i+c,v=n+h,y=(d+p)/2,g=(f+v)/2,m=p-d,_=v-f,b=m*m+_*_,x=r-o,k=d*v-p*f,S=(_<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-k*k)),A=(k*_-m*S)/b,w=(-k*m-_*S)/b,T=(k*_+m*S)/b,M=(-k*m+_*S)/b,C=A-y,E=w-g,R=T-y,P=M-g;return C*C+E*E>R*R+P*P&&(A=T,w=M),{cx:A,cy:w,x01:-c,y01:-h,x11:A*(r/x-1),y11:w*(r/x-1)}}function Rf(t,e,i,n,r,o,a){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=Ut(u-l),h=u>l,d=!1;if(r<o){var f=r;r=o,o=f}if(r<=Ht)e.moveTo(i,n);else if(c>=Wt-Ht)e.moveTo(i+r*Kt(l),n+r*qt(l)),e.arc(i,n,r,l,u,!h),o>Ht&&(e.moveTo(i+o*Kt(u),n+o*qt(u)),e.arc(i,n,o,u,l,h));else{var p,v,y,g,m=t.getParsedCornerRadius(),_=t.getParsePadAngle(l,u),b=_.outerDeltaAngle,x=_.innerDeltaAngle,k=_.outerStartAngle,S=_.outerEndAngle,A=_.innerEndAngle,w=_.innerStartAngle,T=m,M=m,C=m,E=m,R=Math.max(M,T),P=Math.max(C,E),B=R,L=P,O=r*Kt(k),I=r*qt(k),D=o*Kt(A),F=o*qt(A);if((P>Ht||R>Ht)&&(p=r*Kt(S),v=r*qt(S),y=o*Kt(w),g=o*qt(w),c<Nt)){var z=Cf(O,I,y,g,p,v,D,F);if(z){var j=O-z[0],H=I-z[1],N=p-z[0],V=v-z[1],G=1/qt($t((j*N+H*V)/(Jt(j*j+H*H)*Jt(N*N+V*V)))/2),W=Jt(z[0]*z[0]+z[1]*z[1]);L=Zt(P,(o-W)/(G-1)),B=Zt(R,(r-W)/(G+1))}}if(b<.001)a&&(a[3]||a[1])&&e.moveTo(i+O,n+I),d=!0;else if(B>Ht){var U=Zt(T,B),Y=Zt(M,B),K=Ef(y,g,O,I,r,U,Number(h)),X=Ef(p,v,D,F,r,Y,Number(h));B<R&&U===Y?!a||a[0]?(e.moveTo(i+K.cx+K.x01,n+K.cy+K.y01),e.arc(i+K.cx,n+K.cy,B,Yt(K.y01,K.x01),Yt(X.y01,X.x01),!h)):e.moveTo(i+K.cx+B*Kt(Yt(X.y01,X.x01)),n+K.cy+B*qt(Yt(X.y01,X.x01))):!a||a[0]?(e.moveTo(i+K.cx+K.x01,n+K.cy+K.y01),U>0&&e.arc(i+K.cx,n+K.cy,U,Yt(K.y01,K.x01),Yt(K.y11,K.x11),!h),e.arc(i,n,r,Yt(K.cy+K.y11,K.cx+K.x11),Yt(X.cy+X.y11,X.cx+X.x11),!h),Y>0&&e.arc(i+X.cx,n+X.cy,Y,Yt(X.y11,X.x11),Yt(X.y01,X.x01),!h)):Y>0?e.moveTo(i+X.cx+Y*Kt(Yt(X.y01,X.x01)),n+X.cy+Y*qt(Yt(X.y01,X.x01))):e.moveTo(i+p,n+r*qt(S))}else!a||a[0]?(e.moveTo(i+O,n+I),e.arc(i,n,r,k,S,!h)):e.moveTo(i+r*Kt(S),n+r*qt(S));if(!(o>Ht)||x<.001)!a||a[1]?e.lineTo(i+D,n+F):e.moveTo(i+D,n+F),d=!0;else if(L>Ht){var Z=Zt(E,L),q=Zt(C,L),J=Ef(D,F,p,v,o,-q,Number(h)),Q=Ef(O,I,y,g,o,-Z,Number(h));if(!a||a[1]?e.lineTo(i+J.cx+J.x01,n+J.cy+J.y01):e.moveTo(i+J.cx+J.x01,n+J.cy+J.y01),L<P&&Z===q){var $=Yt(Q.y01,Q.x01);!a||a[2]?e.arc(i+J.cx,n+J.cy,L,Yt(J.y01,J.x01),$,!h):e.moveTo(i+J.cx+Kt($),n+J.cy+qt($))}else!a||a[2]?(q>0&&e.arc(i+J.cx,n+J.cy,q,Yt(J.y01,J.x01),Yt(J.y11,J.x11),!h),e.arc(i,n,o,Yt(J.cy+J.y11,J.cx+J.x11),Yt(Q.cy+Q.y11,Q.cx+Q.x11),h),Z>0&&e.arc(i+Q.cx,n+Q.cy,Z,Yt(Q.y11,Q.x11),Yt(Q.y01,Q.x01),!h)):Z>0?e.moveTo(i+Q.cx+Z*Kt(Yt(Q.y01,Q.x01)),n+Q.cy+Z*qt(Yt(Q.y01,Q.x01))):e.moveTo(i+y,n+g)}else!a||a[1]?e.lineTo(i+D,n+F):e.moveTo(i+D,n+F),!a||a[2]?e.arc(i,n,o,A,w,h):e.moveTo(i+o*Kt(w),n+o*qt(w))}return a?a[3]&&e.lineTo(i+r*Kt(l),n+r*qt(l)):e.closePath(),d}function Pf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Bf=function(){function t(){jt(this,t)}return zt(t,null,[{key:"GetCanvas",value:function(){try{return t.canvas||(t.canvas=nu.global.createCanvas({})),t.canvas}catch(t){return null}}},{key:"GetCtx",value:function(){if(!t.ctx){var e=t.GetCanvas();t.ctx=e.getContext("2d")}return t.ctx}}]),t}(),Lf=function(t){ue(i,t);var e=Pf(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;jt(this,i),(t=e.call(this)).cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},t.dataMap=new Map;var o=Bf.GetCanvas(),a=Bf.GetCtx();if(o.width=r,o.height=1,!a)return he(t);if(a.translate(0,0),!a)throw new Error("获取ctx发生错误");var s=a.createLinearGradient(0,0,r,0);return n.forEach((function(t){s.addColorStop(t[0],t[1])})),a.fillStyle=s,a.fillRect(0,0,r,1),t.rgbaSet=a.getImageData(0,0,r,1).data,t}return zt(i,[{key:"getColor",value:function(t){var e=this.rgbaSet.slice(4*t,4*t+4);return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3]/255,")")}},{key:"GetOrCreate",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,s="".concat(t).concat(e).concat(n).concat(r);o.forEach((function(t){return s+=t.join()})),s+=a;var l=this.dataMap.get(s);return l||(l={data:new i(o,a),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(s,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}],[{key:"getInstance",value:function(){return i._instance||(i._instance=new i),i._instance}}]),i}(Se),Of=function(){function t(){jt(this,t)}return zt(t,null,[{key:"GetSize",value:function(e){for(var i=0;i<t.ImageSize.length;i++)if(t.ImageSize[i]>=e)return t.ImageSize[i];return e}},{key:"Get",value:function(e,i,n,r,o,a,s){var l=t.GenKey(e,i,n,r,o),u=t.cache[l];if(!u||0===u.length)return null;for(var c=0;c<u.length;c++)if(u[c].width>=a&&u[c].height>=s)return u[c].pattern;return null}},{key:"Set",value:function(e,i,n,r,o,a,s,l){var u=t.GenKey(e,i,n,r,o);t.cache[u]?t.cache[u].push({width:s,height:l,pattern:a}):t.cache[u]=[{width:s,height:l,pattern:a}]}},{key:"GenKey",value:function(t,e,i,n,r){return"".concat(e,",").concat(i,",").concat(n,",").concat(r,",").concat(t.join())}}]),t}();Of.cache={},Of.ImageSize=[20,40,80,160,320,640,1280,2560];var If=Symbol.for("ArcRenderContribution"),Df=Symbol.for("AreaRenderContribution"),Ff=Symbol.for("CircleRenderContribution"),zf=Symbol.for("GroupRenderContribution"),jf=Symbol.for("ImageRenderContribution"),Hf=Symbol.for("PathRenderContribution"),Nf=Symbol.for("PolygonRenderContribution"),Vf=Symbol.for("RectRenderContribution"),Gf=Symbol.for("SymbolRenderContribution"),Wf=Symbol.for("TextRenderContribution"),Uf=Symbol.for("InteractiveSubRenderContribution");function Yf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Kf=["radius","startAngle","endAngle"].concat(m(hd)),Xf=function(t){ue(i,t);var e=Yf(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{radius:1};return jt(this,i),(t=e.call(this,n)).type="circle",t.numberType=Vd,t}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.radius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)}},{key:"doUpdateAABBBounds",value:function(t){var e=gc(this).circle;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var i=this.attribute,n=nu.graphicService.updateCircleAABBBounds(i,gc(this).circle,this._AABBBounds,t,this),r=i.boundsPadding,o=void 0===r?e.boundsPadding:r,a=rh(o);return a&&n.expand(a),this.clearUpdateBoundTag(),n}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).circle[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,Kf)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,Kf)}},{key:"toCustomPath",value:function(){var t,e,i,n=this.attribute,r=null!==(t=n.radius)&&void 0!==t?t:this.getDefaultAttribute("radius"),o=null!==(e=n.startAngle)&&void 0!==e?e:this.getDefaultAttribute("startAngle"),a=null!==(i=n.endAngle)&&void 0!==i?i:this.getDefaultAttribute("endAngle"),s=new Pl;return s.arc(0,0,r,o,a),s}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Zf(t){return new Xf(t)}function qf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;i||(i=1);var n=t.fontStyle,r=void 0===n?e.fontStyle:n,o=t.fontVariant,a=void 0===o?e.fontVariant:o,s=t.fontWeight,l=void 0===s?e.fontWeight:s,u=t.fontSize,c=void 0===u?e.fontSize:u,h=t.fontFamily;return(r?r+" ":"")+(a?a+" ":"")+(l?l+" ":"")+c*i+"px "+((void 0===h?e.fontFamily:h)||"sans-serif")}function Jf(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function Qf(t,e,i){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}Xf.NOWORK_ANIMATE_ATTR=yd;var $f=function(){function t(e,i,n){jt(this,t),this.fontFamily=e,this.textOptions=i,this.textMeasure=n}return zt(t,[{key:"LayoutBBox",value:function(t,e,i){if("left"===e||"start"===e)t.xOffset=0;else if("center"===e)t.xOffset=t.width/-2;else{if("right"!==e&&"end"!==e)throw new Error("非法的textAlign");t.xOffset=-t.width}return t.yOffset="top"===i?0:"middle"===i?t.height/-2:"alphabetic"===i?-.79*t.height:-t.height,t}},{key:"GetLayout",value:function(t,e,i,n,r,o,a,s,l){for(var u=[],c=[e,i],h=[0,0];t.length>0;){var d=this.textMeasure.clipTextWithSuffix(t,this.textOptions,e,a,s,l).str;u.push({str:d,width:this.textMeasure.measureTextWidth(d,this.textOptions)}),t=t.substring(d.length)}"left"===n||"start"===n||("center"===n?h[0]=c[0]/-2:"right"!==n&&"end"!==n||(h[0]=-c[0])),"top"===r||("middle"===r?h[1]=c[1]/-2:"bottom"===r&&(h[1]=-c[1]));var f={xOffset:h[0],yOffset:h[1],width:c[0],height:c[1]};return this.layoutWithBBox(f,u,n,r,o)}},{key:"GetLayoutByLines",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"end";t=t.map((function(t){return t.toString()}));var l=[],u=[0,0];if("number"==typeof a&&a!==1/0){for(var c,h=0,d=t.length;h<d;h++)c=Math.min(this.textMeasure.measureTextWidth(t[h],this.textOptions),a),l.push({str:this.textMeasure.clipTextWithSuffix(t[h],this.textOptions,c,r,o,s).str,width:c});u[0]=a}else{var f,p;a=0;for(var v=0,y=t.length;v<y;v++)p=t[v],f=this.textMeasure.measureTextWidth(p,this.textOptions),a=Math.max(a,f),l.push({str:p,width:f});u[0]=a}u[1]=l.length*n,u[0]=l.reduce((function(t,e){return Math.max(t,e.width)}),0);var g={xOffset:0,yOffset:0,width:u[0],height:u[1]};return this.LayoutBBox(g,e,i),this.layoutWithBBox(g,l,e,i,n)}},{key:"layoutWithBBox",value:function(t,e,i,n,r){var o=[0,0],a=e.length*r;"top"===n||("middle"===n?o[1]=(t.height-a)/2:"bottom"===n&&(o[1]=t.height-a));for(var s=0;s<e.length;s++)this.lineOffset(t,e[s],i,n,r,o);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:r,textAlign:i,textBaseline:n}}},{key:"lineOffset",value:function(t,e,i,n,r,o){return"left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=(r-this.textOptions.fontSize)/2+.79*this.textOptions.fontSize+o[1],o[1]+=r,e}}]),t}();function tp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var ep=["text","maxLineWidth","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp"].concat(m(hd)),ip=function(t){ue(i,t);var e=tp(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{text:"",fontSize:16};return jt(this,i),(t=e.call(this,n)).type="text",t.numberType=tf,t.cache={},t}return zt(i,[{key:"font",get:function(){var t=gc(this).text;return this._font||(this._font=qf(this.attribute,t)),this._font}},{key:"clipedText",get:function(){var t,e=this.attribute,i=gc(this).text;if(this.isSimplify()){var n=e.maxLineWidth,r=void 0===n?i.maxLineWidth:n;return Number.isFinite(r)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!==(t=e.text)&&void 0!==t?t:i.text).toString()}}},{key:"clipedWidth",get:function(){if(this.isSimplify())return this.tryUpdateAABBBounds(),this.cache.clipedWidth}},{key:"cliped",get:function(){var t=gc(this).text,e=this.attribute;if(!this.isMultiLine){var i=e.maxLineWidth,n=void 0===i?t.maxLineWidth:i;return!!Number.isFinite(n)&&(this.tryUpdateAABBBounds(),"vertical"===e.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map((function(t){return t.text})).join("")!==e.text.toString():null!=this.clipedText&&this.clipedText!==e.text.toString())}}},{key:"multilineLayout",get:function(){if(this.isMultiLine)return this.tryUpdateAABBBounds(),this.cache.layoutData}},{key:"isSimplify",value:function(){return!this.isMultiLine&&"vertical"!==this.attribute.direction}},{key:"isMultiLine",get:function(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}},{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.text;return B(t)?!t.every((function(t){return null==t||""===t})):null!=t&&""!==t}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).text;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateTextAABBBounds(e,t,this._AABBBounds,this),n=this.attribute.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"updateWrapAABBBounds",value:function(t){var e,i,n,r,o=gc(this).text,a=this.attribute,s=a.fontFamily,l=void 0===s?o.fontFamily:s,u=a.textAlign,c=void 0===u?o.textAlign:u,h=a.textBaseline,d=void 0===h?o.textBaseline:h,f=a.fontSize,p=void 0===f?o.fontSize:f,v=a.ellipsis,y=void 0===v?o.ellipsis:v,g=a.maxLineWidth,m=a.stroke,_=void 0===m?o.stroke:m,b=a.lineWidth,x=void 0===b?o.lineWidth:b,k=a.wordBreak,S=void 0===k?o.wordBreak:k,A=a.fontWeight,w=void 0===A?o.fontWeight:A,T=a.ignoreBuf,M=void 0===T?o.ignoreBuf:T,C=a.suffixPosition,E=void 0===C?o.suffixPosition:C,R=a.heightLimit,P=void 0===R?0:R,L=a.lineClamp,O=null!==(e=ph(this.attribute.lineHeight,this.attribute.fontSize||o.fontSize))&&void 0!==e?e:this.attribute.fontSize||o.fontSize,I=M?0:2;if(!this.shouldUpdateShape()&&(null===(i=this.cache)||void 0===i?void 0:i.layoutData)){var D=this.cache.layoutData.bbox;return this._AABBBounds.set(D.xOffset,D.yOffset,D.xOffset+D.width,D.yOffset+D.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}var F=nu.graphicUtil.textMeasure,z=new $f(l,{fontSize:p,fontWeight:w,fontFamily:l},F),j=B(t)?t.map((function(t){return t.toString()})):[t.toString()],H=[],N=[0,0],V=1/0;if(P>0&&(V=Math.max(Math.floor(P/O),1)),L&&(V=Math.min(V,L)),"number"==typeof g&&g!==1/0){if(g>0)for(var G=0;G<j.length;G++){var W=j[G],U=!0;if(G===V-1){var Y=z.textMeasure.clipTextWithSuffix(W,z.textOptions,g,y,!1,E);H.push({str:Y.str,width:Y.width});break}var K=z.textMeasure.clipText(W,z.textOptions,g,"break-word"===S);if(""!==W&&""===K.str){if(y){var X=z.textMeasure.clipTextWithSuffix(W,z.textOptions,g,y,!1,E);K.str=null!==(n=X.str)&&void 0!==n?n:"",K.width=null!==(r=X.width)&&void 0!==r?r:0}else K.str="",K.width=0;U=!1}if(H.push({str:K.str,width:K.width}),K.str.length===W.length);else if(U){var Z=W.substring(K.str.length);j.splice(G+1,0,Z)}}var q=0;H.forEach((function(t){q=Math.max(q,t.width)})),N[0]=q}else{for(var J,Q,$=0,tt=0,et=j.length;tt<et;tt++){if(tt===V-1){var it=z.textMeasure.clipTextWithSuffix(j[tt],z.textOptions,g,y,!1,E);H.push({str:it.str,width:it.width}),$=Math.max($,it.width);break}Q=j[tt],J=z.textMeasure.measureTextWidth(Q,z.textOptions,"break-word"===S),$=Math.max($,J),H.push({str:Q,width:J})}N[0]=$}N[1]=H.length*(O+I);var nt={xOffset:0,yOffset:0,width:N[0],height:N[1]};z.LayoutBBox(nt,c,d);var rt=z.layoutWithBBox(nt,H,c,d,O);return this.cache.layoutData=rt,this.clearUpdateShapeTag(),this._AABBBounds.set(nt.xOffset,nt.yOffset,nt.xOffset+nt.width,nt.yOffset+nt.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}},{key:"updateSingallineAABBBounds",value:function(t){var e=gc(this).text,i=this.attribute.direction;return"horizontal"===(void 0===i?e.direction:i)?this.updateHorizontalSinglelineAABBBounds(t):this.updateVerticalSinglelineAABBBounds(t)}},{key:"updateMultilineAABBBounds",value:function(t){var e=gc(this).text,i=this.attribute.direction;return"horizontal"===(void 0===i?e.direction:i)?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t)}},{key:"updateHorizontalSinglelineAABBBounds",value:function(t){var e,i,n=gc(this).text,r=this.attribute.wrap;if(void 0===r?n.wrap:r)return this.updateWrapAABBBounds([t]);var o,a,s=nu.graphicUtil.textMeasure,l=this.attribute,u=l.maxLineWidth,c=void 0===u?n.maxLineWidth:u,h=l.ellipsis,d=void 0===h?n.ellipsis:h,f=l.textAlign,p=void 0===f?n.textAlign:f,v=l.textBaseline,y=void 0===v?n.textBaseline:v,g=l.fontFamily,m=void 0===g?n.fontFamily:g,_=l.fontSize,b=void 0===_?n.fontSize:_,x=l.fontWeight,k=void 0===x?n.fontWeight:x,S=l.stroke,A=void 0===S?n.stroke:S,w=l.lineWidth,T=void 0===w?n.lineWidth:w,M=l.ignoreBuf,C=void 0===M?n.ignoreBuf:M,E=l.whiteSpace,R=void 0===E?n.whiteSpace:E,P=l.suffixPosition,B=void 0===P?n.suffixPosition:P;if("normal"===R)return this.updateWrapAABBBounds(t);var L=C?0:Math.max(2,.075*b),O=l.fontSize||n.fontSize,I=null!==(e=ph(l.lineHeight,O))&&void 0!==e?e:O+L;if(!this.shouldUpdateShape()&&this.cache){var D=Jf(p,o=null!==(i=this.cache.clipedWidth)&&void 0!==i?i:0),F=Qf(y,I,b);return this._AABBBounds.set(D,F,D+o,F+I),A&&this._AABBBounds.expand(T/2),this._AABBBounds}if(Number.isFinite(c)){if(d){var z=!0===d?n.ellipsis:d,j=s.clipTextWithSuffix(t.toString(),{fontSize:b,fontWeight:k,fontFamily:m},c,z,!1,B);a=j.str,o=j.width}else{var H=s.clipText(t.toString(),{fontSize:b,fontWeight:k,fontFamily:m},c,!1);a=H.str,o=H.width}this.cache.clipedText=a,this.cache.clipedWidth=o}else o=s.measureTextWidth(t.toString(),{fontSize:b,fontWeight:k,fontFamily:m}),this.cache.clipedText=t.toString(),this.cache.clipedWidth=o;this.clearUpdateShapeTag();var N=Jf(p,o),V=I;nu.global&&nu.global.isSafari()&&(V+=.2*b);var G=Qf(y,V,b,L);return this._AABBBounds.set(N,G,N+o,G+V),A&&this._AABBBounds.expand(T/2),this._AABBBounds}},{key:"getBaselineMapAlign",value:function(){return i.baselineMapAlign}},{key:"getAlignMapBaseline",value:function(){return i.alignMapBaseline}},{key:"updateVerticalSinglelineAABBBounds",value:function(t){var e,n,r,o,a=gc(this).text,s=nu.graphicUtil.textMeasure,l=this.attribute,u=l.ignoreBuf,c=(void 0===u?a.ignoreBuf:u)?0:2,h=l.maxLineWidth,d=void 0===h?a.maxLineWidth:h,f=l.ellipsis,p=void 0===f?a.ellipsis:f,v=l.fontSize,y=void 0===v?a.fontSize:v,g=l.fontWeight,m=void 0===g?a.fontWeight:g,_=l.fontFamily,b=void 0===_?a.fontFamily:_,x=l.stroke,k=void 0===x?a.stroke:x,S=l.lineWidth,A=void 0===S?a.lineWidth:S,w=l.verticalMode,T=void 0===w?a.verticalMode:w,M=l.suffixPosition,C=void 0===M?a.suffixPosition:M,E=null!==(e=ph(l.lineHeight,l.fontSize||a.fontSize))&&void 0!==e?e:(l.fontSize||a.fontSize)+c,R=l.textAlign,P=void 0===R?a.textAlign:R,B=l.textBaseline,L=void 0===B?a.textBaseline:B;if(!T){var O=P;P=null!==(n=i.baselineMapAlign[L])&&void 0!==n?n:"left",L=null!==(r=i.alignMapBaseline[O])&&void 0!==r?r:"top"}if(!this.shouldUpdateShape()&&this.cache){var I=Jf(P,o=this.cache.clipedWidth),D=Qf(L,E,y);return this._AABBBounds.set(D,I,D+E,I+o),k&&this._AABBBounds.expand(A/2),this._AABBBounds}var F=[Od(t.toString())];if(Number.isFinite(d)){if(p){var z=!0===p?a.ellipsis:p,j=s.clipTextWithSuffixVertical(F[0],{fontSize:y,fontWeight:m,fontFamily:b},d,z,!1,C);F=[j.verticalList],o=j.width}else{var H=s.clipTextVertical(F[0],{fontSize:y,fontWeight:m,fontFamily:b},d,!1);F=[H.verticalList],o=H.width}this.cache.verticalList=F,this.cache.clipedWidth=o}else o=0,F[0].forEach((function(t){var e=t.direction===Pd.HORIZONTAL?y:s.measureTextWidth(t.text,{fontSize:y,fontWeight:m,fontFamily:b});o+=e,t.width=e})),this.cache.verticalList=F,this.cache.clipedWidth=o;this.clearUpdateShapeTag();var N=Jf(P,o),V=Qf(L,E,y);return this._AABBBounds.set(V,N,V+E,N+o),k&&this._AABBBounds.expand(A/2),this._AABBBounds}},{key:"updateHorizontalMultilineAABBBounds",value:function(t){var e,i,n=gc(this).text,r=this.attribute.wrap;if(void 0===r?n.wrap:r)return this.updateWrapAABBBounds(t);var o=this.attribute,a=o.fontFamily,s=void 0===a?n.fontFamily:a,l=o.textAlign,u=void 0===l?n.textAlign:l,c=o.textBaseline,h=void 0===c?n.textBaseline:c,d=o.fontSize,f=void 0===d?n.fontSize:d,p=o.fontWeight,v=void 0===p?n.fontWeight:p,y=o.ellipsis,g=void 0===y?n.ellipsis:y,m=o.maxLineWidth,_=o.stroke,b=void 0===_?n.stroke:_,x=o.lineWidth,k=void 0===x?n.lineWidth:x,S=o.whiteSpace,A=void 0===S?n.whiteSpace:S,w=o.suffixPosition,T=void 0===w?n.suffixPosition:w,M=null!==(e=ph(o.lineHeight,o.fontSize||n.fontSize))&&void 0!==e?e:o.fontSize||n.fontSize;if("normal"===A)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null===(i=this.cache)||void 0===i?void 0:i.layoutData)){var C=this.cache.layoutData.bbox;return this._AABBBounds.set(C.xOffset,C.yOffset,C.xOffset+C.width,C.yOffset+C.height),b&&this._AABBBounds.expand(k/2),this._AABBBounds}var E=nu.graphicUtil.textMeasure,R=new $f(s,{fontSize:f,fontWeight:v,fontFamily:s},E).GetLayoutByLines(t,u,h,M,!0===g?n.ellipsis:g||void 0,!1,m,T),P=R.bbox;return this.cache.layoutData=R,this.clearUpdateShapeTag(),this._AABBBounds.set(P.xOffset,P.yOffset,P.xOffset+P.width,P.yOffset+P.height),b&&this._AABBBounds.expand(k/2),this._AABBBounds}},{key:"updateVerticalMultilineAABBBounds",value:function(t){var e,n,r,o,a=gc(this).text,s=nu.graphicUtil.textMeasure,l=this.attribute,u=l.ignoreBuf,c=(void 0===u?a.ignoreBuf:u)?0:2,h=l.maxLineWidth,d=void 0===h?a.maxLineWidth:h,f=l.ellipsis,p=void 0===f?a.ellipsis:f,v=l.fontFamily,y=void 0===v?a.fontFamily:v,g=l.fontSize,m=void 0===g?a.fontSize:g,_=l.fontWeight,b=void 0===_?a.fontWeight:_,x=l.stroke,k=void 0===x?a.stroke:x,S=l.lineWidth,A=void 0===S?a.lineWidth:S,w=l.verticalMode,T=void 0===w?a.verticalMode:w,M=l.suffixPosition,C=void 0===M?a.suffixPosition:M,E=null!==(e=ph(l.lineHeight,l.fontSize||a.fontSize))&&void 0!==e?e:(l.fontSize||a.fontSize)+c,R=l.textAlign,P=void 0===R?a.textAlign:R,B=l.textBaseline,L=void 0===B?a.textBaseline:B;if(!T){var O=P;P=null!==(n=i.baselineMapAlign[L])&&void 0!==n?n:"left",L=null!==(r=i.alignMapBaseline[O])&&void 0!==r?r:"top"}if(o=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);o=Xt(e,o)}));var I=Jf(P,o),D=this.cache.verticalList.length*E,F=Qf(L,D,m);return this._AABBBounds.set(F,I,F+D,I+o),k&&this._AABBBounds.expand(A/2),this._AABBBounds}var z=t.map((function(t){return Od(t.toString())}));z.forEach((function(t,e){if(Number.isFinite(d))if(p){var i=!0===p?a.ellipsis:p,n=s.clipTextWithSuffixVertical(t,{fontSize:m,fontWeight:b,fontFamily:y},d,i,!1,C);z[e]=n.verticalList,o=n.width}else{var r=s.clipTextVertical(t,{fontSize:m,fontWeight:b,fontFamily:y},d,!1);z[e]=r.verticalList,o=r.width}else o=0,t.forEach((function(t){var e=t.direction===Pd.HORIZONTAL?m:s.measureTextWidth(t.text,{fontSize:m,fontWeight:b,fontFamily:y});o+=e,t.width=e}))})),this.cache.verticalList=z,this.clearUpdateShapeTag(),this.cache.verticalList.forEach((function(t){var e=t.reduce((function(t,e){return t+e.width}),0);o=Xt(e,o)}));var j=Jf(P,o),H=this.cache.verticalList.length*E,N=Qf(L,H,m);return this._AABBBounds.set(N,j,N+H,j+o),k&&this._AABBBounds.expand(A/2),this._AABBBounds}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).text[t]}},{key:"needUpdateTags",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ep;return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,e)}},{key:"needUpdateTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ep;return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,e)}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function np(t){return new ip(t)}function rp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}ip.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},yd),ip.baselineMapAlign={top:"left",bottom:"right",middle:"center"},ip.alignMapBaseline={left:"top",right:"bottom",center:"middle"};var op=["heightLimit","lineClamp"],ap=function(t){ue(i,t);var e=rp(i);function i(t){return jt(this,i),e.call(this,Object.assign(Object.assign({},t),{wrap:!0}))}return zt(i,[{key:"_isValid",value:function(){var t=this.attribute.text;return B(t)?!t.every((function(t){return null==t||""===t})):null!=t&&""!==t}},{key:"updateMultilineAABBBounds",value:function(t){var e,i,n,r,o=gc(this).text,a=this.attribute,s=a.fontFamily,l=void 0===s?o.fontFamily:s,u=a.textAlign,c=void 0===u?o.textAlign:u,h=a.textBaseline,d=void 0===h?o.textBaseline:h,f=a.fontSize,p=void 0===f?o.fontSize:f,v=a.ellipsis,y=void 0===v?o.ellipsis:v,g=a.maxLineWidth,m=a.stroke,_=void 0===m?o.stroke:m,b=a.lineWidth,x=void 0===b?o.lineWidth:b,k=a.wordBreak,S=void 0===k?o.wordBreak:k,A=a.fontWeight,w=void 0===A?o.fontWeight:A,T=a.ignoreBuf,M=void 0===T?o.ignoreBuf:T,C=a.heightLimit,E=void 0===C?0:C,R=a.suffixPosition,P=void 0===R?o.suffixPosition:R,B=a.lineClamp,L=null!==(e=ph(this.attribute.lineHeight,this.attribute.fontSize||o.fontSize))&&void 0!==e?e:this.attribute.fontSize||o.fontSize,O=M?0:2;if(!this.shouldUpdateShape()&&(null===(i=this.cache)||void 0===i?void 0:i.layoutData)){var I=this.cache.layoutData.bbox;return this._AABBBounds.set(I.xOffset,I.yOffset,I.xOffset+I.width,I.yOffset+I.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}var D=nu.graphicUtil.textMeasure,F=new $f(l,{fontSize:p,fontWeight:w,fontFamily:l},D),z=t.map((function(t){return t.toString()})),j=[],H=[0,0],N=1/0;if(E>0&&(N=Math.max(Math.floor(E/L),1)),B&&(N=Math.min(N,B)),"number"==typeof g&&g!==1/0){if(g>0)for(var V=0;V<z.length;V++){var G=z[V],W=!0;if(V===N-1){var U=F.textMeasure.clipTextWithSuffix(G,F.textOptions,g,y,!1,P);j.push({str:U.str,width:U.width});break}var Y=F.textMeasure.clipText(G,F.textOptions,g,"break-word"===S);if(""!==G&&""===Y.str){if(y){var K=F.textMeasure.clipTextWithSuffix(G,F.textOptions,g,y,!1,P);Y.str=null!==(n=K.str)&&void 0!==n?n:"",Y.width=null!==(r=K.width)&&void 0!==r?r:0}else Y.str="",Y.width=0;W=!1}if(j.push({str:Y.str,width:Y.width}),Y.str.length===G.length);else if(W){var X=G.substring(Y.str.length);z.splice(V+1,0,X)}}var Z=0;j.forEach((function(t){Z=Math.max(Z,t.width)})),H[0]=Z}else{for(var q,J,Q=0,$=0,tt=z.length;$<tt;$++){if($===N-1){var et=F.textMeasure.clipTextWithSuffix(z[$],F.textOptions,g,y,!1,P);j.push({str:et.str,width:et.width}),Q=Math.max(Q,et.width);break}J=z[$],q=F.textMeasure.measureTextWidth(J,F.textOptions,"break-word"===S),Q=Math.max(Q,q),j.push({str:J,width:q})}H[0]=Q}H[1]=j.length*(L+O);var it={xOffset:0,yOffset:0,width:H[0],height:H[1]};F.LayoutBBox(it,c,d);var nt=F.layoutWithBBox(it,j,c,d,L);return this.cache.layoutData=nt,this.clearUpdateShapeTag(),this._AABBBounds.set(it.xOffset,it.yOffset,it.xOffset+it.width,it.yOffset+it.height),_&&this._AABBBounds.expand(x/2),this._AABBBounds}},{key:"needUpdateTags",value:function(t){for(var e=0;e<op.length;e++){var n=op[e];if(-1!==t.indexOf(n))return!0}return Xs(de(i.prototype),"needUpdateTags",this).call(this,t)}},{key:"needUpdateTag",value:function(t){for(var e=0;e<op.length;e++)if(t===op[e])return!0;return Xs(de(i.prototype),"needUpdateTag",this).call(this,t)}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(ip);function sp(t){return new ap(t)}var lp=function(){function t(){jt(this,t)}return zt(t,[{key:"bounds",value:function(t,e){if(I(t)){var i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}}]),t}();function up(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function cp(t,e,i,n,r){return r?t.arc(i,n,e,0,Gt,!1,r):t.arc(i,n,e,0,Gt),!1}var hp=function(t){ue(i,t);var e=up(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="circle",t.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return cp(t,e/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return cp(t,e/2+r,i,n,o)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=t/2;return"M ".concat(e-r,", ").concat(i," a ").concat(r,",").concat(r," 0 1,0 ").concat(2*r,",0 a ").concat(r,",").concat(r," 0 1,0 -").concat(2*r,",0")}}]),i}(lp),dp=new hp;function fp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var pp=function(t){ue(i,t);var e=fp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="cross",t.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(-3*e+i,-e+n,r),t.lineTo(-e+i,-e+n,r),t.lineTo(-e+i,-3*e+n,r),t.lineTo(e+i,-3*e+n,r),t.lineTo(e+i,-e+n,r),t.lineTo(3*e+i,-e+n,r),t.lineTo(3*e+i,e+n,r),t.lineTo(e+i,e+n,r),t.lineTo(e+i,3*e+n,r),t.lineTo(-e+i,3*e+n,r),t.lineTo(-e+i,e+n,r),t.lineTo(-3*e+i,e+n,r),t.closePath(),!0}(t,e/6,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return function(t,e,i,n,r,o){return t.moveTo(-3*e+i-r,-e+n-r,o),t.lineTo(-e+i-r,-e+n-r,o),t.lineTo(-e+i-r,-3*e+n-r,o),t.lineTo(e+i+r,-3*e+n-r,o),t.lineTo(e+i+r,-e+n-r,o),t.lineTo(3*e+i+r,-e+n-r,o),t.lineTo(3*e+i+r,e+n+r,o),t.lineTo(e+i+r,e+n+r,o),t.lineTo(e+i+r,3*e+n+r,o),t.lineTo(-e+i-r,3*e+n+r,o),t.lineTo(-e+i-r,e+n+r,o),t.lineTo(-3*e+i-r,e+n+r,o),t.closePath(),!0}(t,e/6,i,n,r,o)}}]),i}(lp),vp=new pp;function yp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function gp(t,e,i,n,r){return t.moveTo(i,n-e,r),t.lineTo(e+i,n,r),t.lineTo(i,n+e,r),t.lineTo(i-e,n,r),t.closePath(),!0}var mp=function(t){ue(i,t);var e=yp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="diamond",t.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return gp(t,e/2,i,n,r)}},{key:"drawFitDir",value:function(t,e,i,n,r){return gp(t,e/2,i,n,r)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return gp(t,e/2+r,i,n,o)}}]),i}(lp),_p=new mp;function bp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function xp(t,e,i,n){var r=2*e;return t.rect(i-e,n-e,r,r),!1}var kp=function(t){ue(i,t);var e=bp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="square",t.pathStr="M-0.5,-0.5h1v1h-1Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return xp(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return xp(t,e/2+r,i,n)}}]),i}(lp),Sp=new kp;function Ap(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var wp=function(t){ue(i,t);var e=Ap(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="triangleUp",t.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return function(t,e,i,n){return t.moveTo(i+e,e+n),t.lineTo(i-e,e+n),t.lineTo(i,n-e),t.closePath(),!0}(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(i+e+2*r,e+n+r),t.lineTo(i-e-2*r,e+n+r),t.lineTo(i,n-e-2*r),t.closePath(),!0}(t,e/2,i,n,r)}}]),i}(lp),Tp=new wp;function Mp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Cp=function(t){ue(i,t);var e=Mp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="triangle",t}return zt(i)}(wp),Ep=new Cp;function Rp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Pp=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),Bp=Math.sin(Gt/10)*Pp,Lp=-Math.cos(Gt/10)*Pp;function Op(t,e,i,n){var r=Bp*e,o=Lp*e;t.moveTo(i,-e+n),t.lineTo(r+i,o+n);for(var a=1;a<5;++a){var s=Gt*a/5,l=Math.cos(s),u=Math.sin(s);t.lineTo(u*e+i,-l*e+n),t.lineTo(l*r-u*o+i,u*r+l*o+n)}return t.closePath(),!0}var Ip=function(t){ue(i,t);var e=Rp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="star",t.pathStr="M4.51351666838205,0A4.51351666838205,4.51351666838205,0,1,1,-4.51351666838205,0A4.51351666838205,4.51351666838205,0,1,1,4.51351666838205,0",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return Op(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Op(t,e/2+r,i,n)}}]),i}(lp),Dp=new Ip;function Fp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var zp=Jt(3);function jp(t,e,i,n){var r=e,o=r/zp,a=o/5,s=e;return t.moveTo(0+i,-r+n),t.lineTo(o/2+i,n),t.lineTo(a/2+i,n),t.lineTo(a/2+i,s+n),t.lineTo(-a/2+i,s+n),t.lineTo(-a/2+i,n),t.lineTo(-o/2+i,n),t.closePath(),!0}var Hp=function(t){ue(i,t);var e=Fp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="arrow",t.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return jp(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return jp(t,e/2+r,i,n)}}]),i}(lp),Np=new Hp;function Vp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Gp(t,e,i,n){var r=2*e;return t.moveTo(i,-e+n),t.lineTo(r/3/2+i,e+n),t.lineTo(-r/3/2+i,e+n),t.closePath(),!0}var Wp=function(t){ue(i,t);var e=Vp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="wedge",t.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return Gp(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Gp(t,e/2+r,i,n)}}]),i}(lp),Up=new Wp;function Yp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Kp(t,e,i,n){return t.moveTo(-e+i,n),t.lineTo(i,e+n),!1}var Xp=function(t){ue(i,t);var e=Yp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="stroke",t.pathStr="",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return Kp(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Kp(t,e/2+r,i,n)}}]),i}(lp),Zp=new Xp;function qp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Jp=-.5,Qp=Jt(3)/2,$p=1/Jt(12);function tv(t,e,i,n){var r=e/2,o=e*$p,a=r,s=e*$p+e,l=-a,u=s;return t.moveTo(r+i,o+n),t.lineTo(a+i,s+n),t.lineTo(l+i,u+n),t.lineTo(Jp*r-Qp*o+i,Qp*r+Jp*o+n),t.lineTo(Jp*a-Qp*s+i,Qp*a+Jp*s+n),t.lineTo(Jp*l-Qp*u+i,Qp*l+Jp*u+n),t.lineTo(Jp*r+Qp*o+i,Jp*o-Qp*r+n),t.lineTo(Jp*a+Qp*s+i,Jp*s-Qp*a+n),t.lineTo(Jp*l+Qp*u+i,Jp*u-Qp*l+n),t.closePath(),!1}var ev=function(t){ue(i,t);var e=qp(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="wye",t.pathStr="M4.51351666838205,0A4.51351666838205,4.51351666838205,0,1,1,-4.51351666838205,0A4.51351666838205,4.51351666838205,0,1,1,4.51351666838205,0",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return tv(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return tv(t,e/2+r,i,n)}}]),i}(lp),iv=new ev;function nv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var rv=function(t){ue(i,t);var e=nv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="triangleLeft",t.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return function(t,e,i,n){return t.moveTo(-e+i,n),t.lineTo(e+i,e+n),t.lineTo(e+i,n-e),t.closePath(),!0}(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(-e+i-2*r,n),t.lineTo(e+i+r,e+n+2*r),t.lineTo(e+i+r,n-e-2*r),t.closePath(),!0}(t,e/2,i,n,r)}}]),i}(lp),ov=new rv;function av(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var sv=function(t){ue(i,t);var e=av(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="triangleRight",t.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return function(t,e,i,n){return t.moveTo(i-e,e+n),t.lineTo(e+i,n),t.lineTo(i-e,n-e),t.closePath(),!0}(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(i-e-r,e+n+2*r),t.lineTo(e+i+2*r,n),t.lineTo(i-e-r,n-e-2*r),t.closePath(),!0}(t,e/2,i,n,r)}}]),i}(lp),lv=new sv;function uv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var cv=function(t){ue(i,t);var e=uv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="triangleDown",t.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return function(t,e,i,n){return t.moveTo(i-e,n-e),t.lineTo(i+e,n-e),t.lineTo(i,n+e),t.closePath(),!0}(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return function(t,e,i,n,r){return t.moveTo(i-e-2*r,n-e-r),t.lineTo(i+e+2*r,n-e-r),t.lineTo(i,n+e+2*r),t.closePath(),!0}(t,e/2,i,n,r)}}]),i}(lp),hv=new cv;function dv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var fv=Jt(3);function pv(t,e,i,n){var r=e*fv;return t.moveTo(i,n+-r/3*2),t.lineTo(e+i,n+r),t.lineTo(i-e,n+r),t.closePath(),!0}var vv=function(t){ue(i,t);var e=dv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="thinTriangle",t.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return pv(t,e/2/fv,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return pv(t,e/2/fv+r,i,n)}}]),i}(wp),yv=new vv;function gv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function mv(t,e,i,n){var r=2*e;return t.moveTo(e+i,n-r),t.lineTo(i-e,n),t.lineTo(e+i,r+n),!0}var _v=function(t){ue(i,t);var e=gv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="arrow2Left",t.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return mv(t,e/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return mv(t,e/4+r,i,n)}}]),i}(lp),bv=new _v;function xv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function kv(t,e,i,n){var r=2*e;return t.moveTo(i-e,n-r),t.lineTo(i+e,n),t.lineTo(i-e,r+n),!0}var Sv=function(t){ue(i,t);var e=xv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="arrow2Right",t.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return kv(t,e/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return kv(t,e/4+r,i,n)}}]),i}(lp),Av=new Sv;function wv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Tv(t,e,i,n){var r=2*e;return t.moveTo(i-r,n+e),t.lineTo(i,n-e),t.lineTo(i+r,n+e),!0}var Mv=function(t){ue(i,t);var e=wv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="arrow2Up",t.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return Tv(t,e/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Tv(t,e/4+r,i,n)}}]),i}(lp),Cv=new Mv;function Ev(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Rv(t,e,i,n){var r=2*e;return t.moveTo(i-r,n-e),t.lineTo(i,n+e),t.lineTo(i+r,n-e),!0}var Pv=function(t){ue(i,t);var e=Ev(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="arrow2Down",t.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return Rv(t,e/4,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return Rv(t,e/4+r,i,n)}}]),i}(lp),Bv=new Pv;function Lv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Ov(t,e,i,n,r){return t.moveTo(i,n-e),t.lineTo(i,n+e),!0}var Iv=function(t){ue(i,t);var e=Lv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="lineV",t.pathStr="M0,-0.5L0,0.5",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return Ov(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return Ov(t,e/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=t/2;return"M ".concat(e,", ").concat(i-r," L ").concat(e,",").concat(i+r)}}]),i}(lp),Dv=new Iv;function Fv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function zv(t,e,i,n,r){return t.moveTo(i-e,n),t.lineTo(i+e,n),!0}var jv=function(t){ue(i,t);var e=Fv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="lineH",t.pathStr="M-0.5,0L0.5,0",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return zv(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return zv(t,e/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=t/2;return"M ".concat(e-r,", ").concat(i," L ").concat(e+r,",").concat(i)}}]),i}(lp),Hv=new jv;function Nv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Vv(t,e,i,n,r){return t.moveTo(i-e,n-e),t.lineTo(i+e,n+e),t.moveTo(i+e,n-e),t.lineTo(i-e,n+e),!0}var Gv=function(t){ue(i,t);var e=Nv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="close",t.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5",t}return zt(i,[{key:"draw",value:function(t,e,i,n,r){return Vv(t,e/2,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r,o){return Vv(t,e/2+r,i,n)}},{key:"drawToSvgPath",value:function(t,e,i,n){var r=t/2;return"M ".concat(e-r,", ").concat(i-r," L ").concat(e+r,",").concat(i+r," M ").concat(e+r,", ").concat(i-r," L ").concat(e-r,",").concat(i+r)}}]),i}(lp),Wv=new Gv;function Uv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function Yv(t,e,i,n){return t.rect(i-e[0]/2,n-e[1]/2,e[0],e[1]),!1}function Kv(t,e,i,n){var r=e,o=e/2;return t.rect(i-r/2,n-o/2,r,o),!1}var Xv=function(t){ue(i,t);var e=Uv(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="rect",t.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z",t}return zt(i,[{key:"draw",value:function(t,e,i,n){return I(e)?Kv(t,e,i,n):Yv(t,e,i,n)}},{key:"drawOffset",value:function(t,e,i,n,r){return I(e)?Kv(t,e+2*r,i,n):Yv(t,[e[0]+2*r,e[1]+2*r],i,n)}}]),i}(lp),Zv=new Xv,qv=new ye,Jv=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];jt(this,t),this.pathStr="",this.type=e,B(i)?this.svgCache=i:this.path=i,this.isSvg=n}return zt(t,[{key:"drawOffset",value:function(t,e,i,n,r,o,a){return this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(r){t.beginPath(),Ks(r.path.commandList,t,i,n,e,e),a&&a(r.path,r.attribute)})),!1):(Ks(this.path.commandList,t,i,n,e+r,e+r),!1)}},{key:"draw",value:function(t,e,i,n,r,o){return this.isSvg?!!this.svgCache&&(this.svgCache.forEach((function(r){t.beginPath(),Ks(r.path.commandList,t,i,n,e,e),o&&o(r.path,r.attribute)})),!1):(Ks(this.path.commandList,t,i,n,e,e),!1)}},{key:"bounds",value:function(t,e){if(this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach((function(i){var n=i.path;qv.x1=n.bounds.x1*t,qv.y1=n.bounds.y1*t,qv.x2=n.bounds.x2*t,qv.y2=n.bounds.y2*t,e.union(qv)}))}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}]),t}(),Qv={};[dp,vp,_p,Sp,yv,Ep,Dp,Np,Up,Zp,iv,ov,lv,Tp,hv,bv,Av,Cv,Bv,Zv,Dv,Hv,Wv].forEach((function(t){Qv[t.type]=t}));var $v={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};function ty(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var ey=new ye,iy=["symbolType","size"].concat(m(hd)),ny=function(t){ue(i,t);var e=ty(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{symbolType:"circle"};return jt(this,i),(t=e.call(this,n)).type="symbol",t.numberType=$d,t}return zt(i,[{key:"getParsedPath",value:function(){return this.shouldUpdateShape()&&(this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}},{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.size;return B(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}},{key:"doUpdateParsedPath",value:function(){var t,e=gc(this).symbol,n=this.attribute.symbolType,r=void 0===n?e.symbolType:n,o=Qv[r];if(o)return this._parsedPath=o,o;if(o=i.userSymbolMap[r])return this._parsedPath=o,o;if(!0===((t=r=$v[r]||r).startsWith("<svg")||t.startsWith("<?xml"))){var a=(new Md).parse(r).svg;if(!a)return null;var s=B(a.path)?a.path:[a.path];ey.clear();var l=[];s.forEach((function(t){var e=(new Pl).fromString(t.d),i={};of.forEach((function(e){t[e]&&(i[rf[e]]=t[e])})),l.push({path:e,attribute:i}),ey.union(e.bounds)}));var u=ey.width(),c=ey.height(),h=1/Xt(u,c);return l.forEach((function(t){return t.path.transform(0,0,h,h)})),this._parsedPath=new Jv(r,l,!0),i.userSymbolMap[r]=this._parsedPath,this._parsedPath}var d=(new Pl).fromString(r),f=d.bounds.width(),p=d.bounds.height(),v=1/Xt(f,p);return d.transform(0,0,v,v),this._parsedPath=new Jv(r,d),i.userSymbolMap[r]=this._parsedPath,this._parsedPath}},{key:"doUpdateAABBBounds",value:function(t){var e=gc(this).symbol;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var i=this.attribute,n=nu.graphicService.updateSymbolAABBBounds(i,gc(this).symbol,this._AABBBounds,t,this),r=i.boundsPadding,o=void 0===r?e.boundsPadding:r,a=rh(o);return a&&n.expand(a),this.clearUpdateBoundTag(),n}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).symbol[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,iy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,iy)}},{key:"toCustomPath",value:function(){var t=this.getParsedPath(),e=this.attribute.size,i=B(e)?e:[e,e];return t.path?(new Pl).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new Pl).fromString(t.pathStr,0,0,i[0],i[1])}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function ry(t){return new ny(t)}function oy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}ny.userSymbolMap={},ny.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},yd);var ay=["segments","points","curveType"].concat(m(hd)),sy=function(t){ue(i,t);var e=oy(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jt(this,i),(t=e.call(this,n)).type="line",t.numberType=Yd,t}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!(!e||e.length<=1)}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=uh(i,n,e))}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).line;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateLineAABBBounds(e,gc(this).line,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).line[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,ay)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,ay)}},{key:"toCustomPath",value:function(){var t=this.attribute,e=new Pl,i=t.segments,n=function(t){if(t&&t.length){var i=!0;t.forEach((function(t){!1!==t.defined&&(i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y),i=!1)}))}};return i&&i.length?i.forEach((function(t){n(t.points)})):t.points&&n(t.points),e}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function ly(t){return new sy(t)}function uy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}sy.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},yd);var cy=["width","x1","y1","height","cornerRadius"].concat(m(hd)),hy=function(t){ue(i,t);var e=uy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="rect",n.numberType=qd,n}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){return!0}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).rect;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateRectAABBBounds(e,gc(this).rect,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).rect[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,cy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,cy)}},{key:"toCustomPath",value:function(){var t=this.attribute,e=Ih(t),i=e.x,n=e.y,r=e.width,o=e.height,a=new Pl;return a.moveTo(i,n),a.rect(i,n,r,o),a}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function dy(t){return new hy(t)}function fy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}hy.NOWORK_ANIMATE_ATTR=yd;var py=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],vy=function(t){ue(i,t);var e=fy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="rect3d",n.numberType=Jd,n}return zt(i,[{key:"findFace",value:function(){var t={polygons:[],vertices:[],edges:[]},e=gc(this).rect3d,i=this.attribute,n=i.x1,r=i.y1,o=i.x,a=i.y,s=i.length,l=void 0===s?Zt(e.width,e.height):s,u=this.attribute,c=u.width,h=u.height;c=null!=c?c:n-o,h=null!=h?h:r-a;for(var d=0;d<py.length;d++){var f=py[d];t.vertices.push([f[0]*c,f[1]*h,f[2]*l])}return t.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),t.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),t.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),t.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),t.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),t.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),t.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],t}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(hy);function yy(t){return new vy(t)}function gy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}vy.NOWORK_ANIMATE_ATTR=yd;var my=function(t){ue(i,t);var e=gy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="glyph",n.numberType=Gd,n.subGraphic=[],n._onInit&&n._onInit(ce(n)),n.valid=n.isValid(),n}return zt(i,[{key:"setSubGraphic",value:function(t){var e=this;this.detachSubGraphic(),this.subGraphic=t,t.forEach((function(t){t.glyphHost=e,Object.setPrototypeOf(t.attribute,e.attribute)})),this.valid=this.isValid(),this.addUpdateBoundTag()}},{key:"detachSubGraphic",value:function(){this.subGraphic.forEach((function(t){t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})}))}},{key:"getSubGraphic",value:function(){return this.subGraphic}},{key:"onInit",value:function(t){this._onInit=t}},{key:"onUpdate",value:function(t){this._onUpdate=t}},{key:"isValid",value:function(){return!0}},{key:"setAttribute",value:function(t,e,n,r){Xs(de(i.prototype),"setAttribute",this).call(this,t,e,n,r),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"setAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;Xs(de(i.prototype),"setAttributes",this).call(this,t,e,n),this.subGraphic.forEach((function(t){t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()}))}},{key:"translate",value:function(t,e){return Xs(de(i.prototype),"translate",this).call(this,t,e),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"translateTo",value:function(t,e){return Xs(de(i.prototype),"translateTo",this).call(this,t,e),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scale",value:function(t,e,n){return Xs(de(i.prototype),"scale",this).call(this,t,e,n),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"scaleTo",value:function(t,e){return Xs(de(i.prototype),"scaleTo",this).call(this,t,e),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotate",value:function(t){return Xs(de(i.prototype),"rotate",this).call(this,t),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"rotateTo",value:function(t){return Xs(de(i.prototype),"rotate",this).call(this,t),this.subGraphic.forEach((function(t){t.addUpdatePositionTag(),t.addUpdateBoundTag()})),this}},{key:"doUpdateAABBBounds",value:function(){this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var t=nu.graphicService.updateGlyphAABBBounds(this.attribute,gc(this).glyph,this._AABBBounds,this);return this.clearUpdateBoundTag(),t}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"needUpdateTags",value:function(t){return!1}},{key:"needUpdateTag",value:function(t){return!1}},{key:"useStates",value:function(t,e){var i,n=this;if(t.length){if((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((function(t,e){return n.currentStates[e]!==t}))){var r={},o=this.subGraphic.map((function(){return{}}));t.forEach((function(e){var i,a=n.glyphStateProxy?n.glyphStateProxy(e,t):n.glyphStates[e];a&&(Object.assign(r,a.attributes),(null===(i=a.subAttributes)||void 0===i?void 0:i.length)&&o.forEach((function(t,e){Object.assign(t,a.subAttributes[e])})))})),this.subGraphic.forEach((function(i,n){i.updateNormalAttrs(o[n]),i.applyStateAttrs(o[n],t,e)})),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}}else this.clearStates(e)}},{key:"clearStates",value:function(t){var e=this;this.hasState()&&this.normalAttrs&&(this.subGraphic.forEach((function(i){i.applyStateAttrs(i.normalAttrs,e.currentStates,t,!0),i.normalAttrs=null})),this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0),this.normalAttrs=null,this.currentStates=[])}},{key:"clone",value:function(){var t=new i(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map((function(t){return t.clone()}))),t}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function _y(t){return new my(t)}my.NOWORK_ANIMATE_ATTR=yd;var by=function(){function t(e,i,n,r,o,a,s,l,u,c,h,d,f,p){jt(this,t),this.left=e,this.top=i,this.width=n,this.height=r,this.actualHeight=0,this.bottom=i+r,this.right=e+n,this.ellipsis=o,this.wordBreak=a,this.verticalDirection=s,this.lines=[],this.globalAlign=l,this.globalBaseline=u,this.layoutDirection=c,this.directionKey=ru[this.layoutDirection],this.isWidthMax=h,this.isHeightMax=d,this.singleLine=f,p?(p.clear(),this.icons=p):this.icons=new Map}return zt(t,[{key:"draw",value:function(t,e){var i=this.getActualSize(),n=i.width,r=i.height,o=this.isWidthMax?Math.min(this.width,n):this.width||n||0,a=this.isHeightMax?Math.min(this.height,r):this.height||r||0;a=Math.min(a,r);var s=0;switch(this.globalBaseline){case"top":s=0;break;case"middle":s=-a/2;break;case"bottom":s=-a}var l=0;switch(this.globalAlign){case"left":l=0;break;case"center":l=-o/2;break;case"right":l=-o}var u=this[this.directionKey.height];this.singleLine&&(u=this.lines[0].height+1);var c=!1;if("middle"===this.verticalDirection)if(this.actualHeight>=u&&0!==u)for(var h=0;h<this.lines.length;h++){var d=this.lines[h],f=d.top,p=d.height;if(f+p<this[this.directionKey.top]||f+p>this[this.directionKey.top]+u)return c;var v=!1;this.ellipsis&&this.lines[h+1]&&this.lines[h+1].top+this.lines[h+1].height>this[this.directionKey.top]+u&&(v=!0,c=!0),this.lines[h].draw(t,v,this.lines[h][this.directionKey.left]+l,this.lines[h][this.directionKey.top]+s,e)}else{var y=Math.floor((u-this.actualHeight)/2);"vertical"===this.layoutDirection?l+=y:s+=y;for(var g=0;g<this.lines.length;g++)this.lines[g].draw(t,!1,this.lines[g][this.directionKey.left]+l,this.lines[g][this.directionKey.top]+s,e)}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(var m=0;m<this.lines.length;m++){var _=this.lines[m];_.top;var b=_.height,x=u-this.lines[m].top-this.lines[m].height;if(0===u)this.lines[m].draw(t,!1,l,x+s,e);else{if(x+b>this[this.directionKey.top]+u||x<this[this.directionKey.top])return c;var k=!1;this.ellipsis&&this.lines[m+1]&&x-this.lines[m+1].height<this[this.directionKey.top]&&(k=!0,c=!0),this.lines[m].draw(t,k,l,x+s,e)}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(var S=0;S<this.lines.length;S++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(l-=this.lines[S].height+this.lines[S].top);var A=this.lines[S],w=A.top,T=A.height;if(0===u)this.lines[S].draw(t,!1,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,e);else{if(w+T<this[this.directionKey.top]||w+T>this[this.directionKey.top]+u)return c;var M=!1;this.ellipsis&&this.lines[S+1]&&this.lines[S+1].top+this.lines[S+1].height>this[this.directionKey.top]+u&&(M=!0,c=!0),this.lines[S].draw(t,M,this.lines[S][this.directionKey.left]+l,this.lines[S][this.directionKey.top]+s,e)}}}return c}},{key:"getActualSize",value:function(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}},{key:"getRawActualSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.actualWidth>t&&(t=n.actualWidth),e+=n.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}},{key:"getActualSizeWidthEllipsis",value:function(){var t=0,e=0,i=this.getRawActualSize();i.width;i.height;this.width,this.height;var n=this[this.directionKey.height];if(this.singleLine&&(n=this.lines[0].height+1),"middle"===this.verticalDirection)if(this.actualHeight>=n&&0!==n)for(var r=0;r<this.lines.length;r++){var o=this.lines[r],a=o.top,s=o.height;if(a+s<this[this.directionKey.top]||a+s>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[r+1]&&this.lines[r+1].top+this.lines[r+1].height>this[this.directionKey.top]+n){var l=this.lines[r].getWidthWithEllips();l>t&&(t=l),e+=this.lines[r].height}else this.lines[r].actualWidth>t&&(t=this.lines[r].actualWidth),e+=this.lines[r].height}else{Math.floor((n-this.actualHeight)/2);for(var u=0;u<this.lines.length;u++)this.lines[u].actualWidth>t&&(t=this.lines[u].actualWidth),e+=this.lines[u].height}else if("bottom"===this.verticalDirection)for(var c=0;c<this.lines.length;c++){var h=this.lines[c];h.top;var d=h.height,f=n-this.lines[c].top-this.lines[c].height;if(0===n)this.lines[c].actualWidth>t&&(t=this.lines[c].actualWidth),e+=this.lines[c].height;else if(f+d>this[this.directionKey.top]+n||f<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[c+1]&&f-this.lines[c+1].height<this[this.directionKey.top]){var p=this.lines[c].getWidthWithEllips();p>t&&(t=p),e+=this.lines[c].height}else this.lines[c].actualWidth>t&&(t=this.lines[c].actualWidth),e+=this.lines[c].height}else for(var v=0;v<this.lines.length;v++){var y=this.lines[v],g=y.top,m=y.height;if(0===n)this.lines[v].actualWidth>t&&(t=this.lines[v].actualWidth),e+=this.lines[v].height;else if(g+m<this[this.directionKey.top]||g+m>this[this.directionKey.top]+n);else if(this.ellipsis&&this.lines[v+1]&&this.lines[v+1].top+this.lines[v+1].height>this[this.directionKey.top]+n){var _=this.lines[v].getWidthWithEllips();_>t&&(t=_),e+=this.lines[v].height}else this.lines[v].actualWidth>t&&(t=this.lines[v].actualWidth),e+=this.lines[v].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}]),t}(),xy=function(){function t(e,i,n){jt(this,t),this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic";var r=ph(n.lineHeight,this.fontSize);this.lineHeight="number"==typeof r?r>this.fontSize?r:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;var o=du(e,n),a=o.ascent,s=o.height,l=o.descent,u=o.width,c=0,h=0,d=0;this.height>s&&(c=(this.height-s)/2,h=Math.ceil(c),d=Math.floor(c)),"top"===this.textBaseline?(this.ascent=c,this.descent=s-c):"bottom"===this.textBaseline?(this.ascent=s-c,this.descent=c):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=a+h,this.descent=l+d),this.length=e.length,this.width=u||0,this.text=e||"",this.newLine=i||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,"vertical"===n.direction&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height)}return zt(t,[{key:"updateWidth",value:function(){var t=du(this.text,this.character).width;this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}},{key:"draw",value:function(t,e,i,n,r){var o=this.text,a=this.left+i;e+=this.top;var s=this.direction;if(this.verticalEllipsis)o="...",s="vertical",e-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)o+="...","right"===r&&(a-=this.ellipsisWidth);else if("replace"===this.ellipsis){var l=cu(o,("vertical"===s?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,o.length-1);if(o=o.slice(0,l),o+="...","right"===r){var u=du(this.text.slice(l),this.character).width;"vertical"===s||(a-=this.ellipsisWidth-u)}}}switch(this.character.script){case"super":e-=this.ascent*(1/3);break;case"sub":e+=this.descent/2}"vertical"===s&&(t.save(),t.rotateAbout(Math.PI/2,a,e),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(a,e),a=0,e=0),this.character.stroke&&(function(t,e){var i=e&&e.stroke||au;if(i){t.globalAlpha=1,t.lineWidth=e&&"number"==typeof e.lineHeight?e.lineHeight:1,t.strokeStyle=i;var n=e.fontSize||16;switch(e.script){case"super":case"sub":n*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:n,fontFamily:e.fontFamily||"sans-serif"})}else t.globalAlpha=0}(t,this.character),t.strokeText(o,a,e)),function(t,e){var i=e&&e.fill||ou;if(i){t.globalAlpha=1,t.fillStyle=i;var n=e.fontSize||16;switch(e.script){case"super":case"sub":n*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:n,fontFamily:e.fontFamily||"sans-serif"})}else t.globalAlpha=0}(t,this.character),this.character.fill&&t.fillText(o,a,e),this.character.fill&&("boolean"==typeof this.character.lineThrough||"boolean"==typeof this.character.underline?(this.character.underline&&t.fillRect(a,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1),this.character.lineThrough&&t.fillRect(a,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)):"underline"===this.character.textDecoration?t.fillRect(a,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1):"line-through"===this.character.textDecoration&&t.fillRect(a,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)),"vertical"===s&&t.restore()}},{key:"getWidthWithEllips",value:function(t){var e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){var n=cu(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,n),e+="...";var r=du(this.text.slice(n),this.character).width;return i+this.ellipsisWidth-r}return i}}]),t}();function ky(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Sy=["width","height","image"].concat(m(hd)),Ay=function(t){ue(i,t);var e=ky(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="image",n.numberType=Ud,n.loadImage(n.attribute.image),n}return zt(i,[{key:"width",get:function(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:0},set:function(t){this.attribute.width===t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}},{key:"height",get:function(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:0},set:function(t){this.attribute.height===t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}},{key:"repeatX",get:function(){var t;return null!==(t=this.attribute.repeatX)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}},{key:"repeatY",get:function(){var t;return null!==(t=this.attribute.repeatY)&&void 0!==t?t:"no-repeat"},set:function(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}},{key:"image",get:function(){return this.attribute.image},set:function(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}},{key:"imageLoadSuccess",value:function(t,e,n){var r=this;Xs(de(i.prototype),"imageLoadSuccess",this).call(this,t,e,(function(){r.successCallback&&r.successCallback()}))}},{key:"imageLoadFail",value:function(t,e){var n=this;Xs(de(i.prototype),"imageLoadFail",this).call(this,t,(function(){n.failCallback&&n.failCallback()}))}},{key:"setAttributes",value:function(t,e,n){return t.image&&this.loadImage(t.image),Xs(de(i.prototype),"setAttributes",this).call(this,t,e,n)}},{key:"setAttribute",value:function(t,e,n,r){return"image"===t&&this.loadImage(e),Xs(de(i.prototype),"setAttribute",this).call(this,t,e,n,r)}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).image;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateImageAABBBounds(e,gc(this).image,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return eu[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,Sy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,Sy)}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function wy(t){return new Ay(t)}function Ty(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Ay.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},yd);var My=function(t){ue(i,t);var e=Ty(i);function i(t){var n;if(jt(this,i),(n=e.call(this,t))._x=0,n._y=0,n._hovered=!1,n._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(n._hovered=!0),t.margin){var r=rh(t.margin);n._marginArray="number"==typeof r?[r,r,r,r]:r}return n.onBeforeAttributeUpdate=function(t,e,i){if(B(i)&&-1!==i.indexOf("margin")||"margin"===i)if(e.margin){var r=rh(e.margin);n._marginArray="number"==typeof r?[r,r,r,r]:r}else n._marginArray=[0,0,0,0]},he(n)}return zt(i,[{key:"width",get:function(){var t;return(null!==(t=this.attribute.width)&&void 0!==t?t:0)+this._marginArray[1]+this._marginArray[3]}},{key:"height",get:function(){var t;return(null!==(t=this.attribute.height)&&void 0!==t?t:0)+this._marginArray[0]+this._marginArray[2]}},{key:"tryUpdateAABBBounds",value:function(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();var t=this.attribute,e=t.width,i=void 0===e?eu.width:e,n=t.height,r=void 0===n?eu.height:n,o=this.attribute,a=o.backgroundWidth,s=void 0===a?i:a,l=o.backgroundHeight,u=(s-i)/2,c=((void 0===l?r:l)-r)/2;return this._AABBBounds.expand([0,2*u,2*c,0]),this._AABBBounds}},{key:"setHoverState",value:function(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}]),i}(Ay),Cy=function(){function t(e,i,n,r,o,a,s,l){var u=this;jt(this,t),this.left=e,this.width=i,this.baseline=n,this.ascent=r,this.descent=o,this.top=n-r,this.paragraphs=a.map((function(t){return t})),this.textAlign=(this.paragraphs[0]instanceof My?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=s,this.directionKey=ru[this.direction],this.actualWidth=0;var c=0;this.paragraphs.forEach((function(t,e){if(0===e&&t instanceof xy){var i=uu.exec(t.text);0!==(null==i?void 0:i.index)&&(t.text=t.text.slice(null==i?void 0:i.index),t.updateWidth())}u.actualWidth+=t[u.directionKey.width],c=Math.max(t[u.directionKey.height],c)})),this.height=c,this.blankWidth=l?0:this.width-this.actualWidth,this.calcOffset(i,l)}return zt(t,[{key:"calcOffset",value:function(t,e){var i=this.directionKey,n=this.height,r=this.left,o=0;if(this.actualWidth<t&&!e)switch(this.textAlign){case"right":r=t-this.actualWidth;break;case"center":r=(t-this.actualWidth)/2;break;case"justify":this.paragraphs.length<2?r=(t-this.actualWidth)/2:o=(t-this.actualWidth)/(this.paragraphs.length-1)}this.paragraphs.map((function(t){t instanceof My?(t["_"+i.x]=r,r+=t[i.width]+o,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?n-t.height:(n-t.height)/2):(t[i.left]=r,r+=t[i.width]+o)}))}},{key:"draw",value:function(t,e,i,n,r){var o=this;if(e)for(var a=0,s=this.paragraphs.length-1;s>=0;s--){var l=this.paragraphs[s];if(l instanceof My)break;if("vertical"===this.direction&&"vertical"!==l.direction){l.verticalEllipsis=!0;break}var u=du("...",l.character).width||0;if(u<=this.blankWidth+a){l.ellipsis="add";break}if(u<=this.blankWidth+a+l.width){l.ellipsis="replace",l.ellipsisWidth=u,l.ellipsisOtherParagraphWidth=this.blankWidth+a;break}l.ellipsis="hide",a+=l.width}this.paragraphs.map((function(e,a){if(e instanceof My)return e.setAttributes({x:i+e._x,y:n+e._y}),void r(e,t,i+e._x,n+e._y,o.ascent);e.draw(t,n+o.ascent,i,0===a,o.textAlign)}))}},{key:"getWidthWithEllips",value:function(){for(var t=this,e=0,i=this.paragraphs.length-1;i>=0;i--){var n=this.paragraphs[i];if(n instanceof My)break;var r=du("...",n.character).width||0;if(r<=this.blankWidth+e){n.ellipsis="add",n.ellipsisWidth=r;break}if(r<=this.blankWidth+e+n.width){n.ellipsis="replace",n.ellipsisWidth=r,n.ellipsisOtherParagraphWidth=this.blankWidth+e;break}n.ellipsis="hide",e+=n.width}var o=0;return this.paragraphs.map((function(e,i){o+=e instanceof My?e.width:e.getWidthWithEllips(t.direction)})),o}}]),t}(),Ey=function(){function t(e){jt(this,t),this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=ru[this.direction]}return zt(t,[{key:"store",value:function(t){if(t instanceof My){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];var e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}},{key:"send",value:function(){if(0!==this.lineBuffer.length){var t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new Cy(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}}},{key:"deal",value:function(t){t instanceof My?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),0!==t.text.length&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t)))}},{key:"cut",value:function(t){var e=this[this.directionKey.width]-this.lineWidth||0,i=Math.ceil(e/t[this.directionKey.width]*t.length)||0,n=cu(t.text,e,t.character,i,"break-word"===this.frame.wordBreak);if(0!==n){var r=function(t,e){var i=t.text.slice(0,e),n=t.text.slice(e);return[new xy(i,t.newLine,t.character),new xy(n,!0,t.character)]}(t,n),o=Mt(r,2),a=o[0],s=o[1];this.store(a),this.deal(s)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}]),t}();function Ry(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Py=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection"].concat(m(hd)),By=function(t){ue(i,t);var e=Ry(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="richtext",n._currentHoverIcon=null,n.numberType=Qd,n}return zt(i,[{key:"width",get:function(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:tu.width},set:function(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}},{key:"height",get:function(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:tu.height},set:function(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxWidth",get:function(){return this.attribute.maxWidth},set:function(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}},{key:"maxHeight",get:function(){return this.attribute.maxHeight},set:function(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}},{key:"ellipsis",get:function(){var t;return null!==(t=this.attribute.ellipsis)&&void 0!==t?t:tu.ellipsis},set:function(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}},{key:"wordBreak",get:function(){var t;return null!==(t=this.attribute.wordBreak)&&void 0!==t?t:tu.wordBreak},set:function(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}},{key:"verticalDirection",get:function(){var t;return null!==(t=this.attribute.verticalDirection)&&void 0!==t?t:tu.verticalDirection},set:function(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}},{key:"textAlign",get:function(){var t;return null!==(t=this.attribute.textAlign)&&void 0!==t?t:tu.textAlign},set:function(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}},{key:"textBaseline",get:function(){var t;return null!==(t=this.attribute.textBaseline)&&void 0!==t?t:tu.textBaseline},set:function(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}},{key:"textConfig",get:function(){var t;return null!==(t=this.attribute.textConfig)&&void 0!==t?t:tu.textConfig},set:function(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).richtext;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateRichTextAABBBounds(e,gc(this).richtext,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return tu[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,Py)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,Py)}},{key:"getFrameCache",value:function(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}},{key:"doUpdateFrameCache",value:function(){for(var t,e=this,i=this.attribute,n=i.textConfig,r=void 0===n?[]:n,o=i.maxWidth,a=i.maxHeight,s=i.width,l=i.height,u=i.ellipsis,c=i.wordBreak,h=i.verticalDirection,d=i.textAlign,f=i.textBaseline,p=i.layoutDirection,v=i.singleLine,y=[],g=0;g<r.length;g++)if("image"in r[g]){var m=r[g],_=m.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(m.id);if(_)y.push(_);else{var b=new My(m);b.successCallback=function(){var t;e.addUpdateBoundTag(),null===(t=e.stage)||void 0===t||t.renderNextFrame()},b.richtextId=m.id,y.push(b)}}else if(r[g].text.includes("\n"))for(var x=r[g].text.split("\n"),k=0;k<x.length;k++)y.push(new xy(x[k],0!==k,r[g]));else y.push(new xy(r[g].text,!1,r[g]));for(var S="number"==typeof o&&Number.isFinite(o)&&o>0,A="number"==typeof a&&Number.isFinite(a)&&a>0,w="number"==typeof s&&Number.isFinite(s)&&s>0&&(!S||s<=o),T="number"==typeof l&&Number.isFinite(l)&&l>0&&(!A||l<=a),M=new by(0,0,(w?s:S?o:0)||0,(T?l:A?a:0)||0,u,c,h,d,f,p||"horizontal",!w&&S,!T&&A,v||!1,null===(t=this._frameCache)||void 0===t?void 0:t.icons),C=new Ey(M),E=0;E<y.length;E++)C.deal(y[E]);if(C.send(),!("horizontal"===M.layoutDirection?w:T)){var R=M.getActualSizeWidthEllipsis(),P="horizontal"===M.layoutDirection?R.width:R.height;("horizontal"===M.layoutDirection?S:A)&&(P=Math.min(P,"horizontal"===M.layoutDirection?o:a)),M.lines.forEach((function(t){t.calcOffset(P,!1)}))}this._frameCache=M}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"setStage",value:function(t,e){Xs(de(i.prototype),"setStage",this).call(this,t,e),this.getFrameCache().icons.forEach((function(i){i.setStage(t,e)}))}},{key:"bindIconEvent",value:function(){var t=this;this.addEventListener("pointermove",(function(e){var i,n,r,o,a,s=t.pickIcon(e.global);s&&s===t._currentHoverIcon||(s?(null===(i=t._currentHoverIcon)||void 0===i||i.setHoverState(!1),t._currentHoverIcon=s,t._currentHoverIcon.setHoverState(!0),null===(n=t.stage)||void 0===n||n.setCursor(s.attribute.cursor),null===(r=t.stage)||void 0===r||r.renderNextFrame()):!s&&t._currentHoverIcon&&(t._currentHoverIcon.setHoverState(!1),t._currentHoverIcon=null,null===(o=t.stage)||void 0===o||o.setCursor(),null===(a=t.stage)||void 0===a||a.renderNextFrame()))})),this.addEventListener("pointerleave",(function(e){var i,n;t._currentHoverIcon&&(t._currentHoverIcon.setHoverState(!1),t._currentHoverIcon=null,null===(i=t.stage)||void 0===i||i.setCursor(),null===(n=t.stage)||void 0===n||n.renderNextFrame())}))}},{key:"pickIcon",value:function(t){var e,i=this.getFrameCache(),n=this.globalTransMatrix,r=n.e,o=n.f;return i.icons.forEach((function(i){var n,a;i.AABBBounds.containsPoint({x:t.x-r,y:t.y-o})&&(e=i,e.globalX=(null!==(n=e.attribute.x)&&void 0!==n?n:0)+r,e.globalY=(null!==(a=e.attribute.y)&&void 0!==a?a:0)+o)})),e}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Ly(t){return new By(t)}function Oy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}By.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},yd);var Iy=["path","customPath"].concat(m(hd)),Dy=function(t){ue(i,t);var e=Oy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="path",n.numberType=Kd,n}return zt(i,[{key:"pathShape",get:function(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}},{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.path;return null!=t&&""!==t}},{key:"getParsedPathShape",value:function(){var t=gc(this).path;if(!this.valid)return t.path;var e=this.attribute;return e.path instanceof Pl?e.path:(w(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Pl?this.cache:t.path)}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).path;this.doUpdatePathShape(),this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updatePathAABBBounds(e,gc(this).path,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"doUpdatePathShape",value:function(){var t=this.attribute;P(t.path,!0)?this.cache=(new Pl).fromString(t.path):t.customPath&&(this.cache=new Pl,t.customPath(this.cache,this))}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"getDefaultAttribute",value:function(t){return gc(this).path[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,Iy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,Iy)}},{key:"toCustomPath",value:function(){return(new Pl).fromCustomPath2D(this.getParsedPathShape(),0,0)}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Fy(t){return new Dy(t)}function zy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Dy.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},yd);var jy=["segments","points","curveType"].concat(m(hd)),Hy=function(t){ue(i,t);var e=zy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="area",n.numberType=Nd,n}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){if(this.pathProxy)return!0;var t=this.attribute,e=t.points,i=t.segments;return i?0!==i.length:!!e&&0!==e.length}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).area;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateAreaAABBBounds(e,gc(this).area,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),i}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=uh(i,n,e))}},{key:"getDefaultAttribute",value:function(t){return gc(this).area[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,jy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,jy)}},{key:"toCustomPath",value:function(){var t=new Pl,e=this.attribute,i=e.segments,n=function(e){if(e&&e.length){var i=!0,n=[];if(e.forEach((function(e){var r,o;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),n.push({x:null!==(r=e.x1)&&void 0!==r?r:e.x,y:null!==(o=e.y1)&&void 0!==o?o:e.y}),i=!1)})),n.length){for(var r=n.length-1;r>=0;r--)t.lineTo(n[r].x,n[r].y);t.closePath()}}};return e.points?n(e.points):i&&i.length&&i.forEach((function(t){n(t.points)})),t}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Ny(t){return new Hy(t)}function Vy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Hy.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},yd);var Gy=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap"].concat(m(hd)),Wy=function(t){ue(i,t);var e=Vy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="arc",n.numberType=jd,n}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute,e=t.startAngle,i=t.endAngle,n=t.outerRadius,r=t.innerRadius;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)&&this._validNumber(r)}},{key:"getParsedCornerRadius",value:function(){var t=gc(this).arc,e=this.attribute,i=e.cornerRadius,n=void 0===i?t.cornerRadius:i,r=e.outerRadius,o=void 0===r?t.outerRadius:r,a=e.innerRadius,s=void 0===a?t.innerRadius:a;if(0===n||"0%"===n)return 0;var l=Math.abs(o-s);return Math.min(I(n,!0)?n:l*parseFloat(n)/100,l/2)}},{key:"getParsedAngle",value:function(){var t=gc(this).arc,e=this.attribute,i=e.startAngle,n=void 0===i?t.startAngle:i,r=e.endAngle,o=void 0===r?t.endAngle:r,a=this.attribute.cap,s=void 0===a?t.cap:a,l=o-n>=0?1:-1,u=o-n;if(o=(n=_e(n))+u,s&&Ut(u)<Wt-Ht){var c=1,h=1;s.length&&(c=Number(s[0]),h=Number(s[1]));var d=this.attribute,f=d.outerRadius,p=void 0===f?t.outerRadius:f,v=d.innerRadius,y=void 0===v?t.innerRadius:v,g=Math.abs(p-y)/2,m=g/p;if(g>Ht&&p>Ht)return{startAngle:n-l*m*c,endAngle:o+l*m*h,sc:l*m*c,ec:l*m*h}}return{startAngle:n,endAngle:o}}},{key:"getParsePadAngle",value:function(t,e){var i=gc(this).arc,n=this.attribute,r=n.outerRadius,o=void 0===r?i.outerRadius:r,a=n.innerRadius,s=void 0===a?i.innerRadius:a,l=n.padAngle,u=void 0===l?i.padAngle:l,c=this.attribute.padRadius,h=void 0===c?Jt(o*o+s*s):c,d=Ut(e-t),f=t,p=e,v=t,y=e,g=u/2,m=d,_=d;if(g>Ht&&h>Ht){var b=e>t?1:-1,x=te(Number(h)/s*qt(g)),k=te(Number(h)/o*qt(g));return(m-=2*x)>Ht?(v+=x*=b,y-=x):(m=0,v=y=(t+e)/2),(_-=2*k)>Ht?(f+=k*=b,p-=k):(_=0,f=p=(t+e)/2),{outerStartAngle:f,outerEndAngle:p,innerStartAngle:v,innerEndAngle:y,innerDeltaAngle:m,outerDeltaAngle:_}}return{outerStartAngle:f,outerEndAngle:p,innerStartAngle:v,innerEndAngle:y,innerDeltaAngle:m,outerDeltaAngle:_}}},{key:"doUpdateAABBBounds",value:function(t){var e=gc(this).arc;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var i=this.attribute,n=nu.graphicService.updateArcAABBBounds(i,gc(this).arc,this._AABBBounds,t,this),r=i.boundsPadding,o=void 0===r?e.boundsPadding:r,a=rh(o);return a&&n.expand(a),this.clearUpdateBoundTag(),n}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,Gy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,Gy)}},{key:"getDefaultAttribute",value:function(t){return gc(this).arc[t]}},{key:"toCustomPath",value:function(){var t=this.attribute,e=this.getParsedAngle(),i=e.startAngle,n=e.endAngle,r=t.innerRadius,o=t.outerRadius,a=Ut(n-i),s=n>i;if(o<r){var l=o;o=r,r=l}var u=new Pl;if(o<=Ht)u.moveTo(0,0);else if(a>=Wt-Ht)u.moveTo(0+o*Kt(i),0+o*qt(i)),u.arc(0,0,o,i,n,!s),r>Ht&&(u.moveTo(0+r*Kt(n),0+r*qt(n)),u.arc(0,0,r,n,i,s));else{var c=o*Kt(i),h=o*qt(i),d=r*Kt(n),f=r*qt(n);u.moveTo(0+c,0+h),u.arc(0,0,o,i,n,!s),u.lineTo(0+d,0+f),u.arc(0,0,r,n,i,s),u.closePath()}return u}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Uy(t){return new Wy(t)}function Yy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Wy.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},yd);var Ky=function(t){ue(i,t);var e=Yy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="arc3d",n.numberType=Hd,n}return zt(i,[{key:"doUpdateAABBBounds",value:function(){var t=gc(this).arc;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updateArc3dAABBBounds(e,gc(this).polygon,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),this._AABBBounds}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(Wy);function Xy(t){return new Ky(t)}function Zy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Ky.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},yd);var qy=["points","cornerRadius"].concat(m(hd)),Jy=function(t){ue(i,t);var e=Zy(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="polygon",n.numberType=Xd,n}return zt(i,[{key:"isValid",value:function(){return Xs(de(i.prototype),"isValid",this).call(this)&&this._isValid()}},{key:"_isValid",value:function(){var t=this.attribute.points;return t&&t.length>=2}},{key:"doUpdateAABBBounds",value:function(){var t=gc(this).polygon;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updatePolygonAABBBounds(e,gc(this).polygon,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),this._AABBBounds}},{key:"tryUpdateOBBBounds",value:function(){throw new Error("暂不支持")}},{key:"_interpolate",value:function(t,e,i,n,r){"points"===t&&(r.points=uh(i,n,e))}},{key:"getDefaultAttribute",value:function(t){return gc(this).polygon[t]}},{key:"needUpdateTags",value:function(t){return Xs(de(i.prototype),"needUpdateTags",this).call(this,t,qy)}},{key:"needUpdateTag",value:function(t){return Xs(de(i.prototype),"needUpdateTag",this).call(this,t,qy)}},{key:"toCustomPath",value:function(){var t=this.attribute.points,e=new Pl;return t.forEach((function(t,i){0===i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)})),e.closePath(),e}},{key:"clone",value:function(){return new i(Object.assign({},this.attribute))}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(gd);function Qy(t){return new Jy(t)}function $y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Jy.NOWORK_ANIMATE_ATTR=yd;var tg=function(t){ue(i,t);var e=$y(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).type="pyramid3d",n.numberType=Zd,n}return zt(i,[{key:"doUpdateAABBBounds",value:function(){var t=gc(this).polygon;this._AABBBounds.setValue(1/0,1/0,-1/0,-1/0);var e=this.attribute,i=nu.graphicService.updatePyramid3dAABBBounds(e,gc(this).polygon,this._AABBBounds,this),n=e.boundsPadding,r=void 0===n?t.boundsPadding:n,o=rh(r);return o&&i.expand(o),this.clearUpdateBoundTag(),this._AABBBounds}},{key:"findFace",value:function(){for(var t=this.attribute.points,e=t.map((function(e,i){var n=3===i?t[0]:t[i+1],r=e.x-n.x;return 0===r?0:(e.y-n.y)/r})),i=t.map((function(t){return{p:t,d:0}})),n=!1,r=0,o=0;o<e.length-1;o++){for(var a=o+1;a<e.length;a++){if(e[o]===e[a]){n=!0;var s=se.distancePP(i[o].p,i[o+1].p);i[o].d=s,i[o+1].d=s,r=Xt(r,s);var l=se.distancePP(i[a].p,i[a+1].p);i[a].d=l,i[a+1].d=l,r=Xt(r,l)}if(n)break}if(n)break}for(var u=t.length-1;u>=0;u--){var c=t[u];i.unshift({p:c,d:0})}for(var h=0;h<t.length;h++){var d=(r-i[h+t.length].d)/2;i[h].d+=d,i[h+t.length].d+=d}var f={polygons:[],vertices:[],edges:[]};return i.forEach((function(t){f.vertices.push([t.p.x,t.p.y,t.d])})),f.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),f.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),f.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),f.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),f.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),f.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),f.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],f}},{key:"_isValid",value:function(){return Xs(de(i.prototype),"_isValid",this).call(this)&&4===this.attribute.points.length}},{key:"getNoWorkAnimateAttr",value:function(){return i.NOWORK_ANIMATE_ATTR}}]),i}(Jy);function eg(t){return new tg(t)}function ig(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}tg.NOWORK_ANIMATE_ATTR=yd;var ng=function(t){ue(i,t);var e=ig(i);function i(t){var n;return jt(this,i),(n=e.call(this,{x:0,y:0})).type="shadowroot",n.shadowHost=t,n}return zt(i,[{key:"addUpdateBoundTag",value:function(){Xs(de(i.prototype),"addUpdateBoundTag",this).call(this),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"addUpdateShapeAndBoundsTag",value:function(){Xs(de(i.prototype),"addUpdateShapeAndBoundsTag",this).call(this),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}},{key:"tryUpdateGlobalTransMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.shouldUpdateGlobalMatrix()){var e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}},{key:"doUpdateGlobalMatrix",value:function(){if(this.shadowHost){var t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}},{key:"tryUpdateGlobalAABBBounds",value:function(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}]),i}(sf);function rg(t){return new ng(t)}var og=function(){function t(){jt(this,t)}return zt(t,[{key:"updateBounds",value:function(t,e,i,n){var r=t.outerBorder,o=t.shadowBlur,a=void 0===o?e.shadowBlur:o;if(r){var s=e.outerBorder,l=r.distance,u=void 0===l?s.distance:l,c=r.lineWidth,h=void 0===c?s.lineWidth:c;i.expand(u+(a+h)/2)}return i}}]),t}();function ag(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var sg=function(t){ue(i,t);var e=ag(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"updateBounds",value:function(t,e,i,n){var r=t.outerBorder,o=t.shadowBlur,a=void 0===o?e.shadowBlur:o,s=t.strokeBoundsBuffer,l=void 0===s?e.strokeBoundsBuffer:s;if(r){var u=e.outerBorder,c=r.distance,h=void 0===c?u.distance:c,d=r.lineWidth;Rd(i,h+(a+(void 0===d?u.lineWidth:d))/2,!0,l)}return i}}]),i}(og);var lg=function(){function t(){jt(this,t),this.pools=[]}return zt(t,[{key:"allocate",value:function(t,e,i,n,r,o){if(!this.pools.length)return new ke(t,e,i,n,r,o);var a=this.pools.pop();return a.a=t,a.b=e,a.c=i,a.d=n,a.e=r,a.f=o,a}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new ke(t.a,t.b,t.c,t.d,t.e,t.f);var e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}]),t}(),ug=function(){function t(){jt(this,t),this.pools=[]}return zt(t,[{key:"allocate",value:function(){if(!this.pools.length)return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e=this.pools.pop();return t.identity(e),e}},{key:"allocateByObj",value:function(t){var e;e=this.pools.length?this.pools.pop():[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];for(var i=0;i<e.length;i++)e[i]=t[i];return e}},{key:"free",value:function(t){t&&this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}],[{key:"identity",value:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}}]),t}(),cg=new lg,hg=new ug,dg=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},fg=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},pg=function(t,e){return function(i,n){e(i,n,t)}};function vg(t,e,i){var n,r,o,a,s,l,u,c,h,d,f,p,v=i[0],y=i[1],g=i[2];return e===t?(t[12]=e[0]*v+e[4]*y+e[8]*g+e[12],t[13]=e[1]*v+e[5]*y+e[9]*g+e[13],t[14]=e[2]*v+e[6]*y+e[10]*g+e[14],t[15]=e[3]*v+e[7]*y+e[11]*g+e[15]):(n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=n*v+s*y+h*g+e[12],t[13]=r*v+l*y+d*g+e[13],t[14]=o*v+u*y+f*g+e[14],t[15]=a*v+c*y+p*g+e[15]),t}function yg(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function gg(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],v=e[12],y=e[13],g=e[14],m=e[15],_=i[0],b=i[1],x=i[2],k=i[3];return t[0]=_*n+b*s+x*h+k*v,t[1]=_*r+b*l+x*d+k*y,t[2]=_*o+b*u+x*f+k*g,t[3]=_*a+b*c+x*p+k*m,_=i[4],b=i[5],x=i[6],k=i[7],t[4]=_*n+b*s+x*h+k*v,t[5]=_*r+b*l+x*d+k*y,t[6]=_*o+b*u+x*f+k*g,t[7]=_*a+b*c+x*p+k*m,_=i[8],b=i[9],x=i[10],k=i[11],t[8]=_*n+b*s+x*h+k*v,t[9]=_*r+b*l+x*d+k*y,t[10]=_*o+b*u+x*f+k*g,t[11]=_*a+b*c+x*p+k*m,_=i[12],b=i[13],x=i[14],k=i[15],t[12]=_*n+b*s+x*h+k*v,t[13]=_*r+b*l+x*d+k*y,t[14]=_*o+b*u+x*f+k*g,t[15]=_*a+b*c+x*p+k*m,t}function mg(t,e,i){var n,r=e.attribute,o=r.x,a=void 0===o?i.x:o,s=r.y,l=void 0===s?i.y:s,u=r.z,c=void 0===u?i.z:u,h=r.dx,d=void 0===h?i.dx:h,f=r.dy,p=void 0===f?i.dy:f,v=r.dz,y=void 0===v?i.dz:v,g=r.scaleX,m=void 0===g?i.scaleX:g,_=r.scaleY,b=void 0===_?i.scaleY:_,x=r.scaleZ,k=void 0===x?i.scaleZ:x,S=r.alpha,A=void 0===S?i.alpha:S,w=r.beta,T=void 0===w?i.beta:w,M=r.angle,C=void 0===M?i.angle:M,E=r.anchor3d,R=void 0===E?e.attribute.anchor:E,P=r.anchor,B=[0,0,0];if(R){if("string"==typeof R[0]){var L=parseFloat(R[0])/100,O=e.AABBBounds;B[0]=O.x1+(O.x2-O.x1)*L}else B[0]=R[0];if("string"==typeof R[1]){var I=parseFloat(R[1])/100,D=e.AABBBounds;B[1]=D.x1+(D.x2-D.x1)*I}else B[1]=R[1];B[2]=null!==(n=R[2])&&void 0!==n?n:0}if(function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t),vg(t,t,[a+d,l+p,c+y]),vg(t,t,[B[0],B[1],B[2]]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*n,t[5]=a*r+c*n,t[6]=s*r+h*n,t[7]=l*r+d*n,t[8]=u*r-o*n,t[9]=c*r-a*n,t[10]=h*r-s*n,t[11]=d*r-l*n}(t,t,T),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*n,t[1]=a*r-c*n,t[2]=s*r-h*n,t[3]=l*r-d*n,t[8]=o*n+u*r,t[9]=a*n+c*r,t[10]=s*n+h*r,t[11]=l*n+d*r}(t,t,A),vg(t,t,[-B[0],-B[1],B[2]]),function(t,e,i){var n=i[0],r=i[1],o=i[2];t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[m,b,k]),C){var F=hg.allocate(),z=[0,0];if(P){if("string"==typeof R[0]){var j=parseFloat(R[0])/100,H=e.AABBBounds;z[0]=H.x1+(H.x2-H.x1)*j}else z[0]=R[0];if("string"==typeof R[1]){var N=parseFloat(R[1])/100,V=e.AABBBounds;z[1]=V.x1+(V.x2-V.x1)*N}else z[1]=R[1]}vg(F,F,[z[0],z[1],0]),function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*n,t[1]=a*r+c*n,t[2]=s*r+h*n,t[3]=l*r+d*n,t[4]=u*r-o*n,t[5]=c*r-a*n,t[6]=h*r-s*n,t[7]=d*r-l*n}(F,F,C),vg(F,F,[-z[0],-z[1],0]),gg(t,t,F)}}var _g=function(){function t(e){jt(this,t),this.creator=e,this.hooks={onAttributeUpdate:new vs(["graphic"]),onSetStage:new vs(["graphic","stage"]),onRemove:new vs(["graphic"]),onRelease:new vs(["graphic"]),onAddIncremental:new vs(["graphic","group","stage"]),onClearIncremental:new vs(["graphic","group","stage"]),beforeUpdateAABBBounds:new vs(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new vs(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"])},this.tempAABBBounds1=new ye,this.tempAABBBounds2=new ye,this._rectBoundsContribitions=[new og],this._symbolBoundsContribitions=[new sg],this._circleBoundsContribitions=[new og],this._arcBoundsContribitions=[new og],this._pathBoundsContribitions=[new og]}return zt(t,[{key:"onAttributeUpdate",value:function(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}},{key:"onSetStage",value:function(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}},{key:"onRemove",value:function(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}},{key:"onRelease",value:function(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}},{key:"onAddIncremental",value:function(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}},{key:"onClearIncremental",value:function(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}},{key:"beforeUpdateAABBBounds",value:function(t,e,i,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,n)}},{key:"afterUpdateAABBBounds",value:function(t,e,i,n,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,n,r)}},{key:"updatePathProxyAABBBounds",value:function(t,e){var i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;var n=new zs(t);return Ks(i.commandList,n,0,0),!0}},{key:"updateRectAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;if(!this.updatePathProxyAABBBounds(i,n)){var r=t.width,o=t.height,a=t.x1,s=t.y1,l=t.x,u=t.y;r=null!=r?r:a-l,o=null!=o?o:s-u,i.set(0,0,r||0,o||0)}var c=this.tempAABBBounds1,h=this.tempAABBBounds2;return c.setValue(i.x1,i.y1,i.x2,i.y2),h.setValue(i.x1,i.y1,i.x2,i.y2),this._rectBoundsContribitions.length&&this._rectBoundsContribitions.forEach((function(r){r.updateBounds(t,e,c,n),i.union(c),c.setValue(h.x1,h.y1,h.x2,h.y2)})),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"updateGroupAABBBounds",value:function(t,e,i,n){var r=t.width,o=t.height,a=t.path,s=t.clip,l=void 0===s?e.clip:s;a&&a.length?a.forEach((function(t){i.union(t.AABBBounds)})):null!=r&&null!=o&&i.set(0,0,r,o),l||n.forEachChildren((function(t){i.union(t.AABBBounds)}));var u=this.tempAABBBounds1,c=this.tempAABBBounds2;return u.setValue(i.x1,i.y1,i.x2,i.y2),c.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"updateGlyphAABBBounds",value:function(t,e,i,n){return this._validCheck(t,e,i,n)?(n.getSubGraphic().forEach((function(t){i.union(t.AABBBounds)})),i):i}},{key:"updateRichTextAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;if(!n)return i;var r=t.width,o=void 0===r?e.width:r,a=t.height,s=void 0===a?e.height:a,l=t.maxWidth,u=void 0===l?e.maxWidth:l,c=t.maxHeight,h=void 0===c?e.maxHeight:c,d=t.textAlign,f=void 0===d?e.textAlign:d,p=t.textBaseline,v=void 0===p?e.textBaseline:p;if(o>0&&s>0)i.set(0,0,o,s);else{var y=n.getFrameCache().getActualSize(),g=y.width,m=y.height,_=o||g||0,b=s||m||0;b="number"==typeof h&&b>h?h:b||0,_="number"==typeof u&&_>u?u:_||0,i.set(0,0,_,b)}var x=0;switch(v){case"top":x=0;break;case"middle":x=-i.height()/2;break;case"bottom":x=-i.height()}var k=0;switch(f){case"left":k=0;break;case"center":k=-i.width()/2;break;case"right":k=-i.width()}i.translate(k,x);var S=this.tempAABBBounds1,A=this.tempAABBBounds2;return S.setValue(i.x1,i.y1,i.x2,i.y2),A.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"updateTextAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;if(!n)return i;var r=n.attribute.text,o=void 0===r?e.text:r;Array.isArray(o)?n.updateMultilineAABBBounds(o):n.updateSingallineAABBBounds(o);var a=this.tempAABBBounds1,s=this.tempAABBBounds2;a.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2);var l=t.scaleX,u=void 0===l?e.scaleX:l,c=t.scaleY,h=void 0===c?e.scaleY:c,d=t.shadowBlur,f=void 0===d?e.shadowBlur:d,p=t.strokeBoundsBuffer,v=void 0===p?e.strokeBoundsBuffer:p;f&&(Rd(a,f/Math.abs(u+h),!0,v),i.union(a));return this.combindShadowAABBBounds(i,n),pe(i,i,n.transMatrix),i}},{key:"updatePathAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||this.updatePathAABBBoundsImprecise(t,e,i,n);var r=this.tempAABBBounds1,o=this.tempAABBBounds2;r.setValue(i.x1,i.y1,i.x2,i.y2),o.setValue(i.x1,i.y1,i.x2,i.y2),this._pathBoundsContribitions.length&&this._pathBoundsContribitions.forEach((function(a){a.updateBounds(t,e,r,n),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2)}));var a=t.lineJoin,s=void 0===a?e.lineJoin:a;return this.transformAABBBounds(t,i,e,"miter"===s,n),i}},{key:"updatePathAABBBoundsImprecise",value:function(t,e,i,n){if(!n)return i;var r=n.getParsedPathShape();return i.union(r.getBounds()),i}},{key:"updatePyramid3dAABBBounds",value:function(t,e,i,n){if(!n)return i;var r=n.stage;if(!r||!r.camera)return i;n.findFace().vertices.forEach((function(t){var e=t[0],n=t[1];i.add(e,n)}));var o=this.tempAABBBounds1,a=this.tempAABBBounds2;return o.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"updateArc3dAABBBounds",value:function(t,e,i,n){if(!n)return i;var r=n.stage;if(!r||!r.camera)return i;var o=t.outerRadius,a=void 0===o?e.outerRadius:o,s=t.height,l=a+(void 0===s?0:s);i.setValue(-l,-l,l,l);var u=this.tempAABBBounds1,c=this.tempAABBBounds2;return u.setValue(i.x1,i.y1,i.x2,i.y2),c.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"updatePolygonAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||this.updatePolygonAABBBoundsImprecise(t,e,i,n);var r=this.tempAABBBounds1,o=this.tempAABBBounds2;r.setValue(i.x1,i.y1,i.x2,i.y2),o.setValue(i.x1,i.y1,i.x2,i.y2);var a=t.lineJoin,s=void 0===a?e.lineJoin:a;return this.transformAABBBounds(t,i,e,"miter"===s,n),i}},{key:"updatePolygonAABBBoundsImprecise",value:function(t,e,i,n){var r=t.points;return(void 0===r?e.points:r).forEach((function(t){i.add(t.x,t.y)})),i}},{key:"updateLineAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i,n):this.updateLineAABBBoundsByPoints(t,e,i,n));var r=this.tempAABBBounds1,o=this.tempAABBBounds2;r.setValue(i.x1,i.y1,i.x2,i.y2),o.setValue(i.x1,i.y1,i.x2,i.y2);var a=t.lineJoin,s=void 0===a?e.lineJoin:a;return this.transformAABBBounds(t,i,e,"miter"===s,n),i}},{key:"updateLineAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,o=void 0===r?e.points:r,a=i;return o.forEach((function(t){a.add(t.x,t.y)})),a}},{key:"updateLineAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,o=void 0===r?e.segments:r,a=i;return o.forEach((function(t){t.points.forEach((function(t){a.add(t.x,t.y)}))})),a}},{key:"updateAreaAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i,n):this.updateAreaAABBBoundsByPoints(t,e,i,n));var r=this.tempAABBBounds1,o=this.tempAABBBounds2;r.setValue(i.x1,i.y1,i.x2,i.y2),o.setValue(i.x1,i.y1,i.x2,i.y2);var a=t.lineJoin,s=void 0===a?e.lineJoin:a;return this.transformAABBBounds(t,i,e,"miter"===s,n),i}},{key:"updateAreaAABBBoundsByPoints",value:function(t,e,i,n){var r=t.points,o=void 0===r?e.points:r,a=i;return o.forEach((function(t){var e,i;a.add(t.x,t.y),a.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)})),a}},{key:"updateAreaAABBBoundsBySegments",value:function(t,e,i,n){var r=t.segments,o=void 0===r?e.segments:r,a=i;return o.forEach((function(t){t.points.forEach((function(t){var e,i;a.add(t.x,t.y),a.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(i=t.y1)&&void 0!==i?i:t.y)}))})),a}},{key:"updateCircleAABBBounds",value:function(t,e,i,n,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||(n?this.updateCircleAABBBoundsImprecise(t,e,i,r):this.updateCircleAABBBoundsAccurate(t,e,i,r));var o=this.tempAABBBounds1,a=this.tempAABBBounds2;return o.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._circleBoundsContribitions.length&&this._circleBoundsContribitions.forEach((function(n){n.updateBounds(t,e,o,r),i.union(o),o.setValue(a.x1,a.y1,a.x2,a.y2)})),this.transformAABBBounds(t,i,e,!1,r),i}},{key:"updateCircleAABBBoundsImprecise",value:function(t,e,i,n){var r=t.radius,o=void 0===r?e.radius:r;return i.set(-o,-o,o,o),i}},{key:"updateCircleAABBBoundsAccurate",value:function(t,e,i,n){var r=t.startAngle,o=void 0===r?e.startAngle:r,a=t.endAngle,s=void 0===a?e.endAngle:a,l=t.radius,u=void 0===l?e.radius:l;return s-o>Wt-Ht?i.set(-u,-u,u,u):sh(o,s,u,i),i}},{key:"updateArcAABBBounds",value:function(t,e,i,n,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||(n?this.updateArcAABBBoundsImprecise(t,e,i,r):this.updateArcAABBBoundsAccurate(t,e,i,r));var o=this.tempAABBBounds1,a=this.tempAABBBounds2;o.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._arcBoundsContribitions.length&&this._arcBoundsContribitions.forEach((function(n){n.updateBounds(t,e,o,r),i.union(o),o.setValue(a.x1,a.y1,a.x2,a.y2)}));var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return this.transformAABBBounds(t,i,e,"miter"===l,r),i}},{key:"updateArcAABBBoundsImprecise",value:function(t,e,i,n){var r=t.innerRadius,o=void 0===r?e.innerRadius:r,a=t.outerRadius,s=void 0===a?e.outerRadius:a;return s<o&&(s=o),i.set(-s,-s,s,s),i}},{key:"updateArcAABBBoundsAccurate",value:function(t,e,i,n){var r=t.outerRadius,o=void 0===r?e.outerRadius:r,a=t.innerRadius,s=void 0===a?e.innerRadius:a;if(o<s){var l=o;o=s,s=l}var u=t.endAngle,c=void 0===u?e.endAngle:u,h=t.startAngle,d=void 0===h?e.startAngle:h;if(d>c){var f=d;d=c,c=f}return o<=Ht?i.set(0,0,0,0):Math.abs(c-d)>Wt-Ht?i.set(-o,-o,o,o):(sh(d,c,o,i),sh(d,c,s,i)),i}},{key:"updateSymbolAABBBounds",value:function(t,e,i,n,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||(n?this.updateSymbolAABBBoundsImprecise(t,e,i,r):this.updateSymbolAABBBoundsAccurate(t,e,i,r));var o=this.tempAABBBounds1,a=this.tempAABBBounds2;o.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._symbolBoundsContribitions.length&&this._symbolBoundsContribitions.forEach((function(n){n.updateBounds(t,e,o,r),i.union(o),o.setValue(a.x1,a.y1,a.x2,a.y2)}));var s=t.lineJoin,l=void 0===s?e.lineJoin:s;return this.transformAABBBounds(t,i,e,"miter"===l,r),i}},{key:"updateSymbolAABBBoundsImprecise",value:function(t,e,i,n){var r=t.size,o=void 0===r?e.size:r;if(B(o))i.set(-o[0]/2,-o[1]/2,o[0]/2,o[1]/2);else{var a=o/2;i.set(-a,-a,a,a)}return i}},{key:"updateSymbolAABBBoundsAccurate",value:function(t,e,i,n){if(!n)return i;var r=t.size,o=void 0===r?e.size:r;return n.getParsedPath().bounds(o,i),i}},{key:"updateImageAABBBounds",value:function(t,e,i,n){if(!this._validCheck(t,e,i,n))return i;if(!this.updatePathProxyAABBBounds(i,n)){var r=t.width,o=void 0===r?e.width:r,a=t.height,s=void 0===a?e.height:a;i.set(0,0,o,s)}var l=this.tempAABBBounds1,u=this.tempAABBBounds2;return l.setValue(i.x1,i.y1,i.x2,i.y2),u.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,n),i}},{key:"combindShadowAABBBounds",value:function(t,e){if(e&&e.shadowRoot){var i=e.shadowRoot.AABBBounds;t.union(i)}}},{key:"transformAABBBounds",value:function(t,e,i,n,r){var o=t.scaleX,a=void 0===o?i.scaleX:o,s=t.scaleY,l=void 0===s?i.scaleY:s,u=t.stroke,c=void 0===u?i.stroke:u,h=t.shadowBlur,d=void 0===h?i.shadowBlur:h,f=t.lineWidth,p=void 0===f?i.lineWidth:f,v=t.pickStrokeBuffer,y=void 0===v?i.pickStrokeBuffer:v,g=t.strokeBoundsBuffer,m=void 0===g?i.strokeBoundsBuffer:g,_=this.tempAABBBounds1,b=this.tempAABBBounds2;c&&p&&(Rd(_,(p+y)/Math.abs(a+l),n,m),e.union(_),_.setValue(b.x1,b.y1,b.x2,b.y2));if(d){var x=t.shadowOffsetX,k=void 0===x?i.shadowOffsetX:x,S=t.shadowOffsetY,A=void 0===S?i.shadowOffsetY:S;Rd(_,d/Math.abs(a+l)*2,!1,m+1),_.translate(k,A),e.union(_)}this.combindShadowAABBBounds(e,r);var w=!0,T=r.transMatrix;r&&r.isContainer&&(w=!(1===T.a&&0===T.b&&0===T.c&&1===T.d&&0===T.e&&0===T.f)),w&&pe(e,e,T)}},{key:"_validCheck",value:function(t,e,i,n){if(!n)return!0;if(!n.valid)return i.clear(),!1;var r=t.visible;return!!(void 0===r?e.visible:r)||(i.clear(),!1)}}]),t}();_g=dg([Ya(),pg(0,Wa(nf)),fg("design:paramtypes",[Object])],_g);var bg,xg,kg=new(function(){function t(){jt(this,t),this.store=new Map}return zt(t,[{key:"RegisterGraphicCreator",value:function(t,e){this.store.set(t,e),this[t]=e}},{key:"CreateGraphic",value:function(t,e){var i=this.store.get(t);return i?i(e):null}}]),t}());function Sg(t){return bg||(bg=kg.CreateGraphic("text",{})),bg.initAttributes(t),bg.AABBBounds}var Ag={x:0,y:0,z:0,lastModelMatrix:null},wg=function(){function t(){jt(this,t)}return zt(t,[{key:"init",value:function(t){var e=this;t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions&&this.builtinContributions.forEach((function(t){return e._renderContribitions.push(t)})),this._renderContribitions.length&&(this._renderContribitions.sort((function(t,e){return e.order-t.order})),this._beforeRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Ds.beforeFillStroke})),this._afterRenderContribitions=this._renderContribitions.filter((function(t){return t.time===Ds.afterFillStroke})))}},{key:"beforeRenderStep",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach((function(f){f.drawShape(t,e,i,n,r,o,a,s,l,u,c,h,d)}))}},{key:"afterRenderStep",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){this._afterRenderContribitions&&this._afterRenderContribitions.forEach((function(f){f.drawShape(t,e,i,n,r,o,a,s,l,u,c,h,d)}))}},{key:"valid",value:function(t,e,i,n){var r=t.attribute,o=r.fill,a=void 0===o?e.fill:o,s=r.background,l=r.stroke,u=void 0===l?e.stroke:l,c=r.opacity,h=void 0===c?e.opacity:c,d=r.fillOpacity,f=void 0===d?e.fillOpacity:d,p=r.lineWidth,v=void 0===p?e.lineWidth:p,y=r.strokeOpacity,g=void 0===y?e.strokeOpacity:y,m=r.visible,_=void 0===m?e.visible:m,b=Af(h,f,a),x=Tf(h,g),k=kf(a,s),S=Sf(u,v);return!(!t.valid||!_)&&!(!k&&!S)&&!!(b||x||i||n||s)&&{fVisible:b,sVisible:x,doFill:k,doStroke:S}}},{key:"transform",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.attribute,o=r.x,a=void 0===o?e.x:o,s=r.y,l=void 0===s?e.y:s,u=r.z,c=void 0===u?e.z:u,h=r.scaleX,d=void 0===h?e.scaleX:h,f=r.scaleY,p=void 0===f?e.scaleY:f,v=r.angle,y=void 0===v?e.angle:v,g=r.postMatrix,m=i.modelMatrix,_=i.camera;Ag.x=a,Ag.y=l,Ag.z=c,Ag.lastModelMatrix=m;var b=_&&(n||function(t){var e=t.attribute,i=e.alpha,n=e.beta;return i||n}(t)),x=b?t.transMatrix.onlyTranslate()&&!g:1===d&&1===p&&0===y&&!g;if(b){var k=hg.allocate(),S=hg.allocate();mg(S,t,e),gg(k,m||k,S),Ag.x=0,Ag.y=0,Ag.z=0,i.modelMatrix=k,i.setTransform(1,0,0,1,0,0,!0),hg.free(S)}if(x&&!m){var A=t.getOffsetXY(e);Ag.x+=A.x,Ag.y+=A.y,Ag.z=c,i.setTransformForCurrent()}else if(b)Ag.x=0,Ag.y=0,Ag.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(_&&i.project){var w=t.getOffsetXY(e);Ag.x+=w.x,Ag.y+=w.y,this.transformWithoutTranslate(i,Ag.x,Ag.y,Ag.z,d,p,y)}else i.transformFromMatrix(t.transMatrix,!0),Ag.x=0,Ag.y=0,Ag.z=0;return Ag}},{key:"transformUseContext2d",value:function(t,e,i,n){var r=n.camera;if(this.camera=r,r){var o=t.AABBBounds,a=o.x2-o.x1,s=o.y2-o.y1,l=n.project(0,0,i),u=n.project(a,0,i),c=n.project(a,s,i),h={x:0,y:0},d={x:a,y:0},f={x:a,y:s};n.camera=null;var p=1/(h.x*(f.y-d.y)-d.x*f.y+f.x*d.y+(d.x-f.x)*h.y),v=-(h.y*(c.x-u.x)-d.y*c.x+f.y*u.x+(d.y-f.y)*l.x)*p,y=(d.y*c.y+h.y*(u.y-c.y)-f.y*u.y+(f.y-d.y)*l.y)*p,g=(h.x*(c.x-u.x)-d.x*c.x+f.x*u.x+(d.x-f.x)*l.x)*p,m=-(d.x*c.y+h.x*(u.y-c.y)-f.x*u.y+(f.x-d.x)*l.y)*p,_=(h.x*(f.y*u.x-d.y*c.x)+h.y*(d.x*c.x-f.x*u.x)+(f.x*d.y-d.x*f.y)*l.x)*p,b=(h.x*(f.y*u.y-d.y*c.y)+h.y*(d.x*c.y-f.x*u.y)+(f.x*d.y-d.x*f.y)*l.y)*p;n.setTransform(v,y,g,m,_,b,!0)}}},{key:"restoreTransformUseContext2d",value:function(t,e,i,n){this.camera&&(n.camera=this.camera)}},{key:"transformWithoutTranslate",value:function(t,e,i,n,r,o,a){var s=t.project(e,i,n);t.translate(s.x,s.y,!1),t.scale(r,o,!1),t.rotate(a,!1),t.translate(-s.x,-s.y,!1),t.setTransformForCurrent()}},{key:"_draw",value:function(t,e,i,n,r){var o=n.context;if(o){o.highPerformanceSave();var a=this.transform(t,e,o,i),s=a.x,l=a.y,u=a.z,c=a.lastModelMatrix;this.z=u,function(t,e,i,n,r,o,a,s){if(!t.pathProxy)return!1;var l=gc(t,null==o?void 0:o.theme)[t.type],u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,f=void 0===d?l.stroke:d,p=u.opacity,v=void 0===p?l.opacity:p,y=u.fillOpacity,g=void 0===y?l.fillOpacity:y,m=u.lineWidth,_=void 0===m?l.lineWidth:m,b=u.strokeOpacity,x=void 0===b?l.strokeOpacity:b,k=u.visible,S=void 0===k?l.visible:k,A=Af(v,g,h),w=Tf(v,x),T=kf(h),M=Sf(f,_);return!S||!T&&!M||!(A||w||a||s)||(e.beginPath(),Ks(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,n),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),M&&(s?s(e,t.attribute,l):w&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),T&&(a?a(e,t.attribute,l):A&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fill())),!0)}(t,o,s,l,0,r)||(this.drawShape(t,o,s,l,n,r),this.z=0,o.modelMatrix!==c&&hg.free(o.modelMatrix),o.modelMatrix=c),o.highPerformanceRestore()}}}]),t}(),Tg=function(){var t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function i(t){var i=new Error(e+": "+t);throw i.source=e,i}function n(){return r("linear",t.linearGradient,o)||r("radial",t.radialGradient,s)||r("conic",t.conicGradient,a)}function r(e,n,r){return function(n,o){var a,s=g(n);if(s){g(t.startCall)||i("Missing (");var l=((a=r())&&(g(t.comma)||i("Missing comma before color stops")),{type:e,orientation:a,colorStops:d(f)});return g(t.endCall)||i("Missing )"),l}}(n)}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1)}function a(){return y("angular",t.fromAngleValue,1)}function s(){var i,n,r=l();return r&&((i=[]).push(r),n=e,g(t.comma)&&((r=l())?i.push(r):e=n)),i}function l(){var t,e=function(){var t=y("shape",/^(circle)/i,0);return t&&(t.style=v()||u()),t}()||((t=y("shape",/^(ellipse)/i,0))&&(t.style=p()||u()),t);if(e)e.at=c();else{var i=u();if(i){e=i;var n=c();n&&(e.at=n)}else{var r=h();r&&(e={type:"default-radial",at:r})}}return e}function u(){return y("extent-keyword",t.extentKeywords,1)}function c(){if(y("position",/^at/,0)){var t=h();return t||i("Missing positioning value"),t}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t}}function d(e){var n=e(),r=[];if(n)for(r.push(n);g(t.comma);)(n=e())?r.push(n):i("One extra comma");return r}function f(){var e=y("hex",t.hexColor,1)||y("rgba",t.rgbaColor,1)||y("rgb",t.rgbColor,1)||y("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=p(),e}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||v()}function v(){return y("px",t.pixelValue,1)||y("em",t.emValue,1)}function y(t,e,i){var n=g(e);if(n)return{type:t,value:n[i]}}function g(t){var i=/^[\n\r\t\s]+/.exec(e);i&&m(i[0].length);var n=t.exec(e);return n&&m(n[0].length),n}function m(t){e=e.substr(t)}return function(t){return e=t.toString(),r=d(n),e.length>0&&i("Invalid input not EOF"),r;var r}}(),Mg=function(){function t(){jt(this,t)}return zt(t,null,[{key:"IsGradient",value:function(t){return!("string"==typeof t&&t.length<10)}},{key:"IsGradientStr",value:function(t){return"string"==typeof t&&t.length>10}},{key:"Parse",value:function(e){if(t.IsGradientStr(e))try{var i=Tg(e)[0];if(i){if("linear"===i.type)return t.ParseLinear(i);if("radial"===i.type)return t.ParseRadial(i);if("conic"===i.type)return t.ParseConic(i)}}catch(t){return e}return e}},{key:"ParseConic",value:function(t){var e=t.orientation,i=t.colorStops,n=void 0===i?[]:i,r=Nt/2,o=parseFloat(e.value)/180*Nt-r;return{gradient:"conical",x:.5,y:.5,startAngle:o,endAngle:o+Wt,stops:n.map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}},{key:"ParseRadial",value:function(t){var e=t.colorStops;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:(void 0===e?[]:e).map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}},{key:"ParseLinear",value:function(t){for(var e=t.orientation,i=t.colorStops,n=void 0===i?[]:i,r=Nt/2,o="angular"===e.type?parseFloat(e.value)/180*Nt:0;o<0;)o+=Wt;for(;o>Wt;)o-=Wt;var a=0,s=0,l=0,u=0;return o<r?(a=0,s=1,l=Math.sin(o),u=Math.cos(o)):o<Nt?(a=0,s=0,l=Math.cos(o-r),u=Math.sin(o-r)):o<Nt+r?(s=0,l=(a=1)-Math.sin(o-Nt),u=Math.cos(o-Nt)):(l=(a=1)-Math.cos(o-r-Nt),u-=Math.sin(o-r-Nt)),{gradient:"linear",x0:a,y0:s,x1:l,y1:u,stops:n.map((function(t){return{color:t.value,offset:parseFloat(t.length.value)/100}}))}}}]),t}();function Cg(t,e,i){var n=e,r=t.currentMatrix,o=r.a,a=r.b,s=r.c,l=r.d,u=Math.sign(o)*Math.sqrt(o*o+a*a),c=Math.sign(l)*Math.sqrt(s*s+l*l);return u+c===0?0:n=n/Math.abs(u+c)*2*i}function Eg(t,e,i,n,r){if(!e||!0===e)return"black";var o,a;if(B(e))for(var s=0;s<e.length&&!(a=e[s]);s++);else a=e;return"string"==typeof(a=Mg.Parse(a))?a:("linear"===a.gradient?o=function(t,e,i){var n,r,o,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=i.AABBBounds;if(!u)return;var c=u.x2-u.x1,h=u.y2-u.y1,d=u.x1-s,f=u.y1-l;if(i.attribute){var p=i.attribute,v=p.scaleX,y=void 0===v?1:v,g=p.scaleY,m=void 0===g?1:g;if(y*m==0)return;c/=y,h/=m,d/=y,f/=m}var _=t.createLinearGradient(d+(null!==(n=e.x0)&&void 0!==n?n:0)*c,f+(null!==(r=e.y0)&&void 0!==r?r:0)*h,d+(null!==(o=e.x1)&&void 0!==o?o:1)*c,f+(null!==(a=e.y1)&&void 0!==a?a:0)*h);return e.stops.forEach((function(t){_.addColorStop(t.offset,t.color)})),_}(t,a,i,n,r):"conical"===a.gradient?o=function(t,e,i){var n,r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=i.AABBBounds;if(!s)return;var l=s.x2-s.x1,u=s.y2-s.y1,c=s.x1-o,h=s.y1-a;if(i.attribute){var d=i.attribute,f=d.scaleX,p=void 0===f?1:f,v=d.scaleY,y=void 0===v?1:v;if(p*y==0)return;l/=p,u/=y,c/=p,h/=y}var g=t.createConicGradient(c+(null!==(n=e.x)&&void 0!==n?n:0)*l,h+(null!==(r=e.y)&&void 0!==r?r:0)*u,e.startAngle,e.endAngle);return e.stops.forEach((function(t){g.addColorStop(t.offset,t.color)})),g.GetPattern(l+c,u+h,void 0)}(t,a,i,n,r):"radial"===a.gradient&&(o=function(t,e,i){var n,r,o,a,s,l,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=i.AABBBounds;if(!h)return;var d=h.x2-h.x1,f=h.y2-h.y1,p=h.x1-u,v=h.y1-c;if(i.attribute){var y=i.attribute,g=y.scaleX,m=void 0===g?1:g,_=y.scaleY,b=void 0===_?1:_;if(m*b==0)return;p/=m,v/=b,d/=m,f/=b}var x=t.createRadialGradient(p+(null!==(n=e.x0)&&void 0!==n?n:.5)*d,v+(null!==(r=e.y0)&&void 0!==r?r:.5)*f,Math.max(d,f)*(null!==(o=e.r0)&&void 0!==o?o:0),p+(null!==(a=e.x1)&&void 0!==a?a:.5)*d,v+(null!==(s=e.y1)&&void 0!==s?s:.5)*f,Math.max(d,f)*(null!==(l=e.r1)&&void 0!==l?l:.5));return e.stops.forEach((function(t){x.addColorStop(t.offset,t.color)})),x}(t,a,i,n,r)),o||"orange")}var Rg=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Pg=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Bg=function(t,e){return function(i,n){e(i,n,t)}},Lg=function(){function t(){jt(this,t),this.time=Ds.beforeFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f=t.attribute,p=f.background,v=f.backgroundMode,y=void 0===v?l.backgroundMode:v,g=f.backgroundFit,m=void 0===g?l.backgroundFit:g;if(p)if(t.backgroundImg&&t.resources){var _=t.resources.get(p);if("success"!==_.state||!_.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){var b=gc(t.parent).group,x=t.parent.attribute,k=x.scrollX,S=void 0===k?b.scrollX:k,A=x.scrollY,w=void 0===A?b.scrollY:A;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(S,w)}e.clip();var T=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,n,l),this.doDrawImage(e,_.data,T,y,m),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=p,e.fill(),e.highPerformanceRestore()}},{key:"doDrawImage",value:function(t,e,i,n,r){if("no-repeat"===n)t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{var o=i.width(),a=i.height(),s=o,l=a;if(r&&"repeat"!==n&&(e.width||e.height)){var u=e.width,c=e.height;"repeat-x"===n?(s=u*(a/c),l=a):"repeat-y"===n&&(l=c*(o/u),s=o);var h=t.dpr,d=Qu.allocate({width:s,height:l,dpr:h}),f=d.getContext("2d");f&&(f.inuse=!0,f.clearMatrix(),f.setTransformForCurrent(!0),f.clearRect(0,0,s,l),f.drawImage(e,0,0,s,l),e=d.nativeCanvas),Qu.free(d)}var p=t.dpr,v=t.createPattern(e,n);v.setTransform&&v.setTransform(new DOMMatrix([1/p,0,0,1/p,0,0])),t.fillStyle=v,t.translate(i.x1,i.y1),t.fillRect(0,0,o,a),t.translate(-i.x1,-i.y1)}}}]),t}(),Og=new Lg,Ig=function(){function t(e){jt(this,t),this.subRenderContribitions=e,this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach((function(f){f.render(t,e,i,n,r,o,a,s,l,u,c,h,d)}))}}]),t}();Ig=Rg([Ya(),Bg(0,Wa(cs)),Bg(0,Ka(Uf)),Pg("design:paramtypes",[Object])],Ig);var Dg=function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=10}return zt(t,[{key:"createCommonPattern",value:function(t,e,i,n,r){var o=(t-2*e)/2,a=n.dpr,s=Qu.allocate({width:t,height:t,dpr:a}),l=s.getContext("2d");if(!l)return null;l.inuse=!0,l.clearMatrix(),l.setTransformForCurrent(!0),l.clearRect(0,0,t,t),r(o,l);var u=n.createPattern(s.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),Qu.free(s),u}},{key:"createCirclePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,e){e.fillStyle=i,e.arc(t,t,t,0,Wt),e.fill()}))}},{key:"createDiamondPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){var r=t/2,o=r;n.fillStyle=i,n.moveTo(r,o-e),n.lineTo(e+r,o),n.lineTo(r,o+e),n.lineTo(r-e,o),n.closePath(),n.fill()}))}},{key:"createRectPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,o=r;n.fillStyle=i,n.fillRect(r,o,2*t,2*t)}))}},{key:"createVerticalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var o=e;r.fillStyle=i,r.fillRect(o,0,2*n,t)}))}},{key:"createHorizontalLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(n,r){var o=e;r.fillStyle=i,r.fillRect(0,o,t,2*n)}))}},{key:"createBiasLRLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(0,0),n.lineTo(t,t);var r=t/2,o=-r;n.moveTo(r,o),n.lineTo(r+t,o+t),n.moveTo(-r,-o),n.lineTo(-r+t,-o+t),n.stroke()}))}},{key:"createBiasRLLinePattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(e,n){n.strokeStyle=i,n.lineWidth=e,n.moveTo(t,0),n.lineTo(0,t);var r=t/2,o=r;n.moveTo(t+r,o),n.lineTo(r,o+t),n.moveTo(t-r,-o),n.lineTo(-r,-o+t),n.stroke()}))}},{key:"createGridPattern",value:function(t,e,i,n){return this.createCommonPattern(t,e,i,n,(function(t,n){var r=e,o=r;n.fillStyle=i,n.fillRect(r,o,t,t),n.fillRect(r+t,o+t,t,t)}))}},{key:"initTextureMap",value:function(t,e){this.textureMap=new Map}},{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){this.textureMap||this.initTextureMap(e,t.stage);var f=t.attribute,p=f.texture,v=void 0===p?l.texture:p,y=f.textureColor,g=void 0===y?l.textureColor:y,m=f.textureSize,_=void 0===m?l.textureSize:m,b=f.texturePadding,x=void 0===b?l.texturePadding:b;v&&this.drawTexture(v,t,e,i,n,l,g,_,x)}},{key:"drawTexture",value:function(t,e,i,n,r,o,a,s,l){var u=this.textureMap.get(t);if(!u)switch(t){case"circle":u=this.createCirclePattern(s,l,a,i);break;case"diamond":u=this.createDiamondPattern(s,l,a,i);break;case"rect":u=this.createRectPattern(s,l,a,i);break;case"vertical-line":u=this.createVerticalLinePattern(s,l,a,i);break;case"horizontal-line":u=this.createHorizontalLinePattern(s,l,a,i);break;case"bias-lr":u=this.createBiasLRLinePattern(s,l,a,i);break;case"bias-rl":u=this.createBiasRLLinePattern(s,l,a,i);break;case"grid":u=this.createGridPattern(s,l,a,i)}u&&(i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,r,o),i.fillStyle=u,i.fill(),i.highPerformanceRestore())}}]),t}(),Fg=new Dg,zg=function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.outerBorder,p=d.innerBorder,v=f&&!1!==f.visible,y=p&&!1!==p.visible;if(v||y){var g=t.attribute,m=g.innerRadius,_=void 0===m?l.innerRadius:m,b=g.outerRadius,x=void 0===b?l.outerRadius:b,k=g.startAngle,S=void 0===k?l.startAngle:k,A=g.endAngle,w=void 0===A?l.endAngle:A,T=g.opacity,M=void 0===T?l.opacity:T,C=g.x,E=void 0===C?l.x:C,R=g.y,P=void 0===R?l.y:R,B=g.scaleX,L=void 0===B?l.scaleX:B,O=g.scaleY,I=void 0===O?l.scaleY:O,D=!(!f||!f.stroke),F=!(!p||!p.stroke);if(v){var z=f.distance,j=void 0===z?l.outerBorder.distance:z,H=Cg(e,j,e.dpr),N=j/x;if(t.setAttributes({outerRadius:x+H,innerRadius:_-H,startAngle:S-N,endAngle:w+N}),e.beginPath(),Rf(t,e,i,n,x+H,_-H),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,f,l.outerBorder);else if(D){var V=l.outerBorder.opacity;l.outerBorder.opacity=M,e.setStrokeStyle(t,f,(E-i)/L,(P-n)/I,l.outerBorder),l.outerBorder.opacity=V,e.stroke()}}if(y){var G=p.distance,W=void 0===G?l.innerBorder.distance:G,U=Cg(e,W,e.dpr),Y=W/x;if(t.setAttributes({outerRadius:x-U,innerRadius:_+U,startAngle:S+Y,endAngle:w-Y}),e.beginPath(),Rf(t,e,i,n,x-U,_+U),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,p,l.innerBorder);else if(F){var K=l.innerBorder.opacity;l.innerBorder.opacity=M,e.setStrokeStyle(t,p,(E-i)/L,(P-n)/I,l.innerBorder),l.innerBorder.opacity=K,e.stroke()}}t.setAttributes({outerRadius:x,innerRadius:_,startAngle:S,endAngle:w})}}}]),t}(),jg=new zg,Hg=Fg,Ng=Og,Vg=function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.outerBorder,p=d.innerBorder,v=f&&!1!==f.visible,y=p&&!1!==p.visible;if(v||y){var g=t.attribute,m=g.radius,_=void 0===m?l.radius:m,b=g.startAngle,x=void 0===b?l.startAngle:b,k=g.endAngle,S=void 0===k?l.endAngle:k,A=g.opacity,w=void 0===A?l.opacity:A,T=g.x,M=void 0===T?l.x:T,C=g.y,E=void 0===C?l.y:C,R=g.scaleX,P=void 0===R?l.scaleX:R,B=g.scaleY,L=void 0===B?l.scaleY:B,O=!(!f||!f.stroke),I=!(!p||!p.stroke);if(v){var D=f.distance,F=Cg(e,void 0===D?l.outerBorder.distance:D,e.dpr);if(e.beginPath(),e.arc(i,n,_+F,x,S),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,f,l.outerBorder);else if(O){var z=l.outerBorder.opacity;l.outerBorder.opacity=w,e.setStrokeStyle(t,f,(M-i)/P,(E-n)/L,l.outerBorder),l.outerBorder.opacity=z,e.stroke()}}if(y){var j=p.distance,H=Cg(e,void 0===j?l.innerBorder.distance:j,e.dpr);if(e.beginPath(),e.arc(i,n,_-H,x,S),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,p,l.innerBorder);else if(I){var N=l.innerBorder.opacity;l.innerBorder.opacity=w,e.setStrokeStyle(t,p,(M-i)/P,(E-n)/L,l.innerBorder),l.innerBorder.opacity=N,e.stroke()}}}}}]),t}(),Gg=new Vg,Wg=Fg,Ug=Og;function Yg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Kg=function(t){ue(i,t);var e=Yg(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).time=Ds.beforeFillStroke,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.background,p=d.backgroundMode,v=void 0===p?l.backgroundMode:p,y=d.backgroundFit,g=void 0===y?l.backgroundFit:y;if(f)if(t.backgroundImg&&t.resources){var m=t.resources.get(f);if("success"!==m.state||!m.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);var _=t.AABBBounds;this.doDrawImage(e,m.data,_,v,g),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=f,e.fill(),e.highPerformanceRestore()}}]),i}(Lg),Xg=new Kg,Zg=Nt/2;function qg(t,e,i,n,r,o){var a;if(n<0&&(e+=n,n=-n),r<0&&(i+=r,r=-r),I(o,!0))a=[o=Ut(o),o,o,o];else if(Array.isArray(o)){var s,l,u=o;switch(u.length){case 0:a=[0,0,0,0];break;case 1:a=[s=Ut(u[0]),s,s,s];break;case 2:case 3:a=[s=Ut(u[0]),l=Ut(u[1]),s,l];break;default:(a=u)[0]=Ut(a[0]),a[1]=Ut(a[1]),a[2]=Ut(a[2]),a[3]=Ut(a[3])}}else a=[0,0,0,0];if(n<0||a[0]+a[1]+a[2]+a[3]<1e-12)return t.rect(e,i,n,r);var c=[e,i],h=[e+n,i],d=[e+n,i+r],f=[e,i+r],p=Math.min(n/2,r/2),v=[Math.min(p,a[0]),Math.min(p,a[1]),Math.min(p,a[2]),Math.min(p,a[3])],y=[c[0]+v[0],c[1]],g=[c[0],c[1]+v[0]],m=[h[0]-v[1],h[1]],_=[h[0],h[1]+v[1]],b=[d[0]-v[2],d[1]],x=[d[0],d[1]-v[2]],k=[f[0]+v[3],f[1]],S=[f[0],f[1]-v[3]];if(t.moveTo(y[0],y[1]),t.lineTo(m[0],m[1]),!dt(m,_)){var A=m[0],w=m[1]+v[1];t.arc(A,w,v[1],-Zg,0,!1)}if(t.lineTo(x[0],x[1]),!dt(b,x)){var T=x[0]-v[2],M=x[1];t.arc(T,M,v[2],0,Zg,!1)}if(t.lineTo(k[0],k[1]),!dt(k,S)){var C=k[0],E=k[1]-v[3];t.arc(C,E,v[3],Zg,Nt,!1)}if(t.lineTo(g[0],g[1]),!dt(y,g)){var R=y[0],P=y[1]+v[0];t.arc(R,P,v[0],Nt,Nt+Zg,!1)}return t.closePath(),t}function Jg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Qg=function(t){ue(i,t);var e=Jg(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).time=Ds.beforeFillStroke,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.background,p=d.backgroundMode,v=void 0===p?l.backgroundMode:p,y=d.backgroundFit,g=void 0===y?l.backgroundFit:y;if(f)if(t.backgroundImg){var m=t.resources.get(f);if("success"!==m.state||!m.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){var _=gc(t.parent).group,b=t.parent.attribute,x=b.scrollX,k=void 0===x?_.scrollX:x,S=b.scrollY,A=void 0===S?_.scrollY:S;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(k,A)}var w=t.AABBBounds;this.doDrawImage(e,m.data,w,v,g),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else if(M(f)){var T=f.stroke,C=f.fill,E=f.lineWidth,R=void 0===E?1:E,P=f.cornerRadius,B=void 0===P?0:P,L=f.expandX,O=void 0===L?0:L,D=f.expandY,F=void 0===D?0:D;if(!T&&!C)return;e.beginPath();var z=function(t){var e=rh(t.attribute.boundsPadding),i=t.AABBBounds,n=i.x1,r=i.y1,o=i.width(),a=i.height();return I(e)?(n+=e,r+=e,o-=2*e,a-=2*e):(n+=e[3],r+=e[0],o-=e[1]+e[3],a-=e[0]+e[2]),{x:n,y:r,width:o,height:a}}(t),j=z.x,H=z.y,N=z.width,V=z.height;B?qg(e,j-O,H-F,N+2*O,V+2*F,B):e.rect(j-O,H-F,N+2*O,V+2*F),e.globalAlpha=1,C&&(e.fillStyle=C,e.fill()),T&&R>0&&(e.lineWidth=R,e.strokeStyle=T,e.stroke())}else{e.beginPath();var G=t.AABBBounds;e.rect(i,n,G.width(),G.height()),e.fillStyle=f,e.globalAlpha=1,e.fill()}}}]),i}(Lg);var $g=new Qg,tm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},em=function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.outerBorder,p=d.innerBorder,v=f&&!1!==f.visible,y=p&&!1!==p.visible;if(v||y){var g=t.attribute,m=g.cornerRadius,_=void 0===m?l.cornerRadius:m,b=g.opacity,x=void 0===b?l.opacity:b,k=g.x,S=void 0===k?l.x:k,A=g.y,w=void 0===A?l.y:A,T=g.scaleX,M=void 0===T?l.scaleX:T,C=g.scaleY,E=void 0===C?l.scaleY:C,R=g.x1,P=g.y1,L=t.attribute,O=L.width,I=L.height;O=(null!=O?O:R-i)||0,I=(null!=I?I:P-n)||0;var D=!(!f||!f.stroke),F=!(!p||!p.stroke);if(v){var z=f.distance,j=Cg(e,void 0===z?l.outerBorder.distance:z,e.dpr),H=i-j,N=n-j,V=2*j;if(0===_||B(_)&&_.every((function(t){return 0===t}))?(e.beginPath(),e.rect(H,N,O+V,I+V)):(e.beginPath(),qg(e,H,N,O+V,I+V,_)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,f,l.outerBorder);else if(D){var G=l.outerBorder.opacity;l.outerBorder.opacity=x,e.setStrokeStyle(t,f,(S-i)/M,(w-n)/E,l.outerBorder),l.outerBorder.opacity=G,e.stroke()}}if(y){var W=p.distance,U=Cg(e,void 0===W?l.innerBorder.distance:W,e.dpr),Y=i+U,K=n+U,X=2*U;if(0===_||B(_)&&_.every((function(t){return 0===t}))?(e.beginPath(),e.rect(Y,K,O-X,I-X)):(e.beginPath(),qg(e,Y,K,O-X,I-X,_)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,p,l.innerBorder);else if(F){var Z=l.innerBorder.opacity;l.innerBorder.opacity=x,e.setStrokeStyle(t,p,(S-i)/M,(w-n)/E,l.innerBorder),l.innerBorder.opacity=Z,e.stroke()}}}}}]),t}(),im=function(){function t(){jt(this,t),this.time=Ds.beforeFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f=t.attribute.stroke,p=void 0===f?l.stroke:f;Array.isArray(p)&&p.some((function(t){return!1===t}))&&(d.doStroke=!1)}}]),t}();im=tm([Ya()],im);var nm=function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.attribute,f=d.width,p=void 0===f?l.width:f,v=d.height,y=void 0===v?l.height:v,g=d.stroke,m=void 0===g?l.stroke:g;if(Array.isArray(m)&&m.some((function(t){return!1===t}))){if(e.setStrokeStyle(t,t.attribute,i,n,l),e.beginPath(),e.moveTo(i,n),m[0]?e.lineTo(i+p,n):e.moveTo(i+p,n),m[1]?e.lineTo(i+p,n+y):e.moveTo(i+p,n+y),m[2]?e.lineTo(i,n+y):e.moveTo(i,n+y),m[3]){var _=m[0]?n-e.lineWidth/2:n;e.lineTo(i,_)}else e.moveTo(i,n);e.stroke()}}}]),t}();nm=tm([Ya()],nm);var rm=new em,om=Fg,am=Og,sm=new(function(){function t(){jt(this,t),this.time=Ds.afterFillStroke,this.useStyle=!0,this.order=0}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=t.getParsedPath();if(d){var f=t.attribute,p=f.outerBorder,v=f.innerBorder,y=p&&!1!==p.visible,g=v&&!1!==v.visible;if(y||g){var m=t.attribute,_=m.size,b=void 0===_?l.size:_,x=m.opacity,k=void 0===x?l.opacity:x,S=m.x,A=void 0===S?l.x:S,w=m.y,T=void 0===w?l.y:w,M=m.scaleX,C=void 0===M?l.scaleX:M,E=m.scaleY,R=void 0===E?l.scaleY:E,P=!(!p||!p.stroke),B=!(!v||!v.stroke);if(y){var L=p.distance,O=Cg(e,void 0===L?l.outerBorder.distance:L,e.dpr);if(e.beginPath(),!1===d.drawOffset(e,b,i,n,O)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,p,l.outerBorder);else if(P){var I=l.outerBorder.opacity;l.outerBorder.opacity=k,e.setStrokeStyle(t,p,(A-i)/C,(T-n)/R,l.outerBorder),l.outerBorder.opacity=I,e.stroke()}}if(g){var D=v.distance,F=Cg(e,void 0===D?l.innerBorder.distance:D,e.dpr);if(e.beginPath(),!1===d.drawOffset(e,b,i,n,-F)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),h)h(e,v,l.innerBorder);else if(B){var z=l.innerBorder.opacity;l.innerBorder.opacity=k,e.setStrokeStyle(t,v,(A-i)/C,(T-n)/R,l.innerBorder),l.innerBorder.opacity=z,e.stroke()}}}}}}]),t}()),lm=Fg,um=Og;function cm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var hm=function(t){ue(i,t);var e=cm(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).time=Ds.afterFillStroke,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f,p,v,y;this.textureMap||this.initTextureMap(e,t.stage);var g=(d||{}).attribute,m=void 0===g?t.attribute:g,_=m.texture,b=void 0===_?null!==(f=t.attribute.texture)&&void 0!==f?f:hh(l,"texture"):_,x=m.textureColor,k=void 0===x?null!==(p=t.attribute.textureColor)&&void 0!==p?p:hh(l,"textureColor"):x,S=m.textureSize,A=void 0===S?null!==(v=t.attribute.textureSize)&&void 0!==v?v:hh(l,"textureSize"):S,w=m.texturePadding,T=void 0===w?null!==(y=t.attribute.texturePadding)&&void 0!==y?y:hh(l,"texturePadding"):w;b&&this.drawTexture(b,t,e,i,n,l,k,A,T)}}]),i}(Dg);function dm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var fm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},pm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vm=function(t,e){return function(i,n){e(i,n,t)}},ym=function(t){ue(i,t);var e=dm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).arcRenderContribitions=t,n.numberType=jd,n.builtinContributions=[jg,Ng,Hg],n.init(t),n}return zt(i,[{key:"drawArcTailCapPath",value:function(t,e,i,n,r,o,a,s){var l=s-a,u=t.getParsedAngle(),c=u.startAngle,h=u.endAngle,d=Ut((h=s)-c),f=h>c,p=!1;if(r<o){var v=r;r=o,o=v}var y=t.getParsedCornerRadius(),g=t.getParsePadAngle(c,h);g.outerDeltaAngle;var m,_,b,x,k=g.innerDeltaAngle,S=g.outerStartAngle,A=g.outerEndAngle,w=g.innerEndAngle,T=g.innerStartAngle,M=y,C=y,E=y,R=y,P=Math.max(C,M),B=Math.max(E,R),L=P,O=B,I=r*Kt(S),D=r*qt(S),F=o*Kt(w),z=o*qt(w);if((B>Ht||P>Ht)&&(m=r*Kt(A),_=r*qt(A),b=o*Kt(T),x=o*qt(T),d<Nt)){var j=Cf(I,D,b,x,m,_,F,z);if(j){var H=I-j[0],N=D-j[1],V=m-j[0],G=_-j[1],W=1/qt($t((H*V+N*G)/(Jt(H*H+N*N)*Jt(V*V+G*G)))/2),U=Jt(j[0]*j[0]+j[1]*j[1]);O=Zt(B,(o-U)/(W-1)),L=Zt(P,(r-U)/(W+1))}}if(L>Ht){var Y=Zt(M,L),K=Zt(C,L),X=Ef(b,x,I,D,r,Y,Number(f)),Z=Ef(m,_,F,z,r,K,Number(f));if(L<P&&Y===K)e.moveTo(i+X.cx+X.x01,n+X.cy+X.y01),e.arc(i+X.cx,n+X.cy,L,Yt(X.y01,X.x01),Yt(Z.y01,Z.x01),!f);else{var q=h-l-.03,J=Yt(Z.y11,Z.x11);e.arc(i,n,r,q,J,!f),K>0&&e.arc(i+Z.cx,n+Z.cy,K,Yt(Z.y11,Z.x11),Yt(Z.y01,Z.x01),!f)}}else e.moveTo(i+I,n+D);if(!(o>Ht)||k<.001)e.lineTo(i+F,n+z),p=!0;else if(O>Ht){var Q=Zt(R,O),$=Zt(E,O),tt=Ef(F,z,m,_,o,-$,Number(f)),et=Ef(I,D,b,x,o,-Q,Number(f));if(e.lineTo(i+tt.cx+tt.x01,n+tt.cy+tt.y01),O<B&&Q===$){var it=Yt(et.y01,et.x01);e.arc(i+tt.cx,n+tt.cy,O,Yt(tt.y01,tt.x01),it,!f)}else{$>0&&e.arc(i+tt.cx,n+tt.cy,$,Yt(tt.y01,tt.x01),Yt(tt.y11,tt.x11),!f);var nt=Yt(tt.cy+tt.y11,tt.cx+tt.x11),rt=h-l-.03;e.arc(i,n,o,nt,rt,f)}}else e.lineTo(i+o*Kt(T),n+o*qt(T));return p}},{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l=gc(t,null==o?void 0:o.theme).arc,u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.stroke,f=void 0===d?l.stroke:d,p=u.x,v=void 0===p?l.x:p,y=u.y,g=void 0===y?l.y:y,m=this.valid(t,l,a,s);if(m){var _=m.fVisible,b=m.sVisible,x=m.doFill,k=m.doStroke,A=t.attribute,w=A.outerRadius,T=void 0===w?l.outerRadius:w,M=A.innerRadius,C=void 0===M?l.innerRadius:M,E=A.cap,R=void 0===E?l.cap:E,P=A.forceShowCap,B=void 0===P?l.forceShowCap:P,L=0,O=(S(R)&&R||R[0])&&"conical"===h.gradient;if(O){var I=t.getParsedAngle(),D=I.sc,F=I.startAngle,z=I.endAngle;Ut(z-F)<Wt-Ht&&(L=D||0,h.startAngle-=L,h.endAngle-=L)}var j=!1,H=function(t){var e,i=!0;if(S(t,!0)){for(var n=0;n<4;n++)ih[n]=t,i&&(i=!(null!==(e=ih[n])&&void 0!==e&&!e));i=t}else if(Array.isArray(t))for(var r=0;r<4;r++)ih[r]=!!t[r],i&&(i=!!ih[r]);else ih[0]=!1,ih[1]=!1,ih[2]=!1,ih[3]=!1;return{isFullStroke:i,stroke:ih}}(f),N=H.isFullStroke,V=H.stroke;if((x||N)&&(e.beginPath(),Rf(t,e,i,n,T,C),j=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,x,k,_,b,l,r,a,s),x&&(a?a(e,t.attribute,l):_&&(e.setCommonStyle(t,t.attribute,v-i,g-n,l),e.fill())),k&&N&&(s?s(e,t.attribute,l):b&&(e.setStrokeStyle(t,t.attribute,v-i,g-n,l),e.stroke()))),!N&&k&&(e.beginPath(),Rf(t,e,i,n,T,C,V),j||this.beforeRenderStep(t,e,i,n,x,k,_,b,l,r,a,s),s?s(e,t.attribute,l):b&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),(S(R)&&R||R[1])&&B){var G=t.getParsedAngle(),W=G.startAngle,U=G.endAngle;if(Ut(U-W)>=Wt-Ht){e.beginPath();var Y=Math.abs(T-C)/2/T,K=t.attribute,X=K.endAngle,Z=void 0===X?l.endAngle:X,q=K.fill,J=void 0===q?l.fill:q,Q=Z;if(this.drawArcTailCapPath(t,e,i,n,T,C,Q,Q+Y),j||this.beforeRenderStep(t,e,i,n,x,k,_,b,l,r,a,s),x){var $=J;if("conical"===$.gradient){var tt=function(t,e,i,n){for(var r=n.stops,o=n.startAngle,a=n.endAngle;i<0;)i+=Wt;for(;i>Wt;)i-=Wt;if(i<o)return r[0].color;if(i>a)return r[0].color;for(var s,l,u=(i-o)/(a-o),c=0;c<r.length;c++)if(r[c].offset>=u){s=r[c-1],l=r[c];break}return u=(u-s.offset)/(l.offset-s.offset),Wh(s.color,l.color,u,!1)}(0,0,Z,$);a||Af&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=tt,e.fill())}}k&&(s||b&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke()))}}this.afterRenderStep(t,e,i,n,x,k,_,b,l,r,a,s),O&&(h.startAngle+=L,h.endAngle+=L)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n)}}]),i}(wg);function gm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}ym=fm([Ya(),vm(0,Wa(cs)),vm(0,Ka(If)),pm("design:paramtypes",[Object])],ym);var mm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},_m=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bm=function(t,e){return function(i,n){e(i,n,t)}},xm=function(t){ue(i,t);var e=gm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).circleRenderContribitions=t,n.numberType=Vd,n.builtinContributions=[Gg,Ug,Wg],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l=gc(t,null==o?void 0:o.theme).circle,u=t.attribute,c=u.radius,h=void 0===c?l.radius:c,d=u.startAngle,f=void 0===d?l.startAngle:d,p=u.endAngle,v=void 0===p?l.endAngle:p,y=u.x,g=void 0===y?l.x:y,m=u.y,_=void 0===m?l.y:m,b=this.valid(t,l,a,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke;e.beginPath(),e.arc(i,n,h,f,v),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,a,s),S&&(a?a(e,t.attribute,l):x&&(e.setCommonStyle(t,t.attribute,g-i,_-n,l),e.fill())),A&&(s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,g-i,_-n,l),e.stroke())),this.afterRenderStep(t,e,i,n,S,A,x,k,l,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).circle;this._draw(t,r,!1,i,n)}}]),i}(wg);function km(t,e,i,n){if(e.p1){var r=n||{},o=r.offsetX,a=void 0===o?0:o,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u;if(1===i)e.p2&&e.p3?t.bezierCurveTo(a+e.p1.x,l+e.p1.y,a+e.p2.x,l+e.p2.y,a+e.p3.x,l+e.p3.y,c):t.lineTo(a+e.p1.x,l+e.p1.y,c);else if(e.p2&&e.p3){var h=Mt(tl(e,i),1)[0];t.bezierCurveTo(a+h.p1.x,l+h.p1.y,a+h.p2.x,l+h.p2.y,a+h.p3.x,l+h.p3.y,c)}else{var d=e.getPointAt(i);t.lineTo(a+d.x,l+d.y,c)}}}function Sm(t,e,i,n,r){var o,a=r||{},s=a.offsetX,l=void 0===s?0:s,u=a.offsetY,c=void 0===u?0:u,h=a.offsetZ,d=void 0===h?0:h,f=a.mode,p=void 0===f?"none":f,v=a.drawConnect,y=void 0!==v&&v;if(a.zeroX,a.zeroY,(!y||"none"!==p)&&e){var g=!0,m=e.curves;if(i>=1)if(y){var _,b=!0;m.forEach((function(e,i){var n,r=e.p0;if(e.originP1!==e.originP2){if(_&&_.originP1===_.originP2&&(r=_.p0),e.defined)b||(t.lineTo(r.x+l,r.y+c,d),b=!b);else{var o,a=e.originP1,s=e.originP2;if(a&&!1!==a.defined?o=r:a&&!1!==s.defined&&(o=null!==(n=e.p3)&&void 0!==n?n:e.p1),b){b=!b;var u=o?o.x:e.p0.x,h=o?o.y:e.p0.y;t.moveTo(u+l,h+c,d)}else o&&(b=!b,t.lineTo(o.x+l,o.y+c,d))}_=e}else _=e}))}else m.forEach((function(e){e.defined?(g&&t.moveTo(e.p0.x+l,e.p0.y+c,d),km(t,e,1,r),g=!1):g=!0}));else if(!(i<=0)){var x;"x"===n?x=Os.ROW:"y"===n?x=Os.COLUMN:"auto"===n&&(x=e.direction);for(var k=i*e.tryUpdateLength(x),S=0,A=!0,w=null,T=0,M=m.length;T<M;T++){var C=m[T],E=C.getLength(x),R=(k-S)/E;if(S+=E,R<0)break;if(y){var P=C.p0;if(C.originP1===C.originP2){w=C;continue}if(w&&w.originP1===w.originP2&&(P=w.p0),C.defined)A||(t.lineTo(P.x+l,P.y+c,d),A=!A);else{var B=C.originP1,L=C.originP2,O=void 0;if(B&&!1!==B.defined?O=P:B&&!1!==L.defined&&(O=null!==(o=C.p3)&&void 0!==o?o:C.p1),A){A=!A;var I=O?O.x:C.p0.x,D=O?O.y:C.p0.y;t.moveTo(I+l,D+c,d)}else O&&(A=!A,t.lineTo(O.x+l,O.y+c,d))}w=C}else{if(!C.defined){g=!0;continue}g&&t.moveTo(C.p0.x+l,C.p0.y+c,d),km(t,C,Zt(R,1),r),g=!1}}}}}function Am(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}xm=mm([Ya(),bm(0,Wa(cs)),bm(0,Ka(Ff)),_m("design:paramtypes",[Object])],xm);var wm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Tm=function(t){ue(i,t);var e=Am(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).numberType=Yd,t}return zt(i,[{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).line;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d,f,p){var v,y,g,m,_;if(e){t.beginPath();var b=null!==(v=this.z)&&void 0!==v?v:0;Sm(t.camera?t:t.nativeContext,e,l,u,{offsetX:c,offsetY:h,offsetZ:b}),d.cache&&!B(d.cache)&&d.cache.curves.every((function(t){return t.defined}))&&d.attribute.curveType&&d.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,a,s);var x=a.x,k=void 0===x?0:x,S=a.x,A=void 0===S?0:S;!1!==i&&(f?f(t,a,s):r&&(t.setCommonStyle(d,a,k-c,A-h,s),t.fill())),!1!==n&&(p?p(t,a,s):o&&(t.setStrokeStyle(d,a,k-c,A-h,s),t.stroke()));var w=a.connectedType,T=a.connectedX,M=a.connectedY,C=a.connectedStyle;if(B(s)?(w=null!==(y=null!=w?w:s[0].connectedType)&&void 0!==y?y:s[1].connectedType,T=null!==(g=null!=T?T:s[0].connectedX)&&void 0!==g?g:s[1].connectedX,M=null!==(m=null!=M?M:s[0].connectedY)&&void 0!==m?m:s[1].connectedY,C=null!==(_=null!=C?C:s[0].connectedStyle)&&void 0!==_?_:s[1].connectedStyle):(w=null!=w?w:s.connectedType,T=null!=T?T:s.connectedX,M=null!=M?M:s.connectedY,C=null!=C?C:s.connectedStyle),"connect"!==w&&"zero"!==w&&(w="none"),"none"!==w){t.beginPath(),Sm(t.camera?t:t.nativeContext,e,l,u,{offsetX:c,offsetY:h,offsetZ:b,drawConnect:!0,mode:w,zeroX:T,zeroY:M});var E=[];B(s)?s.forEach((function(t){return E.push(t)})):E.push(s),E.push(a),!1!==i&&(f?f(t,a,s):r&&(t.setCommonStyle(d,C,k-c,A-h,E),t.fill())),!1!==n&&(p?p(t,a,s):o&&(t.setStrokeStyle(d,C,k-c,A-h,E),t.stroke()))}return!1}}},{key:"drawLinearLineHighPerformance",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f;e.beginPath();var p=null!==(f=this.z)&&void 0!==f?f:0,v=t.attribute.points,y=v[0];e.moveTo(y.x+a,y.y+s,p);for(var g=1;g<v.length;g++){var m=v[g];e.lineTo(m.x+a,m.y+s,p)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);var _=t.attribute,b=_.x,x=void 0===b?0:b,k=_.x,S=void 0===k?0:k;!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,x-a,S-s,l),e.fill())),!1!==n&&(d?d(e,t.attribute,l):o&&(e.setStrokeStyle(t,t.attribute,x-a,S-s,l),e.stroke()))}},{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l=this,u=gc(t,null==o?void 0:o.theme).line,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,f=c.stroke,p=void 0===f?u.stroke:f,v=c.fillOpacity,y=void 0===v?u.fillOpacity:v,g=c.strokeOpacity,m=void 0===g?u.strokeOpacity:g,_=c.segments,b=c.points,x=c.closePath;if(this.valid(t,u,a,s)){var k=t.attribute.curveType,S=void 0===k?u.curveType:k;x&&"linear"===S&&(S="linearClosed");var A=t.attribute,w=A.clipRange,T=void 0===w?u.clipRange:w,M=A.clipRangeByDimension,C=void 0===M?u.clipRangeByDimension:M;if(1===T&&!_&&!b.some((function(t){return!1===t.defined}))&&"linear"===S)return this.drawLinearLineHighPerformance(t,e,!!d,!!p,y,m,i,n,u,r,o,a,s);if(t.shouldUpdateShape()){var E=t.attribute,R=E.points,P=E.segments,B=R;if(P&&P.length){var L,O;if(t.cache=P.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(O={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===e?L={x:O.endX,y:O.endY,defined:O.curves[O.curves.length-1].defined}:e>1&&(L.x=O.endX,L.y=O.endY,L.defined=O.curves[O.curves.length-1].defined);var i=El(t.points,S,{startPoint:L});return O=i,i})).filter((function(t){return!!t})),"linearClosed"===S){for(var I,D=0;D<t.cache.length;D++){for(var F=t.cache[D],z=0;z<F.curves.length;z++)if(F.curves[z].defined){I=F.curves[z].p0;break}if(I)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(I.x,I.y,!0)}}else{if(!R||!R.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=El(B,S)}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){var j=t.attribute.segments.filter((function(t){return t.points.length}));if(1===j[0].points.length&&j.shift(),1===T){var H=!1;t.cache.forEach((function(r,o){H||(H=l.drawSegmentItem(e,r,!!d,!!p,y,m,j[o],[u,t.attribute],T,C,i,n,t,a,s))}))}else{var N=t.cache.reduce((function(t,e){return t+e.getLength()}),0),V=T*N,G=0,W=!1;t.cache.forEach((function(r,o){if(!W){var c=r.getLength(),h=(V-G)/c;G+=c,h>0&&(W=l.drawSegmentItem(e,r,!!d,!!p,y,m,j[o],[u,t.attribute],Zt(h,1),C,i,n,t,a,s))}}))}}else this.drawSegmentItem(e,t.cache,!!d,!!p,y,m,t.attribute,u,T,C,i,n,t,a,s)}}}]),i}(wg);function Mm(t,e,i,n){if(!(e.length<2)){var r=n||{},o=r.offsetX,a=void 0===o?0:o,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u;r.mode;var h=e[0];t.moveTo(h.p0.x+a,h.p0.y+l,c);var d=(h=e[e.length-1]).p3||h.p1;t.lineTo(d.x+a,d.y+l,c),h=i[i.length-1],t.lineTo(h.p0.x+a,h.p0.y+l,c),d=(h=i[0]).p3||h.p1,t.lineTo(d.x+a,d.y+l,c),t.closePath()}}function Cm(t,e,i,n){var r=n||{},o=r.offsetX,a=void 0===o?0:o,s=r.offsetY,l=void 0===s?0:s,u=r.offsetZ,c=void 0===u?0:u,h=!0;e.forEach((function(e){e.defined?(h&&t.moveTo(e.p0.x+a,e.p0.y+l,c),km(t,e,1,n),h=!1):h=!0})),h=!0;for(var d=i.length-1;d>=0;d--){var f=i[d];f.defined?(h&&t.lineTo(f.p0.x+a,f.p0.y+l,c),km(t,f,1,n),h=!1):h=!0}t.closePath()}Tm=wm([Ya()],Tm);var Em=new hm,Rm=Og;function Pm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Bm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Lm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Om=function(t,e){return function(i,n){e(i,n,t)}};function Im(t,e,i){switch(e){case"linear":default:return hl(t,i);case"basis":return pl(t,i);case"monotoneX":return kl(t,i);case"monotoneY":return Sl(t,i);case"step":return wl(t,.5,i);case"stepBefore":return wl(t,0,i);case"stepAfter":return wl(t,1,i);case"linearClosed":return Cl(t,i)}}var Dm=function(t){ue(i,t);var e=Pm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).areaRenderContribitions=t,n.numberType=Nd,n.builtinContributions=[Em,Rm],n.init(t),n}return zt(i,[{key:"drawLinearAreaHighPerformance",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f,p,v,y,g;e.beginPath();var m=null!==(f=this.z)&&void 0!==f?f:0,_=t.attribute.points,b=_[0];e.moveTo(b.x+a,b.y+s,m);for(var x=1;x<_.length;x++){var k=_[x];e.lineTo(k.x+a,k.y+s,m)}for(var S=_.length-1;S>=0;S--){var A=_[S];e.lineTo((null!==(p=A.x1)&&void 0!==p?p:A.x)+a,(null!==(v=A.y1)&&void 0!==v?v:A.y)+s,m)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,a,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute});var w=t.attribute,T=w.x,M=void 0===T?0:T,C=w.x,E=void 0===C?0:C;if(!1!==i&&(h?h(e,t.attribute,l):r&&(e.setCommonStyle(t,t.attribute,M-a,E-s,l),e.fill())),this.afterRenderStep(t,e,a,s,!!r,!1,i,!1,l,u,h,null,{attribute:t.attribute}),n){var R=t.attribute.stroke,P=void 0===R?l&&l.stroke:R;if(B(P)&&(P[0]||P[2])&&!1===P[1])if(e.beginPath(),P[0]){e.moveTo(b.x+a,b.y+s,m);for(var L=1;L<_.length;L++){var O=_[L];e.lineTo(O.x+a,O.y+s,m)}}else if(P[2]){var I=_[_.length-1];e.moveTo(I.x+a,I.y+s,m);for(var D=_.length-2;D>=0;D--){var F=_[D];e.lineTo((null!==(y=F.x1)&&void 0!==y?y:F.x)+a,(null!==(g=F.y1)&&void 0!==g?g:F.y)+s,m)}}d?d(e,t.attribute,l):(e.setStrokeStyle(t,t.attribute,M-a,E-s,l),e.stroke())}}},{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u,c,h,d,f,p=this,v=gc(t,null==o?void 0:o.theme).area,y=t.attribute,g=y.fill,m=void 0===g?v.fill:g,_=y.stroke;void 0===_&&v.stroke;var b=y.fillOpacity,x=void 0===b?v.fillOpacity:b,k=y.z,S=void 0===k?v.z:k,A=y.strokeOpacity,w=void 0===A?v.strokeOpacity:A,T=this.valid(t,v,a,s);if(T){var M=T.doFill,C=T.doStroke,E=t.attribute,R=E.clipRange,P=void 0===R?v.clipRange:R,B=E.closePath,L=E.points,O=E.segments,I=t.attribute.curveType,D=void 0===I?v.curveType:I;if(B&&"linear"===D&&(D="linearClosed"),1===P&&!O&&!L.some((function(t){return!1===t.defined}))&&"linear"===D)return this.drawLinearAreaHighPerformance(t,e,!!m,C,x,w,i,n,v,r,o,a,s);if(t.shouldUpdateShape()){if(O&&O.length){for(var F,z,j,H=O.map((function(t,e){if(t.points.length<=1&&0===e)return t.points[0]&&(z={endX:t.points[0].x,endY:t.points[0].y}),null;1===e?F={x:z.endX,y:z.endY}:e>1&&(F.x=z.endX,F.y=z.endY);var i=Im(t.points,D,{startPoint:F});return z=i,i})).filter((function(t){return!!t})),N=[],V=O.length-1;V>=0;V--){for(var G=O[V].points,W=[],U=G.length-1;U>=0;U--)W.push({x:null!==(l=G[U].x1)&&void 0!==l?l:G[U].x,y:null!==(u=G[U].y1)&&void 0!==u?u:G[U].y});if(0!==V){var Y=O[V-1].points,K=Y[Y.length-1];K&&W.push({x:null!==(c=K.x1)&&void 0!==c?c:K.x,y:null!==(h=K.y1)&&void 0!==h?h:K.y})}W.length>1&&(j=Im(W,"stepBefore"===D?"stepAfter":"stepAfter"===D?"stepBefore":D),N.unshift(j))}t.cacheArea=N.map((function(t,e){return{top:H[e],bottom:t}}))}else{if(!L||!L.length)return t.cacheArea=null,void t.clearUpdateShapeTag();for(var X=L,Z=[],q=L.length-1;q>=0;q--)Z.push({x:null!==(d=L[q].x1)&&void 0!==d?d:L[q].x,y:null!==(f=L[q].y1)&&void 0!==f?f:L[q].y});var J=Im(X,D),Q=Im(Z,"stepBefore"===D?"stepAfter":"stepAfter"===D?"stepBefore":D);t.cacheArea={top:J,bottom:Q}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){var $=t.attribute.segments.filter((function(t){return t.points.length}));if(1===$[0].points.length&&$.shift(),1===P){var tt=!1;t.cacheArea.forEach((function(o,l){tt||(tt=p.drawSegmentItem(e,o,M,x,C,w,$[l],[v,t.attribute],P,i,n,S,t,r,a,s))}))}else{var et=t.cacheArea.reduce((function(t,e){return t+e.top.getLength()}),0),it=P*et,nt=0,rt=!1;t.cacheArea.forEach((function(o,l){if(!rt){var u=o.top.getLength(),c=(it-nt)/u;nt+=u,c>0&&(rt=p.drawSegmentItem(e,o,M,x,C,w,$[l],[v,t.attribute],Zt(c,1),i,n,S,t,r,a,s))}}))}}else this.drawSegmentItem(e,t.cacheArea,M,x,C,w,t.attribute,v,P,i,n,S,t,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).area;this._draw(t,r,!1,i,n)}},{key:"drawSegmentItem",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d,f,p,v){var y=!1;return y=(y=y||this._drawSegmentItem(t,e,i,n,r,o,a,s,l,u,c,h,d,f,!1,p,v))||this._drawSegmentItem(t,e,i,n,r,o,a,s,l,u,c,h,d,f,!0,p,v)}},{key:"_drawSegmentItem",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d,f,p,v,y){var g,m,_,b,x=a.connectedType,k=a.connectedX,S=a.connectedY,A=a.connectedStyle,w=[];if(p&&(B(s)?(x=null!==(g=null!=x?x:s[0].connectedType)&&void 0!==g?g:s[1].connectedType,k=null!==(m=null!=k?k:s[0].connectedX)&&void 0!==m?m:s[1].connectedX,S=null!==(_=null!=S?S:s[0].connectedY)&&void 0!==_?_:s[1].connectedY,A=null!==(b=null!=A?A:s[0].connectedStyle)&&void 0!==b?b:s[1].connectedStyle):(x=null!=x?x:s.connectedType,k=null!=k?k:s.connectedX,S=null!=S?S:s.connectedY,A=null!=A?A:s.connectedStyle),"connect"!==x&&"zero"!==x&&(x="none"),B(s)?s.forEach((function(t){return w.push(t)})):w.push(s),w.push(a)),p&&"none"===x)return!1;if(e){t.beginPath();var T,M,C=d.attribute,E=C.points,R=C.segments,P=Os.ROW;if(R){var L=R[R.length-1];M=R[0].points[0],T=L.points[L.points.length-1]}else M=E[0],T=E[E.length-1];P=Ut(T.x-M.x)>Ut(T.y-M.y)?Os.ROW:Os.COLUMN,function(t,e,i,n){var r,o=n||{},a=o.drawConnect,s=void 0!==a&&a,l=o.mode;if(!s||"none"!==(void 0===l?"none":l)){var u=e.top,c=e.bottom;if(u.curves.length===c.curves.length)if(i>=1){var h=[],d=[],f=!0;if(s){var p,v,y=!0,g=u.curves.length;u.curves.forEach((function(e,i){var r=c.curves[g-i-1],o=e,a=r;if(e.originP1===e.originP2)return p=e,void(v=r);if(p&&p.originP1===p.originP2&&(o=p,a=v),e.defined)y||(h.push(o),d.push(a),Mm(t,h,d,n),h.length=0,d.length=0,y=!y);else{var s,l,u=e.originP1,f=e.originP2;u&&!1!==u.defined?(s=o,l=a):u&&!1!==f.defined&&(s=e,l=r),y?(y=!y,h.push(s||e),d.push(l||r)):s&&(y=!y,h.push(s||e),d.push(l||r),Mm(t,h,d,n),h.length=0,d.length=0)}p=e})),Mm(t,h,d,n)}else{for(var m=0,_=u.curves.length;m<_;m++){var b=u.curves[m];f!==b.defined?(f?(Cm(t,h,d,n),h.length=0,d.length=0):(h.push(b),d.push(c.curves[_-m-1])),f=!f):f&&(h.push(b),d.push(c.curves[_-m-1]))}Cm(t,h,d,n)}}else if(!(i<=0)){var x=(n||{}).direction,k=u.curves,S=null!==(r=k[k.length-1].p3)&&void 0!==r?r:k[k.length-1].p1,A=Ut(S.x-k[0].p0.x),w=Ut(S.y-k[0].p0.y);x=null!=x?x:A>w?Os.ROW:Os.COLUMN,Number.isFinite(A)||(x=Os.COLUMN),Number.isFinite(w)||(x=Os.ROW);for(var T,M,C=i*(x===Os.ROW?A:w),E=0,R=!0,P=[],B=[],L=!0,O=0,I=u.curves.length;O<I;O++){var D=u.curves[O],F=D.getLength(x),z=(C-E)/F;if(z<0)break;if(E+=F,s){var j=c.curves[I-O-1],H=D,N=j;if(D.originP1===D.originP2){T=D,M=j;continue}if(T&&T.originP1===T.originP2&&(H=T,N=M),D.defined)L||(P.push(H),B.push(N),Mm(t,P,B,n),P.length=0,B.length=0,L=!L);else{var V=D.originP1,G=D.originP2,W=void 0,U=void 0;V&&!1!==V.defined?(W=H,U=N):V&&!1!==G.defined&&(W=D,U=j),L?(L=!L,P.push(W||D),B.push(U||j)):W&&(L=!L,P.push(W||D),B.push(U||j),Mm(t,P,B,n),P.length=0,B.length=0)}T=D}else{var Y=null,K=null;R!==D.defined?(R?(Cm(t,P,B,n),P.length=0,B.length=0):(Y=D,K=c.curves[I-O-1]),R=!R):R&&(Y=D,K=c.curves[I-O-1]),Y&&K&&(z<1&&(Y=Y.p2&&Y.p3?tl(Y,z)[0]:nl(Y,z)[0],K=K.p2&&K.p3?tl(K,1-z)[1]:nl(K,1-z)[1]),Y.defined=R,K.defined=R,P.push(Y),B.push(K)),Y=null,K=null}}s?Mm(t,P,B,n):Cm(t,P,B,n)}}}(t.camera?t:t.nativeContext,e,l,{offsetX:u,offsetY:c,offsetZ:h,direction:P,drawConnect:p,mode:x,zeroX:k,zeroY:S}),this.beforeRenderStep(d,t,u,c,!!n,!1,i,!1,s,f,v,null,{attribute:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(d,a,s);var O=a.x,I=void 0===O?0:O,D=a.x,F=void 0===D?0:D;if(!1!==i&&(v?v(t,a,s):n&&(t.setCommonStyle(d,p?A:a,I-u,F-c,p?w:s),t.fill())),this.afterRenderStep(d,t,u,c,!!n,!1,i,!1,s,f,v,null,{attribute:a}),!1!==r)if(y)y(t,a,s);else{var z=a.stroke,j=void 0===z?s&&s[1]&&s[1].stroke:z;B(j)&&(j[0]||j[2])&&!1===j[1]&&(t.beginPath(),Sm(t.camera?t:t.nativeContext,j[0]?e.top:e.bottom,l,P===Os.ROW?"x":"y",{offsetX:u,offsetY:c,offsetZ:h,drawConnect:p,mode:x,zeroX:k,zeroY:S})),t.setStrokeStyle(d,p?A:a,I-u,F-c,p?w:s),t.stroke()}return!1}}}]),i}(wg);Dm=Bm([Ya(),Om(0,Wa(cs)),Om(0,Ka(Df)),Lm("design:paramtypes",[Object])],Dm);var Fm=Fg,zm=Og;function jm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Hm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Nm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Vm=function(t,e){return function(i,n){e(i,n,t)}},Gm=function(t){ue(i,t);var e=jm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).pathRenderContribitions=t,n.numberType=Kd,n.builtinContributions=[zm,Fm],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u,c,h=null!==(l=this.tempTheme)&&void 0!==l?l:gc(t,null==o?void 0:o.theme).path,d=t.attribute,f=d.x,p=void 0===f?h.x:f,v=d.y,y=void 0===v?h.y:v,g=null!==(u=this.z)&&void 0!==u?u:0,m=this.valid(t,h,a,s);if(m){var _=m.fVisible,b=m.sVisible,x=m.doFill,k=m.doStroke;if(e.beginPath(),t.pathShape)Ks(t.pathShape.commandList,e,i,n,1,1,g);else Ks((null!==(c=t.attribute.path)&&void 0!==c?c:h.path).commandList,e,i,n,1,1,g);e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,n,x,k,_,b,h,r,a,s),k&&(s?s(e,t.attribute,h):b&&(e.setStrokeStyle(t,t.attribute,p-i,y-n,h),e.stroke())),x&&(a?a(e,t.attribute,h):_&&(e.setCommonStyle(t,t.attribute,p-i,y-n,h),e.fill())),this.afterRenderStep(t,e,i,n,x,k,_,b,h,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).path;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}]),i}(wg);function Wm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Gm=Hm([Ya(),Vm(0,Wa(cs)),Vm(0,Ka(Hf)),Nm("design:paramtypes",[Object])],Gm);var Um=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Ym=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Km=function(t,e){return function(i,n){e(i,n,t)}},Xm=function(t){ue(i,t);var e=Wm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).rectRenderContribitions=t,n.type="rect",n.numberType=qd,n.builtinContributions=[rm,am,om],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u=null!==(l=this.tempTheme)&&void 0!==l?l:gc(t,null==o?void 0:o.theme).rect,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,f=c.background,p=c.stroke,v=void 0===p?u.stroke:p,y=c.cornerRadius,g=void 0===y?u.cornerRadius:y,m=c.opacity,_=void 0===m?u.opacity:m,b=c.fillOpacity,x=void 0===b?u.fillOpacity:b,k=c.lineWidth,S=void 0===k?u.lineWidth:k,A=c.strokeOpacity,w=void 0===A?u.strokeOpacity:A,T=c.visible,M=void 0===T?u.visible:T,C=c.x1,E=c.y1,R=c.x,P=void 0===R?u.x:R,L=c.y,O=void 0===L?u.y:L,I=t.attribute,D=I.width,F=I.height,z=wf(_,x,D=(null!=D?D:C-P)||0,F=(null!=F?F:E-O)||0,d),j=Mf(_,w,D,F),H=kf(d,f),N=Sf(v,S);if(t.valid&&M&&(H||N)&&(z||j||a||s||f)){0===g||B(g)&&g.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,D,F)):(e.beginPath(),qg(e,i,n,D,F,g));var V={doFill:H,doStroke:N};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,n,H,N,z,j,u,r,a,s,V),V.doFill&&(a?a(e,t.attribute,u):z&&(e.setCommonStyle(t,t.attribute,P-i,O-n,u),e.fill())),V.doStroke&&(s?s(e,t.attribute,u):j&&(e.setStrokeStyle(t,t.attribute,P-i,O-n,u),e.stroke())),this.afterRenderStep(t,e,i,n,H,N,z,j,u,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).rect;this.tempTheme=r,this._draw(t,r,!1,i,n),this.tempTheme=null}}]),i}(wg);function Zm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Xm=Um([Ya(),Km(0,Wa(cs)),Km(0,Ka(Vf)),Ym("design:paramtypes",[Object])],Xm);var qm=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Jm=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qm=function(t,e){return function(i,n){e(i,n,t)}},$m=function(t){ue(i,t);var e=Zm(i);function i(t){var n;return jt(this,i),(n=e.call(this)).symbolRenderContribitions=t,n.numberType=$d,n.builtinContributions=[sm,um,lm],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u=gc(t,null==o?void 0:o.theme).symbol,c=t.attribute,h=c.size,d=void 0===h?u.size:h,f=c.x,p=void 0===f?u.x:f,v=c.y,y=void 0===v?u.y:v,g=c.scaleX,m=void 0===g?u.scaleX:g,_=c.scaleY,b=void 0===_?u.scaleY:_,x=this.valid(t,u,a,s);if(x){var k=x.fVisible,S=x.sVisible,A=x.doFill,w=x.doStroke,T=t.getParsedPath();if(T){var M=t.attribute.keepDirIn3d,C=void 0===M?u.keepDirIn3d:M,E=null!==(l=this.z)&&void 0!==l?l:0;if(e.beginPath(),C&&e.camera&&e.project){var R=e.project(i,n,E),P=e.camera;e.camera=null,!1===T.draw(e,B(d)?[d[0]*m,d[1]*b]:d*m,R.x,R.y,void 0,(function(r,o){var l,c,h;if(t._parsedPath.svgCache){var d=Object.assign({},o);d.fill=null!==(l=o.fill)&&void 0!==l?l:t.attribute.fill,d.opacity=null!==(c=o.fill)&&void 0!==c?c:t.attribute.opacity,d.fillOpacity=t.attribute.fillOpacity,d.stroke=null!==(h=o.stroke)&&void 0!==h?h:t.attribute.stroke,o=d}o.fill&&(a?a(e,t.attribute,u):(e.setCommonStyle(t,o,p-i,y-n,u),e.fill())),o.stroke&&(s?s(e,t.attribute,u):(e.setStrokeStyle(t,o,(p-i)/m,(y-n)/b,u),e.stroke()))}))&&e.closePath(),e.camera=P}else!1===T.draw(e,d,i,n,E,(function(r,o){var l,c,h;if(t._parsedPath.svgCache){var d=Object.assign({},o);d.fill=null!==(l=o.fill)&&void 0!==l?l:t.attribute.fill,d.opacity=null!==(c=o.opacity)&&void 0!==c?c:t.attribute.opacity,d.fillOpacity=t.attribute.fillOpacity,d.stroke=null!==(h=o.stroke)&&void 0!==h?h:t.attribute.stroke,o=d}o.fill&&(a?a(e,t.attribute,u):(e.setCommonStyle(t,o,p-i,y-n,u),e.fill())),o.stroke&&(s?s(e,t.attribute,u):(e.setStrokeStyle(t,o,(p-i)/m,(y-n)/b,u),e.stroke()))}))&&e.closePath();e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),this.beforeRenderStep(t,e,i,n,A,w,k,S,u,r,a,s),A&&!T.isSvg&&(a?a(e,t.attribute,u):k&&(e.setCommonStyle(t,t.attribute,p-i,y-n,u),e.fill())),w&&!T.isSvg&&(s?s(e,t.attribute,u):S&&(e.setStrokeStyle(t,t.attribute,(p-i)/m,(y-n)/b,u),e.stroke())),this.afterRenderStep(t,e,i,n,A,w,k,S,u,r,a,s)}}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).symbol;this._draw(t,r,!1,i,n)}}]),i}(wg);$m=qm([Ya(),Qm(0,Wa(cs)),Qm(0,Ka(Gf)),Jm("design:paramtypes",[Object])],$m);var t_=function(){function t(){jt(this,t),this.pools=[];for(var e=0;e<10;e++)this.pools.push(new ye)}return zt(t,[{key:"allocate",value:function(t,e,i,n){if(!this.pools.length)return(new ye).setValue(t,e,i,n);var r=this.pools.pop();return r.x1=t,r.y1=e,r.x2=i,r.y2=n,r}},{key:"allocateByObj",value:function(t){if(!this.pools.length)return new ye(t);var e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}},{key:"free",value:function(t){this.pools.push(t)}},{key:"length",get:function(){return this.pools.length}},{key:"release",value:function(){this.pools=[]}}]),t}(),e_=new t_;function i_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var n_=function(t){ue(i,t);var e=i_(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).time=Ds.beforeFillStroke,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d,f,p,v,y,g,m,_,b,x,k,S=t.attribute,A=S.backgroundMode,w=void 0===A?l.backgroundMode:A,T=S.backgroundFit,C=void 0===T?l.backgroundFit:T,E=t.attribute.background;if(E){var R=M(E)&&E.background,P=t.transMatrix.onlyTranslate();if(R){var B=t.AABBBounds,L=(null!==(d=E.x)&&void 0!==d?d:B.x1)+(null!==(f=E.dx)&&void 0!==f?f:0),O=(null!==(p=E.y)&&void 0!==p?p:B.y1)+(null!==(v=E.dy)&&void 0!==v?v:0),I=null!==(y=E.width)&&void 0!==y?y:B.width(),D=null!==(g=E.height)&&void 0!==g?g:B.height();if(k=e_.allocate(L,O,L+I,O+D),E=E.background,!P){var F=k.width(),z=k.height();k.set((null!==(m=E.x)&&void 0!==m?m:0)+(null!==(_=E.dx)&&void 0!==_?_:0),(null!==(b=E.y)&&void 0!==b?b:0)+(null!==(x=E.dy)&&void 0!==x?x:0),F,z)}}else k=t.AABBBounds,P||k.set(0,0,k.width(),k.height());if(t.backgroundImg&&t.resources){var j=t.resources.get(E);if("success"!==j.state||!j.data)return;e.highPerformanceSave(),P&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,n,l),this.doDrawImage(e,j.data,k,w,C),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,n,l),e.fillStyle=E,e.fillRect(k.x1,k.y1,k.width(),k.height()),e.highPerformanceRestore();R&&e_.free(k)}}}]),i}(Lg),r_=new n_;function o_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var a_=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},s_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l_=function(t,e){return function(i,n){e(i,n,t)}},u_=function(t){ue(i,t);var e=o_(i);function i(t){var n;return jt(this,i),(n=e.call(this)).textRenderContribitions=t,n.numberType=tf,n.builtinContributions=[r_],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u,c,h=this,d=gc(t,null==o?void 0:o.theme).text,f=t.attribute;f.text;var p=f.underline,v=void 0===p?d.underline:p,y=f.lineThrough,g=void 0===y?d.lineThrough:y,m=f.keepDirIn3d,_=void 0===m?d.keepDirIn3d:m,b=f.direction,x=void 0===b?d.direction:b,k=f.whiteSpace;void 0===k&&d.whiteSpace;var S=f.fontSize,A=void 0===S?d.fontSize:S,w=f.verticalMode,T=void 0===w?d.verticalMode:w,M=f.x,C=void 0===M?d.x:M,E=f.y,R=void 0===E?d.y:E,P=t.attribute,B=P.textAlign,L=void 0===B?d.textAlign:B,O=P.textBaseline,I=void 0===O?d.textBaseline:O;if(!T&&"vertical"===x){var D=L;L=null!==(l=t.getBaselineMapAlign()[I])&&void 0!==l?l:"left",I=null!==(u=t.getAlignMapBaseline()[D])&&void 0!==u?u:"top"}var F=null!==(c=ph(t.attribute.lineHeight,A))&&void 0!==c?c:A,z=this.valid(t,d,a,s);if(z){var j=z.fVisible,H=z.sVisible,N=z.doFill,V=z.doStroke,G=!_,W=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,n,N,V,j,H,d,r,a,s),G&&this.transformUseContext2d(t,d,W,e);var U=function(r,o,l,u){var c=i+o,f=n+l;if(u){e.highPerformanceSave(),c+=A;var p=cg.allocate(1,0,0,1,0,0);p.rotateByCenter(Math.PI/2,c,f),e.transformFromMatrix(p,!0),cg.free(p)}V&&(s?s(e,t.attribute,d):H&&(e.setStrokeStyle(t,t.attribute,C-i,R-n,d),e.strokeText(r,c,f,W))),N&&(a?a(e,t.attribute,d):j&&(e.setCommonStyle(t,t.attribute,C-i,R-n,d),e.fillText(r,c,f,W),h.drawUnderLine(v,g,t,c,f,W,d,e))),u&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(t.isMultiLine)if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,W),"horizontal"===x){var Y=t.multilineLayout;if(!Y)return void e.highPerformanceRestore();var K=Y.bbox,X=K.xOffset,Z=K.yOffset;V&&(s?s(e,t.attribute,d):H&&(e.setStrokeStyle(t,t.attribute,C-i,R-n,d),Y.lines.forEach((function(t){e.strokeText(t.str,(t.leftOffset||0)+X+i,(t.topOffset||0)+Z+n,W)})))),N&&(a?a(e,t.attribute,d):j&&(e.setCommonStyle(t,t.attribute,C-i,R-n,d),Y.lines.forEach((function(r){e.fillText(r.str,(r.leftOffset||0)+X+i,(r.topOffset||0)+Z+n,W),h.drawMultiUnderLine(v,g,t,(r.leftOffset||0)+i,(r.topOffset||0)+Z+n,W,r.width,d,e)}))))}else{t.tryUpdateAABBBounds();var q=t.cache.verticalList;e.textAlign="left",e.textBaseline="top";var J=F*q.length,Q=0;q.forEach((function(t){var e=t.reduce((function(t,e){return t+(e.width||0)}),0);Q=Xt(e,Q)}));var $=0,tt=0;"bottom"===I?tt=-J:"middle"===I&&(tt=-J/2),"center"===L?$-=Q/2:"right"===L&&($-=Q),q.forEach((function(t,e){var i=t.reduce((function(t,e){return t+(e.width||0)}),0),n=Q-i,r=$;"center"===L?r+=n/2:"right"===L&&(r+=n),t.forEach((function(t){var i=t.text,n=t.width,o=t.direction;U(i,J-(e+1)*F+tt,r,o),r+=n}))}))}else if("horizontal"===x){e.setTextStyle(t.attribute,d,W);var et=t.clipedText,it=0;F!==A&&("top"===I?it=(F-A)/2:"middle"===I||"bottom"===I&&(it=-(F-A)/2)),U(et,0,it,0)}else{t.tryUpdateAABBBounds();var nt=t.cache;if(nt){e.setTextStyleWithoutAlignBaseline(t.attribute,d,W);var rt=nt.verticalList,ot=0,at=rt[0].reduce((function(t,e){return t+(e.width||0)}),0),st=0;"bottom"===I?st=-F:"middle"===I&&(st=-F/2),"center"===L?ot-=at/2:"right"===L&&(ot-=at),e.textAlign="left",e.textBaseline="top",rt[0].forEach((function(t){var e=t.text,i=t.width,n=t.direction;U(e,st,ot,n),ot+=i}))}}G&&this.restoreTransformUseContext2d(t,d,W,e),this.afterRenderStep(t,e,i,n,N,V,j,H,d,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).text,o=t.attribute.keepDirIn3d,a=!(void 0===o?r.keepDirIn3d:o);this._draw(t,r,a,i,n)}},{key:"drawUnderLine",value:function(t,e,i,n,r,o,a,s){if(!(e+t<=0)){var l=i.attribute,u=l.textAlign,c=void 0===u?a.textAlign:u,h=l.textBaseline,d=void 0===h?a.textBaseline:h,f=l.fontSize,p=void 0===f?a.fontSize:f,v=l.fill,y=void 0===v?a.fill:v,g=l.opacity,m=void 0===g?a.opacity:g,_=l.fillOpacity,b=void 0===_?a.fillOpacity:_,x=i.clipedWidth,k=Jf(c,x),S=Qf(d,p,p),A={lineWidth:0,stroke:y,opacity:m,strokeOpacity:b};if(t){A.lineWidth=t,s.setStrokeStyle(i,A,n,r,a),s.beginPath();var w=r+S+p;s.moveTo(n+k,w,o),s.lineTo(n+k+x,w,o),s.stroke()}if(e){A.lineWidth=e,s.setStrokeStyle(i,A,n,r,a),s.beginPath();var T=r+S+p/2;s.moveTo(n+k,T,o),s.lineTo(n+k+x,T,o),s.stroke()}}}},{key:"drawMultiUnderLine",value:function(t,e,i,n,r,o,a,s,l){if(!(e+t<=0)){var u=i.attribute,c=u.textAlign,h=void 0===c?s.textAlign:c,d=u.fontSize,f=void 0===d?s.fontSize:d,p=u.fill,v=void 0===p?s.fill:p,y=u.opacity,g=void 0===y?s.opacity:y,m=u.fillOpacity,_=void 0===m?s.fillOpacity:m,b=Jf(h,a),x=Qf("alphabetic",f,f),k={lineWidth:0,stroke:v,opacity:g,strokeOpacity:_},S=-3;if(t){k.lineWidth=t,l.setStrokeStyle(i,k,n,r,s),l.beginPath();var A=r+x+f+S;l.moveTo(n+b,A,o),l.lineTo(n+b+a,A,o),l.stroke()}if(S=-1,e){k.lineWidth=e,l.setStrokeStyle(i,k,n,r,s),l.beginPath();var w=r+x+f/2+S;l.moveTo(n+b,w,o),l.lineTo(n+b+a,w,o),l.stroke()}}}}]),i}(wg);function c_(t,e,i,n){t.moveTo(e[0].x+i,e[0].y+n);for(var r=1;r<e.length;r++)t.lineTo(e[r].x+i,e[r].y+n)}function h_(t,e){return Math.sqrt(t*t+e*e)}function d_(t,e,i,n,r){var o=e/i;return{x:t.x-n*o,y:t.y-r*o}}u_=a_([Ya(),l_(0,Wa(cs)),l_(0,Ka(Wf)),s_("design:paramtypes",[Object])],u_);var f_=Fg,p_=Og;function v_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var y_=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},g_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},m_=function(t,e){return function(i,n){e(i,n,t)}},__=function(t){ue(i,t);var e=v_(i);function i(t){var n;return jt(this,i),(n=e.call(this)).polygonRenderContribitions=t,n.numberType=Xd,n.builtinContributions=[p_,f_],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l=gc(t,null==o?void 0:o.theme).polygon,u=t.attribute,c=u.points,h=void 0===c?l.points:c,d=u.cornerRadius,f=void 0===d?l.cornerRadius:d,p=u.x,v=void 0===p?l.x:p,y=u.y,g=void 0===y?l.y:y,m=u.closePath,_=void 0===m?l.closePath:m,b=this.valid(t,l,a,s);if(b){var x=b.fVisible,k=b.sVisible,S=b.doFill,A=b.doStroke;e.beginPath(),f<=0||B(f)&&f.every((function(t){return 0===t}))?c_(e.camera?e:e.nativeContext,h,i,n):function(t,e,i,n,r){var o,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(e.length<3)c_(t,e,i,n);else{var s=0,l=e.length-1;a||(s+=1,l-=1,t.moveTo(e[0].x+i,e[0].y+n));for(var u=s;u<=l;u++){var c=e[0===u?l:(u-1)%e.length],h=e[u%e.length],d=e[(u+1)%e.length],f=h.x-c.x,p=h.y-c.y,v=h.x-d.x,y=h.y-d.y,g=(Math.atan2(p,f)-Math.atan2(y,v))/2,m=Math.abs(Math.tan(g)),_=Array.isArray(r)?null!==(o=r[u%e.length])&&void 0!==o?o:0:r,b=_/m,x=h_(f,p),k=h_(v,y),S=Math.min(x,k);b>S&&(b=S,_=S*m);var A=d_(h,b,x,f,p),w=d_(h,b,k,v,y),T=2*h.x-A.x-w.x,M=2*h.y-A.y-w.y,C=h_(T,M),E=d_(h,h_(b,_),C,T,M),R=Math.atan2(A.y-E.y,A.x-E.x),P=Math.atan2(w.y-E.y,w.x-E.x),B=P-R;B<0&&(R=P,B=-B),B>Math.PI&&(B-=Math.PI),0===u?t.moveTo(A.x+i,A.y+n):t.lineTo(A.x+i,A.y+n),B&&t.arcTo(h.x+i,h.y+n,w.x+i,w.y+n,_),t.lineTo(w.x+i,w.y+n)}a||t.lineTo(e[l+1].x+i,e[l+1].y+n)}}(e.camera?e:e.nativeContext,h,i,n,f,_),_&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,n,S,A,x,k,l,r,a,s),S&&(a?a(e,t.attribute,l):x&&(e.setCommonStyle(t,t.attribute,v-i,g-n,l),e.fill())),A&&(s?s(e,t.attribute,l):k&&(e.setStrokeStyle(t,t.attribute,v-i,g-n,l),e.stroke())),this.afterRenderStep(t,e,i,n,S,A,x,k,l,r,a,s)}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).polygon;this._draw(t,r,!1,i,n)}}]),i}(wg);function b_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}__=y_([Ya(),m_(0,Wa(cs)),m_(0,Ka(Nf)),g_("design:paramtypes",[Object])],__);var x_=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},k_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},S_=function(t,e){return function(i,n){e(i,n,t)}},A_=["","repeat-x","repeat-y","repeat"],w_=function(t){ue(i,t);var e=b_(i);function i(t){var n;return jt(this,i),(n=e.call(this)).imageRenderContribitions=t,n.numberType=Ud,n.builtinContributions=[$g],n.init(t),n}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a){var s=gc(t).image,l=t.attribute,u=l.width,c=void 0===u?s.width:u,h=l.height,d=void 0===h?s.height:h,f=l.repeatX,p=void 0===f?s.repeatX:f,v=l.repeatY,y=void 0===v?s.repeatY:v,g=l.cornerRadius,m=void 0===g?s.cornerRadius:g,_=l.image,b=this.valid(t,s,a);if(b){var x=b.fVisible;b.sVisible;var k=b.doFill;if(b.doStroke,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,s),this.beforeRenderStep(t,e,i,n,k,!1,x,!1,s,r,a),k)if(a)a(e,t.attribute,s);else if(x){if(!_||!t.resources)return;var S=t.resources.get(_);if("success"!==S.state)return;var A=!1;0===m||B(m)&&m.every((function(t){return 0===t}))||(e.beginPath(),qg(e,i,n,c,d,m),e.save(),e.clip(),A=!0),e.setCommonStyle(t,t.attribute,i,n,s);var w=0;if("repeat"===p&&(w|=1),"repeat"===y&&(w|=2),w){var T=e.createPattern(S.data,A_[w]);e.fillStyle=T,e.translate(i,n,!0),e.fillRect(0,0,c,d),e.translate(-i,-n,!0)}else e.drawImage(S.data,i,n,c,d);A&&e.restore()}this.afterRenderStep(t,e,i,n,k,!1,x,!1,s,r,a)}}},{key:"draw",value:function(t,e,i){var n=t.attribute.image;if(n&&t.resources&&("success"===t.resources.get(n).state&&e.drawParams.context)){var r=gc(t).image;this._draw(t,r,!1,i)}}}]),i}(wg);w_=x_([Ya(),S_(0,Wa(cs)),S_(0,Ka(jf)),k_("design:paramtypes",[Object])],w_);var T_=Symbol.for("IncrementalDrawContribution"),M_=Symbol.for("ArcRender"),C_=Symbol.for("Arc3dRender"),E_=Symbol.for("AreaRender"),R_=Symbol.for("CircleRender"),P_=Symbol.for("GraphicRender"),B_=Symbol.for("GroupRender"),L_=Symbol.for("LineRender"),O_=Symbol.for("PathRender"),I_=Symbol.for("PolygonRender"),D_=Symbol.for("RectRender"),F_=Symbol.for("Rect3DRender"),z_=Symbol.for("SymbolRender"),j_=Symbol.for("TextRender"),H_=Symbol.for("RichTextRender"),N_=Symbol.for("Pyramid3dRender"),V_=Symbol.for("GlyphRender"),G_=Symbol.for("ImageRender"),W_=Symbol.for("DrawContribution"),U_=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Y_=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},K_=function(t,e){return function(i,n){e(i,n,t)}},X_=Symbol.for("RenderService"),Z_=function(){function t(e){jt(this,t),this.drawContribution=e}return zt(t,[{key:"prepare",value:function(t){var e=this;t&&this.renderTreeRoots.forEach((function(i){e._prepare(i,t)}))}},{key:"_prepare",value:function(t,e){var i=this;t.forEachChildren((function(t){i._prepare(t,e)})),t.update({bounds:e,trans:!0})}},{key:"prepareRenderList",value:function(){}},{key:"beforeDraw",value:function(t){}},{key:"draw",value:function(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}},{key:"afterDraw",value:function(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}},{key:"render",value:function(t,e){this.renderTreeRoots=t,this.drawParams=e;var i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e)}}]),t}();Z_=U_([Ya(),K_(0,Wa(W_)),Y_("design:paramtypes",[Object])],Z_);var q_=new La((function(t){t(X_).to(Z_).inSingletonScope()})),J_=Symbol.for("PickerService"),Q_=Symbol.for("GlobalPickerService"),$_=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},tb=Symbol.for("PickItemInterceptor"),eb=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"afterPickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,n,r):null}},{key:"beforePickItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,n,r):null}},{key:"_pickItem",value:function(t,e,i,n,r){if(!t.shadowRoot)return null;var o=(r||{}).parentMatrix;if(!o)return null;var a=e.pickContext;a.highPerformanceSave();var s=t.shadowRoot,l=cg.allocateByObj(o),u=new ae(l.a*i.x+l.c*i.y+l.e,l.b*i.x+l.d*i.y+l.f),c=e.pickGroup(s,u,l,n);return a.highPerformanceRestore(),c}}]),t}();eb=$_([Ya()],eb);var ib=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"beforePickItem",value:function(t,e,i,n,r){var o=t.baseGraphic;if(o&&o.parent){var a=new ae(i.x,i.y),s=e.pickContext;s.highPerformanceSave();var l=o.parent.globalTransMatrix;l.transformPoint(a,a);var u=o.isContainer?e.pickGroup(o,a.clone(),l,n):e.pickItem(o,a.clone(),l,n);return s.highPerformanceRestore(),u}return null}}]),t}();ib=$_([Ya()],ib);var nb=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"beforePickItem",value:function(t,e,i,n,r){if(!t.in3dMode||n.in3dInterceptor)return null;var o=e.pickContext,a=t.stage;if(!o||!a)return null;if(n.in3dInterceptor=!0,o.save(),this.initCanvasCtx(o),o.camera=a.camera,t.isContainer){var s,l=!1,u=!1;if(t.forEachChildren((function(t){return!(l=t.numberType===Hd)})),t.forEachChildren((function(t){return!(u=!!t.findFace)})),l){var c=t.getChildren(),h=m(c);h.sort((function(t,e){for(var i,n,r,o,a=(null!==(n=null!==(i=t.attribute.startAngle)&&void 0!==i?i:0+t.attribute.endAngle)&&void 0!==n?n:0)/2,s=(null!==(o=null!==(r=e.attribute.startAngle)&&void 0!==r?r:0+e.attribute.endAngle)&&void 0!==o?o:0)/2;a<0;)a+=Wt;for(;s<0;)s+=Wt;return s-a})),h.forEach((function(t){t._next=null,t._prev=null})),t.removeAllChild(),t.update(),h.forEach((function(e){t.appendChild(e)})),n.hack_pieFace="outside",(s=e.pickGroup(t,i,r.parentMatrix,n)).graphic||(n.hack_pieFace="inside",s=e.pickGroup(t,i,r.parentMatrix,n)),s.graphic||(n.hack_pieFace="top",s=e.pickGroup(t,i,r.parentMatrix,n)),t.removeAllChild(),c.forEach((function(t){t._next=null,t._prev=null})),c.forEach((function(e){t.appendChild(e)}))}else if(u){var d=t.getChildren(),f=d.map((function(t){return{ave_z:t.findFace().vertices.map((function(e){var i;return o.view(e[0],e[1],null!==(i=e[2]+t.attribute.z)&&void 0!==i?i:0)[2]})).reduce((function(t,e){return t+e}),0),g:t}}));f.sort((function(t,e){return e.ave_z-t.ave_z})),t.removeAllChild(),f.forEach((function(t){t.g._next=null,t.g._prev=null})),t.update(),f.forEach((function(e){t.add(e.g)})),s=e.pickGroup(t,i,r.parentMatrix,n),t.removeAllChild(),d.forEach((function(t){t._next=null,t._prev=null})),t.update(),d.forEach((function(e){t.add(e)}))}else s=e.pickGroup(t,i,r.parentMatrix,n);return o.camera=null,n.in3dInterceptor=!1,o.restore(),s}return o.restore(),null}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}]),t}();nb=$_([Ya()],nb);var rb=new La((function(t,e,i){i(J_)||(t(Q_).toSelf(),t(J_).toService(Q_)),t(nb).toSelf().inSingletonScope(),t(tb).toService(nb),t(eb).toSelf().inSingletonScope(),t(tb).toService(eb),t(ib).toSelf().inSingletonScope(),t(tb).toService(ib),ds(t,tb)})),ob=new La((function(t){t(ef).to(_g).inSingletonScope(),t(nf).toConstantValue(kg)})),ab=Symbol.for("AutoEnablePlugins"),sb=Symbol.for("PluginService"),lb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},ub=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},cb=function(t,e){return function(i,n){e(i,n,t)}},hb=function(){function t(e){jt(this,t),this.autoEnablePlugins=e,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}return zt(t,[{key:"active",value:function(t,e){var i=this;this.stage=t,this.actived=!0;var n=e.pluginList;n&&_u.isBound(ab)&&this.autoEnablePlugins.getContributions().forEach((function(t){n.includes(t.name)&&i.register(t)}))}},{key:"findPluginsByName",value:function(t){var e=[];return this.onStartupFinishedPlugin.forEach((function(i){i.name===t&&e.push(i)})),this.onRegisterPlugin.forEach((function(i){i.name===t&&e.push(i)})),e}},{key:"register",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}},{key:"unRegister",value:function(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}},{key:"release",value:function(){var t=this;this.onStartupFinishedPlugin.forEach((function(e){e.deactivate(t)})),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach((function(e){e.deactivate(t)})),this.onRegisterPlugin=[]}}]),t}();hb=lb([Ya(),cb(0,Wa(cs)),cb(0,Ka(ab)),ub("design:paramtypes",[Object])],hb);var db=new La((function(t){t(sb).to(hb),function(t,e){t(cs).toDynamicValue((function(t){var i=t.container;return new hs(e,i)})).whenTargetNamed(e)}(t,ab)})),fb=new La((function(t){ds(t,ys)})),pb=new La((function(t){t(gu).to(mu).inSingletonScope(),ds(t,gu)})),vb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},yb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},gb=function(){function t(){jt(this,t),this.type="static",this.offscreen=!1,this.global=nu.global}return zt(t,[{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"init",value:function(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{var n;this.main=!1,i.canvasId&&(n=this.global.getElementById(i.canvasId)),n||(n=this.global.createCanvas({width:e.width,height:e.height})),n.style&&(n.style["pointer-events"]="none");var r=e.getContext().getCanvas().nativeCanvas,o=ku({nativeCanvas:n,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});o.applyPosition(),this.canvas=o,this.context=o.getContext()}}},{key:"resize",value:function(t,e){this.canvas.resize(t,e)}},{key:"resizeView",value:function(t,e){}},{key:"render",value:function(t,e,i){var n;if(!this.main){var r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!==(n=e.background)&&void 0!==n?n:"#ffffff"},e),i))}},{key:"merge",value:function(t){var e=this;t.forEach((function(t){var i=t.getContext().canvas.nativeCanvas;e.context.drawImage(i,0,0)}))}},{key:"prepare",value:function(t,e){}},{key:"drawTo",value:function(t,e,i){var n,r=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!==(n=i.background)&&void 0!==n?n:"#fff":void 0}))}},{key:"getContext",value:function(){return this.context}},{key:"release",value:function(){this.canvas.release()}}]),t}();gb=vb([Ya(),yb("design:paramtypes",[])],gb);var mb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},_b=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},bb=function(){function t(){jt(this,t),this.offscreen=!1,this.type="virtual",this.global=nu.global}return zt(t,[{key:"setDpr",value:function(t){}},{key:"init",value:function(t,e,i){if(this.layer=t,this.window=e,i.main)throw new Error("virtual layer不能作为main layer");this.main=!1,this.canvas=null,this.context=null}},{key:"resize",value:function(t,e){}},{key:"resizeView",value:function(t,e){}},{key:"render",value:function(t,e,i){this.mainHandler.render(t,e,Object.assign(Object.assign({},i),{clear:!1}))}},{key:"merge",value:function(t){}},{key:"prepare",value:function(t,e){}},{key:"drawTo",value:function(t,e,i){var n,r=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!==(n=i.background)&&void 0!==n?n:"#fff":void 0}))}},{key:"getContext",value:function(){return null}},{key:"release",value:function(){}}]),t}();bb=mb([Ya(),_b("design:paramtypes",[])],bb);var xb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},kb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Sb=function(){function t(){jt(this,t),this.offscreen=!0,this.type="dynamic",this.global=nu.global}return zt(t,[{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"init",value:function(t,e,i){this.layer=t;var n=ku({nativeCanvas:this.global.createOffscreenCanvas({width:i.width,height:i.height,dpr:e.dpr}),width:i.width,height:i.height,dpr:e.dpr,canvasControled:!0});this.canvas=n,this.context=n.getContext()}},{key:"resize",value:function(t,e){this.canvas.resize(t,e)}},{key:"resizeView",value:function(t,e){this.canvas.resize(t,e)}},{key:"render",value:function(t,e){var i;e.renderService.render(t,Object.assign(Object.assign({context:this.context},e),{x:0,y:0,clear:null!==(i=e.background)&&void 0!==i?i:"#ffffff"}))}},{key:"prepare",value:function(t,e){}},{key:"release",value:function(){this.canvas.release()}},{key:"getContext",value:function(){return this.context}},{key:"drawTo",value:function(t,e,i){var n=t.getContext(),r=t.dpr,o=i.x,a=void 0===o?0:o,s=i.y,l=void 0===s?0:s,u=i.width,c=void 0===u?this.layer.viewWidth:u,h=i.height,d=void 0===h?this.layer.viewHeight:h;n.nativeContext.save(),n.nativeContext.setTransform(r,0,0,r,0,0),i.clear&&n.clearRect(a,l,c,d),n.drawImage(this.canvas.nativeCanvas,0,0,this.canvas.width,this.canvas.height,a,l,c,d),n.nativeContext.restore()}},{key:"merge",value:function(t){}}]),t}();Sb=xb([Ya(),kb("design:paramtypes",[])],Sb);var Ab=new La((function(t){t(gb).toSelf(),t(Sb).toSelf(),t(bb).toSelf(),t(vf).toService(gb),t(yf).toService(Sb),t(gf).toService(bb)}));function wb(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */wb=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var Tb=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};function Mb(t,e,i){var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a={},s=[],l=!1;o?l=!0:t.forEachChildren((function(t,i){var r=t.attribute.zIndex,o=void 0===r?e:r;if(0===i)n=o;else if(n!==o)return l=!0,!0;return!1}),r);if(l){t.forEachChildren((function(t){var i=t.attribute.zIndex,n=void 0===i?e:i;a[n]?a[n].push(t):(a[n]=[t],s.push(n))}),r),s.sort((function(t,e){return r?e-t:t-e}));for(var u=!1,c=0;c<s.length&&!u;c++){var h=s[c],d=a[h];o&&d.sort((function(t,e){var i,n;return(r?-1:1)*((null!==(i=e.attribute.z)&&void 0!==i?i:0)-(null!==(n=t.attribute.z)&&void 0!==n?n:0))}));for(var f=0;f<d.length;f++)if(i(d[f],f)){u=!0;break}}}else t.forEachChildren(i,r)}function Cb(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Tb(this,void 0,void 0,wb().mark((function e(){return wb().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.forEachChildrenAsync(i,n);case 2:case"end":return e.stop()}}),e)})))}function Eb(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},o=[],a=!1;t.forEachChildren((function(t,e){var n=t.attribute.zIndex;if(0===e);else if(void 0!==(void 0===n?i:n))return a=!0,!0;return!1}),n);var s=null,l=!1;if(a){t.forEachChildren((function(t){var e=t.attribute.zIndex,n=void 0===e?i:e;r[n]?r[n].push(t):(r[n]=[t],o.push(n))}),n),o.sort((function(t,e){return n?e-t:t-e}));for(var u=!1,c=0;c<o.length&&!u;c++)for(var h=o[c],d=r[h],f=0;f<d.length;f++){if(l){u=!0,s=d[f];break}d[f]._uid!==e||(l=!0)}}else t.forEachChildren((function(t){return l?(s=t,!0):(t._uid===e&&(l=!0),!1)}),n);return s}var Rb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Pb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Bb=Symbol.for("DrawItemInterceptor"),Lb=new ye,Ob=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"afterDrawItem",value:function(t,e,i,n,r){return(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx)&&this.drawItem(t,e,i,n,r),!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){return t.attribute.shadowRootIdx<0&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.shadowRoot)return!1;var o=i.context;if(o.highPerformanceSave(),o.transformFromMatrix(t.transMatrix,!0),n.dirtyBounds&&n.backupDirtyBounds){Lb.copy(n.dirtyBounds);var a=t.globalTransMatrix.getInverse();n.dirtyBounds.copy(n.backupDirtyBounds).transformWithMatrix(a)}return n.renderGroup(t.shadowRoot,i,t.parent.globalTransMatrix),o.highPerformanceRestore(),n.dirtyBounds&&n.backupDirtyBounds&&n.dirtyBounds.copy(Lb),!0}}]),t}(),Ib=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"afterDrawItem",value:function(t,e,i,n,r){return t.attribute._debug_bounds&&this.drawItem(t,e,i,n,r),!1}},{key:"drawItem",value:function(t,e,i,n,r){if(!t.attribute._debug_bounds)return!1;var o=i.context;o.highPerformanceSave(),t.parent&&o.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&o.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);var a=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(o,t),o.strokeRect(a.x1,a.y1,a.width(),a.height()),o.highPerformanceRestore(),!0}}]),t}(),Db=function(){function t(){jt(this,t),this.order=1,this.interceptors=[new Ob,new zb,new Fb,new Ib]}return zt(t,[{key:"afterDrawItem",value:function(t,e,i,n,r){for(var o=0;o<this.interceptors.length;o++)if(this.interceptors[o].afterDrawItem&&this.interceptors[o].afterDrawItem(t,e,i,n,r))return!0;return!1}},{key:"beforeDrawItem",value:function(t,e,i,n,r){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(var o=0;o<this.interceptors.length;o++)if(this.interceptors[o].beforeDrawItem&&this.interceptors[o].beforeDrawItem(t,e,i,n,r))return!0;return!1}}]),t}();Db=Rb([Ya(),Pb("design:paramtypes",[])],Db);var Fb=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"beforeDrawItem",value:function(t,e,i,n,r){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,n,r):this.beforeSetInteractive(t,e,i,n,r))}},{key:"beforeSetInteractive",value:function(t,e,i,n,r){var o=t.interactiveGraphic;if(t.attribute.globalZIndex){o||(o=t.clone(),t.interactiveGraphic=o,o.baseGraphic=t),o.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();var a=i.stage.getLayer("_builtin_interactive");return a&&this.getShadowRoot(a).add(o),!0}if(o){i.stage.tryInitInteractiveLayer();var s=i.stage.getLayer("_builtin_interactive");s&&this.getShadowRoot(s).removeChild(o),t.interactiveGraphic=null,o.baseGraphic=null}return!1}},{key:"beforeDrawInteractive",value:function(t,e,i,n,r){var o=t.baseGraphic;if(o){this.processing=!0;var a=i.context;return a.highPerformanceSave(),a.setTransformFromMatrix(o.parent.globalTransMatrix,!0),o.isContainer?n.renderGroup(o,i,o.parent.globalTransMatrix):n.renderItem(o,i),a.highPerformanceRestore(),this.processing=!1,!0}return!1}},{key:"getShadowRoot",value:function(t){var e,i=t.getElementById("_interactive_group");return i||((i=kg.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!==(e=i.shadowRoot)&&void 0!==e?e:i.attachShadow()}}]),t}(),zb=function(){function t(){jt(this,t),this.order=1}return zt(t,[{key:"beforeDrawItem",value:function(t,e,i,n,r){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;var o=e.drawParams,a=o.context,s=o.stage;a.canvas,a.save(),this.initCanvasCtx(a),a.camera=s.camera;var l=a.currentMatrix;l.a/=a.dpr,l.b/=a.dpr,l.c/=a.dpr,l.d/=a.dpr,l.e/=a.dpr,l.f/=a.dpr;var u=hg.allocate();yg(u,l);var c=a.modelMatrix;if(c){if(u){var h=hg.allocate();a.modelMatrix=gg(h,c,u)}}else a.modelMatrix=u;if(a.setTransform(1,0,0,1,0,0,!0),t.isContainer){var d=!1,f=!1;if(t.forEachChildren((function(t){return!(d=t.numberType===Hd)})),t.forEachChildren((function(t){return!(f=!!t.findFace)})),d){var p=t.getChildren(),v=m(p);v.sort((function(t,e){for(var i,n,r,o,a=((null!==(i=t.attribute.startAngle)&&void 0!==i?i:0)+(null!==(n=t.attribute.endAngle)&&void 0!==n?n:0))/2,s=((null!==(r=e.attribute.startAngle)&&void 0!==r?r:0)+(null!==(o=e.attribute.endAngle)&&void 0!==o?o:0))/2;a<0;)a+=Wt;for(;s<0;)s+=Wt;return s-a})),v.forEach((function(t){t._next=null,t._prev=null})),t.removeAllChild(),t.update(),v.forEach((function(e){t.appendChild(e)}));var y=t.parent.globalTransMatrix;i.hack_pieFace="outside",n.renderGroup(t,i,y),i.hack_pieFace="inside",n.renderGroup(t,i,y),i.hack_pieFace="top",n.renderGroup(t,i,y),t.removeAllChild(),p.forEach((function(t){t._next=null,t._prev=null})),p.forEach((function(e){t.appendChild(e)}))}else if(f){var g=t.getChildren(),_=g.map((function(t){return{ave_z:t.findFace().vertices.map((function(e){var i;return a.view(e[0],e[1],null!==(i=e[2]+t.attribute.z)&&void 0!==i?i:0)[2]})).reduce((function(t,e){return t+e}),0),g:t}}));_.sort((function(t,e){return e.ave_z-t.ave_z})),t.removeAllChild(),_.forEach((function(t){t.g._next=null,t.g._prev=null})),t.update(),_.forEach((function(e){t.add(e.g)})),n.renderGroup(t,i,t.parent.globalTransMatrix,!0),t.removeAllChild(),g.forEach((function(t){t._next=null,t._prev=null})),t.update(),g.forEach((function(e){t.add(e)}))}else n.renderGroup(t,i,t.parent.globalTransMatrix)}else n.renderItem(t,i);return a.camera=null,a.restore(),a.modelMatrix!==c&&hg.free(a.modelMatrix),a.modelMatrix=c,i.in3dInterceptor=!1,!0}},{key:"initCanvasCtx",value:function(t){t.setTransformForCurrent()}}]),t}(),jb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Hb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Nb=function(t,e){return function(i,n){e(i,n,t)}},Vb=function(){function t(e,i){jt(this,t),this.contributions=e,this.drawItemInterceptorContributions=i,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new ve,this.backupDirtyBounds=new ve,this.global=nu.global,this.layerService=nu.layerService,this.init()}return zt(t,[{key:"init",value:function(){var t=this;this.contributions.forEach((function(e){if(e.style){var i=t.styleRenderMap.get(e.style)||new Map;i.set(e.numberType,e),t.styleRenderMap.set(e.style,i)}else t.defaultRenderMap.set(e.numberType,e)})),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"prepareForDraw",value:function(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}},{key:"draw",value:function(t,e){var i=this;this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;var n=e.context,r=e.stage,o=e.x,a=void 0===o?0:o,s=e.y,l=void 0===s?0:s,u=e.width,c=e.height;if(n){var h=this.dirtyBounds.setValue(0,0,u,c);if(r.dirtyBounds&&!r.dirtyBounds.empty()){var d=Je(h,r.dirtyBounds,!1);h.x1=Math.floor(d.x1),h.y1=Math.floor(d.y1),h.x2=Math.ceil(d.x2),h.y2=Math.ceil(d.y2)}var f=n.dpr%1;(f||.5!==f)&&(h.x1=Math.floor(h.x1*n.dpr)/n.dpr,h.y1=Math.floor(h.y1*n.dpr)/n.dpr,h.x2=Math.ceil(h.x2*n.dpr)/n.dpr,h.y2=Math.ceil(h.y2*n.dpr)/n.dpr),this.backupDirtyBounds.copy(h),n.inuse=!0,n.clearMatrix(),n.setTransformForCurrent(!0);var p=h.width()*n.dpr<n.canvas.width||h.height()*n.dpr<n.canvas.height;n.save(),n.translate(a,l,!0),p&&(n.beginPath(),n.rect(h.x1,h.y1,h.width(),h.height()),n.clip()),r.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(t,n,e),n.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nl.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nl.zIndex)})).forEach((function(t){t.isContainer?i.renderGroup(t,e,cg.allocate(1,0,0,1,0,0)):i.renderItem(t,e)})),n.restore(),n.restore(),n.draw(),n.inuse=!1}}},{key:"doRegister",value:function(){throw new Error("暂不支持")}},{key:"_findNextGraphic",value:function(t){for(var e=t.parent,i=t._uid;e;){var n=Eb(e,i,Nl.zIndex);if(n)return n;i=e._uid,e=e.parent}return null}},{key:"renderGroup",value:function(t,e,i,n){var r=this;if(!e.break&&!1!==t.attribute.visibleAll){if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(!this.useDirtyBounds||Qe(t.AABBBounds,this.dirtyBounds,!1)){var o,a=i;if(this.useDirtyBounds){o=e_.allocateByObj(this.dirtyBounds);var s=t.transMatrix;a=cg.allocateByObj(i).multiply(s.a,s.b,s.c,s.d,s.e,s.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(a.getInverse())}this.renderItem(t,e,{drawingCb:function(){var i;n?t.forEachChildren((function(t){e.break||(t.isContainer?r.renderGroup(t,e,a):r.renderItem(t,e))})):Mb(t,Nl.zIndex,(function(t){e.break||(t.isContainer?r.renderGroup(t,e,a):r.renderItem(t,e))}),!1,!!(null===(i=e.context)||void 0===i?void 0:i.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(o),e_.free(o),cg.free(a))}}}},{key:"_increaseRender",value:function(t,e){var i=e.layer,n=e.stage,r=i.subLayers,o=r.get(t._uid);o||(o={layer:this.layerService.createLayer(n),zIndex:r.size,group:t},r.set(t._uid,o));var a=o.layer.getNativeHandler().getContext(),s=o.drawContribution||_u.get(T_);s.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),s.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:o.layer,context:a,startAtId:t._uid,break:!1})),o.drawContribution=s;var l=this._findNextGraphic(t);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,e);else{var u=r.get(l._uid);u||(u={layer:this.layerService.createLayer(n),zIndex:r.size},r.set(l._uid,u));var c=u.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:s,clear:"transparent",layer:u.layer,context:c,startAtId:l._uid,break:!1}))}}},{key:"getRenderContribution",value:function(t){var e;return e||(e=this.selectRenderByNumberType(t.numberType)),e||(e=this.selectRenderByType(t.type)),e}},{key:"renderItem",value:function(t,e,i){if(this.InterceptorContributions.length)for(var n=0;n<this.InterceptorContributions.length;n++){var r=this.InterceptorContributions[n];if(r.beforeDrawItem&&r.beforeDrawItem(t,this.currentRenderService,e,this,i))return}var o=this.getRenderContribution(t);if(o){var a,s=!1;if(t.parent){var l=t.parent.attribute,u=l.scrollX,c=void 0===u?0:u,h=l.scrollY,d=void 0===h?0:h;if(s=!(!c&&!d)){a=this.dirtyBounds.clone();var f=t.globalTransMatrix.getInverse();this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(f),this.dirtyBounds.translate(-c,-d)}}if(!this.useDirtyBounds||t.isContainer||Qe(t.AABBBounds,this.dirtyBounds,!1)){var p=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=p),p?t.isContainer&&o.draw(t,this.currentRenderService,e,i):o.draw(t,this.currentRenderService,e,i),s&&this.dirtyBounds.copy(a),this.InterceptorContributions.length)for(var v=0;v<this.InterceptorContributions.length;v++){var y=this.InterceptorContributions[v];if(y.afterDrawItem&&y.afterDrawItem(t,this.currentRenderService,e,this))return}}else s&&this.dirtyBounds.copy(a)}}},{key:"selectRenderByType",value:function(t){return gi.getInstance().warn("未知错误，不应该走到这里"),null}},{key:"selectRenderByNumberType",value:function(t){return this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}},{key:"clearScreen",value:function(t,e,i){var n,r,o=i.clear;if(o){var a=e.getCanvas(),s=i.width,l=void 0===s?a.width:s,u=i.height,c=void 0===u?a.height:u;e.clearRect(0,0,l,c);var h=null===(n=t.drawParams)||void 0===n?void 0:n.stage;if(h&&(e.globalAlpha=null!==(r=h.attribute.opacity)&&void 0!==r?r:1),h&&h.backgroundImg&&h.resources){var d=h.resources.get(o);d&&"success"===d.state&&d.data&&e.drawImage(d.data,0,0,l,c)}else e.fillStyle=Eg(e,o,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+c}},0,0),e.fillRect(0,0,l,c)}}},{key:"afterDraw",value:function(t,e){}}]),t}();Vb=jb([Ya(),Nb(0,Ua(P_)),Nb(1,Wa(cs)),Nb(1,Ka(Bb)),Hb("design:paramtypes",[Array,Object])],Vb);var Gb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Wb=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Ub=function(t,e){return function(i,n){e(i,n,t)}},Yb=function(){function t(e){jt(this,t),this.groupRenderContribitions=e,this.numberType=Wd}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l=gc(t,null==o?void 0:o.theme).group,u=t.attribute,c=u.fill,h=void 0===c?l.fill:c,d=u.background,f=u.stroke,p=void 0===f?l.stroke:f,v=u.opacity,y=void 0===v?l.opacity:v,g=u.width,m=void 0===g?l.width:g,_=u.height,b=void 0===_?l.height:_,x=u.clip,k=void 0===x?l.clip:x,S=u.fillOpacity,A=void 0===S?l.fillOpacity:S,w=u.strokeOpacity,T=void 0===w?l.strokeOpacity:w,M=u.cornerRadius,C=void 0===M?l.cornerRadius:M,E=u.path,R=void 0===E?l.path:E,P=u.lineWidth,L=void 0===P?l.lineWidth:P,O=u.visible,I=void 0===O?l.visible:O,D=wf(y,A,m,b,h),F=Mf(y,T,m,b),z=kf(h,d),j=Sf(p,L);if(t.valid&&I){if(!k){if(!z&&!j)return;if(!(D||F||a||s||d))return}if(R&&R.length&&r.drawContribution){var H=e.disableFill,N=e.disableStroke,V=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,R.forEach((function(t){r.drawContribution.getRenderContribution(t).draw(t,r.renderService,r,o)})),e.disableFill=H,e.disableStroke=N,e.disableBeginPath=V}else 0===C||B(C)&&C.every((function(t){return 0===t}))?(e.beginPath(),e.rect(i,n,m,b)):(e.beginPath(),qg(e,i,n,m,b,C));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(Xg));var G={doFill:z,doStroke:j};this._groupRenderContribitions.forEach((function(o){o.time===Ds.beforeFillStroke&&o.drawShape(t,e,i,n,z,j,D,F,l,r,a,s,G)})),k&&e.clip(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),G.doFill&&(a?a(e,t.attribute,l):D&&(e.setCommonStyle(t,t.attribute,i,n,l),e.fill())),G.doStroke&&(s?s(e,t.attribute,l):F&&(e.setStrokeStyle(t,t.attribute,i,n,l),e.stroke())),this._groupRenderContribitions.forEach((function(o){o.time===Ds.afterFillStroke&&o.drawShape(t,e,i,n,z,j,D,F,l,r,a,s)}))}}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r){var o=t.attribute.clip;o?r.save():r.highPerformanceSave();var a=gc(t,null==n?void 0:n.theme).group,s=r.modelMatrix;if(r.camera){var l=hg.allocate(),u=hg.allocate();mg(u,t,a),gg(l,s||l,u),r.modelMatrix=l,hg.free(u),r.setTransform(1,0,0,1,0,0,!0)}else r.transformFromMatrix(t.transMatrix,!0);r.beginPath(),n.skipDraw?this.drawShape(t,r,0,0,i,n,(function(){return!1}),(function(){return!1})):this.drawShape(t,r,0,0,i);var c,h=t.attribute,d=h.scrollX,f=void 0===d?a.scrollX:d,p=h.scrollY,v=void 0===p?a.scrollY:p;(f||v)&&r.translate(f,v),n&&n.drawingCb&&(c=n.drawingCb()),r.modelMatrix!==s&&hg.free(r.modelMatrix),r.modelMatrix=s,c&&c.then?c.then((function(){o?r.restore():r.highPerformanceRestore()})):o?r.restore():r.highPerformanceRestore()}}}]),t}();function Kb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Yb=Gb([Ya(),Ub(0,Wa(cs)),Ub(0,Ka(zf)),Wb("design:paramtypes",[Object])],Yb);var Xb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Zb=function(t){ue(i,t);var e=Kb(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).numberType=Yd,t}return zt(i,[{key:"drawShape",value:function(t,e,n,r,o,a,s,l){if(t.incremental&&o.multiGraphicOptions){var u=o.multiGraphicOptions,c=u.startAtIdx,h=u.length,d=t.attribute.segments,f=void 0===d?[]:d;if(c>f.length)return;var p=gc(t).line,v=t.attribute,y=v.fill,g=void 0===y?p.fill:y,m=v.stroke,_=void 0===m?p.stroke:m,b=v.opacity,x=void 0===b?p.opacity:b,k=v.fillOpacity,S=void 0===k?p.fillOpacity:k,A=v.strokeOpacity,w=void 0===A?p.strokeOpacity:A,T=v.lineWidth,M=void 0===T?p.lineWidth:T,C=v.visible,E=void 0===C?p.visible:C,R=Af(x,S,g),P=Tf(x,w),B=kf(g),L=Sf(_,M);if(!t.valid||!E)return;if(!B&&!L)return;if(!(R||P||s||l))return;for(var O=o.context,I=c;I<c+h;I++)this.drawIncreaseSegment(t,O,f[I-1],f[I],t.attribute.segments[I],[p,t.attribute],n,r)}else Xs(de(i.prototype),"drawShape",this).call(this,t,e,n,r,o,a,s,l)}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,o,a,s){n&&(e.beginPath(),function(t,e,i,n){var r=n||{},o=r.offsetX,a=void 0===o?0:o,s=r.offsetY,l=void 0===s?0:s,u=e?e.points[e.points.length-1]:i.points[0];t.moveTo(u.x+a,u.y+l),i.points.forEach((function(e){!1!==e.defined?t.lineTo(e.x+a,e.y+l):t.moveTo(e.x+a,e.y+l)}))}(e.nativeContext,i,n,{offsetX:a,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,o),e.setStrokeStyle(t,r,a,s,o),e.stroke())}}]),i}(Tm);function qb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Zb=Xb([Ya()],Zb);var Jb=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Qb=function(t){ue(i,t);var e=qb(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).numberType=Nd,t}return zt(i,[{key:"drawShape",value:function(t,e,n,r,o,a,s){if(t.incremental&&o.multiGraphicOptions){var l=o.multiGraphicOptions,u=l.startAtIdx,c=l.length,h=t.attribute.segments,d=void 0===h?[]:h;if(u>d.length)return;var f=gc(t).area,p=t.attribute,v=p.fill,y=void 0===v?f.fill:v,g=p.fillOpacity,m=void 0===g?f.fillOpacity:g,_=p.opacity,b=void 0===_?f.opacity:_,x=p.visible,k=void 0===x?f.visible:x,S=Af(b,m,y),A=kf(y);if(!t.valid||!k)return;if(!A)return;if(!S&&!s)return;for(var w=u;w<u+c;w++)this.drawIncreaseSegment(t,e,d[w-1],d[w],t.attribute.segments[w],[f,t.attribute],n,r)}else Xs(de(i.prototype),"drawShape",this).call(this,t,e,n,r,o,a,s)}},{key:"drawIncreaseSegment",value:function(t,e,i,n,r,o,a,s){n&&(e.beginPath(),function(t,e,i,n){for(var r=n||{},o=r.offsetX,a=void 0===o?0:o,s=r.offsetY,l=void 0===s?0:s,u=i.points,c=[],h=0;h<u.length;h++)u[h].defined;c.push(u),c.forEach((function(i,n){var r,o,s,u,c=e&&0===n?e.points[e.points.length-1]:i[0];t.moveTo(c.x+a,c.y+l),i.forEach((function(e){!1!==e.defined?t.lineTo(e.x+a,e.y+l):t.moveTo(e.x+a,e.y+l)}));for(var h=i.length-1;h>=0;h--){var d=i[h];t.lineTo(null!==(r=d.x1)&&void 0!==r?r:d.x,null!==(o=d.y1)&&void 0!==o?o:d.y)}t.lineTo(null!==(s=c.x1)&&void 0!==s?s:c.x,null!==(u=c.y1)&&void 0!==u?u:c.y),t.closePath()}))}(e.camera?e:e.nativeContext,i,n,{offsetX:a,offsetY:s}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,r,o),e.setCommonStyle(t,r,a,s,o),e.fill())}}]),i}(Dm);function $b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$b=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function tx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Qb=Jb([Ya()],Qb);var ex,ix=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},nx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rx=function(t,e){return function(i,n){e(i,n,t)}},ox=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};!function(t){t[t.NORMAL=0]="NORMAL",t[t.STOP=1]="STOP"}(ex||(ex={}));var ax=function(t){ue(i,t);var e=tx(i);function i(t,n,r,o){var a;return jt(this,i),(a=e.call(this,t,o)).contributions=t,a.lineRender=n,a.areaRender=r,a.drawItemInterceptorContributions=o,a.rendering=!1,a.currFrameStartAt=0,a.currentIdx=0,a.status=ex.NORMAL,a.checkingForDrawPromise=null,a.hooks={completeDraw:new vs([])},a.defaultRenderMap.set(a.lineRender.numberType,a.lineRender),a.defaultRenderMap.set(a.areaRender.numberType,a.areaRender),a}return zt(i,[{key:"draw",value:function(t,e){return ox(this,void 0,void 0,$b().mark((function i(){var n,r,o,a,s,l,u=this;return $b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.checkingForDrawPromise){i.next=2;break}return i.abrupt("return");case 2:return this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e),i.next=5,this.checkingForDrawPromise;case 5:if(n=i.sent,this.checkingForDrawPromise=null,!n){i.next=8;break}return i.abrupt("return");case 8:this.currentRenderService=t,r=e.context,o=e.x,a=void 0===o?0:o,s=e.y,l=void 0===s?0:s,r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(a,l,!0),r.save(),t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nl.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nl.zIndex)})).forEach((function(t){u.renderGroup(t,e)})),this.hooks.completeDraw.tap("top-draw",(function(){r.restore(),r.restore(),r.draw(),r.inuse=!1,u.rendering=!1})));case 11:case"end":return i.stop()}}),i,this)})))}},{key:"_increaseRender",value:function(t,e){return ox(this,void 0,void 0,$b().mark((function i(){return $b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.rendering=!0,i.next=3,this._renderIncrementalGroup(t,e);case 3:case"end":return i.stop()}}),i,this)})))}},{key:"_renderIncrementalGroup",value:function(t,e){return ox(this,void 0,void 0,$b().mark((function i(){var n=this;return $b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.count=t.count,i.next=3,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return ox(n,void 0,void 0,$b().mark((function n(){var r,o=this;return $b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(2===t.count){n.next=6;break}return n.next=3,Cb(t,Nl.zIndex,(function(i,n){if(o.status===ex.STOP)return!0;if(i.isContainer)return!1;if(n<o.currentIdx)return!1;var r=o.currFrameStartAt+t.incremental;return n<r&&(o.currentIdx=n+1,o.renderItem(i,e)),n===r-1&&(o.currFrameStartAt=o.currentIdx,o.waitToNextFrame())}));case 3:i(!1),n.next=21;break;case 6:if(!(r=t.getChildAt(0)).incremental||!r.attribute.segments){n.next=19;break}r.incrementalAt||(r.incrementalAt=0);case 9:if(!(r.incrementalAt<r.attribute.segments.length)){n.next=17;break}return e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,n.next=15,this.waitToNextFrame();case 15:n.next=9;break;case 17:n.next=20;break;case 19:this.renderItem(r,e);case 20:i(!1);case 21:case"end":return n.stop()}}),n,this)})))}})}));case 3:this.hooks.completeDraw.call();case 4:case"end":return i.stop()}}),i,this)})))}},{key:"waitToNextFrame",value:function(){return ox(this,void 0,void 0,$b().mark((function t(){var e=this;return $b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.global.getRequestAnimationFrame()((function(){t(!1)}))})));case 1:case"end":return t.stop()}}),t)})))}},{key:"checkForDraw",value:function(t){return ox(this,void 0,void 0,$b().mark((function e(){var i;return $b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.rendering,e.t0=t.restartIncremental,!e.t0){e.next=7;break}return i=!1,e.next=6,this.forceStop();case 6:this.resetToInit();case 7:return e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"forceStop",value:function(){return ox(this,void 0,void 0,$b().mark((function t(){var e=this;return $b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.rendering,!t.t0){t.next=5;break}return this.status=ex.STOP,t.next=5,new Promise((function(t){e.hooks.completeDraw.tap("stopCb",(function(){e.status=ex.NORMAL,e.hooks.completeDraw.taps=e.hooks.completeDraw.taps.filter((function(t){return"stopCb"!==t.name})),t(!1)}))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resetToInit",value:function(){this.currFrameStartAt=0,this.currentIdx=0}},{key:"renderGroup",value:function(t,e){return ox(this,void 0,void 0,$b().mark((function i(){var n=this;return $b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.break||!1===t.attribute.visibleAll){i.next=11;break}if(!t.incremental||e.startAtId!==t._uid){i.next=7;break}return i.next=4,this._increaseRender(t,e);case 4:i.t0=void(e.break=!0),i.next=10;break;case 7:return i.next=9,new Promise((function(i){n.renderItem(t,e,{drawingCb:function(){return ox(n,void 0,void 0,$b().mark((function n(){var r=this;return $b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Cb(t,Nl.zIndex,(function(t){return ox(r,void 0,void 0,$b().mark((function i(){return $b().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=e.break,i.t0){i.next=6;break}if(i.t1=t.isContainer,!i.t1){i.next=6;break}return i.next=6,this.renderGroup(t,e);case 6:case"end":return i.stop()}}),i,this)})))}));case 2:i(!1);case 3:case"end":return n.stop()}}),n)})))}})}));case 9:i.t0=void i.sent;case 10:return i.abrupt("return",i.t0);case 11:case"end":return i.stop()}}),i,this)})))}}]),i}(Vb);ax=ix([Ya(),rx(0,Ua(P_)),rx(1,Wa(Zb)),rx(2,Wa(Qb)),rx(3,Wa(cs)),rx(3,Ka(Bb)),nx("design:paramtypes",[Array,Object,Object,Object])],ax);var sx=new La((function(t){t(Lg).toSelf().inSingletonScope(),t(Dg).toSelf().inSingletonScope(),t(W_).to(Vb),t(T_).to(ax),t(B_).to(Yb).inSingletonScope(),t(P_).toService(B_),ds(t,zf),t(Ig).toSelf().inSingletonScope(),ds(t,Uf),ds(t,P_),t(Db).toSelf().inSingletonScope(),t(Bb).toService(Db),ds(t,Bb)}));function lx(){lx.__loaded||(lx.__loaded=!0,_u.load(xf),_u.load(ob),_u.load(q_),_u.load(rb),_u.load(db),function(t){t.load(fb),t.load(pb),t.load(Ab)}(_u),function(t){t.load(sx)}(_u))}lx.__loaded=!1,lx();var ux=_u.get(gs);nu.global=ux;var cx=_u.get(ff);nu.graphicUtil=cx;var hx=_u.get(df);nu.transformUtil=hx;var dx=_u.get(ef);nu.graphicService=dx;var fx=_u.get(pf);nu.layerService=fx;var px=function(){function t(){jt(this,t),this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid}return zt(t,[{key:"activate",value:function(t){this.pluginService=t,nu.graphicService.hooks.onAttributeUpdate.tap(this.key,(function(e){e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&e.stage.renderNextFrame()})),nu.graphicService.hooks.onSetStage.tap(this.key,(function(e){e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&e.stage.renderNextFrame()}))}},{key:"deactivate",value:function(t){var e=this;nu.graphicService.hooks.onAttributeUpdate.taps=nu.graphicService.hooks.onAttributeUpdate.taps.filter((function(t){return t.name!==e.key})),nu.graphicService.hooks.onSetStage.taps=nu.graphicService.hooks.onSetStage.taps.filter((function(t){return t.name!==e.key}))}}]),t}(),vx=function(){function t(){var e=this;jt(this,t),this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!0,e.pageX=t.page.x,e.pageY=t.page.y)},this.onMouseUp=function(t){e.option3d||(e.option3d=e.pluginService.stage.option3d),e.option3d&&(e.mousedown=!1)},this.onMouseMove=function(t){var i,n,r=e.pluginService.stage;if(e.option3d||(e.option3d=r.option3d),e.option3d&&e.mousedown)if(e.pageX&&e.pageY){var o=t.page.x-e.pageX,a=t.page.y-e.pageY;e.pageX=t.page.x,e.pageY=t.page.y;var s=o/100,l=a/100;e.option3d.alpha=(null!==(i=e.option3d.alpha)&&void 0!==i?i:0)+s,e.option3d.beta=(null!==(n=e.option3d.beta)&&void 0!==n?n:0)+l,r.set3dOptions(e.option3d),r.renderNextFrame()}else e.pageX=t.page.x,e.pageY=t.page.y}}return zt(t,[{key:"activate",value:function(t){this.pluginService=t;var e=t.stage;this.option3d=e.option3d,e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.onMouseMove)}},{key:"deactivate",value:function(t){var e=t.stage;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("mousemove",this.onMouseMove)}}]),t}(),yx=function(){function t(){jt(this,t),this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid}return zt(t,[{key:"activate",value:function(t){var e=this;this.pluginService=t,nu.graphicService.hooks.onAddIncremental.tap(this.key,(function(i,n,r){i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=n._uid,e.renderNextFrame(n))})),nu.graphicService.hooks.onClearIncremental.tap(this.key,(function(i,n){i.stage===t.stage&&null!=i.stage&&(e.nextUserParams.startAtId=i._uid,e.nextUserParams.restartIncremental=!0,e.renderNextFrame(i))}))}},{key:"deactivate",value:function(t){var e=this;nu.graphicService.hooks.onAddIncremental.taps=nu.graphicService.hooks.onAddIncremental.taps.filter((function(t){return t.name!==e.key})),nu.graphicService.hooks.onClearIncremental.taps=nu.graphicService.hooks.onClearIncremental.taps.filter((function(t){return t.name!==e.key}))}},{key:"renderNextFrame",value:function(t){var e=this;this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,nu.global.getRequestAnimationFrame()((function(){e._doRenderInThisFrame(),e.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){var t=this,e=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach((function(i){var n=i.layer;if(n&&i.layer.subLayers){var r=i.layer.subLayers.get(i._uid);r&&r.drawContribution&&r.drawContribution.draw(e.renderService,Object.assign({x:e.x,y:e.y,width:n.viewWidth,height:n.viewHeight,stage:e,layer:n,clear:"transparent",renderService:e.renderService,updateBounds:!1,startAtId:i._uid,context:r.layer.getNativeHandler().getContext()},t.nextUserParams))}})),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}]),t}(),gx=function(){function t(){jt(this,t),this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid}return zt(t,[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(i){i&&i===e.pluginService.stage&&e.drawHTML(t.stage.renderService)})),nu.graphicService.hooks.onRelease.tap(this.key,(function(t){e.removeDom(t)}))}},{key:"deactivate",value:function(t){var e=this;t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key}))}},{key:"drawHTML",value:function(t){var e=this;"browser"===nu.global.env&&t.renderTreeRoots.sort((function(t,e){var i,n;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:Nl.zIndex)-(null!==(n=e.attribute.zIndex)&&void 0!==n?n:Nl.zIndex)})).forEach((function(t){e.renderGroupHTML(t)}))}},{key:"renderGroupHTML",value:function(t){var e=this;this.renderGraphicHTML(t),t.forEachChildren((function(t){t.isContainer?e.renderGroupHTML(t):e.renderGraphicHTML(t)}))}},{key:"removeDom",value:function(t){t.bindDom&&t.bindDom.size&&(t.bindDom.forEach((function(t){t.dom&&t.dom.parentElement.removeChild(t.dom)})),t.bindDom.clear())}},{key:"renderGraphicHTML",value:function(t){var e=t.attribute.html;if(e){var i=t.stage;if(i){var n=e.dom,r=e.container,o=e.width,a=e.height,s=e.style,l=e.anchorType,u=void 0===l?"boundsLeftTop":l;t.bindDom||(t.bindDom=new Map);var c=t.bindDom.get(n);if(!c||r&&r!==c.container){var h,d;t.bindDom.forEach((function(t){var e=t.wrapGroup;nu.global.removeDom(e)})),"string"==typeof n?(h=(new DOMParser).parseFromString(n,"text/html").firstChild).lastChild&&(h=h.lastChild.firstChild):h=n;var f=r||(!0===i.params.enableHtmlAttribute?null:i.params.enableHtmlAttribute);d=f?"string"==typeof f?nu.global.getElementById(f):f:t.stage.window.getContainer();var p=nu.global.createDom({tagName:"div",width:o,height:a,style:s,parent:d});p&&(p.appendChild(h),t.bindDom.set(n,{dom:h,container:r,wrapGroup:p})),p.style.pointerEvents="none",p.style.position||(p.style.position="absolute",d.style.position="relative");var v=0,y=0,g=t.globalAABBBounds;if("position"===u||g.empty()){var m=t.globalTransMatrix;v=m.e,y=m.f}else v=g.x1,y=g.y1;var _=nu.global.getElementTopLeft(d,!1),b=i.window.getTopLeft(!1),x=v+b.left-_.left,k=y+b.top-_.top;p.style.left="".concat(x,"px"),p.style.top="".concat(k,"px")}}}else t.bindDom&&t.bindDom.size&&(t.bindDom.forEach((function(t){t.dom&&t.dom.parentElement.removeChild(t.dom)})),t.bindDom.clear())}}]),t}(),mx=new ye,_x=function(){function t(){jt(this,t),this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid}return zt(t,[{key:"activate",value:function(t){var e=this;this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,(function(t){t&&t===e.pluginService.stage&&t.dirtyBounds.clear()})),nu.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(function(t,i,n,r){t.glyphHost&&(t=t.glyphHost),i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||n&&(mx.setValue(r.x1,r.y1,r.x2,r.y2),i.dirty(mx,t.parent&&t.parent.globalTransMatrix)))})),nu.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(function(t,i,n,r,o){i&&i===e.pluginService.stage&&i.renderCount&&(t.isContainer&&!o||i.dirty(r.globalAABBBounds))})),nu.graphicService.hooks.onRemove.tap(this.key,(function(t){var i=t.stage;i&&i===e.pluginService.stage&&i.renderCount&&i&&i.dirty(t.globalAABBBounds)}))}},{key:"deactivate",value:function(t){var e=this;nu.graphicService.hooks.beforeUpdateAABBBounds.taps=nu.graphicService.hooks.beforeUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),nu.graphicService.hooks.afterUpdateAABBBounds.taps=nu.graphicService.hooks.afterUpdateAABBBounds.taps.filter((function(t){return t.name!==e.key})),t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter((function(t){return t.name!==e.key})),nu.graphicService.hooks.onRemove.taps=nu.graphicService.hooks.onRemove.taps.filter((function(t){return t.name!==e.key}))}}]),t}(),bx=new ye,xx=function(){function t(){jt(this,t),this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=Ba.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new ye}return zt(t,[{key:"tryLayout",value:function(t){var e=this;if(!this.layouting){this.layouting=!0;var i=t.parent;if(i&&t.needUpdateLayout()){var n=gc(i).group,r=i.attribute.display;if("flex"===(void 0===r?n.display:r)){var o=i.attribute,a=o.flexDirection,s=void 0===a?n.flexDirection:a,l=o.flexWrap,u=void 0===l?n.flexWrap:l,c=o.justifyContent,h=void 0===c?n.justifyContent:c,d=o.alignItems,f=void 0===d?n.alignItems:d,p=o.alignContent,v=void 0===p?n.alignContent:p,y=o.clip,g=void 0===y?n.clip:y,m=0,_=0,b=0;if(i.forEachChildren((function(t){var e=t.AABBBounds;"column"===s||"column-reverse"===s?(_+=e.height(),m=Math.max(m,e.width())):(m+=e.width(),_=Math.max(_,e.height())),b+=e.x1,b+=e.y1,b+=e.x2,b+=e.y2})),isFinite(b)){var x=i.attribute.width||m,k=i.attribute.height||_;i.attribute.width||(i.attribute.width=0),i.attribute.height||(i.attribute.height=0),this.tempBounds.copy(i._AABBBounds);var S={main:{len:x,field:"x"},cross:{len:k,field:"y"},dir:1},A=S.main,w=S.cross;"row-reverse"===s?S.dir=-1:"column"===s?(A.len=k,w.len=x,A.field="y",w.field="x"):"column-reverse"===s&&(A.len=k,w.len=x,A.field="y",w.field="x",S.dir=-1);var T=0,M=0,C=[];i.forEachChildren((function(t){var e=t.AABBBounds,i="x"===A.field?e.width():e.height(),n="x"===w.field?e.width():e.height();C.push({mainLen:i,crossLen:n}),T+=i,M=Math.max(M,n)}));var E=[];if(T>A.len&&"wrap"===u){var R=0,P=0;C.forEach((function(t,e){var i=t.mainLen,n=t.crossLen;R+i>A.len?0===R?(E.push({idx:e,mainLen:R+i,crossLen:n}),R=0,P=0):(E.push({idx:e-1,mainLen:R,crossLen:n}),R=i,P=n):(R+=i,P=Math.max(P,n))})),E.push({idx:C.length-1,mainLen:R,crossLen:P})}else E.push({idx:C.length-1,mainLen:T,crossLen:M});var B=i.getChildren(),L=0;if(E.forEach((function(t){e.layoutMain(i,B,h,A,C,L,t),L=t.idx+1})),M=E.reduce((function(t,e){return t+e.crossLen}),0),1===E.length)if("flex-end"===f){var O=w.len;this.layoutCross(B,f,w,O,C,E[0],0)}else if("center"===f){var I=w.len/2;this.layoutCross(B,f,w,I,C,E[0],0)}else B.forEach((function(t){t.attribute[w.field]=kx(t,w.field)}));else if("flex-start"===v){L=0;var D=0;E.forEach((function(t,i){e.layoutCross(B,"flex-start",w,D,C,E[i],L),L=t.idx+1,D+=t.crossLen}))}else if("center"===v){L=0;var F=Math.max(0,(w.len-M)/2);E.forEach((function(t,i){e.layoutCross(B,"center",w,F+t.crossLen/2,C,E[i],L),L=t.idx+1,F+=t.crossLen}))}else if("space-around"===v){L=0;var z=Math.max(0,(w.len-M)/E.length/2),j=z;E.forEach((function(t,i){e.layoutCross(B,"flex-start",w,j,C,E[i],L),L=t.idx+1,j+=t.crossLen+2*z}))}else if("space-between"===v){L=0;var H=Math.max(0,(w.len-M)/(2*E.length-2)),N=0;E.forEach((function(t,i){e.layoutCross(B,"flex-start",w,N,C,E[i],L),L=t.idx+1,N+=t.crossLen+2*H}))}B.forEach((function(t,e){t.addUpdateBoundTag(),t.addUpdatePositionTag(),t.clearUpdateLayoutTag()})),i.addUpdateLayoutTag(),g||this.tempBounds.equals(i.AABBBounds)||(this.tryLayout(i),this.layouting=!1)}}}}}},{key:"layoutMain",value:function(t,e,i,n,r,o,a){if("flex-start"===i)for(var s=0,l=o;l<=a.idx;l++)e[l].attribute[n.field]=s+kx(e[l],n.field),s+=r[l].mainLen;else if("flex-end"===i)for(var u=n.len,c=o;c<=a.idx;c++)u-=r[c].mainLen,e[c].attribute[n.field]=u+kx(e[c],n.field);else if("space-around"===i)if(a.mainLen>=n.len)for(var h=0,d=o;d<=a.idx;d++)e[d].attribute[n.field]=h+kx(e[d],n.field),h+=r[d].mainLen;else for(var f=a.idx-o+1,p=(n.len-a.mainLen)/f/2,v=p,y=o;y<=a.idx;y++)e[y].attribute[n.field]=v+kx(e[y],n.field),v+=r[y].mainLen+2*p;else if("space-between"===i)if(a.mainLen>=n.len)for(var g=0,m=o;m<=a.idx;m++)e[m].attribute[n.field]=g+kx(e[m],n.field),g+=r[m].mainLen;else for(var _=a.idx-o+1,b=(n.len-a.mainLen)/(2*_-2),x=0,k=o;k<=a.idx;k++)e[k].attribute[n.field]=x+kx(e[k],n.field),x+=r[k].mainLen+2*b;else if("center"===i)for(var S=(n.len-a.mainLen)/2,A=o;A<=a.idx;A++)e[A].attribute[n.field]=S+kx(e[A],n.field),S+=r[A].mainLen}},{key:"layoutCross",value:function(t,e,i,n,r,o,a){if("flex-end"===e)for(var s=a;s<=o.idx;s++)t[s].attribute[i.field]=n-r[s].crossLen+kx(t[s],i.field);else if("center"===e)for(var l=a;l<=o.idx;l++)t[l].attribute[i.field]=n-r[l].crossLen/2+kx(t[l],i.field);else for(var u=a;u<=o.idx;u++)t[u].attribute[i.field]=n+kx(t[u],i.field)}},{key:"activate",value:function(t){var e=this;this.pluginService=t,nu.graphicService.hooks.onAttributeUpdate.tap(this.key,(function(t){t.glyphHost&&(t=t.glyphHost),e.tryLayout(t),e.layouting=!1})),nu.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(function(t,i,n,r){t.glyphHost&&(t=t.glyphHost),i&&i===e.pluginService.stage&&t.isContainer&&bx.copy(r)})),nu.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(function(t,i,n,r,o){i&&i===e.pluginService.stage&&t.isContainer&&(bx.equals(n)||(e.tryLayout(t),e.layouting=!1))})),nu.graphicService.hooks.onSetStage.tap(this.key,(function(t){t.glyphHost&&(t=t.glyphHost),e.tryLayout(t),e.layouting=!1}))}},{key:"deactivate",value:function(t){var e=this;nu.graphicService.hooks.onAttributeUpdate.taps=nu.graphicService.hooks.onAttributeUpdate.taps.filter((function(t){return t.name!==e.key})),nu.graphicService.hooks.onSetStage.taps=nu.graphicService.hooks.onSetStage.taps.filter((function(t){return t.name!==e.key}))}}]),t}();function kx(t,e){if(!t.attribute.boundsPadding)return 0;if("number"==typeof(i=t.attribute.boundsPadding)&&Number.isFinite(i))return t.attribute.boundsPadding;var i;if(B(t.attribute.boundsPadding)&&1===t.attribute.boundsPadding.length)return t.attribute.boundsPadding[0];var n=rh(t.attribute.boundsPadding);return"x"===e?n[3]:"y"===e?n[0]:0}var Sx=new Nc;Sx.addTimeline(Wc),Sx.setFPS(60);var Ax=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;jt(this,t),this.dir=e,this.color=i,this.colorRgb=Vh.Get(i,zh.Color1),this.ambient=n;var r=Jt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.formatedDir=[e[0]/r,e[1]/r,e[2]/r]}return zt(t,[{key:"computeColor",value:function(t,e){var i,n=this.formatedDir,r=Zt(Xt((t[0]*n[0]+t[1]*n[1]+t[2]*n[2])*(1-this.ambient/2),0)+this.ambient,1);i=P(e)?Vh.Get(e,zh.Color1):e;var o=this.colorRgb;return"rgb(".concat(o[0]*i[0]*r,", ").concat(o[1]*i[1]*r,", ").concat(o[2]*i[2]*r,")")}}]),t}();function Tx(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],v=e[12],y=e[13],g=e[14],m=e[15],_=i[0],b=i[1],x=i[2],k=i[3];return t[0]=_*n+b*s+x*h+k*v,t[1]=_*r+b*l+x*d+k*y,t[2]=_*o+b*u+x*f+k*g,t[3]=_*a+b*c+x*p+k*m,_=i[4],b=i[5],x=i[6],k=i[7],t[4]=_*n+b*s+x*h+k*v,t[5]=_*r+b*l+x*d+k*y,t[6]=_*o+b*u+x*f+k*g,t[7]=_*a+b*c+x*p+k*m,_=i[8],b=i[9],x=i[10],k=i[11],t[8]=_*n+b*s+x*h+k*v,t[9]=_*r+b*l+x*d+k*y,t[10]=_*o+b*u+x*f+k*g,t[11]=_*a+b*c+x*p+k*m,_=i[12],b=i[13],x=i[14],k=i[15],t[12]=_*n+b*s+x*h+k*v,t[13]=_*r+b*l+x*d+k*y,t[14]=_*o+b*u+x*f+k*g,t[15]=_*a+b*c+x*p+k*m,t}function Mx(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[3]*n+i[7]*r+i[11]*o+i[15];return a=a||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/a,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/a,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/a,t}var Cx,Ex=function(){function t(e){jt(this,t),this.params=e}return zt(t,[{key:"params",get:function(){return Object.assign({},this._params)},set:function(t){this._params=Object.assign({},t),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}},{key:"getViewMatrix",value:function(){return this._viewMatrixCached||(this._viewMatrixCached=hg.allocate()),this._viewMatrixCached}},{key:"forceGetViewMatrix",value:function(){this._viewMatrixCached||(this._viewMatrixCached=hg.allocate());var t=this.params.viewParams,e=t.pos,i=t.center,n=t.up;return function(t,e,i,n){var r,o,a,s,l,u,c,h,d,f,p=e[0],v=e[1],y=e[2],g=n[0],m=n[1],_=n[2],b=i[0],x=i[1],k=i[2];Math.abs(p-b)<Ht&&Math.abs(v-x)<Ht&&Math.abs(y-k)<Ht?ug.identity(t):(c=p-b,h=v-x,d=y-k,r=m*(d*=f=1/Math.hypot(c,h,d))-_*(h*=f),o=_*(c*=f)-g*d,a=g*h-m*c,(f=Math.hypot(r,o,a))?(r*=f=1/f,o*=f,a*=f):(r=0,o=0,a=0),s=h*a-d*o,l=d*r-c*a,u=c*o-h*r,(f=Math.hypot(s,l,u))?(s*=f=1/f,l*=f,u*=f):(s=0,l=0,u=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=u,t[10]=d,t[11]=0,t[12]=-(r*p+o*v+a*y),t[13]=-(s*p+l*v+u*y),t[14]=-(c*p+h*v+d*y),t[15]=1)}(this._viewMatrixCached,e,i,n),this._vp||(this._vp=hg.allocate()),this._vp=Tx(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}},{key:"getProjectionMatrix",value:function(){return this._projectionMatrixCached||(this._projectionMatrixCached=hg.allocate()),this._projectionMatrixCached}},{key:"forceGetProjectionMatrix",value:function(){this._projectionMatrixCached||(this._projectionMatrixCached=hg.allocate());var t=this._params,e=t.left,i=t.top,n=t.right,r=t.bottom;return function(t,e,i,n,r,o,a){var s=1/(e-i),l=1/(n-r),u=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*u,t[15]=1}(this._projectionMatrixCached,e,n,r,i,0,-2e6),this._vp||(this._vp=hg.allocate()),this._vp=Tx(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}},{key:"getField",value:function(){var t=this._params,e=t.fieldRatio,i=void 0===e?.8:e,n=t.fieldDepth,r=t.left,o=t.right;return(null!=n?n:o-r)*i}},{key:"getProjectionScale",value:function(t){var e=this.getField();return e/(e+t)}},{key:"view",value:function(t,e,i){var n=[0,0,0];return Mx(n,[t,e,i],this._viewMatrixCached),n}},{key:"vp",value:function(t,e,i){var n=[0,0,0],r=this._params.viewParams.pos;Mx(n,[t,e,i],this._viewMatrixCached),t=n[0],e=n[1],i=n[2];var o=this.getProjectionScale(i);return{x:t*o+r[0],y:e*o+r[1]}}}]),t}();function Rx(){!function(){if(null==Cx)try{(Cx=globalThis===window)&&(Cx=!!document.createElement)}catch(t){Cx=!1}}();var t=nu.global&&nu.global.env;return t?"browser"===t:Cx}function Px(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Bx="white",Lx=function(t){ue(n,t);var e=Px(n);function n(){var t,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jt(this,n),(t=e.call(this,{}))._onVisibleChange=function(e){t._skipRender<0||(e?(t.dirtyBounds&&t.dirtyBounds.setValue(0,0,t._viewBox.width(),t._viewBox.height()),t._skipRender>1&&t.renderNextFrame(),t._skipRender=0):t._skipRender=1)},t.beforeRender=function(e){t._beforeRender&&t._beforeRender(e)},t.afterRender=function(e){t.renderCount++,t._afterRender&&t._afterRender(e),t._afterNextRenderCbs&&t._afterNextRenderCbs.forEach((function(t){return t(e)})),t._afterNextRenderCbs=null},t.params=r,t.theme=new vc,t.hooks={beforeRender:new vs(["stage"]),afterRender:new vs(["stage"])},t.global=nu.global,!t.global.env&&Rx()&&t.global.setEnv("browser"),t.window=_u.get(ec),t.renderService=_u.get(X_),t.pluginService=_u.get(sb),t.layerService=_u.get(pf),t.pluginService.active(ce(t),r),t.window.create({width:r.width,height:r.height,container:r.container,dpr:r.dpr||t.global.devicePixelRatio,canvasControled:!1!==r.canvasControled,title:r.title||"",canvas:r.canvas}),t._viewBox=new ye,r.viewBox?t._viewBox.setValue(r.viewBox.x1,r.viewBox.y1,r.viewBox.x2,r.viewBox.y2):t._viewBox.setValue(0,0,t.width,t.height),t.state="normal",t.renderCount=0,t.tryInitEventSystem(),t._subView=!(t._viewBox.width()===t.width&&t._viewBox.height()===t.height),t._background=null!==(i=r.background)&&void 0!==i?i:Bx,t.appendChild(t.layerService.createLayer(ce(t),{main:!0})),t.nextFrameRenderLayerSet=new Set,t.willNextFrameRender=!1,t.stage=ce(t),t.renderStyle=r.renderStyle,r.autoRender&&t.enableAutoRender(),!1===r.disableDirtyBounds&&t.enableDirtyBounds(),r.enableHtmlAttribute&&t.enableHtmlAttribute(r.enableHtmlAttribute),r.enableLayout&&t.enableLayout(),t.hooks.beforeRender.tap("constructor",t.beforeRender),t.hooks.afterRender.tap("constructor",t.afterRender),t._beforeRender=r.beforeRender,t._afterRender=r.afterRender,t.ticker=r.ticker||Sx,t.supportInteractiveLayer=!1!==r.interactiveLayer,t.timeline=new Gc,t.ticker.addTimeline(t.timeline),t.timeline.pause(),r.optimize||(r.optimize={}),t.optmize(r.optimize),r.background&&P(t._background)&&t._background.includes("/")&&t.setAttributes({background:t._background}),t}return zt(n,[{key:"viewBox",get:function(){return this._viewBox},set:function(t){this._viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}},{key:"x",get:function(){return this._viewBox.x1},set:function(t){this._viewBox.translate(t-this._viewBox.x1,0)}},{key:"y",get:function(){return this._viewBox.y1},set:function(t){this._viewBox.translate(0,t-this._viewBox.y1)}},{key:"width",get:function(){return this.window.width},set:function(t){this.resize(t,this.height)}},{key:"viewWidth",get:function(){return this._viewBox.width()},set:function(t){this.resizeView(t,this.viewHeight)}},{key:"viewHeight",get:function(){return this._viewBox.height()},set:function(t){this.resizeView(this.viewWidth,t)}},{key:"height",get:function(){return this.window.height},set:function(t){this.resize(this.width,t)}},{key:"dpr",get:function(){return this.window.dpr},set:function(t){this.setDpr(t)}},{key:"background",get:function(){var t;return null!==(t=this._background)&&void 0!==t?t:Bx},set:function(t){this._background=t}},{key:"defaultLayer",get:function(){return this.at(0)}},{key:"eventSystem",get:function(){return this._eventSystem}},{key:"tryInitEventSystem",value:function(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new Fc(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents,viewport:{viewBox:this._viewBox,get x(){return this.viewBox.x1},get y(){return this.viewBox.y1},get width(){return this.viewBox.width()},get height(){return this.viewBox.height()}}},this.params.event)))}},{key:"preventRender",value:function(t){t?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}},{key:"optmize",value:function(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}},{key:"optmizeRender",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}},{key:"getTimeline",value:function(){return this.timeline}},{key:"get3dOptions",value:function(t){var e=t.center,i=void 0===e?{x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0}:e,n=t.light,r=void 0===n?{}:n,o=t.alpha,a=void 0===o?0:o,s=t.beta,l=void 0===s?0:s,u=t.camera,c=t.fieldRatio,h=void 0===c?1:c,d=t.fieldDepth;return Object.assign(Object.assign({},t),{center:i,light:r,alpha:a,beta:l,camera:u,fieldRatio:h,fieldDepth:d})}},{key:"set3dOptions",value:function(t){var e,i,n,r,o,a;this.option3d=t;var s=this.get3dOptions(t),l=s.light,u=s.center,c=s.camera,h=s.alpha,d=s.beta,f=s.fieldRatio,p=s.fieldDepth,v=l.dir,y=void 0===v?[1,1,-1]:v,g=l.color,m=void 0===g?"white":g,_=l.ambient,b=(null!==(e=u.x)&&void 0!==e?e:this.width/2)+(null!==(i=u.dx)&&void 0!==i?i:0),x=(null!==(n=u.y)&&void 0!==n?n:this.height/2)+(null!==(r=u.dy)&&void 0!==r?r:0),k=[b,x,(null!==(o=u.z)&&void 0!==o?o:0)+(null!==(a=u.dz)&&void 0!==a?a:0)],S=0,A=0,w=0;c||(S=Math.sin(h)+b,A=Math.sin(d)+x,w=Math.cos(h)*Math.cos(d)*1),this.light=new Ax(y,m,_);var T={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:f,fieldDepth:p,viewParams:{pos:[S,A,w],center:k,up:[0,1,0]}};this.camera?this.camera.params=T:this.camera=new Ex(T),t.enableView3dTransform&&this.enableView3dTransform()}},{key:"setBeforeRender",value:function(t){this._beforeRender=t}},{key:"setAfterRender",value:function(t){this._afterRender=t}},{key:"afterNextRender",value:function(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}},{key:"enableView3dTransform",value:function(){this.view3dTranform||(this.view3dTranform=!0,this.pluginService.register(new vx))}},{key:"disableView3dTranform",value:function(){var t=this;this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableAutoRender",value:function(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new px))}},{key:"disableAutoRender",value:function(){var t=this;this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableIncrementalAutoRender",value:function(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new yx))}},{key:"disableIncrementalAutoRender",value:function(){var t=this;this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableDirtyBounds",value:function(){if(!this.dirtyBounds){this.dirtyBounds=new ve;var t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new _x,this.pluginService.register(t))}}},{key:"disableDirtyBounds",value:function(){var t=this;this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableLayout",value:function(){this._enableLayout||(this._enableLayout=!0,this.pluginService.register(new xx))}},{key:"disableLayout",value:function(){var t=this;this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"enableHtmlAttribute",value:function(t){this.htmlAttribute||(this.htmlAttribute=t,this.pluginService.register(new gx))}},{key:"disableHtmlAttribute",value:function(){var t=this;this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach((function(e){t.pluginService.unRegister(e)})))}},{key:"tryUpdateAABBBounds",value:function(){var t=this._viewBox;return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}},{key:"combineLayer",value:function(t,e){throw new Error("暂不支持")}},{key:"createLayer",value:function(t,e){var i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}},{key:"sortLayer",value:function(t){var e=this,i=this.children;i.sort(t),this.removeAllChild(),i.forEach((function(t){e.appendChild(t)}))}},{key:"removeLayer",value:function(t){return this.removeChild(this.findChildByUid(t))}},{key:"tryInitInteractiveLayer",value:function(){this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}},{key:"clearViewBox",value:function(t){this.window.clearViewBox(this._viewBox,t)}},{key:"render",value:function(t,e){this.ticker.start(),this.timeline.resume();var i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear(),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}},{key:"combineLayersToWindow",value:function(){}},{key:"renderNextFrame",value:function(t,e){var i=this;this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach((function(t){i.nextFrameRenderLayerSet.add(t)})),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()((function(){i._doRenderInThisFrame(),i.willNextFrameRender=!1})))}},{key:"_doRenderInThisFrame",value:function(){this.timeline.resume(),this.ticker.start();var t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.hooks.afterRender.call(this),this.nextFrameRenderLayerSet.clear()),this.state=t,this._skipRender&&this._skipRender++}},{key:"renderLayerList",value:function(t,e){for(var i=this,n=[],r=0;r<t.length;r++){var o=t[r];"virtual"===o.layerMode&&(o=o.getNativeHandler().mainHandler.layer),n.includes(o)||n.push(o)}n.forEach((function(t){t.renderCount>i.renderCount||(t.renderCount=i.renderCount+1,t.render({renderService:i.renderService,background:t===i.defaultLayer?i.background:void 0,updateBounds:!(!i.dirtyBounds||i.dirtyBounds.empty())},Object.assign({renderStyle:i.renderStyle},e)))})),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())},Object.assign({renderStyle:this.renderStyle},e))}},{key:"resizeWindow",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.window.resize(t,e),i&&this.render()}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.window.resize(t,e),this.forEachChildren((function(i){i.resize(t,e)})),this._subView||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render()}},{key:"resizeView",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren((function(i){i.resizeView(t,e)})),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render()}},{key:"setViewBox",value:function(t,e,n,r,o){var a=this,s=!0;"object"==i(t)?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(s=!1)):(this.viewBox.setValue(t,e,t+n,e+r),!1===o&&(s=!1)),this.forEachChildren((function(t){t.resizeView(a.viewBox.width(),a.viewBox.height())})),s&&this.render()}},{key:"setDpr",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.forEachChildren((function(e){e.setDpr(t)})),e&&this.render()}},{key:"setOrigin",value:function(t,e){throw new Error("暂不支持")}},{key:"export",value:function(t){throw new Error("暂不支持")}},{key:"pick",value:function(t,e){this.pickerService||(this.pickerService=_u.get(J_));var i=this.pickerService.pick(this.children,new ae(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}},{key:"startAnimate",value:function(t){throw new Error("暂不支持")}},{key:"setToFrame",value:function(t){throw new Error("暂不支持")}},{key:"release",value:function(){Xs(de(n.prototype),"release",this).call(this),this.eventSystem&&this.eventSystem.release(),this.pluginService.release(),this.forEach((function(t){t.release()})),this.interactiveLayer&&this.interactiveLayer.release(),this.window.release()}},{key:"setStage",value:function(t){}},{key:"dirty",value:function(t,e){e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t)}},{key:"getLayer",value:function(t){return this.children.filter((function(e){return e.name===t}))[0]}},{key:"renderTo",value:function(t,e){var i=this;this.forEachChildren((function(n,r){n.drawTo(t,Object.assign(Object.assign({},e),{renderService:i.renderService,background:n===i.defaultLayer?i.background:void 0,clear:0===r,updateBounds:!(!i.dirtyBounds||i.dirtyBounds.empty())}))}))}},{key:"renderToNewWindow",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,i=_u.get(ec);if(t)i.create({width:this.viewWidth,height:this.viewHeight,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""});else{var n=e?e.width():Math.min(this.viewWidth,this.window.width-this.x),r=e?e.height():Math.min(this.viewHeight,this.window.height-this.y);i.create({width:n,height:r,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""})}var o=e?-e.x1:0,a=e?-e.y1:0;return this.renderTo(i,{x:o,y:a,width:e?e.x2:i.width,height:e?e.y2:i.height}),i}},{key:"toCanvas",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}},{key:"setCursor",value:function(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}},{key:"getCursor",value:function(){return this._cursor}}]),n}(sf);var Ox=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Ix=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Dx=new ke(1,0,0,1,0,0),Fx={x:0,y:0},zx=function(){function t(e,i){jt(this,t),this.matrix=new ke(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new ke(1,0,0,1,0,0),this.path=new Pl}return zt(t,[{key:"nativeContext",get:function(){return this.path}},{key:"getCanvas",value:function(){throw new Error("不支持getCanvas")}},{key:"getContext",value:function(){throw new Error("不支持getContext")}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return cg.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.restore()}},{key:"restore",value:function(){this.stack.length>0&&(cg.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(cg.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,o){var a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*o),a&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,o){var a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,o),a&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.path.clear()}},{key:"clip",value:function(t,e){}},{key:"arc",value:function(t,e,i,n,r,o){this.path.arc(t,e,i,n,r,o)}},{key:"arcTo",value:function(t,e,i,n,r){this.path.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,o){this.path.bezierCurveTo(t,e,i,n,r,o)}},{key:"closePath",value:function(){this.path.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,o,a,s){}},{key:"lineTo",value:function(t,e){this.path.lineTo(t,e)}},{key:"moveTo",value:function(t,e){this.path.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.path.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"createImageData",value:function(t,e){return null}},{key:"createLinearGradient",value:function(t,e,i,n){throw new Error("不支持createLinearGradient")}},{key:"createPattern",value:function(t,e){throw new Error("不支持createPattern")}},{key:"createRadialGradient",value:function(t,e,i,n,r,o){throw new Error("不支持createRadialGradient")}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"fill",value:function(t,e){}},{key:"fillRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){}},{key:"fillText",value:function(t,e,i){}},{key:"getImageData",value:function(t,e,i,n){return null}},{key:"getLineDash",value:function(){return[]}},{key:"isPointInPath",value:function(t,e){return this.matrix.transformPoint({x:t,y:e},Fx),function(t,e,i){return qu(t,0,!1,e,i)}(this.path.commandList,Fx.x,Fx.y)}},{key:"isPointInStroke",value:function(t,e){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:t,y:e},Fx);var i=Cg(this,this.lineWidth,this.dpr);return function(t,e,i,n){return qu(t,e,!0,i,n)}(this.path.commandList,i,Fx.x,Fx.y)}},{key:"measureText",value:function(t){throw new Error("不支持measureText")}},{key:"putImageData",value:function(t,e,i){throw new Error("不支持measureText")}},{key:"setLineDash",value:function(t){}},{key:"stroke",value:function(t){}},{key:"strokeRect",value:function(t,e,i,n){this.path.rect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i){}},{key:"drawImage",value:function(){}},{key:"setCommonStyle",value:function(t,e,i,n,r){}},{key:"_setCommonStyle",value:function(t,e,i,n){}},{key:"setStrokeStyle",value:function(t,e,i,n,r){}},{key:"_setStrokeStyle",value:function(t,e,i,n){}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(Dx,t,e)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return cg.free(t)})),this.stack.length=0}}]),t}();zx=Ox([Ya(),Ix("design:paramtypes",[Object,Number])],zx);var jx=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Hx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Nx=500,Vx=500,Gx=1,Wx=function(){function t(e){var i;jt(this,t);var n=e.nativeCanvas,r=e.width,o=void 0===r?Nx:r,a=e.height,s=void 0===a?Vx:a,l=e.dpr,u=void 0===l?Gx:l,c=e.x,h=e.y,d=e.id,f=e.canvasControled,p=void 0===f||f;this._x=null!=c?c:0,this._y=null!=h?h:0,this._pixelWidth=o*u,this._pixelHeight=s*u,this._visiable=!1!==e.visiable,this.controled=p,this._displayWidth=o,this._displayHeight=s,this._dpr=u,this._nativeCanvas=n,this._id=null!==(i=n.id)&&void 0!==i?i:d,d&&(n.id=d),this.init(e)}return zt(t,[{key:"displayWidth",get:function(){return this._pixelWidth/this._dpr}},{key:"displayHeight",get:function(){return this._pixelHeight/this._dpr}},{key:"id",get:function(){return this._id}},{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"nativeCanvas",get:function(){return this._nativeCanvas}},{key:"width",get:function(){return this._pixelWidth},set:function(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}},{key:"height",get:function(){return this._pixelHeight},set:function(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}},{key:"getContext",value:function(t){return this._context}},{key:"visiable",get:function(){return this._visiable},set:function(t){this._visiable=t,t?this.show():this.hide()}},{key:"dpr",get:function(){return this._dpr},set:function(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}},{key:"getNativeCanvas",value:function(){return this._nativeCanvas}},{key:"hide",value:function(){}},{key:"show",value:function(){}},{key:"applyPosition",value:function(){}},{key:"resetStyle",value:function(t){}},{key:"resize",value:function(t,e){}},{key:"toDataURL",value:function(t,e){return""}},{key:"readPixels",value:function(t,e,i,n){return this._context.getImageData(t,e,i,n)}},{key:"convertToBlob",value:function(t){throw new Error("暂未实现")}},{key:"transferToImageBitmap",value:function(){throw new Error("暂未实现")}},{key:"release",value:function(){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}]),t}();Wx.env="browser",Wx=jx([Ya(),Hx("design:paramtypes",[Object])],Wx);var Ux=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Yx=function(){function t(){jt(this,t)}return zt(t,[{key:"configure",value:function(t){t.env===this.type&&t.setActiveEnvContribution(this)}},{key:"getNativeAABBBounds",value:function(t){return new ye}},{key:"removeDom",value:function(t){return!1}},{key:"createDom",value:function(t){return null}},{key:"getDynamicCanvasCount",value:function(){return 999}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadBlob",value:function(t){return fetch(t).then((function(t){return t.blob()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"getElementTop",value:function(t,e){return 0}},{key:"getElementLeft",value:function(t,e){return 0}},{key:"getElementTopLeft",value:function(t,e){return{top:0,left:0}}}]),t}();Yx=Ux([Ya()],Yx);var Kx=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Xx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Zx=function(){function t(){jt(this,t),this._uid=Ba.GenAutoIncrementId()}return zt(t,[{key:"onChange",value:function(t){this._onChangeCb=t}},{key:"configure",value:function(t,e){e.env===this.type&&t.setWindowHandler(this)}},{key:"release",value:function(){this.releaseWindow()}},{key:"isVisible",value:function(t){return!0}},{key:"onVisibleChange",value:function(t){}},{key:"getTopLeft",value:function(t){return{top:0,left:0}}}]),t}();Zx=Kx([Ya(),Xx("design:paramtypes",[])],Zx);var qx=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Jx=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Qx=function(t,e){return function(i,n){e(i,n,t)}},$x=function(){function t(e){jt(this,t),this.pickItemInterceptorContributions=e,this.type="default",this.global=nu.global}return zt(t,[{key:"_init",value:function(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((function(t,e){return t.order-e.order}))}},{key:"pick",value:function(t,e,i){var n={graphic:null,group:null};i.pickerService=this;var r=0,o=0;if(i&&i.bounds){if(!i.bounds.contains(e.x,e.y))return n;r=i.bounds.x1,o=i.bounds.y1}this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);for(var a,s=new ke(1,0,0,1,r,o),l=t.length-1;l>=0&&!(n=t[l].isContainer?this.pickGroup(t[l],e,s,i):this.pickItem(t[l],e,s,i)).graphic;l--)a||(a=n.group);if(n.graphic||(n.group=a),this.pickContext&&(this.pickContext.inuse=!1),n.graphic){for(var u=n.graphic;u.parent;)u=u.parent;u.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=u.shadowHost)}return n}},{key:"containsPoint",value:function(t,e,i){var n;return!!(null===(n=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||void 0===n?void 0:n.graphic)}},{key:"pickGroup",value:function(t,e,i,n){var r=this,o={group:null,graphic:null};if(!1===t.attribute.visibleAll)return o;var a=n.pickContext,s=a.modelMatrix;if(a.camera){var l=t.transMatrix,u=hg.allocate();if(yg(u,l),s){if(u){var c=hg.allocate();a.modelMatrix=gg(c,s,u),hg.free(u)}}else yg(u,t.globalTransMatrix),a.modelMatrix=u}if(this.InterceptorContributions.length)for(var h=0;h<this.InterceptorContributions.length;h++){var d=this.InterceptorContributions[h];if(d.beforePickItem){var f=d.beforePickItem(t,this,e,n,{parentMatrix:i});if(f)return a.modelMatrix!==s&&hg.free(a.modelMatrix),a.modelMatrix=s,f}}var p=t.transMatrix,v=cg.allocateByObj(i),y=new ae(e.x,e.y);v.transformPoint(y,y);var g=t.AABBBounds.containsPoint(y);if(!g&&!t.stage.camera)return o;var m=this.pickItem(t,y.clone(),i,n);m&&m.graphic&&(o.graphic=m.graphic,o.params=m.params);var _=!1!==t.attribute.pickable&&g;return v.multiply(p.a,p.b,p.c,p.d,p.e,p.f),!1===t.attribute.childrenPickable||m&&m.graphic||Mb(t,Nl.zIndex,(function(a){if(a.isContainer){var s=new ae(e.x,e.y),l=gc(t).group,u=t.attribute,c=u.scrollX,h=void 0===c?l.scrollX:c,d=u.scrollY,f=void 0===d?l.scrollY:d;s.x-=h,s.y-=f,o=r.pickGroup(a,s,v,n)}else{var p=new ae(e.x,e.y);v.transformPoint(p,p);var y=gc(t).group,g=t.attribute,m=g.scrollX,_=void 0===m?y.scrollX:m,b=g.scrollY,x=void 0===b?y.scrollY:b;p.x-=_,p.y-=x;var k=r.pickItem(a,p,i,n);k&&k.graphic&&(o.graphic=k.graphic,o.params=k.params)}return!!o.graphic||!!o.group}),!0,!!a.camera),a.modelMatrix!==s&&hg.free(a.modelMatrix),a.modelMatrix=s,o.graphic||o.group||!_||t.stage.camera||(o.group=t),cg.free(v),o}},{key:"selectPicker",value:function(t){return this.pickerMap.get(t.numberType)||null}}]),t}();$x=qx([Ya(),Qx(0,Wa(cs)),Qx(0,Ka(tb)),Jx("design:paramtypes",[Object])],$x);var tk=!1,ek=new La((function(t){tk||(tk=!0,t(ym).toSelf().inSingletonScope(),t(M_).to(ym).inSingletonScope(),t(P_).toService(M_),t(If).toService(Ig),ds(t,If))})),ik=!1,nk=new La((function(t){ik||(ik=!0,t(Xm).toSelf().inSingletonScope(),t(D_).to(Xm).inSingletonScope(),t(P_).toService(D_),t(nm).toSelf(),t(im).toSelf(),t(Vf).toService(nm),t(Vf).toService(im),t(Vf).toService(Ig),ds(t,Vf))})),rk=!1,ok=new La((function(t){rk||(rk=!0,t(Tm).toSelf().inSingletonScope(),t(Zb).toSelf().inSingletonScope(),t(L_).to(Tm).inSingletonScope(),t(P_).toService(L_))})),ak=!1,sk=new La((function(t){ak||(ak=!0,t(Dm).toSelf().inSingletonScope(),t(E_).to(Dm).inSingletonScope(),t(P_).toService(E_),t(Df).toService(Ig),ds(t,Df),t(Qb).toSelf().inSingletonScope())})),lk=!1,uk=new La((function(t){lk||(lk=!0,t($m).toSelf().inSingletonScope(),t(z_).to($m).inSingletonScope(),t(P_).toService(z_),t(Gf).toService(Ig),ds(t,Gf))})),ck=!1,hk=new La((function(t){ck||(ck=!0,t(xm).toSelf().inSingletonScope(),t(R_).to(xm).inSingletonScope(),t(P_).toService(R_),t(Ff).toService(Ig),ds(t,Ff))})),dk=!1,fk=new La((function(t){dk||(dk=!0,t(j_).to(u_).inSingletonScope(),t(P_).toService(j_),t(Wf).toService(Ig),ds(t,Wf))})),pk=!1,vk=new La((function(t){pk||(pk=!0,t(Gm).toSelf().inSingletonScope(),t(O_).to(Gm).inSingletonScope(),t(P_).toService(O_),t(Hf).toService(Ig),ds(t,Hf))})),yk=!1,gk=new La((function(t){yk||(yk=!0,t(I_).to(__).inSingletonScope(),t(P_).toService(I_),t(Nf).toService(Ig),ds(t,Nf))})),mk=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},_k=function(){function t(){jt(this,t),this.numberType=Gd}return zt(t,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){r.drawContribution&&t.getSubGraphic().forEach((function(t){var l=r.drawContribution.getRenderContribution(t);l&&l.drawShape&&l.drawShape(t,e,i,n,r,o,a,s)}))}},{key:"draw",value:function(t,e,i,n){var r=i.context;if(r&&(r.highPerformanceSave(),i.drawContribution)){var o=gc(t),a=t.getSubGraphic();a.length&&a.forEach((function(t){i.drawContribution.renderItem(t,i,{theme:o})})),r.highPerformanceRestore()}}}]),t}();_k=mk([Ya()],_k);var bk=!1,xk=new La((function(t){bk||(bk=!0,t(V_).to(_k).inSingletonScope(),t(P_).toService(V_))}));function kk(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Sk=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Ak=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},wk=function(t){ue(i,t);var e=kk(i);function i(){var t;return jt(this,i),(t=e.call(this)).numberType=Qd,t.builtinContributions=[r_],t.init(),t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r){var o=gc(t).richtext,a=t.attribute,s=a.strokeOpacity,l=void 0===s?o.strokeOpacity:s,u=a.opacity,c=void 0===u?o.opacity:u,h=a.fillOpacity,d=void 0===h?o.fillOpacity:h,f=a.visible,p=void 0===f?o.visible:f;if(t.valid&&p){var v=Af(c,d,!0),y=Af(c,l,!0);v&&(e.translate(i,n),this.beforeRenderStep(t,e,i,n,v,y,v,y,o,r),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,n,v,y,v,y,o,r))}}},{key:"drawIcon",value:function(t,e,i,n,r){var o,a=gc(t).richtextIcon,s=t.attribute,l=s.width,u=void 0===l?a.width:l,c=s.height,h=void 0===c?a.height:c,d=s.opacity,f=void 0===d?a.opacity:d,p=s.image,v=s.backgroundFill,y=void 0===v?a.backgroundFill:v,g=s.backgroundFillOpacity,m=void 0===g?a.backgroundFillOpacity:g,_=s.backgroundStroke,b=void 0===_?a.backgroundStroke:_,x=s.backgroundStrokeOpacity,k=void 0===x?a.backgroundStrokeOpacity:x,S=s.backgroundRadius,A=void 0===S?a.backgroundRadius:S,w=s.margin,T=t.attribute,M=T.backgroundWidth,C=void 0===M?u:M,E=T.backgroundHeight,R=void 0===E?h:E;if(w&&(i+=t._marginArray[3],n+=t._marginArray[0]),t._hovered){var P=(C-u)/2,B=(R-h)/2;0===A?(e.beginPath(),e.rect(i-P,n-B,C,R)):(e.beginPath(),qg(e,i-P,n-B,C,R,A)),y&&(e.globalAlpha=m,e.fillStyle=y,e.fill()),b&&(e.globalAlpha=k,e.strokeStyle=b,e.stroke())}var L=p&&(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.get(p));L&&"success"===L.state&&(e.globalAlpha=f,e.drawImage(L.data,i,n,u,h))}},{key:"draw",value:function(t,e,i){var n=gc(t).richtext;this._draw(t,n,!1,i)}}]),i}(wg);wk=Sk([Ya(),Ak("design:paramtypes",[])],wk);var Tk=!1,Mk=new La((function(t){Tk||(Tk=!0,t(H_).to(wk).inSingletonScope(),t(P_).toService(H_))})),Ck=!1,Ek=new La((function(t){Ck||(Ck=!0,t(G_).to(w_).inSingletonScope(),t(P_).toService(G_),t(jf).toService(Ig),ds(t,jf))}));function Rk(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Pk=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Bk=function(t){ue(i,t);var e=Rk(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="rect3d",t.numberType=Jd,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u=gc(t,null==o?void 0:o.theme).rect3d,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,f=c.stroke,p=void 0===f?u.stroke:f,v=c.x1,y=c.y1,g=c.x,m=c.y,_=c.opacity,b=void 0===_?u.opacity:_,x=c.fillOpacity,k=void 0===x?u.fillOpacity:x,S=c.lineWidth,A=void 0===S?u.lineWidth:S,w=c.strokeOpacity,T=void 0===w?u.strokeOpacity:w,M=c.visible,C=void 0===M?u.visible:M,E=t.attribute,R=E.width,P=E.height;R=(null!=R?R:v-g)||0,P=(null!=P?P:y-m)||0;var B=null!==(l=this.z)&&void 0!==l?l:0,L=wf(b,k,R,P,d),O=Mf(b,T,R,P),I=kf(d),D=Sf(p,A);if(t.valid&&C&&(I||D)&&(L||O||a||s)){var F=r.stage||{},z=F.light;F.camera;var j=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,n,u);var H=d;"string"!=typeof H&&(H="black"),this.fill(i,n,B,j,H,e,z,a)}!1!==p&&(e.setStrokeStyle(t,t.attribute,i,n,u),this.stroke(i,n,B,j,e))}}},{key:"stroke",value:function(t,e,i,n,r){var o=n.vertices;n.edges.forEach((function(n){var a=o[n[0]],s={x:t+a[0],y:e+a[1],z:i+a[2]},l=o[n[1]],u={x:t+l[0],y:e+l[1],z:i+l[2]};r.beginPath(),r.moveTo(s.x,s.y,s.z),r.lineTo(u.x,u.y,u.z),r.stroke()}))}},{key:"fill",value:function(t,e,i,n,r,o,a,s){var l=Vh.Get(r,zh.Color255),u=n.vertices,c=u.map((function(t){return o.view(t[0],t[1],t[2])[2]})),h=[];n.polygons.forEach((function(t,e){h.push({faceIdx:e,polygon:t});var i=t.polygon;t.normal;var n=c[i[0]],r=c[i[1]],o=c[i[2]],a=c[i[3]];t.ave_z=n+r+o+a})),h.sort((function(t,e){return e.polygon.ave_z-t.polygon.ave_z})),h.forEach((function(n){var c=n.polygon,h=c.polygon,d=c.normal,f=u[h[0]],p=u[h[1]],v=u[h[2]],y=u[h[3]],g={x:t+f[0],y:e+f[1],z:i+f[2]},m={x:t+p[0],y:e+p[1],z:i+p[2]},_={x:t+v[0],y:e+v[1],z:i+v[2]},b={x:t+y[0],y:e+y[1],z:i+y[2]};o.beginPath(),o.moveTo(g.x,g.y,g.z),o.lineTo(m.x,m.y,m.z),o.lineTo(_.x,_.y,_.z),o.lineTo(b.x,b.y,b.z),o.closePath(),s?s(o,null,null):(o.fillStyle=a?a.computeColor(d,l):r,o.fill())}))}},{key:"draw",value:function(t,e,i){var n=gc(t).rect;this._draw(t,n,!1,i)}}]),i}(wg);Bk=Pk([Ya()],Bk);var Lk=!1,Ok=new La((function(t){Lk||(Lk=!0,t(F_).to(Bk).inSingletonScope(),t(P_).toService(F_))}));function Ik(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Dk=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s};var Fk=function(t){ue(i,t);var e=Ik(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).numberType=Hd,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u=gc(t,null==o?void 0:o.theme).arc,c=t.attribute.fill,h=void 0===c?u.fill:c,d=this.valid(t,u,a,s);if(d){var f=d.fVisible,p=d.sVisible,v=d.doFill,y=d.doStroke,g=null!==(l=this.z)&&void 0!==l?l:0,m=t.attribute,_=m.outerRadius,b=void 0===_?u.outerRadius:_,x=m.innerRadius,k=void 0===x?u.innerRadius:x,S=m.height,A=void 0===S?10:S,w=Vh.Get(h,zh.Color255),T=(r.stage||{}).light,M=r.hack_pieFace,C={top:g,bottom:g+A},E={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};"bottom"===M||"top"===M?(e.beginPath(),function(t,e,i,n,r,o,a){var s=t.getParsedAngle(),l=s.startAngle,u=s.endAngle,c=Ut(u-l),h=u>l,d=!1;if(o<a){var f=o;o=a,a=f}if(o<=Ht)e.moveTo(i,n,r);else if(c>=Wt-Ht)e.moveTo(i+o*Kt(l),n+o*qt(l),r),e.arc(i,n,o,l,u,!h,r),a>Ht&&(e.moveTo(i+a*Kt(u),n+a*qt(u),r),e.arc(i,n,a,u,l,h,r));else{var p=t.getParsePadAngle(l,u),v=p.outerDeltaAngle,y=p.innerDeltaAngle,g=p.outerStartAngle,m=p.outerEndAngle,_=p.innerEndAngle,b=p.innerStartAngle,x=o*Kt(g),k=o*qt(g),S=a*Kt(_),A=a*qt(_);v<.001?d=!0:(e.moveTo(i+x,n+k,r),e.arc(i,n,o,g,m,!h,r)),!(a>Ht)||y<.001?(e.lineTo(i+S,n+A,r),d=!0):(e.lineTo(i+S,n+A,r),e.arc(i,n,a,_,b,h,r))}e.closePath()}(t,e,i,n,C[M],b,k),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(a?a(e,t.attribute,u):f&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=T?T.computeColor(E[M],w):h,e.fill())),y&&(s?s(e,t.attribute,u):p&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke()))):"outside"!==M&&"inside"!==M||("inside"===M&&(e.save(),e.beginPath(),e.arc(i,n,k,0,Wt,!0,C.top),e.clip()),e.beginPath(),function(t,e,i,n,r,o,a,s){var l=t.getParsedAngle(),u=l.startAngle,c=l.endAngle,h=Ut(c-u),d=c>u,f=!1;if(a<=Ht)e.moveTo(i,n,r);else if(h>=Wt-Ht)e.moveTo(i+a*Kt(u),n+a*qt(u),r),e.arc(i,n,a,u,c,!d,r),e.lineTo(i+a*Kt(c),n+a*qt(c),o),e.arc(i,n,a,c,u,d,o);else{var p=s(u,c),v=p.innerouterDeltaAngle,y=p.innerouterStartAngle,g=p.innerouterEndAngle,m=a*Kt(y),_=a*qt(y),b=a*Kt(g),x=a*qt(g);v<.001?f=!0:(e.moveTo(i+m,n+_,r),e.arc(i,n,a,y,g,!d,r),e.lineTo(i+b,n+x,o),e.arc(i,n,a,g,y,d,o))}e.closePath()}(t,e,i,n,C.top,C.bottom,"outside"===M?b:k,(function(e,i){var n=t.getParsePadAngle(e,i),r=n.outerDeltaAngle,o=n.innerDeltaAngle,a=n.outerStartAngle,s=n.outerEndAngle,l=n.innerEndAngle,u=n.innerStartAngle;return"outside"===M?{innerouterDeltaAngle:r,innerouterEndAngle:s,innerouterStartAngle:a}:{innerouterDeltaAngle:o,innerouterEndAngle:l,innerouterStartAngle:u}})),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),v&&(a?a(e,t.attribute,u):f&&(e.setCommonStyle(t,t.attribute,i,n,u),e.fillStyle=T?T.computeColor(E[M],w):h,e.fill())),y&&(s?s(e,t.attribute,u):p&&(e.setStrokeStyle(t,t.attribute,i,n,u),e.stroke())),"inside"===M&&e.restore())}}},{key:"draw",value:function(t,e,i,n){var r=gc(t,null==n?void 0:n.theme).arc;this._draw(t,r,!1,i,n)}}]),i}(wg);Fk=Dk([Ya()],Fk);var zk=!1,jk=new La((function(t){zk||(zk=!0,t(C_).to(Fk).inSingletonScope(),t(P_).toService(C_))}));function Hk(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Nk=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},Vk=function(t){ue(i,t);var e=Hk(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="pyramid3d",t.numberType=Zd,t}return zt(i,[{key:"drawShape",value:function(t,e,i,n,r,o,a,s){var l,u=gc(t,null==o?void 0:o.theme).polygon,c=t.attribute,h=c.fill,d=void 0===h?u.fill:h,f=c.stroke,p=void 0===f?u.stroke:f,v=c.face,y=void 0===v?[!0,!0,!0,!0,!0,!0]:v,g=null!==(l=this.z)&&void 0!==l?l:0;if(this.valid(t,u,a,s)){var m=r.stage||{},_=m.light,b=m.camera,x=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,n,u);var k=d;"string"!=typeof k&&(k="black"),this.fill(i,n,g,x,y,k,e,_,b,t,u,a)}!1!==p&&(e.setStrokeStyle(t,t.attribute,i,n,u),this.stroke(i,n,g,x,e))}}},{key:"stroke",value:function(t,e,i,n,r){var o=n.vertices;n.edges.forEach((function(n){var a=o[n[0]],s=o[n[1]],l={x:t+a[0],y:e+a[1],z:i+a[2]},u={x:t+s[0],y:e+s[1],z:i+s[2]};r.beginPath(),r.moveTo(l.x,l.y,l.z),r.lineTo(u.x,u.y,u.z),r.stroke()}))}},{key:"fill",value:function(t,e,i,n,r,o,a,s,l,u,c,h){var d=Vh.Get(o,zh.Color255),f=n.vertices,p=f.map((function(t){return a.view(t[0],t[1],t[2])[2]})),v=[];n.polygons.forEach((function(t,e){if(r[e]){v.push({faceIdx:e,polygon:t});var i=t.polygon;t.normal;var n=p[i[0]],o=p[i[1]],a=p[i[2]],s=p[i[3]];t.ave_z=n+o+a+s}})),v.sort((function(t,e){return e.polygon.ave_z-t.polygon.ave_z})),v.forEach((function(n){var r=n.polygon,l=r.polygon,p=r.normal,v=f[l[0]],y=f[l[1]],g=f[l[2]],m=f[l[3]],_={x:t+v[0],y:e+v[1],z:i+v[2]},b={x:t+y[0],y:e+y[1],z:i+y[2]},x={x:t+g[0],y:e+g[1],z:i+g[2]},k={x:t+m[0],y:e+m[1],z:i+m[2]};a.beginPath(),a.moveTo(_.x,_.y,_.z),a.lineTo(b.x,b.y,b.z),a.lineTo(x.x,x.y,x.z),a.lineTo(k.x,k.y,k.z),a.closePath(),h?h(a,u.attribute,c):(a.fillStyle=s?s.computeColor(p,d):o,a.fill())}))}},{key:"draw",value:function(t,e,i){var n=gc(t).polygon;this._draw(t,n,!1,i)}}]),i}(wg);Vk=Nk([Ya()],Vk);var Gk=!1,Wk=new La((function(t){Gk||(Gk=!0,t(N_).to(Vk).inSingletonScope(),t(P_).toService(N_))}));var Uk=Rx(),Yk=Uk&&globalThis?globalThis.document:void 0;function Kk(t){return("desktop-browser"===t||"mobile-browser"===t)&&Uk}function Xk(t){return Zk(t)||"mobile-browser"===t}function Zk(t){return t.includes("miniApp")||"lynx"===t||"wx"===t}var qk=0;function Jk(){return qk>=9999999&&(qk=0),qk++}function Qk(t){return null!=t&&""!==t&&(!!I(t)||+t==+t)}function $k(t){return!(!t||0===t.length)&&(!w(t[0])&&!w(t[0].dataId)&&B(t[0].fields))}var tS=function(t,e,i){return t.fields=e||[],t.fname=i,t},eS=function(t){return function(e){return U(e,t)}},iS=function(t){gi.getInstance().error(t)},nS=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(A(t))return t;var n=function(t){var e,i,n,r=[],o=t.length,a=null,s=0,l="";t+="";var u=function(){r.push(l+t.substring(e,i)),l="",e=i+1};for(e=0,i=0;i<o;i+=1)if("\\"===(n=t[i]))l+=t.substring(e,i),l+=t.substring(++i,++i),e=i;else if(n===a)u(),a=null,s=-1;else{if(a)continue;e===s&&'"'===n||e===s&&"'"===n?(e=i+1,a=n):"."!==n||s?"["===n?(i>e&&u(),s=e=i+1):"]"===n&&(s||iS("Access path missing open bracket: "+t),s>0&&u(),s=0,e=i+1):i>e?u():e=i+1}return s&&iS("Access path missing closing bracket: "+t),a&&iS("Access path missing closing quote: "+t),i>e&&(i+=1,u()),r}(t),r=1===n.length?n[0]:t;return tS((i&&i.get||eS)(n),[r],e||r)},rS=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(B(t)){var n=t.map((function(t){return nS(t,e,i)}));return function(t){return n.map((function(e){return e(t)}))}}return nS(t,e,i)};rS("id");var oS=tS((function(t){return t}),[],"identity"),aS=tS((function(){return 0}),[],"zero");tS((function(){return 1}),[],"one"),tS((function(){return!0}),[],"true"),tS((function(){return!1}),[],"false"),tS((function(){return{}}),[],"emptyObject");var sS,lS=function(t,e){var i,n,r=A(e)?e:function(t){return t};if(t&&t.length){for(var o=t.length,a=0;a<o;a+=1){var s=r(t[a]);w(s)||!I(s=+s)||Number.isNaN(s)||(w(i)?(i=s,n=s):(i=Math.min(i,s),n=Math.max(n,s)))}return[i,n]}return[i,n]},uS=function t(e,i,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(i===n)return!0;if(w(i)||w(n))return w(i)&&w(n);if(!C(i)&&!C(n))return i===n;var o=B(i)?i:i[e],a=B(n)?n:n[e];return o===a||!1!==r&&(B(a)?!(!B(o)||a.length!==o.length||!a.every((function(t,e){return t===o[e]}))):!!M(a)&&!(!M(o)||Object.keys(a).length!==Object.keys(o).length||!Object.keys(a).every((function(e){return t(e,a,o)}))))},cS=function(t,e){return w(t)?e:P(t)?e*parseFloat(t)/100:t};function hS(t,e,i,n){var r,o,a=-1;t.forEach((function(t){r=e(t),o=i(t),!w(r)&&(r=+r)>=r&&!w(o)&&(o=+o)>=o&&n(r,o,++a)}))}function dS(t,e,i,n,r){var o=0,a=0;return hS(t,e,i,(function(t,e){var i=e-r(t),s=e-n;o+=i*i,a+=s*s})),1-o/a}function fS(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.x},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.y},n=0,r=0,o=0,a=0,s=0;hS(t,e,i,(function(t,e){++s,n+=(t-n)/s,r+=(e-r)/s,o+=(t*e-o)/s,a+=(t*t-a)/s}));var l,u,c,h,d,f=(u=r,c=o,h=a-(l=n)*l,d=Math.abs(h)<1e-24?0:(c-l*u)/h,[u-d*l,d]),p=function(t){return f[0]+f[1]*t};return{coef:f,predict:p,rSquared:dS(t,e,i,r,p)}}function pS(t){return"horizontal"===t}function vS(t){return"vertical"===t}!function(t){t.Identity="identity",t.Linear="linear",t.Log="log",t.Pow="pow",t.Sqrt="sqrt",t.Symlog="symlog",t.Time="time",t.Quantile="quantile",t.Quantize="quantize",t.Threshold="threshold",t.Ordinal="ordinal",t.Point="point",t.Band="band"}(sS||(sS={}));var yS={};function gS(t){switch(t){case sS.Linear:case sS.Log:case sS.Pow:case sS.Sqrt:case sS.Symlog:case sS.Time:return!0;default:return!1}}function mS(t){return!!yS[t]}function _S(t){switch(t){case sS.Ordinal:case sS.Point:case sS.Band:return!0;default:return!1}}function bS(t){return t}Object.values(sS).forEach((function(t){yS[t]=!0}));var xS=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},kS=function(t){return t<0?-t*t:t*t},SS=function(t){return-Math.log(-t)},AS=function(t){return-Math.exp(-t)},wS=function(t){return isFinite(t)?Math.pow(10,t):t<0?0:t},TS=function(t){return 10===t?wS:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}},MS=function(t){return t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),function(e){return Math.log(e)/t})},CS=function(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}},ES=function(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}};function RS(t,e){if(t=Number(t),e=Number(e),e-=t)return function(i){return(i-t)/e};var i=Number.isNaN(e)?NaN:.5;return function(){return i}}function PS(t,e,i){var n,r,o=t[0],a=t[1],s=e[0],l=e[1];return a<o?(n=RS(a,o),r=i(l,s)):(n=RS(o,a),r=i(s,l)),function(t){return r(n(t))}}function BS(t,e,i){var n;return n=1===t?t+2*i:t-e+2*i,t?n>0?n:1:0}function LS(t,e,i,n){return 1===i&&(i=0),BS(t,i,n)*(e/(1-i))}function OS(t,e){var i=(t[1]-t[0])/(e[1]-e[0]),n=t[0]-i*e[0];return[n,i+n]}function IS(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),o=new Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)r[a]=RS(t[a],t[a+1]),o[a]=i(e[a],e[a+1]);return function(e){var i=mt(t,e,1,n)-1;return o[i](r[i](e))}}var DS=function(t,e){var i,n,r=t.slice(),o=0,a=r.length-1,s=r[o],l=r[a];return l<s&&(o=(i=[a,o])[0],a=i[1],s=(n=[l,s])[0],l=n[1]),r[o]=e.floor(s),r[a]=e.ceil(l),r},FS=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Math.floor(Math.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},zS=function(){function t(){jt(this,t),this._rangeFactorStart=null,this._rangeFactorEnd=null}return zt(t,[{key:"_calculateWholeRange",value:function(t){return this._wholeRange?this._wholeRange:T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=OS(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}},{key:"rangeFactor",value:function(t,e,i){return t?(2===t.length&&t.every((function(t){return t>=0&&t<=1}))&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):T(this._rangeFactorStart)&&T(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}},{key:"rangeFactorStart",value:function(t,e){var i;return w(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!w(this._rangeFactorEnd)&&1!==this._rangeFactorEnd?(this._rangeFactorStart=t,this._rangeFactorEnd=null!==(i=this._rangeFactorEnd)&&void 0!==i?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"rangeFactorEnd",value:function(t,e){var i;return w(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0!==t||!w(this._rangeFactorStart)&&0!==this._rangeFactorStart?(this._rangeFactorEnd=t,this._rangeFactorStart=null!==(i=this._rangeFactorStart)&&void 0!==i?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}},{key:"generateFishEyeTransform",value:function(){var t;if(this._fishEyeOptions){var e=this._fishEyeOptions,i=e.distortion,n=void 0===i?2:i,r=e.radiusRatio,o=void 0===r?.1:r,a=e.radius,s=this.range(),l=s[0],u=s[s.length-1],c=Math.min(l,u),h=Math.max(l,u),d=Tt(null!==(t=this._fishEyeOptions.focus)&&void 0!==t?t:0,c,h),f=w(a)?(h-c)*o:a,p=Math.exp(n);p=p/(p-1)*f;var v=n/f;this._fishEyeTransform=function(t){var e=Math.abs(t-d);if(e>=f)return t;if(e<=1e-6)return d;var i=p*(1-Math.exp(-e*v))/e*.75+.25;return d+(t-d)*i}}else this._fishEyeTransform=null}},{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}}]),t}();function jS(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return HS(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return HS(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function HS(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function NS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var VS=Symbol("implicit"),GS=function(t){ue(i,t);var e=NS(i);function i(){var t;return jt(this,i),(t=e.call(this)).type=sS.Ordinal,t._index=new Map,t._domain=[],t._ordinalRange=[],t._unknown=VS,t}return zt(i,[{key:"specified",value:function(t){var e;return t?(this._specified=Object.assign(null!==(e=this._specified)&&void 0!==e?e:{},t),this):Object.assign({},this._specified)}},{key:"_getSpecifiedValue",value:function(t){if(this._specified)return this._specified[t]}},{key:"clone",value:function(){return(new i).domain(this._domain).range(this._ordinalRange).unknown(this._unknown)}},{key:"calculateVisibleDomain",value:function(t){return T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}},{key:"scale",value:function(t){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==VS)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._ordinalRange[(n-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(r):r}},{key:"invert",value:function(t){for(var e=0;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}},{key:"domain",value:function(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;var e,i=jS(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r="".concat(n);this._index.has(r)||this._index.set(r,this._domain.push(n))}}catch(t){i.e(t)}finally{i.f()}return this}},{key:"range",value:function(t){if(!t)return this._ordinalRange.slice();var e=Array.from(t);return this._ordinalRange=e,this}}]),i}(zS);function WS(t,e,i,n){var r,o,a=[];if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(r=e<t){var s=t;t=e,e=s}var l=Et(1,e-t+1)(i);if(o=Math.floor((e-t+1)/l),!n)for(;Math.ceil((e-t+1)/o)>i&&l>1;)l-=1,o=Math.floor((e-t)/l);for(var u=t;u<=e;)a.push(u),u+=o;return r&&a.reverse(),a}function US(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var YS=function(t){ue(i,t);var e=US(i);function i(t){var n;return jt(this,i),(n=e.call(this)).type=sS.Band,n._range=[0,1],n._step=void 0,n._bandwidth=void 0,n._isFixed=!1,n._round=!1,n._paddingInner=0,n._paddingOuter=0,n._align=.5,n._unknown=void 0,delete n.unknown,n.rescale(t),n}return zt(i,[{key:"rescale",value:function(t,e){if(t)return this;this._wholeRange=null;var n=this._calculateWholeRange(this._range,e),r=Xs(de(i.prototype),"domain",this).call(this).length,o=n[1]<n[0],a=n[Number(o)-0],s=n[1-Number(o)],l=BS(r,this._paddingInner,this._paddingOuter);return this._step=(s-a)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),a+=(s-a-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(a=Math.round(a),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:o,start:o?a+this._step*(r-1):a,count:r},this.generateFishEyeTransform(),this}},{key:"scale",value:function(t){if(this._bandRangeState){var e="".concat(t),i=this._getSpecifiedValue(e);if(void 0!==i)return i;var n=this._index.get(e);if(!n){if(this._unknown!==VS)return this._unknown;n=this._domain.push(t),this._index.set(e,n)}var r=this._bandRangeState,o=r.count,a=r.start+(n-1)%o*(r.reverse?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(a):a}}},{key:"_calculateWholeRange",value:function(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var n;if(T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&2===t.length){var r=OS(t,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(r[1]-r[0])}else n=Math.abs(t[1]-t[0]);var o=function(t,e,i,n,r){var o=BS(t,i,n),a=e/Math.max(1,o||1);r&&(a=Math.floor(a));var s=a*(1-i);return r&&(s=Math.round(s)),s}(Xs(de(i.prototype),"domain",this).call(this).length,n,this._paddingInner,this._paddingOuter,this._round);o<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):o>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=o,this._isFixed=!1)}if(this.isBandwidthFixed()){var a=LS(Xs(de(i.prototype),"domain",this).call(this).length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),s=Math.min((t[1]-t[0])/a,1);if(T(this._rangeFactorStart)&&T(this._rangeFactorEnd)){if(a>0){var l=t[0]-a*this._rangeFactorStart,u=l+a;this._wholeRange=[l,u]}else{var c=t[1]+a*(1-this._rangeFactorEnd),h=c-a;this._wholeRange=[h,c]}var d=this._rangeFactorStart+s<=1,f=this._rangeFactorEnd-s>=0;"rangeFactorStart"===e&&d?this._rangeFactorEnd=this._rangeFactorStart+s:"rangeFactorEnd"===e&&f?this._rangeFactorStart=this._rangeFactorEnd-s:t[0]<=t[1]?d?this._rangeFactorEnd=this._rangeFactorStart+s:f?this._rangeFactorStart=this._rangeFactorEnd-s:(this._rangeFactorStart=0,this._rangeFactorEnd=s):f?this._rangeFactorStart=this._rangeFactorEnd-s:d?this._rangeFactorEnd=this._rangeFactorStart+s:(this._rangeFactorStart=1-s,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=s,this._wholeRange=[t[0],t[0]+a];return this._wholeRange}return Xs(de(i.prototype),"_calculateWholeRange",this).call(this,t)}},{key:"calculateWholeRangeSize",value:function(){var t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}},{key:"calculateVisibleDomain",value:function(t){var e=this._domain;if(T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&e.length){var i=this._getInvertIndex(t[0]),n=this._getInvertIndex(t[1]);return e.slice(Math.min(i,n),Math.max(i,n)+1)}return e}},{key:"domain",value:function(t,e){return t?(Xs(de(i.prototype),"domain",this).call(this,t),this.rescale(e)):Xs(de(i.prototype),"domain",this).call(this)}},{key:"range",value:function(t,e){return t?(this._range=[gt(t[0]),gt(t[1])],this.rescale(e)):this._range}},{key:"rangeRound",value:function(t,e){return this._range=[gt(t[0]),gt(t[1])],this._round=!0,this.rescale(e)}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return-1===t?e:WS(0,e.length-1,t,!1).map((function(t){return e[t]}))}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.ticks(e).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0]+t._bandwidth/2)/(t._range[1]-t._range[0])}}))}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return WS(0,e.length-1,t,!0).filter((function(t){return t<e.length})).map((function(t){return e[t]}))}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n,r=[];if(i=Et(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),n=e<t){var o=t;t=e,e=o}for(var a=t;a<=e;)r.push(a),a+=i;return n&&r.reverse(),r}(0,e.length-1,t).map((function(t){return e[t]}))}},{key:"_getInvertIndex",value:function(t){var e=0,i=this.step()/2,n=this.bandwidth()/2,r=this._domain.length,o=this.range(),a=o[0]>o[o.length-1];for(e=0;e<r;e++){var s=this.scale(this._domain[e])+n;if(0===e&&(!a&&!St(t,s+i)||a&&!At(t,s-i)))break;if(e===r-1)break;if(!At(t,s-i)&&!St(t,s+i))break}return e>=0&&e<=r-1?e:r-1}},{key:"invert",value:function(t){return this._domain[this._getInvertIndex(t)]}},{key:"padding",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}},{key:"paddingInner",value:function(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}},{key:"paddingOuter",value:function(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}},{key:"step",value:function(){return this._step}},{key:"round",value:function(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}},{key:"align",value:function(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}},{key:"rangeFactor",value:function(t,e){return t?(Xs(de(i.prototype),"rangeFactor",this).call(this,t),this.rescale(e)):Xs(de(i.prototype),"rangeFactor",this).call(this)}},{key:"rangeFactorStart",value:function(t,e){return w(t)?Xs(de(i.prototype),"rangeFactorStart",this).call(this):(Xs(de(i.prototype),"rangeFactorStart",this).call(this,t),this.rescale(e,"rangeFactorStart"))}},{key:"rangeFactorEnd",value:function(t,e){return w(t)?Xs(de(i.prototype),"rangeFactorEnd",this).call(this):(Xs(de(i.prototype),"rangeFactorEnd",this).call(this,t),this.rescale(e,"rangeFactorEnd"))}},{key:"bandwidth",value:function(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}},{key:"maxBandwidth",value:function(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}},{key:"minBandwidth",value:function(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"isBandwidthFixed",value:function(){return this._isFixed&&!!this._bandwidth}},{key:"_isBandwidthFixedByUser",value:function(){return this._isFixed&&this._userBandwidth&&I(this._userBandwidth)}},{key:"clone",value:function(){var t,e,n;return new i(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!==(t=this._userBandwidth)&&void 0!==t?t:"auto",!0).maxBandwidth(null!==(e=this._maxBandwidth)&&void 0!==e?e:"auto",!0).minBandwidth(null!==(n=this._maxBandwidth)&&void 0!==n?n:"auto")}}]),i}(GS),KS=function(t,e){var i=t.r,n=e.r,r=t.g,o=e.g,a=t.b,s=e.b,l=t.opacity,u=e.opacity;return function(t){var e=Math.round(i*(1-t)+n*t),c=Math.round(r*(1-t)+o*t),h=Math.round(a*(1-t)+s*t);return new Ke(e,c,h,l*(1-t)+u*t)}};function XS(t,e){var n,r=i(e);if(w(e)||"boolean"===r)return function(){return e};if("number"===r)return Lt(t,e);if("string"===r){if(n=Ye.parseColorString(e)){var o=KS(Ye.parseColorString(t),n);return function(t){return o(t).formatRgb()}}return Lt(Number(t),Number(e))}return e instanceof Ke?KS(t,e):e instanceof Ye?KS(t.color,e.color):e instanceof Date?function(t,e){var i=t.valueOf(),n=e.valueOf(),r=new Date;return function(t){return r.setTime(i*(1-t)+n*t),r}}(t,e):Lt(Number(t),Number(e))}function ZS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var qS=function(t){ue(i,t);var e=ZS(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bS,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bS;return jt(this,i),(t=e.call(this))._unknown=void 0,t.transformer=n,t.untransformer=r,t._forceAlign=!0,t._domain=[0,1],t._range=[0,1],t._clamp=bS,t._piecewise=PS,t._interpolate=XS,t}return zt(i,[{key:"calculateVisibleDomain",value:function(t){var e;return T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!==(e=this._niceDomain)&&void 0!==e?e:this._domain}},{key:"fishEye",value:function(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"invert",value:function(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),Lt)),this._clamp(this.untransformer(this._input(t)))}},{key:"domain",value:function(t,e){var i;if(!t)return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;var n=Array.from(t,gt);return this._domain=n,this.rescale(e)}},{key:"range",value:function(t,e){if(!t)return this._range.slice();var i=Array.from(t);return this._range=i,this.rescale(e)}},{key:"rangeRound",value:function(t,e){var i=Array.from(t);return this._range=i,this._interpolate=Ot,this.rescale(e)}},{key:"rescale",value:function(t){var e;if(t)return this;var i=null!==(e=this._niceDomain)&&void 0!==e?e:this._domain,n=i.length,r=this._range.length,o=Math.min(n,r);if(n&&n<r&&this._forceAlign){for(var a=r-n+1,s=i[n-1],l=n>=2?(s-i[n-2])/a:0,u=1;u<=a;u++)i[n-2+u]=s-l*(a-u);o=r}return void 0===this._clamp&&(this._clamp=Et(i[0],i[o-1])),this._piecewise=o>2?IS:PS,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}},{key:"clamp",value:function(t,e,i){return arguments.length?(this._clamp=e||(t?void 0:bS),this.rescale(i)):this._clamp!==bS}},{key:"interpolate",value:function(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}},{key:"ticks",value:function(){return[]}},{key:"tickData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=this.ticks(e);return(null!=i?i:[]).map((function(e,i){return{index:i,tick:e,value:(t.scale(e)-t._range[0])/(t._range[1]-t._range[0])}}))}},{key:"rangeFactor",value:function(t,e){return t?(Xs(de(i.prototype),"rangeFactor",this).call(this,t),this._output=this._input=null,this):Xs(de(i.prototype),"rangeFactor",this).call(this)}},{key:"rangeFactorStart",value:function(t,e){return w(t)?Xs(de(i.prototype),"rangeFactorStart",this).call(this):(Xs(de(i.prototype),"rangeFactorStart",this).call(this,t),this._output=this._input=null,this)}},{key:"rangeFactorEnd",value:function(t,e){return w(t)?Xs(de(i.prototype),"rangeFactorEnd",this).call(this):(Xs(de(i.prototype),"rangeFactorEnd",this).call(this,t),this._output=this._input=null,this)}},{key:"forceAlignDomainRange",value:function(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}]),i}(zS),JS=Math.sqrt(50),QS=Math.sqrt(10),$S=Math.sqrt(2),tA=[1,2,5,10],eA=function(t,e,i){var n=1,r=t,o=Math.floor((e-1)/2),a=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?r=0:t<0&&t>=-Number.MIN_VALUE?r=-(e-1):!i&&a<1?n=oA(a).step:(i||a>1)&&(r=Math.floor(t)-o*n),n>0?(t>0?r=Math.max(r,0):t<0&&(r=Math.min(r,-(e-1)*n)),vt(0,e).map((function(t){return r+t*n}))):t>0?nA(0,-(e-1)/n,n):nA((e-1)/n,0,n)},iA=wt((function(t,e,i,n){var r,o,a,s,l=-1;if(i=+i,(t=+t)==(e=+e))return[t];if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),s=aA(t,e,i).step,!isFinite(s))return[];if(s>0){var u=Math.round(t/s),c=Math.round(e/s);for(u*s<t&&++u,c*s>e&&--c,a=new Array(o=c-u+1);++l<o;)a[l]=(u+l)*s}else if(s<0&&(null==n?void 0:n.noDecimals)){s=1;var h=Math.ceil(t),d=Math.floor(e);if(!(h<=d))return[];for(a=new Array(o=d-h+1);++l<o;)a[l]=h+l}else{s=-s;var f=Math.round(t*s),p=Math.round(e*s);for(f/s<t&&++f,p/s>e&&--p,a=new Array(o=p-f+1);++l<o;)a[l]=(f+l)/s}return r&&a.reverse(),a})),nA=function(t,e,i){var n,r,o=-1;if(i>0){var a=Math.floor(t/i),s=Math.ceil(e/i);for((a+1)*i<t&&++a,(s-1)*i>e&&--s,r=new Array(n=s-a+1);++o<n;)r[o]=(a+o)*i}else{i=-i;var l=Math.floor(t*i),u=Math.ceil(e*i);for((l+1)/i<t&&++l,(u-1)/i>e&&--u,r=new Array(n=u-l+1);++o<n;)r[o]=(l+o)/i}return r},rA=wt((function(t,e,i,n){var r,o,a;if(i=+i,(t=+t)==(e=+e))return eA(t,i,null==n?void 0:n.noDecimals);if(Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return eA(t,i,null==n?void 0:n.noDecimals);(r=e<t)&&(a=t,t=e,e=a);var s=aA(t,e,i),l=s.step;if(!isFinite(l))return[];if(l>0){for(var u=1,c=s.power,h=10===s.gap?2*Math.pow(10,c):1*Math.pow(10,c);u<=5&&(o=nA(t,e,l)).length>i+1&&i>2;)l+=h,u+=1;i>2&&o.length<i-1&&(o=function(t,e,i){var n,r=t[0],o=t[t.length-1],a=e-t.length;if(o<=0){var s=[];for(n=a;n>=1;n--)s.push(r-n*i);return s.concat(t)}if(r>=0){for(n=1;n<=a;n++)t.push(o+n*i);return t}var l=[],u=[];for(n=1;n<=a;n++)n%2==0?l=[r-Math.floor(n/2)*i].concat(l):u.push(o+Math.ceil(n/2)*i);return l.concat(t).concat(u)}(o,i,l))}else(null==n?void 0:n.noDecimals)&&l<0&&(l=1),o=nA(t,e,l);return r&&o.reverse(),o})),oA=function(t){var e=Math.floor(Math.log(t)/Math.LN10),i=t/Math.pow(10,e),n=tA[0];return i>=JS?n=tA[3]:i>=QS?n=tA[2]:i>=$S&&(n=tA[1]),e>=0?{step:n*Math.pow(10,e),gap:n,power:e}:{step:-Math.pow(10,-e)/n,gap:n,power:e}};function aA(t,e,i){var n=(e-t)/Math.max(0,i);return oA(n)}function sA(t,e,i){var n;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if(i<=0||0===(n=function(t,e,i){return(e-t)/Math.max(1,i-1)}(t,e,i))||!isFinite(n))return[];for(var r=new Array(i),o=0;o<i;o++)r[o]=t+o*n;return r}function lA(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=0,o=t.length-1,a=t[r],s=t[o],l=10;for(s<a&&(i=a,a=s,s=i,i=r,r=o,o=i);l-- >0;){if((i=aA(a,s,n).step)===e)return t[r]=a,t[o]=s,t;if(i>0)a=Math.floor(a/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;a=Math.ceil(a*i)/i,s=Math.floor(s*i)/i}e=i}}function uA(t,e){var i=I(e.forceMin),n=I(e.forceMax),r=null,o=[],a=null,s=i&&n?function(t){return t>=e.forceMin&&t<=e.forceMax}:i?function(t){return t>=e.forceMin}:n?function(t){return t<=e.forceMax}:null;return i?o[0]=e.forceMin:I(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(o[0]=e.min),n?o[1]=e.forceMax:I(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(o[1]=e.max),I(o[0])&&I(o[1])?((a=t.slice())[0]=o[0],a[a.length-1]=o[1]):r=I(o[0])||I(o[1])?I(o[0])?"max":"min":"all",{niceType:r,niceDomain:a,niceMinMax:o,domainValidator:s}}var cA=function(t,e,i){return Math.abs(e-t)<1?+i.toFixed(1):Math.round(+i)},hA=wt((function(t,e,i,n,r,o){var a=[],s={},l=r(t),u=r(e),c=[];if(Number.isInteger(n))c=rA(l,u,i);else for(var h=(u-l)/(i-1),d=0;d<i;d++)c.push(l+d*h);return c.forEach((function(i){var r=o(i),l=Number.isInteger(n)?cA(t,e,r):cA(t,e,FS(r)),u=cA(t,e,function(t,e){var i,n;return e[0]<e[1]?(i=e[0],n=e[1]):(i=e[1],n=e[0]),Math.min(Math.max(t,i),n)}(l,[t,e]));!s[u]&&!isNaN(u)&&c.length>1&&(s[u]=1,a.push(u))})),a})),dA=wt((function(t,e,i,n,r){return sA(n(t),n(e),i).map((function(t){return FS(r(t))}))}));function fA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var pA=function(t){ue(i,t);var e=fA(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type=sS.Linear,t}return zt(i,[{key:"clone",value:function(){return(new i).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}},{key:"tickFormat",value:function(){return function(){}}},{key:"d3Ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1?arguments[1]:void 0,i=this.calculateVisibleDomain(this._range);return iA(i[0],i[i.length-1],t,e)}},{key:"ticks",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0;if(T(this._rangeFactorStart)&&T(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(e,i);var n=null!==(t=this._niceDomain)&&void 0!==t?t:this._domain,r=this._domain,o=n[0],a=n[n.length-1],s=rA(r[0],r[r.length-1],e,i);if(!s.length)return s;if(this._domainValidator)s=s.filter(this._domainValidator);else if((s[0]!==o||s[s.length-1]!==a)&&this._niceType){var l=n.slice();if("all"===this._niceType?(l[0]=s[0],l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()):"min"===this._niceType&&s[0]!==o?(l[0]=s[0],this._niceDomain=l,this.rescale()):"max"===this._niceType&&s[s.length-1]!==a&&(l[l.length-1]=s[s.length-1],this._niceDomain=l,this.rescale()),"all"!==this._niceType){var u=Math.min(l[0],l[l.length-1]),c=Math.max(l[0],l[l.length-1]);s=s.filter((function(t){return t>=u&&t<=c}))}}return s}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return sA(e[0],e[e.length-1],t)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return function(t,e,i){var n,r,o=-1;if(i=+i,(r=(e=+e)<(t=+t))&&(n=t,t=e,e=n),!isFinite(i)||e-t<=i)return[t];for(var a=Math.floor((e-t)/i+1),s=new Array(a);++o<a;)s[o]=t+o*i;return r&&s.reverse(),s}(e[0],e[e.length-1],t)}},{key:"nice",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0,r=this._domain,o=[];if(n){var a=uA(r,n);if(o=a.niceMinMax,this._domainValidator=a.domainValidator,this._niceType=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){var s=lA(r.slice(),i);"min"===this._niceType?s[s.length-1]=null!==(t=o[1])&&void 0!==t?t:s[s.length-1]:"max"===this._niceType&&(s[0]=null!==(e=o[0])&&void 0!==e?e:s[0]),this._niceDomain=s,this.rescale()}return this}},{key:"niceMin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="min";var e=this._domain[this._domain.length-1],i=lA(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}},{key:"niceMax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._niceType="max";var e=this._domain[0],i=lA(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}]),i}(qS);function vA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function yA(t){return function(e){return-t(-e)}}function gA(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.max(e,t)}}var mA=function(t){ue(i,t);var e=vA(i);function i(){var t;return jt(this,i),(t=e.call(this,MS(10),TS(10))).type=sS.Log,t._limit=gA(),t._logs=t.transformer,t._pows=t.untransformer,t._domain=[1,10],t._base=10,t}return zt(i,[{key:"clone",value:function(){return(new i).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}},{key:"rescale",value:function(t){var e;if(t)return this;Xs(de(i.prototype),"rescale",this).call(this);var n=MS(this._base),r=TS(this._base);return(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain)[0]<0?(this._logs=yA(n),this._pows=yA(r),this._limit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.EPSILON;return function(e){return Math.min(e,-t)}}(),this.transformer=SS,this.untransformer=AS):(this._logs=n,this._pows=r,this._limit=gA(),this.transformer=this._logs,this.untransformer=r),this}},{key:"scale",value:function(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));var i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}},{key:"base",value:function(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}},{key:"tickFormat",value:function(){return bS}},{key:"d3Ticks",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=this.domain(),n=this._limit(i[0]),r=this._limit(i[i.length-1]),o=r<n;o&&(n=(t=[r,n])[0],r=t[1]);var a,s,l=this._logs(n),u=this._logs(r),c=[];if(!(this._base%1)&&u-l<e){if(l=Math.floor(l),u=Math.ceil(u),n>0){for(;l<=u;++l)for(a=1;a<this._base;++a)if(!((s=l<0?a/this._pows(-l):a*this._pows(l))<n)){if(s>r)break;c.push(s)}}else for(;l<=u;++l)for(a=this._base-1;a>=1;--a)if(!((s=l>0?a/this._pows(-l):a*this._pows(l))<n)){if(s>r)break;c.push(s)}2*c.length<e&&(c=rA(n,r,e))}else c=rA(l,u,Math.min(u-l,e)).map(this._pows);return c=c.filter((function(t){return 0!==t})),o?c.reverse():c}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return hA(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return dA(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return dA(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}},{key:"nice",value:function(){var t,e,i=this,n=arguments.length>1?arguments[1]:void 0,r=this._domain,o=[],a=null;if(n){var s=uA(r,n);if(o=s.niceMinMax,this._domainValidator=s.domainValidator,a=s.niceType,s.niceDomain)return this._niceDomain=s.niceDomain,this.rescale(),this}else a="all";if(a){var l=DS(r.slice(),{floor:function(t){return i._pows(Math.floor(i._logs(i._limit(t))))},ceil:function(t){return Math.abs(t)>=1?Math.ceil(t):i._pows(Math.ceil(i._logs(i._limit(t))))}});return"min"===a?l[l.length-1]=null!==(t=o[1])&&void 0!==t?t:l[l.length-1]:"max"===a&&(l[0]=null!==(e=o[0])&&void 0!==e?e:l[0]),this._niceDomain=l,this.rescale(),this}return this}},{key:"niceMin",value:function(){var t=this._domain[this._domain.length-1];this.nice();var e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}},{key:"niceMax",value:function(){var t=this._domain[0];this.nice();var e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}]),i}(qS);function _A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var bA=function(t){ue(i,t);var e=_A(i);function i(t){var n;return jt(this,i),(n=e.call(this,!1)).type=sS.Point,n._padding=0,n.paddingInner(1,t),n.padding=n.paddingOuter,n.paddingInner=void 0,n.paddingOuter=void 0,n}return zt(i)}(YS);function xA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var kA=function(t){ue(i,t);var e=xA(i);function i(){var t;return jt(this,i),(t=e.call(this,xS,kS)).type=sS.Sqrt,t}return zt(i,[{key:"clone",value:function(){return(new i).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}]),i}(pA);function SA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var AA=function(t){ue(i,t);var e=SA(i);function i(){var t;return jt(this,i),(t=e.call(this,CS(1),ES(1))).type=sS.Symlog,t._const=1,t}return zt(i,[{key:"clone",value:function(){return(new i).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}},{key:"constant",value:function(t,e){return arguments.length?(this._const=t,this.transformer=CS(t),this.untransformer=ES(t),this.rescale(e)):this._const}},{key:"ticks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return hA(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}},{key:"forceTicks",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.calculateVisibleDomain(this._range);return dA(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"stepTicks",value:function(t){var e=this.calculateVisibleDomain(this._range);return dA(e[0],e[e.length-1],t,this.transformer,this.untransformer)}},{key:"nice",value:function(){var t,e,i=arguments.length>1?arguments[1]:void 0,n=this._domain,r=[],o=null;if(i){var a=uA(n,i);if(r=a.niceMinMax,this._domainValidator=a.domainValidator,o=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else o="all";if(o){var s=DS(n.slice(),{floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)}});return"min"===o?s[s.length-1]=null!==(t=r[1])&&void 0!==t?t:s[s.length-1]:"max"===o&&(s[0]=null!==(e=r[0])&&void 0!==e?e:s[0]),this._niceDomain=s,this.rescale(),this}return this}},{key:"niceMin",value:function(){var t=this._domain[this._domain.length-1];this.nice();var e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}},{key:"niceMax",value:function(){var t=this._domain[0];this.nice();var e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}]),i}(pA),wA=function(){function t(){jt(this,t),this.type=sS.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}return zt(t,[{key:"unknown",value:function(t){return arguments.length?(this._unknown=t,this):this._unknown}},{key:"scale",value:function(t){return!w(t)&&F(+t)?this._range[mt(this._domain,t,0,this.n)]:this._unknown}},{key:"invertExtent",value:function(t){var e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}},{key:"domain",value:function(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}},{key:"range",value:function(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}},{key:"clone",value:function(){return(new t).domain(this._domain).range(this._range).unknown(this._unknown)}}]),t}(),TA=function(t,e,i,n){return new fi(Object.assign({defaultFontParams:Object.assign({fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14},n),getTextBounds:i?void 0:Sg,specialCharSet:"-/: .,@%'\"~"+fi.ALPHABET_CHAR_SET+fi.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)};function MA(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function CA(t){return{align:(t=MA(t))>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"left":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"right":"center",baseline:t>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"bottom":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"top":"middle"}}var EA=function(t){return t.map((function(t,e){return{index:e,value:t}}))},RA=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new ye(t).expand(i/2),r=new ye(e).expand(i/2);return n.intersects(r)};function PA(t,e,i){return i>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}function BA(t,e){for(var i,n=1,r=t.length,o=t[0];n<r;o=i,++n)if(i=t[n],PA(o.AABBBounds,i.AABBBounds,e))return!0;return!1}var LA=function(t,e,i){var n,r=i.labelStyle,o=i.axisOrientType,a=i.labelFlush,s=i.labelFormatter,l=i.startAngle,u=void 0===l?0:l,c=null!==(n=r.angle)&&void 0!==n?n:0;"vertical"===r.direction&&(c+=ge(90));var h=["bottom","top"].includes(o),d=["left","right"].includes(o),f=1,p=0;h||(d?(f=0,p=1):u&&(f=Math.cos(u),p=-Math.sin(u)));var v=TA(r),y=e.map((function(i,n){var o,l,u,y,g=s?s(i):"".concat(i),m=v.quickMeasure(g),_=m.width,b=m.height,x=Math.max(_,12),k=Math.max(b,12),S=t.scale(i),A=f*S,w=p*S,T=A,M=w;"right"===(u=a&&h&&0===n?"left":a&&h&&n===e.length-1?"right":null!==(o=r.textAlign)&&void 0!==o?o:"center")?T-=x:"center"===u&&(T-=x/2),"bottom"===(y=a&&d&&0===n?"top":a&&d&&n===e.length-1?"bottom":null!==(l=r.textBaseline)&&void 0!==l?l:"middle")?M-=k:"middle"===y&&(M-=k/2);var C=(new ye).set(T,M,T+x,M+k);return c&&C.rotate(c,A,w),C}));return y},OA={parity:function(t){return t.filter((function(t,e){return e%2==0}))},greedy:function(t,e){var i;return t.filter((function(t,n){return!(n&&PA(i.AABBBounds,t.AABBBounds,e)||(i=t,0))}))}},IA=function(t,e){return DA(0,t.length,(function(i){return e(t[i])}))},DA=function(t,e,i){for(var n=t,r=e;n<r;){var o=Math.floor((n+r)/2);i(o)>=0?r=o:n=o+1}return n},FA=function(t,e,i,n){return LA(t,e,i).map((function(t){return n?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()]}))},zA=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2},jA=function(t,e){return t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0},HA=function(t,e,i,n,r,o){var a=0,s=0,l=-1,u=Number.MAX_VALUE,c=function(n){var r=!0,o=0;do{o+n<t.length&&zA(e[o],e[o+n],i)&&(r=!1),o+=n}while(r&&o<t.length);return r},h=DA(r,t.length,(function(t){return c(t)?1:-1})),d=h;do{if(d>h&&!o&&!c(d))d++;else{if(!n){s=d;break}var f=t.length-1,p=void 0,v=0;p=t.length%d>0?t.length-t.length%d+d:t.length;do{if((p-=d)!==f&&!zA(e[p],e[f],i))break;v++}while(p>0);if(p===f){s=d,a=v;break}var y=Math.floor(t.length/d)-v+1;if(y<l)break;l=y;var g=jA(e[p],e[f]),m=p-d>=0?jA(e[p-d],e[p]):g,_=Math.abs(g-m);if(_<u&&(u=_,s=d,a=v),g<=m)break;d++}}while(d<=t.length);return{step:s,delCount:a}},NA=function(t,e){var i,n=e.tickCount,r=e.forceTickCount,o=e.tickStep,a=e.getRadius,s=e.labelOffset,l=e.labelGap,u=void 0===l?0:l,c=e.labelStyle,h=null==a?void 0:a();if(!h)return EA(t.domain());if(T(o))i=t.stepTicks(o);else if(T(r))i=t.forceTicks(r);else if(T(n)){var d=t.range(),f=Math.abs(d[d.length-1]-d[0]),p=A(n)?n({axisLength:f,labelStyle:c}):n;i=t.ticks(p)}else if(e.sampling){var v=t.domain(),y=t.range(),g=function(t,e,i){var n,r=i.labelStyle,o=i.getRadius,a=i.labelOffset,s=i.labelFormatter,l=null==o?void 0:o(),u=null!==(n=r.angle)&&void 0!==n?n:0,c=TA(r);return e.map((function(e){var i,n,r=s?s(e):"".concat(e),o=c.quickMeasure(r),h=o.width,d=o.height,f=Math.max(h,12),p=Math.max(d,12),v=t.scale(e),y=CA(v),g=be({x:0,y:0},l+a,v),m=g.x,_=g.y;return i=m+("right"===y.align?-f:"center"===y.align?-f/2:0),n=_+("bottom"===y.baseline?-p:"middle"===y.baseline?-p/2:0),(new ye).set(i,n,i+f,n+p).rotate(u,i+f/2,n+p/2)}))}(t,v,e),m=ht(y),_=ct(y),b=Math.abs(_-m)*(h+s)/v.length,x=VA(v,g,u,Math.floor(g.reduce((function(t,e){return Math.min(t,e.width(),e.height())}),Number.MAX_VALUE)/b)),k=x.step,S=x.delCount;i=(i=t.stepTicks(k)).slice(0,i.length-S)}else i=t.domain();return EA(i)},VA=function(t,e,i,n){var r=n;do{var o=!0;r++;var a=0;do{a+r<t.length&&RA(e[a],e[a+r],i)&&(o=!1),a+=r}while(o&&a<t.length);if(o)break}while(r<=t.length);var s=0;if(t.length>2){var l=t.length-t.length%r;for(l>=t.length&&(l-=r);l>0&&RA(e[0],e[l]);)s++,l-=r}return{step:r,delCount:s}},GA=function(t,i){if(gS(t.type))return function(t,e){if(!gS(t.type))return EA(t.domain());var i=t.range(),n=Math.abs(i[i.length-1]-i[0]);if(n<2)return EA([t.domain()[0]]);var r,o=e.tickCount,a=e.forceTickCount,s=e.tickStep,l=e.noDecimals,u=void 0!==l&&l,c=e.labelStyle;if(T(s))r=t.stepTicks(s);else if(T(a))r=t.forceTicks(a);else if("d3"===e.tickMode){var h=A(o)?o({axisLength:n,labelStyle:c}):o;r=t.d3Ticks(null!=h?h:5,{noDecimals:u})}else{var d=A(o)?o({axisLength:n,labelStyle:c}):o;r=t.ticks(null!=d?d:5,{noDecimals:u})}if(e.sampling&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){for(var f=e.labelGap,p=void 0===f?4:f,v=e.labelFlush,y=LA(t,r,e).map((function(t,e){return{AABBBounds:t,value:r[e]}}));y.length>=3&&BA(y,p);)y=OA.parity(y);var g=y.map((function(t){return t.value}));g.length<3&&v&&(g.length>1&&g.pop(),ut(g)!==ut(r)&&g.push(ut(r))),r=g}return EA(r)}(t,i);if(_S(t.type)){if("cartesian"===i.coordinateType)return function(t,i){var n,r=t.domain();if(!r.length)return[];var o,a=i.tickCount,s=i.forceTickCount,l=i.tickStep,u=i.labelGap,c=void 0===u?4:u,h=i.axisOrientType,d=i.labelStyle,f=function(t){return["bottom","top","z"].includes(t)}(h),p=t.range(),v=t.calculateWholeRangeSize();if(v<2)return i.labelLastVisible?EA([r[r.length-1]]):EA([r[0]]);if(T(l))o=t.stepTicks(l);else if(T(s))o=t.forceTicks(s);else if(T(a)){var y=A(a)?a({axisLength:v,labelStyle:d}):a;o=t.ticks(y)}else if(i.sampling){var g=(null!==(n=i.labelStyle.fontSize)&&void 0!==n?n:12)+2,m=ht(p),_=ct(p);if(r.length<=v/g){var b=(_-m)/r.length,x=FA(t,r,i,f),k=Math.min.apply(Math,e(x.map((function(t){return t[2]})))),S=HA(r,x,c,i.labelLastVisible,Math.floor(k/b),!1);o=t.stepTicks(S.step),i.labelLastVisible&&(S.delCount&&(o=o.slice(0,o.length-S.delCount)),o.push(r[r.length-1]))}else{var w=[r[0],r[Math.floor(r.length/2)],r[r.length-1]],M=FA(t,w,i,f),C=null;M.forEach((function(t){C?C[2]<t[2]&&(C=t):C=t}));var E=_-m-c>0?Math.ceil(r.length*(c+C[2])/(_-m-c)):r.length-1;o=t.stepTicks(E),!i.labelLastVisible||o.length&&o[o.length-1]===r[r.length-1]||(o.length&&Math.abs(t.scale(o[o.length-1])-t.scale(r[r.length-1]))<C[2]&&(o=o.slice(0,-1)),o.push(r[r.length-1]))}}else o=t.domain();return EA(o)}(t,i);if("polar"===i.coordinateType&&"angle"===i.axisOrientType)return NA(t,i)}return EA(t.domain())},WA=function t(e,i){return e===i||!A(e)&&!A(i)&&(B(e)&&B(i)?i.every((function(i){return e.some((function(e){return t(e,i)}))})):!(!M(e)||!M(i))&&Object.keys(i).every((function(n){return t(e[n],i[n])})))},UA=function t(e,i,n){if(w(i))return e;var r=i[0];return w(r)?e:1===i.length?(e[r]=n,e):(w(e[r])&&("number"==typeof i[1]?e[r]=[]:e[r]={}),t(e[r],i.slice(1),n))};function YA(t){return t.radius?{x:Math.cos(t.angle)*t.radius,y:Math.sin(t.angle)*t.radius}:{x:0,y:0}}function KA(t,e){var i=[];return t.forEach((function(t){var n=+t[e];F(n)&&i.push(n)})),0===i.length?null:ht(i)}function XA(t,e){var i=[];return t.forEach((function(t){var n=+t[e];F(n)&&i.push(n)})),0===i.length?null:ct(i)}function ZA(t,e){return t.reduce((function(t,i){var n=e?+i[e]:+i;return F(n)&&(t+=n),t}),0)}function qA(t,e){var i=0,n=0;return t.forEach((function(t){var r=e?+t[e]:+t;F(r)&&(i+=r,n++)})),i/n}function JA(t,e){var i=qA(t,e);if(t.length<=1)return 0;var n=t.reduce((function(t,n){return t+Math.pow(e?+n[e]:+n-i,2)}),0);return n/(t.length-1)}function QA(t,e){var i=$A(t),n=$A(e),r=Math.asin((t.x*e.y-e.x*t.y)/i/n),o=Math.acos((t.x*e.x+t.y*e.y)/i/n);return r<0?-o:o}function $A(t,e){return void 0===e&&(e={x:0,y:0}),se.distancePP(t,e)}function tw(t,e,i){var n,r,o,a,s=!1;if(e&&A(e))try{for(var l=u(t),c=l.next();!c.done;c=l.next()){var h=c.value;try{for(var d=(o=void 0,u(h.getSeries(i))),f=d.next();!f.done;f=d.next()){var p=f.value;if(s=!!e.call(null,p))return s}}catch(t){o={error:t}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s}var ew,iw,nw=function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i].getSeries(),r=0;r<n.length;r++){var o=n[r];if(e&&o&&o.coordinate===e)return o;if(!e&&o)return o}return null};function rw(t){return function(e){return B(t)?t.reduce((function(t,e){return null==t?void 0:t[e]}),e):null==e?void 0:e[t]}}t.SeriesTypeEnum=void 0,(ew=t.SeriesTypeEnum||(t.SeriesTypeEnum={})).area="area",ew.line="line",ew.bar="bar",ew.bar3d="bar3d",ew.rangeColumn="rangeColumn",ew.rangeColumn3d="rangeColumn3d",ew.rangeArea="rangeArea",ew.dot="dot",ew.geo="geo",ew.link="link",ew.map="map",ew.pie="pie",ew.pie3d="pie3d",ew.radar="radar",ew.rose="rose",ew.scatter="scatter",ew.circularProgress="circularProgress",ew.wordCloud="wordCloud",ew.wordCloud3d="wordCloud3d",ew.funnel="funnel",ew.funnel3d="funnel3d",ew.linearProgress="linearProgress",ew.boxPlot="boxPlot",ew.sankey="sankey",ew.gaugePointer="gaugePointer",ew.gauge="gauge",ew.treemap="treemap",ew.sunburst="sunburst",ew.circlePacking="circlePacking",ew.waterfall="waterfall",ew.heatmap="heatmap",ew.correlation="correlation",t.SeriesMarkNameEnum=void 0,(iw=t.SeriesMarkNameEnum||(t.SeriesMarkNameEnum={})).label="label",iw.point="point",iw.line="line",iw.area="area",iw.bar="bar",iw.bar3d="bar3d",iw.boxPlot="boxPlot",iw.outlier="outlier",iw.circlePacking="circlePacking",iw.group="group",iw.gridBackground="gridBackground",iw.grid="grid",iw.dot="dot",iw.title="title",iw.subTitle="subTitle",iw.symbol="symbol",iw.funnel="funnel",iw.funnel3d="funnel3d",iw.transform="transform",iw.transform3d="transform3d",iw.transformLabel="transformLabel",iw.outerLabel="outerLabel",iw.outerLabelLine="outerLabelLine",iw.pin="pin",iw.pinBackground="pinBackground",iw.pointer="pointer",iw.segment="segment",iw.track="track",iw.cell="cell",iw.cellBackground="cellBackground",iw.link="link",iw.arrow="arrow",iw.pie="pie",iw.pie3d="pie3d",iw.labelLine="labelLine",iw.progress="progress",iw.minLabel="minLabel",iw.maxLabel="maxLabel",iw.rose="rose",iw.node="node",iw.sunburst="sunburst",iw.nonLeaf="nonLeaf",iw.leaf="leaf",iw.nonLeafLabel="nonLeafLabel",iw.leaderLine="leaderLine",iw.stackLabel="stackLabel",iw.word="word",iw.fillingWord="fillingWord",iw.nodePoint="nodePoint",iw.ripplePoint="ripplePoint",iw.centerPoint="centerPoint",iw.centerLabel="centerLabel",iw.barBackground="barBackground",iw.lineLabel="lineLabel",iw.areaLabel="areaLabel";var ow,aw,sw,lw,uw,cw,hw,dw,fw,pw,vw,yw,gw,mw,_w,bw="__VCHART",xw=500,kw=500,Sw="".concat(bw,"_LABEL_LIMIT"),Aw="".concat(bw,"_LABEL_ALIGN"),ww="".concat(bw,"_LABEL_TEXT"),Tw="".concat(bw,"_LABEL_VISIBLE"),Mw="".concat(bw,"_LABEL_X"),Cw="".concat(bw,"_LABEL_Y"),Ew="".concat(bw,"_ARC_TRANSFORM_VALUE"),Rw="".concat(bw,"_ARC_RATIO"),Pw="".concat(bw,"_ARC_START_ANGLE"),Bw="".concat(bw,"_ARC_END_ANGLE"),Lw="".concat(bw,"_ARC_K"),Ow="".concat(bw,"_ARC_MIDDLE_ANGLE"),Iw="".concat(bw,"_ARC_QUADRANT"),Dw="".concat(bw,"_ARC_RADIAN"),Fw=-Math.PI/2,zw=3*Math.PI/2,jw=-90,Hw=270,Nw=.6;!function(t){t.enter="enter",t.update="update",t.exit="exit",t.group="group"}(ow||(ow={})),function(t){t.enter="enter",t.update="update",t.exit="exit",t.unChange="unChange"}(aw||(aw={})),function(t){t.arc="arc",t.arc3d="arc3d",t.area="area",t.image="image",t.line="line",t.path="path",t.rect="rect",t.rect3d="rect3d",t.rule="rule",t.shape="shape",t.symbol="symbol",t.text="text",t.richtext="richtext",t.polygon="polygon",t.pyramid3d="pyramid3d",t.circle="circle",t.cell="cell",t.interval="interval",t.group="group",t.glyph="glyph",t.component="component",t.largeRects="largeRects",t.largeSymbols="largeSymbols"}(sw||(sw={})),function(t){t.axis="axis",t.grid="grid",t.legend="legend",t.slider="slider",t.label="label",t.datazoom="datazoom",t.player="player",t.title="title",t.scrollbar="scrollbar"}(lw||(lw={})),function(t){t[t.player=1]="player",t[t.rollUp=2]="rollUp",t[t.drillDown=3]="drillDown",t[t.slider=4]="slider",t[t.datazoom=5]="datazoom",t[t.legend=6]="legend",t[t.scrollbar=7]="scrollbar",t[t.brush=8]="brush",t[t.normal=9]="normal"}(uw||(uw={})),function(t){t.lineAxis="lineAxis",t.circleAxis="circleAxis"}(cw||(cw={})),function(t){t.lineAxisGrid="lineAxisGrid",t.circleAxisGrid="circleAxisGrid"}(hw||(hw={})),function(t){t.discreteLegend="discreteLegend",t.colorLegend="colorLegend",t.sizeLegend="sizeLegend"}(dw||(dw={})),function(t){t.lineCrosshair="lineCrosshair",t.rectCrosshair="rectCrosshair",t.sectorCrosshair="sectorCrosshair",t.circleCrosshair="circleCrosshair",t.polygonCrosshair="polygonCrosshair",t.ringCrosshair="ringCrosshair"}(fw||(fw={})),function(t){t.symbolLabel="symbolLabel",t.rectLabel="rectLabel",t.lineLabel="lineLabel",t.dataLabel="dataLabel"}(pw||(pw={})),function(t){t.continuousPlayer="continuousPlayer",t.discretePlayer="discretePlayer"}(vw||(vw={})),function(t){t.before="before",t.layouting="layouting",t.reevaluate="reevaluate",t.after="after"}(yw||(yw={})),t.VGRAMMAR_HOOK_EVENT=void 0,(gw=t.VGRAMMAR_HOOK_EVENT||(t.VGRAMMAR_HOOK_EVENT={})).BEFORE_EVALUATE_DATA="beforeEvaluateData",gw.AFTER_EVALUATE_DATA="afterEvaluateData",gw.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",gw.AFTER_EVALUATE_SCALE="afterEvaluateScale",gw.BEFORE_PARSE_VIEW="beforeParseView",gw.AFTER_PARSE_VIEW="afterParseView",gw.BEFORE_TRANSFORM="beforeTransform",gw.AFTER_TRANSFORM="afterTransform",gw.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",gw.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",gw.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",gw.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",gw.BEFORE_STAGE_RESIZE="beforeStageResize",gw.AFTER_STAGE_RESIZE="afterStageResize",gw.BEFORE_VRENDER_DRAW="beforeVRenderDraw",gw.AFTER_VRENDER_DRAW="afterVRenderDraw",gw.BEFORE_MARK_JOIN="beforeMarkJoin",gw.AFTER_MARK_JOIN="afterMarkJoin",gw.BEFORE_MARK_UPDATE="beforeMarkUpdate",gw.AFTER_MARK_UPDATE="afterMarkUpdate",gw.BEFORE_MARK_STATE="beforeMarkState",gw.AFTER_MARK_STATE="afterMarkState",gw.BEFORE_MARK_ENCODE="beforeMarkEncode",gw.AFTER_MARK_ENCODE="afterMarkEncode",gw.BEFORE_DO_LAYOUT="beforeDoLayout",gw.AFTER_DO_LAYOUT="afterDoLayout",gw.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",gw.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",gw.BEFORE_DO_RENDER="beforeDoRender",gw.AFTER_DO_RENDER="afterDoRender",gw.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",gw.AFTER_MARK_RENDER_END="afterMarkRenderEnd",gw.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",gw.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",gw.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",gw.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",gw.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",gw.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",gw.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",gw.BEFORE_ELEMENT_STATE="beforeElementState",gw.AFTER_ELEMENT_STATE="afterElementState",gw.BEFORE_ELEMENT_ENCODE="beforeElementEncode",gw.AFTER_ELEMENT_ENCODE="afterElementEncode",gw.ANIMATION_START="animationStart",gw.ANIMATION_END="animationEnd",gw.ELEMENT_ANIMATION_START="elementAnimationStart",gw.ELEMENT_ANIMATION_END="elementAnimationEnd",gw.ALL_ANIMATION_START="allAnimationStart",gw.ALL_ANIMATION_END="allAnimationEnd",function(t){t.signal="signal",t.data="data",t.scale="scale",t.coordinate="coordinate",t.mark="mark"}(mw||(mw={})),function(t){t.active="active",t.selected="selected",t.highlight="highlight",t.blur="blur"}(_w||(_w={}));var Vw="__vgrammar_scene_item__",Gw=[sw.line,sw.area],Ww=[sw.arc3d,sw.rect3d,sw.pyramid3d],Uw="key",Yw=[{}],Kw=["key"],Xw="VGRAMMAR_IMMEDIATE_ANIMATION",Zw=0,qw=1e3,Jw=0,Qw=0,$w=!1,tT=!1,eT="quintInOut",iT={stopWhenStateChange:!1,immediatelyApply:!0};function nT(t,e){return lt(t).reduce((function(t,i){var n=P(i)?e.getGrammarById(i):i;return n&&t.push(n),t}),[])}function rT(t,e){if(w(t))return[];if(function(t){return!A(t)&&!!(null==t?void 0:t.signal)}(t)){var i=t.signal;if(P(i))return lt(e.getGrammarById(i));if("signal"===(null==i?void 0:i.grammarType))return[i]}else if(function(t){return!A(t)&&!!(null==t?void 0:t.callback)}(t))return nT(t.dependency,e);return[]}function oT(t){return A(t)||(null==t?void 0:t.signal)||!!(null==t?void 0:t.callback)}function aT(t,e,i,n){if(w(t))return t;if(A(t))return n?t.call(null,i,n,e):t.call(null,i,e);if(t.signal){var r=t.signal;return P(r)?null==e?void 0:e[r]:r.output()}return t.callback?n?t.callback.call(null,i,n,e):t.callback.call(null,i,e):t}function sT(t,e){if(w(t))return t;if(A(t))return t.call(null,e);if(t.signal){var i=t.signal;return P(i)?null==e?void 0:e[i]:i.output()}return t.callback?t.callback.call(null,e):t}function lT(t,e){return uT(t)?t.output():e[t]}var uT=function(t){return t&&!w(t.grammarType)},cT=function(t){return A(t)?t:function(e){return e[t]}};function hT(t){return!!(null==t?void 0:t.scale)}function dT(t){return!!(null==t?void 0:t.field)}function fT(t,e){if(!t)return[];var i=[];return t.scale&&(i=uT(t.scale)?[t.scale]:lt(e.getScaleById(t.scale))),i.concat(rT(t,e))}function pT(t,e){switch(e){case"line":return t.some((function(t){return["x","y","defined"].includes(t)}));case"area":return t.some((function(t){return["x","y","x1","y1","defined"].includes(t)}));case"largeRects":return t.some((function(t){return["x","y","width","y1"].includes(t)}));case"largeSymbols":return t.some((function(t){return["x","y"].includes(t)}))}return!1}function vT(t,e){if(["x","y","dx","dy"].includes(e))return!0;switch(t){case sw.arc:return["innerRadius","outerRadius","startAngle","endAngle"].includes(e);case sw.group:case sw.rect:case sw.image:return["width","height","y1"].includes(e);case sw.path:case sw.shape:return["path","customPath"].includes(e);case sw.line:return"defined"===e;case sw.area:return["x1","y1","defined"].includes(e);case sw.rule:return["x1","y1"].includes(e);case sw.symbol:return"size"===e;case sw.polygon:return"points"===e;case sw.text:return"text"===e}return!1}var yT=function(){function t(e,i,n,r){jt(this,t),this.channelEncoder={},this.marks=e,i&&this.registerChannelEncoder(i),n&&this.registerDefaultEncoder(n),this.progressiveChannels&&this.registerProgressiveChannels(r)}return zt(t,[{key:"getMarks",value:function(){return this.marks}},{key:"registerChannelEncoder",value:function(t,e){return P(t)?this.channelEncoder[t]=e:Object.assign(this.channelEncoder,t),this}},{key:"registerFunctionEncoder",value:function(t){return this.functionEncoder=t,this}},{key:"registerDefaultEncoder",value:function(t){return this.defaultEncoder=t,this}},{key:"registerProgressiveChannels",value:function(t){return this.progressiveChannels=lt(t),this}},{key:"getChannelEncoder",value:function(){return this.channelEncoder}},{key:"getFunctionEncoder",value:function(){return this.functionEncoder}},{key:"getDefaultEncoder",value:function(){return this.defaultEncoder}},{key:"getProgressiveChannels",value:function(){return this.progressiveChannels}}]),t}(),gT=function(){function t(){jt(this,t)}return zt(t,null,[{key:"registerPlotMarks",value:function(e,i){t._plotMarks[e]=i}},{key:"createPlotMark",value:function(e,i){return t._plotMarks[e]?new t._plotMarks[e](i):null}},{key:"registerMark",value:function(e,i){t._marks[e]=i}},{key:"createMark",value:function(e,i,n){return t._marks[e]?new t._marks[e](i,e,n):null}},{key:"hasMark",value:function(e){return!!t._marks[e]}},{key:"registerComponent",value:function(e,i){t._components[e]=i}},{key:"createComponent",value:function(e,i,n,r){var o=t._components[e];return o?new o(i,n,r):null}},{key:"hasComponent",value:function(e){return!!t._components[e]}},{key:"registerGraphicComponent",value:function(e,i){t._graphicComponents[e]=i}},{key:"createGraphicComponent",value:function(e,i,n){var r=t._graphicComponents[e];return r?r(i,n):null}},{key:"registerTransform",value:function(e,i,n){t._transforms[e]=Object.assign(i,{type:e,isBuiltIn:!!n})}},{key:"getTransform",value:function(e){return t._transforms[e]}},{key:"unregisterRuntimeTransforms",value:function(){Object.keys(t._transforms).forEach((function(e){t._transforms[e]&&!t._transforms[e].isBuiltIn&&(t._transforms[e]=null)}))}},{key:"registerGrammar",value:function(e,i,n){t._grammars[e]={grammarClass:i,specKey:null!=n?n:e}}},{key:"createGrammar",value:function(e,i,n){var r,o=null===(r=t._grammars[e])||void 0===r?void 0:r.grammarClass;return o?new o(i,n):null}},{key:"getGrammars",value:function(){return this._grammars}},{key:"getGlyph",value:function(e){return t._glyphs[e]}},{key:"createInteraction",value:function(e,i,n){var r=t._interactions[e];return r?new r(i,n):null}}]),t}();function mT(t,e,i,n,r){i&&(oT(i)?e.forEach((function(e){var r=aT(i,n,e.datum,t);Object.assign(e.nextAttrs,r)})):Object.keys(i).forEach((function(o){var a,s,l=i[o],u=r&&!vT(t.mark.markType,o)?[e[0]]:e;if(hT(l)){var c=lT(l.scale,n),h=null!==(a=null==l?void 0:l.offset)&&void 0!==a?a:0,d=!w(l.band)&&c.bandwidth?c.bandwidth()*l.band:null,f=P(null==l?void 0:l.field),p=f?rS(l.field):null,v=f?null:w(null==l?void 0:l.value)?0:null===(s=c.scale)||void 0===s?void 0:s.call(c,l.value);u.forEach((function(t){var e;f&&(v=null===(e=c.scale)||void 0===e?void 0:e.call(c,p(t.datum))),t.nextAttrs[o]=I(v)||I(d)?v+h+d:v}))}else if(dT(l)){var y=rS(l.field);u.forEach((function(t){t.nextAttrs[o]=y(t.datum)}))}else u.forEach((function(e){e.nextAttrs[o]=aT(l,n,e.datum,t)}))})))}function _T(t,e,i,n){if(!t)return null;if(oT(t))return aT(t,n,e,i);var r={};return Object.keys(t).forEach((function(o){var a,s,l,u=t[o];if(hT(u)){var c=lT(u.scale,n),h=null!==(a=null==u?void 0:u.offset)&&void 0!==a?a:0,d=!w(u.band)&&c.bandwidth?c.bandwidth()*u.band:null,f=P(null==u?void 0:u.field),p=f?rS(u.field):null,v=f?null===(s=c.scale)||void 0===s?void 0:s.call(c,p(e)):w(null==u?void 0:u.value)?0:null===(l=c.scale)||void 0===l?void 0:l.call(c,u.value);r[o]=I(v)||I(d)?v+h+d:v}else if(dT(u)){var y=rS(u.field);r[o]=y(e)}else r[o]=aT(u,n,e,i)})),r}gT._plotMarks={},gT._marks={},gT._components={},gT._graphicComponents={},gT._transforms={},gT._grammars={},gT._glyphs={},gT._animations={},gT._interactions={},gT._graphics={},gT.registerGlyph=function(t,e,i,n,r){return gT._glyphs[t]=new yT(e,i,n,r),gT._glyphs[t]},gT.registerAnimationType=function(t,e){gT._animations[t]=e},gT.getAnimationType=function(t){return gT._animations[t]},gT.registerInteraction=function(t,e){gT._interactions[t]=e},gT.registerGraphic=function(t,e){gT._graphics[t]=e},gT.getGraphicType=function(t){return gT._graphics[t]},gT.createGraphic=function(t,e){var i=gT._graphics[t];return i?i(e):null};var bT=function(t){return!!sw[t]};function xT(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=gT.getGraphicType(e)?gT.createGraphic(e,n):gT.createGraphicComponent(e,n,{skipDefault:null===(i=null==t?void 0:t.spec)||void 0===i?void 0:i.skipTheme});return r||gi.getInstance().error("create ".concat(e," graphic failed!")),r}var kT=function(t){t&&(t[Vw]=null,t.release(),t.parent&&t.parent.removeChild(t))},ST=["fillOpacity"],AT=function(t,e,i){var n;return"fillOpacity"===e?(t.fillOpacity=null!==(n=i.fillOpacity)&&void 0!==n?n:1,["fillOpacity"]):[]};var wT=v(v(v(v({rect3d:[{channels:["x","y","z","x1","y1","width","height","length"],transform:function(t,e,i){var n,r,o,a,s,l,u,c,h,d,f,p;F(e.width)||!F(e.x1)&&F(i.width)?(t.x=Math.min(null!==(n=i.x)&&void 0!==n?n:0,null!==(r=i.x1)&&void 0!==r?r:1/0),t.width=i.width):F(e.x1)||!F(e.width)&&F(i.x1)?(t.x=Math.min(i.x,i.x1),t.width=Math.abs(i.x1-i.x)):(t.x=Math.min(null!==(o=i.x)&&void 0!==o?o:0,null!==(a=i.x1)&&void 0!==a?a:1/0),t.width=i.width),F(e.height)||!F(e.y1)&&F(i.height)?(t.y=Math.min(null!==(s=i.y)&&void 0!==s?s:0,null!==(l=i.y1)&&void 0!==l?l:1/0),t.height=i.height):F(e.y1)||!F(e.height)&&F(i.y1)?(t.y=Math.min(i.y,i.y1),t.height=Math.abs(i.y1-i.y)):(t.y=Math.min(null!==(u=i.y)&&void 0!==u?u:0,null!==(c=i.y1)&&void 0!==c?c:1/0),t.height=i.height),F(e.length)||!F(e.z1)&&F(i.length)?(t.z=Math.min(null!==(h=i.z)&&void 0!==h?h:0,null!==(d=i.z1)&&void 0!==d?d:1/0),t.length=i.length):F(e.z1)||!F(e.length)&&F(i.z1)?(t.z=Math.min(i.z,i.z1),t.length=Math.abs(i.z1-i.z)):(t.z=Math.min(null!==(f=i.z)&&void 0!==f?f:0,null!==(p=i.z1)&&void 0!==p?p:1/0),t.length=i.length)},storedAttrs:"sizeAttrs"}]},sw.text,[{channels:["text","limit","autoLimit","maxLineWidth"],transform:function(t,e,i){var n,r,o,a,s=null!==(n=i.limit)&&void 0!==n?n:1/0,l=null!==(r=i.autoLimit)&&void 0!==r?r:1/0,u=Math.min(s,l),c=E(i.text)&&!w(i.text.text),h=c?i.text.text:i.text;t.maxLineWidth=u===1/0?i.maxLineWidth:u,c?"html"===i.text.type?(t.html={dom:h,width:null!==(o=e.width)&&void 0!==o?o:u,height:null!==(a=e.height)&&void 0!==a?a:e.fontSize,anchorType:"position"},t.text=""):"rich"===i.text.type?t.textConfig=h:t.text=h:t.text=h},storedAttrs:"limitAttrs"}]),sw.rule,[{channels:["x","y","x1","y1"],transform:function(t,e,i){var n=function(t){var e=t.x,i=t.y,n=t.x1,r=t.y1;return F(e)&&F(i)&&F(n)&&F(r)?[{x:e,y:i},{x:n,y:r}]:[]}(i);t.points=n,t.x=0,t.y=0},storedAttrs:"pointAttrs"}]),sw.symbol,[{channels:["shape","symbolType"],transform:function(t,e,i){var n;t.symbolType=null!==(n=e.shape)&&void 0!==n?n:e.symbolType}},{channels:["image","fill","background"],transform:function(t,e,i){e.image?(t.background=e.image,t.fill=!1):i.image?(t.background=i.image,t.fill=!1):(t.fill=i.fill,t.background=i.background)},storedAttrs:"imageAttrs"}]),sw.richtext,[{channels:["text","textConfig"],transform:function(t,e,i){var n,r,o,a;t.text=null,"rich"===(null===(n=e.text)||void 0===n?void 0:n.type)?t.textConfig=e.text.text:"html"===(null===(r=e.textConfig)||void 0===r?void 0:r.type)?(t.html={dom:e.textConfig.text,width:e.width,height:null!==(o=e.height)&&void 0!==o?o:e.fontSize,anchorType:"position"},t.text=""):"rich"===(null===(a=e.textConfig)||void 0===a?void 0:a.type)?t.textConfig=e.textConfig.text:t.textConfig=e.textConfig}}]);var TT=function(t,e,i,n){var r={},o=e?Object.keys(e):[],a=P(t)?wT[t]:t;if(a&&a.length){var s=[];o.forEach((function(t){var o=!1;a.forEach((function(a,l){if(a.channels.includes(t)){if(!s[l])if(a.storedAttrs){var u=function(t,e,i,n,r,o){var a=r.getGraphicAttribute(t,!1,o);if(a)return e.forEach((function(t){t in n&&(a[t]=n[t])})),a;var s={};return e.forEach((function(t){s[t]=n[t]})),i[t]=s,s}(a.storedAttrs,a.channels,r,e,i,n);a.transform(r,e,u)}else a.transform(r,e,null);s[l]=!0,o=!0}})),o||(ST.includes(t)?AT(r,t,e):r[t]=e[t])}))}else o.forEach((function(t){ST.includes(t)?AT(r,t,e):r[t]=e[t]}));return r},MT=function(t,e,n){return!(!w(t)||!w(e))||!w(t)&&!w(e)&&("lineDash"===n?function(t,e){return t.length===e.length&&t.join("-")===e.join("-")}(t,e):"stroke"===n||"fill"===n?function(t,e){if(t===e)return!0;if(i(t)!=i(e))return!1;if(P(t))return!1;if(t.gradient!==e.gradient)return!1;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((function(i){return"stops"===i?function(t,e){var i,n;if(t===e)return!0;var r=null!==(i=t&&t.length)&&void 0!==i?i:0;return r===(null!==(n=e&&e.length)&&void 0!==n?n:0)&&0!==r&&t.every((function(t,i){return!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset}))}(t[i],e[i]):t[i]===e[i]}))}(t,e):t===e)},CT=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],ET=["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"].concat(CT);function RT(t){var e={};return t?(Object.keys(t).forEach((function(i){"x"!==i&&"y"!==i&&"x1"!==i&&"y1"!==i&&"defined"!==i&&"size"!==i&&"width"!==i&&"height"!==i&&"context"!==i&&(e[i]=t[i])})),e):e}var PT=function(){function e(t){var i=this;jt(this,e),this.data=null,this.states=[],this.diffState=aw.enter,this.isReserved=!1,this.runtimeStatesEncoder=null,this.items=[],this.getStateAttrs=function(t,e){var n,r,o,a=!w(null===(n=i.runtimeStatesEncoder)||void 0===n?void 0:n[t]),s=a?i.runtimeStatesEncoder[t]:null===(r=i.mark.getSpec().encode)||void 0===r?void 0:r[t];if(!s)return{};if(A(s))return s(i.getDatum(),i,t,e);if(!a&&(null===(o=i.graphicItem.states)||void 0===o?void 0:o[t]))return i.graphicItem.states[t];var l=i.items.map((function(t){return Object.assign({},t,{nextAttrs:{}})}));mT(i,l,s,i.mark.parameters());var u=i.transformElementItems(l,i.mark.markType);return i.graphicItem.states?i.graphicItem.states[t]||(i.graphicItem.states[t]=u):i.graphicItem.states=v({},t,u),u},this.mark=t}return zt(e,[{key:"initGraphicItem",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.graphicItem){var i=this.mark.getAttributeTransforms();this.graphicItem=this.mark.addGraphicItem(i?TT(i,e,this):e,this.groupKey),this.graphicItem&&(this.graphicItem[Vw]=this,i&&(this.graphicItem.onBeforeAttributeUpdate=function(e){return t.mark?TT(i,e,t):e}),this.clearGraphicAttributes(),this.mark.needAnimate()&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(e),this.setFinalGraphicAttributes(e)))}}},{key:"updateGraphicItem",value:function(t){if(this.graphicItem){w(t.clip)||this.graphicItem.setAttribute("clip",t.clip),w(t.interactive)||this.graphicItem.setAttribute("pickable",t.interactive),w(t.zIndex)||this.graphicItem.setAttribute("zIndex",t.zIndex),this.diffState===aw.exit?this.graphicItem.releaseStatus="willRelease":this.graphicItem.releaseStatus=void 0;var e=this.mark.animate.getAnimationConfigs("state");0!==e.length&&(this.graphicItem.stateAnimateConfig=e[0].originConfig)}}},{key:"getGraphicItem",value:function(){return this.graphicItem}},{key:"removeGraphicItem",value:function(){var t,e;this.graphicItem&&(null===(e=null===(t=this.graphicItem.animates)||void 0===t?void 0:t.forEach)||void 0===e||e.call(t,(function(t){return t.stop()}))),this.graphicItem&&(kT(this.graphicItem),this.graphicItem[Vw]=null,this.graphicItem=null)}},{key:"resetGraphicItem",value:function(){this.graphicItem&&(this.graphicItem=null)}},{key:"getBounds",value:function(){var t;return null===(t=this.graphicItem)||void 0===t?void 0:t.AABBBounds}},{key:"getStates",value:function(){return this.states}},{key:"updateData",value:function(e,i,n){var r,o=this;this.mark.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ELEMENT_UPDATE_DATA,{groupKey:e,data:i,key:n},this),this.data=i;var a=cT(n);return this.items=i.map((function(t){return{datum:t,key:a(t),view:o.mark.view,nextAttrs:{}}})),this.groupKey=e,this.key=this.mark.isCollectionMark()?e:null===(r=this.items)||void 0===r?void 0:r[0].key,this.mark.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_UPDATE_DATA,{groupKey:e,data:i,key:n},this),this.items}},{key:"state",value:function(t,e){var i,n=this.mark.isCollectionMark(),r=this.states,o=lt(aT(t,e,this.getDatum(),this)),a=null===(i=this.mark.getSpec())||void 0===i?void 0:i.stateSort;a&&a.sort(a);var s=o.length!==r.length||o.some((function(t,e){return t!==r[e]}));this.states=o,!n&&s&&this.diffState===aw.unChange&&(this.diffState=aw.update)}},{key:"encodeGraphic",value:function(t){this.coordinateTransformEncode(this.items);var e=this.transformElementItems(this.items,this.mark.markType);t&&(this.mark.isCollectionMark()&&delete t.defined,Object.assign(e,t)),this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null,this.applyGraphicAttributes(e)):this.initGraphicItem(e),this.diffState!==aw.enter&&this.diffState!==aw.update||!this.states.length||this.useStates(this.states),this.mark.markType===sw.shape&&(this.graphicItem.datum=this.items[0].datum),this.items.forEach((function(t){t.nextAttrs={}})),this._setCustomizedShape()}},{key:"_setCustomizedShape",value:function(){var t,e=this;if(this.graphicItem){var i=null===(t=this.mark.getSpec())||void 0===t?void 0:t.setCustomizedShape;i&&(this.graphicItem.pathProxy=function(t){return i(e.data,t,new Pl)})}}},{key:"encodeItems",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,r=this.mark.isCollectionMark(),o=e[ow.update],a=e[ow.enter],s=e[ow.exit],l=this.mark.isLargeMode()||r&&!this.mark.getSpec().enableSegments;this.diffState===aw.enter?(a&&mT(this,t,a,n,l),o&&mT(this,t,o,n,l)):this.diffState===aw.update?((r&&a||i)&&mT(this,t,a,n,l),o&&mT(this,t,o,n,l)):this.diffState===aw.exit&&s&&(i&&mT(this,t,a,n,l),mT(this,t,s,n,l))}},{key:"coordinateTransformEncode",value:function(t){if(this.mark.coord&&"arc"!==this.mark.markType&&!0!==this.mark.disableCoordinateTransform){var e=this.mark.coord.output();t.forEach((function(t){var i=t.nextAttrs,n=e.convert(i);Object.assign(i,n)}))}}},{key:"clearStates",value:function(t){var e=S(t)?t:0!==this.mark.animate.getAnimationConfigs("state").length;this.states=[],this.graphicItem&&this.graphicItem.clearStates(e),this.runtimeStatesEncoder&&(this.runtimeStatesEncoder={})}},{key:"_updateRuntimeStates",value:function(t,e){this.runtimeStatesEncoder||(this.runtimeStatesEncoder={}),this.runtimeStatesEncoder[t]=e}},{key:"hasState",value:function(t){return this.states&&t&&this.states.includes(t)}},{key:"addState",value:function(t,e){var i;if(!this.graphicItem)return!1;if(e&&P(t)&&!nt(e,null===(i=this.runtimeStatesEncoder)||void 0===i?void 0:i[t])){var n=this.states.slice();return n.includes(t)?this.graphicItem.clearStates():n.push(t),this._updateRuntimeStates(t,e),this.useStates(n),!0}var r=this.mark.getSpec().encode,o=lt(t).reduce((function(t,e){return e&&!t.includes(e)&&(null==r?void 0:r[e])&&t.push(e),t}),this.states.slice());return o.length!==this.states.length&&(this.useStates(o),!0)}},{key:"removeState",value:function(t){var e=this;if(!this.graphicItem)return!1;var i=lt(t);if(!i.length)return!1;var n=this.states.filter((function(t){return!i.includes(t)}));return n.length!==this.states.length&&(this.runtimeStatesEncoder&&i.forEach((function(t){e.runtimeStatesEncoder[t]=null})),this.useStates(n),!0)}},{key:"useStates",value:function(e,i){var n;if(!this.graphicItem)return!1;this.mark.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ELEMENT_STATE,{states:e},this);var r=null===(n=this.mark.getSpec())||void 0===n?void 0:n.stateSort;r&&e.sort(r),this.states=e;var o=S(i)?i:0!==this.mark.animate.getAnimationConfigs("state").length;return this.graphicItem.stateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,o),this.mark.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_STATE,{states:e},this),!0}},{key:"diffAttributes",value:function(t){var e={},i=this.getFinalGraphicAttributes();for(var n in t)uS(n,i,t)&&K(i,n)||(e[n]=t[n]);return e}},{key:"transformElementItems",value:function(t,e,i){var n,r,o,a,s=t[0];if(!s.nextAttrs||0===Object.keys(s.nextAttrs).length)return{};var l=s.nextAttrs;if(function(t){return[sw.line,sw.area,sw.largeRects,sw.largeSymbols].includes(t)}(e)&&t&&t.length&&w(null===(n=s.nextAttrs)||void 0===n?void 0:n.points)&&(!0===i||pT(Object.keys(s.nextAttrs),this.mark.markType))){var u=this.getGraphicAttribute("points",!1),c=this.getGraphicAttribute("segments",!1),h=this.mark.getSpec().enableSegments,d=t.map((function(t){return t.nextAttrs})),f=this.mark.isProgressive();if(l=RT(l),e===sw.line||e===sw.area){var p=function(t,e,i,n){return!t||!t.length||1===t.length&&e?[]:t.some((function(t){return pT(Object.keys(t.nextAttrs),"line")}))?t.map((function(t,e){var r,o=t.nextAttrs,a=null!==(r=null==i?void 0:i[e])&&void 0!==r?r:{},s=a.x,l=a.y,u=a.x1,c=a.y1,h=a.defined;return w(o.x)&&(o.x=s),w(o.y)&&(o.y=l),w(o.defined)&&!1===h&&(o.defined=!1),o.context=t.key,n&&(w(o.x1)&&(o.x1=u),w(o.y1)&&(o.y1=c)),o})):null!=i?i:[]}(t,!0,u,e===sw.area);if(h&&!f){var v=p&&0!==p.length?p:function(t){return t?t.reduce((function(t,e){return t.concat(e.points)}),[]):null}(c),y=function(t,e,i){var n;if(!t||t.length<=1)return null;var r="area"===(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.markType)?ET:CT,o=[],a=null;return t.forEach((function(t,e){a&&r.every((function(e){return MT(a[e],t[e],e)}))||(o.length&&(o[o.length-1].endIndex=e),a=t,o.push({attrs:a,startIndex:e}))})),o.length>=2?o.map((function(t){var n=TT(sw.line,RT(t.attrs),i);return n.points=e.slice(t.startIndex,w(t.endIndex)?e.length:t.endIndex),n})):null}(d,v,this);y?(l.segments=y,l.points=null):(l.segments=null,l.points=v)}else f?l.segments=(null!==(a=null===(o=null===(r=this.graphicItem)||void 0===r?void 0:r.attribute)||void 0===o?void 0:o.segments)&&void 0!==a?a:[]).concat([{points:p}]):(l.points=p,l.segments=null)}else e===sw.largeRects?l.points=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t||!t.length||1===t.length&&e)return[];var n=new Float32Array(4*t.length);return t.forEach((function(t,e){var r,o,a,s,l=t.nextAttrs,u=null!==(r=l.x)&&void 0!==r?r:i[4*e],c=null!==(o=l.y)&&void 0!==o?o:i[4*e+1],h=null!==(a=l.width)&&void 0!==a?a:i[4*e+2],d=null!==(s=l.y1)&&void 0!==s?s:i[4*e+3];n[4*e]=u,n[4*e+1]=c,n[4*e+2]=h,n[4*e+3]=d-c})),n}(t,!0,u):e===sw.largeSymbols&&(l.points=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!t||!t.length||1===t.length&&e)return[];var n=new Float32Array(2*t.length);return t.forEach((function(t,e){var r,o,a=t.nextAttrs,s=null!==(r=a.x)&&void 0!==r?r:i[2*e],l=null!==(o=a.y)&&void 0!==o?o:i[2*e+1];n[2*e]=s,n[2*e+1]=l})),n}(t,!0,u))}return l}},{key:"applyGraphicAttributes",value:function(t){var e,i,n=this;if(!W(t))if(this.mark.needAnimate()){var r=this.diffAttributes(t),o=null!==(e=this.getPrevGraphicAttributes())&&void 0!==e?e:{},a=null!==(i=this.getFinalGraphicAttributes())&&void 0!==i?i:{};Object.keys(r).forEach((function(t){o[t]=n.getGraphicAttribute(t),a[t]=r[t]})),this.setNextGraphicAttributes(r),this.setPrevGraphicAttributes(o),this.setFinalGraphicAttributes(a);var s=this.mark.animate.getElementAnimators(this).reduce((function(t,e){return Object.assign(t,e.getEndAttributes())}),{}),l=Object.assign({},s,a);this.graphicItem.setAttributes(l)}else this.graphicItem.setAttributes(t)}},{key:"getGraphicAttribute",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.graphicItem){if(i){var n,r=this.getPrevGraphicAttributes();if(!w(n=U(r,t)))return n}var o=this.mark.getAttributeTransforms(),a=[t];if(o&&o.length){var s=o.find((function(e){return e.storedAttrs&&e.channels.includes(t)}));s&&(a=[s.storedAttrs,t])}return U(null===(e=this.graphicItem)||void 0===e?void 0:e.attribute,a)}}},{key:"setGraphicAttribute",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.graphicItem){var n=this.getFinalGraphicAttributes(),r=this.getPrevGraphicAttributes();i&&n&&(n[t]=e),r&&!K(r,t)&&(r[t]=this.graphicItem.attribute[t]),this.graphicItem.setAttribute(t,e)}}},{key:"setGraphicAttributes",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.graphicItem){var n=this.getFinalGraphicAttributes(),r=this.getPrevGraphicAttributes();Object.keys(t).forEach((function(o){n&&i&&(n[o]=t[o]),r&&!K(r,o)&&(r[o]=e.graphicItem.attribute[o])})),this.graphicItem.setAttributes(t)}}},{key:"getFinalGraphicAttributes",value:function(){return this.graphicItem.finalAttrs}},{key:"setFinalGraphicAttributes",value:function(t){this.graphicItem.finalAttrs=t}},{key:"getPrevGraphicAttributes",value:function(){return this.graphicItem.prevAttrs}},{key:"setPrevGraphicAttributes",value:function(t){this.graphicItem.prevAttrs=t}},{key:"getNextGraphicAttributes",value:function(){return this.graphicItem.nextAttrs}},{key:"setNextGraphicAttributes",value:function(t){this.graphicItem.nextAttrs=t}},{key:"clearChangedGraphicAttributes",value:function(){this.graphicItem&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null))}},{key:"clearGraphicAttributes",value:function(){this.graphicItem&&(this.graphicItem.prevAttrs&&this.setPrevGraphicAttributes(null),this.graphicItem.nextAttrs&&this.setNextGraphicAttributes(null),this.graphicItem.finalAttrs&&this.setFinalGraphicAttributes(null))}},{key:"remove",value:function(){this.graphicItem&&(kT(this.graphicItem),this.graphicItem=null)}},{key:"release",value:function(){this.removeGraphicItem(),this.mark=null,this.data=null,this.items=null}},{key:"getItemAttribute",value:function(t){var e,i;if(null===(e=this.items)||void 0===e?void 0:e.length)return this.mark.isCollectionMark()?w(t)?this.items.map((function(t){return t.nextAttrs})):this.items.map((function(e){var i;return null===(i=e.nextAttrs)||void 0===i?void 0:i[t]})):w(t)?this.items[0].nextAttrs:null===(i=this.items[0].nextAttrs)||void 0===i?void 0:i[t]}},{key:"setItemAttributes",value:function(t){var e;(null===(e=this.items)||void 0===e?void 0:e.length)&&(this.mark.isCollectionMark()?B(t)&&this.items.forEach((function(e,i){Object.assign(e.nextAttrs,t[i])})):Object.assign(this.items[0].nextAttrs,t))}},{key:"getItem",value:function(){var t,e;return this.mark.isCollectionMark()?null!==(t=this.items)&&void 0!==t?t:[]:null===(e=this.items)||void 0===e?void 0:e[0]}},{key:"getDatum",value:function(){var t,e;return this.mark.isCollectionMark()?null!==(t=this.data)&&void 0!==t?t:[]:null===(e=this.data)||void 0===e?void 0:e[0]}}]),e}();function BT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var LT=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"],OT=function(t){ue(i,t);var e=BT(i);function i(t,n){var r;return jt(this,i),r=e.call(this,t),(null==n?void 0:n.mode)&&(r.mode=n.mode,r.setMode(n.mode)),(null==n?void 0:n.skipDefault)&&(r.skipDefault=!0),r.setTheme({common:{strokeBoundsBuffer:0}}),r.attribute=t,r.onSetStage((function(){r.render(),r.bindEvents()})),r}return zt(i,[{key:"setAttribute",value:function(t,e,i){E(this.attribute[t])&&E(e)&&!A(this.attribute[t])&&!A(e)?Q(this.attribute[t],e):this.attribute[t]=e,LT.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"setAttributes",value:function(t,e){var i=Object.keys(t);this._mergeAttributes(t,i),i.every((function(t){return LT.includes(t)}))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(i)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}},{key:"_mergeAttributes",value:function(t,e){w(e)&&(e=Object.keys(t));for(var i=0;i<e.length;i++){var n=e[i];!E(this.attribute[n])||A(this.attribute[n])||A(t[n])?this.attribute[n]=t[n]:Q(this.attribute[n],t[n])}}},{key:"bindEvents",value:function(){}},{key:"_getNodeId",value:function(t){return"".concat(this.id,"-").concat(this.name,"-").concat(t)}},{key:"_dispatchEvent",value:function(t,e){var i,n=new Rc(t,e);n.manager=null===(i=this.stage)||void 0===i?void 0:i.eventSystem.manager,this.dispatchEvent(n)}}]),i}(sf),IT=function(){function t(e){var i=this;jt(this,t),this.onPointerDown=function(t){var e=t.target,n=i.rootNode,r=e===n;if(e&&!r){var o,a=function(t){if(s||(t.type="dragstart",null==e||e.dispatchEvent(t),s=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.pickable=!1;var i=(null==n?void 0:n.pick(t.global.x,t.global.y)).graphic;e.pickable=!0,o!==i&&(o&&(t.type="dragleave",t.target=o,o.dispatchEvent(t)),i&&(t.type="dragenter",t.target=i,i.dispatchEvent(t)),(o=i)&&(t.type="dragover",t.target=o,o.dispatchEvent(t)))}},s=!1;null==n||n.addEventListener("pointermove",a);var l=function(){s&&(o&&(t.type="drop",t.target=o,o.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),s=!1),null==n||n.removeEventListener("pointermove",a)};e.addEventListener("pointerup",l,{once:!0}),e.addEventListener("pointerupoutside",l,{once:!0})}},this.rootNode=e,this.initEvents()}return zt(t,[{key:"initEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.addEventListener("pointerdown",this.onPointerDown)}},{key:"removeEvents",value:function(){var t;null===(t=this.rootNode)||void 0===t||t.removeEventListener("pointerdown",this.onPointerDown)}},{key:"release",value:function(){this.removeEvents(),this.rootNode=null}}]),t}();function DT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var FT=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},zT=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(i*i+n*n)},jT=function(t){ue(i,t);var e=DT(i);function i(t){var n,r,o,a,s,l,u,c,h,d,f,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jt(this,i),(n=e.call(this)).cachedEvents=[],n.startPoints=[],n.processEvent={},n.throttleTimer=0,n.emitThrottles=[],n.lastTapTarget=null,n.onStart=function(t){n.reset(),n.startTime=Pc.now();var e=ce(n),i=e.cachedEvents,r=e.startPoints;t&&i.push(t.clone()),r.length=i.length;for(var o=0;o<i.length;o++){var a=i[o],s={x:a.x,y:a.y};r[o]=s}if(1!==r.length)n.startDistance=zT(r[0],r[1]),n.center=function(t){var e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};for(var i=0,n=0,r=0;r<e;)i+=t[r].x,n+=t[r].y,r++;return{x:Math.round(i/e),y:Math.round(n/e)}}([r[0],r[1]]);else{var l=i[0];n.pressTimeout=setTimeout((function(){l.direction="none",l.deltaX=0,l.deltaY=0,l.points=r,n.triggerStartEvent("press",l),n.triggerEvent("press",l),n.eventType="press",n.direction="none"}),n.config.press.time)}},n.onMove=function(t){n.clearPressTimeout();var e=ce(n),i=e.startPoints,r=e.cachedEvents;if(i.length){for(var o=t.clone(),a=o.x,s=o.y,l=o.pointerId,u=0,c=r.length;u<c;u++)if(l===r[u].pointerId){r[u]=o;break}var h={x:a,y:s},d=r.map((function(t){return{x:t.x,y:t.y}})),f=Pc.now();if(n.prevMoveTime=n.lastMoveTime,n.prevMovePoint=n.lastMovePoint,n.lastMoveTime=f,n.lastMovePoint=h,1===i.length){var p=i[0],v=a-p.x,y=s-p.y,g=n.direction||FT(p,h);n.direction=g;var m=n.getEventType(h);return o.direction=g,o.deltaX=v,o.deltaY=y,o.points=d,n.triggerStartEvent(m,o),void n.triggerEvent(m,o)}var _=ce(n).startDistance,b=zT(d[0],d[1]);o.scale=b/_,o.center=n.center,o.points=d,n.triggerStartEvent("pinch",o),n.triggerEvent("pinch",o)}},n.onEnd=function(t){var e=t.clone(),i=ce(n),r=i.cachedEvents,o=i.startPoints,a=r.map((function(t){return{x:t.x,y:t.y}}));if(e.points=a,n.triggerEndEvent(e),1===r.length){var s=Pc.now(),l=n.lastMoveTime;if(s-l<100){var u=l-(n.prevMoveTime||n.startTime);if(u>0){var c=n.prevMovePoint||o[0],h=n.lastMovePoint||o[0],d=zT(c,h),f=d/u;f>n.config.swipe.velocity&&d>n.config.swipe.threshold&&(e.velocity=f,e.direction=FT(c,h),n.triggerEvent("swipe",e))}}s-n.lastTapTime<n.config.tap.interval&&t.target===n.lastTapTarget?n.tapCount++:n.tapCount=1,n.lastTapTime=s,n.lastTapTarget=t.target,1===n.tapCount?n.triggerEvent("tap",e):2===n.tapCount&&(n.triggerEvent("doubletap",e),n.tapCount=0)}for(var p=0,v=r.length;p<v;p++)if(r[p].pointerId===e.pointerId){r.splice(p,1),o.splice(p,1);break}n.reset(),r.length>0&&n.onStart()},n.element=t,n.tapCount=0,n.lastTapTime=0,n.config={press:{time:null!==(o=null===(r=null==p?void 0:p.press)||void 0===r?void 0:r.time)&&void 0!==o?o:251,threshold:null!==(s=null===(a=null==p?void 0:p.press)||void 0===a?void 0:a.threshold)&&void 0!==s?s:9},swipe:{threshold:null!==(u=null===(l=null==p?void 0:p.swipe)||void 0===l?void 0:l.threshold)&&void 0!==u?u:10,velocity:null!==(h=null===(c=null==p?void 0:p.swipe)||void 0===c?void 0:c.velocity)&&void 0!==h?h:.3},tap:{interval:null!==(f=null===(d=null==p?void 0:p.tap)||void 0===d?void 0:d.interval)&&void 0!==f?f:300}},n.initEvents(),n}return zt(i,[{key:"initEvents",value:function(){var t=this.element;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}},{key:"removeEvents",value:function(){var t=this.element;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}},{key:"release",value:function(){this.removeEvents(),this.element=null}},{key:"getEventType",value:function(t){var e,i=this.eventType,n=this.startTime,r=this.startPoints;return i||(e=Pc.now()-n>this.config.press.time&&zT(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}},{key:"enable",value:function(t){this.processEvent[t]=!0}},{key:"isProcess",value:function(t){return this.processEvent[t]}},{key:"pushEvent",value:function(t,e){for(var i=this.emitThrottles,n={type:t,ev:e},r=0,o=i.length;r<o;r++)if(i[r].type===t)return void i.splice(r,1,n);i.push(n)}},{key:"clearPressTimeout",value:function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}},{key:"reset",value:function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}},{key:"triggerEvent",value:function(t,e){var i=this;this.pushEvent(t,e);var n=this.throttleTimer,r=this.emitThrottles;n||(this.throttleTimer=nu.global.getRequestAnimationFrame()((function(){for(var t=0,e=r.length;t<e;t++){var n=r[t],o=n.type,a=n.ev;i.emitEvent(o,a)}i.throttleTimer=0,i.emitThrottles.length=0})))}},{key:"triggerStartEvent",value:function(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent("".concat(t,"start"),e))}},{key:"triggerEndEvent",value:function(t){var e=this,i=this.processEvent;Object.keys(i).forEach((function(n){e.triggerEvent("".concat(n,"end"),t),"press"===n&&e.triggerEvent("".concat(n,"up"),t),delete i[n]}))}},{key:"emitEvent",value:function(t,e){var i=this.element._events["*"];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(var n=0,r=i.length;n<r&&!e.propagationImmediatelyStopped;n++)i[n].fn.call(i[n].context,e,t);this.emit(t,e)}}]),i}(x),HT=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},NT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VT=[0,0,0],GT=new ke(1,0,0,1,0,0),WT=function(){function t(e,i){jt(this,t),this.fillAttributes=Object.assign(Object.assign({},Il),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},Fl),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},zl),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;var n=e.nativeCanvas.getContext("2d");if(!n)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=n,this.canvas=e,this.matrix=new ke(1,0,0,1,0,0),this.stack=[],this.dpr=i,this.applyedMatrix=new ke(1,0,0,1,0,0)}return zt(t,[{key:"fillStyle",get:function(){return this.nativeContext.fillStyle},set:function(t){this.nativeContext.fillStyle=t}},{key:"font",get:function(){return this.nativeContext.font},set:function(t){this.nativeContext.font=t}},{key:"globalAlpha",get:function(){return this.nativeContext.globalAlpha},set:function(t){this.nativeContext.globalAlpha=t}},{key:"lineCap",get:function(){return this.nativeContext.lineCap},set:function(t){this.nativeContext.lineCap=t}},{key:"lineDashOffset",get:function(){return this.nativeContext.lineDashOffset},set:function(t){this.nativeContext.lineDashOffset=t}},{key:"lineJoin",get:function(){return this.nativeContext.lineJoin},set:function(t){this.nativeContext.lineJoin=t}},{key:"lineWidth",get:function(){return this.nativeContext.lineWidth},set:function(t){this.nativeContext.lineWidth=t}},{key:"miterLimit",get:function(){return this.nativeContext.miterLimit},set:function(t){this.nativeContext.miterLimit=t}},{key:"shadowBlur",get:function(){return this.nativeContext.shadowBlur},set:function(t){this.nativeContext.shadowBlur=t}},{key:"shadowColor",get:function(){return this.nativeContext.shadowColor},set:function(t){this.nativeContext.shadowColor=t}},{key:"shadowOffsetX",get:function(){return this.nativeContext.shadowOffsetX},set:function(t){this.nativeContext.shadowOffsetX=t}},{key:"shadowOffsetY",get:function(){return this.nativeContext.shadowOffsetY},set:function(t){this.nativeContext.shadowOffsetY=t}},{key:"strokeStyle",get:function(){return this.nativeContext.strokeStyle},set:function(t){this.nativeContext.strokeStyle=t}},{key:"textAlign",get:function(){return this.nativeContext.textAlign},set:function(t){this.nativeContext.textAlign=t}},{key:"textBaseline",get:function(){return this.nativeContext.textBaseline},set:function(t){this.nativeContext.textBaseline=t}},{key:"inuse",get:function(){return!!this._inuse},set:function(t){t!==!!this._inuse&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}},{key:"reset",value:function(){this.stack.length&&gi.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new ke(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.nativeContext}},{key:"setTransformForCurrent",value:function(){!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}},{key:"currentMatrix",get:function(){return this.matrix}},{key:"cloneMatrix",value:function(t){return cg.allocateByObj(t)}},{key:"clear",value:function(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}},{key:"restore",value:function(){this.nativeContext.restore(),this.stack.length>0&&(cg.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}},{key:"highPerformanceRestore",value:function(){this.stack.length>0&&(cg.free(this.matrix),this.matrix=this.stack.pop())}},{key:"rotate",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.matrix.rotate(t),e&&this.setTransformForCurrent()}},{key:"save",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}},{key:"highPerformanceSave",value:function(){var t=this.cloneMatrix(this.matrix);this.stack.push(t)}},{key:"scale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.scale(t,e),i&&this.setTransformForCurrent()}},{key:"setScale",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}},{key:"scalePoint",value:function(t,e,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.translate(i,n,!1),this.scale(t,e,!1),this.translate(-i,-n,!1),r&&this.setTransformForCurrent()}},{key:"setTransform",value:function(t,e,i,n,r,o){var a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.dpr;this.matrix.setValue(s*t,s*e,s*i,s*n,s*r,s*o),a&&this.setTransformForCurrent()}},{key:"setTransformFromMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dpr;this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}},{key:"resetTransform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}},{key:"transform",value:function(t,e,i,n,r,o){var a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.matrix.multiply(t,e,i,n,r,o),a&&this.setTransformForCurrent()}},{key:"transformFromMatrix",value:function(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}},{key:"translate",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.matrix.translate(t,e),i&&this.setTransformForCurrent()}},{key:"rotateDegrees",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t*Math.PI/180;this.rotate(i,e)}},{key:"rotateAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"rotateDegreesAbout",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}},{key:"beginPath",value:function(){this.disableBeginPath||this.nativeContext.beginPath()}},{key:"clip",value:function(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}},{key:"arc",value:function(t,e,i,n,r,o,a){if(a=a||0,this.camera){var s=[];!function(t,e,i,n,r,o,a,s){if(s)for(;i>e;)i-=Wt;else for(;i<e;)i+=Wt;for(var l=Nt/3*(i>e?1:-1),u=e,c=u;c!==i;){c=l>0?Math.min(c+l,i):Math.max(c+l,i);var h=Math.abs(c-u),d=4*Math.tan(h/4)/3,f=c<u?-1:1,p=Math.cos(u),v=Math.sin(u),y=Math.cos(c),g=Math.sin(c),m=p*o+n,_=v*a+r,b=y*o+n,x=g*a+r,k=o*d*f,S=a*d*f;t.push([m-k*v,_+S*p,b+k*g,x-S*y,b,x]),u=c}}(s,n,r,t,e,i,i,o);for(var l=0;l<s.length;++l){var u=s[l];this.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5],a)}}else this.nativeContext.arc(t,e,i,n,r,o)}},{key:"arcTo",value:function(t,e,i,n,r){this.nativeContext.arcTo(t,e,i,n,r)}},{key:"bezierCurveTo",value:function(t,e,i,n,r,o,a){if(a=a||0,this.camera){var s=a,l=a;this.modelMatrix&&(Mx(VT,[t,e,a],this.modelMatrix),t=VT[0],e=VT[1],s=VT[2],Mx(VT,[i,n,a],this.modelMatrix),i=VT[0],n=VT[1],l=VT[2],Mx(VT,[r,o,a],this.modelMatrix),r=VT[0],o=VT[1],a=VT[2]);var u=this.camera.vp(r,o,a);r=u.x,o=u.y,t=(u=this.camera.vp(t,e,s)).x,e=u.y,i=(u=this.camera.vp(i,n,l)).x,n=u.y}this.nativeContext.bezierCurveTo(t,e,i,n,r,o)}},{key:"closePath",value:function(){this.nativeContext.closePath()}},{key:"ellipse",value:function(t,e,i,n,r,o,a,s){null==s?this.nativeContext.ellipse(t,e,i,n,r,o,a):this.nativeContext.ellipse(t,e,i,n,r,o,a,s)}},{key:"lineTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(Mx(VT,[t,e,i],this.modelMatrix),t=VT[0],e=VT[1],i=VT[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.lineTo(t,e)}},{key:"moveTo",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(Mx(VT,[t,e,i],this.modelMatrix),t=VT[0],e=VT[1],i=VT[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}this.nativeContext.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,i,n,r){if(r=r||0,this.camera){var o=r;this.modelMatrix&&(Mx(VT,[t,e,r],this.modelMatrix),t=VT[0],e=VT[1],o=VT[2],Mx(VT,[i,n,r],this.modelMatrix),i=VT[0],n=VT[1],r=VT[2]);var a=this.camera.vp(i,n,r);i=a.x,n=a.y,t=(a=this.camera.vp(t,e,o)).x,e=a.y}this.nativeContext.quadraticCurveTo(t,e,i,n)}},{key:"rect",value:function(t,e,i,n,r){r=r||0,this.camera?(this.moveTo(t,e,r),this.lineTo(t+i,e,r),this.lineTo(t+i,e+n,r),this.lineTo(t,e+n,r),this.closePath()):this.nativeContext.rect(t,e,i,n)}},{key:"createImageData",value:function(){var t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}},{key:"createLinearGradient",value:function(t,e,i,n){return this.nativeContext.createLinearGradient(t,e,i,n)}},{key:"createPattern",value:function(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}},{key:"createRadialGradient",value:function(t,e,i,n,r,o){return this.nativeContext.createRadialGradient(t,e,i,n,r,o)}},{key:"createConicGradient",value:function(t,e,i,n){var r,o=!1,a=this;return{stops:[],addColorStop:function(t,e){this.stops.push([t,e]),o=!0},GetPattern:function(s,l,u){return o&&(u||(u=n-i),r=function(t,e,i,n,r,o,a,s,l){var u=Math.floor(180*r/Math.PI),c=Bf.GetCanvas(),h=Bf.GetCtx();if(!h)return null;var d=Of.GetSize(s),f=Of.GetSize(l),p=Of.Get(e,i,n,o,a,d,f);if(p)return p;var v=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(n,2),Math.pow(d-i,2)+Math.pow(n,2)),Math.max(Math.pow(d-i,2)+Math.pow(f-n,2),Math.pow(i,2)+Math.pow(f-n,2)))),y=u+1,g=r/Math.max(1,y-1),m=Lf.getInstance().GetOrCreate(i,n,d,f,e,y),_=2*Math.PI*v/360;c.width=d,c.height=f,h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,d,f),h.translate(i,n),h.rotate(o);for(var b=0,x=y-1;b<x&&!(o+b*g>a);b++){var k=m.getColor(b);h.beginPath(),h.rotate(g),h.moveTo(0,0),h.lineTo(v,-2*_),h.lineTo(v,0),h.fillStyle=k,h.closePath(),h.fill()}var S=h.getImageData(0,0,d,f);return c.width=S.width,c.height=S.height,h.putImageData(S,0,0),(p=t.createPattern(c,"no-repeat"))&&Of.Set(e,i,n,o,a,p,d,f),p}(a,this.stops,t,e,u,i,n,s,l),o=!1),r}}}},{key:"fill",value:function(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}},{key:"fillRect",value:function(t,e,i,n){this.nativeContext.fillRect(t,e,i,n)}},{key:"clearRect",value:function(t,e,i,n){this.nativeContext.clearRect(t,e,i,n)}},{key:"project",value:function(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(Mx(VT,[t,e,i],this.modelMatrix),t=VT[0],e=VT[1],i=VT[2]);var n=this.camera.vp(t,e,i);t=n.x,e=n.y}return{x:t,y:e}}},{key:"view",value:function(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(Mx(VT,[t,e,i],this.modelMatrix),t=VT[0],e=VT[1],i=VT[2]),this.camera.view(t,e,i)):[t,e,i]}},{key:"fillText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(Mx(VT,[e,i,n],this.modelMatrix),e=VT[0],i=VT[1],n=VT[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.fillText(t,e,i)}},{key:"getImageData",value:function(t,e,i,n){return this.nativeContext.getImageData(t,e,i,n)}},{key:"getLineDash",value:function(){return this.nativeContext.getLineDash()}},{key:"isPointInPath",value:function(t,e){return this.nativeContext.isPointInPath(t,e)}},{key:"isPointInStroke",value:function(t,e){return this.nativeContext.isPointInStroke(t,e)}},{key:"measureText",value:function(t){var e,i,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nu.global.measureTextMethod;if(!r||"native"===r)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=nu.graphicUtil.createTextMeasureInstance({},{},(function(){return n.canvas.nativeCanvas})));var o=null!==(e=this.fontFamily)&&void 0!==e?e:zl.fontFamily,a=null!==(i=this.fontSize)&&void 0!==i?i:zl.fontSize;return this.mathTextMeasure.textSpec.fontFamily===o&&this.mathTextMeasure.textSpec.fontSize===a||(this.mathTextMeasure.textSpec.fontFamily=o,this.mathTextMeasure.textSpec.fontSize=a,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,r)}},{key:"putImageData",value:function(t,e,i){this.nativeContext.putImageData(t,e,i)}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}},{key:"stroke",value:function(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}},{key:"strokeRect",value:function(t,e,i,n){this.nativeContext.strokeRect(t,e,i,n)}},{key:"strokeText",value:function(t,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(Mx(VT,[e,i,n],this.modelMatrix),e=VT[0],i=VT[1],n=VT[2]);var r=this.camera.vp(e,i,n);e=r.x,i=r.y}this.nativeContext.strokeText(t,e,i)}},{key:"drawImage",value:function(){var t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}},{key:"setCommonStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(t,e,i,n,r[0]);var o=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(o,t)})),this._setCommonStyle(t,e,i,n,o)}return this._setCommonStyle(t,e,i,n,r)}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var o=this.nativeContext;r||(r=this.fillAttributes);var a=e.fillOpacity,s=void 0===a?r.fillOpacity:a,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;s>1e-12&&u>1e-12?(o.globalAlpha=s*u,o.fillStyle=Eg(this,h,t,i,n)):o.globalAlpha=s*u}},{key:"setShadowBlendStyle",value:function(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);var n=Object.create(i[0]);return i.forEach((function(t,e){0!==e&&Object.assign(n,t)})),this._setShadowBlendStyle(t,e,n)}return this._setShadowBlendStyle(t,e,i)}},{key:"_setShadowBlendStyle",value:function(t,e,i){var n=this.nativeContext;i||(i=this.fillAttributes);var r=e.opacity,o=void 0===r?i.opacity:r,a=e.shadowBlur,s=void 0===a?i.shadowBlur:a,l=e.shadowColor,u=void 0===l?i.shadowColor:l,c=e.shadowOffsetX,h=void 0===c?i.shadowOffsetX:c,d=e.shadowOffsetY,f=void 0===d?i.shadowOffsetY:d,p=e.blur,v=void 0===p?i.blur:p,y=e.globalCompositeOperation,g=void 0===y?i.globalCompositeOperation:y;o<=1e-12||(s||h||f?(n.shadowBlur=s*this.dpr,n.shadowColor=u,n.shadowOffsetX=h*this.dpr,n.shadowOffsetY=f*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),v?(n.filter="blur(".concat(v,"px)"),this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),g?(n.globalCompositeOperation=g,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1))}},{key:"setStrokeStyle",value:function(t,e,i,n,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(t,e,i,n,r[0]);var o=Object.create(r[0]);return r.forEach((function(t,e){0!==e&&Object.assign(o,t)})),this._setStrokeStyle(t,e,i,n,o)}return this._setStrokeStyle(t,e,i,n,r)}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var o=this.nativeContext;r||(r=this.strokeAttributes);var a=e.strokeOpacity,s=void 0===a?r.strokeOpacity:a,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,f=void 0===d?r.stroke:d,p=e.lineJoin,v=void 0===p?r.lineJoin:p,y=e.lineDash,g=void 0===y?r.lineDash:y,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b;o.globalAlpha=s*u,o.lineWidth=Cg(this,h,this.dpr),o.strokeStyle=Eg(this,f,t,i,n),o.lineJoin=v,o.setLineDash(g),o.lineCap=_,o.miterLimit=x}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e,i){var n=this.nativeContext;e||(e=this.textAttributes);var r=t.scaleIn3d,o=void 0===r?e.scaleIn3d:r;t.font?n.font=t.font:n.font=qf(t,e,o&&this.camera&&this.camera.getProjectionScale(i));var a=t.fontFamily,s=void 0===a?e.fontFamily:a,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,n.textAlign="left",n.textBaseline="alphabetic"}},{key:"setTextStyle",value:function(t,e,i){var n,r,o=this.nativeContext;e||(e=this.textAttributes),t.font?o.font=t.font:o.font=qf(t,e,this.camera&&this.camera.getProjectionScale(i));var a=t.fontFamily,s=void 0===a?e.fontFamily:a,l=t.fontSize,u=void 0===l?e.fontSize:l;this.fontFamily=s,this.fontSize=u,o.textAlign=null!==(n=t.textAlign)&&void 0!==n?n:e.textAlign,o.textBaseline=null!==(r=t.textBaseline)&&void 0!==r?r:e.textBaseline}},{key:"draw",value:function(){}},{key:"clearMatrix",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dpr;this.setTransformFromMatrix(GT,t,e)}},{key:"onlyTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dpr;return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}},{key:"release",value:function(){this.stack.forEach((function(t){return cg.free(t)})),this.stack.length=0}}]),t}();function UT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}WT.env="browser",WT=HT([Ya(),NT("design:paramtypes",[Object,Number])],WT);var YT=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},KT=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},XT=function(t){ue(i,t);var e=UT(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(t){var e=t.container;if("string"==typeof e){var i=nu.global.getElementById(e);i&&(this._container=i)}else this._container=e;this._context=new WT(this,this._dpr),this.initStyle()}},{key:"initStyle",value:function(){if(this.controled){var t=this.nativeCanvas;t.width=this._pixelWidth,t.height=this._pixelHeight,!t.style||this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}}},{key:"hide",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}},{key:"show",value:function(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}},{key:"applyPosition",value:function(){var t=this._nativeCanvas;t.style.position="absolute",t.style.top="".concat(this._y,"px"),t.style.left="".concat(this._x,"px")}},{key:"resetStyle",value:function(t){if(this.controled){var e=t.width,i=void 0===e?this._displayWidth:e,n=t.height,r=void 0===n?this._displayHeight:n,o=t.dpr,a=void 0===o?this._dpr:o,s=t.x,l=void 0===s?this._x:s,u=t.y,c=void 0===u?this._y:u,h=this.nativeCanvas;h.width=i*a,h.height=r*a,!h.style||this.setCanvasStyle(h,l,c,i,r),t.id&&(h.id=t.id),this.visiable||this.hide()}}},{key:"setCanvasStyle",value:function(t,e,i,n,r){this.controled&&(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"))}},{key:"toDataURL",value:function(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}},{key:"resize",value:function(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width="".concat(t,"px"),this._nativeCanvas.style.height="".concat(e,"px")),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}}]),i}(Wx);function ZT(t,e){return new La((function(i){i(bu).toDynamicValue((function(){return function(e){return new t(e)}})).whenTargetNamed(t.env),i(xu).toDynamicValue((function(){return function(t,i){return new e(t,i)}})).whenTargetNamed(e.env)}))}XT.env="browser";var qT=ZT(XT=YT([Ya(),KT("design:paramtypes",[Object])],XT),WT),JT=Symbol.for("MathPickerContribution"),QT=Symbol.for("MathArcPicker"),$T=Symbol.for("MathAreaPicker"),tM=Symbol.for("MathCirclePicker"),eM=Symbol.for("MathImagePicker"),iM=Symbol.for("MathLinePicker"),nM=Symbol.for("MathPathPicker"),rM=Symbol.for("MathRectPicker"),oM=Symbol.for("MathSymbolPicker"),aM=Symbol.for("MathTextPicker"),sM=Symbol.for("MathPolygonPicker"),lM=Symbol.for("MathGlyphPicker"),uM=Symbol.for("CanvasArcPicker"),cM=Symbol.for("CanvasArc3dPicker"),hM=Symbol.for("CanvasAreaPicker"),dM=Symbol.for("CanvasCirclePicker"),fM=Symbol.for("CanvasImagePicker"),pM=Symbol.for("CanvasLinePicker"),vM=Symbol.for("CanvasPathPicker"),yM=Symbol.for("CanvasRectPicker"),gM=Symbol.for("CanvasRect3dPicker"),mM=Symbol.for("CanvasSymbolPicker"),_M=Symbol.for("CanvasTextPicker"),bM=Symbol.for("CanvasPolygonPicker"),xM=Symbol.for("CanvasPyramid3dPicker"),kM=Symbol.for("CanvasRichTextPicker"),SM=Symbol.for("CanvasGlyphPicker"),AM=Symbol.for("CanvasGroupPicker"),wM=Symbol.for("CanvasPickerContribution");function TM(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var MM=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},CM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},EM=function(t,e){return function(i,n){e(i,n,t)}},RM=function(t){ue(i,t);var e=TM(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,r)).contributions=t,o.drawContribution=n,o.pickItemInterceptorContributions=r,o.global.hooks.onSetEnv.tap("canvas-picker-service",(function(t,e,i){o.configure(i,e)})),o.configure(o.global,o.global.env),o.pickerMap=new Map,o.init(),o}return zt(i,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),Xs(de(i.prototype),"_init",this).call(this)}},{key:"configure",value:function(t,e){this.pickCanvas=Qu.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(var r=0;r<this.InterceptorContributions.length;r++){var o=this.InterceptorContributions[r];if(o.beforePickItem){var a=o.beforePickItem(t,this,e,n,{parentMatrix:i});if(a)return a}}var s=this.pickerMap.get(t.numberType);if(!s)return null;var l=s.contains(t,e,n)?t:null,u={graphic:l};if(l)return u;if(this.InterceptorContributions.length)for(var c=0;c<this.InterceptorContributions.length;c++){var h=this.InterceptorContributions[c];if(h.afterPickItem){var d=h.afterPickItem(t,this,e,n,{parentMatrix:i});if(d)return d}}return u}}]),i}($x);RM=MM([Ya(),EM(0,Wa(cs)),EM(0,Ka(wM)),EM(1,Wa(W_)),EM(2,Wa(cs)),EM(2,Ka(tb)),CM("design:paramtypes",[Object,Object,Object])],RM);var PM=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},BM=function(){function t(){jt(this,t),this.type="group",this.numberType=Wd}return zt(t,[{key:"contains",value:function(t,e,i){return!1}}]),t}();BM=PM([Ya()],BM);var LM=new La((function(t,e,i,n){LM.__vloaded||(LM.__vloaded=!0,t(AM).to(BM).inSingletonScope(),t(wM).toService(AM),ds(t,wM))}));LM.__vloaded=!1;var OM=LM,IM=new La((function(t,e,i,n){i(RM)||t(RM).toSelf().inSingletonScope(),i(J_)?n(J_).toService(RM):t(J_).toService(RM)}));function DM(t){t.load(OM),t.load(IM)}function FM(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var zM,jM=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},HM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},NM=zM=function(t){ue(i,t);var e=FM(i);function i(){var t;return jt(this,i),(t=e.call(this)).type="browser",t._canvasIsIntersecting=!0,t.global=nu.global,t}return zt(i,[{key:"container",get:function(){return this.canvas.nativeCanvas.parentElement}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return this.canvas.nativeCanvas.getBoundingClientRect()}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}},{key:"postInit",value:function(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("发生错误，该环境不存在IntersectionObserver")}}},{key:"isElementVisible",value:function(t){var e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>n)}},{key:"observerCanvas",value:function(){var t=this;this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);var e=new IntersectionObserver((function(e,i){e.forEach((function(e){t._canvasIsIntersecting!==e.isIntersecting?(t._canvasIsIntersecting=e.isIntersecting,t._onVisibleChangeCb&&t._onVisibleChangeCb(e.isIntersecting)):t._canvasIsIntersecting=e.isIntersecting}))}));e&&e.observe(this.canvas.nativeCanvas)}},{key:"createWindowByConfig",value:function(t){var e,i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw new Error("发生错误，containerId可能传入有误");t.offscreen?e=null:e.appendChild(i);var n={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:zM.GenerateCanvasId(),canvasControled:!0};this.canvas=new XT(n)}},{key:"createWindowByCanvas",value:function(t){var e,i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else i=t.canvas;if(!i)throw new Error("发生错误，传入的canvas不正确");var n=t.width,r=t.height;if(null==n||null==r||!t.canvasControled){var o=i.getBoundingClientRect();n=o.width,r=o.height}var a=t.dpr;null==a&&(a=null!==(e=i.getContext("2d").pixelRatio)&&void 0!==e?e:i.width/n),this.canvas=new XT({width:n,height:r,dpr:a,nativeCanvas:i,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return this.canvas.nativeCanvas.dispatchEvent(t)}},{key:"getStyle",value:function(){return this.canvas.nativeCanvas.style}},{key:"setStyle",value:function(t){this.canvas.nativeCanvas.style=t}},{key:"getBoundingClientRect",value:function(){var t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t,e){var i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}},{key:"isVisible",value:function(t){return this._canvasIsIntersecting}},{key:"onVisibleChange",value:function(t){this._onVisibleChangeCb=t}},{key:"getTopLeft",value:function(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}}],[{key:"GenerateCanvasId",value:function(){return"".concat(zM.idprefix,"_").concat(zM.prefix_count++)}}]),i}(Zx);NM.env="browser",NM.idprefix="visactor_window",NM.prefix_count=0,NM=zM=jM([Ya(),HM("design:paramtypes",[])],NM);var VM=new La((function(t){t(NM).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(NM)})).whenTargetNamed(NM.env)}));function GM(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var WM=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},UM=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},YM=function(){function t(e){jt(this,t),this.dom=e}return zt(t,[{key:"x1",get:function(){return this.dom.getBoundingClientRect().left}},{key:"x2",get:function(){return this.dom.getBoundingClientRect().right}},{key:"y1",get:function(){return this.dom.getBoundingClientRect().top}},{key:"y2",get:function(){return this.dom.getBoundingClientRect().bottom}},{key:"width",get:function(){return this.dom.getBoundingClientRect().width}},{key:"height",get:function(){return this.dom.getBoundingClientRect().height}}]),t}();function KM(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.createElement("img");if(i.crossOrigin="anonymous",e){var n=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(n)}return i.src=t,i.complete?Promise.resolve(i):new Promise((function(t,e){i.onload=function(){t(i)},i.onerror=function(){e(new Error("加载失败"))}}))}var XM=function(t){ue(i,t);var e=GM(i);function i(){var t;jt(this,i),(t=e.call(this)).type="browser",t.supportEvent=!0;try{t.supportsTouchEvents="ontouchstart"in globalThis,t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsTouchEvents=!1,t.supportsPointerEvents=!1,t.supportsPointerEvents=!1}return t.applyStyles=!0,t}return zt(i,[{key:"mapToCanvasPoint",value:function(t,e){var i;if(e){var n,r,o=t.clientX,a=t.clientY,s=e.getBoundingClientRect(),l=null===(i=e.getNativeHandler)||void 0===i?void 0:i.call(e).nativeCanvas;return l&&(n=s.width/l.offsetWidth,r=s.height/l.offsetHeight),{x:(o-s.left)/(F(n)?n:1),y:(a-s.top)/(F(r)?r:1)}}return{x:t.offsetX,y:t.offsetY}}},{key:"getNativeAABBBounds",value:function(t){var e=t;if("string"==typeof t&&((e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild)),e.getBoundingClientRect){var i=e.getBoundingClientRect();return new YM(i)}return new ye}},{key:"removeDom",value:function(t){return t.parentElement.removeChild(t),!0}},{key:"createDom",value:function(t){var e=t.tagName,i=void 0===e?"div":e,n=t.width,r=t.height,o=t.style,a=t.parent,s=document.createElement(i);if(o&&(P(o)?s.setAttribute("style",o):Object.keys(o).forEach((function(t){s.setAttribute(t,o[t])}))),null!=n&&(s.style.width="".concat(n,"px")),null!=r&&(s.style.height="".concat(r,"px")),a){var l=P(a)?this.getElementById(a):a;l&&l.appendChild&&l.appendChild(s)}return s}},{key:"loadImage",value:function(t){return KM(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return KM(t,!0).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"createCanvas",value:function(t){var e,i,n=document.createElement("canvas");t.id&&(n.id=null!==(e=t.id)&&void 0!==e?e:Ba.GenAutoIncrementId().toString());var r=null!==(i=t.dpr)&&void 0!==i?i:window.devicePixelRatio;return t.width&&t.height&&(n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.width=t.width*r,n.height=t.height*r),n}},{key:"createOffscreenCanvas",value:function(t){var e,i=null!==(e=t.dpr)&&void 0!==e?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}},{key:"releaseCanvas",value:function(t){var e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getRequestAnimationFrame",value:function(){return window.requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return window.cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return document.addEventListener(t,e,i)}},{key:"removeEventListener",value:function(t,e,i){return document.removeEventListener(t,e,i)}},{key:"dispatchEvent",value:function(t){return document.dispatchEvent(t)}},{key:"getElementById",value:function(t){return document.getElementById(t)}},{key:"getRootElement",value:function(){return document.body}},{key:"getDocument",value:function(){return document}},{key:"release",value:function(){}},{key:"getElementTop",value:function(t,e){for(var i=t.offsetTop,n=t.offsetParent;null!==n;)i+=n.offsetTop,n=n.offsetParent;return i}},{key:"getElementLeft",value:function(t,e){for(var i=t.offsetLeft,n=t.offsetParent;null!==n;)i+=n.offsetLeft,n=n.offsetParent;return i}},{key:"getElementTopLeft",value:function(t,e){for(var i=t.offsetTop,n=t.offsetLeft,r=t.offsetParent;null!==r;)i+=r.offsetTop,n+=r.offsetLeft,r=r.offsetParent;return{top:i,left:n}}}]),i}(Yx);XM=WM([Ya(),UM("design:paramtypes",[])],XM);var ZM=new La((function(t){ZM.isBrowserBound||(ZM.isBrowserBound=!0,t(XM).toSelf().inSingletonScope(),t(ys).toService(XM))}));function qM(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];qM.__loaded||(qM.__loaded=!0,t.load(ZM),t.load(qT),t.load(VM),e&&DM(t))}function JM(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}ZM.isBrowserBound=!1,qM.__loaded=!1;var QM=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},$M=function(t){ue(i,t);var e=JM(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t,this._globalAlpha=t}},{key:"getImageData",value:function(t,e,i,n){var r=this;return new Promise((function(o,a){var s;try{tt.canvasGetImageData({canvasId:null!==(s=r.canvas.nativeCanvas.id)&&void 0!==s?s:r.canvas.id,x:t,y:e,width:i,height:n,success:function(t){o(t)}})}catch(t){a(t)}}))}},{key:"draw",value:function(){var t=this,e=this.nativeContext;e.draw&&(this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))})))}},{key:"createPattern",value:function(t,e){return null}}]),i}(WT);function tC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}$M.env="feishu",$M=QM([Ya()],$M);var eC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},iC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nC=function(t){ue(i,t);var e=tC(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(){this._context=new $M(this,this._dpr)}},{key:"release",value:function(){}}]),i}(Wx);nC.env="feishu";var rC=ZT(nC=eC([Ya(),iC("design:paramtypes",[Object])],nC),$M);function oC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var aC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},sC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},lC=function(t,e){return function(i,n){e(i,n,t)}},uC=function(){function t(){jt(this,t),this.cache={}}return zt(t,[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}]),t}(),cC=function(t){ue(i,t);var e=oC(i);function i(t){var n;return jt(this,i),(n=e.call(this)).global=t,n.type="feishu",n.eventManager=new uC,n}return zt(i,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:Ba.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new nC(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var o=t.dpr;null==o&&(o=e.width/i),this.canvas=new nC({width:i,height:n,dpr:o,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t,e){var i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}}]),i}(Zx);cC.env="feishu",cC=aC([Ya(),lC(0,Wa(gs)),sC("design:paramtypes",[Object])],cC);var hC=new La((function(t){t(cC).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(cC)})).whenTargetNamed(cC.env)}));function dC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var fC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},pC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vC=function(t,e){return function(i,n){e(i,n,t)}},yC=function(t){ue(i,t);var e=dC(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,n)).contributions=t,r.pickItemInterceptorContributions=n,r.global.hooks.onSetEnv.tap("math-picker-service",(function(t,e,i){r.configure(i,e)})),r.configure(r.global,r.global.env),r.pickerMap=new Map,r.init(),r}return zt(i,[{key:"init",value:function(){var t=this;this.contributions.getContributions().forEach((function(e){t.pickerMap.set(e.numberType,e)})),Xs(de(i.prototype),"_init",this).call(this)}},{key:"configure",value:function(t,e){this.pickContext=new zx(null,1)}},{key:"pickItem",value:function(t,e,i,n){if(!1===t.attribute.pickable)return null;var r=this.pickerMap.get(t.numberType);if(!r)return null;var o=r.contains(t,e,n)?t:null;return o?{graphic:o}:null}}]),i}($x);yC=fC([Ya(),vC(0,Wa(cs)),vC(0,Ka(JT)),vC(1,Wa(cs)),vC(1,Ka(tb)),pC("design:paramtypes",[Object,Object])],yC);var gC=new La((function(t){gC.__vloaded||(gC.__vloaded=!0,ds(t,JT))}));gC.__vloaded=!1;var mC=gC,_C=new La((function(t,e,i,n){i(yC)||t(yC).toSelf().inSingletonScope(),i(J_)?n(J_).toService(yC):t(J_).toService(yC)}));function bC(t){t.load(mC),t.load(_C)}function xC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var kC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},SC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var AC=function(t){ue(i,t);var e=xC(i);function i(){var t;jt(this,i),(t=e.call(this)).type="feishu",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return zt(i,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"configure",value:function(t,e){var i,n,r,o,a,s;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,o=e.freeCanvasIdx,a=this.freeCanvasList,s=tt.getSystemInfoSync().pixelRatio,n.forEach((function(t,e){var n=tt.createCanvasContext(t);n.canvas={width:i.width*s,height:i.height*s};var l={width:i.width*s,height:i.height*s,offsetWidth:i.width,offsetHeight:i.height,id:null!=t?t:"",getContext:function(){return n},getBoundingClientRect:function(){return{height:i.height,width:i.width}}};r.set(t,l),e>=o&&a.push(l)})))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return tt.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}]),i}(Yx);AC=kC([Ya(),SC("design:paramtypes",[])],AC);var wC=new La((function(t){wC.isFeishuBound||(wC.isFeishuBound=!0,t(AC).toSelf().inSingletonScope(),t(ys).toService(AC))}));function TC(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];TC.__loaded||(TC.__loaded=!0,t.load(wC),t.load(rC),t.load(hC),e&&bC(t))}function MC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}wC.isFeishuBound=!1,TC.__loaded=!1;var CC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},EC=function(t){ue(i,t);var e=MC(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.globalAlpha=t,this._globalAlpha=t}},{key:"setLineDash",value:function(t){var e=arguments,i=this.nativeContext;if(this.nativeContext.setLineDash){var n=e[0];if(0===n[0]&&0===n[1])return;i.setLineDash(n)}}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var o=this.nativeContext;r||(r=this.strokeAttributes);var a=e.strokeOpacity,s=void 0===a?r.strokeOpacity:a,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,f=void 0===d?r.stroke:d,p=e.lineJoin,v=void 0===p?r.lineJoin:p,y=e.lineDash,g=void 0===y?r.lineDash:y,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b;o.globalAlpha=s*u,o.lineWidth=Cg(this,h,this.dpr),o.strokeStyle=Eg(this,f,t,i,n),o.lineJoin=v,0===g[0]&&0===g[1]||o.setLineDash(g),o.lineCap=_,o.miterLimit=x}}},{key:"measureText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nu.global.measureTextMethod;return this.setTransform(1,0,0,1,0,0,!0,nu.global.devicePixelRatio),Xs(de(i.prototype),"measureText",this).call(this,t,e)}},{key:"createPattern",value:function(t,e){return null}},{key:"draw",value:function(){var t=this,e=this.nativeContext;this.drawPromise=new Promise((function(i){e.draw(!0,(function(){t.drawPromise=null,i(null)}))}))}}]),i}(WT);function RC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}EC.env="lynx",EC=CC([Ya()],EC);var PC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},BC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},LC=function(t){ue(i,t);var e=RC(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(){this._context=new EC(this,this._dpr)}},{key:"resize",value:function(t,e){this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._nativeCanvas.nativeCanvas&&(this._nativeCanvas.nativeCanvas.width=this._pixelWidth,this._nativeCanvas.nativeCanvas.height=this._pixelHeight),this._context.dpr=this._dpr}},{key:"release",value:function(){}}]),i}(Wx);function OC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}LC.env="lynx",LC=PC([Ya(),BC("design:paramtypes",[Object])],LC);var IC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},DC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},FC=function(t,e){return function(i,n){e(i,n,t)}},zC=function(){function t(){jt(this,t),this.cache={}}return zt(t,[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}]),t}(),jC=function(t){ue(i,t);var e=OC(i);function i(t){var n;return jt(this,i),(n=e.call(this)).global=t,n.type="lynx",n.eventManager=new zC,n}return zt(i,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:Ba.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new LC(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var o=t.dpr;null==o&&(o=e.width/i),this.canvas=new LC({width:i,height:n,dpr:o,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=t.changedTouches[0].x,t.changedTouches[0].clientX=t.changedTouches[0].x,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=t.changedTouches[0].y,t.changedTouches[0].clientY=t.changedTouches[0].y),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t,e){var i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}}]),i}(Zx);jC.env="lynx",jC=IC([Ya(),FC(0,Wa(gs)),DC("design:paramtypes",[Object])],jC);var HC=new La((function(t){t(jC).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(jC)})).whenTargetNamed(jC.env)})),NC=ZT(LC,EC);function VC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var GC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},WC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},UC=!1;try{UC=!!lynx.createCanvasNG}catch(t){}var YC=function(t){ue(i,t);var e=VC(i);function i(){var t;jt(this,i),(t=e.call(this)).type="lynx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return zt(i,[{key:"configure",value:function(t,e){var i,n,r,o,a,s;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,o=e.freeCanvasIdx,a=this.freeCanvasList,s=SystemInfo.pixelRatio,n.forEach((function(t,e){var n=UC?lynx.createCanvasNG(t):lynx.createCanvas(t);n.width=i.width*s,n.height=i.height*s,UC&&n.attachToCanvasView(t);var l=n.getContext("2d");l.draw=function(t,e){e()};var u={width:i.width*s,height:i.height*s,offsetWidth:i.width,offsetHeight:i.height,id:null!=t?t:"",getContext:function(){return l},getBoundingClientRect:function(){return{height:i.height,width:i.width}},nativeCanvas:n};r.set(t,u),e>=o&&a.push(u)})))}},{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"loadImage",value:function(t){return function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return Promise.reject();var e=lynx.createImage(t);return new Promise((function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(new Error("加载失败"))}}))}(t,!1).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return SystemInfo.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fh.clear(t)}}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}]),i}(Yx);YC=GC([Ya(),WC("design:paramtypes",[])],YC);var KC=new La((function(t){KC.isLynxBound||(KC.isLynxBound=!0,t(YC).toSelf().inSingletonScope(),t(ys).toService(YC))}));function XC(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];XC.__loaded||(XC.__loaded=!0,t.load(KC),t.load(NC),t.load(HC),e&&bC(t))}function ZC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}KC.isLynxBound=!1,XC.__loaded=!1;var qC=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},JC=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},QC=function(t){ue(i,t);var e=ZC(i);function i(t,n){var r;jt(this,i),r=e.call(this,t,n);var o=t.nativeCanvas.getContext("2d");if(!o)throw new Error("发生错误，获取2d上下文失败");return r.nativeContext=o,r.canvas=t,r.matrix=new ke(1,0,0,1,0,0),r.stack=[],r.dpr=null!=n?n:1,r}return zt(i,[{key:"release",value:function(){}}]),i}(WT);function $C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}QC.env="node",QC=qC([Ya(),JC("design:paramtypes",[Object,Number])],QC);var tE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},eE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},iE=function(t){ue(i,t);var e=$C(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(){this._context=new QC(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}},{key:"release",value:function(){this._nativeCanvas.release&&A(this._nativeCanvas.release)&&this._nativeCanvas.release()}}]),i}(Wx);iE.env="node";var nE=ZT(iE=tE([Ya(),eE("design:paramtypes",[Object])],iE),QC);function rE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var oE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},aE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},sE=function(t,e){return function(i,n){e(i,n,t)}},lE=function(t){ue(i,t);var e=rE(i);function i(t){var n;return jt(this,i),(n=e.call(this)).global=t,n.type="node",n}return zt(i,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return""}},{key:"getWH",value:function(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:Ba.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new iE(i)}},{key:"createWindowByCanvas",value:function(t){var e=t.canvas,i=t.width,n=t.height;null!=i&&null!=n&&t.canvasControled||(i=e.width,n=e.height),this.canvas=new iE({width:i,height:n,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){this.canvas.release()}},{key:"resizeWindow",value:function(t,e){this.canvas.resize(t,e)}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"getImageBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png";return this.canvas.nativeCanvas.toBuffer(t)}},{key:"addEventListener",value:function(t,e,i){}},{key:"dispatchEvent",value:function(t){return!0}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getStyle",value:function(){}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){return null}},{key:"clearViewBox",value:function(t,e){}}]),i}(Zx);lE.env="node",lE=oE([Ya(),sE(0,Wa(gs)),aE("design:paramtypes",[Object])],lE);var uE=new La((function(t){t(lE).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(lE)})).whenTargetNamed(lE.env)}));function cE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var hE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},dE=function(t){ue(i,t);var e=cE(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).type="node",t._lastTime=0,t.supportEvent=!1,t}return zt(i,[{key:"configure",value:function(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}},{key:"getDynamicCanvasCount",value:function(){return 0}},{key:"getStaticCanvasCount",value:function(){return 999}},{key:"loadJson",value:function(t){var e=fetch(t).then((function(t){return t.json()}));return e.then((function(t){return{data:t,state:"success"}})).catch((function(){return{data:null,state:"fail"}})),e}},{key:"loadArrayBuffer",value:function(t){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,loadState:"success"}})).catch((function(){return{data:null,loadState:"fail"}}))}},{key:"loadImage",value:function(t){var e=this.pkg.loadImage;return e?e(t).then((function(t){return{loadState:t?"success":"fail",data:t}})).catch((function(){return{loadState:"fail",data:null}})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}},{key:"loadSvg",value:function(t){var e=this.pkg.Resvg;if(!e)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));var i=new e(t).render().asPng();return this.loadImage(i)}},{key:"createCanvas",value:function(t){return this.pkg.createCanvas(t.width,t.height)}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){}},{key:"removeEventListener",value:function(t,e,i){}},{key:"getElementById",value:function(t){return null}},{key:"getRootElement",value:function(){return null}},{key:"dispatchEvent",value:function(t){}},{key:"release",value:function(){}},{key:"createOffscreenCanvas",value:function(t){}}]),i}(Yx);dE=hE([Ya()],dE);var fE=new La((function(t){fE.isNodeBound||(fE.isNodeBound=!0,t(dE).toSelf().inSingletonScope(),t(ys).toService(dE))}));function pE(t){pE.__loaded||(pE.__loaded=!0,t.load(fE),t.load(nE),t.load(uE))}function vE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}fE.isNodeBound=!1,pE.__loaded=!1;var yE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},gE=function(t){ue(i,t);var e=vE(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"globalAlpha",get:function(){return this._globalAlpha},set:function(t){this.nativeContext.setGlobalAlpha(t),this._globalAlpha=t}},{key:"draw",value:function(){this.nativeContext.draw()}},{key:"strokeText",value:function(t,e,i){}},{key:"_setCommonStyle",value:function(t,e,i,n,r){var o=this.nativeContext;r||(r=this.fillAttributes);var a=e.fillOpacity,s=void 0===a?r.fillOpacity:a,l=e.opacity,u=void 0===l?r.opacity:l,c=e.fill,h=void 0===c?r.fill:c;s>1e-12&&u>1e-12&&(o.setGlobalAlpha(s*u),o.setFillStyle(Eg(this,h,t,i,n)))}},{key:"_setStrokeStyle",value:function(t,e,i,n,r){var o=this.nativeContext;r||(r=this.strokeAttributes);var a=e.strokeOpacity,s=void 0===a?r.strokeOpacity:a,l=e.opacity,u=void 0===l?r.opacity:l;if(s>1e-12&&u>1e-12){var c=e.lineWidth,h=void 0===c?r.lineWidth:c,d=e.stroke,f=void 0===d?r.stroke:d,p=e.lineJoin,v=void 0===p?r.lineJoin:p,y=e.lineDash,g=void 0===y?r.lineDash:y,m=e.lineCap,_=void 0===m?r.lineCap:m,b=e.miterLimit,x=void 0===b?r.miterLimit:b;o.setGlobalAlpha(s*u),o.setLineWidth(Cg(this,h,this.dpr)),o.setStrokeStyle(Eg(this,f,t,i,n)),o.setLineJoin(v),o.setLineDash(g),o.setLineCap(_),o.setMiterLimit(x)}}},{key:"setTextStyleWithoutAlignBaseline",value:function(t,e){var i,n=this.nativeContext;e||(e=this.textAttributes),t.font?n.font=t.font:n.font=qf(t,e),n.setFontSize(null!==(i=t.fontSize)&&void 0!==i?i:e.fontSize)}},{key:"setTextStyle",value:function(t,e){var i,n,r=this.nativeContext;e||(e=this.textAttributes),t.font?r.font=t.font:r.font=qf(t,e),r.setTextAlign(null!==(i=t.textAlign)&&void 0!==i?i:e.textAlign),r.setTextBaseline(null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline)}},{key:"createConicGradient",value:function(t,e,i,n){return null}},{key:"createPattern",value:function(t,e){return null}}]),i}(WT);function mE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}gE.env="taro",gE=yE([Ya()],gE);var _E=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},bE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xE=function(t){ue(i,t);var e=mE(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(){this._context=new gE(this,this._dpr)}},{key:"release",value:function(){}}]),i}(Wx);xE.env="taro";var kE=ZT(xE=_E([Ya(),bE("design:paramtypes",[Object])],xE),gE);function SE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var AE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},wE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},TE=function(t,e){return function(i,n){e(i,n,t)}},ME=function(){function t(){jt(this,t),this.cache={}}return zt(t,[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}]),t}(),CE=function(t){ue(i,t);var e=SE(i);function i(t){var n;return jt(this,i),(n=e.call(this)).global=t,n.type="taro",n.eventManager=new ME,n}return zt(i,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:Ba.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new xE(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var o=t.dpr;null==o&&(o=e.width/i),this.canvas=new xE({width:i,height:n,dpr:o,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e=t.type;return!!this.eventManager.cache[e]&&(t.changedTouches.length>0&&(t.changedTouches.forEach((function(e,i){t.changedTouches[i]=Object.assign(Object.assign({},t.changedTouches[i]),{offsetX:e.x,offsetY:e.y})})),t.offsetX=t.changedTouches[0].offsetX,t.offsetY=t.changedTouches[0].offsetY),t.touches.length>0&&t.touches.forEach((function(e,i){t.touches[i]=Object.assign(Object.assign({},t.touches[i]),{offsetX:e.x,offsetY:e.y})})),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[e].listener&&this.eventManager.cache[e].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t,e){var i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}}]),i}(Zx);CE.env="taro",CE=AE([Ya(),TE(0,Wa(gs)),wE("design:paramtypes",[Object])],CE);var EE=new La((function(t){t(CE).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(CE)})).whenTargetNamed(CE.env)}));function RE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var PE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},BE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};var LE=function(t){ue(i,t);var e=RE(i);function i(){var t;jt(this,i),(t=e.call(this)).type="taro",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return zt(i,[{key:"getDynamicCanvasCount",value:function(){return this.freeCanvasList.length}},{key:"getStaticCanvasCount",value:function(){return 9999}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}},{key:"configure",value:function(t,e){var i,n,r,o,a,s,l;t.env===this.type&&(t.setActiveEnvContribution(this),i=e.domref,n=e.canvasIdLists,r=this.canvasMap,o=e.freeCanvasIdx,a=this.freeCanvasList,s=e.taro,l=e.pixelRatio,n.forEach((function(t,e){var n=s.createCanvasContext(t);n.canvas={width:i.width*l,height:i.height*l},n.createRadialGradient||(n.createRadialGradient=function(){return n.createCircularGradient.apply(n,arguments)}),!n.getImageData&&s.canvasGetImageData&&(n.getImageData=function(e,i,n,r){return new Promise((function(o,a){try{s.canvasGetImageData({canvasId:t,x:e,y:i,width:n,height:r,success:function(t){o(t)}})}catch(t){a(t)}}))});var u={id:t,width:i.width*l,height:i.height*l,offsetWidth:i.width,offsetHeight:i.height,getContext:function(){return n},getBoundingClientRect:function(){return{height:i.height,width:i.width}}};return r.set(t,u),e>=o&&a.push(u),u})),this.taro=e.taro,this.pixelRatio=e.pixelRatio)}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){var e=window||globalThis;if(e.DOMParser){var i=(new e.DOMParser).parseFromString(t,"image/svg+xml").children[0],n=(new XMLSerializer).serializeToString(i),r="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n));return Promise.resolve({data:r,loadState:"success"})}if(e.Blob){var o=new e.Blob([t],{type:"image/svg+xml"}),a=e.URL.createObjectURL(o);return Promise.resolve({data:a,loadState:"success"})}return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return this.pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return requestAnimationFrame}},{key:"getCancelAnimationFrame",value:function(){return cancelAnimationFrame}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}}]),i}(Yx);LE=PE([Ya(),BE("design:paramtypes",[])],LE);var OE=new La((function(t){OE.isTaroBound||(OE.isTaroBound=!0,t(LE).toSelf().inSingletonScope(),t(ys).toService(LE))}));function IE(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];IE.__loaded||(IE.__loaded=!0,t.load(OE),t.load(kE),t.load(EE),e&&bC(t))}function DE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}OE.isTaroBound=!1,IE.__loaded=!1;var FE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},zE=function(t){ue(i,t);var e=DE(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"draw",value:function(){}},{key:"createPattern",value:function(t,e){return null}}]),i}(WT);function jE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}zE.env="wx",zE=FE([Ya()],zE);var HE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},NE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},VE=function(t){ue(i,t);var e=jE(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i,[{key:"init",value:function(){this._context=new zE(this,this._dpr)}},{key:"release",value:function(){}}]),i}(Wx);VE.env="wx";var GE=ZT(VE=HE([Ya(),NE("design:paramtypes",[Object])],VE),zE);function WE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var UE=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},YE=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},KE=function(t,e){return function(i,n){e(i,n,t)}},XE=function(){function t(){jt(this,t),this.cache={}}return zt(t,[{key:"addEventListener",value:function(t,e){t&&e&&(this.cache[t]=this.cache[t]||{listener:[]},this.cache[t].listener.push(e))}},{key:"removeEventListener",value:function(t,e){if(t&&e&&this.cache[t]){var i=this.cache[t].listener.findIndex((function(t){return t===e}));i>=0&&this.cache[t].listener.splice(i,1)}}},{key:"cleanEvent",value:function(){this.cache={}}}]),t}(),ZE=function(t){ue(i,t);var e=WE(i);function i(t){var n;return jt(this,i),(n=e.call(this)).global=t,n.type="wx",n.eventManager=new XE,n}return zt(i,[{key:"container",get:function(){return null}},{key:"getTitle",value:function(){return this.canvas.id.toString()}},{key:"getWH",value:function(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}},{key:"getXY",value:function(){return{x:0,y:0}}},{key:"createWindow",value:function(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}},{key:"createWindowByConfig",value:function(t){var e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:Ba.GenAutoIncrementId().toString(),canvasControled:!1};this.canvas=new VE(i)}},{key:"createWindowByCanvas",value:function(t){var e;if("string"==typeof t.canvas){if(!(e=this.global.getElementById(t.canvas)))throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=t.canvas;var i=t.width,n=t.height;if(null==i||null==n||!t.canvasControled){var r=e.getBoundingClientRect();i=r.width,n=r.height}var o=t.dpr;null==o&&(o=e.width/i),this.canvas=new VE({width:i,height:n,dpr:o,nativeCanvas:e,canvasControled:t.canvasControled})}},{key:"releaseWindow",value:function(){}},{key:"resizeWindow",value:function(t,e){}},{key:"setDpr",value:function(t){this.canvas.dpr=t}},{key:"getContext",value:function(){return this.canvas.getContext()}},{key:"getNativeHandler",value:function(){return this.canvas}},{key:"getDpr",value:function(){return this.canvas.dpr}},{key:"addEventListener",value:function(t,e){this.eventManager.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){this.eventManager.removeEventListener(t,e)}},{key:"dispatchEvent",value:function(t){var e,i,n,r,o=t.type;return!!this.eventManager.cache[o]&&(t.changedTouches&&t.changedTouches[0]&&(t.offsetX=t.changedTouches[0].x,t.changedTouches[0].offsetX=null!==(e=t.changedTouches[0].x)&&void 0!==e?e:t.changedTouches[0].pageX,t.changedTouches[0].clientX=null!==(i=t.changedTouches[0].x)&&void 0!==i?i:t.changedTouches[0].pageX,t.offsetY=t.changedTouches[0].y,t.changedTouches[0].offsetY=null!==(n=t.changedTouches[0].y)&&void 0!==n?n:t.changedTouches[0].pageY,t.changedTouches[0].clientY=null!==(r=t.changedTouches[0].y)&&void 0!==r?r:t.changedTouches[0].pageY),t.preventDefault=function(){},t.stopPropagation=function(){},this.eventManager.cache[o].listener&&this.eventManager.cache[o].listener.forEach((function(e){e(t)})),!0)}},{key:"getStyle",value:function(){return{}}},{key:"setStyle",value:function(t){}},{key:"getBoundingClientRect",value:function(){var t=this.getWH();return{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}},{key:"clearViewBox",value:function(t,e){var i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}}]),i}(Zx);ZE.env="wx",ZE=UE([Ya(),KE(0,Wa(gs)),YE("design:paramtypes",[Object])],ZE);var qE=new La((function(t){t(ZE).toSelf(),t(ic).toDynamicValue((function(t){return t.container.get(ZE)})).whenTargetNamed(ZE.env)}));function JE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function QE(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */QE=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var $E=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},tR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},eR=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};var iR=function(t){ue(i,t);var e=JE(i);function i(){var t;jt(this,i),(t=e.call(this)).type="wx",t.supportEvent=!0,t.canvasMap=new Map,t.freeCanvasList=[],t.canvasIdx=0,t.supportsTouchEvents=!0;try{t.supportsPointerEvents=!!globalThis.PointerEvent,t.supportsMouseEvents=!!globalThis.MouseEvent}catch(e){t.supportsPointerEvents=!1,t.supportsMouseEvents=!1}return t.applyStyles=!0,t}return zt(i,[{key:"configure",value:function(t,e){if(t.env===this.type)return t.setActiveEnvContribution(this),function(t,e,i,n,r,o){return eR(this,void 0,void 0,QE().mark((function t(){var a,s,l;return QE().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=wx.getSystemInfoSync().pixelRatio,s=QE().mark((function t(s){var l;return QE().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e[s],t.next=3,new Promise((function(t){var e=wx.createSelectorQuery();o&&(e=e.in(o)),e.select("#".concat(l)).fields({node:!0,size:!0}).exec((function(e){if(e[0]){var o=e[0].node,u=e[0].width,c=e[0].height;o.width=u*a,o.height=c*a,i.set(l,o),s>=n&&r.push(o),t(null)}}))}));case 3:case"end":return t.stop()}}),t)})),l=0;case 3:if(!(l<e.length)){t.next=8;break}return t.delegateYield(s(l),"t0",5);case 5:l++,t.next=3;break;case 8:case"end":return t.stop()}}),t)})))}(e.domref,e.canvasIdLists,this.canvasMap,e.freeCanvasIdx,this.freeCanvasList,e.component).then((function(){}))}},{key:"loadImage",value:function(t){return Promise.resolve({data:t,loadState:"success"})}},{key:"loadSvg",value:function(t){return Promise.reject()}},{key:"createCanvas",value:function(t){var e=this.freeCanvasList[this.canvasIdx]||this.freeCanvasList[this.freeCanvasList.length-1];return this.canvasIdx++,e}},{key:"createOffscreenCanvas",value:function(t){}},{key:"releaseCanvas",value:function(t){}},{key:"getDevicePixelRatio",value:function(){return wx.getSystemInfoSync().pixelRatio}},{key:"getRequestAnimationFrame",value:function(){return function(t){return fh.call(t)}}},{key:"getCancelAnimationFrame",value:function(){return function(t){fh.clear(t)}}},{key:"addEventListener",value:function(t,e,i){return null}},{key:"removeEventListener",value:function(t,e,i){return null}},{key:"dispatchEvent",value:function(t){return null}},{key:"getElementById",value:function(t){return this.canvasMap.get(t)}},{key:"getRootElement",value:function(){return null}},{key:"getDocument",value:function(){return null}},{key:"release",value:function(){}},{key:"mapToCanvasPoint",value:function(t){var e;return null===(e=null==t?void 0:t.type)||void 0===e||e.startsWith("mouse"),t}}]),i}(Yx);iR=$E([Ya(),tR("design:paramtypes",[])],iR);var nR=new La((function(t){nR._isWxBound||(nR._isWxBound=!0,t(iR).toSelf().inSingletonScope(),t(ys).toService(iR))}));function rR(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];rR.__loaded||(rR.__loaded=!0,t.load(nR),t.load(GE),t.load(qE),e&&bC(t))}function oR(t){oR.__loaded||(oR.__loaded=!0,qM(t,!1),TC(t,!1),XC(t,!1),pE(t),IE(t,!1),rR(t,!1),DM(t),ux.hooks.onSetEnv.tap("loadMathPicker",(function(e,i){"browser"!==i&&bC(t)})))}function aR(){!function(t){oR(t)}(_u)}nR._isWxBound=!1,rR.__loaded=!1,oR.__loaded=!1;var sR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},lR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},uR=function(t,e){return function(i,n){e(i,n,t)}},cR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="arc",this.numberType=jd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).arc;n.highPerformanceSave();var o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=Cg(n,o+a,n.dpr),h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();cR=sR([Ya(),uR(0,Wa(M_)),lR("design:paramtypes",[Object])],cR);var hR=!1,dR=new La((function(t,e,i,n){hR||(hR=!0,t(uM).to(cR).inSingletonScope(),t(wM).toService(uM))})),fR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},pR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},vR=function(t,e){return function(i,n){e(i,n,t)}},yR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="arc",this.numberType=jd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).arc;n.highPerformanceSave();var o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();yR=fR([Ya(),vR(0,Wa(M_)),pR("design:paramtypes",[Object])],yR);var gR=!1,mR=new La((function(t,e,i,n){gR||(gR=!0,t(QT).to(yR).inSingletonScope(),t(JT).toService(QT))})),_R=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},bR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},xR=function(t,e){return function(i,n){e(i,n,t)}},kR=new ye,SR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="rect",this.numberType=qd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).rect,o=t.attribute.cornerRadius,a=void 0===o?r.cornerRadius:o,s=t.attribute,l=s.x,u=void 0===l?r.x:l,c=s.y,h=void 0===c?r.y:c;n.highPerformanceSave();var d=!0;if(t.transMatrix.onlyTranslate()){var f=t.getOffsetXY(r);u+=f.x,h+=f.y,n.setTransformForCurrent()}else u=0,h=0,d=!1,n.transformFromMatrix(t.transMatrix,!0);var p=!0;if(!d||t.shadowRoot||I(a,!0)&&0!==a||B(a)&&a.some((function(t){return 0!==t})))p=!1,this.canvasRenderer.drawShape(t,n,u,h,{},null,(function(t,i,n){return!!p||(p=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(p)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=Cg(n,o+a,n.dpr),p=t.isPointInStroke(e.x,e.y)}));else{var v=t.attribute,y=v.fill,g=void 0===y?r.fill:y,m=v.stroke,_=void 0===m?r.stroke:m,b=v.lineWidth,x=void 0===b?r.lineWidth:b;if(g)p=!0;else if(_){var k=t.AABBBounds;kR.setValue(k.x1,k.y1,k.x2,k.y2),kR.expand(-x/2),p=!kR.containsPoint(e)}}return n.highPerformanceRestore(),p}}]),t}();SR=_R([Ya(),xR(0,Wa(D_)),bR("design:paramtypes",[Object])],SR);var AR=!1,wR=new La((function(t,e,i,n){AR||(AR=!0,t(yM).to(SR).inSingletonScope(),t(wM).toService(yM))})),TR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},MR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},CR=function(t,e){return function(i,n){e(i,n,t)}},ER=new ye,RR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="rect",this.numberType=qd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).rect,o=t.attribute.cornerRadius,a=void 0===o?r.cornerRadius:o,s=t.attribute,l=s.x,u=void 0===l?r.x:l,c=s.y,h=void 0===c?r.y:c;n.highPerformanceSave();var d=!0;if(t.transMatrix.onlyTranslate()){var f=t.getOffsetXY(r);u+=f.x,h+=f.y,n.setTransformForCurrent()}else u=0,h=0,d=!1,n.transformFromMatrix(t.transMatrix,!0);var p=!0;if(!d||I(a,!0)&&0!==a||B(a)&&a.some((function(t){return 0!==t})))p=!1,this.canvasRenderer.drawShape(t,n,u,h,{},null,(function(t,i,n){return!!p||(p=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(p)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,p=t.isPointInStroke(e.x,e.y)}));else if(p){var v=t.attribute,y=v.fill,g=void 0===y?r.fill:y,m=v.stroke,_=void 0===m?r.stroke:m,b=v.lineWidth,x=void 0===b?r.lineWidth:b;if(g)p=!0;else if(_){var k=t.AABBBounds;ER.setValue(k.x1,k.y1,k.x2,k.y2),ER.expand(-x/2),p=!ER.containsPoint(e)}}return n.highPerformanceRestore(),p}}]),t}();RR=TR([Ya(),CR(0,Wa(D_)),MR("design:paramtypes",[Object])],RR);var PR=!1,BR=new La((function(t,e,i,n){PR||(PR=!0,t(rM).to(RR).inSingletonScope(),t(JT).toService(rM))}));function LR(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var OR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},IR=function(t){ue(i,t);var e=LR(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i)}(wg);function DR(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var FR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},zR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},jR=function(t,e){return function(i,n){e(i,n,t)}},HR=function(t){ue(i,t);var e=DR(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="line",n.numberType=Yd,n}return zt(i,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;n.highPerformanceSave();var r=gc(t).line,o=this.transform(t,r,n),a=o.x,s=o.y,l=o.z,u=o.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,a,s,{},null,(function(t){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){if(d)return!0;var r=e.lineWidth||i.lineWidth,o=e.pickStrokeBuffer||i.pickStrokeBuffer;return n.lineWidth=Cg(n,r+o,n.dpr),d=t.isPointInStroke(c.x,c.y)})),this.canvasRenderer.z=0,n.modelMatrix!==u&&hg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}]),i}(IR=OR([Ya()],IR));HR=FR([Ya(),jR(0,Wa(L_)),zR("design:paramtypes",[Object])],HR);var NR=!1,VR=new La((function(t,e,i,n){NR||(NR=!0,t(pM).to(HR).inSingletonScope(),t(wM).toService(pM))})),GR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},WR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},UR=function(t,e){return function(i,n){e(i,n,t)}},YR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="line",this.numberType=Yd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).line,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();YR=GR([Ya(),UR(0,Wa(L_)),WR("design:paramtypes",[Object])],YR);var KR=!1,XR=new La((function(t,e,i,n){KR||(KR=!0,t(iM).to(YR).inSingletonScope(),t(JT).toService(iM))})),ZR=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},qR=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},JR=function(t,e){return function(i,n){e(i,n,t)}},QR=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="area",this.numberType=Nd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).area,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l,c=t.attribute,h=c.fillPickable,d=void 0===h?r.fillPickable:h,f=c.strokePickable,p=void 0===f?r.strokePickable:f;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var v=t.getOffsetXY(r);s+=v.x,u+=v.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var y=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t){return!!y||!!d&&(y=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(y)return!0;if(!p)return!1;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=Cg(n,o+a,n.dpr),y=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),y}}]),t}();QR=ZR([Ya(),JR(0,Wa(E_)),qR("design:paramtypes",[Object])],QR);var $R=!1,tP=new La((function(t,e,i,n){$R||($R=!0,t(hM).to(QR).inSingletonScope(),t(wM).toService(hM))})),eP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},iP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nP=function(t,e){return function(i,n){e(i,n,t)}},rP=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="area",this.numberType=Nd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).area,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t){return!!h||(h=t.isPointInPath(e.x,e.y))})),n.highPerformanceRestore(),h}}]),t}();rP=eP([Ya(),nP(0,Wa(E_)),iP("design:paramtypes",[Object])],rP);var oP=!1,aP=new La((function(t,e,i,n){oP||(oP=!0,t($T).to(rP).inSingletonScope(),t(JT).toService($T))}));function sP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var lP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},uP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},cP=function(t,e){return function(i,n){e(i,n,t)}},hP=function(t){ue(i,t);var e=sP(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="symbol",n.numberType=$d,n}return zt(i,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.getParsedPath();if(!n.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(r.isSvg||"imprecise"===t.attribute.pickMode)return!0}n.highPerformanceSave();var o=gc(t).symbol,a=this.transform(t,o,n),s=a.x,l=a.y,u=a.z,c=a.lastModelMatrix,h=e;if(n.camera){h=e.clone();var d=t.parent.globalTransMatrix;h.x=d.a*e.x+d.c*e.y+d.e,h.y=d.b*e.x+d.d*e.y+d.f}this.canvasRenderer.z=u;var f=!1;return this.canvasRenderer.drawShape(t,n,s,l,{},null,(function(t,e,i){return!!f||(f=t.isPointInPath(h.x,h.y))}),(function(t,e,i){if(f)return!0;var r=e.lineWidth||i.lineWidth,o=e.pickStrokeBuffer||i.pickStrokeBuffer;return n.lineWidth=Cg(n,r+o,n.dpr),f=t.isPointInStroke(h.x,h.y)})),this.canvasRenderer.z=0,n.modelMatrix!==c&&hg.free(n.modelMatrix),n.modelMatrix=c,n.highPerformanceRestore(),f}}]),i}(IR);hP=lP([Ya(),cP(0,Wa(z_)),uP("design:paramtypes",[Object])],hP);var dP=!1,fP=new La((function(t,e,i,n){dP||(dP=!0,t(mM).to(hP).inSingletonScope(),t(wM).toService(mM))})),pP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},vP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},yP=function(t,e){return function(i,n){e(i,n,t)}},gP=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="symbol",this.numberType=$d}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).symbol,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();gP=pP([Ya(),yP(0,Wa(z_)),vP("design:paramtypes",[Object])],gP);var mP=!1,_P=new La((function(t,e,i,n){mP||(mP=!0,t(oM).to(gP).inSingletonScope(),t(JT).toService(oM))})),bP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},xP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},kP=function(t,e){return function(i,n){e(i,n,t)}},SP=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="circle",this.numberType=Vd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).circle,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=Cg(n,o+a,n.dpr),h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();SP=bP([Ya(),kP(0,Wa(R_)),xP("design:paramtypes",[Object])],SP);var AP=!1,wP=new La((function(t,e,i,n){AP||(AP=!0,t(dM).to(SP).inSingletonScope(),t(wM).toService(dM))})),TP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},MP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},CP=function(t,e){return function(i,n){e(i,n,t)}},EP=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="circle",this.numberType=Vd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).circle,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();EP=TP([Ya(),CP(0,Wa(R_)),MP("design:paramtypes",[Object])],EP);var RP=!1,PP=new La((function(t,e,i,n){RP||(RP=!0,t(tM).to(EP).inSingletonScope(),t(JT).toService(tM))}));function BP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var LP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},OP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},IP=function(t,e){return function(i,n){e(i,n,t)}},DP=function(t){ue(i,t);var e=BP(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="text",n.numberType=tf,n}return zt(i,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=t.AABBBounds;if(!n.camera)return!!r.containsPoint(e);n.highPerformanceSave();var o=gc(t).text,a=t.attribute.keepDirIn3d,s=!(void 0===a?o.keepDirIn3d:a),l=this.transform(t,o,n,s),u=l.x,c=l.y,h=l.z,d=l.lastModelMatrix;this.canvasRenderer.z=h;var f=e;if(n.camera){f=e.clone();var p=t.parent.globalTransMatrix;f.x=p.a*e.x+p.c*e.y+p.e,f.y=p.b*e.x+p.d*e.y+p.f}var v=!1;return this.canvasRenderer.drawShape(t,n,u,c,{},null,(function(e,i,n){if(v)return!0;var r=t.attribute,a=r.fontSize,s=void 0===a?o.fontSize:a,l=r.textBaseline,d=void 0===l?o.textBaseline:l,p=r.textAlign,y=void 0===p?o.textAlign:p,g=t.AABBBounds,m=g.height(),_=g.width(),b=Qf(d,m,s),x=Jf(y,_);return e.rect(x+u,b+c,_,m,h),v=e.isPointInPath(f.x,f.y)}),(function(t,e,i){return v})),this.canvasRenderer.z=0,n.modelMatrix!==d&&hg.free(n.modelMatrix),n.modelMatrix=d,n.highPerformanceRestore(),v}}]),i}(IR);DP=LP([Ya(),IP(0,Wa(j_)),OP("design:paramtypes",[Object])],DP);var FP=!1,zP=new La((function(t,e,i,n){FP||(FP=!0,t(_M).to(DP).inSingletonScope(),t(wM).toService(_M))})),jP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},HP=function(){function t(){jt(this,t),this.type="text",this.numberType=tf}return zt(t,[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}]),t}();HP=jP([Ya()],HP);var NP=!1,VP=new La((function(t,e,i,n){NP||(NP=!0,t(aM).to(HP).inSingletonScope(),t(JT).toService(aM))}));function GP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var WP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},UP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},YP=function(t,e){return function(i,n){e(i,n,t)}},KP=function(t){ue(i,t);var e=GP(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="path",n.numberType=Kd,n}return zt(i,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).path;n.highPerformanceSave();var o=this.transform(t,r,n),a=o.x,s=o.y,l=o.z,u=o.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,a,s,{},null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){if(d)return!0;var r=e.lineWidth||i.lineWidth,o=e.pickStrokeBuffer||i.pickStrokeBuffer;return n.lineWidth=Cg(n,r+o,n.dpr),d=t.isPointInStroke(c.x,c.y)})),this.canvasRenderer.z=0,n.modelMatrix!==u&&hg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}]),i}(IR);KP=WP([Ya(),YP(0,Wa(O_)),UP("design:paramtypes",[Object])],KP);var XP=!1,ZP=new La((function(t,e,i,n){XP||(XP=!0,t(vM).to(KP).inSingletonScope(),t(wM).toService(vM))})),qP=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},JP=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},QP=function(t,e){return function(i,n){e(i,n,t)}},$P=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="path",this.numberType=Kd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).path,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();$P=qP([Ya(),QP(0,Wa(O_)),JP("design:paramtypes",[Object])],$P);var tB=!1,eB=new La((function(t,e,i,n){tB||(tB=!0,t(nM).to($P).inSingletonScope(),t(JT).toService(nM))})),iB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},nB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},rB=function(t,e){return function(i,n){e(i,n,t)}},oB=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="polygon",this.numberType=Xd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.contains(e.x,e.y))return!1;if("imprecise"===t.attribute.pickMode)return!0;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).polygon,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=Cg(n,o+a,n.dpr),h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();oB=iB([Ya(),rB(0,Wa(I_)),nB("design:paramtypes",[Object])],oB);var aB=!1,sB=new La((function(t,e,i,n){aB||(aB=!0,t(bM).to(oB).inSingletonScope(),t(wM).toService(bM))})),lB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},uB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},cB=function(t,e){return function(i,n){e(i,n,t)}},hB=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="polygon",this.numberType=Xd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.contains(e.x,e.y))return!1;var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).polygon,o=t.attribute,a=o.x,s=void 0===a?r.x:a,l=o.y,u=void 0===l?r.y:l;if(n.highPerformanceSave(),t.transMatrix.onlyTranslate()){var c=t.getOffsetXY(r);s+=c.x,u+=c.y,n.setTransformForCurrent()}else s=0,u=0,n.transformFromMatrix(t.transMatrix,!0);var h=!1;return this.canvasRenderer.drawShape(t,n,s,u,{},null,(function(t,i,n){return!!h||(h=t.isPointInPath(e.x,e.y))}),(function(t,i,r){if(h)return!0;var o=i.lineWidth||r.lineWidth,a=i.pickStrokeBuffer||r.pickStrokeBuffer;return n.lineWidth=o+a,h=t.isPointInStroke(e.x,e.y)})),n.highPerformanceRestore(),h}}]),t}();hB=lB([Ya(),cB(0,Wa(I_)),uB("design:paramtypes",[Object])],hB);var dB=!1,fB=new La((function(t,e,i,n){dB||(dB=!0,t(sM).to(hB).inSingletonScope(),t(JT).toService(sM))})),pB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},vB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},yB=function(t,e){return function(i,n){e(i,n,t)}},gB=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="glyph",this.numberType=Gd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!(null!=i?i:{}).pickContext)return!1;var n=null==i?void 0:i.pickerService;if(n){var r=!1;return t.getSubGraphic().forEach((function(t){if(!r){var o=n.pickItem(t,e,null,i);r=!(!o||!o.graphic)}})),r}return!1}}]),t}();gB=pB([Ya(),yB(0,Wa(V_)),vB("design:paramtypes",[Object])],gB);var mB=!1,_B=new La((function(t,e,i,n){mB||(mB=!0,t(SM).to(gB).inSingletonScope(),t(wM).toService(SM))})),bB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},xB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},kB=function(t,e){return function(i,n){e(i,n,t)}},SB=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="glyph",this.numberType=Gd}return zt(t,[{key:"contains",value:function(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;if(!(null!=i?i:{}).pickContext)return!1;var n=null==i?void 0:i.pickerService;if(n){var r=!1;return t.getSubGraphic().forEach((function(t){r||(r=!!n.pickItem(t,e,null,i))})),r}return!1}}]),t}();SB=bB([Ya(),kB(0,Wa(V_)),xB("design:paramtypes",[Object])],SB);var AB=!1,wB=new La((function(t,e,i,n){AB||(AB=!0,t(lM).to(SB).inSingletonScope(),t(SB).toService(lM))})),TB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},MB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},CB=function(t,e){return function(i,n){e(i,n,t)}},EB=function(){function t(e){jt(this,t),this.canvasRenderer=e,this.type="richtext",this.numberType=Qd}return zt(t,[{key:"contains",value:function(t,e,i){return!!t.AABBBounds.containsPoint(e)}}]),t}();EB=TB([Ya(),CB(0,Wa(H_)),MB("design:paramtypes",[Object])],EB);var RB=!1,PB=new La((function(t,e,i,n){RB||(RB=!0,t(kM).to(EB).inSingletonScope(),t(wM).toService(kM))})),BB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},LB=function(){function t(){jt(this,t),this.type="image",this.numberType=Ud}return zt(t,[{key:"contains",value:function(t,e,i){return!!(null!=i?i:{}).pickContext&&!!t.AABBBounds.containsPoint(e)}}]),t}();LB=BB([Ya()],LB);var OB=!1,IB=new La((function(t,e,i,n){OB||(OB=!0,t(eM).to(LB).inSingletonScope(),t(LB).toService(eM))})),DB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},FB=function(){function t(){jt(this,t),this.type="image",this.numberType=Ud}return zt(t,[{key:"contains",value:function(t,e,i){return!!(null!=i?i:{}).pickContext&&!!t.AABBBounds.containsPoint(e)}}]),t}();FB=DB([Ya()],FB);var zB=!1,jB=new La((function(t,e,i,n){zB||(zB=!0,t(fM).to(FB).inSingletonScope(),t(wM).toService(fM))})),HB=!1,NB=new La((function(t,e,i,n){HB||(HB=!0,t(eM).to(LB).inSingletonScope(),t(LB).toService(eM))}));function VB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var GB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},WB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},UB=function(t,e){return function(i,n){e(i,n,t)}};new ye;var YB=function(t){ue(i,t);var e=VB(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="rect3d",n.numberType=Jd,n}return zt(i,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).rect;n.highPerformanceSave();var o=this.transform(t,r,n),a=o.x,s=o.y,l=o.z,u=o.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,a,s,i,null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))})),this.canvasRenderer.z=0,n.modelMatrix!==u&&hg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}]),i}(IR);YB=GB([Ya(),UB(0,Wa(F_)),WB("design:paramtypes",[Object])],YB);var KB=!1,XB=new La((function(t,e,i,n){KB||(KB=!0,t(gM).to(YB).inSingletonScope(),t(wM).toService(gM))}));function ZB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var qB=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},JB=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},QB=function(t,e){return function(i,n){e(i,n,t)}},$B=function(t){ue(i,t);var e=ZB(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="arc3d",n.numberType=Hd,n}return zt(i,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).arc;n.highPerformanceSave();var o=this.transform(t,r,n),a=o.x,s=o.y,l=o.z,u=o.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,a,s,i,null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))})),this.canvasRenderer.z=0,n.modelMatrix!==u&&hg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}]),i}(IR);$B=qB([Ya(),QB(0,Wa(C_)),JB("design:paramtypes",[Object])],$B);var tL=!1,eL=new La((function(t,e,i,n){tL||(tL=!0,t(cM).to($B).inSingletonScope(),t(wM).toService(cM))}));function iL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var nL=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},rL=function(t,e){if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},oL=function(t,e){return function(i,n){e(i,n,t)}},aL=function(t){ue(i,t);var e=iL(i);function i(t){var n;return jt(this,i),(n=e.call(this)).canvasRenderer=t,n.type="pyramid3d",n.numberType=Zd,n}return zt(i,[{key:"contains",value:function(t,e,i){var n=(null!=i?i:{}).pickContext;if(!n)return!1;var r=gc(t).polygon;n.highPerformanceSave();var o=this.transform(t,r,n),a=o.x,s=o.y,l=o.z,u=o.lastModelMatrix,c=e;if(n.camera){c=e.clone();var h=t.parent.globalTransMatrix;c.x=h.a*e.x+h.c*e.y+h.e,c.y=h.b*e.x+h.d*e.y+h.f}this.canvasRenderer.z=l;var d=!1;return this.canvasRenderer.drawShape(t,n,a,s,{},null,(function(t,e,i){return!!d||(d=t.isPointInPath(c.x,c.y))}),(function(t,e,i){return!1})),this.canvasRenderer.z=0,n.modelMatrix!==u&&hg.free(n.modelMatrix),n.modelMatrix=u,n.highPerformanceRestore(),d}}]),i}(IR);aL=nL([Ya(),oL(0,Wa(N_)),rL("design:paramtypes",[Object])],aL);var sL=!1,lL=new La((function(t,e,i,n){sL||(sL=!0,t(xM).to(aL).inSingletonScope(),t(wM).toService(xM))})),uL=Rx();function cL(){cL.__loaded||(cL.__loaded=!0,kg.RegisterGraphicCreator("arc",Uy),_u.load(ek),_u.load(uL?dR:mR))}cL.__loaded=!1;var hL=cL;function dL(){dL.__loaded||(dL.__loaded=!0,kg.RegisterGraphicCreator("arc3d",Xy),_u.load(jk),_u.load(eL))}dL.__loaded=!1;var fL=dL;function pL(){pL.__loaded||(pL.__loaded=!0,kg.RegisterGraphicCreator("area",Ny),_u.load(sk),_u.load(uL?tP:aP))}pL.__loaded=!1;var vL=pL;function yL(){yL.__loaded||(yL.__loaded=!0,kg.RegisterGraphicCreator("circle",Zf),_u.load(hk),_u.load(uL?wP:PP))}yL.__loaded=!1;var gL=yL;function mL(){mL.__loaded||(mL.__loaded=!0,kg.RegisterGraphicCreator("glyph",_y),_u.load(xk),_u.load(uL?_B:wB))}mL.__loaded=!1;var _L=mL;function bL(){bL.__loaded||(bL.__loaded=!0,kg.RegisterGraphicCreator("group",lf))}bL.__loaded=!1;var xL=bL;function kL(){kL.__loaded||(kL.__loaded=!0,kg.RegisterGraphicCreator("image",wy),_u.load(Ek),_u.load(uL?jB:NB))}kL.__loaded=!1;var SL=kL;function AL(){AL.__loaded||(AL.__loaded=!0,kg.RegisterGraphicCreator("line",ly),_u.load(ok),_u.load(uL?VR:XR))}AL.__loaded=!1;var wL=AL;function TL(){TL.__loaded||(TL.__loaded=!0,kg.RegisterGraphicCreator("path",Fy),_u.load(vk),_u.load(uL?ZP:eB))}TL.__loaded=!1;var ML=TL;function CL(){CL.__loaded||(CL.__loaded=!0,kg.RegisterGraphicCreator("polygon",Qy),_u.load(gk),_u.load(uL?sB:fB))}CL.__loaded=!1;var EL=CL;function RL(){RL.__loaded||(RL.__loaded=!0,kg.RegisterGraphicCreator("pyramid3d",eg),_u.load(Wk),_u.load(lL))}RL.__loaded=!1;var PL=RL;function BL(){BL.__loaded||(BL.__loaded=!0,kg.RegisterGraphicCreator("rect",dy),_u.load(nk),_u.load(uL?wR:BR))}BL.__loaded=!1;var LL=BL;function OL(){OL.__loaded||(OL.__loaded=!0,kg.RegisterGraphicCreator("rect3d",yy),_u.load(Ok),_u.load(XB))}OL.__loaded=!1;var IL=OL;function DL(){DL.__loaded||(DL.__loaded=!0,kg.RegisterGraphicCreator("richtext",Ly),_u.load(Mk),_u.load(uL?PB:IB))}DL.__loaded=!1;var FL=DL;function zL(){zL.__loaded||(zL.__loaded=!0,kg.RegisterGraphicCreator("shadowRoot",rg))}zL.__loaded=!1;var jL=zL;function HL(){HL.__loaded||(HL.__loaded=!0,kg.RegisterGraphicCreator("symbol",ry),_u.load(uk),_u.load(uL?fP:_P))}HL.__loaded=!1;var NL=HL;function VL(){VL.__loaded||(VL.__loaded=!0,kg.RegisterGraphicCreator("text",np),_u.load(fk),_u.load(uL?zP:VP))}VL.__loaded=!1;var GL=VL;function WL(){WL.__loaded||(WL.__loaded=!0,kg.RegisterGraphicCreator("wrapText",sp))}WL.__loaded=!1;var UL=WL;function YL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var KL={debounce:Pt,throttle:Bt};xL(),LL();var XL=function(t){ue(i,t);var e=YL(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="scrollbar",r._onRailPointerDown=function(t){var e,i=t.viewX,n=t.viewY,o=r.attribute,a=o.direction,s=o.width,l=o.height,u=o.range,c=r._sliderSize,h=Mt(r._getScrollRange(),2),d=h[0],f=h[1];if("vertical"===a){var p=n-r._viewPosition.y,v=Tt(p-c/2,d,f);e=p/l,r._slider.setAttribute("y",v,!0)}else{var y=i-r._viewPosition.x,g=Tt(y-c/2,d,f);e=y/s,r._slider.setAttribute("x",g,!0)}r.setScrollRange([e-(u[1]-u[0])/2,e+(u[1]-u[0])/2],!1),r.stage&&!r.stage.autoRender&&r.stage.renderNextFrame()},r._onSliderPointerDown=function(t){t.stopPropagation();var e=r.attribute.direction;r._prePos="horizontal"===e?t.clientX:t.clientY,r._dispatchEvent("scrollDown",{pos:r._prePos,event:t}),"browser"===ux.env?(ux.addEventListener("pointermove",r._onSliderPointerMove,{capture:!0}),ux.addEventListener("pointerup",r._onSliderPointerUp)):(r.stage.addEventListener("pointermove",r._onSliderPointerMove,{capture:!0}),r.stage.addEventListener("pointerup",r._onSliderPointerUp),r.stage.addEventListener("pointerupoutside",r._onSliderPointerUp))},r._computeScrollValue=function(t){var e,i,n=r.attribute.direction,o=r._getSliderRenderBounds(),a=o.width,s=o.height;return"vertical"===n?e=((i=t.clientY)-r._prePos)/s:e=((i=t.clientX)-r._prePos)/a,[i,e]},r._onSliderPointerMove=KL[r.attribute.delayType]((function(t){t.stopPropagation();var e=r.getScrollRange(),i=Mt(r._computeScrollValue(t),2),n=i[0],o=i[1];r.setScrollRange([e[0]+o,e[1]+o],!0),r._prePos=n}),r.attribute.delayTime),r._onSliderPointerUp=function(t){t.preventDefault();var e=r.attribute,i=e.realTime,n=void 0===i||i,o=e.range,a=e.limitRange,s=void 0===a?[0,1]:a,l=r.getScrollRange(),u=Mt(r._computeScrollValue(t),2);u[0];var c=u[1],h=[l[0]+c,l[1]+c];n||r._dispatchEvent("scroll",{pre:o,value:Ct(h,s[0],s[1])}),r._dispatchEvent("scrollUp",{pre:o,value:Ct(h,s[0],s[1])}),"browser"===ux.env?(ux.removeEventListener("pointermove",r._onSliderPointerMove,{capture:!0}),ux.removeEventListener("pointerup",r._onSliderPointerUp)):(r.stage.removeEventListener("pointermove",r._onSliderPointerMove,{capture:!0}),r.stage.removeEventListener("pointerup",r._onSliderPointerUp),r.stage.removeEventListener("pointerupoutside",r._onSliderPointerUp))},r}return zt(i,[{key:"setScrollRange",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.attribute,n=i.direction,r=void 0===n?"horizontal":n,o=i.limitRange,a=void 0===o?[0,1]:o,s=i.range,l=i.realTime,u=void 0===l||l,c=Ct(t,a[0],a[1]);if(e){var h=this._getSliderPos(c);this._slider&&("horizontal"===r?this._slider.setAttribute("x",h[0],!0):this._slider.setAttribute("y",h[0],!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame())}this.attribute.range=c,u&&(this._dispatchEvent("scroll",{pre:s,value:c}),this._dispatchEvent("scrollDrag",{pre:s,value:c}))}},{key:"getScrollRange",value:function(){return this.attribute.range}},{key:"bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n;this._rail&&this._rail.addEventListener("pointerdown",KL[i](this._onRailPointerDown,r)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown)}}},{key:"render",value:function(){this._reset();var t=this.attribute,e=t.direction,i=void 0===e?"horizontal":e,n=t.width,r=t.height,o=t.range,a=t.limitRange,s=void 0===a?[0,1]:a,l=t.railStyle,u=t.sliderStyle,c=t.padding,h=void 0===c?2:c,d=this.createOrUpdateChild("scrollbar-container",{},"group"),f=d.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:n,height:r},l),"rect");this._rail=f;var p,v=this._getSliderRenderBounds(),y=this._getSliderPos(Ct(o,s[0],s[1])),g=y[1]-y[0];this._sliderSize=g,p="horizontal"===i?{x:y[0],y:v.y1,width:g,height:v.height}:{x:v.x1,y:y[0],width:v.width,height:g};var m=d.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},p),{cornerRadius:this._getDefaultSliderCornerRadius()}),u),{boundsPadding:mi(h),pickMode:"imprecise"}),"rect");this._slider=m,this._container=d;var _=this._container.AABBBounds;this._viewPosition={x:_.x1,y:_.y1}}},{key:"_getSliderRenderBounds",value:function(){if(this._sliderRenderBounds)return this._sliderRenderBounds;var t=this.attribute,e=t.width,i=t.height,n=t.padding,r=Mt(mi(void 0===n?2:n),4),o=r[0],a=r[1],s=r[2],l=r[3],u={x1:l,y1:o,x2:e-a,y2:i-s,width:Math.max(0,e-(l+a)),height:Math.max(0,i-(o+s))};return this._sliderRenderBounds=u,u}},{key:"_getDefaultSliderCornerRadius",value:function(){var t=this.attribute,e=t.direction;if(t.round){var i=this._getSliderRenderBounds(),n=i.width,r=i.height;return"horizontal"===e?r:n}return 0}},{key:"_getSliderPos",value:function(t){var e=this.attribute.direction,i=this._getSliderRenderBounds(),n=i.width,r=i.height,o=i.x1,a=i.y1;return"horizontal"===e?[n*t[0]+o,n*t[1]+o]:[r*t[0]+a,r*t[1]+a]}},{key:"_getScrollRange",value:function(){if(this._sliderLimitRange)return this._sliderLimitRange;var t=this.attribute,e=t.limitRange,i=void 0===e?[0,1]:e,n=t.direction,r=Mt(Ct(i,0,1),2),o=r[0],a=r[1],s=this._getSliderRenderBounds(),l=s.width,u=s.height,c=s.x1,h=s.y1,d=this._sliderSize;return"horizontal"===n?Ct([c+o*l,c+a*l],c,l-d):Ct([h+o*u,h+a*u],h,u-d)}},{key:"_reset",value:function(){this._sliderRenderBounds=null,this._sliderLimitRange=null}}]),i}(OT);function ZL(t,e){t.forEachChildren((function(t){var i=e(t);t.isContainer&&!i&&ZL(t,e)}))}XL.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var qL=function(t){return!w(t)&&!1!==t.visible};var JL=["#ffffff","#000000"];function QL(t,e,i,n,r,o){if("string"!=typeof t||"string"!=typeof e)return t;var a=new Ye(t).toHex(),s=new Ye(e).toHex();return $L(a,s,i,n,o)?a:function(t,e,i,n,r,o){var a=[];r&&(r instanceof Array?a.push.apply(a,m(r)):a.push(r)),a.push.apply(a,JL);for(var s=0,l=a;s<l.length;s++){var u=l[s];if(t!==u&&$L(u,e,i,n,o))return u}}(a,s,i,n,r,o)}function $L(t,e,i,n,r){if("lightness"===r){var o=Ye.getColorBrightness(new Ye(e));return Ye.getColorBrightness(new Ye(t))<.5?o>=.5:o<.5}return n?tO(t,e)>n:"largeText"===i?tO(t,e)>3:tO(t,e)>4.5}function tO(t,e){var i=eO(t),n=eO(e);return((i>n?i:n)+.05)/((i>n?n:i)+.05)}function eO(t){var e=function(t){for(var e="",i="",n="",r="#"===t[0]?1:0,o=r;o<t.length;o++)"#"!==t[o]&&(o<r+2?e+=t[o]:o<r+4?i+=t[o]:o<r+6&&(n+=t[o]));return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]}(t),i=e[0]/255,n=e[1]/255,r=e[2]/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}function iO(t,e,i,n){var r;switch(t){case"base":r=e;break;case"invertBase":r=i;break;case"similarBase":r=n}return r}function nO(t,e){return[t[0]*e,t[1]*e]}function rO(t,e,i){var n=function(t,e){var i=Mt(t,2),n=i[0],r=i[1],o=Mt(e,2),a=o[0],s=o[1],l=Math.sqrt((n*n+r*r)*(a*a+s*s)),u=l&&(n*a+r*s)/l;return Math.acos(Math.min(Math.max(u,-1),1))}(t,e),r=function(t,e){return t[0]*e[1]-e[0]*t[1]}(t,e)>=0;return i?r?2*Math.PI-n:n:r?n:2*Math.PI-n}var oO,aO=-.5*Math.PI,sO=1.5*Math.PI,lO="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol";!function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(oO||(oO={}));var uO=v(v(v(v({},oO.selectedReverse,{}),oO.selected,{}),oO.hover,{}),oO.hoverReverse,{}),cO={container:"",width:30,height:30,style:{}},hO=function(t,e,i){return new fi(Object.assign({defaultFontParams:{fontFamily:lO,fontSize:11},getTextBounds:i?void 0:Sg,specialCharSet:"-/: .,@%'\"~"+fi.ALPHABET_CHAR_SET+fi.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)};function dO(t,e){var i,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lO;if(!t)return{width:0,height:0};var o=Sg({text:t,fontFamily:null!==(i=e.fontFamily)&&void 0!==i?i:r,fontSize:e.fontSize||12,fontWeight:e.fontWeight,textAlign:null!==(n=e.textAlign)&&void 0!==n?n:"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||12});return{width:o.width(),height:o.height()}}function fO(){xL(),LL(),NL(),FL(),GL()}function pO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var vO=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};fO();var yO=function(t){ue(i,t);var e=pO(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="tag",r}return zt(i,[{key:"render",value:function(){var t,e,i,n,r,o,a=this.attribute,s=a.text,l=void 0===s?"":s,u=a.textStyle,c=void 0===u?{}:u,h=a.shape,d=void 0===h?{}:h,f=a.panel,p=void 0===f?{}:f,v=a.space,y=void 0===v?4:v,g=a.minWidth,m=a.maxWidth,_=a.padding,b=void 0===_?4:_,x=a.visible,k=a.state,A=a.type,M=a.textAlwaysCenter,C=mi(b),E=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),R=C[1]+C[3],P=C[0]+C[2],B=0,L=0,O=d.visible,D=vO(d,["visible"]);if(S(O)){var F=(null==D?void 0:D.size)||10,z=I(F)?F:Math.max(F[0],F[1]);r=E.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:F,strokeBoundsBuffer:0},D),{visible:O,x:z/2,y:z/2}),"symbol"),W(null==k?void 0:k.shape)||(r.states=k.shape),O&&(L=z+y)}if(R+=L,B+=L,"rich"===A){var j=Object.assign(Object.assign({textConfig:l,visible:T(l)&&!1!==x},c),{x:B,y:0,width:null!==(t=c.width)&&void 0!==t?t:0,height:null!==(e=c.height)&&void 0!==e?e:0});o=E.createOrUpdateChild("tag-text",j,"richtext");var H=p.visible,N=vO(p,["visible"]);if(x&&S(H)){var V=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},N),{visible:H&&!!l,x:o.AABBBounds.x1,y:o.AABBBounds.y1,width:o.AABBBounds.width(),height:o.AABBBounds.height()}),"rect");W(null==k?void 0:k.panel)||(V.states=k.panel)}}else if("html"===A){var G=Object.assign(Object.assign({textConfig:[],visible:T(l)&&!1!==x,html:Object.assign(Object.assign({dom:l},cO),c)},c),{x:B,y:0});o=E.createOrUpdateChild("tag-text",G,"richtext");var U=p.visible,Y=vO(p,["visible"]);if(x&&S(U)){var K=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},Y),{visible:U&&!!l,x:o.AABBBounds.x1,y:o.AABBBounds.y1,width:o.AABBBounds.width(),height:o.AABBBounds.height()}),"rect");W(null==k?void 0:k.panel)||(K.states=k.panel)}}else{var X=Object.assign(Object.assign({text:l,visible:T(l)&&!1!==x,lineHeight:null==c?void 0:c.fontSize},c),{x:B,y:0});w(X.lineHeight)&&(X.lineHeight=c.fontSize),o=E.createOrUpdateChild("tag-text",X,"text"),W(null==k?void 0:k.text)||(o.states=k.text);var Z=dO(X.text,c,null===(i=this.stage)||void 0===i?void 0:i.getTheme().text.fontFamily),q=Z.width,J=Z.height;R+=q;var Q=null!==(n=d.size)&&void 0!==n?n:10,$=I(Q)?Q:Math.max(Q[0],Q[1]);P+=Math.max(J,d.visible?$:0);var tt=c.textAlign,et=c.textBaseline;(T(g)||T(m))&&(T(g)&&R<g&&(R=g),T(m)&&R>m&&(R=m,o.setAttribute("maxLineWidth",m-C[1]-C[2])));var it=0,nt=0;"center"===tt?(it-=R/2,r&&r.setAttribute("x",(r.attribute.x||0)-q/2),E.setAttribute("x",-L/2)):"right"===tt||"end"===tt?(it-=R,r&&r.setAttribute("x",(r.attribute.x||0)-q),E.setAttribute("x",-C[1]-L)):"left"!==tt&&"start"!==tt||E.setAttribute("x",C[3]),!M||"left"!==tt&&"start"!==tt||o.setAttributes({x:B+R/2,textAlign:"center"}),"middle"===et?(nt-=P/2,r&&r.setAttribute("y",0)):"bottom"===et?(nt-=P,r&&r.setAttribute("y",-J/2),E.setAttribute("y",-C[2])):"top"===et&&(E.setAttribute("y",C[0]),r&&r.setAttribute("y",J/2));var rt=p.visible,ot=vO(p,["visible"]);if(x&&S(rt)){var at=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},ot),{visible:rt&&!!l,x:it,y:nt,width:R,height:P}),"rect");W(null==k?void 0:k.panel)||(at.states=k.panel)}}}}]),i}(OT);yO.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};var gO={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},mO={poptip:Q({},gO)};function _O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var bO=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},xO=new ye;xL(),UL(),NL(),LL();var kO=function(t){ue(i,t);var e=_O(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="poptip",r.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"],r}return zt(i,[{key:"render",value:function(){var t,e,i,n,r,o,a,s,l=this.attribute,u=l.titleStyle,c=void 0===u?{}:u,h=l.position,d=l.contentStyle,f=void 0===d?{}:d,p=l.panel,v=void 0===p?{}:p,y=l.space,g=void 0===y?4:y,m=l.minWidth,_=void 0===m?0:m,b=l.maxWidth,x=void 0===b?1/0:b,k=l.padding,A=void 0===k?4:k,w=l.maxWidthPercent,M=l.visible,C=l.state,E=l.dx,R=void 0===E?0:E,P=l.dy,L=void 0===P?0:P,O=this.attribute,I=O.title,D=void 0===I?"":I,F=O.content,z=void 0===F?"":F;D=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(D):D,z=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(z):z;var j=mi(A),H=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group"),N=x-j[1]-j[3],V=T(D)&&!1!==M,G=Object.assign(Object.assign({text:B(D)?D:[D],visible:V},c),{x:j[3],y:j[0],maxLineWidth:N,textAlign:"left",textBaseline:"top"}),U=H.createOrUpdateChild("poptip-title",G,"wrapText");W(null==C?void 0:C.title)||(U.states=C.title);var Y=U.AABBBounds,K=Y.height(),X=Y.width(),Z=K+g;V||(Z=0);var q=T(z)&&!1!==M,J=Object.assign(Object.assign({text:B(z)?z:[z],visible:q},f),{x:j[3],y:j[0]+Z,maxLineWidth:N,textAlign:"left",textBaseline:"top"}),Q=H.createOrUpdateChild("poptip-content",J,"wrapText");W(null==C?void 0:C.content)||(Q.states=C.content);var $=Q.AABBBounds,tt=$.height(),et=$.width();q&&(Z+=tt);var it=Xt(X+j[1]+j[3],et+j[1]+j[3]);it>x?it=x:it<_&&(it=_);var nt=j[0]+j[2]+Z,rt=v.visible,ot=bO(v,["visible"]),at=null!==(t=ot.size)&&void 0!==t?t:12,st=B(at)?[at[0]+(null!==(e=ot.space)&&void 0!==e?e:0),at[1]+(null!==(i=ot.space)&&void 0!==i?i:0)]:at+(null!==(n=ot.space)&&void 0!==n?n:0),lt=null!==(r=ot.lineWidth)&&void 0!==r?r:1,ut=this.stage?[null!==(o=this.stage.viewWidth)&&void 0!==o?o:this.stage.width,null!==(a=this.stage.viewHeight)&&void 0!==a?a:this.stage.height]:void 0;if(ut){var ct=this.AABBBounds,ht=null!==(s=this.attribute.x)&&void 0!==s?s:ct.x1,dt=ut[0]-ct.x1,ft=Math.max(ht,dt),pt=(B(at)?at[0]:12)+3;if((ft=Math.min(ft-pt,ft*w))<it){it=ft;var vt=j[1]+j[3];U.setAttribute("maxLineWidth",ft-vt),Q.setAttribute("maxLineWidth",ft-vt),nt=j[0]+j[2],V&&(nt+=U.AABBBounds.height()+g),nt+=Q.AABBBounds.height()}}for(var yt,gt,mt,_t,bt,xt,kt,St,At="auto"===h,wt=-1/0,Tt=0;Tt<this.positionList.length+1;Tt++){var Mt=At?this.positionList[Tt===this.positionList.length?yt:Tt]:h,Ct=this.getAngleAndOffset(Mt,it,nt,B(st)?st:[st,st-lt]),Et=Ct.angle,Rt=Ct.offset;if(Ct.rectOffset,S(rt)){var Pt=(B(at)?at[0]:at)/4,Bt=H.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},ot),{visible:rt&&(q||V),x:Pt,y:0,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:"arrow2Left",angle:Et,dx:Rt[0],dy:Rt[1],size:at,zIndex:-9}),"symbol");W(null==C?void 0:C.panel)||(Bt.states=C.panel);var Lt=H.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},ot),{visible:rt&&(q||V),x:0,y:0,width:it,height:nt,zIndex:-8}),"rect");W(null==C?void 0:C.panel)||(Lt.states=C.panel)}if(H.setAttributes({x:-Rt[0]+R,y:-Rt[1]+L}),!At||!ut)break;xO.setValue(0,0,it,nt).transformWithMatrix(H.globalTransMatrix);var Ot=xO,It=(new ve).setValue(0,0,ut[0],ut[1]);if(mt=It,_t=!1,bt=void 0,xt=void 0,kt=void 0,St=void 0,(gt=Ot)&&mt?(Le=gt.x1,Oe=gt.x2,Ie=gt.y1,De=gt.y2,Fe=mt.x1,ze=mt.x2,je=mt.y1,He=mt.y2,_t&&(Le>Oe&&(Le=(bt=[Oe,Le])[0],Oe=bt[1]),Ie>De&&(Ie=(xt=[De,Ie])[0],De=xt[1]),Fe>ze&&(Fe=(kt=[ze,Fe])[0],ze=kt[1]),je>He&&(je=(St=[He,je])[0],He=St[1])),Le>Fe&&Oe<ze&&Ie>je&&De<He?Ne.BBOX1:Fe>Le&&ze<Oe&&je>Ie&&He<De?Ne.BBOX2:Ne.NONE):Ne.NONE)break;var Dt=Je(Ot,It,!1),Ft=(Dt.x2-Dt.x1)*(Dt.y2-Dt.y1);Ft>wt&&(wt=Ft,yt=Tt)}}},{key:"getAngleAndOffset",value:function(t,e,i,n){var r=n[1]/2;switch(t){case"tl":return{angle:Nt/2*3,offset:[e/4,i+r],rectOffset:[-e/4,-i-n[1]]};case"top":return{angle:Nt/2*3,offset:[e/2,i+r],rectOffset:[0,-i-n[1]]};case"tr":return{angle:Nt/2*3,offset:[e/4*3,i+r],rectOffset:[e/4*3,-i-n[1]]};case"rt":return{angle:0,offset:[-r,i/5],rectOffset:[e/4*3,-i-n[1]]};case"right":return{angle:0,offset:[-r,i/2],rectOffset:[e/4*3,-i-n[1]]};case"rb":return{angle:0,offset:[-r,i/5*4],rectOffset:[e/4*3,-i-n[1]]};case"bl":return{angle:Nt/2,offset:[e/4,-r],rectOffset:[-e/4,-i-n[1]]};case"bottom":return{angle:Nt/2,offset:[e/2,-r],rectOffset:[0,-i-n[1]]};case"br":return{angle:Nt/2,offset:[e/4*3,-r],rectOffset:[e/4*3,-i-n[1]]};case"lt":return{angle:Nt,offset:[e+r,i/5],rectOffset:[-e/4,-i-n[1]]};case"left":return{angle:Nt,offset:[e+r,i/2],rectOffset:[0,-i-n[1]]};case"lb":return{angle:Nt,offset:[e+r,i/5*4],rectOffset:[e/4*3,-i-n[1]]}}}}]),i}(OT);kO.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},maxWidthPercent:.8,space:8,padding:10};var SO=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s};var AO=function(){function t(){jt(this,t)}return zt(t,[{key:"render",value:function(t,e,i,n,r,o,a,s,l,u,c,h,d){var f;if(1===t._showPoptip){var p=t.attribute.poptip||{},v=p.visible,y=p.visibleCb;if(!1===v||y&&!1===y(t))return;var g={};Q(g,kO.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(g):this.poptipComponent=new kO(g);var m=t.attribute.poptip||{};if("text"===t.type&&null==m.title&&null==m.content){var _={};Q(_,mO.poptip,m),(m=_).content=null!==(f=m.content)&&void 0!==f?f:t.attribute.text}var b=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1},m),{x:b.e,y:b.f})),u.stage.tryInitInteractiveLayer();var x=u.stage.getLayer("_builtin_interactive");x&&x.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&this.poptipComponent.setAttributes({visibleAll:!1}))}}]),t}();AO=SO([Ya()],AO);var wO=function(t,e,n,r){var o,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(s=(a<3?o(s):a>3?o(e,n,s):o(e,n))||s);return a>3&&s&&Object.defineProperty(e,n,s),s},TO=function(){function t(){var e=this;jt(this,t),this.name="poptip",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid,this.poptip=function(t){var i=t.target;!i.isContainer&&i.attribute?i!==e.activeGraphic&&(i.attribute.poptip&&(i.setAttributes({}),i._showPoptip=1),e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2),e.setActiveGraphic(i,!0)):e.unpoptip(t)},this.unpoptip=function(t){e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2,e.setActiveGraphic(null,!0))}}return zt(t,[{key:"activate",value:function(t){this.pluginService=t,this.pluginService.stage.addEventListener("pointerover",this.poptip)}},{key:"setActiveGraphic",value:function(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}},{key:"deactivate",value:function(t){this.pluginService.stage.removeEventListener("pointerover",this.poptip)}}]),t}();TO=wO([Ya()],TO);var MO=function(){function t(){var e=this;jt(this,t),this.name="poptipForText",this.activeEvent="onRegister",this._uid=Ba.GenAutoIncrementId(),this.key=this.name+this._uid,this.pointerlave=function(t){var i=e.pluginService.stage;t.target===i&&e.unpoptip(t)},this.poptip=function(t){var i=t.target;if("text"===i.type&&i.cliped&&!i.isContainer&&i.attribute&&!i.attribute.disableAutoClipedPoptip){if(i!==e.activeGraphic){var n=i.attribute.poptip;(void 0===n?{}:n)&&(i.setAttributes({}),i._showPoptip=1),e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2),e.setActiveGraphic(i,!0)}}else e.unpoptip(t)},this.unpoptip=function(t){e.activeGraphic&&(e.activeGraphic.setAttributes({}),e.activeGraphic._showPoptip=2,e.setActiveGraphic(null,!0))}}return zt(t,[{key:"activate",value:function(t){this.pluginService=t;var e=this.pluginService.stage;e.addEventListener("pointerover",this.poptip),e.addEventListener("pointerleave",this.pointerlave)}},{key:"setActiveGraphic",value:function(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}},{key:"deactivate",value:function(t){var e=this.pluginService.stage;e.removeEventListener("pointerover",this.poptip),e.removeEventListener("pointerleave",this.pointerlave)}}]),t}();MO=wO([Ya()],MO);var CO=new La((function(t,e,i,n){i(AO)||(t(AO).toSelf().inSingletonScope(),t(Uf).toService(AO)),i(TO)||(t(TO).toSelf(),t(ab).toService(TO)),i(MO)||(t(MO).toSelf(),t(ab).toService(MO))}));function EO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var RO=function(t){ue(i,t);var e=EO(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="crosshair",t}return zt(i,[{key:"render",value:function(){this.renderCrosshair(this)}}]),i}(OT);function PO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}xL(),wL();var BO=function(t){ue(i,t);var e=PO(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.lineStyle;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[i,n]},r),"line")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}]),i}(RO);function LO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}BO.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},xL(),LL();var OO=function(t){ue(i,t);var e=LO(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.rectStyle;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y},r),"rect")}},{key:"setLocation",value:function(t){var e=t.start,i=t.end;this.setAttributes({start:e,end:i})}}]),i}(RO);function IO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}OO.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}},xL(),hL();var DO=function(t){ue(i,t);var e=IO(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.lineStyle;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},i),{outerRadius:n}),this.attribute),r),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=se.distancePP(t,e);this.setAttribute("radius",i)}}]),i}(RO);function FO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}DO.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}},xL(),hL();var zO=function(t){ue(i,t);var e=FO(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderCrosshair",value:function(t){var e=this.attribute,i=e.center,n=e.radius,r=e.innerRadius,o=void 0===r?0:r,a=e.sectorStyle,s=this.attribute,l=s.startAngle,u=s.endAngle;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},i),{outerRadius:n,innerRadius:o,startAngle:l,endAngle:u}),a),"arc")}},{key:"setLocation",value:function(t){var e=this.attribute,i=e.center,n=e.startAngle,r=void 0===n?aO:n,o=e.endAngle,a=(void 0===o?sO:o)-r,s=me(xe(i,t));this.setAttributes({startAngle:s-a/2,endAngle:s+a/2})}}]),i}(RO);function jO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}zO.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},xL(),ML();var HO=function(t){ue(i,t);var e=jO(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderCrosshair",value:function(t){for(var e,i=this.attribute,n=i.center,r=i.radius,o=i.sides,a=void 0===o?6:o,s=i.lineStyle,l=this.attribute,u=l.startAngle,c=l.endAngle,h=(c-u)%(2*Math.PI)==0,d=(c-u)/a,f=0;f<=a;f++){var p=be(n,r,u+d*f);0===f?e="M".concat(p.x,",").concat(p.y):e+="L".concat(p.x,",").concat(p.y),f===a&&h&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}},{key:"setLocation",value:function(t){var e=this.attribute.center,i=se.distancePP(t,e);this.setAttribute("radius",i)}}]),i}(RO);HO.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}};var NO=new Uint32Array(33),VO=new Uint32Array(33);VO[0]=0,NO[0]=~VO[0];for(var GO=1;GO<=32;++GO)VO[GO]=VO[GO-1]<<1|1,NO[GO]=~VO[GO];function WO(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.max(1,Math.sqrt(t*e/1e6)),r=~~((t+2*i+n)/n),o=~~((e+2*i+n)/n),a=function(t){return~~((t+i)/n)};return a.invert=function(t){return t*n-i},a.bitmap=function(){return function(t,e){var i=new Uint32Array(~~((t*e+32)/32));function n(t,e){i[t]|=e}function r(t,e){i[t]&=e}return{array:i,get:function(e,n){var r=n*t+e;return i[r>>>5]&1<<(31&r)},set:function(e,i){var r=i*t+e;n(r>>>5,1<<(31&r))},clear:function(e,i){var n=i*t+e;r(n>>>5,~(1<<(31&n)))},getRange:function(n){var r=n.x1,o=n.y1,a=n.x2,s=n.y2;if(a<0||s<0||r>t||o>e)return!0;for(var l,u,c,h,d=s;d>=o;--d)if((c=(l=d*t+r)>>>5)==(h=(u=d*t+a)>>>5)){if(i[c]&NO[31&l]&VO[1+(31&u)])return!0}else{if(i[c]&NO[31&l])return!0;if(i[h]&VO[1+(31&u)])return!0;for(var f=c+1;f<h;++f)if(i[f])return!0}return!1},setRange:function(i){var r=i.x1,o=i.y1,a=i.x2,s=i.y2;if(!(a<0||s<0||r>t||o>e))for(var l,u,c,h,d;o<=s;++o)if((c=(l=o*t+r)>>>5)==(h=(u=o*t+a)>>>5))n(c,NO[31&l]&VO[1+(31&u)]);else for(n(c,NO[31&l]),n(h,VO[1+(31&u)]),d=c+1;d<h;++d)n(d,4294967295)},clearRange:function(e){for(var i,n,o,a,s,l=e.x1,u=e.y1,c=e.x2,h=e.y2;u<=h;++u)if((o=(i=u*t+l)>>>5)==(a=(n=u*t+c)>>>5))r(o,VO[31&i]|NO[1+(31&n)]);else for(r(o,VO[31&i]),r(a,NO[1+(31&n)]),s=o+1;s<a;++s)r(s,0)},outOfBounds:function(i){var n=i.x1,r=i.y1,o=i.x2,a=i.y2;return n<0||r<0||a>=e||o>=t},toImageData:function(n){for(var r=n.createImageData(t,e),o=r.data,a=0;a<e;++a)for(var s=0;s<t;++s){var l=a*t+s,u=4*l,c=i[l>>>5]&1<<(31&l);o[u+0]=255*c,o[u+1]=255*c,o[u+2]=255*c,o[u+3]=31}return r}}}(r,o)},a.ratio=n,a.padding=i,a.width=t,a.height=e,a}function UO(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var i=e.x1,n=e.x2,r=e.y1,o=e.y2,a=Tt(i,0,t.width),s=Tt(n,0,t.width),l=Tt(r,0,t.height),u=Tt(o,0,t.height);return{x1:t(a),x2:t(s),y1:t(l),y2:t(u)}}return{x1:t(e.x1),x2:t(e.x2),y1:t(e.y1),y2:t(e.y2)}}function YO(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=i;return r>0&&(o={x1:i.x1-r,x2:i.x2+r,y1:i.y1-r,y2:i.y2+r}),o=UO(t,o),!(n&&e.outOfBounds(o)||e.getRange(o))}function KO(t,e,i){for(var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]).filter((function(t){return T(t)})),a=0;a<o.length;a++){var s=i.clone();if(s.setAttributes(o[a]),s.update(),YO(t,e,UO(t,s.AABBBounds),n,r))return e.setRange(UO(t,s.AABBBounds,!0)),o[a]}return!1}function XO(t,e,i,n,r,o,a){var s,l,u,c=null===(s=n.overlap)||void 0===s?void 0:s.clampForce,h=null===(l=n.overlap)||void 0===l?void 0:l.overlapPadding;if("bound"===i.type||"position"===i.type){if(A(a)){var d=((A(i.position)?i.position(r.attribute):i.position)||(u=n.type,"rect"===u?qO:ZO)).map((function(t){return a(r.AABBBounds,o,t,n.offset)}));return KO(t,e,r,d,c,h)}return!1}if("moveY"===i.type){var f=(i.offset?A(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x,y:r.attribute.y+t}}));return KO(t,e,r,f,c,h)}if("moveX"===i.type){var p=(i.offset?A(i.offset)?i.offset(r.attribute):i.offset:[]).map((function(t){return{x:r.attribute.x+t,y:r.attribute.y}}));return KO(t,e,r,p,c,h)}return!1}var ZO=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],qO=["top","inside-top","inside"];function JO(t,e,i){var n=t.AABBBounds,r=n.x1,o=n.x2,a=n.y1,s=n.y2,l=Math.min(r,o),u=Math.max(r,o),c=Math.min(a,s),h=Math.max(a,s),d=0,f=0;return l<0&&u-l<=e?d=-l:u>e&&l-(u-e)>=0&&(d=e-u),c<0&&h-c<=i?f=-c:h>i&&c-(h-i)>=0&&(f=i-h),{dx:d,dy:f}}var QO={fadeIn:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(t=n.opacity)&&void 0!==t?t:1,fillOpacity:null!==(e=n.fillOpacity)&&void 0!==e?e:1,strokeOpacity:null!==(i=n.strokeOpacity)&&void 0!==i?i:1}}},fadeOut:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{from:{opacity:null!==(t=n.opacity)&&void 0!==t?t:1,fillOpacity:null!==(e=n.fillOpacity)&&void 0!==e?e:1,strokeOpacity:null!==(i=n.strokeOpacity)&&void 0!==i?i:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}}};function $O(t,e){var i,n;return null!==(n=null===(i=QO[e])||void 0===i?void 0:i.call(QO,t))&&void 0!==n?n:{from:{},to:{}}}var tI=function(t,e,i,n){var r=Object.assign({},t.attribute),o=Object.assign({},e.attribute);return lt(null==n?void 0:n.excludeChannels).forEach((function(t){delete o[t]})),Object.keys(o).forEach((function(t){i&&!i.includes(t)&&delete o[t]})),{from:r,to:o}};function eI(t,e,i,n){t.attribute.text!==e.attribute.text&&F(Number(t.attribute.text)*Number(e.attribute.text))&&t.animate().play(new gh({text:t.attribute.text},{text:e.attribute.text},i,n))}var iI={mode:"same-time",duration:300,easing:"linear"};function nI(t,e,i,n){var r=function(t){return t.radius?{x:Math.cos(t.angle)*t.radius,y:Math.sin(t.angle)*t.radius}:{x:0,y:0}}({radius:i,angle:n});return{x:t+r.x,y:e+r.y}}function rI(t){return(t=function(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}function oI(t){return 3===t||4===t}var aI=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t){var r=t.x1,o=t.y1,a=t.x2,s=t.y2,l=Math.abs(a-r),u=Math.abs(s-o),c=(e.x1+e.x2)/2,h=(e.y1+e.y2)/2,d=0,f=0,p=0,v=0;e&&(p=Math.abs(e.x1-e.x2)/2,v=Math.abs(e.y1-e.y2)/2);var y={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":f=-1;break;case"bottom":f=1;break;case"left":d=-1;break;case"right":d=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":d=Math.sin(y[i]*(Math.PI/180)),f=Math.cos(y[i]*(Math.PI/180));break;case"center":d=0,f=0}return{x:c+d*(n+p)+Math.sign(d)*(l/2),y:h+f*(n+v)+Math.sign(f)*(u/2)}}},sI=function(t){if(!t||!t.attribute)return[];var e=t.attribute,i=e.points,n=e.segments;if(n&&n.length){var r=[];return n.forEach((function(t){t.points.forEach((function(t){r.push(t)}))})),r}return i};function lI(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!t||!e)return{x:1/0,y:1/0};var r=t.x1,o=t.x2,a=Math.abs(o-r),s=e.x1,l=s;return"end"===i?l=s+a/2+n:"start"===i&&(l=s-a/2-n),{x:l,y:e.y1}}function uI(t,e,i,n,r,o){return Math.abs(e/t)<o/r?{x:i+(t>0?r:-r),y:n+e*r/Math.abs(t)}:{x:i+t*o/Math.abs(e),y:n+(e>0?o:-o)}}function cI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}xL(),GL(),FL(),wL();var hI=function(t){ue(i,t);var e=cI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="label",r._onHover=function(t){var e=t.target;e===r._lastHover||W(e.states)||(e.addState(oO.hover,!0),ZL(ce(r),(function(t){t===e||W(t.states)||t.addState(oO.hoverReverse,!0)})),r._lastHover=e)},r._onUnHover=function(t){r._lastHover&&(ZL(ce(r),(function(t){W(t.states)||(t.removeState(oO.hoverReverse),t.removeState(oO.hover))})),r._lastHover=null)},r._onClick=function(t){var e=t.target;if(r._lastSelect===e&&e.hasState("selected"))return r._lastSelect=null,void ZL(ce(r),(function(t){W(t.states)||(t.removeState(oO.selectedReverse),t.removeState(oO.selected))}));W(e.states)||(e.addState(oO.selected,!0),ZL(ce(r),(function(t){t===e||W(t.states)||t.addState(oO.selectedReverse,!0)})),r._lastSelect=e)},r._handleRelatedGraphicSetState=function(t){var e,i,n,o,a;if((null===(e=t.detail)||void 0===e?void 0:e.type)===Rs.STATE||(null===(i=t.detail)||void 0===i?void 0:i.type)===Rs.ANIMATE_UPDATE&&(null===(n=t.detail.animationState)||void 0===n?void 0:n.isFirstFrameOfStep)){var s=null!==(a=null===(o=t.target)||void 0===o?void 0:o.currentStates)&&void 0!==a?a:[];(r._isCollectionBase?m(r._graphicToText.values()):[r._graphicToText.get(t.target)]).forEach((function(t){t&&(t.text&&t.text.useStates(s),t.labelLine&&t.labelLine.useStates(s))}))}},r}return zt(i,[{key:"setBitmap",value:function(t){this._bitmap=t}},{key:"setBitmapTool",value:function(t){this._bmpTool=t}},{key:"labeling",value:function(t,e,i,n){}},{key:"_createLabelLine",value:function(t,e){var i=function(t,e){if(t&&e&&!Qe(t,e,!0)){var i=Math.min(t.x1,t.x2),n=Math.min(t.y1,t.y2),r=Math.min(e.x1,e.x2),o=Math.min(e.y1,e.y2),a=Math.abs(t.x2-i)/2,s=Math.abs(t.y2-n)/2,l=Math.abs(e.x2-r)/2,u=Math.abs(e.y2-o)/2,c=i+a,h=n+s,d=r+l,f=o+u,p=d-c,v=f-h;return[uI(p,v,c,h,a,s),uI(-p,-v,d,f,l,u)]}}(t.AABBBounds,null==e?void 0:e.AABBBounds);if(i){var n=kg.line({points:i});return e&&e.attribute.fill&&n.setAttribute("stroke",e.attribute.fill),this.attribute.line&&!W(this.attribute.line.style)&&n.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(n),n}}},{key:"render",value:function(){var t=this;if(this._prepare(),!(w(this._idToGraphic)||this._isCollectionBase&&w(this._idToPoint))){var e,i=this.attribute,n=i.overlap,r=i.smartInvert,o=i.dataFilter,a=i.customLayoutFunc,s=i.customOverlapFunc,l=this.attribute.data;A(o)&&(l=o(l)),e=A(a)?a(l,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null):this._layout(l),A(s)?e=s(e,this.getRelatedGraphic.bind(this),this._isCollectionBase?function(e){return t._idToPoint.get(e.id)}:null):!1!==n&&(e=this._overlapping(e)),e&&e.length&&e.forEach((function(e){t._bindEvent(e),t._setStatesOfText(e)})),!1!==r&&this._smartInvert(e),this._renderLabels(e)}}},{key:"_bindEvent",value:function(t){if(!this.attribute.disableTriggerEvent&&t){var e=this.attribute,i=e.hover,n=e.select;i&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),n&&t.addEventListener("pointerdown",this._onClick)}}},{key:"_setStatesOfText",value:function(t){if(t){var e=this.attribute.state;e&&!W(e)&&(t.states=e)}}},{key:"_setStatesOfLabelLine",value:function(t){if(t){var e=this.attribute.labelLineState;e&&!W(e)&&(t.states=e)}}},{key:"_createLabelText",value:function(t){var e,i;return"rich"===t.textType?(t.textConfig=t.text,t.width=null!==(e=t.width)&&void 0!==e?e:0,t.height=null!==(i=t.height)&&void 0!==i?i:0,kg.richtext(t)):"html"===t.textType?(t.textConfig=[],t.html=Object.assign(Object.assign({dom:t.text},cO),t),kg.richtext(t)):kg.text(t)}},{key:"_prepare",value:function(){var t,e,i,n,r,o=[];if((A(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach((function(t){"willRelease"!==t.releaseStatus&&o.push(t)})),null===(t=this._idToGraphic)||void 0===t||t.clear(),null===(e=this._idToPoint)||void 0===e||e.clear(),this._baseMarks=o,this._isCollectionBase="line-data"===this.attribute.type,o&&0!==o.length){var a=this.attribute.data;if(a&&0!==a.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);for(var s=0,l=0;l<o.length;l++){var u=o[l],c=sI(u);if(c&&c.length)for(var h=0;h<c.length;h++){var d=a[s];d&&c[h]&&(T(d.id)||(d.id="vrender-component-".concat(this.name,"-").concat(s)),this._idToPoint.set(d.id,c[h]),this._idToGraphic.set(d.id,u)),s++}}}else for(var f=0;f<o.length;f++){var p=a[f],v=o[f];p&&v&&(T(p.id)||(p.id="vrender-component-".concat(this.name,"-").concat(f)),this._idToGraphic.set(p.id,v))}if(!1!==this.attribute.animation){var y=M(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:Q({},iI,y,null!==(i=this.attribute.animationEnter)&&void 0!==i?i:{}),exit:Q({},iI,y,null!==(n=this.attribute.animationExit)&&void 0!==n?n:{}),update:B(this.attribute.animationUpdate)?this.attribute.animationUpdate:Q({},iI,y,null!==(r=this.attribute.animationUpdate)&&void 0!==r?r:{})}}}}}},{key:"getRelatedGraphic",value:function(t){return this._idToGraphic.get(t.id)}},{key:"_layout",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.attribute,i=e.textStyle,n=void 0===i?{}:i,r=e.position,o=e.offset,a=[],s=0;s<t.length;s++){var l=t[s],u=this.getRelatedGraphic(l);if(u){var c=Object.assign(Object.assign({fill:this._isCollectionBase?B(u.attribute.stroke)?u.attribute.stroke.find((function(t){return!!t&&!0!==t})):u.attribute.stroke:u.attribute.fill},n),l),h=this._createLabelText(c),d=this.getGraphicBounds(h),f=A(r)?r(l):r,p=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(l.id),f):this.getGraphicBounds(u,{x:l.x,y:l.y},f),v=this.labeling(d,p,f,o);v&&(c.x=v.x,c.y=v.y,h.setAttributes(v)),a.push(h)}}return a}},{key:"_overlapping",value:function(t){var e,i,n,r,o=this;if(0===t.length)return[];var a=M(this.attribute.overlap)?this.attribute.overlap:{},s=[],l=this.getBaseMarkGroup(),u=null!==(e=a.size)&&void 0!==e?e:{width:null!==(i=null==l?void 0:l.AABBBounds.width())&&void 0!==i?i:0,height:null!==(n=null==l?void 0:l.AABBBounds.height())&&void 0!==n?n:0};if(0===u.width||0===u.height)return t;var c=a.avoidBaseMark,h=a.strategy,d=void 0===h?[]:h,f=a.hideOnHit,p=void 0===f||f,v=a.clampForce,y=void 0===v||v,g=a.avoidMarks,m=void 0===g?[]:g,_=a.overlapPadding,b=this._bmpTool||WO(u.width,u.height),x=this._bitmap||b.bitmap(),k=d.some((function(t){return"bound"===t.type}));c&&(null===(r=this._baseMarks)||void 0===r||r.forEach((function(t){t.AABBBounds&&x.setRange(UO(b,t.AABBBounds,!0))}))),m.length>0&&m.forEach((function(t){P(t)?function(t,e){if(!e)return[];var i=t.find((function(t){return t.name===e}),!0);return i?i.findAll((function(t){return"group"!==t.type}),!0):[]}(o.getRootNode(),t).forEach((function(t){t.AABBBounds&&x.setRange(UO(b,t.AABBBounds,!0))})):t.AABBBounds&&x.setRange(UO(b,t.AABBBounds,!0))}));for(var S=0;S<t.length;S++)if(!1!==t[S].visible){var w=t[S],T=this.getRelatedGraphic(w.attribute);if(w.update(),Qe(T.AABBBounds,{x1:0,x2:b.width,y1:0,y2:b.height},!0)){if(YO(b,x,w.AABBBounds,y,_)){if(!k){x.setRange(UO(b,w.AABBBounds,!0)),s.push(w);continue}if(k&&T&&T.AABBBounds&&this._canPlaceInside(w.AABBBounds,T.AABBBounds)){x.setRange(UO(b,w.AABBBounds,!0)),s.push(w);continue}}for(var C=!1,E=0;E<d.length;E++)if(!1!==(C=XO(b,x,d[E],this.attribute,w,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[S].attribute.id)):this.getGraphicBounds(T,t[S].attribute),this.labeling))){w.setAttributes({x:C.x,y:C.y}),s.push(w);break}if(!C&&y){var R=JO(w,b.width,b.height),B=R.dx,L=void 0===B?0:B,O=R.dy,I=void 0===O?0:O;if(0===L&&0===I){if(YO(b,x,w.AABBBounds)){x.setRange(UO(b,w.AABBBounds,!0)),s.push(w);continue}}else if(YO(b,x,{x1:w.AABBBounds.x1+L,x2:w.AABBBounds.x2+L,y1:w.AABBBounds.y1+I,y2:w.AABBBounds.y2+I})){w.setAttributes({x:w.attribute.x+L,y:w.attribute.y+I}),x.setRange(UO(b,w.AABBBounds,!0)),s.push(w);continue}}!C&&!p&&s.push(w)}}return A(this.onAfterLabelOverlap)&&this.onAfterLabelOverlap(x),s}},{key:"getBaseMarkGroup",value:function(){var t=this.attribute.baseMarkGroupName;if(t)return this.getRootNode().find((function(e){return e.name===t}),!0)}},{key:"getGraphicBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){if(!1!==t.attribute.visible)return t.AABBBounds;var i=t.attribute,n=i.x,r=i.y;return{x1:n,x2:n,y1:r,y2:r}}var o=e.x,a=e.y;return{x1:o,x2:o,y1:a,y2:a}}},{key:"_renderLabels",value:function(t){!1===this._enableAnimation||!1===this.attribute.animation?this._renderWithOutAnimation(t):this._renderWithAnimation(t)}},{key:"_renderWithAnimation",value:function(t){var e,i=this,n=new Map,r=this._graphicToText||new Map,o=[],a=[],s=(null!==(e=this.attribute.line)&&void 0!==e?e:{}).visible;t.forEach((function(t,e){var l,u=i.getRelatedGraphic(t.attribute),c=t.attribute.id,h=i._isCollectionBase?c:u,d=(null==r?void 0:r.get(h))?"update":"enter";if(s&&(l=i._createLabelLine(t,u)),"enter"===d){if(o.push(t),n.set(h,l?{text:t,labelLine:l}:{text:t}),u){var f=$O(t.attribute,"fadeIn"),p=f.from,v=f.to;i.add(t),l&&(a.push(l),i.add(l)),i._syncStateWithRelatedGraphic(u),i._animationConfig.enter.duration>0&&u.once("animate-bind",(function(n){t.setAttributes(p),l&&l.setAttributes(p);var r=i._afterRelatedGraphicAttributeUpdate(t,o,l,a,e,u,v,i._animationConfig.enter);u.on("afterAttributeUpdate",r)}))}}else if("update"===d){var y=r.get(h);r.delete(h),n.set(h,y);var g=y.text,m=i._animationConfig.update,_=m.duration,b=m.easing;(function(t,e,i){if(!B(i)){var n=i.duration,r=i.easing,o=i.increaseEffect,a=void 0===o||o;return t.animate().to(e.attribute,n,r),void(a&&eI(t,e,n,r))}i.forEach((function(i,n){var r=i.duration,o=i.easing,a=i.increaseEffect,s=void 0===a||a,l=i.channel,u=tI(t,e,l,i.options),c=u.from,h=u.to;W(h)||t.animate().to(h,r,o),"text"in c&&"text"in h&&s&&eI(t,e,r,o)}))})(g,t,i._animationConfig.update),y.labelLine&&l&&y.labelLine.animate().to(l.attribute,_,b)}})),r.forEach((function(t){var e;null===(e=t.text)||void 0===e||e.animate().to($O(t.text.attribute,"fadeOut").to,i._animationConfig.exit.duration,i._animationConfig.exit.easing).onEnd((function(){i.removeChild(t.text),t.labelLine&&i.removeChild(t.labelLine)}))})),this._graphicToText=n}},{key:"_renderWithOutAnimation",value:function(t){var e,i=this,n=new Map,r=this._graphicToText||new Map,o=(null!==(e=this.attribute.line)&&void 0!==e?e:{}).visible;t.forEach((function(t){var e,a=i.getRelatedGraphic(t.attribute),s=(null==r?void 0:r.get(a))?"update":"enter",l=i._isCollectionBase?t.attribute.id:a;if(o&&(e=i._createLabelLine(t,a)),"enter"===s)n.set(l,e?{text:t,labelLine:e}:{text:t}),i.add(t),e&&i.add(e),i._syncStateWithRelatedGraphic(a);else if("update"===s){var u=r.get(l);r.delete(l),n.set(l,u),u.text.setAttributes(t.attribute),u.labelLine&&e&&u.labelLine.setAttributes(e.attribute)}})),r.forEach((function(t){i.removeChild(t.text),t.labelLine&&i.removeChild(t.labelLine)})),this._graphicToText=n}},{key:"_syncStateWithRelatedGraphic",value:function(t){this.attribute.syncState&&t.on("afterAttributeUpdate",this._handleRelatedGraphicSetState)}},{key:"_afterRelatedGraphicAttributeUpdate",value:function(t,e,i,n,r,o,a,s){var l=this,u=s.mode,c=s.duration,h=s.easing,d=s.delay;return function s(f){var p,v,y,g=f.detail;if(!g)return{};var m=null===(p=g.animationState)||void 0===p?void 0:p.step;if(g.type!==Rs.ANIMATE_UPDATE||!m||"wait"===m.type&&null==(null===(v=m.prev)||void 0===v?void 0:v.type))return{};if(g.type===Rs.ANIMATE_END)return t.setAttributes(a),void(i&&i.setAttributes(a));var _=function(){o&&(o.onAnimateBind=void 0,o.removeEventListener("afterAttributeUpdate",s))};switch(u){case"after":g.animationState.end&&(t.animate({onStart:_}).wait(d).to(a,c,h),i&&i.animate().wait(d).to(a,c,h));break;case"after-all":r===e.length-1&&g.animationState.end&&(e.forEach((function(t){t.animate({onStart:_}).wait(d).to(a,c,h)})),n.forEach((function(t){t.animate().wait(d).to(a,c,h)})));break;default:if(l._isCollectionBase){var b=l._idToPoint.get(t.attribute.id);!b||t.animates&&t.animates.has("label-animate")||!o.containsPoint(b.x,b.y,Es.LOCAL,null===(y=l.stage)||void 0===y?void 0:y.pickerService)||(t.animate({onStart:_}).wait(d).to(a,c,h),i&&i.animate().wait(d).to(a,c,h))}else g.animationState.isFirstFrameOfStep&&(t.animate({onStart:_}).wait(d).to(a,c,h),i&&i.animate().wait(d).to(a,c,h))}}}},{key:"_smartInvert",value:function(t){var e,i,n,r,o,a=M(this.attribute.smartInvert)?this.attribute.smartInvert:{},s=a.textType,l=a.contrastRatiosThreshold,u=a.alternativeColors,c=a.mode,h=null!==(e=a.fillStrategy)&&void 0!==e?e:"invertBase",d=null!==(i=a.strokeStrategy)&&void 0!==i?i:"base",f=null!==(n=a.brightColor)&&void 0!==n?n:"#ffffff",p=null!==(r=a.darkColor)&&void 0!==r?r:"#000000",v=null!==(o=a.outsideEnable)&&void 0!==o&&o;if("null"!==h||"null"!==d)for(var y=0;y<t.length;y++){var g=t[y];if(g){var m=this.getRelatedGraphic(g.attribute),_=m.attribute.fill,b=_,x=QL(g.attribute.fill,_,s,l,u,c),k=$L(x,f)?f:p;if(v){var S=iO(h,b,x,k);if(S&&g.setAttributes({fill:S}),0===g.attribute.lineWidth)continue;var A=iO(d,b,x,k);A&&g.setAttributes({stroke:A})}else if(this._canPlaceInside(g.AABBBounds,m.AABBBounds)){var w=iO(h,b,x,k);if(w&&g.setAttributes({fill:w}),0===g.attribute.lineWidth)continue;var T=iO(d,b,x,k);T&&g.setAttributes({stroke:T})}else{if(0===g.attribute.lineWidth)continue;if(g.attribute.stroke){g.setAttributes({fill:QL(g.attribute.fill,g.attribute.stroke,s,l,u,c)});continue}var C=iO(h,b,x,k);C&&g.setAttributes({fill:C});var E=iO(d,b,x,k);E&&g.setAttributes({stroke:E})}}}}},{key:"_canPlaceInside",value:function(t,e){return!(!t||!e)&&e.encloses(t)}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._enableAnimation=!1}},{key:"enableAnimation",value:function(){this._enableAnimation=!0}}]),i}(OT);function dI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}hI.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},offset:0,pickable:!1};var fI=function(t){ue(i,t);var e=dI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="symbol-label",r}return zt(i,[{key:"labeling",value:function(t,e){return aI(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}]),i}(hI);function pI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}fI.defaultAttributes={textStyle:{fontSize:12,fill:"#000",textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},position:"top",offset:5,pickable:!1};var vI=function(t){ue(i,t);var e=pI(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"labeling",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t&&e){var r=t.x1,o=t.y1,a=t.x2,s=t.y2,l=Math.abs(a-r),u=Math.abs(s-o),c=Math.abs(e.x2-e.x1),h=Math.abs(e.y2-e.y1),d=(e.x1+e.x2)/2,f=(e.y1+e.y2)/2,p=0,v=0;switch(i){case"top":case"inside-top":v=-.5;break;case"bottom":case"inside-bottom":v=.5;break;case"left":case"inside-left":p=-.5;break;case"right":case"inside-right":p=.5;break;case"top-right":p=.5,v=-.5;break;case"top-left":p=-.5,v=-.5;break;case"bottom-right":p=.5,v=.5;break;case"bottom-left":p=-.5,v=.5}d+=p*c,f+=v*h;var y=0,g=0,m=i.includes("inside");switch(i.includes("top")?g=m?1:-1:i.includes("bottom")?g=m?-1:1:i.includes("left")?y=m?1:-1:i.includes("right")&&(y=m?-1:1),i){case"top-right":case"bottom-right":y=-1;break;case"top-left":case"bottom-left":y=1}return{x:d+y*n+y*l/2,y:f+g*n+g*u/2}}}}]),i}(hI);function yI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}vI.tag="rect-label",vI.defaultAttributes={textStyle:{fontSize:12,fill:"#000",textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},position:"top",offset:5,pickable:!1};var gI=function(t){ue(i,t);var e=yI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="line-label",r}return zt(i,[{key:"getGraphicBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end";if(!t||"line"!==t.type)return Xs(de(i.prototype),"getGraphicBounds",this).call(this,t,e);var r=t.attribute.points||[e],o="start"===n?0:r.length-1;return r[o]?{x1:r[o].x,x2:r[o].x,y1:r[o].y,y2:r[o].y}:void 0}},{key:"labeling",value:function(t,e){return lI(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}]),i}(hI);function mI(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return _I(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _I(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function _I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function bI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}gI.defaultAttributes={textStyle:{fontSize:12,fill:"#000",textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},position:"end",offset:6,pickable:!1};var xI=function(){function t(e,i,n,r,o,a,s,l,u){jt(this,t),this.refDatum=e,this.center=i,this.outerCenter=n,this.quadrant=r,this.radian=o,this.middleAngle=a,this.innerRadius=s,this.outerRadius=l,this.circleCenter=u,this.labelVisible=!0,this.labelLimit=0}return zt(t,[{key:"getLabelBounds",value:function(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}]),t}(),kI=function(t){ue(i,t);var e=bI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="arc-label",r._ellipsisWidth=0,r._arcLeft=new Map,r._arcRight=new Map,r}return zt(i,[{key:"_overlapping",value:function(t){return t}},{key:"labeling",value:function(t,e){if(t&&e)return{x:0,y:0}}},{key:"_layout",value:function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=Xs(de(i.prototype),"_layout",this).call(this,e),r=n.map((function(e){return t.getGraphicBounds(e)})),o=Object.assign(Object.assign({},this.attribute.textStyle),{text:"…"}),a=this._createLabelText(o),s=this.getGraphicBounds(a),l=s.x2-s.x1,u=this.layoutArcLabels(this.attribute.position,this.attribute,Array.from(this._idToGraphic.values()),e,r,l),c=function(){var t=e[h],i=u.find((function(e){var i;return(null===(i=e.refDatum)||void 0===i?void 0:i.id)===t.id}));if(i){var r={visible:i.labelVisible,x:i.labelPosition.x,y:i.labelPosition.y,angle:i.angle,maxLineWidth:i.labelLimit,points:i.pointA&&i.pointB&&i.pointC?[i.pointA,i.pointB,i.pointC]:void 0,line:i.labelLine};n[h].setAttributes(r)}},h=0;h<e.length;h++)c();return n}},{key:"layoutArcLabels",value:function(t,e,i,n,r,o){var a=this;this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=o;var s=0;i.forEach((function(t){t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)})),n.forEach((function(t,i){var o,l,u,c=a._idToGraphic.get(t.id).attribute,h={x:null!==(o=null==c?void 0:c.x)&&void 0!==o?o:0,y:null!==(l=null==c?void 0:c.y)&&void 0!==l?l:0};if(!w(n[i])&&!w(r[i])){var d=n[i]?n[i]:null,f=r[i]?r[i]:{x1:0,x2:0,y1:0,y2:0},p=(c.startAngle+c.endAngle)/2,v=c.endAngle-c.startAngle,y=rI(c.endAngle-v/2),g=nI(h.x,h.y,c.outerRadius,p),m=nI(h.x,h.y,s+e.line.line1MinLength,p),_=new xI(d,g,m,y,v,p,c.innerRadius,c.outerRadius,h);_.pointA=nI(h.x,h.y,a.computeDatumRadius(2*h.x,2*h.y,c.outerRadius),_.middleAngle),_.labelSize={width:f.x2-f.x1,height:f.y2-f.y1},1===(u=_.quadrant)||2===u?a._arcRight.set(_.refDatum,_):oI(_.quadrant)&&a._arcLeft.set(_.refDatum,_)}}));var l=Array.from(this._arcLeft.values()),u=Array.from(this._arcRight.values()),c=[];switch(t){case"inside":case"inside-inner":case"inside-outer":c.push.apply(c,m(this._layoutInsideLabels(u,e,i))),c.push.apply(c,m(this._layoutInsideLabels(l,e,i)));break;default:c.push.apply(c,m(this._layoutOutsideLabels(u,e,i))),c.push.apply(c,m(this._layoutOutsideLabels(l,e,i)))}return c}},{key:"_layoutInsideLabels",value:function(t,e,i){var n,r,o=this,a=e,s=a.spaceWidth,l=null!==(n=a.position)&&void 0!==n?n:"inside",u=null!==(r=a.offsetRadius)&&void 0!==r?r:-s;return t.forEach((function(t){var i,n,r,c,h=t.labelSize,d=t.radian,f=t.innerRadius,p=t.outerRadius;d<function(t,e){return e>2*t?NaN:2*Math.asin(e/2/t)}(p,h.height)?c=0:c=p-(d>=Math.PI?f:Math.max(f,h.height/2/Math.tan(d/2)))-s;!0!==a.rotate&&(c=p-s);var v=o._getFormatLabelText(t.refDatum,c);t.labelText=v;var y,g=Math.min(c,t.labelSize.width),m=o._computeAlign(t,e),_=0;"inside"===l&&(_="left"===m?g:"right"===m?0:g/2),y="inside-inner"===l?f-u+_:p+u-_,t.labelPosition=nI(t.circleCenter.x,t.circleCenter.y,y,t.middleAngle),t.labelLimit=g,St(g,0)||(t.labelVisible=!1),t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:t.middleAngle;var b=null!==(r=a.offsetAngle)&&void 0!==r?r:0;["inside-inner","inside-outer"].includes(l)&&(b+=Math.PI/2),t.angle+=b})),t}},{key:"_layoutOutsideLabels",value:function(t,e,i){var n,r,o,a=null!==(n=i[0].attribute.x)&&void 0!==n?n:0,s=2*(null!==(r=i[0].attribute.y)&&void 0!==r?r:0),l=e.line.line2MinLength,u=e.layout,c=e.spaceWidth;if(t.forEach((function(t){var e=oI(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+l+c),y:t.outerCenter.y}})),t.sort((function(t,e){return t.labelPosition.y-e.labelPosition.y})),!1!==e.coverEnable||"none"===u.strategy){var h,d=mI(t);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=f.labelPosition,v=f.labelSize;f.labelLimit=v.width,f.pointB=oI(f.quadrant)?{x:p.x+v.width/2+l+c,y:p.y}:{x:p.x-v.width/2-l-c,y:p.y},this._computeX(f,e,i)}}catch(t){d.e(t)}finally{d.f()}!1===e.coverEnable&&"none"===u.strategy&&this._coverLabels(t)}else{var y=s/((null===(o=e.textStyle)||void 0===o?void 0:o.fontSize)||16);this._adjustY(t,y,e,i);var g,m=t.reduce((function(t,e){var i=e.getLabelBounds(),n=i.y1,r=i.y2;return t.minY=Math.max(0,Math.min(n,t.minY)),t.maxY=Math.min(s,Math.max(r,t.maxY)),t}),{minY:1/0,maxY:-1/0}),_=m.minY,b=m.maxY,x=Math.max(Math.abs(s/2-_),Math.abs(b-s/2)),k=this._computeLayoutRadius(x,e,i),S=mI(t);try{for(S.s();!(g=S.n()).done;){var A=g.value;this._computePointB(A,k,e,i),this._computeX(A,e,i)}}catch(t){S.e(t)}finally{S.f()}}var w=2*a;return t.forEach((function(t){var i,n;t.labelVisible&&(At(t.pointB.x,l+c)||St(t.pointB.x,w-l-c))&&(t.labelVisible=!1),t.angle=null!==(n=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==n?n:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign({},e.line)})),t}},{key:"_computeX",value:function(t,e,i){var n,r=t.circleCenter,o=2*r.x;r.y;var a=0;i.forEach((function(t){t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}));var s=this.computeLayoutOuterRadius(a,e.width,e.height),l=e.line.line1MinLength,u=e.line.line2MinLength,c=null===(n=e.layout)||void 0===n?void 0:n.align,h=e.spaceWidth,d=t.labelPosition,f=t.quadrant,p=t.pointB;F(p.x*p.y)||(t.pointC={x:NaN,y:NaN},d.x=NaN,t.labelLimit=0);var v=this.computeRadius(s,e.width,e.height),y=oI(f)?-1:1,g=0,m=(y>0?o-p.x:p.x)-u-h;"labelLine"===c&&(g=(v+l+u)*y+r.x,m=(y>0?o-g:g)-h);var _=this._getFormatLabelText(t.refDatum,m);t.labelText=_;var b=Math.min(m,t.labelSize.width);switch(c){case"labelLine":break;case"edge":g=y>0?o-b-h:b+h;break;default:g=p.x+y*u}b=Math.max(this._ellipsisWidth,b),t.labelLimit=b,t.pointC={x:g,y:d.y};var x=.5*(t.labelLimit<t.labelSize.width?t.labelLimit:t.labelSize.width);if("edge"===c){d.x=(y>0?o+0:0)-y*x}else{d.x=g+0+y*(h+x)}}},{key:"_computeAlign",value:function(t,e){var i,n,r,o,a,s,l=e,u=null!==(n=null===(i=l.textStyle)||void 0===i?void 0:i.textAlign)&&void 0!==n?n:null===(r=l.textStyle)||void 0===r?void 0:r.align,c=null!==(a=null===(o=l.layout)||void 0===o?void 0:o.textAlign)&&void 0!==a?a:null===(s=l.layout)||void 0===s?void 0:s.align;return"inside"!==l.position?w(u)||"auto"===u?"edge"===c?oI(t.quadrant)?"left":"right":oI(t.quadrant)?"right":"left":u:w(u)||"auto"===u?"center":u}},{key:"_getFormatLabelText",value:function(t,e){var i;return null!==(i=null==t?void 0:t.text)&&void 0!==i?i:""}},{key:"_adjustY",value:function(t,e,i,n){var r;n[0].attribute.x;var o=2*(null!==(r=n[0].attribute.y)&&void 0!==r?r:0),a=i.layout;if("vertical"===a.strategy){var s,l=0,u=t.length;if(u<=0)return;for(var c=0;c<u;c++){if(At(s=t[c].getLabelBounds().y1-l,0)){var h=this._shiftY(t,c,u-1,-s);this._shiftY(t,h,0,s/2)}l=t[c].getLabelBounds().y2}At(s=t[0].getLabelBounds().y1-0,0)&&this._shiftY(t,0,u-1,-s);for(var d=t.length-1;d>=0&&t[d].getLabelBounds().y2>o;d--)t[d].labelVisible=!1}else if("none"!==a.strategy){var f=t.map((function(t,e){return{arc:t,originIndex:e,priorityIndex:0}}));f.sort((function(t,e){return e.arc.radian-t.arc.radian})),f.forEach((function(t,e){t.priorityIndex=e,t.arc.labelVisible=!1}));for(var p=1/0,v=-1/0,y=0;y<e&&y<t.length;y++){this._storeY(t);var g=f[y].arc;this._computeYRange(g,i,n),g.labelVisible=!0;var m=g.labelPosition.y,_=this._findNeighborIndex(t,f[y]),b=_.lastIndex,x=_.nextIndex,k=t[b],S=t[x];if(-1===b&&-1!==x){var A=S.labelPosition.y;m>A?g.labelPosition.y=A-S.labelSize.height/2-g.labelSize.height/2:this._twoWayShift(t,g,S,x)}else if(-1!==b&&-1===x){var w=k.labelPosition.y;m<w?g.labelPosition.y=w+k.labelSize.height/2+g.labelSize.height/2:this._twoWayShift(t,k,g,f[y].originIndex)}else if(-1!==b&&-1!==x){var T=k.labelPosition.y,M=S.labelPosition.y;m>M?(g.labelPosition.y=M-S.labelSize.height/2-g.labelSize.height/2,this._twoWayShift(t,k,g,f[y].originIndex)):m<T?(g.labelPosition.y=T+k.labelSize.height/2+g.labelSize.height/2,this._twoWayShift(t,g,S,x)):(this._twoWayShift(t,k,g,f[y].originIndex),this._twoWayShift(t,g,S,x))}var C=Math.min(p,f[y].originIndex),E=Math.max(v,f[y].originIndex),R=void 0;if(St(R=t[E].getLabelBounds().y2-o,0)&&this._shiftY(t,E,0,-R),At(R=t[C].getLabelBounds().y1-0,0)&&this._shiftY(t,C,t.length-1,-R),St(R=t[E].getLabelBounds().y2-o,0)){g.labelVisible=!1,this._restoreY(t);break}a.tangentConstraint&&!this._checkYRange(t)?(g.labelVisible=!1,this._restoreY(t)):(p=C,v=E)}}}},{key:"_shiftY",value:function(t,e,i,n){for(var r=e<i?1:-1,o=e;-1!==o;){t[o].labelPosition.y+=n;var a=this._findNextVisibleIndex(t,o,i,r);if(a>=0&&a<t.length){var s=t[o].getLabelBounds(),l=s.y1,u=s.y2,c=t[a].getLabelBounds(),h=c.y1,d=c.y2;if(r>0&&u<h||r<0&&l>d)return o}o=a}return i}},{key:"_findNextVisibleIndex",value:function(t,e,i,n){for(var r=(i-e)*n,o=1;o<=r;o++){var a=e+o*n;if(t[a].labelVisible)return a}return-1}},{key:"_computePointB",value:function(t,e,i,n){var r=i,o=0;n.forEach((function(t){t.attribute.outerRadius>o&&(o=t.attribute.outerRadius)}));var a=this.computeLayoutOuterRadius(o,i.width,i.height),s=r.line.line1MinLength;if("none"===r.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{var l=t.circleCenter,u=this.computeRadius(a,i.width,i.height),c=t.labelPosition,h=t.quadrant,d=e-Math.max(u+s,t.outerRadius),f=Math.sqrt(Math.pow(e,2)-Math.pow(Math.abs(l.y-c.y),2))-d;F(f)?t.pointB={x:l.x+f*(oI(h)?-1:1),y:c.y}:t.pointB={x:NaN,y:NaN}}}},{key:"_storeY",value:function(t){var e,i=mI(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.lastLabelY=n.labelPosition.y)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_computeYRange",value:function(t,e,i){var n=t.circleCenter,r={width:2*n.x,height:2*n.y},o=0;i.forEach((function(t){t.attribute.outerRadius>o&&(o=t.attribute.outerRadius)}));var a,s,l,u=this.computeLayoutOuterRadius(o,e.width,e.height),c=e.line.line1MinLength,h=r.width,d=r.height,f=this.computeRadius(u,e.width,e.height),p=this._computeLayoutRadius(d/2,e,i),v=Math.abs(t.center.x-h/2),y=t.center.y-d/2;if(kt(h/2,v))a=0,s=1,l=-y;else if(kt(d/2,y))a=1,s=0,l=-v;else{var g=-1/(y/v);a=g,s=-1,l=y-g*v}var m,_,b=function(t,e,i,n,r,o){if(0===t&&0===e||o<=0)return[];if(0===t){var a=-i/e,s=Math.pow(o,2)-Math.pow(a-r,2);return s<0?[]:0===s?[{x:n,y:a}]:[{x:Math.sqrt(s)+n,y:a},{x:-Math.sqrt(s)+n,y:a}]}if(0===e){var l=-i/t,u=Math.pow(o,2)-Math.pow(l-n,2);return u<0?[]:0===u?[{x:l,y:r}]:[{x:l,y:Math.sqrt(u)+r},{x:l,y:-Math.sqrt(u)+r}]}var c=Math.pow(e/t,2)+1,h=2*((i/t+n)*(e/t)-r),d=Math.pow(h,2)-4*c*(Math.pow(i/t+n,2)+Math.pow(r,2)-Math.pow(o,2));if(d<0)return[];var f=(-h+Math.sqrt(d))/(2*c),p=(-h-Math.sqrt(d))/(2*c),v=-(e*f+i)/t;return 0===d?[{x:v,y:f}]:[{x:v,y:f},{x:-(e*p+i)/t,y:p}]}(a,s,l,c+f-p,0,p);b.length<2||(b[0].x>b[1].x&&b.reverse(),b[0].x<0?kt(b[0].y,b[1].y)?St(t.middleAngle,-Math.PI)&&At(t.middleAngle,0)||St(t.middleAngle,Math.PI)&&At(t.middleAngle,2*Math.PI)?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=d):b[0].y<b[1].y?(m=0,_=b[1].y+d/2):(m=b[1].y+d/2,_=r.height):(m=Math.min(b[0].y,b[1].y)+d/2,_=Math.max(b[0].y,b[1].y)+d/2),t.labelYRange=[m,_])}},{key:"_computeLayoutRadius",value:function(t,e,i){var n=e,r=n.layoutArcGap,o=n.line.line1MinLength,a=0;i.forEach((function(t){t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}));var s=this.computeLayoutOuterRadius(a,e.width,e.height),l=this.computeRadius(s,e.width,e.height)+o,u=l-r;return Math.max((Math.pow(u,2)+Math.pow(t,2))/(2*u),l)}},{key:"_findNeighborIndex",value:function(t,e){for(var i=e.originIndex,n=-1,r=-1,o=i-1;o>=0;o--)if(t[o].labelVisible){n=o;break}for(var a=i+1;a<t.length;a++)if(t[a].labelVisible){r=a;break}return{lastIndex:n,nextIndex:r}}},{key:"_twoWayShift",value:function(t,e,i,n){var r=i.getLabelBounds().y1-e.getLabelBounds().y2;if(At(r,0)){var o=this._shiftY(t,n,t.length-1,-r);this._shiftY(t,o,0,r/2)}}},{key:"_restoreY",value:function(t){var e,i=mI(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.labelVisible&&(n.labelPosition.y=n.lastLabelY)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_checkYRange",value:function(t){var e,i=mI(t);try{for(i.s();!(e=i.n()).done;){var n=e.value,r=n.labelYRange,o=n.labelPosition;if(n.labelVisible&&r&&(At(o.y,r[0])||St(o.y,r[1])))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}},{key:"_coverLabels",value:function(t){if(!(t.length<=1))for(var e,i,n,r,o,a,s,l,u,c,h=t[0].getLabelBounds(),d=1;d<t.length;d++){var f=t[d].getLabelBounds();i=f,n=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,n=(e=h).x1,r=e.y1,o=e.x2,a=e.y2,s=i.x1,l=i.y1,u=i.x2,c=i.y2,n<=s&&o<=s||n>=u&&o>=u||r<=l&&a<=l||r>=c&&a>=c?h=f:t[d].labelVisible=!1}}},{key:"_createLabelLine",value:function(t,e){var i,n,r,o,a,s,l,u=t.attribute,c=u.points,h=u.line,d=void 0===h?{}:h,f=u.visible,p=u.fill,v=t.attribute.points?kg.line({visible:null===(r=null!==(i=d.visible&&f)&&void 0!==i?i:null===(n=t.attribute)||void 0===n?void 0:n.visible)||void 0===r||r,stroke:null!==(a=null===(o=d.style)||void 0===o?void 0:o.stroke)&&void 0!==a?a:p,lineWidth:null!==(l=null===(s=d.style)||void 0===s?void 0:s.lineWidth)&&void 0!==l?l:1,points:c,curveType:d.smooth?"basis":null}):void 0;return v&&this._setStatesOfLabelLine(v),v}},{key:"computeRadius",value:function(t,e,i,n){return this.computeLayoutRadius(e||0,i||0)*t*(w(n)?1:n)}},{key:"computeLayoutRadius",value:function(t,e){return Math.min(t/2,e/2)}},{key:"_canPlaceInside",value:function(t,e){return"inside"===this.attribute.position}},{key:"computeLayoutOuterRadius",value:function(t,e,i){return t/(Math.min(e,i)/2)}},{key:"computeDatumRadius",value:function(t,e,i){var n=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*n}}]),i}(hI);function SI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}kI.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,textAlign:"center",textBaseline:"middle"},position:"outside",offset:0,line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0},pickable:!1};var AI=function(t){ue(i,t);var e=SI(i);function i(t){var n;return jt(this,i),(n=e.call(this,Q({},i.defaultAttributes,t))).name="line-label",n}return zt(i,[{key:"getGraphicBounds",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end";if("area"!==t.type)return Xs(de(i.prototype),"getGraphicBounds",this).call(this,t,n);var o=(null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.points)||[n],a="start"===r?0:o.length-1;return{x1:o[a].x,x2:o[a].x,y1:o[a].y,y2:o[a].y}}},{key:"labeling",value:function(t,e){return lI(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}]),i}(hI);function wI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}AI.defaultAttributes={textStyle:{fontSize:12,fill:"#000",textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},position:"end",offset:6,pickable:!1};var TI=function(t){ue(i,t);var e=wI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="line-data-label",r}return zt(i,[{key:"labeling",value:function(t,e){return aI(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)}}]),i}(hI);function MI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}TI.defaultAttributes={textStyle:{fontSize:12,fill:"#000",textAlign:"center",textBaseline:"middle",boundsPadding:[-1,0,-1,0]},position:"top",offset:5,pickable:!1};var CI={rect:vI,symbol:fI,arc:kI,line:gI,area:AI,"line-data":TI},EI=function(t){ue(i,t);var e=MI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="data-label",r}return zt(i,[{key:"render",value:function(){var t,e=this,i=this.attribute,n=i.dataLabels,r=i.size;if(n&&0!==n.length){var o=r||{},a=o.width,s=void 0===a?0:a,l=o.height,u=void 0===l?0:l;if(s&&u&&F(u*s)){this._componentMap||(this._componentMap=new Map);for(var c=WO(s,u),h=c.bitmap(),d=new Map,f=this._componentMap,p=0;p<n.length;p++){var v=n[p],y=CI[v.type]||hI;if(y){var g=v.baseMarkGroupName,m=v.type,_=null!==(t=v.id)&&void 0!==t?t:"".concat(g,"-").concat(m,"-").concat(p),b=this._componentMap.get(_);b?(b.setBitmapTool(c),b.setBitmap(h),b.setAttributes(v),d.set(_,b)):((b=new y(v)).setBitmap(h),b.setBitmapTool(c),this.add(b),d.set(_,b))}}f.forEach((function(t,i){d.get(i)||e.removeChild(t)})),this._componentMap=d}}}},{key:"setLocation",value:function(t){this.translateTo(t.x,t.y)}},{key:"disableAnimation",value:function(){this._componentMap.forEach((function(t){t.disableAnimation()}))}},{key:"enableAnimation",value:function(){this._componentMap.forEach((function(t){t.enableAnimation()}))}}]),i}(OT);function RI(){xL(),wL(),EL(),NL()}function PI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}EI.defaultAttributes={pickable:!1},RI();var BI,LI,OI=function(t){ue(i,t);var e=PI(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="segment",r}return zt(i,[{key:"getStartAngle",value:function(){return this._startAngle}},{key:"getEndAngle",value:function(){return this._endAngle}},{key:"getMainSegmentPoints",value:function(){return this._mainSegmentPoints}},{key:"render",value:function(){var t=this;this.removeAllChild(),this._reset();var e=this.attribute,i=e.startSymbol,n=e.endSymbol,r=e.lineStyle,o=e.state,a=e.visible,s=void 0===a||a,l=e.multiSegment,u=e.mainSegmentIndex;if(s){this._computeLineAngle();var c=this._renderSymbol(i,"start"),h=this._renderSymbol(n,"end");if(this.startSymbol=c,this.endSymbol=h,l){var d=m(this.attribute.points);if(F(u))d[u]=this._clipPoints(d[u]);else{var f=this._clipPoints(pt(d));d[0][0]=f[0],d[d.length-1][d[d.length-1].length-1]=f[f.length-1]}d.forEach((function(e,i){var n,a,s=kg.line(Object.assign(Object.assign({points:e},B(r)?null!==(n=r[i])&&void 0!==n?n:r[r.length-1]:r),{fill:!1}));s.name="".concat(t.name,"-line"),s.id=t._getNodeId("line"+i),W(null==o?void 0:o.line)||(s.states=B(o.line)?null!==(a=o.line[i])&&void 0!==a?a:o.line[o.line.length-1]:o.line),t.add(s)}))}else{var p=kg.polygon(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},lt(r)[0]),{fill:!1,closePath:!1}));p.name="".concat(this.name,"-line"),p.id=this._getNodeId("line"),W(null==o?void 0:o.line)||(p.states=[].concat(o.line)[0]),this.add(p)}}}},{key:"_renderSymbol",value:function(t,e){var i=this._getMainSegmentPoints();if(i.length){var n,r=t.autoRotate,o=void 0===r||r;if(t&&t.visible){var a,s,l=this._startAngle,u=this._endAngle,c=this.attribute.state,h=i[0],d=i[i.length-1],f=t.refX,p=void 0===f?0:f,v=t.refY,y=void 0===v?0:v,g=t.refAngle,m=void 0===g?0:g,_=t.style,b=t.symbolType,x=t.size,k=void 0===x?12:x;"start"===e?(a={x:h.x+(F(l)?p*Math.cos(l)+y*Math.cos(l-Math.PI/2):0),y:h.y+(F(l)?p*Math.sin(l)+y*Math.sin(l-Math.PI/2):0)},s=l+Math.PI/2):(a={x:d.x+(F(u)?p*Math.cos(u)+y*Math.cos(u-Math.PI/2):0),y:d.y+(F(u)?p*Math.sin(u)+y*Math.sin(u-Math.PI/2):0)},s=u+Math.PI/2),(n=kg.symbol(Object.assign(Object.assign(Object.assign({},a),{symbolType:b,size:k,angle:o?s+m:0,strokeBoundsBuffer:0}),_))).name="".concat(this.name,"-").concat(e,"-symbol"),n.id=this._getNodeId("".concat(e,"-symbol")),W(null==c?void 0:c.symbol)||(n.states=c.symbol),this.add(n)}return n}}},{key:"_getMainSegmentPoints",value:function(){if(this._mainSegmentPoints)return this._mainSegmentPoints;var t,e=this.attribute,i=e.points,n=e.multiSegment,r=e.mainSegmentIndex;return t=n?F(r)?i[r]:pt(i):i,this._mainSegmentPoints=t,t}},{key:"_clipPoints",value:function(t){var e=this.attribute,i=e.startSymbol,n=void 0===i?{}:i,r=e.endSymbol,o=void 0===r?{}:r,a=t;if(n.visible){var s=n.clip?n.size||10:0;a=[{x:t[0].x-s/2*(Math.cos(this._startAngle)||0),y:t[0].y-s/2*(Math.sin(this._startAngle)||0)}].concat(m(a.slice(1)))}if(o.visible){var l=o.clip?o.size||10:0,u={x:t[t.length-1].x-l/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-l/2*(Math.sin(this._endAngle)||0)};a=[].concat(m(a.slice(0,a.length-1)),[u])}return a}},{key:"_computeLineAngle",value:function(){var t=this._getMainSegmentPoints();if(!(t.length<=1)){var e=t[0],i=t[1],n=t[t.length-2],r=t[t.length-1],o=[e.x-i.x,e.y-i.y],a=Math.atan2(o[1],o[0]),s=[r.x-n.x,r.y-n.y],l=Math.atan2(s[1],s[0]);this._startAngle=a,this._endAngle=l}}},{key:"_reset",value:function(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}]),i}(OT);OI.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}},function(t){t.innerView="inner-view",t.axisContainer="axis-container",t.labelContainer="axis-label-container",t.tickContainer="axis-tick-container",t.tick="axis-tick",t.subTick="axis-sub-tick",t.label="axis-label",t.title="axis-title",t.gridContainer="axis-grid-container",t.grid="axis-grid",t.gridRegion="axis-grid-region",t.line="axis-line",t.background="axis-background",t.axisLabelBackground="axis-label-background"}(BI||(BI={})),function(t){t.selected="selected",t.selectedReverse="selected_reverse",t.hover="hover",t.hoverReverse="hover_reverse"}(LI||(LI={}));var II=v(v(v(v({},LI.selectedReverse,{}),LI.selected,{}),LI.hover,{}),LI.hoverReverse,{}),DI={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}};function FI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var zI=function(t){ue(i,t);var e=FI(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="axis",t.data=[],t.tickLineItems=[],t.subTickLineItems=[],t.axisLabelLayerSize={},t.axisLabelsContainer=null,t._onHover=function(e){var i=e.target;i!==t._lastHover&&i.name&&!W(i.states)&&(i.addState(oO.hover,!0),ZL(t.axisContainer,(function(t){t!==i&&t.name&&!W(t.states)&&t.addState(oO.hoverReverse,!0)})),t._lastHover=i)},t._onUnHover=function(e){t._lastHover&&(ZL(t.axisContainer,(function(t){t.name&&!W(t.states)&&(t.removeState(oO.hoverReverse),t.removeState(oO.hover))})),t._lastHover=null)},t._onClick=function(e){var i=e.target;if(t._lastSelect===i&&i.hasState(oO.selected))return t._lastSelect=null,void ZL(t.axisContainer,(function(t){t.name&&!W(t.states)&&(t.removeState(oO.selectedReverse),t.removeState(oO.selected))}));i.name&&!W(i.states)&&(i.addState(oO.selected,!0),ZL(t.axisContainer,(function(t){t!==i&&t.name&&!W(t.states)&&t.addState(oO.selectedReverse,!0)})),t._lastSelect=i)},t}return zt(i,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"getBoundsWithoutRender",value:function(t){var e=X(this.attribute);Q(this.attribute,t);var i=kg.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}},{key:"render",value:function(){this.removeAllChild(),this._prevInnerView=this._innerView,this._innerView=kg.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent()}},{key:"_bindEvent",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.hover,i=t.select;e&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),i&&this._innerView.addEventListener("pointerdown",this._onClick)}}},{key:"_renderInner",value:function(t){var e=this,i=this.attribute,n=i.title,r=i.label,o=i.tick,a=i.line,s=i.items,l=kg.group({x:0,y:0,zIndex:1});if(l.name=BI.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),a&&a.visible&&this.renderLine(l),s&&s.length&&(this.data=this._transformItems(s[0]),o&&o.visible&&this.renderTicks(l),r&&r.visible)){var u=kg.group({x:0,y:0,pickable:!1});u.name=BI.labelContainer,u.id=this._getNodeId("label-container"),this.axisLabelsContainer=u,l.add(u),s.forEach((function(t,i){var n=e.renderLabels(u,t,i),r=n.getChildren();e.beforeLabelsOverlap(r,t,n,i,s.length),e.handleLabelsOverlap(r,t,n,i,s.length),e.afterLabelsOverlap(r,t,n,i,s.length);var o=0,a=0,l="center",c="middle";r.forEach((function(t){var e,i=t.attribute,n=null!==(e=i.angle)&&void 0!==e?e:0,r=t.AABBBounds,s=r.width(),u=r.height();n&&(s=Math.abs(s*Math.cos(n)),u=Math.abs(u*Math.sin(n))),o=Math.max(o,s),a=Math.max(a,u),l=i.textAlign,c=i.textBaseline})),e.axisLabelLayerSize[i]={width:o,height:a,textAlign:l,textBaseline:c}}))}n&&n.visible&&this.renderTitle(l)}},{key:"renderTicks",value:function(t){var e=this,i=this.getTickLineItems(),n=kg.group({x:0,y:0,pickable:!1});n.name=BI.tickContainer,n.id=this._getNodeId("tick-container"),t.add(n),i.forEach((function(t,r){var o,a=kg.line(Object.assign({},e._getTickLineAttribute("tick",t,r,i)));if(a.name=BI.tick,a.id=e._getNodeId(t.id),W(null===(o=e.attribute.tick)||void 0===o?void 0:o.state))a.states=uO;else{var s=e.data[r],l=Q({},uO,e.attribute.tick.state);Object.keys(l).forEach((function(t){A(l[t])&&(l[t]=l[t](s.rawValue,r,s,e.data))})),a.states=l}n.add(a)})),this.tickLineItems=i;var r=this.attribute.subTick;if(r&&r.visible){var o=this.getSubTickLineItems();o.length&&o.forEach((function(t,o){var a=kg.line(Object.assign({},e._getTickLineAttribute("subTick",t,o,i)));if(a.name=BI.subTick,a.id=e._getNodeId("".concat(o)),W(r.state))a.states=uO;else{var s=Q({},uO,r.state);Object.keys(s).forEach((function(e){A(s[e])&&(s[e]=s[e](t.value,o,t,i))})),a.states=s}n.add(a)})),this.subTickLineItems=o}}},{key:"renderLabels",value:function(t,e,i){var n=this,r=this.attribute.label.dataFilter;r&&A(r)&&(e=r(e,i));var o=this._transformItems(e),a=kg.group({x:0,y:0,pickable:!1});return a.name="".concat(BI.labelContainer,"-layer-").concat(i),a.id=this._getNodeId("label-container-layer-".concat(i)),t.add(a),o.forEach((function(t,e){var r,s,l,u,c=n._getLabelAttribute(t,e,o,i);if("rich"===c.type?(c.textConfig=c.text,c.width=null!==(r=c.width)&&void 0!==r?r:0,c.height=null!==(s=c.height)&&void 0!==s?s:0,u=kg.richtext(c)):"html"===c.type?(c.textConfig=[],c.html=Object.assign(Object.assign({dom:c.text},cO),c),u=kg.richtext(c)):u=kg.text(c),u.name=BI.label,u.id=n._getNodeId("layer".concat(i,"-label-").concat(t.id)),W(null===(l=n.attribute.label)||void 0===l?void 0:l.state))u.states=uO;else{var h=Q({},uO,n.attribute.label.state);Object.keys(h).forEach((function(n){A(h[n])&&(h[n]=h[n](t,e,o,i))})),u.states=h}a.add(u)})),a}},{key:"renderTitle",value:function(t){var e=this.getTitleAttribute(),i=new yO(Object.assign({},e));i.name=BI.title,i.id=this._getNodeId("title"),t.add(i)}},{key:"getVerticalCoord",value:function(t,e,i){var n=this.getVerticalVector(e,i,t);return{x:t.x+n[0],y:t.y+n[1]}}},{key:"getTextAlign",value:function(t){var e="center";return kt(t[0],0)?kt(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}},{key:"getTickLineItems",value:function(){var t=this,e=this.attribute.tick,i=this.data,n=[],r=e.alignWithLabel,o=e.inside,a=void 0!==o&&o,s=e.length,l=e.dataFilter,u=1;return i.length>=2&&(u=i[1].value-i[0].value),(l&&A(l)?l(i):i).forEach((function(e){var i=e.point,o=e.value;if(!r){var l=e.value-u/2;if(t.isInValidValue(l))return;i=t.getTickCoord(l),o=l}var c=t.getVerticalCoord(i,s,a);if("3d"===t.mode){var h=t.getVerticalVector(s,a,i),d=0,f=0;Ut(h[0])>Ut(h[1])?d=Nt/2*(c.x>i.x?1:-1):f=Nt/2*(c.y>i.y?-1:1),n.push({start:i,end:c,value:o,id:"tick-".concat(e.id),anchor:[i.x,i.y],alpha:d,beta:f})}else n.push({start:i,end:c,value:o,id:"tick-".concat(e.id)})})),n}},{key:"getSubTickLineItems",value:function(){var t=this.attribute.subTick,e=[],i=t.count,n=void 0===i?4:i,r=t.inside,o=void 0!==r&&r,a=t.length,s=void 0===a?2:a,l=this.tickLineItems,u=l.length;if(u>=2)for(var c=0;c<u-1;c++)for(var h=l[c],d=l[c+1],f=0;f<n;f++){var p=(f+1)/(n+1),v=(1-p)*h.value+p*d.value,y=this.getTickCoord(v),g=this.getVerticalCoord(y,s,o);e.push({start:y,end:g,value:v,id:"sub-tick-".concat(v)})}return e}},{key:"_getTickLineAttribute",value:function(t,e,i,n){var r=U(this.attribute,"".concat(t,".style")),o=this.data[i];r=A(r)?Q({},U(DI,"".concat(t,".style")),"tick"===t?r(o.rawValue,i,o,this.data):r(e.value,i,e,n)):r;var a=e.start,s=e.end,l=e.anchor,u=e.alpha,c=e.beta;return Object.assign({points:[a,s],anchor:l,alpha:u,beta:c},r)}},{key:"_getLabelAttribute",value:function(t,e,i,n){var r,o,a=this.attribute.label,s=a.space,l=void 0===s?4:s,u=a.inside,c=void 0!==u&&u,h=a.formatMethod,d=a.type,f=void 0===d?"text":d,p=a.text,v=l,y=0;(null===(r=this.attribute.tick)||void 0===r?void 0:r.visible)&&this.attribute.tick.inside===c&&(y=this.attribute.tick.length||4),(null===(o=this.attribute.subTick)||void 0===o?void 0:o.visible)&&this.attribute.subTick.inside===c&&(y=Math.max(y,this.attribute.subTick.length||2)),v+=y;var g=this.getRelativeVector(t.point);n>0&&(0===g[1]?v+=(this.axisLabelLayerSize[n-1].height+U(this.attribute,"label.space",4))*n:v+=(this.axisLabelLayerSize[n-1].width+U(this.attribute,"label.space",4))*n);var m=this.getVerticalCoord(t.point,v,c),_=this.getVerticalVector(v||1,c,m),b=h?h("".concat(t.label),t,e,i,n):t.label,x=this.attribute.label.style;return x=A(x)?Q({},DI.label.style,x(t,e,i,n)):x,x=Q(this.getLabelAlign(_,c,x.angle),x),A(x.text)&&(x.text=x.text({label:t.label,value:t.rawValue,index:t.index,layer:n})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(m,_,b,x)),{text:null!=p?p:b,lineHeight:null==x?void 0:x.fontSize,type:f}),x)}},{key:"getLabelPosition",value:function(t,e,i,n){return t}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}}]),i}(OT);function jI(t){t.forEach((function(t){if(!t.rotatedBounds&&t.attribute.angle){var e,i,n,r,o,a=function(t){var e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),s=(e=a.centerX,i=a.centerY,n=a.angle,r=t.attribute.x,o=t.attribute.y,{x:(e-r)*Math.cos(n)+(i-o)*Math.sin(n)+r,y:(e-r)*Math.sin(n)+(o-i)*Math.cos(n)+o}),l=s.x-a.centerX,u=s.y-a.centerY;a.x1+=l,a.x2+=l,a.y1+=u,a.y2+=u,a.centerX+=l,a.centerY+=u,t.rotatedBounds=a}}))}function HI(t,e){return Qe(t.AABBBounds,e.AABBBounds,!1)&&(!t.rotatedBounds||!e.rotatedBounds||function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,r=ri(t,i),o=ri(e,i),a=function(t,e){return[e.x-t.x,e.y-t.y]};n&&(n.save(),n.fillStyle="red",n.globalAlpha=.6,r.forEach((function(t,e){0===e?n.moveTo(t.x,t.y):n.lineTo(t.x,t.y)})),n.fill(),n.restore(),n.save(),n.fillStyle="green",n.globalAlpha=.6,o.forEach((function(t,e){0===e?n.moveTo(t.x,t.y):n.lineTo(t.x,t.y)})),n.fill(),n.restore());var s=ni(t),l=ni(e);n&&n.fillRect(s.x,s.y,2,2),n&&n.fillRect(l.x,l.y,2,2);var u=a(s,l),c=a(r[0],r[1]),h=a(r[1],r[2]),d=a(o[0],o[1]),f=a(o[1],o[2]),p=i?t.angle:ii(t.angle),v=i?t.angle+Vt:ii(90-t.angle),y=i?e.angle:ii(e.angle),g=i?e.angle+Vt:ii(90-e.angle);v>Wt&&(v-=Wt),g>Wt&&(g-=Wt);var m=function(t,e,i,n){var r=[Math.cos(e),Math.sin(e)];return t+(ti(r,i)+ti(r,n))/2>ti(r,u)};return m((t.x2-t.x1)/2,p,d,f)&&m((t.y2-t.y1)/2,v,d,f)&&m((e.x2-e.x1)/2,y,c,h)&&m((e.y2-e.y1)/2,g,c,h)}(t.rotatedBounds,e.rotatedBounds,!0))}var NI={parity:function(t){return t.filter((function(t,e){return e%2?t.setAttribute("opacity",0):1}))},greedy:function(t,e){var i;return t.filter((function(t,n){return n&&VI(i,t,e)?t.setAttribute("opacity",0):(i=t,1)}))}};function VI(t,e,i){var n=t.AABBBounds,r=e.AABBBounds;return i>Math.max(r.x1-n.x2,n.x1-r.x2,r.y1-n.y2,n.y1-r.y2)&&(!t.rotatedBounds||!e.rotatedBounds||i>Math.max(e.rotatedBounds.x1-t.rotatedBounds.x2,t.rotatedBounds.x1-e.rotatedBounds.x2,e.rotatedBounds.y1-t.rotatedBounds.y2,t.rotatedBounds.y1-e.rotatedBounds.y2))}function GI(t,e){for(var i,n=1,r=t.length,o=t[0];n<r;o=i,++n)if(VI(o,i=t[n],e))return!0}function WI(t){var e=t.AABBBounds;return e.width()>1&&e.height()>1}function UI(t,e){if(!W(t)){var i=e.orient,n=e.labelRotateAngle,r=void 0===n?[0,45,90]:n;if(0!==r.length&&!t.some((function(t){return!!t.attribute.angle}))){var o=0,a=0,s=function(){var e=r[o++];if(t.forEach((function(t){t.attribute.angle=ge(e)})),function(t,e){"bottom"!==t&&"top"!==t||function(t,e){e.forEach((function(e){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},KI(t,e.attribute.angle)),{angle:YI(e.attribute.angle)}))}))}(t,e),"left"!==t&&"right"!==t||function(t,e){e.forEach((function(e,i){e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},XI(t,e.attribute.angle)),{angle:YI(e.attribute.angle)}))}))}(t,e),jI(e)}(i,t),!function(t){for(var e=1;e<t.length;e++)if(HI(t[e-1],t[e]))return!0;return!1}(t))return 1};for(r&&r.length>0&&(a=r.length);o<a&&!s(););}}}function YI(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function KI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(i=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);var r,o=(e=YI(e))/(.5*Math.PI);return{textAlign:i[r=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1],textBaseline:n[r]}}function XI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=["right","right","center","left","center","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(i=["left","right","right","right","left","left","left","left","right"],n=["middle","bottom","middle","top","top","top","middle","bottom","bottom"]);var r,o=(e=YI(e))/(.5*Math.PI);return{textAlign:i[r=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1],textBaseline:n[r]}}var ZI=function(){function t(){jt(this,t)}return zt(t,[{key:"isInValidValue",value:function(t){return t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute.start,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}},{key:"getRelativeVector",value:function(t){var e=this.attribute,i=e.start,n=e.end;return[n.x-i.x,n.y-i.y]}},{key:"getVerticalVector",value:function(t){var e,i,n,r,o,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.attribute.verticalFactor,l=void 0===s?1:s,u=this.getRelativeVector(),c=(i=Mt(e=u,2),n=i[0],r=i[1],(o=n*n+r*r)>0&&(o=1/Math.sqrt(o)),[e[0]*o,e[1]*o]);return nO([c[1],-1*c[0]],t*(a?1:-1)*l)}}]),t}();function qI(){xL(),wL(),FL(),GL()}function JI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var QI=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};qI(),LL();var $I=function(t){ue(i,t);var e=JI(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t),n)}return zt(i,[{key:"_renderInner",value:function(t){var e;Xs(de(i.prototype),"_renderInner",this).call(this,t);var n=this.attribute.panel;if(n&&n.visible){var r=this.axisContainer,o=r.AABBBounds,a=kg.rect(Object.assign({x:o.x1,y:o.y1,width:o.width(),height:o.height()},n.style));a.name=BI.background,a.id=this._getNodeId("background"),a.states=Q({},II,null!==(e=n.state)&&void 0!==e?e:{}),r.insertBefore(a,r.firstChild)}}},{key:"renderLine",value:function(t){var e=this.attribute,i=e.start,n=e.end,r=e.line,o=r.startSymbol,a=r.endSymbol,s=r.style;r.breakRange,r.breakShape,r.breakShapeStyle;var l=r.state,u=QI(r,["startSymbol","endSymbol","style","breakRange","breakShape","breakShapeStyle","state"]),c=Object.assign({points:[i,n],startSymbol:o,endSymbol:a,lineStyle:s},u);W(l)||(c.state={line:Q({},II,l),symbol:Q({},II,l)});var h=new OI(c);h.name=BI.line,h.id=this._getNodeId("line"),t.add(h)}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this,r=this.attribute.title,o=r.position,a=void 0===o?"middle":o,s=r.space,l=void 0===s?4:s,u=r.textStyle,c=void 0===u?{}:u,h=r.autoRotate,d=void 0===h||h,f=r.shape,p=r.background,v=r.state,y=void 0===v?{}:v,g=QI(r,["position","space","textStyle","autoRotate","shape","background","state"]),m=.5;"start"===a?m=0:"end"===a&&(m=1);var _=this.attribute.verticalFactor,b=-1*(void 0===_?1:_),x=this.getTickCoord(m),k=this.getRelativeVector(),S=0;if((null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside){var A=+U(this.attribute,"label.space",4);S+=A;var T=Object.keys(this.axisLabelLayerSize).length;if(0===k[1]){var M=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(M)?S+=M+(T-1)*A:S=0}else{if(0===k[0]){var C=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.width():0;isFinite(C)?S+=C+(T-1)*A:S=0}else Object.keys(this.axisLabelLayerSize).forEach((function(t,e){S+=n.axisLabelLayerSize[t].width+(e>0?A:0)}));var E=this.axisLabelLayerSize[0].textAlign,R="start"===E||"left"===E,P="center"===E,B=k[1]>0;S=1===b?B?R?S:P?S/2:A:R?A:P?S/2:S:B?R?A:P?S/2:S:R?S:P?S/2:A}}var L=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(L=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(L=Math.max(L,this.attribute.subTick.length||2));var O,I,D=L+S+l,F=this.getVerticalCoord(x,D,!1),z=this.getVerticalVector(D,!1,{x:0,y:0}),j=g.angle;if(O="start"===a?"start":"end"===a?"end":"center",w(j)&&d){j=rO(k,[1,0],!0);var H=this.attribute.verticalFactor;I=1==-1*(void 0===H?1:H)?"bottom":"top"}else O=this.getTextAlign(z),I=this.getTextBaseline(z,!1);var N=Object.assign(Object.assign(Object.assign({},F),g),{textStyle:Object.assign({textAlign:O,textBaseline:I},c),state:{text:Q({},II,y.text),shape:Q({},II,y.shape),panel:Q({},II,y.background)}});return N.angle=j,f&&f.visible&&(N.shape=Object.assign({visible:!0},f.style),f.space&&(N.space=f.space)),p&&p.visible&&(N.panel=Object.assign({visible:!0},p.style)),N}},{key:"getTextBaseline",value:function(t,e){var i="middle",n=this.attribute.verticalFactor,r=(e?1:-1)*(void 0===n?1:n);return kt(t[1],0)?i=!kt(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1===r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}},{key:"getLabelAlign",value:function(t,e,i){var n=this.attribute.orient;if(F(i)||0===t[0]&&0===t[1]){if("top"===n||"bottom"===n)return KI(n,i);if("left"===n||"right"===n)return XI(n,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){var o,a,s,l,u=(this.attribute.label||{}).flush;if(void 0!==u&&u&&t.length){var c=this.attribute,h=c.orient,d=c.start,f=c.end,p="bottom"===h||"top"===h,v=t[0],y=ut(t),g=p?v.attribute.x>y.attribute.x:v.attribute.y<y.attribute.y;if(p){var m=g?y:v,_=g?v:y,b=d.x,x=f.x,k=m.AABBBounds.x1,S=_.AABBBounds.x2;k<b&&(m.attribute.angle?m.setAttributes({dx:(null!==(o=m.attribute.dx)&&void 0!==o?o:0)+b-k}):m.setAttributes({x:b,textAlign:"left"})),S>x&&(_.attribute.angle?_.setAttributes({dx:(null!==(a=_.attribute.dx)&&void 0!==a?a:0)+x-S}):_.setAttributes({x:x,textAlign:"right"}))}else{var A=g?y:v,w=g?v:y,T=A.AABBBounds.y2,M=w.AABBBounds.y1,C=d.y,E=f.y;M<C&&(w.attribute.angle?w.setAttributes({dy:(null!==(s=w.attribute.dy)&&void 0!==s?s:0)+C-M}):w.setAttributes({y:C,textBaseline:"top"})),T>E&&(A.attribute.angle?A.setAttributes({dy:(null!==(l=A.attribute.dy)&&void 0!==l?l:0)+E-T}):A.setAttributes({y:E,textBaseline:"bottom"}))}}}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){if(!W(t)){var o=this.attribute,a=o.verticalLimitSize,s=o.label,l=o.orient,u=this._getAxisLabelLimitLength(a,r),c=s.layoutFunc,h=s.autoRotate,d=s.autoRotateAngle,f=s.autoLimit,p=s.limitEllipsis,v=s.autoHide,y=s.autoHideMethod,g=s.autoHideSeparation,m=s.lastVisible;if(A(c))c(t,e,n,this);else{if(h&&UI(t,{labelRotateAngle:d,orient:l}),f&&F(u)&&u>0){var _="left"!==l&&"right"!==l||!t.some((function(t){return"vertical"===t.attribute.direction}))?1/0:Math.abs(this.attribute.start.y-this.attribute.end.y)/t.length;!function(t,e){var i=e.limitLength,n=e.verticalLimitLength,r=e.ellipsis,o=void 0===r?"...":r,a=e.orient;!W(t)&&F(i)&&t.forEach((function(t){if("top"!==a&&"bottom"!==a||!(Math.floor(t.AABBBounds.height())<=i)){var e=t.attribute.direction;if("left"!==a&&"right"!==a||!("vertical"===e&&Math.floor(t.AABBBounds.height())<=n||"vertical"!==e&&Math.floor(t.AABBBounds.width())<=i)){var r=t.attribute.angle,s=0===r||w(r)?"top"===a||"bottom"===a?null:"vertical"===e?n:i:Math.abs(i/Math.sin(r));F(t.attribute.maxLineWidth)&&(s=F(s)?Math.min(t.attribute.maxLineWidth,s):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:s,ellipsis:t.attribute.ellipsis||o})}}}))}(t,{limitLength:u,verticalLimitLength:_,ellipsis:p,orient:l})}v&&function(t,e){if(!W(t)){var i=t.filter(WI);if(!W(i)){var n;jI(n=function(t){return t.forEach((function(t){return t.setAttribute("opacity",1)})),t}(i));var r=e.method,o=void 0===r?"parity":r,a=e.separation,s=void 0===a?0:a,l=A(o)?o:NI[o]||NI.parity;if(n.length>=3&&GI(n,s)){do{n=l(n,s)}while(n.length>=3&&GI(n,s));if(n.length<3||e.lastVisible){var u=ut(i);if(!u.attribute.opacity){var c=n.length;if(c>1){u.setAttribute("opacity",1);for(var h=c-1;h>=0&&VI(n[h],u,s);h--)n[h].setAttribute("opacity",0)}}}}i.forEach((function(t){t.setAttribute("visible",!!t.attribute.opacity)}))}}}(t,{orient:l,method:y,separation:g,lastVisible:m})}}}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){var o,a=this.attribute,s=a.verticalLimitSize,l=a.orient,u="bottom"===l||"top"===l,c=i.AABBBounds,h=u?c.height():c.width(),d=this.attribute.verticalMinSize;if(F(d)&&(!F(s)||d<=s)){var f,p,v=this._getAxisLabelLimitLength(d,r);h=Math.max(h,v),"left"===l?(f=c.x2-h,p=c.y1):"right"===l?(f=c.x1,p=c.y1):"top"===l?(f=c.x1,p=c.y2-h):"bottom"===l&&(f=c.x1,p=c.y1);var y=kg.rect({x:f,y:p,width:u?c.width():h,height:u?h:c.height(),pickable:!1});y.name=BI.axisLabelBackground,y.id=this._getNodeId("axis-label-background"),i.insertBefore(y,i.firstChild)}T(this.attribute.label.containerAlign)&&("left"===l?o=c.x2:"right"===l?o=c.x1:"top"===l?o=c.y2:"bottom"===l&&(o=c.y1),function(t,e,i,n,r){if("right"===n||"left"===n){if("left"===r){var o="right"===n?0:-1;t.forEach((function(t){t.setAttributes({x:e+i*o,textAlign:"left"})}))}else if("right"===r){var a="right"===n?1:0;t.forEach((function(t){t.setAttributes({x:e+i*a,textAlign:"right"})}))}else if("center"===r){var s="right"===n?1:-1;t.forEach((function(t){t.setAttributes({x:e+.5*i*s,textAlign:"center"})}))}}else if("bottom"===n||"top"===n)if("top"===r){var l="bottom"===n?0:-1;t.forEach((function(t){t.setAttributes({y:e+i*l,textBaseline:"top"})}))}else if("bottom"===r){var u="bottom"===n?1:0;t.forEach((function(t){t.setAttributes({y:e+i*u,textBaseline:"bottom"})}))}else if("middle"===r){var c="bottom"===n?1:-1;t.forEach((function(t){t.setAttributes({y:e+.5*i*c,textBaseline:"middle"})}))}}(t,o,h,l,this.attribute.label.containerAlign))}},{key:"_getAxisLabelLimitLength",value:function(t,e){var i,n,r,o,a=this.attribute,s=a.label,l=a.title,u=a.line,c=a.tick,h=null!==(i=s.space)&&void 0!==i?i:4,d=t,f=0,p=0,v=u&&u.visible?null!==(n=u.style.lineWidth)&&void 0!==n?n:1:0,y=c&&c.visible?null!==(r=c.length)&&void 0!==r?r:4:0;if(l&&l.visible&&"string"==typeof l.text){f=dO(l.text,l.textStyle,null===(o=this.stage)||void 0===o?void 0:o.getTheme().text.fontFamily).height;var g=mi(l.padding);p=l.space+g[0]+g[2]}return d&&(d=(d-h-p-f-v-y)/e),d}}]),i}(zI);$I.defaultAttributes=DI,ot($I,ZI);var tD=function(){function t(){jt(this,t)}return zt(t,[{key:"isInValidValue",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?aO:i,r=e.endAngle,o=void 0===r?sO:r;return Math.abs(o-n)%(2*Math.PI)==0?t>1:t<0||t>1}},{key:"getTickCoord",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?aO:i,r=e.endAngle,o=void 0===r?sO:r,a=e.center,s=e.radius,l=e.inside,u=void 0!==l&&l,c=e.innerRadius,h=void 0===c?0:c;return be(a,u&&h>0?h:s,n+(o-n)*t)}},{key:"getVerticalVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,n=this.attribute.inside,r=void 0!==n&&n,o=this.attribute.center,a=[i.x-o.x,i.y-o.y];return nO(a,(e?-1:1)*(r?-1:1)*t/function(t){var e=Mt(t,2),i=e[0],n=e[1];return Math.sqrt(i*i+n*n)}(a))}},{key:"getRelativeVector",value:function(t){var e=this.attribute.center;return[t.y-e.y,-1*(t.x-e.x)]}}]),t}(),eD=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<0)for(;t<0;)t+=Gt;else if(t>0)for(;t>Gt;)t-=Gt;return t};function iD(t,e,i){return!At(t,e,0,1e-6)&&!St(t,i,0,1e-6)}function nD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var rD=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};qI(),gL();var oD=function(t){ue(i,t);var e=nD(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))}return zt(i,[{key:"renderLine",value:function(t){var e=this.attribute,i=e.startAngle,n=void 0===i?aO:i,r=e.endAngle,o=void 0===r?sO:r,a=e.radius,s=e.center,l=e.innerRadius,u=void 0===l?0:l,c=e.line,h=void 0===c?{}:c,d=e.inside,f=a,p=u;void 0!==d&&d&&u>0&&(f=u,p=0);var v=Object.assign(Object.assign(Object.assign({},s),{startAngle:n,endAngle:o,radius:f,innerRadius:p}),h.style),y=kg.circle(v);y.name=BI.line,y.id=this._getNodeId("line"),W(h.state)||(y.states=Q({},II,h.state)),t.add(y)}},{key:"getTitleAttribute",value:function(){var t,e,i,n=this.attribute,r=n.center,o=n.radius,a=n.innerRadius,s=void 0===a?0:a,l=this.attribute.title,u=l.space,c=void 0===u?4:u,h=l.textStyle,d=void 0===h?{}:h,f=l.shape,p=l.background,v=l.state,y=void 0===v?{}:v,g=rD(l,["space","textStyle","shape","background","state"]),m=r,_=0;(null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside&&(_=U(this.attribute.label,"style.fontSize",12)+U(this.attribute.label,"space",4));var b=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(b=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(b=Math.max(b,this.attribute.subTick.length||2));var x=o+b+_+c,k="middle",S=this.attribute.title.position;w(S)&&(S=0===s?"end":"middle"),"start"===S?(k="bottom",m={x:r.x,y:r.y-x}):"end"===S&&(k="top",m={x:r.x,y:r.y+x});var A=Object.assign(Object.assign(Object.assign({},m),g),{textStyle:Object.assign({textBaseline:k,textAlign:"center"},d),state:{text:Q({},II,y.text),shape:Q({},II,y.shape),panel:Q({},II,y.background)}}),T=g.angle;return A.angle=T,f&&f.visible&&(A.shape=Object.assign({visible:!0},f.style),f.space&&(A.space=f.space)),p&&p.visible&&(A.panel=Object.assign({visible:!0},p.style)),A}},{key:"getSubTickLineItems",value:function(){var t,e,i=this.attribute.subTick,n=[],r=i.count,o=void 0===r?4:r,a=i.inside,s=void 0!==a&&a,l=i.length,u=void 0===l?2:l,c=this.tickLineItems,h=c.length;if(h>=2)for(var d=this.data[1].value-this.data[0].value,f=null===(e=null===(t=this.attribute)||void 0===t?void 0:t.tick)||void 0===e?void 0:e.alignWithLabel,p=0;p<h;p++)for(var v=c[p],y=c[p+1],g=0;g<o;g++){var m=(g+1)/(o+1),_=(1-m)*v.value+m*(y?y.value:f?1:v.value+d),b=this.getTickCoord(_),x=this.getVerticalCoord(b,u,s);n.push({start:b,end:x,value:_})}return n}},{key:"getTextBaseline",value:function(t){var e="middle";return kt(t[1],0)?e="middle":t[1]>0&&t[1]>Math.abs(t[0])?e="top":t[1]<0&&Math.abs(t[1])>Math.abs(t[0])&&(e="bottom"),e}},{key:"beforeLabelsOverlap",value:function(t,e,i,n,r){}},{key:"handleLabelsOverlap",value:function(t,e,i,n,r){}},{key:"afterLabelsOverlap",value:function(t,e,i,n,r){}},{key:"getLabelAlign",value:function(t,e,i){return{textAlign:"center",textBaseline:"middle"}}},{key:"getLabelPosition",value:function(t,e,i,n){return function(t,e,i,n){var r=Sg(Object.assign({text:i},n)),o=r.width(),a=r.height(),s=eD(Math.atan2(e[1],e[0]))-Math.PI,l=3*Math.PI/4,u=Math.PI/4,c=Math.PI/2;return{x:t.x-(iD(s,-l,-u)?((s+l)/c-.5)*o:iD(s,u,l)?(.5-(s-u)/c)*o:Math.cos(s)>=0?.5*o:.5*-o),y:t.y-(iD(s,-l,-u)?.5*-a:iD(s,u,l)?.5*a:Math.cos(s)>=0?(.5-(u-s)/c)*a:(.5-eD(s-l)/c)*a)}}(t,e,i,n)}}]),i}(zI);function aD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}oD.defaultAttributes=DI,ot(oD,tD);var sD=function(t){ue(i,t);var e=aD(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).mode=Bs.NORMAL,t}return zt(i,[{key:"onBind",value:function(){var t,e=this,i=this.target.getInnerView(),n=this.target.getPrevInnerView();n&&(this._oldElementMap=(t={},ZL(n,(function(e){"group"!==e.type&&e.id&&(t[e.id]=e)})),t),this._newElementAttrMap={},ZL(i,(function(t){var i,n,r,o,a,s;if("group"!==t.type&&t.id){var l=e._oldElementMap[t.id];if(l){if(!nt(t.attribute,l.attribute)){var u=X(t.attribute);e._newElementAttrMap[t.id]={state:"update",node:t,attrs:Object.assign(Object.assign({},u),{opacity:null!==(i=u.opacity)&&void 0!==i?i:1,fillOpacity:null!==(n=u.fillOpacity)&&void 0!==n?n:1,strokeOpacity:null!==(r=u.strokeOpacity)&&void 0!==r?r:1})},t.setAttributes(l.attribute)}}else{var c={opacity:null!==(o=t.attribute.opacity)&&void 0!==o?o:1,fillOpacity:null!==(a=t.attribute.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(s=t.attribute.strokeOpacity)&&void 0!==s?s:1};e._newElementAttrMap[t.id]={state:"enter",node:t,attrs:c},t.setAttributes({opacity:0,fillOpacity:0,strokeOpacity:0})}}})))}},{key:"onStart",value:function(){var t=this,e=this.duration,i=this.easing;Object.keys(this._newElementAttrMap).forEach((function(n){var r,o=t._newElementAttrMap[n],a=o.node,s=o.attrs;if("enter"===o.state){var l=(null!==(r=t.params)&&void 0!==r?r:{}).enter,u=void 0===l?{}:l;e=F(u.duration)?u.duration:e,i=u.easing?u.easing:i}"path"===a.type?a.animate({interpolate:function(t,e,i,n,r){return"path"===t&&(r.path=function(t,e){var i,n,r,o=It.lastIndex=Dt.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(i=It.exec(t))&&(n=Dt.exec(e));)(r=n.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(i=i[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,l.push({i:a,x:Lt(i,n)})),o=Dt.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)s[(i=l[n]).i]=i.x(t);return s.join("")})}(i,n)(e),!0)}}).to(s,e,i):a.animate().to(s,e,i)}))}},{key:"onUpdate",value:function(t,e,i){}}]),i}(Yc);function lD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var uD=function(t){ue(i,t);var e=lD(i);function i(t,n,r,o){return jt(this,i),e.call(this,null,null,r,o)}return zt(i,[{key:"getEndProps",value:function(){return{}}},{key:"onBind",value:function(){this.target.setTheme({common:{opacity:0}})}},{key:"onEnd",value:function(){this.target.setTheme({common:{opacity:1}})}},{key:"onUpdate",value:function(t,e,i){this.target.setTheme({common:{opacity:e}})}}]),i}(Yc);function cD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function hD(t,e){var i="";return 0===t.length||(t.forEach((function(t,e){0===e?i="M".concat(t.x,",").concat(t.y):i+="L".concat(t.x,",").concat(t.y)})),e&&(i+="Z")),i}function dD(t,e,i,n){var r="";if(!t||0===e.length)return r;var o=e[0],a=se.distancePP(t,o),s=i?0:1;return n?r+="M".concat(t.x,",").concat(t.y-a,"A").concat(a,",").concat(a,",0,0,").concat(s,",").concat(t.x,",").concat(t.y+a,"A").concat(a,",").concat(a,",0,0,").concat(s,",").concat(t.x,",").concat(t.y-a,"Z"):e.forEach((function(t,e){0===e?r="M".concat(t.x,",").concat(t.y):r+="A".concat(a,",").concat(a,",0,0,").concat(s,",").concat(t.x,",").concat(t.y)})),r}function fD(t,e,i){var n=i.type,r=i.closed,o=e.slice(0).reverse(),a="",s="";if("line"===n&&i.smoothLink&&i.center){var l=t[0],u=o[0],c=i.center;a=hD(t,!!r),s=hD(o,!!r);var h=se.distancePP(u,c),d=se.distancePP(l,c);a+="A".concat(h,",").concat(h,",0,0,1,").concat(u.x,",").concat(u.y,"L").concat(u.x,",").concat(u.y),s+="A".concat(d,",").concat(d,",0,0,0,").concat(l.x,",").concat(l.y)}else if("circle"===n){var f=i.center;a=dD(f,t,!1,!!r),s=dD(f,o,!0,!!r)}else"line"!==n&&"polygon"!==n||(a=hD(t,!!r),s=hD(o,!!r));return r?a+=s:(a+=s="L"+s.substring(1),a+="Z"),a}var pD=function(t){ue(i,t);var e=cD(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="axis-grid",t.data=[],t}return zt(i,[{key:"getInnerView",value:function(){return this._innerView}},{key:"getPrevInnerView",value:function(){return this._prevInnerView}},{key:"render",value:function(){this.removeAllChild(),this._prevInnerView=this._innerView,this._innerView=kg.group({x:0,y:0,pickable:!1}),this.add(this._innerView);var t=this.attribute,e=t.items,i=t.visible;e&&e.length&&!1!==i&&(this.data=this._transformItems(e),this._renderGrid(this._innerView))}},{key:"getVerticalCoord",value:function(t,e,i){var n=this.getVerticalVector(e,i,t);return{x:t.x+n[0],y:t.y+n[1]}}},{key:"_transformItems",value:function(t){var e=this,i=[];return t.forEach((function(t){var n;i.push(Object.assign(Object.assign({},t),{point:e.getTickCoord(t.value),id:null!==(n=t.id)&&void 0!==n?n:t.label}))})),i}},{key:"_renderGrid",value:function(t){(this.attribute.subGrid||{}).visible&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}},{key:"_renderGridByType",value:function(t,e){var n=this,r=Q({},this.attribute,this.getGridAttribute(t)),o=r.type,a=r.items,s=r.style,l=r.closed,u=r.alternateColor,c=r.depth,h=void 0===c?0:c,d=t?"".concat(BI.grid,"-sub"):"".concat(BI.grid);if(a.forEach((function(t,r){var a=t.id,u=t.points,c="";if("line"===o||"polygon"===o)c=hD(u,!!l);else if("circle"===o){c=dD(n.attribute.center,u,!1,!!l)}var f=kg.path(Object.assign({path:c,z:h},A(s)?Q({},n.skipDefault?null:i.defaultAttributes.style,s(t,r)):s));f.name="".concat(d,"-line"),f.id=n._getNodeId("".concat(d,"-path-").concat(a)),e.add(f)})),h&&"line"===o&&a.forEach((function(t,r){var o=t.id,a=t.points,u=[];u.push(a[0]);var c=a[1].x-a[0].x,f=a[1].y-a[0].y,p=Math.sqrt(c*c+f*f),v=h/p;u.push({x:a[0].x+c*v,y:a[0].y+f*v});var y=hD(u,!!l),g=Ut(u[0].x-u[1].x),m=Ut(u[0].y-u[1].y),_=kg.path(Object.assign({path:y,z:0,alpha:g>m?(a[1].x-a[0].x>0?-1:1)*Nt/2:0,beta:g<m?-Nt/2:0,anchor3d:g>m?[u[0].x,0]:[0,u[0].y]},A(s)?Q({},n.skipDefault?null:i.defaultAttributes.style,s(t,r)):s));_.name="".concat(d,"-line"),_.id=n._getNodeId("".concat(d,"-path-").concat(o)),e.add(_)})),a.length>1&&u)for(var f=B(u)?u:[u,"transparent"],p=function(t){return f[t%f.length]},v=0;v<a.length-1;v++){var y=[a[v].points,a[v+1].points],g=fD(y[0],y[1],r),m=kg.path({path:g,fill:p(v)});m.name="".concat(d,"-region"),m.id=this._getNodeId("".concat(d,"-region-").concat(v)),e.add(m)}}},{key:"_getNodeId",value:function(t){return"".concat(this.id,"-").concat(t)}}]),i}(OT);function vD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}pD.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}},xL(),ML();var yD=function(t){ue(i,t);var e=vD(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},pD.defaultAttributes,t),n)}return zt(i,[{key:"_getGridPoint",value:function(t,e){var i;if("line"===t){var n=this.attribute.length;i=[e,this.getVerticalCoord(e,n,!0)]}else if("circle"===t||"polygon"===t){var r=this.attribute,o=r.center,a=r.sides,s=void 0===a?6:a,l=r.startAngle,u=void 0===l?aO:l,c=r.endAngle,h=void 0===c?sO:c;i=function(t,e,i,n,r){for(var o=[],a=r-n,s=0;s<e;s++){var l=n+s*a/e;o.push(be(t,i,l))}return o}(o,s,se.distancePP(o,e),u,h)}return i}},{key:"getGridAttribute",value:function(t){var e,i=this,n=this.attribute,r=n.type,o=n.alignWithLabel,a=void 0===o||o,s=1;this.data.length>=2&&(s=this.data[1].value-this.data[0].value);var l=[];if(t){e=Q({},this.attribute,this.attribute.subGrid);var u=[],c=(this.attribute.subGrid||{}).count,h=void 0===c?4:c;if(this.data.length>=2){var d=[];this.data.forEach((function(t){var e=t.value;if(!a){var n=t.value-s/2;if(i.isInValidValue(n))return;e=n}d.push({value:e})}));for(var f=0;f<d.length-1;f++){var p=d[f],v=d[f+1];u.push({id:"sub-".concat(f,"-0"),points:this._getGridPoint(r,this.getTickCoord(p.value)),datum:{}});for(var y=0;y<h;y++){var g=(y+1)/(h+1),m=(1-g)*p.value+g*v.value,_=this.getTickCoord(m);u.push({id:"sub-".concat(f,"-").concat(y+1),points:this._getGridPoint(r,_),datum:{}})}f===d.length-2&&u.push({id:"sub-".concat(f,"-").concat(h+1),points:this._getGridPoint(r,this.getTickCoord(v.value)),datum:{}})}l=u}}else{e=this.attribute;var b=[];this.data.forEach((function(t){var e=t.point;if(!a){var n=t.value-s/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}b.push({id:t.label,datum:t,points:i._getGridPoint(r,e)})})),l=b}return Object.assign(Object.assign({},e),{items:l})}}]),i}(pD);function gD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}ot(yD,ZI);var mD=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};xL(),ML();var _D=function(t){ue(i,t);var e=gD(i);function i(t,n){return jt(this,i),e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},pD.defaultAttributes,t),n)}return zt(i,[{key:"getGridAttribute",value:function(t){var e,i=this,n=[],r=this.attribute,o=r.radius,a=r.innerRadius,s=void 0===a?0:a,l=r.startAngle,u=void 0===l?aO:l,c=r.endAngle,h=void 0===c?sO:c,d=r.center,f=r.subGrid,p=mD(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),v=(p||{}).alignWithLabel,y=void 0===v||v,g=o-s,_=1;if(this.data.length>=2&&(_=this.data[1].value-this.data[0].value),t){e=Q({},p,f);var b=[],x=(f||{}).count,k=void 0===x?4:x,S=this.data.length;if(S>=2){var A=[];this.data.forEach((function(t){var e=t.value;if(!y){var n=t.value-_/2;if(i.isInValidValue(n))return;e=n}A.push({value:e})}));for(var w=0;w<S;w++){var T=A[w],M=A[w+1];b.push({id:"sub-".concat(w,"-0"),points:[this.getTickCoord(T.value),this.getVerticalCoord(this.getTickCoord(T.value),g,!0)],datum:{}});for(var C=0;C<k;C++){var E=(C+1)/(k+1),R=(1-E)*T.value+E*(M?M.value:y?1:T.value+_),P=this.getTickCoord(R),B=this.getVerticalCoord(P,g,!0);b.push({id:"sub-".concat(w,"-").concat(C+1),points:[P,B],datum:{}})}}Math.abs(h-u)%(2*Math.PI)==0&&b.push(b[0]),n=b}}else{e=p;var L=[];(Math.abs(h-u)%(2*Math.PI)==0?m(this.data).concat(this.data[0]):this.data).forEach((function(t){var e=t.point;if(!y){var n=t.value-_/2;if(i.isInValidValue(n))return;e=i.getTickCoord(n)}var r=i.getVerticalCoord(e,g,!0);L.push({id:t.id,points:[e,r],datum:t})})),n=L}return Object.assign(Object.assign({},e),{items:n,center:d,type:"line"})}}]),i}(pD);ot(_D,tD);var bD,xD="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",kD={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:xD,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:xD,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}},SD={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};function AD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}!function(t){t.startHandler="startHandler",t.endHandler="endHandler",t.middleHandler="middleHandler",t.background="background"}(bD||(bD={}));var wD=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},TD={debounce:Pt,throttle:Bt};fO(),LL(),NL(),vL(),wL();var MD,CD,ED,RD=function(t){ue(i,t);var e=AD(i);function i(t,n){var r;jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="dataZoom",r._previewData=[],r._activeState=!1,r._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},r._layoutCache={attPos:"x",attSize:"width",max:0},r.state={start:0,end:1},r._statePointToData=function(t){return t},r._onHandlerPointerDown=function(t,e){t.stopPropagation(),"start"===e?(r._activeTag=bD.startHandler,r._activeItem=r._startHandlerMask):"end"===e?(r._activeTag=bD.endHandler,r._activeItem=r._endHandlerMask):"middleRect"===e?(r._activeTag=bD.middleHandler,r._activeItem=r._middleHandlerRect):"middleSymbol"===e?(r._activeTag=bD.middleHandler,r._activeItem=r._middleHandlerSymbol):"background"===e&&(r._activeTag=bD.background,r._activeItem=r._background),r._activeState=!0,r._activeCache.startPos=r.eventPosToStagePos(t),r._activeCache.lastPos=r.eventPosToStagePos(t),"browser"===ux.env&&(ux.addEventListener("pointermove",r._onHandlerPointerMove,{capture:!0}),ux.addEventListener("pointerup",r._onHandlerPointerUp.bind(ce(r)))),r.addEventListener("pointermove",r._onHandlerPointerMove,{capture:!0})},r._onHandlerPointerMove=TD[r.attribute.delayType]((function(t){t.stopPropagation();var e=r.attribute,i=e.start,n=e.end,o=e.brushSelect;e.realTime;var a=r.eventPosToStagePos(t),s=r._layoutCache,l=s.attPos,u=s.max,c=(a[l]-r._activeCache.lastPos[l])/u,h=r.state,d=h.start,f=h.end;r._activeState&&(r._activeTag===bD.middleHandler?r.moveZoomWithMiddle((r.state.start+r.state.end)/2+c):r._activeTag===bD.startHandler?d+c>f?(f=(d=f)+c,r._activeTag=bD.endHandler):d+=c:r._activeTag===bD.endHandler&&(f+c<d?(d=(f=d)+c,r._activeTag=bD.startHandler):f+=c),r._activeCache.lastPos=a,o&&r.renderDragMask()),d=Math.min(Math.max(d,0),1),f=Math.min(Math.max(f,0),1),i===d&&n===f||(r.setStateAttr(d,f,!0),r._dispatchEvent("change",{start:d,end:f,tag:r._activeTag}))}),r.attribute.delayTime);var o=t.position,a=t.showDetail;return r._activeCache.startPos=o,r._activeCache.lastPos=o,r._showText="auto"!==a&&a,r.setPropsFromAttrs(),r}return zt(i,[{key:"setPropsFromAttrs",value:function(){var t=this.attribute,e=t.start,i=t.end,n=t.orient,r=t.previewData,o=t.previewPointsX,a=t.previewPointsY,s=t.previewPointsX1,l=t.previewPointsY1;e&&(this.state.start=e),i&&(this.state.end=i);var u=this.getLayoutAttrFromConfig(),c=u.width,h=u.height;this._spanCache=this.state.end-this.state.start,this._isHorizontal="top"===n||"bottom"===n,this._layoutCache.max=this._isHorizontal?c:h,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",r&&(this._previewData=r),A(o)&&(this._previewPointsX=o),A(a)&&(this._previewPointsY=a),A(s)&&(this._previewPointsX1=s),A(l)&&(this._previewPointsY1=l)}},{key:"setAttributes",value:function(t,e){Xs(de(i.prototype),"setAttributes",this).call(this,t,e),this.setPropsFromAttrs()}},{key:"bindEvents",value:function(){var t=this;if(!this.attribute.disableTriggerEvent){var e=this.attribute,i=e.showDetail,n=e.brushSelect;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"start")})),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"end")})),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleSymbol")})),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"middleRect")}));var r=n?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),n&&this._background&&this._background.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),n&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,"background")})),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",(function(e){return t._onHandlerPointerDown(e,r)})),this.addEventListener("pointerup",this._onHandlerPointerUp),this.addEventListener("pointerupoutside",this._onHandlerPointerUp),"auto"===i&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave))}}},{key:"dragMaskSize",value:function(){var t=this.attribute.position,e=this._layoutCache,i=e.attPos,n=e.max;return this._activeCache.lastPos[i]-t[i]>n?n+t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-t[i]<0?t[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-this._activeCache.startPos[i]}},{key:"setStateAttr",value:function(t,e,i){var n=this.attribute,r=n.zoomLock,o=void 0!==r&&r,a=n.minSpan,s=void 0===a?0:a,l=n.maxSpan,u=void 0===l?1:l,c=e-t;c!==this._spanCache&&(o||c<s||c>u)||(this._spanCache=c,this.state.start=t,this.state.end=e,i&&this.setAttributes({start:t,end:e}))}},{key:"eventPosToStagePos",value:function(t){var e,i,n=ux.mapToCanvasPoint(t),r=n.x,o=n.y;return{x:r-((null===(e=this.stage)||void 0===e?void 0:e.x)||0),y:o-((null===(i=this.stage)||void 0===i?void 0:i.y)||0)}}},{key:"_onHandlerPointerUp",value:function(t){t.preventDefault();var e=this.attribute,i=e.start,n=e.end,r=e.brushSelect,o=e.realTime,a=void 0===o||o;if(this._activeState&&this._activeTag===bD.background){var s=this.eventPosToStagePos(t);this.backgroundDragZoom(this._activeCache.startPos,s)}this._activeState=!1,r&&this.renderDragMask(),a&&i===this.state.start&&n===this.state.end||(this.setStateAttr(this.state.start,this.state.end,!0),this._dispatchEvent("change",{start:this.state.start,end:this.state.end,tag:this._activeTag})),"browser"===ux.env&&(ux.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),ux.removeEventListener("pointerup",this._onHandlerPointerUp.bind(this))),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})}},{key:"_onHandlerPointerEnter",value:function(t){t.stopPropagation(),this._showText=!0,this.renderText()}},{key:"_onHandlerPointerLeave",value:function(t){t.stopPropagation(),this._showText=!1,this.renderText()}},{key:"backgroundDragZoom",value:function(t,e){var i=this._layoutCache,n=i.attPos,r=i.max,o=this.attribute.position,a=t[n]-o[n],s=e[n]-o[n],l=Math.min(Math.max(Math.min(a,s)/r,0),1),u=Math.min(Math.max(Math.max(a,s)/r,0),1);Math.abs(l-u)<.01?this.moveZoomWithMiddle(l):this.setStateAttr(l,u,!1)}},{key:"moveZoomWithMiddle",value:function(t){var e=t-(this.state.start+this.state.end)/2;0!==e&&(e>0?this.state.end+e>1&&(e=1-this.state.end):e<0&&this.state.start+e<0&&(e=-this.state.start),this.setStateAttr(this.state.start+e,this.state.end+e,!1))}},{key:"renderDragMask",value:function(){var t=this.attribute.dragMaskStyle,e=this.getLayoutAttrFromConfig(),i=e.position,n=e.width,r=e.height;this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:Tt(this.dragMaskSize()<0?this._activeCache.lastPos.x:this._activeCache.startPos.x,i.x,i.x+n),y:i.y,width:this._activeState&&this._activeTag===bD.background&&Math.abs(this.dragMaskSize())||0,height:r},t),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:i.x,y:Tt(this.dragMaskSize()<0?this._activeCache.lastPos.y:this._activeCache.startPos.y,i.y,i.y+r),width:n,height:this._activeState&&this._activeTag===bD.background&&Math.abs(this.dragMaskSize())||0},t),"rect")}},{key:"isTextOverflow",value:function(t,e,i){if(!e)return!1;if(this._isHorizontal){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1}},{key:"setTextAttr",value:function(t,e){var i=this.attribute,n=i.startTextStyle,r=i.endTextStyle,o=n.formatMethod,a=wD(n,["formatMethod"]),s=r.formatMethod,l=wD(r,["formatMethod"]),u=this.state,c=u.start,h=u.end;this._startValue=this._statePointToData(c),this._endValue=this._statePointToData(h);var d,f,p,v,y=this.getLayoutAttrFromConfig(),g=y.position,m=y.width,_=y.height,b=o?o(this._startValue):this._startValue,x=s?s(this._endValue):this._endValue,k={x1:g.x,y1:g.y,x2:g.x+m,y2:g.y+_};this._isHorizontal?(d={x:g.x+c*m,y:g.y+_/2},f={x:g.x+h*m,y:g.y+_/2},p={textAlign:this.isTextOverflow(k,t,"start")?"left":"right",textBaseline:"middle"},v={textAlign:this.isTextOverflow(k,e,"end")?"right":"left",textBaseline:"middle"}):(d={x:g.x+m/2,y:g.y+c*_},f={x:g.x+m/2,y:g.y+h*_},p={textAlign:"center",textBaseline:this.isTextOverflow(k,t,"start")?"top":"bottom"},v={textAlign:"center",textBaseline:this.isTextOverflow(k,e,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,Q({},a,{text:b,x:d.x,y:d.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:p}),"data-zoom-start-text-".concat(g)),this._endText=this.maybeAddLabel(this._container,Q({},l,{text:x,x:f.x,y:f.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:v}),"data-zoom-end-text-".concat(g))}},{key:"renderText",value:function(){var t=null,e=null;this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds,this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;var i=t,n=i.x1,r=i.x2,o=i.y1,a=i.y2,s=this.attribute.startTextStyle,l=s.dx,u=void 0===l?0:l,c=s.dy,h=void 0===c?0:c;if((new ve).set(n,o,r,a).intersects(e)){var d="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",h+d*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",u+d*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",h):this._startText.setAttribute("dx",u)}},{key:"getLayoutAttrFromConfig",value:function(){var t,e,i,n;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;var r,o,a,s=this.attribute,l=s.position,u=s.size,c=s.orient,h=s.middleHandlerStyle,d=void 0===h?{}:h,f=s.startHandlerStyle,p=void 0===f?{}:f,v=s.endHandlerStyle,y=void 0===v?{}:v,g=u.width,m=u.height,_=null!==(e=null===(t=d.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;d.visible?this._isHorizontal?(r=g,o=m-_,a={x:l.x,y:l.y+_}):(r=g-_,o=m,a={x:l.x+("left"===c?_:0),y:l.y}):(r=g,o=m,a=l);var b=null!==(i=p.size)&&void 0!==i?i:this._isHorizontal?o:r,x=null!==(n=y.size)&&void 0!==n?n:this._isHorizontal?o:r;return p.visible&&(this._isHorizontal?(r-=(b+x)/2,a={x:a.x+b/2,y:a.y}):(o-=(b+x)/2,a={x:a.x,y:a.y+b})),this._layoutAttrFromConfig={position:a,width:r,height:o},this._layoutAttrFromConfig}},{key:"render",value:function(){var t,e,i,n,r,o,a,s,l,u,c,h,d,f,p,v,y,g;this._layoutAttrFromConfig=null;var m=this.attribute,_=m.orient,b=m.backgroundStyle,x=m.backgroundChartStyle,k=void 0===x?{}:x,S=m.selectedBackgroundStyle,A=void 0===S?{}:S,w=m.selectedBackgroundChartStyle,T=void 0===w?{}:w,M=m.middleHandlerStyle,C=void 0===M?{}:M,E=m.startHandlerStyle,R=void 0===E?{}:E,P=m.endHandlerStyle,B=void 0===P?{}:P,L=m.brushSelect,O=m.zoomLock,I=this.state,D=I.start,F=I.end,z=this.getLayoutAttrFromConfig(),j=z.position,H=z.width,N=z.height,V=null!==(t=R.triggerMinSize)&&void 0!==t?t:40,G=null!==(e=B.triggerMinSize)&&void 0!==e?e:40,W=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=W,this._background=W.createOrUpdateChild("background",Object.assign(Object.assign({x:j.x,y:j.y,width:H,height:N,cursor:L?"crosshair":"auto"},b),{pickable:!O}),"rect"),(null===(i=k.line)||void 0===i?void 0:i.visible)&&this.setPreviewAttributes("line",W),(null===(n=k.area)||void 0===n?void 0:n.visible)&&this.setPreviewAttributes("area",W),L&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=W.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:j.x+D*H,y:j.y,width:(F-D)*H,height:N,cursor:L?"crosshair":"move"},A),{pickable:!O}),"rect"):this._selectedBackground=W.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:j.x,y:j.y+D*N,width:H,height:(F-D)*N,cursor:L?"crosshair":"move"},A),{pickable:!O}),"rect"),(null===(r=T.line)||void 0===r?void 0:r.visible)&&this.setSelectedPreviewAttributes("line",W),(null===(o=T.area)||void 0===o?void 0:o.visible)&&this.setSelectedPreviewAttributes("area",W),this._isHorizontal){if(C.visible){var U=(null===(a=C.background)||void 0===a?void 0:a.size)||10;this._middleHandlerRect=W.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:j.x+D*H,y:j.y-U,width:(F-D)*H,height:U},null===(s=C.background)||void 0===s?void 0:s.style),{pickable:!O}),"rect"),this._middleHandlerSymbol=W.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:j.x+(D+F)/2*H,y:j.y-U/2,strokeBoundsBuffer:0,angle:0,symbolType:null!==(u=null===(l=C.icon)||void 0===l?void 0:l.symbolType)&&void 0!==u?u:"square"},C.icon),{pickable:!O}),"symbol")}this._startHandler=W.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:j.x+D*H,y:j.y+N/2,size:N,symbolType:null!==(c=R.symbolType)&&void 0!==c?c:"square"},SD.horizontal),R),{pickable:!O}),"symbol"),this._endHandler=W.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:j.x+F*H,y:j.y+N/2,size:N,symbolType:null!==(h=B.symbolType)&&void 0!==h?h:"square"},SD.horizontal),B),{pickable:!O}),"symbol");var Y=Math.max(this._startHandler.AABBBounds.width(),V),K=Math.max(this._startHandler.AABBBounds.height(),V),X=Math.max(this._endHandler.AABBBounds.width(),G),Z=Math.max(this._endHandler.AABBBounds.height(),G);this._startHandlerMask=W.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:j.x+D*H-Y/2,y:j.y+N/2-K/2,width:Y,height:K,fill:"white",fillOpacity:0,zIndex:999},SD.horizontal),{pickable:!O}),"rect"),this._endHandlerMask=W.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:j.x+F*H-X/2,y:j.y+N/2-Z/2,width:X,height:Z,fill:"white",fillOpacity:0,zIndex:999},SD.horizontal),{pickable:!O}),"rect")}else{if(C.visible){var q=(null===(d=C.background)||void 0===d?void 0:d.size)||10;this._middleHandlerRect=W.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===_?j.x-q:j.x+H,y:j.y+D*N,width:q,height:(F-D)*N},null===(f=C.background)||void 0===f?void 0:f.style),{pickable:!O}),"rect"),this._middleHandlerSymbol=W.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===_?j.x-q/2:j.x+H+q/2,y:j.y+(D+F)/2*N,angle:Math.PI/180*90,symbolType:null!==(v=null===(p=C.icon)||void 0===p?void 0:p.symbolType)&&void 0!==v?v:"square",strokeBoundsBuffer:0},C.icon),{pickable:!O}),"symbol")}this._startHandler=W.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:j.x+H/2,y:j.y+D*N,size:H,symbolType:null!==(y=R.symbolType)&&void 0!==y?y:"square"},SD.vertical),R),{pickable:!O}),"symbol"),this._endHandler=W.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:j.x+H/2,y:j.y+F*N,size:H,symbolType:null!==(g=B.symbolType)&&void 0!==g?g:"square"},SD.vertical),B),{pickable:!O}),"symbol");var J=Math.max(this._startHandler.AABBBounds.width(),V),Q=Math.max(this._startHandler.AABBBounds.height(),V),$=Math.max(this._endHandler.AABBBounds.width(),G),tt=Math.max(this._endHandler.AABBBounds.height(),G);this._startHandlerMask=W.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:j.x+H/2+J/2,y:j.y+D*N-Q/2,width:tt,height:$,fill:"white",fillOpacity:0,zIndex:999},SD.vertical),{pickable:!O}),"rect"),this._endHandlerMask=W.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:j.x+H/2+$/2,y:j.y+F*N-tt/2,width:tt,height:$,fill:"white",fillOpacity:0,zIndex:999},SD.vertical),{pickable:!O}),"rect")}this._showText&&this.renderText()}},{key:"computeBasePoints",value:function(){var t,e,i=this.attribute.orient,n=this.getLayoutAttrFromConfig(),r=n.position,o=n.width,a=n.height;return this._isHorizontal?(t=[{x:r.x,y:r.y+a}],e=[{x:r.x+o,y:r.y+a}]):"left"===i?(t=[{x:r.x+o,y:r.y}],e=[{x:r.x+o,y:r.y+a}]):(t=[{x:r.x,y:r.y+a}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}},{key:"getPreviewLinePoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e)}}));if(0===e.length)return e;var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"getPreviewAreaPoints",value:function(){var t=this,e=this._previewData.map((function(e){return{x:t._previewPointsX&&t._previewPointsX(e),y:t._previewPointsY&&t._previewPointsY(e),x1:t._previewPointsX1&&t._previewPointsX1(e),y1:t._previewPointsY1&&t._previewPointsY1(e)}}));if(0===e.length)return e;var i=this.computeBasePoints(),n=i.basePointStart,r=i.basePointEnd;return n.concat(e).concat(r)}},{key:"setPreviewAttributes",value:function(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");var i=this.attribute.backgroundChartStyle,n=void 0===i?{}:i;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"setSelectedPreviewAttributes",value:function(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");var i=this.attribute.selectedBackgroundChartStyle,n=void 0===i?{}:i,r=this.state,o=r.start,a=r.end,s=this.getLayoutAttrFromConfig(),l=s.position,u=s.width,c=s.height;this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?l.x+o*u:l.x,y:this._isHorizontal?l.y:l.y+o*c,width:this._isHorizontal?(a-o)*u:u,height:this._isHorizontal?c:(a-o)*c,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?l.x+o*u:l.x),y:-(this._isHorizontal?l.y:l.y+o*c),width:this._isHorizontal?(a-o)*u:u,height:this._isHorizontal?c:(a-o)*c,pickable:!1}),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}},{key:"maybeAddLabel",value:function(t,e,i){var n=this.find((function(t){return t.name===i}),!0);return n?n.setAttributes(e):(n=new yO(e)).name=i,t.add(n),n}},{key:"setStartAndEnd",value:function(t,e){var i=this.attribute,n=i.start,r=i.end;T(t)&&T(e)&&(t!==this.state.start||e!==this.state.end)&&(this.state.start=t,this.state.end=e,n===this.state.start&&r===this.state.end||(this.setStateAttr(t,e,!0),this._dispatchEvent("change",{start:t,end:e,tag:this._activeTag})))}},{key:"setPreviewData",value:function(t){this._previewData=t}},{key:"setText",value:function(t,e){"start"===e?this._startText.setAttribute("text",t):this._endText.setAttribute("text",t)}},{key:"getStartValue",value:function(){return this._startValue}},{key:"getEndTextValue",value:function(){return this._endValue}},{key:"getMiddleHandlerSize",value:function(){var t,e,i,n,r=this.attribute.middleHandlerStyle,o=void 0===r?{}:r,a=null!==(e=null===(t=o.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10,s=null!==(n=null===(i=o.icon)||void 0===i?void 0:i.size)&&void 0!==n?n:10;return Math.max.apply(Math,[a].concat(m(lt(s))))}},{key:"setPreviewPointsX",value:function(t){A(t)&&(this._previewPointsX=t)}},{key:"setPreviewPointsY",value:function(t){A(t)&&(this._previewPointsY=t)}},{key:"setPreviewPointsX1",value:function(t){A(t)&&(this._previewPointsX1=t)}},{key:"setPreviewPointsY1",value:function(t){A(t)&&(this._previewPointsY1=t)}},{key:"setStatePointToData",value:function(t){A(t)&&(this._statePointToData=t)}}]),i}(OT);function PD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}RD.defaultAttributes=kD,function(t){t.start="start",t.middle="middle",t.end="end",t.insideStartTop="insideStartTop",t.insideStartBottom="insideStartBottom",t.insideMiddleTop="insideMiddleTop",t.insideMiddleBottom="insideMiddleBottom",t.insideEndTop="insideEndTop",t.insideEndBottom="insideEndBottom"}(MD||(MD={})),function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom",t.middle="middle",t.insideLeft="insideLeft",t.insideRight="insideRight",t.insideTop="insideTop",t.insideBottom="insideBottom"}(CD||(CD={})),function(t){t.top="top",t.bottom="bottom",t.middle="middle",t.insideTop="insideTop",t.insideBottom="insideBottom",t.insideMiddle="insideMiddle"}(ED||(ED={}));var BD=function(t){ue(i,t);var e=PD(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="marker",t}return zt(i,[{key:"setAttribute",value:function(t,e,n){Xs(de(i.prototype),"setAttribute",this).call(this,t,e,n),"visible"===t&&this.render()}},{key:"_initContainer",value:function(){var t,e,i,n=this.attribute,r=n.limitRect,o=void 0===r?{}:r;if(n.clipInRange){var a=kg.group(Object.assign(Object.assign({},o),{clip:!0,pickable:!1}));i=kg.group({x:-(null!==(t=o.x)&&void 0!==t?t:0),y:-(null!==(e=o.y)&&void 0!==e?e:0),pickable:!1}),a.add(i),this._containerClip=a,this.add(a)}else i=kg.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}},{key:"_updateContainer",value:function(){var t,e,i=this.attribute,n=i.limitRect,r=void 0===n?{}:n,o=i.clipInRange;this._containerClip&&this._containerClip.setAttributes(Object.assign({},r)),this._container.setAttributes({x:o?-(null!==(t=r.x)&&void 0!==t?t:0):0,y:o?-(null!==(e=r.y)&&void 0!==e?e:0):0})}},{key:"render",value:function(){var t;this.setAttribute("pickable",!1);var e=null===(t=this.attribute.visible)||void 0===t||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker()):(this._initContainer(),this.initMarker(this._container)):(this._container=null,this.removeAllChild())}}]),i}(OT),LD={startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:MD.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},OD={start:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},ID={label:{position:CD.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},DD={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"}},FD={top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}};function zD(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,a=t.AABBBounds,s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=0,d=0;return s<i&&(h=i-s),l<n&&(d=n-l),u>r&&(h=r-u),c>o&&(d=o-c),{dx:h,dy:d}}function jD(t,e){var i=zD(t,e),n=i.dx,r=i.dy,o=t.attribute,a=o.dx,s=void 0===a?0:a,l=o.dy,u=void 0===l?0:l;n&&t.setAttribute("dx",n+s),r&&t.setAttribute("dy",r+u)}function HD(){xL(),fO()}function ND(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}HD(),RI();var VD=function(t){ue(i,t);var e=ND(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="markLine",r}return zt(i,[{key:"getLine",value:function(){return this._line}},{key:"getLabel",value:function(){return this._label}},{key:"setLabelPos",value:function(){var t,e,i,n=this.attribute,r=n.label,o=void 0===r?{}:r,a=n.limitRect,s=o.position,l=void 0===s?"end":s,u=o.refX,c=void 0===u?0:u,h=o.refY,d=void 0===h?0:h,f=o.confine,p=this._line.getMainSegmentPoints(),v=null!==(t=this._line.getEndAngle())&&void 0!==t?t:0,y=c*Math.cos(v)+d*Math.cos(v-Math.PI/2),g=c*Math.sin(v)+d*Math.sin(v-Math.PI/2);if(i=l.includes("start")||l.includes("Start")?{x:p[0].x+y,y:p[0].y+g}:l.includes("middle")||l.includes("Middle")?{x:(p[0].x+p[p.length-1].x)/2+y,y:(p[0].y+p[p.length-1].y)/2+g}:{x:p[p.length-1].x+y,y:p[p.length-1].y+g},this._label.setAttributes(Object.assign(Object.assign({},i),{angle:o.autoRotate?v+(null!==(e=o.refAngle)&&void 0!==e?e:0):0,textStyle:Object.assign(Object.assign({},OD[l]),o.textStyle)})),a&&f){var m=a.x,_=a.y,b=a.width,x=a.height;jD(this._label,{x1:m,y1:_,x2:m+b,y2:_+x})}}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.points,n=e.startSymbol,r=e.endSymbol,o=e.label,a=e.lineStyle,s=e.mainSegmentIndex,l=e.multiSegment,u=new OI({points:i,startSymbol:n,endSymbol:r,lineStyle:a,mainSegmentIndex:s,multiSegment:l,pickable:!1});u.name="mark-line-line",this._line=u,t.add(u);var c=new yO(Object.assign({},o));c.name="mark-line-label",this._label=c,t.add(c),this.setLabelPos()}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.points,i=t.startSymbol,n=t.endSymbol,r=t.label,o=t.lineStyle,a=t.mainSegmentIndex,s=t.multiSegment;this._line&&this._line.setAttributes({points:e,startSymbol:i,endSymbol:n,lineStyle:o,mainSegmentIndex:a,multiSegment:s}),this._label&&this._label.setAttributes(Object.assign({dx:0,dy:0},r)),this.setLabelPos()}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<2)return!1;var e=!0;return t.forEach((function(t){if(t.length)t.forEach((function(t){F(t.x)&&F(t.y)||(e=!1)}));else if(!F(t.x)||!F(t.y))return void(e=!1)})),e}}]),i}(BD);function GD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}VD.defaultAttributes=LD,HD(),EL();var WD=function(t){ue(i,t);var e=GD(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="markArea",r}return zt(i,[{key:"getArea",value:function(){return this._area}},{key:"getLabel",value:function(){return this._label}},{key:"_getPositionByDirection",value:function(t,e){var i=this._area.AABBBounds,n=i.x1,r=i.x2,o=i.y1,a=i.y2;return e.includes("left")||e.includes("Left")?{x:n,y:(o+a)/2}:e.includes("right")||e.includes("Right")?{x:r,y:(o+a)/2}:e.includes("top")||e.includes("Top")?{x:(n+r)/2,y:o}:e.includes("bottom")||e.includes("Bottom")?{x:(n+r)/2,y:a}:{x:(n+r)/2,y:(o+a)/2}}},{key:"setLabelPos",value:function(){var t;if(this._label&&this._area){var e=this.attribute.label,i=void 0===e?{}:e,n=null!==(t=i.position)&&void 0!==t?t:"middle",r=this._getPositionByDirection(this._area,n);if(this._label.setAttributes(Object.assign(Object.assign({},r),{textStyle:Object.assign(Object.assign({},DD[n]),i.textStyle)})),this.attribute.limitRect&&i.confine){var o=this.attribute.limitRect,a=o.x,s=o.y,l=o.width,u=o.height;jD(this._label,{x1:a,y1:s,x2:a+l,y2:s+u})}}}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.points,n=e.label,r=e.areaStyle,o=kg.polygon(Object.assign({points:i},r));o.name="mark-area-area",this._area=o,t.add(o);var a=new yO(Object.assign({},n));a.name="mark-area-label",this._label=a,t.add(a),this.setLabelPos()}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.points,i=t.label,n=t.areaStyle;this._area&&this._area.setAttributes(Object.assign({points:e},n)),this._area&&this._label.setAttributes(Object.assign({dx:0,dy:0},i)),this.setLabelPos()}},{key:"isValidPoints",value:function(){var t=this.attribute.points;if(!t||t.length<3)return!1;var e=!0;return t.forEach((function(t){F(t.x)&&F(t.y)||(e=!1)})),e}}]),i}(BD);function UD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}WD.defaultAttributes=ID,HD(),RI(),NL(),SL(),wL();var YD=function(t){ue(i,t);var e=UD(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="markPoint",r}return zt(i,[{key:"setLabelPos",value:function(){}},{key:"setItemAttributes",value:function(t,e,i,n){var r;if(t){var o=e.autoRotate,a=void 0===o||o,s=e.refX,l=void 0===s?0:s,u=e.refY,c=void 0===u?0:u,h=e.refAngle,d=void 0===h?0:h,f=e.textStyle,p=void 0===f?{}:f,v=e.richTextStyle,y=void 0===v?{}:v,g=e.imageStyle,m=void 0===g?{}:g,_=e.position,b=void 0===_?ED.middle:_,x=(null===(r=this._line)||void 0===r?void 0:r.getEndAngle())||0,k=l*Math.cos(x)+c*Math.cos(x-Math.PI/2),S=l*Math.sin(x)+c*Math.sin(x-Math.PI/2);"text"===n?t.setAttributes(Object.assign(Object.assign({},p),{textStyle:Object.assign(Object.assign({},FD[(null==e?void 0:e.position)||"end"]),p.textStyle)})):"richText"===n?t.setAttributes({dx:this.getItemDx(t,b,y)+(y.dx||0),dy:this.getItemDy(t,b,y)+(y.dy||0)}):"image"===n&&t.setAttributes({dx:this.getItemDx(t,b,m)+(m.dx||0),dy:this.getItemDy(t,b,m)+(m.dy||0)}),t.setAttributes({x:i.x+(k||0),y:i.y+(S||0),angle:a&&x+d})}}},{key:"getItemDx",value:function(t,e,i){var n,r,o=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.width())&&void 0!==r?r:(null==i?void 0:i.width)||0;return e.includes("inside")?-o:0}},{key:"getItemDy",value:function(t,e,i){var n,r,o=null!==(r=null===(n=null==t?void 0:t.AABBBounds)||void 0===n?void 0:n.height())&&void 0!==r?r:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-o:e.includes("middle")||e.includes("Middle")?-o/2:0}},{key:"initItem",value:function(t,e){var i,n=t.type,r=void 0===n?"text":n,o=t.symbolStyle,a=t.richTextStyle,s=t.imageStyle,l=t.renderCustomCallback;return"symbol"===r?i=kg.symbol(Object.assign(Object.assign({},e),o)):"text"===r?i=new yO(Object.assign({},e)):"richText"===r?i=kg.richtext(Object.assign(Object.assign({},e),a)):"image"===r?i=kg.image(Object.assign(Object.assign({},e),s)):"custom"===r&&l&&(i=l()),this.setItemAttributes(i,t,e,r),i}},{key:"getItemLineAttr",value:function(t,e,i){var n=t.type,r=void 0===n?"type-s":n;return"type-do"===r?[e,{x:(e.x+i.x)/2,y:i.y},i]:"type-po"===r?[e,{x:i.x,y:e.y},i]:"type-op"===r?[e,{x:e.x,y:i.y},i]:[e,i]}},{key:"setItemLineAttr",value:function(t,e,i,n){if(this._line){var r=t.startSymbol,o=t.endSymbol,a=t.lineStyle,s=this.getItemLineAttr(t,e,i);this._line.setAttributes({points:s,startSymbol:r,endSymbol:o,lineStyle:a,visible:n})}}},{key:"getDecorativeLineAttr",value:function(t,e){var i,n=(null===(i=null==t?void 0:t.decorativeLine)||void 0===i?void 0:i.length)||10,r=this._line.getEndAngle()||0;return{startPointOffsetX:n/2*Math.cos(r-Math.PI/2),startPointOffsetY:n/2*Math.sin(r-Math.PI/2),endPointOffsetX:-n/2*Math.cos(r-Math.PI/2),endPointOffsetY:-n/2*Math.sin(r-Math.PI/2)}}},{key:"setDecorativeLineAttr",value:function(t,e,i){if(this._decorativeLine){var n=t.lineStyle,r=this.getDecorativeLineAttr(t,e),o=r.startPointOffsetX,a=r.startPointOffsetY,s=r.endPointOffsetX,l=r.endPointOffsetY;this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+o,y:e.y+a},{x:e.x+s,y:e.y+l}]},n),{visible:i}))}}},{key:"setAllOfItemsAttr",value:function(t){var e,i=this.attribute,n=i.position,r=i.itemLine,o=void 0===r?{}:r,a=i.itemContent,s=void 0===a?{}:a,l=i.limitRect,u=s.type,c=void 0===u?"text":u,h=s.confine;if(l&&h){var d=l.x,f=l.y,p=l.width,v=l.height,y=zD(this._item,{x1:d,y1:f,x2:d+p,y2:f+v}),g=y.dx,m=y.dy;t.x=t.x+g,t.y=t.y+m}this.setItemAttributes(this._item,s,t,c),this.setItemLineAttr(o,n,t,o.visible),this.setDecorativeLineAttr(o,t,null===(e=o.decorativeLine)||void 0===e?void 0:e.visible)}},{key:"initMarker",value:function(t){var e=this.attribute,i=e.position,n=e.itemContent,r=void 0===n?{}:n,o={x:i.x+(r.offsetX||0),y:i.y+(r.offsetY||0)},a=new OI({points:[],pickable:!1});a.name="mark-point-line",this._line=a,t.add(a);var s=kg.line({points:[]});s.name="mark-point-decorativeLine",this._decorativeLine=s,t.add(s);var l=this.initItem(r,o);this._item=l,this.setAllOfItemsAttr(o),t.add(l)}},{key:"updateMarker",value:function(){var t=this.attribute,e=t.position,i=t.itemContent,n=void 0===i?{}:i,r=n.type,o=void 0===r?"text":r,a={x:e.x+(n.offsetX||0),y:e.y+(n.offsetY||0)};this.setItemAttributes(this._item,n,a,o),this.setAllOfItemsAttr(a)}},{key:"isValidPoints",value:function(){var t=this.attribute.position;return!(!F(t.x)||!F(t.y))}}]),i}(BD);function KD(){xL(),NL(),GL()}function XD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}YD.defaultAttributes={itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10,symbolStyle:{symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},textStyle:{dx:0,dy:0},imageStyle:{width:80,height:80},richTextStyle:{width:100,height:100}}};var ZD={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};KD();var qD=function(t){ue(i,t);var e=XD(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="pager",r._current=1,r._onHover=function(t){var e=t.target;e.hasState("disable")||e.addState("hover")},r._onUnHover=function(t){t.target.removeState("hover")},r._onClick=function(t){var e=t.target;if("preHandler"===e.name){if(1===r._current)return;r._current-=1,1===r._current?e.addState("disable"):e.removeState("disable"),r._dispatchEvent("toPrev",{current:r._current,total:r._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(r._current===r._total)return;r._current+=1,r._current===r._total?e.addState("disable"):e.removeState("disable"),r._dispatchEvent("toNext",{current:r._current,total:r._total,direction:"next",event:t})}r._current>1&&r.preHandler.removeState("disable"),r._current<r._total&&r.nextHandler.removeState("disable"),r.text.setAttribute("text","".concat(r._current,"/").concat(r._total))},r}return zt(i,[{key:"getCurrent",value:function(){return this._current}},{key:"render",value:function(){var t,e;this._reset();var i=this.attribute,n=i.layout,r=void 0===n?"horizontal":n,o=i.handler,a=void 0===o?ZD:o,s=i.total,l=i.defaultCurrent,u=void 0===l?1:l,c=i.textStyle,h=i.padding,d=void 0===h?0:h;this._current=u;var f=mi(d),p="horizontal"===r,v=kg.group({x:0,y:0}),y=a.style||{},g=y.size||15,m=null!==(t=a.space)&&void 0!==t?t:8,_=a.state||{},b=a.preShape,x=a.nextShape;b||(b=p?"triangleLeft":"triangleUp"),x||(x=p?"triangleRight":"triangleDown");var k=kg.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:0,y:0,symbolType:b,size:g}));k.states=_,k.name="preHandler",this.preHandler=k,v.add(k);var S=dO("".concat(s,"/").concat(s),Object.assign({textAlign:"center",textBaseline:"middle"},c),null===(e=this.stage)||void 0===e?void 0:e.getTheme().text.fontFamily),A=S.width,w=S.height,T=I(g)?g:g[0],M=I(g)?g:g[1],C=kg.text(Object.assign({x:p?T/2+m+A/2:0,y:p?0:M/2+m+w/2,text:"".concat(u,"/").concat(s),textAlign:"center",textBaseline:"middle",lineHeight:null==c?void 0:c.fontSize},c));this.text=C,v.add(C);var E=kg.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},y),{x:p?T+2*m+A:0,y:p?0:M+2*m+w,symbolType:x,size:g}));E.name="nextHandler",E.states=_,this.nextHandler=E,v.add(E),1===this._total?(k.addState("disable"),E.addState("disable")):1===this._current?k.addState("disable"):this._current===s&&E.addState("disable");var R=v.AABBBounds,P=R.width(),B=R.height();v.translateTo(0-R.x1+f[3],0-R.y1+f[0]),this.add(v),this.attribute.width=P+f[1]+f[3],this.attribute.height=B+f[0]+f[2],this._bindEvents()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}},{key:"_reset",value:function(){this.removeAllChild(),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}}]),i}(OT);qD.defaultAttributes={handler:ZD,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};var JD,QD,$D;function tF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}!function(t){t.selected="selected",t.unSelected="unSelected",t.selectedHover="selectedHover",t.unSelectedHover="unSelectedHover",t.focus="focus"}(JD||(JD={})),function(t){t.legendItemHover="legendItemHover",t.legendItemUnHover="legendItemUnHover",t.legendItemClick="legendItemClick",t.legendItemAttributeUpdate="legendItemAttributeUpdate"}(QD||(QD={})),function(t){t.innerView="innerView",t.title="legendTitle",t.item="legendItem",t.itemShape="legendItemShape",t.itemLabel="legendItemLabel",t.itemValue="legendItemValue",t.focus="legendItemFocus"}($D||($D={}));var eF=function(t){ue(i,t);var e=tF(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="legend",t._title=null,t}return zt(i,[{key:"render",value:function(){this.removeAllChild();var t=this.attribute,e=t.interactive,i=void 0===e||e,n=t.title,r=t.padding,o=mi(void 0===r?0:r),a=kg.group({x:o[3],y:o[0],pickable:i,childrenPickable:i});a.name=$D.innerView,this.add(a),this._innerView=a,(null==n?void 0:n.visible)&&this._renderTitle(n),this._renderContent(),this._adjustLayout(),i&&this._bindEvents();var s=this._innerView.AABBBounds;this.attribute.width=s.width()+o[1]+o[3],this.attribute.height=s.height()+o[0]+o[2]}},{key:"_renderTitle",value:function(t){var e=t.text,i=void 0===e?"":e,n=t.textStyle,r=t.padding,o=void 0===r?0:r,a=t.background,s=t.minWidth,l=t.maxWidth,u=t.shape,c={x:0,y:0,text:i,textStyle:n,padding:mi(o),minWidth:s,maxWidth:l};u&&u.visible&&(c.shape=Object.assign({visible:!0},u.style),T(u.space)&&(c.space=u.space)),a&&a.visible&&(c.panel=Object.assign({visible:!0},a.style));var h=new yO(c);h.name=$D.title,this._title=h,this._innerView.add(h)}},{key:"_adjustLayout",value:function(){var t;if(this._title){var e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),n=null===(t=this.attribute.title)||void 0===t?void 0:t.align;"center"===n?this._title.setAttribute("x",(e-i)/2):"end"===n&&this._title.setAttribute("x",e-i)}}}]),i}(OT);function iF(){xL(),GL(),LL(),NL()}function nF(){xL(),fO()}function rF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var oF=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},aF=v(v(v(v(v({},JD.focus,{}),JD.selected,{}),JD.selectedHover,{}),JD.unSelected,{}),JD.unSelectedHover,{});nF(),KD();var sF,lF=function(t){ue(i,t);var e=rF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="discreteLegend",r._itemsContainer=null,r._itemHeightByUser=void 0,r._itemHeight=0,r._itemMaxWidth=0,r._onHover=function(t){var e=t.target;if(e&&e.name&&e.name.startsWith($D.item)){var i=e.delegate;if(r._lastActiveItem){if(r._lastActiveItem.id===i.id)return;r._unHover(r._lastActiveItem,t)}r._hover(i,t)}else r._lastActiveItem&&(r._unHover(r._lastActiveItem,t),r._lastActiveItem=null)},r._onUnHover=function(t){r._lastActiveItem&&(r._unHover(r._lastActiveItem,t),r._lastActiveItem=null)},r._onClick=function(t){var e,i,n,o,a=t.target;if(a&&a.name&&a.name.startsWith($D.item)){var s=a.delegate;if(a.name===$D.focus){var l=s.hasState(JD.focus);s.toggleState(JD.focus),l?null===(e=r._itemsContainer)||void 0===e||e.getChildren().forEach((function(e){r._removeLegendItemState(e,[JD.unSelected,JD.unSelectedHover,JD.focus],t),r._setLegendItemState(e,JD.selected,t)})):(r._setLegendItemState(s,JD.selected,t),r._removeLegendItemState(s,[JD.unSelected,JD.unSelectedHover],t),null===(i=r._itemsContainer)||void 0===i||i.getChildren().forEach((function(e){s!==e&&(r._removeLegendItemState(e,[JD.selected,JD.selectedHover,JD.focus],t),r._setLegendItemState(e,JD.unSelected,t))})))}else{null===(n=r._itemsContainer)||void 0===n||n.getChildren().forEach((function(t){t.removeState(JD.focus)}));var u=r.attribute,c=u.selectMode,h=void 0===c?"multiple":c,d=u.allowAllCanceled,f=void 0===d||d,p=s.hasState(JD.selected),v=r._getSelectedLegends();if("multiple"===h){if(!1===f&&p&&1===v.length)return void r._dispatchLegendEvent(QD.legendItemClick,s,t);p?(r._removeLegendItemState(s,[JD.selected,JD.selectedHover],t),r._setLegendItemState(s,JD.unSelected,t)):(r._setLegendItemState(s,JD.selected,t),r._removeLegendItemState(s,[JD.unSelected,JD.unSelectedHover],t))}else r._setLegendItemState(s,JD.selected,t),r._removeLegendItemState(s,[JD.unSelected,JD.unSelectedHover],t),null===(o=r._itemsContainer)||void 0===o||o.getChildren().forEach((function(e){s!==e&&(r._removeLegendItemState(e,[JD.selected,JD.selectedHover],t),r._setLegendItemState(e,JD.unSelected,t))}))}r._dispatchLegendEvent(QD.legendItemClick,s,t)}},r}return zt(i,[{key:"setSelected",value:function(t){var e,i=this;(null===(e=this._itemsContainer)||void 0===e?void 0:e.getChildren()).forEach((function(e){var n=e.data;t.includes(n.label)?(i._setLegendItemState(e,JD.selected),i._removeLegendItemState(e,[JD.unSelected,JD.unSelectedHover])):(i._removeLegendItemState(e,[JD.selected,JD.selectedHover]),i._setLegendItemState(e,JD.unSelected))}))}},{key:"_renderContent",value:function(){var t=this,e=this.attribute,i=e.item,n=void 0===i?{}:i,r=e.items,o=e.reversed,a=e.maxCol,s=void 0===a?1:a,l=e.maxRow,u=void 0===l?2:l;if(!1!==n.visible&&!W(r)){var c=r;o&&(c=null==r?void 0:r.reverse());var h=kg.group({x:0,y:0});this._itemsContainer=h;var d=this.attribute,f=d.layout,p=d.maxWidth,v=d.maxHeight,y=d.defaultSelected,g=void 0===y?[]:y,m=d.autoPage,_="horizontal"===f,b=n.spaceCol,x=void 0===b?16:b,k=n.spaceRow,S=void 0===k?8:k,A=n.maxWidth,w=n.width,M=n.height;T(A)?T(w)?this._itemWidthByUser=Math.min(A,w):this._itemWidthByUser=A:T(w)&&(this._itemWidthByUser=w),T(M)&&(this._itemHeightByUser=M);var C=!1,E=0,R=0,P=0,B=1,L=1;c.forEach((function(e,i){e.id||(e.id=e.label),e.index=i;var n=t._renderEachItem(e,!!W(g)||(null==g?void 0:g.includes(e.label)),i,c),r=n.attribute.width,o=n.attribute.height;t._itemHeight=Math.max(t._itemHeight,o),E=Math.max(r,E),t._itemMaxWidth=Math.max(r,t._itemMaxWidth),_?(B=u,T(p)&&(r>=p?(C=!0,i>0&&(R=0,P+=o+S,L+=1)):p<R+r&&(C=!0,R=0,P+=o+S,L+=1)),i>0&&n.setAttributes({x:R,y:P}),R+=x+r):(B=s,T(v)&&v<P+o&&(C=!0,P=0,R+=E+x,E=0,L+=1),i>0&&n.setAttributes({x:R,y:P}),P+=S+o),h.add(n)}));var O=!1;C&&m&&L>B&&(O=this._renderPager(_)),O||(h.setAttribute("y",this._title?this._title.AABBBounds.height()+U(this.attribute,"title.space",8):0),this._innerView.add(h))}}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent&&this._itemsContainer){var t=this.attribute,e=t.hover,i=void 0===e||e,n=t.select,r=void 0===n||n;i&&(this._itemsContainer.addEventListener("pointermove",this._onHover),this._itemsContainer.addEventListener("pointerleave",this._onUnHover)),r&&this._itemsContainer.addEventListener("pointerdown",this._onClick)}}},{key:"_renderEachItem",value:function(t,e,i,n){var r,o,a,s=t.id,l=t.label,u=t.value,c=t.shape,h=this.attribute.item,d=h.padding,f=void 0===d?0:d,p=h.focus,v=h.focusIconStyle,y=this.attribute.item,g=y.shape,m=y.label,_=y.value,b=y.background,x=this._handleStyle(g,t,e,i,n),k=this._handleStyle(m,t,e,i,n),S=this._handleStyle(_,t,e,i,n),A=this._handleStyle(b,t,e,i,n),M=mi(f);!1===b.visible?(a=kg.group({x:0,y:0,cursor:null===(r=A.style)||void 0===r?void 0:r.cursor}),this._appendDataToShape(a,$D.item,t,a)):(a=kg.group(Object.assign({x:0,y:0},A.style)),this._appendDataToShape(a,$D.item,t,a,A.state)),a.id="".concat(null!=s?s:l,"-").concat(i),a.addState(e?JD.selected:JD.unSelected);var C=kg.group({x:0,y:0,pickable:!1});a.add(C);var E,R=0,P=0,L=0;if(g&&!1!==g.visible){var O=U(x,"style.size",10);P=B(O)?O[0]||0:O,L=U(g,"space",8);var I=kg.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},c),x.style));Object.keys(x.state||{}).forEach((function(t){var e=x.state[t].fill||x.state[t].stroke;c.fill&&w(x.state[t].fill)&&e&&(x.state[t].fill=e),c.stroke&&w(x.state[t].stroke)&&e&&(x.state[t].stroke=e)})),this._appendDataToShape(I,$D.itemShape,t,a,x.state),I.addState(e?JD.selected:JD.unSelected),C.add(I)}var D=0;if(p){var F=U(v,"size",10);E=kg.symbol(Object.assign(Object.assign({x:0,y:-F/2-1,strokeBoundsBuffer:0},v),{visible:!0,pickMode:"imprecise",boundsPadding:M})),this._appendDataToShape(E,$D.focus,t,a),D=F}var z=kg.text(Object.assign(Object.assign({x:P/2+L,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null===(o=k.style)||void 0===o?void 0:o.fontSize},k.style),{text:m.formatMethod?m.formatMethod(l,t,i):l}));this._appendDataToShape(z,$D.itemLabel,t,a,k.state),z.addState(e?JD.selected:JD.unSelected),C.add(z);var j=U(m,"space",8);if(T(u)){var H=U(_,"space",p?8:0),N=kg.text(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:S.style.fontSize},S.style),{text:_.formatMethod?_.formatMethod(u,t,i):u}));if(this._appendDataToShape(N,$D.itemValue,t,a,S.state),N.addState(e?JD.selected:JD.unSelected),this._itemWidthByUser){var V=this._itemWidthByUser-M[1]-M[3]-P-L-j-D-H,G=N.AABBBounds,W=z.AABBBounds,Y=G.width(),K=W.width();K>V?(V-Y)/K>.4?z.setAttribute("maxLineWidth",V-Y):(N.setAttribute("maxLineWidth",.5*V),z.setAttribute("maxLineWidth",.5*V)):N.setAttribute("maxLineWidth",V-K),_.alignRight?N.setAttributes({textAlign:"right",x:this._itemWidthByUser-P/2-M[1]-M[3]-D-H}):N.setAttribute("x",z.AABBBounds.x2+H)}else N.setAttribute("x",z.AABBBounds.x2+H);R=N.AABBBounds.x2+H,C.add(N)}else this._itemWidthByUser?(z.setAttribute("maxLineWidth",this._itemWidthByUser-M[1]-M[3]-P-L-D),R=z.AABBBounds.x2+j):R=z.AABBBounds.x2+j;E&&(E.setAttribute("x",R),C.add(E));var X=C.AABBBounds,Z=X.width(),q=X.height(),J=T(this.attribute.item.width)?this.attribute.item.width:Z+M[1]+M[3],Q=this._itemHeightByUser||q+M[0]+M[2];return a.attribute.width=J,a.attribute.height=Q,E&&E.setAttribute("visible",!1),C.translateTo(-X.x1+M[3],-X.y1+M[0]),a}},{key:"_renderPager",value:function(t){var e,i=this,n=this._title?this._title.AABBBounds.height()+U(this.attribute,"title.space",8):0,r=this.attribute,o=r.maxWidth,a=r.maxHeight,s=r.maxCol,l=void 0===s?1:s,u=r.maxRow,c=void 0===u?2:u,h=r.item,d=void 0===h?{}:h,f=r.pager,p=void 0===f?{}:f,v=r.disableTriggerEvent,y=d.spaceCol,g=void 0===y?16:y,m=d.spaceRow,_=void 0===m?8:m,b=this._itemsContainer,x=p.animation,k=void 0===x||x,S=p.animationDuration,A=void 0===S?450:S,w=p.animationEasing,T=void 0===w?"quadIn":w,M=p.space,C=void 0===M?12:M,E=p.position,R=void 0===E?"middle":E,P=oF(p,["animation","animationDuration","animationEasing","space","position"]),B=0,L=0,O=0,I=0,D=1;if(t){if(e=new qD(Object.assign(Object.assign({layout:1===c?"horizontal":"vertical",total:99},Q({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},P)),{disableTriggerEvent:v})),this._pager=e,this._innerView.add(e),B=(c-1)*_+this._itemHeight*c,(L=o-e.AABBBounds.width()-C)<=0)return this._innerView.removeChild(e),!1;var F;b.getChildren().forEach((function(t,e){var i=t.attribute,n=i.width,r=i.height;L<O+n&&(O=0,I+=r+_,D+=1),e>0&&t.setAttributes({x:O,y:I}),O+=g+n})),e.setAttribute("total",Math.ceil(D/c)),F="start"===R?n:"end"===R?n+B-e.AABBBounds.height()/2:n+B/2-e.AABBBounds.height()/2,e.setAttributes({x:L,y:F})}else{if(e=new qD(Object.assign({layout:"horizontal",total:99,disableTriggerEvent:v},P)),this._pager=e,this._innerView.add(e),L=this._itemMaxWidth*l+(l-1)*g,(B=a-e.AABBBounds.height()-C-n)<=0)return this._innerView.removeChild(e),!1;var z;b.getChildren().forEach((function(t,e){var n=t.attribute.height;B<I+n&&(I=0,O+=i._itemMaxWidth+g,D+=1),e>0&&t.setAttributes({x:O,y:I}),I+=_+n})),e.setAttribute("total",Math.ceil(D/l)),z="start"===R?0:"end"===R?L-e.AABBBounds.width():(L-e.AABBBounds.width())/2,e.setAttributes({x:z,y:a-e.AABBBounds.height()})}p.defaultCurrent>1&&(t?b.setAttribute("y",-(p.defaultCurrent-1)*(B+_)):b.setAttribute("x",-(p.defaultCurrent-1)*(L+g)));var j=kg.group({x:0,y:n,width:L,height:B,clip:!0,pickable:!1});j.add(b),this._innerView.add(j);var H=function(e){var i=e.detail.current;k?b.animate().to(t?{y:-(i-1)*(B+_)}:{x:-(i-1)*(L+g)},A,T):t?b.setAttribute("y",-(i-1)*(B+_)):b.setAttribute("x",-(i-1)*(L+g))};return this._pager.addEventListener("toPrev",H),this._pager.addEventListener("toNext",H),!0}},{key:"_hover",value:function(t,e){this._lastActiveItem=t,t.hasState(JD.selected)?this._setLegendItemState(t,JD.selectedHover,e):this._setLegendItemState(t,JD.unSelectedHover,e);var i=t.getChildren()[0].find((function(t){return t.name===$D.focus}),!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(QD.legendItemHover,t,e)}},{key:"_unHover",value:function(t,e){var i=!1;(t.hasState(JD.unSelectedHover)||t.hasState(JD.selectedHover))&&(i=!0),t.removeState(JD.unSelectedHover),t.removeState(JD.selectedHover),t.getChildren()[0].getChildren().forEach((function(t){i||!t.hasState(JD.unSelectedHover)&&!t.hasState(JD.selectedHover)||(i=!0),t.removeState(JD.unSelectedHover),t.removeState(JD.selectedHover)}));var n=t.getChildren()[0].find((function(t){return t.name===$D.focus}),!1);n&&n.setAttribute("visible",!1),i&&this._dispatchLegendEvent(QD.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(QD.legendItemUnHover,t,e)}},{key:"_setLegendItemState",value:function(t,e,i){var n=!1;t.hasState(e)||(n=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach((function(t){t.name!==$D.focus&&(n||t.hasState(e)||(n=!0),t.addState(e,!0))})),n&&this._dispatchLegendEvent(QD.legendItemAttributeUpdate,t,i)}},{key:"_removeLegendItemState",value:function(t,e,i){var n=!1;e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)})),t.getChildren()[0].getChildren().forEach((function(t){t.name!==$D.focus&&e.forEach((function(e){!n&&t.hasState(e)&&(n=!0),t.removeState(e)}))})),n&&this._dispatchLegendEvent(QD.legendItemAttributeUpdate,t,i)}},{key:"_getSelectedLegends",value:function(){var t,e=[];return null===(t=this._itemsContainer)||void 0===t||t.getChildren().forEach((function(t){t.hasState(JD.selected)&&e.push(t.data)})),e}},{key:"_appendDataToShape",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.name=e,t.data=i,t.delegate=n,t.states=Q({},aF,r)}},{key:"_dispatchLegendEvent",value:function(t,e,i){var n=this._getSelectedLegends();n.sort((function(t,e){return t.index-e.index}));var r=n.map((function(t){return t.label}));this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(JD.selected),currentSelectedItems:n,currentSelected:r,event:i})}},{key:"_handleStyle",value:function(t,e,i,n,r){var o={};return t.style&&(A(t.style)?o.style=t.style(e,i,n,r):o.style=t.style),t.state&&(o.state={},Object.keys(t.state).forEach((function(a){t.state[a]&&(A(t.state[a])?o.state[a]=t.state[a](e,i,n,r):o.state[a]=t.state[a])}))),o}}]),i}(eF);function uF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}function cF(t){return B(t)?t:[t,t]}function hF(t){return t?"ew-resize":"ns-resize"}lF.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0},function(t){t.innerView="innerView",t.railContainer="sliderRailContainer",t.rail="sliderRail",t.startText="sliderStartText",t.endText="sliderEndText",t.startHandler="sliderStartHandler",t.startHandlerText="startHandlerText",t.endHandler="sliderEndHandler",t.endHandlerText="sliderEndHandlerText",t.track="sliderTrack",t.trackContainer="sliderTrackContainer"}(sF||(sF={})),iF();var dF=function(t){ue(i,t);var e=uF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="slider",r._isHorizontal=!0,r._startHandler=null,r._endHandler=null,r._startHandlerText=null,r._endHandlerText=null,r._currentHandler=null,r._currentValue={},r._onHandlerPointerdown=function(t){t.stopPropagation(),r._currentHandler=t.target,r._prePos=r._isHorizontal?t.clientX:t.clientY,"browser"===ux.env?(ux.addEventListener("pointermove",r._onHandlerPointerMove,{capture:!0}),ux.addEventListener("pointerup",r._onHandlerPointerUp)):(r.stage.addEventListener("pointermove",r._onHandlerPointerMove,{capture:!0}),r.stage.addEventListener("pointerup",r._onHandlerPointerUp),r.stage.addEventListener("pointerupoutside",r._onHandlerPointerUp))},r._onHandlerPointerMove=function(t){var e,i;t.stopPropagation();var n=r.attribute,o=n.railWidth,a=n.railHeight,s=n.min,l=n.max;if(l!==s){var u,c,h,d=0;r._isHorizontal?(d=(u=t.clientX)-r._prePos,c=null===(i=r._currentHandler)||void 0===i?void 0:i.attribute.x,h=o):(d=(u=t.clientY)-r._prePos,c=null===(e=r._currentHandler)||void 0===e?void 0:e.attribute.y,h=a);var f=Tt(c+d,0,h),p=f/h*(l-s)+s;"text"===r._currentHandler.type?r._updateHandlerText(r._currentHandler,f,p):r._updateHandler(r._currentHandler,f,p),r._updateTrack(),r._prePos=u,r._dispatchChangeEvent()}},r._onHandlerPointerUp=function(t){t.preventDefault(),r._currentHandler=null,"browser"===ux.env?(ux.removeEventListener("pointermove",r._onHandlerPointerMove,{capture:!0}),ux.removeEventListener("pointerup",r._onHandlerPointerUp)):(r.stage.removeEventListener("pointermove",r._onHandlerPointerMove,{capture:!0}),r.stage.removeEventListener("pointerup",r._onHandlerPointerUp),r.stage.removeEventListener("pointerupoutside",r._onHandlerPointerUp))},r._onTrackPointerdown=function(t){t.stopPropagation(),r._prePos=r._isHorizontal?t.clientX:t.clientY,"browser"===ux.env?(ux.addEventListener("pointermove",r._onTrackPointerMove,{capture:!0}),ux.addEventListener("pointerup",r._onTrackPointerUp)):(r.stage.addEventListener("pointermove",r._onTrackPointerMove,{capture:!0}),r.stage.addEventListener("pointerup",r._onTrackPointerUp),r.stage.addEventListener("pointerupoutside",r._onTrackPointerUp))},r._onTrackPointerMove=function(t){t.stopPropagation();var e=r.attribute,i=e.railWidth,n=e.railHeight,o=e.min,a=e.max;if(a!==o){var s,l,u,c=r._getHandlers(),h=c.startHandler,d=c.endHandler;r._isHorizontal?(s=t.clientX,l=r._track.attribute.width,u=i):(s=t.clientY,l=r._track.attribute.height,u=n);var f=s-r._prePos;if(h){var p=r._isHorizontal?h.attribute.x:h.attribute.y,v=Tt(p+f,0,u-l),y=v/u*(a-o)+o;r._updateHandler(h,v,y)}if(d){var g=r._isHorizontal?d.attribute.x:d.attribute.y,m=Tt(g+f,l,u),_=m/u*(a-o)+o,b=null==h?void 0:h.attribute;r._updateHandler(d,m,_),r._track.setAttributes(r._isHorizontal?{x:Math.min(b.x,d.attribute.x),width:Math.abs(b.x-d.attribute.x)}:{y:Math.min(b.y,d.attribute.y),height:Math.abs(b.y-d.attribute.y)})}r._prePos=s,r._dispatchChangeEvent()}},r._onTrackPointerUp=function(t){t.preventDefault(),"browser"===ux.env?(ux.removeEventListener("pointermove",r._onTrackPointerMove,{capture:!0}),ux.removeEventListener("pointerup",r._onTrackPointerUp)):(r.stage.removeEventListener("pointermove",r._onTrackPointerMove,{capture:!0}),r.stage.removeEventListener("pointerup",r._onTrackPointerUp),r.stage.removeEventListener("pointerupoutside",r._onTrackPointerUp))},r._onRailPointerDown=function(t){t.stopPropagation();var e=r.attribute,i=e.railWidth,n=e.railHeight,o=e.min,a=e.max;if(a!==o){var s,l,u,c,h=r._startHandler,d=r._endHandler;r._isHorizontal?(s=t.viewX-r._rail.globalAABBBounds.x1,l=null==h?void 0:h.attribute.x,u=null==d?void 0:d.attribute.x,c=i):(s=t.viewY-r._rail.globalAABBBounds.y1,l=null==h?void 0:h.attribute.y,u=null==d?void 0:d.attribute.y,c=n);var f=s/c*(a-o)+o;if(T(u)){var p=Math.abs(s-l)>Math.abs(s-u)?d:h;r._updateHandler(p,s,f)}else r._updateHandler(h,s,f);r._updateTrack(),r._dispatchChangeEvent()}},r}return zt(i,[{key:"track",get:function(){return this._track}},{key:"currentValue",get:function(){return this._currentValue}},{key:"startHandler",get:function(){return this._startHandler}},{key:"endHandler",get:function(){return this._endHandler}},{key:"setValue",value:function(t){var e=this.attribute,i=e.layout,n=e.railWidth,r=e.railHeight,o=e.min,a=e.max;if(a!==o){var s=Mt(lt(t),2),l=s[0],u=s[1],c=this._getHandlers(),h=c.startHandler,d=c.endHandler,f="vertical"===i?r:n,p=(l-o)/(a-o)*f;if(h&&this._updateHandler(h,p,l),d){var v=(u-o)/(a-o)*f;this._updateHandler(d,v,u)}this._updateTrack()}}},{key:"render",value:function(){var t,e;this.removeAllChild();var i=this.attribute,n=i.layout,r=void 0===n?"horizontal":n,o=i.railWidth,a=i.railHeight,s=i.startText,l=i.endText,u=i.min,c=i.max,h=i.showHandler,d=void 0===h||h,f=this.attribute.value;w(f)&&(f=[u,c]),this._currentValue={startValue:cF(f)[0],endValue:cF(f)[1]};var p="horizontal"===r;this._isHorizontal=p;var v=kg.group({x:0,y:0});v.name=sF.innerView,this.add(v),this._innerView=v;var y,g=0;if(s&&s.visible){(y=kg.text(Object.assign({x:p?0:o/2,y:p?a/2:0,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:s.text,lineHeight:null===(t=s.style)||void 0===t?void 0:t.fontSize},s.style))).name=sF.startText,v.add(y);var m=T(s.space)?s.space:0;g+=(p?y.AABBBounds.width():y.AABBBounds.height())+m}var _=kg.group({x:p?g:0,y:p?0:g});v.add(_);var b,x=kg.group({x:0,y:0});if(x.name=sF.railContainer,this._railContainer=x,_.add(x),this._renderRail(x),g+=p?o:a,l&&l.visible){var k=T(l.space)?l.space:0;(b=kg.text(Object.assign({x:p?g+k:o/2,y:p?a/2:g+k,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:l.text,lineHeight:null===(e=l.style)||void 0===e?void 0:e.fontSize},l.style))).name=sF.endText,v.add(b)}this._renderTrack(x),d&&(this._renderHandlers(_),this._bindEvents())}},{key:"_renderRail",value:function(t){var e=this.attribute,i=e.railWidth,n=e.railHeight,r=e.railStyle,o="default";!1!==e.slidable&&(o="pointer");var a=kg.rect(Object.assign({x:0,y:0,width:i,height:n,cursor:o},r));return a.name=sF.rail,t.add(a),this._rail=a,a}},{key:"_renderHandlers",value:function(t){var e=this.attribute,i=e.range,n=e.min,r=e.max,o=e.handlerSize,a=void 0===o?14:o,s=e.handlerStyle,l=e.handlerText,u=e.railHeight,c=e.railWidth,h=e.slidable,d=this.attribute.value;w(d)&&(d=[n,r]);var f=l&&l.visible,p=this._isHorizontal,v=p?c:u,y=Mt(cF(d),2),g=y[0],m=y[1],_=r===n?i?0:v:(g-n)/(r-n)*v,b=this._renderHandler(Object.assign({x:p?_:c/2,y:p?u/2:_,size:a,strokeBoundsBuffer:0,cursor:!1===h?"default":hF(p)},s));if(b.name=sF.startHandler,this._startHandler=b,t.add(b),this._currentValue.startPos=_,f){var x=this._renderHandlerText(g,i?"start":"end");x.name=sF.startHandlerText,t.add(x),this._startHandlerText=x}if(i){var k=r===n?v:(m-n)/(r-n)*v,S=this._renderHandler(Object.assign({x:p?k:c/2,y:p?u/2:k,size:a,strokeBoundsBuffer:0,cursor:!1===h?"default":hF(p)},s));if(S.name=sF.endHandler,this._endHandler=S,t.add(S),this._currentValue.endPos=k,f){var A=this._renderHandlerText(m,"end");A.name=sF.endHandlerText,t.add(A),this._endHandlerText=A}}}},{key:"_renderTrack",value:function(t){var e,i,n=this.attribute,r=n.range,o=n.min,a=n.max,s=n.railHeight,l=n.railWidth,u=n.trackStyle,c=n.railStyle,h=n.slidable,d=n.value;if(w(d))r?(e=o,i=a):e=i=o;else if(r){var f=Ct(d,o,a);e=f[0],i=f[1]}else e=o,i=Tt(d,o,a);var p=this._isHorizontal,v=p?l:s;r||(e=o);var y=kg.group({x:0,y:0,width:l,height:s,cornerRadius:null==c?void 0:c.cornerRadius,clip:!0,pickable:!1});y.name=sF.trackContainer;var g,m=M(r)&&!0===r.draggableTrack;g=!1===h?"default":!1===r||!1===m?"pointer":hF(p);var _=a===o?v:(i-e)/(a-o)*v,b=a===o?0:(e-o)/(a-o)*v,x=kg.rect(Object.assign({x:p?b:0,y:p?0:b,width:p?_:l,height:p?s:_,cursor:g},u));x.name=sF.track,this._track=x,y.add(x),t.add(y)}},{key:"_renderHandler",value:function(t){return kg.symbol(t)}},{key:"_renderHandlerText",value:function(t,e){var i,n,r,o=this.attribute,a=o.align,s=o.min,l=o.max,u=o.handlerSize,c=void 0===u?14:u,h=o.handlerText,d=void 0===h?{}:h,f=o.railHeight,p=o.railWidth,v=o.slidable,y=this._isHorizontal,g=y?p:f,m=l===s?"start"===e?0:g:(t-s)/(l-s)*g,_=null!==(i=d.space)&&void 0!==i?i:4,b={text:d.formatter?d.formatter(t):t.toFixed(null!==(n=d.precision)&&void 0!==n?n:0),lineHeight:null===(r=d.style)||void 0===r?void 0:r.lineHeight,cursor:!1===v?"default":hF(y)};return y?"top"===a?(b.textBaseline="bottom",b.textAlign="center",b.x=m,b.y=(f-c)/2-_):(b.textBaseline="top",b.textAlign="center",b.x=m,b.y=(f+c)/2+_):"left"===a?(b.textBaseline="middle",b.textAlign="end",b.x=(p-c)/2-_,b.y=m):(b.textBaseline="middle",b.textAlign="start",b.x=(p+c)/2+_,b.y=m),kg.text(Object.assign(Object.assign({},b),d.style))}},{key:"_bindEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.slidable,i=t.range;e&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),M(i)&&i.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown))}}},{key:"_updateTrack",value:function(){var t=this._startHandler,e=this._endHandler;if(this._isHorizontal){var i=null==t?void 0:t.attribute.x;if(e){var n=null==e?void 0:e.attribute.x;this._track.setAttributes({x:Math.min(i,n),width:Math.abs(i-n)})}else this._track.setAttributes({width:i})}else{var r=null==t?void 0:t.attribute.y;if(e){var o=null==e?void 0:e.attribute.y;this._track.setAttributes({y:Math.min(r,o),height:Math.abs(r-o)})}else this._track.setAttributes({height:r})}}},{key:"_updateHandler",value:function(t,e,i){var n,r=this._isHorizontal;t.setAttribute(r?"x":"y",e);var o=t.name===sF.startHandler?this._startHandlerText:this._endHandlerText;if(o){var a=this.attribute.handlerText,s=void 0===a?{}:a;o.setAttributes(v({text:s.formatter?s.formatter(i):i.toFixed(null!==(n=s.precision)&&void 0!==n?n:0)},r?"x":"y",e))}t.name===sF.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_updateHandlerText",value:function(t,e,i){var n,r=this._isHorizontal,o=this.attribute.handlerText,a=void 0===o?{}:o;t.setAttributes(v(v({},r?"x":"y",e),"text",a.formatter?a.formatter(i):i.toFixed(null!==(n=a.precision)&&void 0!==n?n:0)));var s=t.name===sF.startHandlerText?this._startHandler:this._endHandler;s&&s.setAttributes(v({},r?"x":"y",e)),t.name===sF.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}},{key:"_dispatchChangeEvent",value:function(){var t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}},{key:"_getHandlers",value:function(){var t,e=this._startHandler,i=this._endHandler;return this._isHorizontal?i&&i.attribute.x<(null==e?void 0:e.attribute.x)&&(t=e,e=i,i=t):i&&i.attribute.y<(null==e?void 0:e.attribute.y)&&(t=e,e=i,i=t),{startHandler:e,endHandler:i}}}]),i}(OT);function fF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}dF.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},nF(),iF();var pF=function(t){ue(i,t);var e=fF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="colorLegend",r._onSliderChange=function(t){r._updateColor(),r.dispatchEvent(t)},r}return zt(i,[{key:"setSelected",value:function(t){this._slider&&(this._slider.setValue(t),this._updateColor())}},{key:"_renderContent",value:function(){for(var t=this.attribute,e=t.colors,i=t.slidable,n=t.layout,r=t.align,o=t.min,a=t.max,s=t.value,l=t.railWidth,u=t.railHeight,c=t.showHandler,h=void 0===c||c,d=t.handlerSize,f=t.handlerStyle,p=t.railStyle,v=t.trackStyle,y=t.startText,g=t.endText,m=t.handlerText,_=t.showTooltip,b=t.tooltip,x=t.disableTriggerEvent,k=[],S=(a-o)/(e.length-1),A=0;A<e.length;A++)k.push(o+S*A);this._colorScale=(new pA).domain(k,!0).range(e),this._color=this._getTrackColor();var w=new dF({x:0,y:0,range:{draggableTrack:!0},slidable:i,layout:n,align:r,min:o,max:a,value:s,railWidth:l,railHeight:u,showHandler:h,handlerSize:d,handlerStyle:f,railStyle:p,trackStyle:Object.assign({fill:this._color},v),startText:y,endText:g,handlerText:m,showTooltip:_,tooltip:b,disableTriggerEvent:x});this._innerView.add(w),this._slider=w,w.translateTo(0-w.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+U(this.attribute,"title.space",12):0)-w.AABBBounds.y1),this._updateColor()}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&this._slider.addEventListener("change",this._onSliderChange)}},{key:"_getTrackColor",value:function(){var t=this.attribute,e=t.colors,i=t.layout;if(!W(e)){var n=e.length;if(1===n)return e[0];for(var r=[],o=0;o<n;o++){var a=o/(n-1);r.push({offset:a,color:e[o]})}var s="horizontal"===i;return{gradient:"linear",stops:r,x0:0,y0:0,x1:s?1:0,y1:s?0:1}}}},{key:"_updateColor",value:function(){var t=this.attribute,e=t.layout,i=void 0===e?"horizontal":e,n=t.colors,r=t.railWidth,o=t.railHeight,a=this._slider,s=a.startHandler,l=a.endHandler,u=a.track,c=this._slider.currentValue,h=c.startValue,d=c.endValue,f=c.startPos,p=c.endPos,v=this._colorScale.scale(h),y=this._colorScale.scale(d);null==s||s.setAttribute("fill",v),null==l||l.setAttribute("fill",y);var g="horizontal"===i?r:o;if(Math.abs(f-p)!==g&&n&&n.length>1){var m=this._color.stops,_=Math.min(f,p),b=Math.max(f,p),x=_/g,k=b/g,S=k-x,A=m.filter((function(t){return t.offset>x&&t.offset<k})),w=Math.min(h,d),T=Math.max(h,d),M=this._colorScale.scale(w),C=this._colorScale.scale(T),E=[{offset:0,color:M}];A.forEach((function(t){E.push({offset:(t.offset-x)/S,color:t.color})})),E.push({offset:1,color:C}),u.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:E}))}}}]),i}(eF);function vF(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom",e=0;return"top"===t?"\n    M".concat(e,",-6L").concat(e-3.5,",-2.5\n    v5\n    h7\n    v-5\n    Z\n"):"left"===t?"\n    M".concat((e=1)-6,",0L").concat(e-6+2.5,",-3.5\n    h5\n    v7\n    h-5\n    Z\n"):"right"===t?"\n    M".concat((e=-1)+6,",0L").concat(e+6-2.5,",-3.5\n    h-5\n    v7\n    h5\n    Z\n  "):"\n    M".concat(e,",6L").concat(e-3.5,",2.5\n    v-5\n    h7\n    v5\n    Z\n")}function yF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}pF.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}}},nF(),iF(),ML();var gF=function(t){ue(i,t);var e=yF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="sizeLegend",r._onSliderChange=function(t){r.dispatchEvent(t)},r}return zt(i,[{key:"setSelected",value:function(t){this._slider&&this._slider.setValue(t)}},{key:"_renderContent",value:function(){var t=this.attribute,e=t.slidable,i=t.layout,n=t.align,r=t.min,o=t.max,a=t.value,s=t.railWidth,l=t.railHeight,u=t.showHandler,c=void 0===u||u,h=t.handlerSize,d=t.handlerStyle,f=t.railStyle,p=t.trackStyle,v=t.startText,y=t.endText,g=t.handlerText,m=t.showTooltip,_=t.tooltip,b=t.sizeBackground,x=t.disableTriggerEvent,k=kg.group({x:0,y:0});this._innerView.add(k);var S=new dF({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:e,layout:i,align:n,min:r,max:o,value:a,railWidth:s,railHeight:l,showHandler:c,handlerSize:h,handlerStyle:Object.assign({symbolType:vF(n)},d),railStyle:f,trackStyle:p,startText:v,endText:y,handlerText:g,showTooltip:m,tooltip:_,disableTriggerEvent:x});k.add(S);var A,w=0;"horizontal"===i?"top"===n?(A="M0,0L".concat(s,",0L").concat(s,",12Z"),w=l):(A="M0,12L".concat(s,",12L").concat(s,",0Z"),S.setAttribute("y",12)):"left"===n?A="M".concat(s,",0L").concat(s,",0L").concat(s+12,",").concat(l,"L").concat(s,",").concat(l,"Z"):(A="M0,".concat(l,"L12,").concat(l,"L12,0Z"),S.setAttribute("x",12));var T=kg.path(Object.assign(Object.assign({x:0,y:w,path:A},b),{zIndex:0}));k.add(T);var M=this._title?this._title.AABBBounds.height()+U(this.attribute,"title.space",12):0;k.translate(0-k.AABBBounds.x1,M-k.AABBBounds.y1),this._slider=S}},{key:"_bindEvents",value:function(){this.attribute.disableTriggerEvent||this._slider&&this._slider.addEventListener("change",this._onSliderChange)}}]),i}(eF);function mF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}gF.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}},xL(),UL(),FL();var _F=function(t){ue(i,t);var e=mF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="title",r}return zt(i,[{key:"render",value:function(){var t,e,i,n,r,o,a,s,l,u,c,h,d,f,p,v,y,g,m,_,b,x,k,S,A,w,M,C,E,R,P,L,O,I,D,F,z,j,H,N,V,G,W=this.attribute,U=W.textType,Y=W.text,K=W.subtextType,X=W.textStyle,Z=void 0===X?{}:X,q=W.subtext,J=W.subtextStyle,Q=void 0===J?{}:J,$=W.width,tt=W.height,et=W.minWidth,it=W.maxWidth,nt=W.minHeight,rt=W.maxHeight,ot=W.align,at=W.verticalAlign,st=W.padding,lt=mi(void 0===st?0:st),ut=this.createOrUpdateChild("title-container",{x:lt[3],y:lt[0],zIndex:1},"group");if(!1!==this.attribute.visible&&!1!==Z.visible)if("rich"===U||T(Z.character)){var ct=Object.assign({x:null!==(t=Z.x)&&void 0!==t?t:0,y:null!==(e=Z.y)&&void 0!==e?e:0,width:null!==(n=null!==(i=Z.width)&&void 0!==i?i:$)&&void 0!==n?n:0,height:null!==(o=null!==(r=Z.height)&&void 0!==r?r:tt)&&void 0!==o?o:0,ellipsis:null===(a=Z.ellipsis)||void 0===a||a,wordBreak:null!==(s=Z.wordBreak)&&void 0!==s?s:"break-word",maxHeight:Z.maxHeight,maxWidth:Z.maxWidth,textConfig:null!==(l=Z.character)&&void 0!==l?l:Y},Z);this._mainTitle=ut.createOrUpdateChild("mainTitle",ct,"richtext")}else if("html"===U){var ht=Object.assign({html:Object.assign(Object.assign({dom:Y},cO),Z),x:null!==(u=Z.x)&&void 0!==u?u:0,y:null!==(c=Z.y)&&void 0!==c?c:0,width:null!==(d=null!==(h=Z.width)&&void 0!==h?h:$)&&void 0!==d?d:0,height:null!==(p=null!==(f=Z.height)&&void 0!==f?f:tt)&&void 0!==p?p:0,ellipsis:null===(v=Z.ellipsis)||void 0===v||v,wordBreak:null!==(y=Z.wordBreak)&&void 0!==y?y:"break-word",maxHeight:Z.maxHeight,maxWidth:Z.maxWidth,textConfig:[]},Z);this._mainTitle=ut.createOrUpdateChild("mainTitle",ht,"richtext")}else T(Y)&&(this._mainTitle=ut.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:B(Y)?Y:[Y]},Z),{maxLineWidth:null!==(g=Z.maxLineWidth)&&void 0!==g?g:$,heightLimit:Z.heightLimit,lineClamp:Z.lineClamp,ellipsis:null===(m=Z.ellipsis)||void 0===m||m,x:0,y:0}),"wrapText"));var dt=this._mainTitle?this._mainTitle.AABBBounds.height():0,ft=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==Q.visible)if("rich"===K||T(Q.character)){var pt=Object.assign({x:null!==(_=Q.x)&&void 0!==_?_:0,y:null!==(b=Q.y)&&void 0!==b?b:0,width:null!==(k=null!==(x=Q.width)&&void 0!==x?x:$)&&void 0!==k?k:0,height:null!==(A=null!==(S=Q.height)&&void 0!==S?S:tt)&&void 0!==A?A:0,ellipsis:null===(w=Q.ellipsis)||void 0===w||w,wordBreak:null!==(M=Q.wordBreak)&&void 0!==M?M:"break-word",maxHeight:Q.maxHeight,maxWidth:Q.maxWidth,textConfig:null!==(C=Q.character)&&void 0!==C?C:q},Q);this._subTitle=ut.createOrUpdateChild("subTitle",pt,"richtext")}else if("html"===K){var vt=Object.assign({html:Object.assign(Object.assign({dom:q},cO),Q),x:null!==(E=Q.x)&&void 0!==E?E:0,y:null!==(R=Q.y)&&void 0!==R?R:0,width:null!==(L=null!==(P=Q.width)&&void 0!==P?P:$)&&void 0!==L?L:0,height:null!==(I=null!==(O=Q.height)&&void 0!==O?O:tt)&&void 0!==I?I:0,ellipsis:null===(D=Q.ellipsis)||void 0===D||D,wordBreak:null!==(F=Q.wordBreak)&&void 0!==F?F:"break-word",maxHeight:Q.maxHeight,maxWidth:Q.maxWidth,textConfig:[]},Q);this._subTitle=ut.createOrUpdateChild("subTitle",vt,"richtext")}else T(q)&&(this._subTitle=ut.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:B(q)?q:[q]},Q),{maxLineWidth:null!==(z=Q.maxLineWidth)&&void 0!==z?z:$,heightLimit:Q.heightLimit,lineClamp:Q.lineClamp,ellipsis:null===(j=Q.ellipsis)||void 0===j||j,x:0,y:dt}),"wrapText"));var yt=this._subTitle?this._subTitle.AABBBounds.height():0,gt=this._subTitle?this._subTitle.AABBBounds.width():0,mt=Math.max(ft,gt),_t=dt+(null!==(H=Q.height)&&void 0!==H?H:yt);if(T($)&&(mt=$,this._mainTitle&&this._mainTitle.setAttribute("maxLineWidth",$),this._subTitle&&this._subTitle.setAttribute("maxLineWidth",$)),T(tt)&&(_t=tt),T(et)&&mt<et&&(mt=et),T(it)&&(this._mainTitle&&this._mainTitle.setAttribute("maxLineWidth",it),this._subTitle&&this._subTitle.setAttribute("maxLineWidth",it),this._mainTitle&&this._mainTitle.setAttribute("maxWidth",it),this._subTitle&&this._subTitle.setAttribute("maxWidth",it),mt>it&&(mt=it)),T(nt)&&_t<nt&&(_t=nt),T(rt)&&(this._mainTitle&&this._mainTitle.setAttribute("maxHeight",rt),this._subTitle&&this._subTitle.setAttribute("maxHeight",rt-dt),_t>rt&&(_t=rt)),ut.attribute.width=mt,ut.attribute.height=_t,ut.attribute.boundsPadding=lt,this._mainTitle){if(T(ot)||T(Z.align)){var bt=Z.align?Z.align:ot,xt=null!==(N=Z.width)&&void 0!==N?N:ft;"left"===bt?(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left")):"center"===bt?(this._mainTitle.setAttribute("x",xt/2),this._mainTitle.setAttribute("textAlign","center")):"right"===bt&&(this._mainTitle.setAttribute("x",xt),this._mainTitle.setAttribute("textAlign","right"))}if(T(at)||T(Z.verticalAlign)){var kt=Z.verticalAlign?Z.verticalAlign:at,St=Z.height?Z.height:_t;"top"===kt?(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top")):"middle"===kt?(this._mainTitle.setAttribute("y",St/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===kt&&(this._mainTitle.setAttribute("y",St),this._mainTitle.setAttribute("textBaseline","bottom"))}}if(this._subTitle){if(T(ot)||T(Q.align)){var At=Q.align?Q.align:ot,wt=null!==(V=Q.width)&&void 0!==V?V:gt;"left"===At?(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left")):"center"===At?(this._subTitle.setAttribute("x",wt/2),this._subTitle.setAttribute("textAlign","center")):"right"===At&&(this._subTitle.setAttribute("x",wt),this._subTitle.setAttribute("textAlign","right"))}if(T(at)||T(Z.verticalAlign)){var Tt=Q.verticalAlign?Q.verticalAlign:at,Mt=dt,Ct=null!==(G=Q.height)&&void 0!==G?G:0;"top"===Tt?(this._subTitle.setAttribute("y",Mt),this._subTitle.setAttribute("textBaseline","top")):"middle"===Tt?(this._subTitle.setAttribute("y",Mt+Ct/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===Tt&&(this._subTitle.setAttribute("y",Mt+Ct),this._subTitle.setAttribute("textBaseline","bottom"))}}}}]),i}(OT);_F.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};var bF={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};function xF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}xL(),GL(),FL();var kF=function(t){ue(i,t);var e=xF(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).name="indicator",t}return zt(i,[{key:"render",value:function(){var t,e,i,n=this,r=this.attribute,o=r.visible,a=r.title,s=void 0===a?{}:a,l=r.content,u=r.size,c=r.limitRatio,h=void 0===c?1/0:c,d=Math.min(u.width,u.height)*h,f=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1},"group");if(!0===o){if(T(s))if(!1!==s.visible){var p=Q({},U(bF,"title.style"),s.style);"rich"===p.type?this._title=f.createOrUpdateChild("indicator-title",Object.assign(Object.assign({textConfig:p.text},p),{visible:s.visible,x:0,y:0,width:null!==(t=p.width)&&void 0!==t?t:0,height:null!==(e=p.height)&&void 0!==e?e:0}),"richtext"):"html"===p.type?this._title=f.createOrUpdateChild("indicator-title",Object.assign(Object.assign({textConfig:[],html:Object.assign(Object.assign({dom:p.text},cO),p)},p),{visible:s.visible,x:0,y:0}),"richtext"):this._title=f.createOrUpdateChild("indicator-title",Object.assign(Object.assign({},p),{lineHeight:T(p.lineHeight)?p.lineHeight:p.fontSize,visible:s.visible,x:0,y:0}),"text"),s.autoFit&&F(d)&&this._setLocalAutoFit(d,this._title,s),s.autoLimit&&F(h)&&this._title.setAttribute("maxLineWidth",d)}else{var v=f.find((function(t){return"indicator-title"===t.name}),!1);v&&f.removeChild(v),this._title=void 0}if(T(l)){var y=lt(l),g=[];y.forEach((function(t,e){var i,r;if(!1!==t.visible){var o,a=Q({},U(bF,"content.style"),t.style);o="rich"===a.type?f.createOrUpdateChild("indicator-content-"+e,Object.assign(Object.assign({textConfig:a.text},a),{visible:s.visible,x:0,y:0,width:null!==(i=a.width)&&void 0!==i?i:0,height:null!==(r=a.height)&&void 0!==r?r:0}),"richtext"):"html"===a.type?f.createOrUpdateChild("indicator-content-"+e,Object.assign(Object.assign({textConfig:[],html:Object.assign(Object.assign({dom:a.text},cO),a)},a),{visible:s.visible,x:0,y:0}),"richtext"):f.createOrUpdateChild("indicator-content-"+e,Object.assign(Object.assign({},a),{lineHeight:T(a.lineHeight)?a.lineHeight:a.fontSize,visible:t.visible,x:0,y:0}),"text"),t.autoFit&&F(d)&&n._setLocalAutoFit(d,o,t),t.autoLimit&&F(h)&&o.setAttribute("maxLineWidth",d),g.push(o)}else{var l=f.find((function(t){return t.name==="indicator-content-"+e}),!1);l&&f.removeChild(l)}})),this._content=g}this._setGlobalAutoFit(d),this._setYPosition();var m=null!==(i=null==f?void 0:f.AABBBounds.height())&&void 0!==i?i:0;f.setAttribute("y",u.height/2-m/2),f.setAttribute("x",u.width/2)}else f&&f.hideAll()}},{key:"_setLocalAutoFit",value:function(t,e,i){var n,r,o,a,s,l,u,c;if("default"===(null!==(n=i.fitStrategy)&&void 0!==n?n:"default")){var h=dO(null!==(o=null===(r=i.style)||void 0===r?void 0:r.text)&&void 0!==o?o:"",null!==(a=i.style)&&void 0!==a?a:{},null===(s=this.stage)||void 0===s?void 0:s.getTheme().text.fontFamily).width;if(h>0){var d=t*(null!==(l=i.fitPercent)&&void 0!==l?l:.5)/h,f=Math.floor((null!==(c=null===(u=i.style)||void 0===u?void 0:u.fontSize)&&void 0!==c?c:20)*d);e.setAttribute("fontSize",f),e.setAttribute("lineHeight",T(i.style.lineHeight)?i.style.lineHeight:f)}}}},{key:"_setGlobalAutoFit",value:function(t){var e,i,n,r,o,a,s,l=this,u=t/2,c=[],h=0,d=null!==(e=this.attribute.title)&&void 0!==e?e:{};d.autoFit&&"inscribed"===d.fitStrategy?(this._title.setAttribute("fontSize",12),c.push({text:this._title,spec:null!==(i=this.attribute.title)&&void 0!==i?i:{}})):h+=null!==(a=null===(o=null===(r=null===(n=this._title)||void 0===n?void 0:n.AABBBounds)||void 0===r?void 0:r.height)||void 0===o?void 0:o.call(r))&&void 0!==a?a:0;var f=null!==(s=d.space)&&void 0!==s?s:0;if(h+=f,lt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n,r,o,a=l._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(a.setAttribute("fontSize",12),c.push({text:a,spec:t})):h+=null!==(r=null===(n=null===(i=null==a?void 0:a.AABBBounds)||void 0===i?void 0:i.height)||void 0===n?void 0:n.call(i))&&void 0!==r?r:0;var s=null!==(o=t.space)&&void 0!==o?o:0;h+=s})),!(c.length<=0)){var p=12/c.reduce((function(t,e){return Math.max(t,e.text.AABBBounds.width())}),0)*c.length,v=h/2,y=Math.pow(p,2)+1,g=2*v*p,m=Math.pow(v,2)-Math.pow(u,2),_=2*(p*((-g+Math.sqrt(Math.pow(g,2)-4*y*m))/(2*y))+v),b=(_-h)/c.length;F(_)&&c.forEach((function(t){var e,i=null===(e=t.spec.style)||void 0===e?void 0:e.lineHeight;t.text.setAttribute("fontSize",b),t.text.setAttribute("lineHeight",T(i)?i:b)}))}}},{key:"_setYPosition",value:function(){var t,e,i,n,r,o,a=this,s=0,l=null!==(n=null===(i=null===(e=null===(t=this._title)||void 0===t?void 0:t.AABBBounds)||void 0===e?void 0:e.height)||void 0===i?void 0:i.call(e))&&void 0!==n?n:0,u=null!==(o=null===(r=this.attribute.title)||void 0===r?void 0:r.space)&&void 0!==o?o:0;lt(this.attribute.content).filter((function(t){return!1!==t.visible})).forEach((function(t,e){var i,n=a._content[e];n.setAttribute("y",l+u+s);var r=null!==(i=t.space)&&void 0!==i?i:0;s+=n.AABBBounds.height()+r}))}}]),i}(OT);function SF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var AF,wF,TF=function(t){ue(i,t);var e=SF(i);function i(t){return jt(this,i),e.call(this,t)}return zt(i)}(ny);function MF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}!function(t){t.OnPlay="onPlay",t.OnPause="onPause",t.OnForward="onForward",t.OnBackward="onBackward"}(AF||(AF={})),function(t){t.Start="start",t.Pause="pause",t.Forward="forward",t.Backward="backward"}(wF||(wF={}));var CF=function(t){ue(i,t);var e=MF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t)))._isPaused=!0,r.updateAttributes=function(){r._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},i.defaultControllerAttr),{visible:r.attribute.start.visible}),r.attribute.start.style)},r._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},i.defaultControllerAttr),{visible:r.attribute.pause.visible}),r.attribute.pause.style)},r._forwardAttr={style:Object.assign(Object.assign(Object.assign({},i.defaultControllerAttr),{visible:r.attribute.forward.visible}),r.attribute.forward.style)},r._backwardAttr={style:Object.assign(Object.assign(Object.assign({},i.defaultControllerAttr),{visible:r.attribute.backward.visible}),r.attribute.backward.style)},r.updateLayout()},r.updateLayout=function(){var t,e,i,n;r._layout=r.attribute.layout,"horizontal"===r._layout?(r._backwardAttr.style.symbolType=null!==(t=r._backwardAttr.style.symbolType)&&void 0!==t?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",r._forwardAttr.style.symbolType=null!==(e=r._forwardAttr.style.symbolType)&&void 0!==e?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===r._layout&&(r._backwardAttr.style.symbolType=null!==(i=r._backwardAttr.style.symbolType)&&void 0!==i?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",r._forwardAttr.style.symbolType=null!==(n=r._forwardAttr.style.symbolType)&&void 0!==n?n:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},r._initPlay=function(){w(r._playController)&&(r._playController=new TF(Object.assign({},r._startAttr.style)),r.add(r._playController))},r._initBackward=function(){w(r._backwardController)&&(r._backwardController=new TF(Object.assign({},r._backwardAttr.style)),r.add(r._backwardController))},r._initForward=function(){w(r._forwardController)&&(r._forwardController=new TF(Object.assign({},r._forwardAttr.style)),r.add(r._forwardController))},r._initEvents=function(){r.attribute.disableTriggerEvent||(r._playController.addEventListener("pointerdown",(function(t){t.stopPropagation(),!0===r._isPaused?r.play():r.pause()})),r._backwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),r.backward()})),r._forwardController.addEventListener("pointerdown",(function(t){t.stopPropagation(),r.forward()})))},r.renderPlay=function(){r._isPaused?r._playController.setAttributes(Object.assign({symbolType:r._playController.getComputedAttribute("symbolType")},r._startAttr.style)):r._playController.setAttributes(Object.assign({symbolType:r._playController.getComputedAttribute("symbolType")},r._pauseAttr.style))},r.renderBackward=function(){r._backwardController.setAttributes(r._backwardAttr.style)},r.renderForward=function(){r._forwardController.setAttributes(r._forwardAttr.style)},r.play=function(){r._dispatchEvent("ControllerEventEnum.OnPlay")},r.pause=function(){r._dispatchEvent("ControllerEventEnum.OnPause")},r.forward=function(){r._dispatchEvent("ControllerEventEnum.OnForward")},r.backward=function(){r._dispatchEvent("ControllerEventEnum.OnBackward")},r.togglePlay=function(){r._playController.setAttributes(r._startAttr.style),r._isPaused=!0},r.togglePause=function(){r._playController.setAttributes(r._pauseAttr.style),r._isPaused=!1},r.updateAttributes(),r._initPlay(),r._initBackward(),r._initForward(),r._initEvents(),r}return zt(i,[{key:"render",value:function(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}]),i}(OT);CF.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},CF.defaultAttributes=v(v(v(v({},wF.Start,{}),wF.Pause,{}),wF.Backward,{}),wF.Forward,{});var EF,RF,PF={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},BF=[200,10];!function(t){t.Default="default",t.Reverse="reverse"}(EF||(EF={})),function(t){t.change="change",t.play="play",t.pause="pause",t.backward="backward",t.forward="forward",t.end="end",t.OnChange="change",t.OnPlay="play",t.OnPause="pause",t.OnBackward="backward",t.OnForward="forward",t.OnEnd="end"}(RF||(RF={}));var LF=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===EF.Default&&n===i}({direction:e,maxIndex:i,dataIndex:r})||function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===EF.Reverse&&n===i}({direction:e,minIndex:n,dataIndex:r})},OF=function(t){var e=t.direction,i=t.maxIndex,n=t.minIndex,r=t.dataIndex;return function(t){var e=t.direction,i=t.minIndex,n=t.dataIndex;return e===EF.Default&&n===i}({direction:e,minIndex:n,dataIndex:r})||function(t){var e=t.direction,i=t.maxIndex,n=t.dataIndex;return e===EF.Reverse&&n===i}({direction:e,maxIndex:i,dataIndex:r})},IF=function(t){return"top"===t||"bottom"===t};function DF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var FF=function(t){ue(i,t);var e=DF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t)))._data=[],r._layoutInfo={},r._updateSliderAttrs=function(){var t,e,i,n;F(r._handlerStyle.size)?n=r._handlerStyle.size:r._handlerStyle.size&&r._handlerStyle.size.length&&(n=Xt(r._handlerStyle.size[0],r._handlerStyle.size[1]));var o={visible:r._sliderVisible,min:r._minIndex,max:r._maxIndex,value:null!==(t=r.attribute.dataIndex)&&void 0!==t?t:0,railWidth:r._railStyle.width,railHeight:r._railStyle.height,railStyle:r._railStyle,trackStyle:r._trackStyle,handlerSize:F(n)?n:void 0,handlerStyle:r._handlerStyle,dy:r.attribute.slider.dy,dx:r.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:r.attribute.disableTriggerEvent};if(IF(r._orient)){var a=Math.max(0,r._layoutInfo.slider.size),s=null!==(e=r._railStyle.height)&&void 0!==e?e:BF[1];o.layout="horizontal",o.railHeight=s,o.railWidth=a,o.x=r._layoutInfo.slider.x,o.y=r._layoutInfo.slider.y}else{var l=Math.max(0,r._layoutInfo.slider.size),u=null!==(i=r._railStyle.width)&&void 0!==i?i:BF[1];o.layout="vertical",o.railWidth=u,o.railHeight=l,o.x=r._layoutInfo.slider.x,o.y=r._layoutInfo.slider.y}return o},r._initSlider=function(){var t=r._updateSliderAttrs();r._slider=new dF(t),r._sliderVisible&&r.add(r._slider)},r._updateControllerAttrs=function(){var t={start:r._start,pause:r._pause,forward:r._forward,backward:r._backward,disableTriggerEvent:r.attribute.disableTriggerEvent};return IF(r._orient)?(t.layout="horizontal",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:r._layoutInfo.start.x,y:r._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:r._layoutInfo.start.x,y:r._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:r._layoutInfo.backward.x,y:r._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:r._layoutInfo.forward.x,y:r._layoutInfo.forward.y})})):(t.layout="vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:r._layoutInfo.start.x,y:r._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:r._layoutInfo.start.x,y:r._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:r._layoutInfo.backward.x,y:r._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:r._layoutInfo.forward.x,y:r._layoutInfo.forward.y})})),t},r._initController=function(){var t=r._updateControllerAttrs();r._controller=new CF(t),r._controllerVisible&&r.add(r._controller)},r._initAttributes(),r._initLayoutInfo(),r._initController(),r._initSlider(),r}return zt(i,[{key:"_initAttributes",value:function(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;var t=this.attribute,e=t.slider,i=void 0===e?{}:e,n=t.controller,r=void 0===n?{}:n;this._sliderVisible=i.visible,this._railStyle=Object.assign({},i.railStyle),this._trackStyle=Object.assign({},i.trackStyle),this._handlerStyle=Object.assign({},i.handlerStyle),this._controllerVisible=r.visible,this._start=Object.assign({},r.start),this._pause=Object.assign({},r.pause),this._forward=Object.assign({},r.forward),this._backward=Object.assign({},r.backward)}},{key:"_initLayoutInfo",value:function(){var t,e,i,n=this,r=[this._start,this._backward,this._forward].sort((function(t,e){return t.order-e.order})),o=r.filter((function(t){return"end"!==t.position})),a=r.filter((function(t){return"end"===t.position})),s=null!==(t=IF(this._orient)?this._railStyle.height:this._railStyle.width)&&void 0!==t?t:BF[1],l=r.reduce((function(t,e){var i=e.style.size,n=I(i)?i:Xt(i[0],i[1]);return t+e.space+n}),0),u=this._sliderVisible?(IF(this._orient)?null===(e=this._size)||void 0===e?void 0:e.width:null===(i=this._size)||void 0===i?void 0:i.height)-l:0,c=u-this.attribute.slider.space,h=o.reduce((function(t,e){var i=e.key,r=e.space,o=e.style.size,a=I(o)?o:Xt(o[0],o[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:a,x:IF(n._orient)?t+r:(n._size.width-a)/2,y:IF(n._orient)?(n._size.height-a)/2:t+r}),t+r+a}),0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:c,x:IF(this._orient)?h+this.attribute.slider.space:(this._size.width-s)/2,y:IF(this._orient)?(this._size.height-s)/2:h+this.attribute.slider.space}),a.reduce((function(t,e){var i=e.key,r=e.space,o=e.style.size,a=I(o)?o:Xt(o[0],o[1]);return n._layoutInfo[i]=Object.assign(Object.assign({},n._layoutInfo[i]),{size:a,x:IF(n._orient)?t+r:(n._size.width-a)/2,y:IF(n._orient)?(n._size.height-a)/2:t+r}),t+r+a}),h+u)}},{key:"render",value:function(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}},{key:"renderSlider",value:function(){var t=this._updateSliderAttrs();this._slider.setAttributes(t)}},{key:"renderController",value:function(){var t=this._updateControllerAttrs();this._controller.setAttributes(t)}},{key:"dispatchCustomEvent",value:function(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}]),i}(OT);function zF(){iF(),xL(),NL()}function jF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}FF.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},PF),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},PF),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},PF),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},PF),{key:"backward",position:"start"})}},zF();var HF=function(t){ue(i,t);var e=jF(i);function i(t,n){var r,o;return jt(this,i),(o=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},t)))._activeIndex=-1,o._isReachEnd=!1,o._initAttributes=function(){var t,e,n,a;Xs((r=ce(o),de(i.prototype)),"_initAttributes",r).call(r),o._alternate=null!==(t=o.attribute.alternate)&&void 0!==t&&t,o._interval=null!==(e=o.attribute.interval)&&void 0!==e?e:1e3,o._direction=null!==(n=o.attribute.direction)&&void 0!==n?n:EF.Default,o._dataIndex=w(o.attribute.dataIndex)?"default"===o._direction?o._minIndex:o._maxIndex:null!==(a=o.attribute.dataIndex)&&void 0!==a?a:0,o._slider.setAttribute("value",o._dataIndex)},o._initEvents=function(){o.attribute.disableTriggerEvent||(o._controller.addEventListener(AF.OnPlay,(function(t){t.stopPropagation(),o.play()})),o._controller.addEventListener(AF.OnPause,(function(t){t.stopPropagation(),o.pause()})),o._controller.addEventListener(AF.OnForward,(function(t){t.stopPropagation(),o.forward()})),o._controller.addEventListener(AF.OnBackward,(function(t){t.stopPropagation(),o.backward()})),o._slider.addEventListener("change",(function(t){var e=Math.floor(t.detail.value)+.5;o._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),o._slider.setValue(o._dataIndex),o.dispatchCustomEvent(RF.change)})))},o.play=function(){o._isPlaying||1!==o._data.length&&(o._controller.togglePause(),o._isPlaying=!0,(LF({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction})||OF({dataIndex:o._dataIndex,maxIndex:o._maxIndex,minIndex:o._minIndex,direction:o._direction}))&&(o._direction===EF.Default?o._updateDataIndex(o._minIndex):o._updateDataIndex(o._maxIndex)),o.dispatchCustomEvent(RF.play),o._isReachEnd=!1,o._tickTime=Date.now(),o._rafId=ux.getRequestAnimationFrame()(o._play.bind(ce(o),!0)))},o._play=function(t){var e=Date.now();if(o._isReachEnd&&e-o._tickTime>=o._interval)return o._isReachEnd=!1,void o._playEnd();t&&o._activeIndex!==o._dataIndex?(o.dispatchCustomEvent(RF.change),o._activeIndex=o._dataIndex):e-o._tickTime>=o._interval&&(o._tickTime=e,o._updateDataIndex(function(t,e,i,n){return"default"===t?Math.min(e+1,n):Math.max(e-1,i)}(o._direction,o._dataIndex,o._minIndex,o._maxIndex)),o._activeIndex=o._dataIndex,o.dispatchCustomEvent(RF.change)),("default"===o._direction&&o._dataIndex>=o._maxIndex||"reverse"===o._direction&&o._dataIndex<=o._minIndex)&&(o._isReachEnd=!0),o._rafId=ux.getRequestAnimationFrame()(o._play.bind(ce(o),!1))},o._updateDataIndex=function(t){o._dataIndex=t,o._slider.setValue(o._dataIndex)},o._playEnd=function(){o._isPlaying=!1,o._controller.togglePlay(),ux.getCancelAnimationFrame()(o._rafId),o._activeIndex=-1,o.dispatchCustomEvent(RF.end)},o.pause=function(){o._isPlaying&&(o._isPlaying=!1,ux.getCancelAnimationFrame()(o._rafId),o._controller.togglePlay(),o.dispatchCustomEvent(RF.pause))},o.backward=function(){var t=Math.max(o._dataIndex-1,o._minIndex);o._updateDataIndex(t),o.dispatchCustomEvent(RF.change),o.dispatchCustomEvent(RF.backward)},o.forward=function(){var t=Math.min(o._dataIndex+1,o._maxIndex);o._updateDataIndex(t),o.dispatchCustomEvent(RF.change),o.dispatchCustomEvent(RF.forward)},o._initAttributes(),o._initEvents(),o}return zt(i,[{key:"setAttributes",value:function(t,e){Xs(de(i.prototype),"setAttributes",this).call(this,t,e),this._initAttributes()}},{key:"dispatchCustomEvent",value:function(t){Xs(de(i.prototype),"dispatchCustomEvent",this).call(this,t,this._dataIndex)}}]),i}(FF);function NF(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */NF=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function VF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var GF=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};zF();var WF,UF=function(t){ue(i,t);var e=VF(i);function i(t){var n,r;return jt(this,i),(r=e.call(this,t))._isPlaying=!1,r._startTime=Date.now(),r._initAttributes=function(){var t,e;Xs((n=ce(r),de(i.prototype)),"_initAttributes",n).call(n),r._maxIndex=r._data.length,r._slider.setAttribute("max",r._maxIndex),r._isPlaying=!1,r._elapsed=0,r._interval=null!==(t=r.attribute.interval)&&void 0!==t?t:1e3,r._dataIndex=null!==(e=r.attribute.dataIndex)&&void 0!==e?e:r._minIndex;var o=r._data.length;r.attribute.totalDuration&&r._data.length?(r._totalDuration=r.attribute.totalDuration,r._interval=r._totalDuration/(null!=o?o:1)):(r._totalDuration=r._interval*o,r._interval=r.attribute.interval)},r._initEvents=function(){r.attribute.disableTriggerEvent||(r._controller.addEventListener(AF.OnPlay,(function(t){t.stopPropagation(),r.play()})),r._controller.addEventListener(AF.OnPause,(function(t){t.stopPropagation(),r.pause()})),r._controller.addEventListener(AF.OnForward,(function(t){t.stopPropagation(),r.forward()})),r._controller.addEventListener(AF.OnBackward,(function(t){t.stopPropagation(),r.backward()})),r._slider.addEventListener("change",(function(t){var e;t.stopPropagation();var i=null===(e=t.detail)||void 0===e?void 0:e.value,n=i/r._maxIndex;r._elapsed=n*r._totalDuration,r._startTime=Date.now()-r._elapsed,r._dispatchChange(i)})))},r._getSliderValue=function(){var t=r._elapsed/r._totalDuration;return Math.min(t*r._maxIndex,r._maxIndex)},r._updateSlider=function(){var t=r._getSliderValue();r._dataIndex=Math.floor(t),r._slider.setValue(Math.min(t,r._maxIndex)),r._dispatchChange(Math.floor(t))},r._dispatchChange=function(t){var e=Math.floor(t);e!==r._activeIndex&&(r._dataIndex=e,r._activeIndex=e,e!==r._maxIndex&&r.dispatchCustomEvent(RF.change))},r.play=function(){return GF(ce(r),void 0,void 0,NF().mark((function t(){return NF().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(RF.play),this._rafId=ux.getRequestAnimationFrame()(this._play.bind(this)));case 1:case"end":return t.stop()}}),t,this)})))},r._play=function(){r._elapsed=Date.now()-r._startTime;var t=r._getSliderValue();r._updateSlider(),t>=r._maxIndex?r._playEnd():r._rafId=ux.getRequestAnimationFrame()(r._play.bind(ce(r)))},r._playEnd=function(){r._isPlaying=!1,ux.getCancelAnimationFrame()(r._rafId),r._controller.togglePlay(),r.dispatchCustomEvent(RF.end)},r.pause=function(){r._isPlaying&&(r._isPlaying=!1,r._elapsed=Date.now()-r._startTime,ux.getCancelAnimationFrame()(r._rafId),r._controller.togglePlay(),r.dispatchCustomEvent(RF.pause))},r.backward=function(){var t=Date.now(),e=1*r._interval,i=r._elapsed-e;i<=0?(r._elapsed=0,r._startTime=t):(r._elapsed=i,r._startTime=r._startTime+r._interval),r._updateSlider(),r.dispatchCustomEvent(RF.backward)},r.forward=function(){var t=Date.now(),e=1*r._interval,i=r._elapsed+e;i>=r._totalDuration?(r._startTime=t-r._totalDuration,r._elapsed=r._totalDuration):(r._startTime=r._startTime-e,r._elapsed=i),r._updateSlider(),r.dispatchCustomEvent(RF.forward)},r._initAttributes(),r._initEvents(),r}return zt(i,[{key:"dispatchCustomEvent",value:function(t){Xs(de(i.prototype),"dispatchCustomEvent",this).call(this,t,this._dataIndex)}},{key:"render",value:function(){Xs(de(i.prototype),"render",this).call(this)}}]),i}(FF);!function(t){t.drawStart="drawStart",t.drawEnd="drawEnd",t.drawing="drawing",t.moving="moving",t.moveStart="moveStart",t.moveEnd="moveEnd",t.brushClear="brushClear"}(WF||(WF={}));var YF={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:"pointerup",resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{y1:-1/0,y2:1/0,x1:-1/0,x2:1/0}};function KF(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var XF={debounce:Pt,throttle:Bt};xL(),EL();var ZF=function(t){ue(i,t);var e=KF(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,(null==n?void 0:n.skipDefault)?t:Q({},i.defaultAttributes,t))).name="brush",r._activeDrawState=!1,r._cacheDrawPoints=[],r._isDrawedBeforeEnd=!1,r._activeMoveState=!1,r._operatingMaskMoveDx=0,r._operatingMaskMoveDy=0,r._operatingMaskMoveRangeX=[-1/0,1/0],r._operatingMaskMoveRangeY=[-1/0,1/0],r._brushMaskAABBBoundsDict={},r._onBrushStart=function(t){var e;if(!r._outOfInteractiveRange(t)){t.stopPropagation();var i=null===(e=r.attribute.brushMoved)||void 0===e||e;r._activeMoveState=i&&r._isPosInBrushMask(t),r._activeDrawState=!r._activeMoveState,r._activeDrawState&&r._initDraw(t),r._activeMoveState&&r._initMove(t)}},r._onBrushing=function(t){r._outOfInteractiveRange(t)||((r._activeDrawState||r._activeMoveState)&&t.stopPropagation(),r._activeDrawState&&r._drawing(t),r._activeMoveState&&r._moving(t))},r._onBrushEnd=function(t){t.preventDefault();var e=r.attribute.removeOnClick,i=void 0===e||e;r._activeDrawState&&!r._isDrawedBeforeEnd&&i?(r._container.incrementalClearChild(),r._brushMaskAABBBoundsDict={},r._dispatchEvent(WF.brushClear,{operateMask:r._operatingMask,operatedMaskAABBBounds:r._brushMaskAABBBoundsDict,event:t})):(r._activeDrawState&&r._dispatchEvent(WF.drawEnd,{operateMask:r._operatingMask,operatedMaskAABBBounds:r._brushMaskAABBBoundsDict,event:t}),r._activeMoveState&&r._dispatchEvent(WF.moveEnd,{operateMask:r._operatingMask,operatedMaskAABBBounds:r._brushMaskAABBBoundsDict,event:t})),r._activeDrawState=!1,r._activeMoveState=!1,r._isDrawedBeforeEnd=!1,r._operatingMask&&r._operatingMask.setAttribute("pickable",!1)},r}return zt(i,[{key:"_bindBrushEvents",value:function(){if(!this.attribute.disableTriggerEvent){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n,o=t.trigger,a=void 0===o?YF.trigger:o,s=t.updateTrigger,l=void 0===s?YF.updateTrigger:s,u=t.endTrigger,c=void 0===u?YF.endTrigger:u,h=t.resetTrigger,d=void 0===h?YF.resetTrigger:h;this.stage.addEventListener(a,this._onBrushStart),this.stage.addEventListener(l,XF[i](this._onBrushing,r)),this.stage.addEventListener(c,this._onBrushEnd),this.stage.addEventListener(d,this._onBrushEnd)}}},{key:"_isPosInBrushMask",value:function(t){for(var e,i=this,n=this.eventPosToStagePos(t),r=this._container.getChildren(),o=function(){var t=r[a].attribute,e=t.points,o=void 0===e?[]:e,s=t.dx,l=void 0===s?0:s,u=t.dy,c=void 0===u?0:u,h=o.map((function(t){return{x:t.x+l,y:t.y+c}}));if(li(h,n.x,n.y))return{v:(i._operatingMask=r[a],!0)}},a=0;a<r.length;a++)if(e=o())return e.v;return!1}},{key:"_initDraw",value:function(t){var e=this.attribute.brushMode,i=this.eventPosToStagePos(t);this._cacheDrawPoints=[i],this._isDrawedBeforeEnd=!1,"single"===e&&(this._brushMaskAABBBoundsDict={},this._container.incrementalClearChild()),this._addBrushMask(),this._dispatchEvent(WF.drawStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}},{key:"_initMove",value:function(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!==(e=this._operatingMask.attribute.dx)&&void 0!==e?e:0,this._operatingMaskMoveDy=null!==(i=this._operatingMask.attribute.dy)&&void 0!==i?i:0;var n=this.attribute.interactiveRange,r=n.minY,o=void 0===r?-1/0:r,a=n.maxY,s=void 0===a?1/0:a,l=n.minX,u=void 0===l?-1/0:l,c=n.maxX,h=void 0===c?1/0:c,d=this._operatingMask.globalAABBBounds,f=u-d.x1,p=h-d.x2,v=o-d.y1,y=s-d.y2;this._operatingMaskMoveRangeX=[f,p],this._operatingMaskMoveRangeY=[v,y],this._operatingMask.setAttribute("pickable",!0),this._dispatchEvent(WF.moveStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}},{key:"_drawing",value:function(t){var e,i,n=this.eventPosToStagePos(t),r=null===(e=this._operatingMask)||void 0===e?void 0:e._AABBBounds,o=r.x1,a=void 0===o?0:o,s=r.x2,l=void 0===s?0:s,u=r.y1,c=void 0===u?0:u,h=r.y2,d=void 0===h?0:h,f=this.attribute,p=f.sizeThreshold,v=void 0===p?5:p,y=f.brushType,g=this._cacheDrawPoints.length;if(this._isDrawedBeforeEnd=!!(Math.abs(l-a)>v||Math.abs(c-d)>v),g>0){var m=null!==(i=this._cacheDrawPoints[this._cacheDrawPoints.length-1])&&void 0!==i?i:{};if(n.x===m.x&&n.y===m.y)return}"polygon"===y||g<=1?this._cacheDrawPoints.push(n):this._cacheDrawPoints[g-1]=n;var _=this._computeMaskPoints();this._operatingMask.setAttribute("points",_),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(WF.drawing,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}},{key:"_moving",value:function(t){var e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x!==(null==e?void 0:e.x)||i.y!==(null==e?void 0:e.y)){var n=i.x-e.x,r=i.y-e.y,o=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],n))+this._operatingMaskMoveDx,a=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],r))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:o,dy:a}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(WF.moving,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}}},{key:"_computeMaskPoints",value:function(){var t=this.attribute,e=t.brushType,i=t.xRange,n=void 0===i?[0,0]:i,r=t.yRange,o=void 0===r?[0,0]:r,a=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===e?[a,{x:s.x,y:a.y},s,{x:a.x,y:s.y}]:"x"===e?[{x:a.x,y:o[0]},{x:s.x,y:o[0]},{x:s.x,y:o[1]},{x:a.x,y:o[1]}]:"y"===e?[{x:n[0],y:a.y},{x:n[0],y:s.y},{x:n[1],y:s.y},{x:n[1],y:a.y}]:X(this._cacheDrawPoints)}},{key:"_addBrushMask",value:function(){var t,e=this.attribute,i=e.brushStyle,n=e.hasMask,r=kg.polygon(Object.assign(Object.assign({points:X(this._cacheDrawPoints),cursor:"move",pickable:!1},i),{opacity:n?null!==(t=i.opacity)&&void 0!==t?t:1:0}));r.name="brush-".concat(Date.now()),this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}},{key:"_outOfInteractiveRange",value:function(t){var e=this.attribute.interactiveRange,i=e.minY,n=void 0===i?-1/0:i,r=e.maxY,o=void 0===r?1/0:r,a=e.minX,s=void 0===a?-1/0:a,l=e.maxX,u=void 0===l?1/0:l,c=this.eventPosToStagePos(t);return c.x>u||c.x<s||c.y>o||c.y<n}},{key:"eventPosToStagePos",value:function(t){var e,i,n=ux.mapToCanvasPoint(t),r=n.x,o=n.y;return{x:r-((null===(e=this.stage)||void 0===e?void 0:e.x)||0),y:o-((null===(i=this.stage)||void 0===i?void 0:i.y)||0)}}},{key:"render",value:function(){this._bindBrushEvents();var t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}},{key:"releaseBrushEvents",value:function(){var t=this.attribute,e=t.delayType,i=void 0===e?"throttle":e,n=t.delayTime,r=void 0===n?0:n,o=t.trigger,a=void 0===o?YF.trigger:o,s=t.updateTrigger,l=void 0===s?YF.updateTrigger:s,u=t.endTrigger,c=void 0===u?YF.endTrigger:u,h=t.resetTrigger,d=void 0===h?YF.resetTrigger:h;this.stage.removeEventListener(a,this._onBrushStart),this.stage.removeEventListener(l,XF[i](this._onBrushing,r)),this.stage.removeEventListener(c,this._onBrushEnd),this.stage.removeEventListener(d,this._onBrushEnd)}}]),i}(OT);ZF.defaultAttributes=YF;var qF=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var r=[t.shape].concat(m(i.map((function(t){return null==t?void 0:t.shape})))),o=[t.key].concat(m(i.map((function(t){return null==t?void 0:t.key})))),a=[t.value].concat(m(i.map((function(t){return null==t?void 0:t.value}))));return Q.apply(void 0,[t].concat(i,[{shape:r.every(w)?void 0:Q.apply(void 0,[{}].concat(m(r))),key:o.every(w)?void 0:Q.apply(void 0,[{}].concat(m(o))),value:a.every(w)?void 0:Q.apply(void 0,[{}].concat(m(a)))}]))},JF=function(t){var e=t.width,i=t.height,n=t.wordBreak,r=void 0===n?"break-word":n,o=t.textAlign,a=t.textBaseline,s=t.text;return Array.isArray(s)?{width:e,height:i,wordBreak:r,textAlign:o,textBaseline:a,singleLine:!1,textConfig:lt(s).map((function(e){return Object.assign(Object.assign({},t),{text:e})}))}:{width:e,height:i,wordBreak:r,textAlign:o,textBaseline:a,singleLine:!1,textConfig:s.text}},QF={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:lO,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:lO,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:lO,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new ye).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},$F=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];function tz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}xL(),LL(),NL(),GL(),FL();var ez=function(t){ue(n,t);var e=tz(n);function n(t,i){var r;return jt(this,n),(r=e.call(this,(null==i?void 0:i.skipDefault)?t:Q({},n.defaultAttributes,t),i)).name="tooltip",r}return zt(n,[{key:"render",value:function(){var t,e=this,r=this.attribute,o=r.visible,a=r.content,s=r.panel,l=r.keyWidth,u=r.valueWidth,c=r.hasContentShape,h=r.autoCalculatePosition,d=r.autoMeasure;if(o){d&&n.measureTooltip(this.attribute),h&&n.calculateTooltipPosition(this.attribute);var f=mi(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},s),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:f[3],y:f[0]},"group");var p=n.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",Q({symbolType:"circle"},p.shape,{visible:qL(p)&&qL(p.shape)}),"symbol"),"object"!=i(p.value.text)||null===p.value.text||"rich"!==p.value.text.type&&"html"!==p.value.text.type?p.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:qL(p)&&qL(p.value)},JF(p.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!==(t=p.value.text)&&void 0!==t?t:"",visible:qL(p)&&qL(p.value)},p.value),"text"):"rich"===p.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:qL(p)&&qL(p.value)},JF(p.value)),"richtext"):"html"===p.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:p.value.text.text},cO),p.value),visible:qL(p)&&qL(p.value),width:p.value.width,height:p.value.height,wordBreak:p.value.wordBreak,textAlign:p.value.textAlign,textBaseline:p.value.textBaseline,singleLine:!1,textConfig:[]},p.value),"richtext"));var v=qL(p.shape)?p.shape.size+p.shape.spacing:0,y=p.value,g=y.textAlign,m=y.textBaseline,_=s.width-f[3]-f[0]-v;"center"===g?this._tooltipTitle.setAttribute("x",v+_/2):"right"===g||"end"===g?this._tooltipTitle.setAttribute("x",v+_):this._tooltipTitle.setAttribute("x",v),"bottom"===m?this._tooltipTitle.setAttribute("y",p.height):"middle"===m?this._tooltipTitle.setAttribute("y",p.height/2):this._tooltipTitle.setAttribute("y",0);var b=qL(p)?p.height+p.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(),a&&a.length){this._tooltipContent.setAttribute("x",f[3]),this._tooltipContent.setAttribute("y",f[0]+b);var x=0;a.forEach((function(t,r){var o,a,s,h=n.getContentAttr(e.attribute,r);if(qL(h)){var d="tooltip-content-".concat(r),f=e._tooltipContent.createOrUpdateChild(d,{visible:!0,x:0,y:x},"group"),p=0;if(qL(h.shape)&&f.createOrUpdateChild("".concat(d,"-shape"),Object.assign({visible:!0,x:h.shape.size/2,y:h.shape.size/2+((null!==(o=ph(h.key.lineHeight,h.key.fontSize))&&void 0!==o?o:h.key.fontSize)-h.shape.size)/2},h.shape),"symbol"),c&&(p+=h.shape.size+h.shape.spacing),qL(h.key)){var v;v=h.key.multiLine?f.createOrUpdateChild("".concat(d,"-key"),Object.assign(Object.assign({visible:!0},JF(h.key)),{textBaseline:"top"}),"richtext"):"object"!=i(h.key.text)||null===h.key.text||"rich"!==h.key.text.type&&"html"!==h.key.text.type?f.createOrUpdateChild("".concat(d,"-key"),Object.assign(Object.assign({visible:!0,text:null!==(a=h.key.text)&&void 0!==a?a:""},h.key),{textBaseline:"top"}),"text"):"rich"===h.key.text.type?f.createOrUpdateChild("".concat(d,"-value"),Object.assign(Object.assign({visible:!0},JF(h.key)),{textBaseline:"top"}),"richtext"):f.createOrUpdateChild("".concat(d,"-value"),{html:Object.assign(Object.assign({dom:h.key.text.text},cO),h.key)},"richtext");var y=h.key.textAlign;"center"===y?v.setAttribute("x",p+l/2):"right"===y||"end"===y?v.setAttribute("x",p+l):v.setAttribute("x",p),v.setAttribute("y",0),p+=l+h.key.spacing}if(qL(h.value)){var g;g=h.value.multiLine?f.createOrUpdateChild("".concat(d,"-value"),Object.assign(Object.assign({visible:!0},JF(h.value)),{textBaseline:"top"}),"richtext"):"object"!=i(h.value.text)||null===h.value.text||"rich"!==h.value.text.type&&"html"!==h.value.text.type?f.createOrUpdateChild("".concat(d,"-value"),Object.assign(Object.assign({visible:!0,text:null!==(s=h.value.text)&&void 0!==s?s:""},h.value),{textBaseline:"top"}),"text"):"rich"===h.value.text.type?f.createOrUpdateChild("".concat(d,"-value"),Object.assign(Object.assign({visible:!0},JF(h.value)),{textBaseline:"top"}),"richtext"):f.createOrUpdateChild("".concat(d,"-value"),{html:Object.assign({dom:h.value.text.text,container:"",width:30,height:30,style:{}},h.value)},"richtext");var m="right";T(h.value.textAlign)?m=h.value.textAlign:qL(h.key)||(m="left"),g.setAttribute("textAlign",m),"center"===m?g.setAttribute("x",p+u/2):"right"===m||"end"===m?g.setAttribute("x",p+u):g.setAttribute("x",p),p+=u,g.setAttribute("y",0),f.add(g)}x+=h.height+h.spaceRow}}))}}else this.hideAll()}},{key:"setAttributes",value:function(t,e){var i=Object.keys(t);this.attribute.autoCalculatePosition&&i.every((function(t){return $F.includes(t)}))?(this._mergeAttributes(t,i),w(this.attribute.panel.width)&&this.attribute.autoMeasure&&n.measureTooltip(this.attribute),n.calculateTooltipPosition(this.attribute),Xs(de(n.prototype),"setAttributes",this).call(this,{x:this.attribute.x,y:this.attribute.y},e)):Xs(de(n.prototype),"setAttributes",this).call(this,t,e)}}],[{key:"calculateTooltipPosition",value:function(t){var e=t.panel,i=e.width,n=void 0===i?0:i,r=e.height,o=void 0===r?0:r,a=t.offsetX,s=t.offsetY,l=t.pointerX,u=t.pointerY,c=t.positionX,h=t.positionY,d=t.parentBounds,f=l,p=u;return"left"===c?f-=n+a:"center"===c?f-=n/2:f+=a,"top"===h?p-=o+s:"middle"===h?p-=o/2:p+=s,f+n>d.x2&&(f-=n+a),p+o>d.y2&&(p-=o+s),f<d.x1&&(f=d.x1),p<d.y1&&(p=d.y1),t.x=f,t.y=p,t}},{key:"measureTooltip",value:function(t){var e=t.content,r=t.contentStyle,o=mi(t.padding),a=n.getTitleAttr(t),s=0,l=o[0]+o[2],u=0,c=a.value,h=a.shape,d=null!=h?h:{},f=d.visible,p=void 0!==f&&f,v=d.symbolType,y=void 0===v?"":v;if(T(c)&&"object"!=i(a.value.text)){var g=hO(c).quickMeasure(c.text),m=g.width,_=g.height;s=m,u=_}if(p&&Qv[y]&&(s+=h.size+h.spacing,u=Math.max(h.size,u)),t.title&&(t.title.width=s,t.title.height=u),qL(a)&&(l+=u+a.spaceRow),e&&e.length){var b=[];if(e.forEach((function(e,i){var r=n.getContentAttr(t,i);(e.key||e.value)&&qL(r)&&b.push([e,r])})),b.length){var x=!1,k=[],S=[],A=[];b.forEach((function(t,e){var i,n=Mt(t,2),o=n[0],a=n[1],s=a.key,u=a.value,c=a.shape,h=a.spaceRow,d=qL(c),f=null!==(i=null==c?void 0:c.symbolType)&&void 0!==i?i:"",p=hO(s),v=hO(u),y=0;if(qL(s)){var g=p.quickMeasure(s.text),m=g.width,_=g.height;S.push(m),y=Math.max(y,_)}if(qL(u)){var w=v.quickMeasure(u.text),T=w.width,M=w.height;A.push(T),y=Math.max(y,M)}d&&Qv[f]&&(x=!0,k.push(c.size),y=Math.max(c.size,y)),o.height=y,l+=y,e<b.length-1&&(l+=null!=h?h:r.spaceRow)}));var w=k.length?Math.max.apply(Math,k):0,M=S.length?Math.max.apply(Math,S):0,C=A.length?Math.max.apply(Math,A):0;s=Math.max(M+C+r.key.spacing+r.value.spacing+(x?w+r.shape.spacing:0),s),e.forEach((function(t){t.width=s})),t.hasContentShape=x,t.keyWidth=M,t.valueWidth=C}}return t.panel.width=s+o[1]+o[3],t.panel.height=l,t}},{key:"getTitleAttr",value:function(t){return qF({},n.defaultAttributes.titleStyle,n.defaultAttributes.title,t.titleStyle,t.title)}},{key:"getContentAttr",value:function(t,e){return qF({},n.defaultAttributes.contentStyle,t.contentStyle,t.content[e])}}]),n}(OT);function iz(t){if(t)return t.type===sS.Band?t.bandwidth():t.type===sS.Point?t.step():void 0}ez.defaultAttributes=QF;var nz=function(t,e){return uT(t)?t.output():t&&M(t)?A(t.callback)?function(i){return t.callback(i,e)}:A(t.value)?t.value(e):t:t},rz=function(t,e){return t?M(t)?Object.keys(t).reduce((function(i,n){var r=t[n];return i[n]=nz(r,e),i}),{}):t.map((function(t){return nz(t,e)})):t};function oz(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */oz=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function az(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var sz=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},lz=-1,uz=function(e){ue(n,e);var i=az(n);function n(t){var e;return jt(this,n),(e=i.call(this)).spec={},e.references=new Map,e.targets=[],e.transforms=[],e.view=t,e.uid=++lz,e}return zt(n,[{key:"parse",value:function(t){return this.id(t.id),this.name(t.name),this.depend(t.dependency),this}},{key:"depend",value:function(t){var e,i=this;if(null===(e=this.spec)||void 0===e?void 0:e.dependency){var n=lt(this.spec.dependency).map((function(t){return P(t)?i.view.getGrammarById(t):t}));this.detach(n)}this.spec.dependency=t;var r=lt(t).map((function(t){return P(t)?i.view.getGrammarById(t):t}));return this.attach(r),this.commit(),this}},{key:"addEventListener",value:function(t,e,i){var n=e;return i&&!1===i.trap||((n=e).raw=e),i&&i.target&&(n.target=i.target),this.on(t,n),this}},{key:"removeEventListener",value:function(t,e){return e?this.off(t,e):this.off(t),this}},{key:"emit",value:function(t){for(var e,i,r,o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return null===(o=null===(r=this.view)||void 0===r?void 0:r.emit)||void 0===o||(e=o).call.apply(e,[r,t].concat(s)),(i=Xs(de(n.prototype),"emit",this)).call.apply(i,[this,t].concat(s))}},{key:"emitGrammarEvent",value:function(t){for(var e,i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return(e=Xs(de(n.prototype),"emit",this)).call.apply(e,[this,t].concat(r))}},{key:"evaluateTransform",value:function(e,i,n){return sz(this,void 0,void 0,oz().mark((function r(){var o,a,s,l;return oz().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e&&e.length){r.next=2;break}return r.abrupt("return",i);case 2:o=i,a=0,s=e.length;case 4:if(!(a<s)){r.next=17;break}if(l=e[a],this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_TRANSFORM,l.type),o=l.transform(l.isRawOptions?l.options:rz(l.options,n),o,n,this.view),r.t0=null==o?void 0:o.then,!r.t0){r.next=13;break}return r.next=12,o;case 12:o=r.sent;case 13:a++,this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_TRANSFORM,l.type);case 15:r.next=4;break;case 17:return r.abrupt("return",o);case 18:case"end":return r.stop()}}),r,this)})))}},{key:"evaluateTransformSync",value:function(e,i,n){if(!e||!e.length)return i;for(var r=i,o=0,a=e.length;o<a;){var s=e[o];this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_TRANSFORM,s.type),r=s.transform(s.isRawOptions?s.options:rz(s.options,n),r,n,this.view),o++,this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_TRANSFORM,s.type)}return r}},{key:"set",value:function(t){return!1}},{key:"id",value:function(t){return arguments.length?(this.view.grammars.unrecord(this),this._id=t,this.view.grammars.record(this),this):this._id}},{key:"name",value:function(t){return arguments.length?(this._name=t,this):this._name}},{key:"attach",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return lt(t).filter((function(t){return!w(t)})).forEach((function(n){var r;w(t)||(n.targets.includes(e)||n.targets.push(e),e.references.set(n,(null!==(r=e.references.get(n))&&void 0!==r?r:0)+i))})),this}},{key:"detach",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return lt(t).filter((function(t){return!w(t)})).forEach((function(t){var n=e.references.get(t)-i;n>0?e.references.set(t,n-1):(e.references.delete(t),t.targets.includes(e)&&(t.targets=t.targets.filter((function(t){return t!==e}))))})),this}},{key:"detachAll",value:function(){var t=this;this.references.forEach((function(e,i){t.detach(i,e)}))}},{key:"link",value:function(t){this.grammarSource=t}},{key:"run",value:function(){var t,e=null===(t=this.grammarSource)||void 0===t?void 0:t.output(),i=this.parameters();return this.evaluate(e,i)}},{key:"runSync",value:function(){var t,e=null===(t=this.grammarSource)||void 0===t?void 0:t.output(),i=this.parameters();return this.evaluateSync?this.evaluateSync(e,i):this.evaluate(e,i)}},{key:"commit",value:function(){this.view.commit(this)}},{key:"parameters",value:function(){var t={};return this.references.forEach((function(e,i){T(i.id())&&(t[i.id()]=i.output())})),t}},{key:"getSpec",value:function(){return this.spec}},{key:"reuse",value:function(t){return this}},{key:"clear",value:function(){this.spec=null,this.view=null}},{key:"release",value:function(){this.clear()}},{key:"setFunctionSpec",value:function(t,e){return w(this.spec[e])||this.detach(rT(this.spec[e],this.view)),this.spec[e]=t,this.attach(rT(t,this.view)),this.commit(),this}}]),n}(x),cz=function(t,e,i){var n,r;if("callback"===t&&A(e))return{references:[],value:{callback:e,dependency:[]}};if(!w(e.data)){var o=i.getDataById(e.data);return{references:[o],value:o}}if(!w(e.customized)){var a=i.getCustomizedById(e.customized);return{references:[a],value:a}}if(!w(e.scale)){var s=i.getScaleById(e.scale);return{references:[s],value:s}}if((r=e)&&(r.signal||r.callback)){var l=rT(e,i);return{references:l,value:e.callback?{value:e.callback,dependency:l}:null!==(n=null==l?void 0:l[0])&&void 0!==n?n:e}}return{value:e}},hz=function(t,e){var i=gT.getTransform(t.type);if(i){var n={},r=[];return Object.keys(t).forEach((function(i){var o;if("type"!==i){var a=t[i];if("dependency"!==i){var s=function(t,e,i){if(w(e))return{value:e};if(B(e)){var n=e.map((function(e){return cz(t,e,i)}));return{references:n.reduce((function(t,e){return e.references&&t.concat(e.references),t}),[]),value:n.map((function(t){return t.value}))}}return cz(t,e,i)}(i,a,e);s&&((null===(o=s.references)||void 0===o?void 0:o.length)&&(r=r.concat(s.references)),n[i]=s.value)}else(null==a?void 0:a.length)&&(r=r.concat(nT(a,e)))}})),{markPhase:i.markPhase,transform:i.transform,canProgressive:i.canProgressive,type:i.type,options:n,references:r}}},dz=function(t,e){if(null==t?void 0:t.length){var i=[],n=[];return t.forEach((function(t){var r,o=hz(t,e);o&&((null===(r=o.references)||void 0===r?void 0:r.length)&&(n=n.concat(o.references)),i.push(o))})),{transforms:i,refs:n}}return null};function fz(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */fz=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var pz=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},vz={csv:ta,dsv:$o,tsv:ea,json:function(t){if(!P(t))return lt(t);try{return lt(JSON.parse(t))}catch(t){return[]}}};function yz(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */yz=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function gz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var mz=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},_z=function(e){ue(n,e);var i=gz(n);function n(e,r,o){var a;return jt(this,n),(a=i.call(this,e)).grammarType="data",a.spec={},a._dataIDKey="VGRAMMAR_DATA_ID_KEY_".concat(a.uid),a._loadTasks=[],a._postFilters=[],a.ingest=function(t){var e=sT(t.format,a.parameters());return a._input=function(t,e){if(!e||!vz[e.type])return lt(t);var i="dsv"===e.type?{delimiter:e.delimiter}:{};return vz[e.type](t,i,new Ma(new wa))}(t.values,e),a._input},a.load=function(t){var e;if(t.values)return a.ingest(t);var i=sT(t.url,a.parameters()),n=null!==(e=sT(t.format,a.parameters()))&&void 0!==e?e:{type:"json"};return function(t){return pz(void 0,void 0,void 0,fz().mark((function e(){return fz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return e.abrupt("return",e.sent.text());case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}(i).then((function(t){return a.ingest({values:t,format:n})}))},a.relay=function(t){return t[0]},a.evaluateSync=function(e,i){a.view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_EVALUATE_DATA);var n=a._isLoaded?a.transforms:a._loadTasks.concat(a.transforms),r=a.evaluateTransformSync(n,a.grammarSource?e:a._input,i),o=a._evaluateFilter(r,i);return a.setValues(o),a._isLoaded=!0,a.view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_EVALUATE_DATA),ce(a)},a._loadTasks=[],w(r)||a.values(r,o),a}return zt(n,[{key:"parse",value:function(t){return Xs(de(n.prototype),"parse",this).call(this,t),this._isLoaded=!1,this.source(t.source,t.format,!1),this.url(t.url,t.format,!1),this.values(t.values,t.format,!1),this.transform(t.transform),this.parseLoad(t),this.commit(),this}},{key:"parseDataSource",value:function(t){var e=this,i=[],n=[],r=t.format?rT(t.format,this.view)[0]:null;if(r&&i.push(r),t.values){var o=rT(t.values,this.view)[0];o&&i.push(o),n.push({type:"ingest",transform:this.ingest,isRawOptions:!0,options:{values:t.values,format:t.format}})}else if(t.url){var a=rT(t.url,this.view)[0];a&&i.push(a),n.push({type:"load",transform:this.load,options:{url:null!=a?a:t.url,format:null!=r?r:t.format}})}else if(t.source){var s=[];lt(t.source).forEach((function(t){var n=uT(t)?t:e.view.getDataById(t);n&&(i.push(n),s.push(n))})),s.length&&(n.push({type:"relay",transform:this.relay,options:s}),this.grammarSource=s[0])}return{transforms:n,refs:i}}},{key:"evaluate",value:function(e,i){return mz(this,void 0,void 0,yz().mark((function n(){var r,o,a;return yz().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_EVALUATE_DATA),r=this._isLoaded?this.transforms:this._loadTasks.concat(this.transforms),this.grammarSource&&(this._input=e),n.next=5,this.evaluateTransform(r,this._input,i);case 5:return o=n.sent,a=this._evaluateFilter(o,i),n.abrupt("return",(this.setValues(a),this._isLoaded=!0,this.view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_EVALUATE_DATA),this));case 8:case"end":return n.stop()}}),n,this)})))}},{key:"output",value:function(){return this._values}},{key:"getDataIDKey",value:function(){return this._dataIDKey}},{key:"values",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{values:t,format:e});return w(t)||(n.url=void 0,n.source=void 0),i?this.parseLoad(n):this}},{key:"url",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{url:t,format:e});return w(t)||(n.values=void 0,n.source=void 0),i?this.parseLoad(n):this}},{key:"source",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Object.assign({},this.spec,{source:t,format:e});return w(t)||(n.values=void 0,n.url=void 0),i?this.parseLoad(n):this}},{key:"parseLoad",value:function(t){this.detach(this.parseDataSource(this.spec).refs),this.spec=t;var e=this.parseDataSource(this.spec);return this.attach(e.refs),this._loadTasks=e.transforms,this._isLoaded=!1,this.commit(),this}},{key:"setValues",value:function(t){var e=this;this._values=lt(t).map((function(t,i){var n=t===Object(t)?t:{data:t};return n[e._dataIDKey]=i,n}))}},{key:"field",value:function(t){return this._values.map((function(e){return e[t]}))}},{key:"transform",value:function(t){var e=dz(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]),this.spec.transform=t;var i=dz(this.spec.transform,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.commit(),this}},{key:"getValue",value:function(){return this._values}},{key:"getInput",value:function(){return this._input}},{key:"addDataFilter",value:function(t){return this._postFilters=this._postFilters.concat(lt(t)),this._postFilters.sort((function(t,e){var i,n;return(null!==(i=t.rank)&&void 0!==i?i:0)-(null!==(n=e.rank)&&void 0!==n?n:0)})),this}},{key:"removeDataFilter",value:function(t){var e=lt(t);return this._postFilters=this._postFilters.filter((function(t){return!e.includes(t)})),this}},{key:"_evaluateFilter",value:function(t,e){return this._postFilters.reduce((function(t,i){return i.filter(t,e)}),t)}},{key:"reuse",value:function(t){return t.grammarType!==this.grammarType||(this._isLoaded=!1,this._values=t.output()),this}},{key:"clear",value:function(){Xs(de(n.prototype),"clear",this).call(this),this._input=null,this._values=null}}]),n}(uz),bz="window",xz="view",kz={trap:!1},Sz="width",Az="height",wz="viewWidth",Tz="viewHeight",Mz="padding",Cz="viewBox",Ez="autoFit";function Rz(t,e,i,n){for(var r,o,a=t[e];e>i&&(r=t[o=Math.floor((e-1)/2)],a&&r&&n(a,r)<0);)t[e]=r,e=o;return t[e]=a}function Pz(t,e,i,n){for(var r,o=e,a=null!=i?i:t.length,s=t[e],l=2*e+1;l<a;)(r=l+1)<a&&n(t[l],t[r])>=0&&(l=r),t[e]=t[l],l=2*(e=l)+1;return t[e]=s,Rz(t,e,o,n)}var Bz=function(){function t(e){jt(this,t),this.compare=e,this.nodes=[]}return zt(t,[{key:"size",value:function(){return this.nodes.length}},{key:"last",value:function(){return this.nodes[0]}},{key:"validate",value:function(){for(var t=this.nodes.length-1;t>0;t-=1){var e=Math.floor((t-1)/2);if(this.compare(this.nodes[e],this.nodes[t])>0)return!1}return!0}},{key:"push",value:function(t){if(this.nodes.includes(t)){var e=this.nodes.indexOf(t);return Rz(this.nodes,e,0,this.compare),Pz(this.nodes,e,null,this.compare)}return this.nodes.push(t),Rz(this.nodes,this.nodes.length-1,0,this.compare)}},{key:"remove",value:function(t){if(this.nodes.includes(t)){var e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e).concat(this.nodes.slice(e+1)),Rz(this.nodes,e,0,this.compare),Pz(this.nodes,e,null,this.compare)}}},{key:"pop",value:function(){var t,e=this.nodes.pop();return this.nodes.length?(t=this.nodes[0],this.nodes[0]=e,Pz(this.nodes,0,null,this.compare)):t=e,t}},{key:"clear",value:function(){this.nodes=[]}}]),t}(),Lz=function(){function t(e){jt(this,t),this.list=[],this.ids={},this.idFunc=e||oS}return zt(t,[{key:"add",value:function(t){var e=this.idFunc(t);return this.ids[e]||(this.ids[e]=1,this.list.push(t)),this}},{key:"remove",value:function(t){var e=this.idFunc(t);return this.ids[e]&&(this.ids[e]=0,this.list=this.list.filter((function(e){return e!==t}))),this}},{key:"forEach",value:function(t,e){e?this.list.slice().reverse().forEach(t):this.list.forEach(t)}},{key:"filter",value:function(t){return this.list.filter(t)}},{key:"length",get:function(){return this.list.length}},{key:"getElementByIndex",value:function(t){return this.list[t]}}]),t}();function Oz(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Oz=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var Iz=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},Dz=function(){function t(){jt(this,t),this.grammars=[],this.logger=gi.getInstance(),this._curRank=0,this._committed=new Lz((function(t){return t.uid})),this._heap=new Bz((function(t,e){return(null==t?void 0:t.qrank)-(null==e?void 0:e.qrank)})),this._beforeRunner=null,this._afterRunner=null,this._isRunning=!1,this._updateCounter=0,this._finishFirstRender=!1}return zt(t,[{key:"asyncCallback",value:function(t){return Iz(this,void 0,void 0,Oz().mark((function e(){return Oz().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(this);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.logger.error(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"add",value:function(t){if(t)return this._setRankOfGrammar(t),this.commit(t),!this.grammars.includes(t)&&(this.grammars.push(t),!0)}},{key:"remove",value:function(t){t&&(this._committed.remove(t),this._heap.remove(t),this.grammars=this.grammars.filter((function(e){return e!==t})))}},{key:"_setRankOfGrammar",value:function(t){t&&(t.rank=++this._curRank)}},{key:"_reRank",value:function(t){for(var e=this,i=[t];i.length;){var n=i.pop();this._setRankOfGrammar(n);var r=n.targets;r&&r.forEach((function(n){i.push(n),n===t&&e.logger.error("Cycle detected in dataflow graph.")}))}}},{key:"_enqueue",value:function(t){t&&(t.qrank=t.rank,this._heap.push(t))}},{key:"_logGrammarRunInfo",value:function(t){if(this.logger.canLogError()){var e=[{key:"id",value:t.id()},{key:"name",value:t.name()}].reduce((function(t,e,i){return w(e.value)?t:"".concat(t).concat(i?" , ":"").concat(e.key,": ").concat(e.value)}),"");this.logger.debug("Run Operator: ",t,e)}}},{key:"hasCommitted",value:function(){return!!this._committed.length}},{key:"commit",value:function(t){return this._isRunning?this._enqueue(t):this._committed.add(t),this}},{key:"_beforeEvaluate",value:function(){var t=this;this.grammars.forEach((function(e){e.targets.some((function(t){return(null==t?void 0:t.rank)<(null==e?void 0:e.rank)}))&&t._reRank(e)})),this._committed.forEach((function(e){return t._enqueue(e)})),this._committed=new Lz((function(t){return t.uid}))}},{key:"_enqueueTargets",value:function(t){var e=this;t.targets&&t.targets.length&&this._finishFirstRender&&t.targets.forEach((function(t){return e._enqueue(t)}))}},{key:"evaluate",value:function(){return Iz(this,void 0,void 0,Oz().mark((function t(){var e,i,n,r,o;return Oz().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isReleased){t.next=2;break}return t.abrupt("return");case 2:if(t.t0=this._beforeRunner,!t.t0){t.next=6;break}return t.next=6,this.asyncCallback(this._beforeRunner);case 6:if(this._committed.length){t.next=8;break}return t.abrupt("return",(this.logger.info("Dataflow invoked, but nothing to do."),!1));case 8:this._isRunning=!0,this._updateCounter+=1,o=0,this.logger.canLogInfo()&&(n=Date.now(),this.logger.debug("-- START PROPAGATION (".concat(this._updateCounter,") -----"))),this._beforeEvaluate(),t.prev=11;case 12:if(!(this._heap.size()>0)||this._isReleased){t.next=29;break}if(!(e=this._heap.pop())){t.next=27;break}if(e.rank!==e.qrank){t.next=26;break}if(i=e.run(),t.t1=i&&i.then,!t.t1){t.next=21;break}return t.next=20,i;case 20:i=t.sent;case 21:if(this._isRunning){t.next=23;break}return t.abrupt("return",!1);case 23:this._logGrammarRunInfo(e),this._enqueueTargets(e),o+=1,t.next=27;break;case 26:this._enqueue(e);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t2=t.catch(11),this._heap.clear(),r=t.t2;case 34:if(t.t3=!this._isReleased,!t.t3){t.next=48;break}if(this._isRunning=!1,this.logger.canLogInfo()&&(n=Date.now()-n,this.logger.info("> ".concat(o," grammars; ").concat(n," ms"))),!r){t.next=42;break}this.logger.error(r),t.next=46;break;case 42:if(t.t4=this._afterRunner,!t.t4){t.next=46;break}return t.next=46,this.asyncCallback(this._afterRunner);case 46:this._finishFirstRender=!0,t.t3=!0;case 48:return t.abrupt("return",t.t3);case 49:case"end":return t.stop()}}),t,this,[[11,31]])})))}},{key:"evaluateSync",value:function(){if(this._beforeRunner&&this._beforeRunner(this),!this._committed.length)return this.logger.info("Dataflow invoked, but nothing to do."),!1;this._isRunning=!0,this._updateCounter+=1;var t,e,i=0;for(this.logger.canLogInfo()&&(e=Date.now(),this.logger.debug("-- START PROPAGATION (".concat(this._updateCounter,") -----"))),this._beforeEvaluate();this._heap.size()>0;)(t=this._heap.pop())&&(t.rank===t.qrank?(t.runSync(),this._logGrammarRunInfo(t),this._enqueueTargets(t),i+=1):this._enqueue(t));return this._isRunning=!1,this.logger.canLogInfo()&&(e=Date.now()-e,this.logger.info("> ".concat(i," grammars updated; ").concat(e," ms"))),this._afterRunner&&this._afterRunner(this),this._finishFirstRender=!0,!0}},{key:"stop",value:function(){this._isRunning&&(this._isRunning=!1)}},{key:"runBefore",value:function(t){this._beforeRunner=t}},{key:"runAfter",value:function(t){this._afterRunner=t}},{key:"release",value:function(){this.stop(),this._isReleased=!0,this._heap&&(this._heap.clear(),this._heap=null),this.logger=null,this._committed=null}}]),t}(),Fz=function(t,e,i,n,r){!function t(o){if(r||!o||n&&!n(o)||i.call(null,o),o.markType===sw.group){var a=o[e];a&&a.forEach((function(e){t(e)}))}r&&(!o||n&&!n(o)||i.call(null,o))}(t)},zz=function(){function e(i){var n=this;jt(this,e),this.handleAfterNextRender=function(){n._stage&&!n._viewOptions.disableDirtyBounds&&n._stage.enableDirtyBounds(),n._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_VRENDER_DRAW),n._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_VRENDER_NEXT_RENDER)},this._view=i}return zt(e,[{key:"initialize",value:function(t,e,i,n){return this._width=t,this._height=e,this._viewOptions=i,this._eventConfig=n,this.initStage(),this}},{key:"stage",value:function(){var t;return null!==(t=this._stage)&&void 0!==t?t:null}},{key:"gestureController",value:function(){var t;return null!==(t=this._gestureController)&&void 0!==t?t:null}},{key:"canvas",value:function(){return this._stage?this._stage.window.getNativeHandler().nativeCanvas:null}},{key:"context",value:function(){return this._stage?this._stage.window.getContext().nativeContext:null}},{key:"combineIncrementalLayers",value:function(){var t=this;return this._stage&&function(t){return Ed(this,void 0,void 0,Cd().mark((function e(){var i,n;return Cd().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],n=t.getChildren(),e.next=3,new Promise((function(t){nu.global.getRequestAnimationFrame()((function(){t(null)}))}));case 3:return n.forEach((function(t){t.subLayers.size&&t.subLayers.forEach((function(t){t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&i.push(new Promise((function(e){t.drawContribution.hooks.completeDraw.tap("outWait",(function(){t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter((function(t){return"outWait"!==t.name})),e(null)}))})))}))})),e.next=6,Promise.all(i);case 6:case"end":return e.stop()}}),e)})))}(this._stage).then((function(){t._stage&&t._stage.defaultLayer.combineSubLayer()})),this}},{key:"background",value:function(t){if(this._stage)return this._stage.background=t,this}},{key:"setDpr",value:function(t,e){var i,n;return null===(n=null===(i=this._stage)||void 0===i?void 0:i.setDpr)||void 0===n||n.call(i,t),e&&this.renderNextFrame(),this}},{key:"shouldResize",value:function(t,e){return t!==this._width||e!==this._height}},{key:"resize",value:function(e,i){return this._view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_STAGE_RESIZE),this.shouldResize(e,i)&&(this._width=e,this._height=i,this._stage&&this._stage.resize(e,i)),this._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_STAGE_RESIZE),this}},{key:"setViewBox",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._stage?(!t||this._viewBox&&t.x1===this._viewBox.x1&&t.x2===this._viewBox.x2&&t.y1===this._viewBox.y1&&t.y2===this._viewBox.y2||(this._viewBox=t,this._stage.setViewBox(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1,e)),this):this}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_VRENDER_DRAW),this.initStage(),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this.handleAfterNextRender),e&&(this._stage.render(),this._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_VRENDER_DRAW)),this}},{key:"renderNextFrame",value:function(){return this.initStage(),this._stage.renderNextFrame(),this}},{key:"toCanvas",value:function(){return this._stage?this._stage.toCanvas():null}},{key:"preventRender",value:function(t){this._stage&&this._stage.preventRender(t)}},{key:"release",value:function(){var t;this._view.traverseMarkTree((function(t){t.release()})),this._dragController&&this._dragController.release(),this._gestureController&&this._gestureController.release(),this._stage!==(null===(t=this._viewOptions)||void 0===t?void 0:t.stage)&&this._stage.release(),this._stage=null,this._layer=null,this._dragController=null,this._gestureController=null}},{key:"createStage",value:function(){var e,i,n,r,o;this._view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_CREATE_VRENDER_STAGE);var a,s=this._viewOptions,l=null!==(e=s.stage)&&void 0!==e?e:(a={width:this._width,height:this._height,renderStyle:s.renderStyle,viewBox:s.viewBox,dpr:s.dpr,canvas:s.renderCanvas,canvasControled:s.canvasControled,container:s.container,title:s.rendererTitle,beforeRender:s.beforeRender,afterRender:s.afterRender,disableDirtyBounds:!0,autoRender:!0,pluginList:s.pluginList,enableHtmlAttribute:s.enableHtmlAttribute,optimize:s.optimize,supportsTouchEvents:s.supportsTouchEvents,supportsPointerEvents:s.supportsPointerEvents},new Lx(a));(null===(i=s.options3d)||void 0===i?void 0:i.enable)&&l.set3dOptions(s.options3d),l.enableIncrementalAutoRender(),this._viewBox=s.viewBox,this._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_CREATE_VRENDER_STAGE),this._view.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_CREATE_VRENDER_LAYER);var u=null!==(n=s.layer)&&void 0!==n?n:l.defaultLayer;if(this._view.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_CREATE_VRENDER_LAYER),(null===(r=this._eventConfig)||void 0===r?void 0:r.drag)&&(this._dragController=new IT(l)),null===(o=this._eventConfig)||void 0===o?void 0:o.gesture){var c=M(this._eventConfig.gesture)?this._eventConfig.gesture:{};this._gestureController=new jT(l,c)}return{stage:l,layer:u}}},{key:"initStage",value:function(){if(!this._stage){var t=this.createStage(),e=t.stage,i=t.layer;this._stage=e,this._layer=i;var n=this._view.background();this.background(n)}}}]),e}();function jz(t){return w(t.offsetX)?w(t.x)?t.changedTouches&&t.changedTouches.length?function(t){return{canvasX:t.changedTouches[0].x,canvasY:t.changedTouches[0].y}}(t):{canvasX:0,canvasY:0}:function(t){return{canvasX:t.x,canvasY:t.y}}(t):function(t){return{canvasX:t.offsetX,canvasY:t.offsetY}}(t)}function Hz(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return F(e.canvasX)&&Object.defineProperty(t,"canvasX",{value:e.canvasX,writable:!0}),F(e.canvasY)&&Object.defineProperty(t,"canvasY",{value:e.canvasY,writable:!0}),i&&F(e.clientX)&&Object.defineProperty(t,"clientX",{value:e.clientX,writable:!0}),i&&F(e.clientY)&&Object.defineProperty(t,"clientY",{value:e.clientY,writable:!0}),[e.canvasX,e.canvasY]}function Nz(t,e,i,n,r){r===bz&&function(t){["touches","changedTouches","targetTouches"].forEach((function(e){t[e]&&t[e].length&&Array.from(t[e]).forEach((function(t){Hz(t,jz(t),!1)}))}));var e=jz(t);Hz(t,e)}(e.changedTouches?e.changedTouches[0]:e);return e.element=i,e}function Vz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Gz=function(t){ue(i,t);var e=Vz(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments)).grammarType="signal",t.spec={value:null,update:null},t}return zt(i,[{key:"parse",value:function(t){return Xs(de(i.prototype),"parse",this).call(this,t),this.value(t.value),this.update(t.update),this.commit(),this}},{key:"evaluate",value:function(t,e){return this._signal=this.spec.update?aT(this.spec.update,e,this._signal):this.spec.value,this.spec.value=this._signal,this}},{key:"output",value:function(){return this._signal}},{key:"getValue",value:function(){return this.output()}},{key:"set",value:function(t){if(B(t)&&B(this.value)&&t.length===this.value.length){for(var e=0;e<t.length;e++)if(this.value[e]!==t[e])return this._signal=t,this.spec.value=t,!0;return!1}return this._signal!==t&&(this._signal=t,this.spec.value=t,!0)}},{key:"update",value:function(t){return w(t)||this.value(void 0),this.setFunctionSpec(t,"update")}},{key:"value",value:function(t){return w(t)||this.update(void 0),this.spec.value=t,this.commit(),this}},{key:"reuse",value:function(t){return t.grammarType!==this.grammarType||(this._signal=t.output()),this}},{key:"clear",value:function(){Xs(de(i.prototype),"clear",this).call(this),this._signal=null}}]),i}(uz),Wz=-1,Uz=[Sz,Az,Mz,wz,Tz,Cz,Ez],Yz=function(t){var e,i,n,r;return I(t)?{top:t,bottom:t,left:t,right:t}:{top:null!==(e=null==t?void 0:t.top)&&void 0!==e?e:0,bottom:null!==(i=null==t?void 0:t.bottom)&&void 0!==i?i:0,left:null!==(n=null==t?void 0:t.left)&&void 0!==n?n:0,right:null!==(r=null==t?void 0:t.right)&&void 0!==r?r:0}},Kz=function(t){var e,i=function t(e,i){var n,r;e.group=i;var o=null!==(n=e.id)&&void 0!==n?n:"VGRAMMAR_MARK_"+ ++Wz;e.id=o,(null!==(r=e.marks)&&void 0!==r?r:[]).forEach((function(e){return t(e,o)}))};return(null!==(e=t.marks)&&void 0!==e?e:[]).forEach((function(t){return i(t,"root")})),t},Xz=function(t){var e,i,n,r,o,a=null!=t?t:{},s=a.reuse,l=void 0===s||s,u=a.morph,c=void 0===u||u,h=a.morphAll,d=void 0!==h&&h,f=a.animation,p=void 0===f?{}:f,v=a.enableExitAnimation,y=void 0===v||v;return{reuse:l,morph:c,morphAll:d,animation:{easing:null!==(e=p.easing)&&void 0!==e?e:eT,delay:null!==(i=p.delay)&&void 0!==i?i:Jw,duration:null!==(n=p.duration)&&void 0!==n?n:qw,oneByOne:null!==(r=p.oneByOne)&&void 0!==r?r:tT,splitPath:null!==(o=p.splitPath)&&void 0!==o?o:null},enableExitAnimation:y}},Zz=function(t,e){return e&&e.debounce?Pt(t,e.debounce):e&&e.throttle?Bt(t,e.throttle):t};function qz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Jz=function(e){ue(n,e);var i=qz(n);function n(t){var e;return jt(this,n),(e=i.call(this,t)).getStateAttrs=function(t,i){var n,r,o,a=!w(null===(n=e.runtimeStatesEncoder)||void 0===n?void 0:n[t]),s=a?e.runtimeStatesEncoder[t]:null===(r=e.mark.getSpec().encode)||void 0===r?void 0:r[t],l={};if(!s)return l;if(A(s))return l.attributes=s(e.getDatum(),ce(e),t,i),l;if(!a&&(null===(o=e.graphicItem.glyphStates)||void 0===o?void 0:o[t]))return e.graphicItem.glyphStates[t];if(s){var u=e.items[0],c=[Object.assign({},u,{nextAttrs:{}})];return mT(ce(e),c,s,e.mark.parameters()),e.coordinateTransformEncode(c),l.attributes=c[0].nextAttrs,e.graphicItem.glyphStates?e.graphicItem.glyphStates[t]||(e.graphicItem.glyphStates[t]=l):e.graphicItem.glyphStates=v({},t,l),l}return l},e.glyphMeta=e.mark.getGlyphMeta(),e}return zt(n,[{key:"getGlyphGraphicItems",value:function(){return this.glyphGraphicItems}},{key:"initGraphicItem",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.graphicItem){this.graphicItem=this.mark.addGraphicItem(e,this.groupKey),this.graphicItem[Vw]=this,this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1);var i=this.glyphMeta.getMarks();this.glyphGraphicItems={},this.graphicItem.getSubGraphic().forEach((function(e){var n=i[e.name];t.glyphGraphicItems[e.name]=e,e.onBeforeAttributeUpdate=function(i){return t.mark?TT(n,i,t,e.name):i}})),this.clearGraphicAttributes()}}},{key:"useStates",value:function(e,i){if(!this.graphicItem)return!1;this.mark.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ELEMENT_STATE,{states:e},this),this.states=e.slice();var n=S(i)?i:0!==this.mark.animate.getAnimationConfigs("state").length;return this.graphicItem.glyphStateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,n),this.mark.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_STATE,{states:e},this),!0}},{key:"encodeGraphic",value:function(){this.coordinateTransformEncode(this.items);var t=this.transformElementItems(this.items,this.mark.markType);this.graphicItem||this.initGraphicItem(),this.diffState===aw.enter?(this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!0),this.applyGraphicAttributes(t),this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1)):this.applyGraphicAttributes(t),this.diffState!==aw.enter&&this.diffState!==aw.update||!this.states.length||(Object.values(this.glyphGraphicItems).forEach((function(t){t.states={}})),this.useStates(this.states)),this.items.map((function(t){t.nextAttrs={}}))}},{key:"encodeCustom",value:function(t){var e,i,n=this,r={},o=this.glyphMeta.getChannelEncoder(),a=this.glyphMeta.getFunctionEncoder();(a&&(r=a.call(null,Object.assign({},null===(e=this.graphicItem)||void 0===e?void 0:e.attribute,t),this.getDatum(),this,this.mark.getGlyphConfig())),o)&&Object.keys(o).forEach((function(e){var a;if(!w(t[e])){i||(i=Object.assign({},null===(a=n.graphicItem)||void 0===a?void 0:a.attribute,t));var s=o[e].call(null,e,t[e],i,n.getDatum(),n,n.mark.getGlyphConfig());Object.keys(null!=s?s:{}).forEach((function(t){var e;r[t]=Object.assign(null!==(e=r[t])&&void 0!==e?e:{},s[t])}))}}));return r}},{key:"encodeDefault",value:function(){var t={};if(this.diffState===aw.enter&&this.glyphMeta.getDefaultEncoder()){var e=this.glyphMeta.getDefaultEncoder().call(null,this.getDatum(),this,this.mark.getGlyphConfig());Object.assign(t,e)}return t}},{key:"_onGlyphAttributeUpdate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(i){if(!t.mark)return i;var n=t.glyphMeta.getMarks(),r=TT(t.mark.getAttributeTransforms(),i,t),o=e?t.encodeDefault():null,a=t.encodeCustom(i);return Object.keys(n).forEach((function(r){var s=n[r],l=t.glyphGraphicItems[r],u=null==a?void 0:a[r],c=Object.assign({},u);if(e){var h=null==o?void 0:o[r];Object.keys(null!=h?h:{}).forEach((function(e){K(t.items[0].nextAttrs,e)||K(c,e)||(c[e]=h[e])}))}var d=Object.assign({},function(t,e){var i;return(null!==(i=wT[t])&&void 0!==i?i:[]).reduce((function(t,i){return i.channels.forEach((function(i){K(e,i)&&(t[i]=e[i])})),t}),{})}(s,i),c),f=t._generateGlyphItems(s,t.items,d);t.coordinateTransformEncode(f);var p=t.transformElementItems(f,s);t.applyGlyphGraphicAttributes(p,r,l),s===sw.shape&&(l.datum=f[0].datum)})),r}}},{key:"_generateGlyphItems",value:function(t,e,i){var n=e.map((function(t){return Object.assign({},t,{nextAttrs:i})}));return Gw.includes(t)&&this.mark.getSpec().enableSegments&&n.forEach((function(t,n){t.nextAttrs=Object.assign({},e[n].nextAttrs,i)})),n}},{key:"getGraphicAttribute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.graphicItem){var n=this.getPrevGraphicAttributes(i);return e&&K(n,t)?n[t]:(i?this.glyphGraphicItems[i]:this.graphicItem).attribute[t]}}},{key:"setGraphicAttribute",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;if(this.graphicItem){var r=n?this.glyphGraphicItems[n]:this.graphicItem,o=this.getFinalGraphicAttributes(n),a=this.getPrevGraphicAttributes(n);i&&(o[t]=e),K(a,t)||(a[t]=r.attribute[t]),r.setAttribute(t,e)}}},{key:"setGraphicAttributes",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.graphicItem){var n=i?this.glyphGraphicItems[i]:this.graphicItem,r=this.getFinalGraphicAttributes(i),o=this.getPrevGraphicAttributes(i);Object.keys(t).forEach((function(i){e&&(r[i]=t[i]),K(o,i)||(o[i]=n.attribute[i])})),n.setAttributes(t)}}},{key:"diffAttributes",value:function(t,e){var i={},n=this.getFinalGraphicAttributes(e);for(var r in t)uS(r,n,t)||(i[r]=t[r]);return i}},{key:"applyGlyphGraphicAttributes",value:function(t,e,i){var n,r;if(this.mark.needAnimate()){var o=this.diffAttributes(t,e),a=null!==(n=this.getPrevGraphicAttributes(e))&&void 0!==n?n:{},s=null!==(r=this.getFinalGraphicAttributes(e))&&void 0!==r?r:{};Object.keys(o).forEach((function(t){a[t]=i.attribute[t],s[t]=o[t]})),this.setNextGraphicAttributes(o,e),this.setPrevGraphicAttributes(a,e),this.setFinalGraphicAttributes(s,e),i.setAttributes(o)}else i.setAttributes(t)}},{key:"getFinalGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).finalAttrs}},{key:"setFinalGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).finalAttrs=t}},{key:"getPrevGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).prevAttrs}},{key:"setPrevGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).prevAttrs=t}},{key:"getNextGraphicAttributes",value:function(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).nextAttrs}},{key:"setNextGraphicAttributes",value:function(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).nextAttrs=t}},{key:"clearChangedGraphicAttributes",value:function(){var t=this;this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach((function(e){t.setPrevGraphicAttributes(null,e),t.setNextGraphicAttributes(null,e)}))}},{key:"clearGraphicAttributes",value:function(){var t=this;this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),this.setFinalGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach((function(e){t.setPrevGraphicAttributes(null,e),t.setNextGraphicAttributes(null,e),t.setFinalGraphicAttributes(null,e)}))}},{key:"remove",value:function(){this.glyphGraphicItems=null,Xs(de(n.prototype),"remove",this).call(this)}},{key:"release",value:function(){this.glyphGraphicItems&&(Object.values(this.glyphGraphicItems).forEach((function(t){t[Vw]=null})),this.glyphGraphicItems=null),Xs(de(n.prototype),"release",this).call(this)}}]),n}(PT),Qz=function(t){return t.markType===sw.glyph?new Jz(t):new PT(t)};function $z(t,e,i){var n=new Map;if(!t||0===t.length)return{keys:[],data:n};if(!e)return n.set(Uw,i?t.slice().sort(i):t.slice()),{keys:Kw,data:n};var r=cT(e);if(1===t.length){var o=r(t[0]);return n.set(o,[t[0]]),{keys:[o],data:n}}var a=new Set;return t.forEach((function(t){var e,i=r(t),o=null!==(e=n.get(i))&&void 0!==e?e:[];o.push(t),n.set(i,o),a.add(i)})),i&&a.forEach((function(t){n.get(t).sort(i)})),{keys:Array.from(a),data:n}}var tj=function(){function t(e,i,n){jt(this,t),this.prevData=(null==e?void 0:e.length)?$z(e,null!=i?i:null,n):null}return zt(t,[{key:"setCurrentData",value:function(t){this.currentData=t}},{key:"getCurrentData",value:function(){return this.currentData}},{key:"doDiff",value:function(){var t=this;if(this.callback)if(this.currentData&&this.prevData){var e=new Map(this.prevData.data);this.currentData.keys.forEach((function(i){t.callback(i,t.currentData.data.get(i),e.get(i)),e.delete(i)})),this.prevData.keys.forEach((function(i){e.has(i)&&t.callback(i,null,e.get(i))}))}else this.currentData?this.currentData.keys.forEach((function(e){t.callback(e,t.currentData.data.get(e),null)})):this.prevData&&this.prevData.keys.forEach((function(e){t.callback(e,null,t.prevData.data.get(e))}))}},{key:"setCallback",value:function(t){this.callback=t}},{key:"updateToCurrent",value:function(){this.prevData=this.currentData,this.currentData=null}},{key:"reset",value:function(){this.prevData=null}}]),t}();function ej(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var ij=function(t,e){if(!t)return null;if(t.from){var i=t.from,n=Object.keys(i);n.forEach((function(t){w(i[t])&&delete i[t]}));var r=pT(n,e.mark.markType)&&!T(i.segments);if(r){var o=e.items.map((function(t){return Object.assign({},t,{nextAttrs:Object.assign({},i)})}));t.from=e.transformElementItems(o,e.mark.markType,r)}}if(t.to){var a=t.to,s=Object.keys(a);s.forEach((function(t){w(a[t])&&delete a[t]}));var l=pT(s,e.mark.markType)&&!T(a.segments);if(l){var u=e.items.map((function(t){return Object.assign({},t,{nextAttrs:Object.assign({},a)})}));t.to=e.transformElementItems(u,e.mark.markType,l)}}return t};var nj=function(t,e,i,n,r){return A(i)?i(t.getDatum(),t,r):i};var rj=function(t){ue(i,t);var e=ej(i);function i(t,n,r,o,a){var s;return jt(this,i),(s=e.call(this,t,n,r,o,a))._interpolator=null==a?void 0:a.interpolator,s._element=null==a?void 0:a.element,s}return zt(i,[{key:"onBind",value:function(){var t,e;this.from=null!==(t=this.from)&&void 0!==t?t:{},this.to=null!==(e=this.to)&&void 0!==e?e:{}}},{key:"getEndProps",value:function(){return this.to}},{key:"onUpdate",value:function(t,e,i){this._interpolator&&this._element&&this._interpolator.call(this,e,this.from,this.to,i,this._element.getDatum(),this._element,this.params.parameters)}}]),i}(Yc),oj=function(t){ue(i,t);var e=ej(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"getEndProps",value:function(){return this.to}},{key:"onBind",value:function(){var t,e;this.from=null!==(t=this.from)&&void 0!==t?t:{},this.to=null!==(e=this.to)&&void 0!==e?e:{}}},{key:"onStart",value:function(){var t,e=this,i=null!==(t=this.target.constructor.NOWORK_ANIMATE_ATTR)&&void 0!==t?t:yd,n=Object.keys(i).filter((function(t){return 0!==i[t]}));this.subAnimate.animate.preventAttrs(n);var r=Object.assign({},this.from),o=Object.assign({},this.to);Object.keys(o).forEach((function(t){n.includes(t)?(r[t]=o[t],e.from[t]=o[t]):w(r[t])&&(r[t]=e.target.getComputedAttribute(t))})),this.target.setAttributes(r,!1,{type:Rs.ANIMATE_UPDATE,animationState:{ratio:0,end:!1}}),this._fromAttribute=r,this._toAttribute=o}},{key:"onEnd",value:function(){this.target.setAttributes(this._toAttribute,!1,{type:Rs.ANIMATE_END})}},{key:"update",value:function(t,e,i){var n=this;0===this.updateCount&&this.onFirstRun(),this.updateCount+=1;var r=this.step.getLastProps();Object.keys(r).forEach((function(t){n.subAnimate.animate.validAttr(t)&&(i[t]=r[t])})),this.onUpdate(t,e,i),t&&this.onEnd()}},{key:"onUpdate",value:function(t,e,i){this.target.stepInterpolate(this.subAnimate,this.subAnimate.animate,i,this.step,e,t,this._toAttribute,this._fromAttribute)}}]),i}(Yc);Xc.mode|=Bs.SET_ATTR_IMMEDIATELY;var aj=0,sj=function(t){return!w(t)&&t.prototype instanceof Yc},lj=function(){function t(e,i,n){jt(this,t),this.id=aj++,this.isAnimating=!1,this.runnings=[],this.element=e,this.animationOptions=n,this.unit=i}return zt(t,[{key:"callback",value:function(t){return this.callbackFunction=t,this}},{key:"animate",value:function(t,e){return this.isAnimating=!0,this.animateElement(t,e),0===this.runnings.length&&this.animationEnd(),this}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.runnings.forEach((function(e){return e.stop(t)})),this.animationEnd(e),this}},{key:"pause",value:function(){return this.runnings.forEach((function(t){return t.pause()})),this}},{key:"resume",value:function(){return this.runnings.forEach((function(t){return t.resume()})),this}},{key:"startAt",value:function(t){var e=this;return this.runnings.forEach((function(i){var n=e.unit.initialDelay;i.startAt(n+t)})),this}},{key:"getTotalAnimationTime",value:function(){var t,e=this.unit.initialDelay+this.unit.loopDuration*this.unit.loopCount;return null!==(t=this.unit.totalTime)&&void 0!==t?t:e}},{key:"getEndAttributes",value:function(){return this.runnings.reduce((function(t,e){return Object.assign(t,e.getEndProps())}),{})}},{key:"animationEnd",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isAnimating=!1,this.runnings=null,e&&(null===(t=this.callbackFunction)||void 0===t||t.call(null))}},{key:"animateElement",value:function(t,e){var i=this,n=this.element.getGraphicItem();if(n){var r=n.animate();this.runnings.push(r),r.startAt(this.unit.initialDelay),r.wait(this.unit.loopDelay),this.unit.timeSlices.forEach((function(n){i.animateTimeSlice(r,n,t,e)})),r.wait(this.unit.loopDelayAfter),r.loop(this.unit.loopCount-1),F(this.unit.totalTime)&&setTimeout((function(){r&&r.stop("end")}),this.unit.totalTime),r.onEnd((function(){i.runnings=i.runnings.filter((function(t){return t!==r})),0===i.runnings.length&&i.animationEnd()}))}}},{key:"animateTimeSlice",value:function(t,e,i,n){var r=this,o=e.delay,a=e.delayAfter,s=e.duration,l=e.effects;if(o>0&&t.wait(o),l.length<0)t.wait(s);else{var u=l.map((function(t,e){var o,a=null!==(o=t.type?function(t,e,i,n){var r=A(e.options)?e.options.call(null,t.getDatum(),t,n):e.options;if(!e.type||!gT.getAnimationType(e.type))return null;var o=gT.getAnimationType(e.type)(t,r,i);return ij(o,t)}(r.element,t,i,n):t.channel?function(t,e,i,n){var r=e.channel,o=null;return B(r)?o=r.reduce((function(e,i){return e.from[i]=t.getGraphicAttribute(i,!0),e.to[i]=t.getGraphicAttribute(i,!1),e}),{from:{},to:{}}):M(r)&&(o=Object.keys(r).reduce((function(e,i){var o,a,s=!w(null===(o=r[i])||void 0===o?void 0:o.from),l=!w(null===(a=r[i])||void 0===a?void 0:a.to);return(s||l)&&(e.from[i]=s?nj(t,0,r[i].from,0,n):void 0,e.to[i]=l?nj(t,0,r[i].to,0,n):t.getGraphicAttribute(i,!1)),e}),{from:{},to:{}})),ij(o,t)}(r.element,t,0,n):void 0)&&void 0!==o?o:{},l=a.custom||(null==t?void 0:t.custom),u=(null==a?void 0:a.customParameters)||(null==t?void 0:t.customParameters);a.from&&Object.keys(a.from).length&&r.unit&&r.animationOptions.timeline.controlOptions.immediatelyApply&&"component"!==r.element.mark.markType&&r.element.getGraphicItem().setAttributes(a.from);var c=sj(l);return w(l)||sj(l)?c?new l(a.from,a.to,s,t.easing,u):a.to?new oj(a.from,a.to,s,t.easing):void 0:new rj(a.from,a.to,s,t.easing,{interpolator:l,element:r.element,parameters:u})})).filter((function(t){return!w(t)}));1===u.length?t.play(u[0]):u.length>1&&t.play(new Ah(s,u))}a>0&&t.wait(a)}}]),t}();function uj(t){var e=[];return Object.keys(t).forEach((function(i){e=e.concat(cj(i,t[i]))})),e}function cj(t,e){var i=[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return lt(e).forEach((function(e){var r,o=function(t){var e,i,n,r,o,a,s,l,u,c,h,d;if(w(t.timeSlices)){var f=t;return{startTime:null!==(e=f.startTime)&&void 0!==e?e:Zw,totalTime:f.totalTime,oneByOne:null!==(i=f.oneByOne)&&void 0!==i?i:tT,loop:null!==(n=f.loop)&&void 0!==n?n:$w,controlOptions:Q({},iT,null!==(r=f.controlOptions)&&void 0!==r?r:{}),timeSlices:[{duration:null!==(o=f.duration)&&void 0!==o?o:qw,delay:null!==(a=f.delay)&&void 0!==a?a:Jw,delayAfter:null!==(s=f.delayAfter)&&void 0!==s?s:Qw,effects:[{type:f.type,channel:f.channel,custom:f.custom,easing:null!==(l=f.easing)&&void 0!==l?l:eT,customParameters:f.customParameters,options:f.options}]}]}}var p=lt(t.timeSlices).filter((function(t){return t.effects&&lt(t.effects).filter((function(t){return t.channel||t.type})).length}));if(p.length)return{startTime:null!==(u=t.startTime)&&void 0!==u?u:Zw,totalTime:t.totalTime,oneByOne:null!==(c=t.oneByOne)&&void 0!==c?c:tT,loop:null!==(h=t.loop)&&void 0!==h?h:$w,controlOptions:Q({},iT,null!==(d=t.controlOptions)&&void 0!==d?d:{}),timeSlices:p.map((function(t){var e,i;return{duration:t.duration,delay:null!==(e=t.delay)&&void 0!==e?e:Jw,delayAfter:null!==(i=t.delayAfter)&&void 0!==i?i:Qw,effects:lt(t.effects).filter((function(t){return t.channel||t.type})).map((function(t){var e;return{type:t.type,channel:t.channel,custom:t.custom,easing:null!==(e=t.easing)&&void 0!==e?e:eT,customParameters:t.customParameters,options:t.options}}))}})),partitioner:t.partitioner,sort:t.sort}}(e);o&&(i.push({state:t,id:null!==(r=o.id)&&void 0!==r?r:"".concat(t,"-").concat(n),timeline:o,originConfig:e}),n+=1)})),i}function hj(t,e,i){return A(t)?t.call(null,e.getDatum(),e,i):t}var dj=function(){function t(e){jt(this,t),this.parallelArrangers=[this],this.totalTime=0,this.startTime=0,this.endTime=0,this.animators=e.filter((function(t){return!w(t)})),this.totalTime=this.animators.reduce((function(t,e){return Math.max(t,e.getTotalAnimationTime())}),0)}return zt(t,[{key:"parallel",value:function(t){var e=Array.from(new Set(this.parallelArrangers.concat(t.parallelArrangers)));return e.forEach((function(t){t.parallelArrangers=e})),this.arrangeTime(),this}},{key:"after",value:function(t){return this.afterArranger=t,this.arrangeTime(),this}},{key:"arrangeTime",value:function(){var t=this.parallelArrangers.reduce((function(t,e){return Math.max(t,e.totalTime)}),this.totalTime),e=this.parallelArrangers.reduce((function(t,e){var i,n;return Math.max(t,null!==(n=null===(i=e.afterArranger)||void 0===i?void 0:i.endTime)&&void 0!==n?n:0)}),0);this.parallelArrangers.forEach((function(i){i.startTime=e,i.endTime=e+t,i.animators.forEach((function(t){t.startAt(e)}))}))}}]),t}(),fj=function(){function e(t,i){jt(this,e),this.state=null,this.immediateConfigs=[],this.isEnabled=!0,this.disabledStates=[],this.animators=new Map,this.elementRecorder=new WeakMap,this.timelineCount={},this.mark=t,this.configs=uj(null!=i?i:{})}return zt(e,[{key:"getAnimationConfigs",value:function(t){var e;return this.isEnabled?(null!==(e=this.configs)&&void 0!==e?e:[]).filter((function(e){return e.state===t})):[]}},{key:"updateConfig",value:function(t){this.configs=uj(null!=t?t:{})}},{key:"updateState",value:function(t){this.state=t}},{key:"animate",value:function(){var t=this;if(this.isEnabled&&this.configs&&this.configs.length){var e=this.mark.getAllElements(),i=this.mark.parameters();return e.forEach((function(e){var i;e.isReserved&&e.diffState!==aw.exit&&(e.isReserved=!1);var n=null===(i=t.elementRecorder.get(e))||void 0===i?void 0:i.prevState;t.configs.some((function(t){return n!==e.diffState&&t.state===n&&t.timeline.controlOptions.stopWhenStateChange}))&&t.clearElementAnimation(e,!1)})),this.configs.forEach((function(n){t.animateByTimeline(n,e,i)})),this.mark.cleanExitElements(),this}}},{key:"runAnimationByState",value:function(t){var e=this;if(this.isEnabled){var i=this.configs.filter((function(e){return e.state===t})),n=this.mark.getAllElements(),r=this.mark.parameters(),o=i.reduce((function(t,i){return t.concat(e.animateByTimeline(i,n,r,!0))}),[]);return new dj(o)}}},{key:"stopAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.stop()})),this}},{key:"pauseAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.pause()})),this}},{key:"resumeAnimationByState",value:function(t){var e=this.animators.get(t);return e&&e.forEach((function(t){return t.resume()})),this}},{key:"run",value:function(t){var e=this;if(this.isEnabled){var i=cj(Xw,t,this.immediateConfigs.length);this.immediateConfigs=this.immediateConfigs.concat(i);var n=this.mark.getAllElements(),r=this.mark.parameters(),o=i.reduce((function(t,i){return t.concat(e.animateByTimeline(i,n,r,!0))}),[]);return new dj(o)}}},{key:"stop",value:function(){return this.animators.forEach((function(t){t.forEach((function(t){return t.stop()}))})),this}},{key:"pause",value:function(){return this.animators.forEach((function(t){return t.forEach((function(t){return t.pause()}))})),this}},{key:"resume",value:function(){return this.animators.forEach((function(t){return t.forEach((function(t){return t.resume()}))})),this}},{key:"reverse",value:function(){return this}},{key:"restart",value:function(){return this}},{key:"record",value:function(){return this}},{key:"recordEnd",value:function(){return this}},{key:"isAnimating",value:function(){var t=!1;return this.animators.forEach((function(e){t=t||e.some((function(t){return t.isAnimating}))})),t}},{key:"isElementAnimating",value:function(t){var e,i=null===(e=this.elementRecorder.get(t))||void 0===e?void 0:e.count;return w(i)||Object.values(i).every((function(t){return 0===t}))}},{key:"getAnimatorCount",value:function(){var t=0;return this.animators.forEach((function(e){return t+=e.length})),t}},{key:"getAllAnimators",value:function(){var t=[];return this.animators.forEach((function(e){t.push.apply(t,m(e))})),t}},{key:"getElementAnimators",value:function(t,e){var i,n=lt(t),r=[];return e?r=null!==(i=this.animators.get(e))&&void 0!==i?i:[]:this.animators.forEach((function(t){r=r.concat(t)})),r.filter((function(t){return n.includes(t.element)}))}},{key:"enable",value:function(){return this.isEnabled=!0,this}},{key:"disable",value:function(){return this.isEnabled=!1,this.stop(),this.animators.clear(),this}},{key:"enableAnimationState",value:function(t){var e=lt(t);return this.disabledStates=this.disabledStates.filter((function(t){return!e.includes(t)})),this}},{key:"disableAnimationState",value:function(t){var e=lt(t);return this.disabledStates=this.disabledStates.concat(e),this}},{key:"release",value:function(){this.stop(),this.animators.clear(),this.configs=null,this.animators=null,this.elementRecorder=null,this.timelineCount=null}},{key:"animateByTimeline",value:function(t,e,i){var n,r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=[],s=e.filter((function(e){var n=!(e.isReserved&&e.diffState===aw.exit),a=r.getAnimationState(e),s=!r.disabledStates.includes(a),l=o||a===t.state,u=!t.timeline.partitioner||t.timeline.partitioner(e.getDatum(),e,i);return n&&s&&l&&u}));if(s.length){w(this.timelineCount[t.id])&&(this.timelineCount[t.id]=0),t.timeline.sort&&s.sort((function(e,n){return t.timeline.sort(e.getDatum(),n.getDatum(),e,n,i)}));var l={width:this.mark.view.width(),height:this.mark.view.height(),group:null!==(n=this.mark.group)&&void 0!==n?n:null,mark:this.mark,view:this.mark.view,elementCount:s.length,elementIndex:0};s.forEach((function(e,n){l.elementIndex=n;var o=Object.assign(v({},"VGRAMMAR_ANIMATION_PARAMETERS",l),i),u=r.getAnimationUnit(t.timeline,e,n,s.length,o);a.push(r.animateElement(t,u,e,l,o))}))}return a}},{key:"animateElement",value:function(e,i,n,r,o){var a,s,l=this,u=new lj(n,i,e);if(u.animate(r,o),u.isAnimating){n.diffState===aw.exit&&(n.isReserved=!0);var c=0===this.timelineCount[e.id];this.timelineCount[e.id]+=1;var h=null!==(a=this.elementRecorder.get(n))&&void 0!==a?a:{prevState:e.state,count:{}};h.prevState=e.state,h.count[e.state]=(null!==(s=h.count[e.state])&&void 0!==s?s:0)+1,this.elementRecorder.set(n,h);var d=this.animators.get(e.state);d?d.push(u):this.animators.set(e.state,[u]),u.callback((function(){l.handleAnimatorEnd(u)}));var f={mark:this.mark,animationState:e.state,animationConfig:e.originConfig};return c&&this.mark.emit(t.VGRAMMAR_HOOK_EVENT.ANIMATION_START,f),this.mark.emit(t.VGRAMMAR_HOOK_EVENT.ELEMENT_ANIMATION_START,f,n),u}}},{key:"getAnimationState",value:function(t){var e=aT(this.state,this.mark.parameters(),t.getDatum(),t);return null!=e?e:t.diffState}},{key:"getAnimationUnit",value:function(t,e,i,n,r){var o=[],a=hj(t.startTime,e,r),s=hj(t.totalTime,e,r),l=hj(t.oneByOne,e,r),u=hj(t.loop,e,r),c=0;t.timeSlices.forEach((function(t){var i,a=hj(t.delay,e,r),l=hj(t.delayAfter,e,r),u=null!==(i=hj(t.duration,e,r))&&void 0!==i?i:s/n,h=lt(t.effects).map((function(t){return Object.assign({},t,{customParameters:hj(t.customParameters,e,r)})}));o.push({effects:h,duration:u,delay:a,delayAfter:l}),c+=a+u+l}));var h=I(l)?l:!0===l?c:0;return{initialDelay:a,loopCount:I(u)?u:!0===u?1/0:1,loopDelay:h*i,loopDelayAfter:h*(n-i-1),loopAnimateDuration:c,loopDuration:c+h*(n-1),totalTime:s,timeSlices:o}}},{key:"clearElementAnimation",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.animators.forEach((function(n){n.forEach((function(n){n.element===t&&(n.animationOptions.state===aw.exit?n.stop("start",!1):n.stop("end",!1),e.handleAnimatorEnd(n,i))}))})),this.elementRecorder.delete(t)}},{key:"clearAllElements",value:function(){var t=this,e=this.mark.getAllElements();e&&e.forEach((function(i,n){t.clearElement(i,n===e.length-1)}))}},{key:"clearElement",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearElementAnimation(t),t.getGraphicItem()&&(t.clearGraphicAttributes(),t.diffState===aw.exit&&(t.isReserved=!1),e&&this.mark.cleanExitElements())}},{key:"handleAnimatorEnd",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.element,r=e.animationOptions,o=r.state,a=o===Xw,s=this.elementRecorder.get(n).count;s[o]-=1,this.animators.set(o,this.animators.get(o).filter((function(t){return t!==e}))),0===this.animators.get(o).length&&this.animators.delete(o),this.timelineCount[r.id]-=1;var l=0===this.timelineCount[r.id],u=a?this.immediateConfigs.find((function(t){return t.id===r.id})).originConfig:this.configs.find((function(t){return t.id===r.id})).originConfig;l&&(delete this.timelineCount[r.id],a&&(this.immediateConfigs=this.immediateConfigs.filter((function(t){return t.id!==r.id})))),i&&(0===Object.keys(this.timelineCount).length?this.clearAllElements():o===aw.exit&&0===s[aw.exit]&&this.clearElement(n));var c={mark:this.mark,animationState:o,animationConfig:u};l&&this.mark.emit(t.VGRAMMAR_HOOK_EVENT.ANIMATION_END,c),this.mark.emit(t.VGRAMMAR_HOOK_EVENT.ELEMENT_ANIMATION_END,c,n)}}]),e}();function pj(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */pj=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function vj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var yj=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},gj=function(e){ue(n,e);var i=vj(n);function n(t,e,r){var o;return jt(this,n),(o=i.call(this,t)).grammarType="mark",o.elements=[],o.elementMap=new Map,o.isUpdated=!0,o._isReentered=!1,o.animate=new fj(ce(o),{}),o.differ=new tj([]),o.evaluateSync=function(t,e){var i;return o.evaluateMainTasks(t,e),(null===(i=o.renderContext)||void 0===i?void 0:i.progressive)||o.evaluateTransformSync(o._getTransformsAfterEncode(),o.elements,e),ce(o)},o.markType=e,o.spec.type=e,o.spec.encode={update:{}},o.spec.group=r,r&&(o.group=r,o.attach(r),r.appendChild(ce(o))),o}return zt(n,[{key:"parse",value:function(t){var e,i,r,o=this;if(Xs(de(n.prototype),"parse",this).call(this,t),this.spec.group){var a=P(this.spec.group)?this.view.getMarkById(this.spec.group):this.spec.group;this.detach(a)}var s=P(t.group)?this.view.getMarkById(t.group):t.group;return this.attach(s),this.join(null===(e=t.from)||void 0===e?void 0:e.data,t.key,t.sort,t.groupBy,t.groupSort),this.coordinate(t.coordinate),this.state(t.state,this.spec.stateSort),Object.keys(null!==(i=this.spec.encode)&&void 0!==i?i:{}).forEach((function(t){o.encodeState(t,{},!0)})),Object.keys(null!==(r=t.encode)&&void 0!==r?r:{}).forEach((function(e){o.encodeState(e,t.encode[e])})),this.animation(t.animation),this.animationState(t.animationState),this.morph(t.morph,t.morphKey,t.morphElementKey),this.layout(t.layout),this.configure(t),this.transform(t.transform),this.parseAddition(t),this.spec=t,this.markType=t.type,this.commit(),this}},{key:"parameters",value:function(){var t;return null!==(t=this._finalParameters)&&void 0!==t?t:Xs(de(n.prototype),"parameters",this).call(this)}},{key:"parseAddition",value:function(t){return this}},{key:"reuse",value:function(t){var e=this;if(t.grammarType!==this.grammarType)return this;var i=t;return this.markType=i.markType,this.coord=i.coord,this.elementMap=i.elementMap,this.elements=i.elements,this.elementMap.forEach((function(t){return t.mark=e})),this.differ=i.differ,this.animate=i.animate,this.animate.mark=this,this._context=i._context,this.graphicItem=i.graphicItem,this.graphicIndex=i.graphicIndex,this.graphicParent=i.graphicParent,this.needClear=i.needClear,this.isUpdated=i.isUpdated,this}},{key:"needLayout",value:function(){return!w(this.spec.layout)}},{key:"handleLayoutEnd",value:function(){}},{key:"handleRenderEnd",value:function(){this.needClear&&(this.cleanExitElements(),this.elementMap.forEach((function(t){t.diffState===aw.exit?t.clearGraphicAttributes():t.clearChangedGraphicAttributes()})),this.differ.updateToCurrent(),this.needClear=!1)}},{key:"evaluateMainTasks",value:function(e,i){var n;if(this.needSkipBeforeLayout()&&this.view.getLayoutState()===yw.before)return this;var r=null===(n=this.view.renderer)||void 0===n?void 0:n.stage();this.init(r,i);var o=this.evaluateTransformSync(this._getTransformsBeforeJoin(),null!=e?e:Yw,i),a=(null==o?void 0:o.progressive)?e:o;return this.evaluateGroup(a),this.renderContext=this.parseRenderContext(a,i),this.renderContext.progressive?(this.differ.reset(),this.elementMap.clear(),this.evaluateProgressive()):((null==o?void 0:o.progressive)&&(this.renderContext.parameters=i,this.renderContext.beforeTransformProgressive=o.progressive,a=o.progressive.output()),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_JOIN),this.evaluateJoin(a),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_JOIN),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,i),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_STATE),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),i),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_ENCODE)),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_UPDATE),this.update(this.spec),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_UPDATE),this}},{key:"evaluateGroup",value:function(t){if(this.markType!==sw.group){var e=$z(null!=t?t:Yw,this.spec.groupBy,this.spec.groupSort),i=e.keys;this._groupKeys=i,this.differ.setCurrentData(e)}}},{key:"_getTransformsAfterEncodeItems",value:function(){return this.transforms&&this.transforms.filter((function(t){return"afterEncodeItems"===t.markPhase}))}},{key:"_getTransformsAfterEncode",value:function(){return this.transforms&&this.transforms.filter((function(t){return w(t.markPhase)||"afterEncode"===t.markPhase}))}},{key:"_getTransformsBeforeJoin",value:function(){return this.transforms?this.transforms.filter((function(t){return"beforeJoin"===t.markPhase})):[]}},{key:"evaluate",value:function(t,e){var i;return yj(this,void 0,void 0,pj().mark((function n(){return pj().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.evaluateMainTasks(t,e),n.t0=null===(i=this.renderContext)||void 0===i?void 0:i.progressive,n.t0){n.next=5;break}return n.next=5,this.evaluateTransform(this._getTransformsAfterEncode(),this.elements,e);case 5:return n.abrupt("return",this);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"output",value:function(){return this}},{key:"join",value:function(t,e,i,n,r){return this.grammarSource&&(this.detach(this.grammarSource),this.grammarSource=null),this.spec.from=null,w(t)||(P(t)?this.grammarSource=this.view.getDataById(t):this.grammarSource=t,this.spec.from={data:t},this.attach(this.grammarSource)),this.spec.key=e,this.spec.sort=i,this.spec.groupBy=n,this.spec.groupSort=r,this.commit(),this}},{key:"coordinate",value:function(t){return P(t)?this.coord=this.view.getCoordinateById(t):this.coord=t,this.attach(this.coord),this.commit(),this}},{key:"state",value:function(t,e){return this.spec.stateSort=e,this.setFunctionSpec(t,"state")}},{key:"encode",value:function(t,e,i){return this.encodeState(aw.update,t,e,i)}},{key:"encodeState",value:function(t,e,i,n){var r=this;if(t===aw.enter&&(this._isReentered=!0),this.spec.encode[t]){var o=this.spec.encode[t];if(oT(o))this.detach(fT(o,this.view));else{var a=P(e);a&&n||!a&&i?(Object.keys(o).forEach((function(t){r.detach(fT(o[t],r.view))})),this.spec.encode[t]={}):a?this.detach(fT(o[e],this.view)):Object.keys(e).forEach((function(t){r.detach(fT(o[t],r.view))}))}}return e&&(this.spec.encode[t]||(this.spec.encode[t]={}),P(e)?(this.spec.encode[t][e]=i,this.attach(fT(i,this.view))):oT(e)?(this.spec.encode[t]=e,this.attach(fT(e,this.view))):e&&(Object.assign(this.spec.encode[t],e),Object.values(e).forEach((function(t){r.attach(fT(t,r.view))})))),this.commit(),this}},{key:"_getEncoders",value:function(){var t;return null!==(t=this.spec.encode)&&void 0!==t?t:{}}},{key:"animation",value:function(t){return this.spec.animation=t,this}},{key:"animationState",value:function(t){return this.setFunctionSpec(t,"animationState")}},{key:"layout",value:function(t){return this.spec.layout=t,this.commit(),this}},{key:"morph",value:function(t,e,i){return this.spec.morph=t,this.spec.morphKey=e,this.spec.morphElementKey=i,this}},{key:"transform",value:function(t){var e=dz(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]);var i=dz(t,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.spec.transform=t,this.commit(),this}},{key:"configure",value:function(t){var e=this,i=["clip","zIndex","interactive","context","setCustomizedShape","large","largeThreshold","progressiveStep","progressiveThreshold","support3d","morph","morphKey","morphElementKey","attributeTransforms","skipTheme","enableSegments"];return null===t?(i.forEach((function(t){w(e.spec[t])||(e.spec[t]=void 0)})),this):(i.forEach((function(i){w(t[i])||(e.spec[i]=t[i])})),this)}},{key:"context",value:function(t){return this.spec.context=t,this._context=t,this}},{key:"isCollectionMark",value:function(){return Gw.includes(this.markType)}},{key:"needAnimate",value:function(){var t;return!(null===(t=this.renderContext)||void 0===t?void 0:t.progressive)&&!w(this.spec.animation)}},{key:"getAllElements",value:function(){var t=this,e=this.elements.slice();return this.elementMap.forEach((function(t){t.diffState!==aw.exit||e.includes(t)||e.push(t)})),this.spec.sort&&e.sort((function(e,i){return t.spec.sort(e.getDatum(),i.getDatum())})),e}},{key:"getScales",value:function(){var t={};return this.references.forEach((function(e,i){i.grammarType===mw.scale&&(t[i.id()]=i.output())})),t}},{key:"getScalesByChannel",value:function(){var t=this.spec.encode;if(!t)return{};var e={},i=this.parameters();return Object.keys(t).forEach((function(n){var r=t[n];r&&!oT(r)&&Object.keys(r).forEach((function(t){hT(r[t])&&(e[t]=lT(r[t].scale,i))}))})),e}},{key:"getFieldsByChannel",value:function(){var t=this.spec.encode;if(!t)return{};var e={};return Object.keys(t).forEach((function(i){var n=t[i];oT(n)||Object.keys(n).forEach((function(t){dT(n[t])&&(e[t]=n[t].field)}))})),e}},{key:"init",value:function(t,e){var i,n,r,o,a=this;if(this._delegateEvent||(this._delegateEvent=function(t,e){var i,n=null===(i=t.target)||void 0===i?void 0:i[Vw];if((null==n?void 0:n.mark)===a){var r=Nz(a.view,t,n,0,xz);a.emitGrammarEvent(e,r,n)}},this.initEvent()),this.animate||(this.animate=new fj(this,this.spec.animation),this.needAnimate()&&this.animate.updateState(this.spec.animationState)),!this.group){var s=lT(this.spec.group,e);this.group=s,s&&s.appendChild(this)}var l=this.group?this.group.getGroupGraphicItem():t.defaultLayer,u=null!==(r=null===(n=null===(i=this.group)||void 0===i?void 0:i.children)||void 0===n?void 0:n.indexOf(this))&&void 0!==r?r:0;if(this.markType!==sw.group){if(!this.graphicItem){var c=xT(this,sw.group,{pickable:!1,zIndex:null!==(o=this.spec.zIndex)&&void 0!==o?o:0});(this.spec.support3d||Ww.includes(this.markType))&&c.setMode("3d"),c.name="".concat(this.id()||this.markType),this.graphicItem=c}this.graphicParent=this.graphicItem,!l||this.graphicIndex===u&&this.graphicItem.parent===l||l.insertIntoKeepIdx(this.graphicItem,u)}else this.graphicParent=l;this.graphicIndex=u}},{key:"update",value:function(t){this._context=this.spec.context,this.isUpdated=!0,this.renderContext.progressive||(t.animation&&this.animate.updateConfig(t.animation),this.animate.updateState(t.animationState)),this.markType!==sw.group?(w(t.zIndex)||this.graphicItem.setAttribute("zIndex",t.zIndex),w(t.clip)||this.graphicItem.setAttribute("clip",t.clip),this.elementMap.forEach((function(e){e.updateGraphicItem({interactive:t.interactive})}))):this.elementMap.forEach((function(e){e.updateGraphicItem({clip:t.clip,zIndex:t.zIndex,interactive:t.interactive})}))}},{key:"evaluateJoin",value:function(t){var e,i,n,r,o=this;this.needClear=!0;var a=cT(null!==(n=null!==(e=this.spec.key)&&void 0!==e?e:null===(i=this.grammarSource)||void 0===i?void 0:i.getDataIDKey())&&void 0!==n?n:function(){return Uw}),s=cT(null!==(r=this.spec.groupBy)&&void 0!==r?r:function(){return Uw}),l=this.spec.sort,u=this.isCollectionMark(),c=new Set(this.elements.filter((function(t){return t.diffState===aw.enter}))),h=[];this.differ.setCallback((function(t,e,i){var n,r=t;if(w(e))(n=o.elementMap.get(r))&&(n.diffState=aw.exit);else if(w(i)){(n=o.elementMap.has(r)?o.elementMap.get(r):Qz(o)).diffState===aw.exit&&(n.diffState=aw.enter,o.animate.getElementAnimators(n,aw.exit).forEach((function(t){return t.stop("start")}))),n.diffState=aw.enter;var l=u?t:s(e[0]);n.updateData(l,e,a,o.view),o.elementMap.set(r,n),h.push(n)}else if(n=o.elementMap.get(r)){n.diffState=aw.update;var d=u?t:s(e[0]);n.updateData(d,e,a,o.view),h.push(n)}c.delete(n)}));var d=null!=t?t:Yw;u||this.differ.setCurrentData($z(d,(function(t){return"".concat(s(t),"-").concat(a(t))}),void 0)),this.differ.doDiff(),c.forEach((function(t){o.elementMap.delete(u?t.groupKey:"".concat(t.groupKey,"-").concat(t.key)),t.remove(),t.release()})),this.elements=h,l&&this.elements.length>=2&&this.elements.sort((function(t,e){return l(t.getDatum(),e.getDatum())}))}},{key:"evaluateState",value:function(t,e,i){e&&t.forEach((function(t){t.state(e,i)}))}},{key:"evaluateGroupEncode",value:function(t,e,i){var n;if(this.markType===sw.group){var r=this.elements[0],o={};return mT(r,[Object.assign({},null===(n=r.items)||void 0===n?void 0:n[0],{nextAttrs:o})],e,i),o}if(this._groupKeys&&e){var a={};return this._groupKeys.forEach((function(n){var r=t.find((function(t){return t.groupKey===n}));r&&(a[n]=_T(e,r.items&&r.items[0]&&r.items[0].datum,r,i))})),a}}},{key:"evaluateEncode",value:function(e,i,n){var r=this;if(i){this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ELEMENT_ENCODE,{encoders:i,parameters:n},this);var o=this.evaluateGroupEncode(e,i[ow.group],n);e.forEach((function(t){r.markType===sw.group&&o?t.items.forEach((function(t){t.nextAttrs=Object.assign(t.nextAttrs,o)})):(null==o?void 0:o[t.groupKey])&&!r.isCollectionMark()&&t.items.forEach((function(e){e.nextAttrs=Object.assign(e.nextAttrs,o[t.groupKey])})),t.encodeItems(t.items,i,r._isReentered,n)})),this._isReentered=!1,this.evaluateTransformSync(this._getTransformsAfterEncodeItems(),e,n),e.forEach((function(t){t.encodeGraphic(r.isCollectionMark()?null==o?void 0:o[t.groupKey]:null)})),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_ENCODE,{encoders:i,parameters:n},this)}else e.forEach((function(t){t.initGraphicItem()}))}},{key:"addGraphicItem",value:function(t,e,i){var n,r=null!=i?i:xT(this,this.markType,t);if(r){if(null===(n=this.renderContext)||void 0===n?void 0:n.progressive){var o;if(this._groupKeys){var a=this._groupKeys.indexOf(e);a>=0&&(o=this.graphicParent.getChildAt(a))}else o=this.graphicParent.at(0);this.isCollectionMark()?(r.incremental=1,o.appendChild(r)):o.incrementalAppendChild(r)}else this.graphicParent.appendChild(r);return r}}},{key:"parseRenderContext",value:function(t,e){var i=this,n=this.markType!==sw.group&&this.spec.progressiveStep>0&&this.spec.progressiveThreshold>0&&this.spec.progressiveStep<this.spec.progressiveThreshold,r=this.spec.large&&this.spec.largeThreshold>0&&t.length>=this.spec.largeThreshold;if(n){var o=this.differ.getCurrentData();return o&&o.keys&&o.keys.some((function(t){return o.data.get(t).length>i.spec.progressiveThreshold}))?{large:r,parameters:e,progressive:{data:t,step:this.spec.progressiveStep,currentIndex:0,totalStep:o.keys.reduce((function(t,e){return Math.max(Math.ceil(o.data.get(e).length/i.spec.progressiveStep),t)}),1),groupedData:o.data}}:{large:r}}return{large:r}}},{key:"isProgressive",value:function(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}},{key:"isDoingProgressive",value:function(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}},{key:"clearProgressive",value:function(){this.renderContext&&this.renderContext.progressive&&(this.elements=[],this.graphicParent.children.forEach((function(t){t.incrementalClearChild()})),this.graphicParent.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}},{key:"restartProgressive",value:function(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}},{key:"evaluateJoinProgressive",value:function(){var t,e,i,n=this,r=this.renderContext.progressive.currentIndex,o=cT(null!==(i=null!==(t=this.spec.key)&&void 0!==t?t:null===(e=this.grammarSource)||void 0===e?void 0:e.getDataIDKey())&&void 0!==i?i:function(){return Uw}),a=[];if(this.isCollectionMark())return this._groupKeys.forEach((function(t,e){var i=n.renderContext.progressive.groupedData.get(t),s=n.renderContext.progressive.step,l=i.slice(r*s,(r+1)*s);if(0===r){var u=Qz(n);u.diffState=aw.enter,u.updateData(t,l,o,n.view),a.push(u)}else{var c=n.elements[e];c.updateData(t,l,o,n.view),a.push(c)}})),a;var s={};return this._groupKeys.forEach((function(t){var e=n.renderContext.progressive.groupedData.get(t),i=n.renderContext.progressive.step,l=e.slice(r*i,(r+1)*i),u=[];l.forEach((function(e){var i=Qz(n);i.diffState=aw.enter,i.updateData(t,[e],o,n.view),u.push(i),a.push(i)})),s[t]=u})),{groupElements:s,elements:a}}},{key:"evaluateEncodeProgressive",value:function(e,i,n){var r=this;if(i){var o=Object.keys(i).reduce((function(t,e){return!i[e]||e!==ow.enter&&e!==ow.exit&&e!==ow.update||(t[e]=function(t,e,i){if(oT(e))return{themeEncoder:{},positionEncoder:e};var n={},r={};if(t===sw.glyph&&gT.getGlyph(i)){var o=gT.getGlyph(i),a=o.getProgressiveChannels();if(a)Object.keys(e).forEach((function(t){a.includes(t)?r[t]=e[t]:n[t]=e[t]}));else{var s=Array.from(new Set(Object.values(o.getMarks())));Object.keys(e).forEach((function(t){s.some((function(e){return vT(e,t)}))?r[t]=e[t]:n[t]=e[t]}))}}else Object.keys(e).forEach((function(i){vT(t,i)?r[i]=e[i]:n[i]=e[i]}));return{positionEncoder:r,themeEncoder:n}}(r.markType,i[e],r.glyphType).positionEncoder),t}),{}),a=this.renderContext.progressive.currentIndex,s=this.isCollectionMark();this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ELEMENT_ENCODE,{encoders:i,parameters:n},this);var l=this.evaluateGroupEncode(e,i[ow.group],n);if(e.forEach((function(t,e){var u=a>0||!s&&e>0;!u&&(null==l?void 0:l[t.groupKey])&&t.items.forEach((function(e){e.nextAttrs=Object.assign(e.nextAttrs,l[t.groupKey])})),t.encodeItems(t.items,u?o:i,r._isReentered,n)})),this._isReentered=!1,this.evaluateTransformSync(this._getTransformsAfterEncodeItems(),e,n),e.forEach((function(t){t.encodeGraphic()})),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_ENCODE,{encoders:i,parameters:n},this),0===a&&!s){var u=e[0].getGraphicItem(),c=null==u?void 0:u.parent;if(c){var h=u.attribute,d={},f={};Object.keys(h).forEach((function(t){["pickable","zIndex"].includes(t)||(vT(r.markType,t)?f[t]=h[t]:d[t]=h[t])})),c.setTheme({common:d}),u.initAttributes(f)}}}else e.forEach((function(t){t.initGraphicItem()}))}},{key:"evaluateProgressive",value:function(){var e,i,n,r=this;if(null===(e=this.renderContext)||void 0===e?void 0:e.beforeTransformProgressive){this.renderContext.beforeTransformProgressive.progressiveRun();var o=this.renderContext.beforeTransformProgressive.output();return this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_JOIN),this.evaluateJoin(o),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_JOIN),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,this.renderContext.parameters),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_STATE),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),this.renderContext.parameters),void this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_ENCODE)}if(null===(i=this.renderContext)||void 0===i?void 0:i.progressive){var a=this.renderContext.parameters;this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_JOIN);var s=this.evaluateJoinProgressive(),l=Array.isArray(s)?s:s.elements;if(this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_JOIN),0===this.renderContext.progressive.currentIndex?(this.graphicParent.removeAllChild(),this._groupKeys.forEach((function(t){var e=xT(r,sw.group,{pickable:!1,zIndex:r.spec.zIndex});e.incremental=r.renderContext.progressive.step,r.graphicParent.appendChild(e)})),this.elements=l):this.elements=this.elements.concat(l),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(l,this.spec.state,a),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_STATE),this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_ENCODE),Array.isArray(s))this.evaluateEncodeProgressive(l,this._getEncoders(),a);else{var u=s.groupElements;Object.keys(u).forEach((function(t){r.evaluateEncodeProgressive(u[t],r._getEncoders(),a)}))}this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_ENCODE);var c=null===(n=this._getTransformsAfterEncode())||void 0===n?void 0:n.filter((function(t){return!0===t.canProgressive}));(null==c?void 0:c.length)&&this.evaluateTransformSync(c,this.elements,a),this.renderContext.progressive.currentIndex+=1}}},{key:"isLargeMode",value:function(){return this.renderContext&&this.renderContext.large}},{key:"cleanExitElements",value:function(){var t=this;this.elementMap.forEach((function(e,i){e.diffState!==aw.exit||e.isReserved||(t.elementMap.delete(i),e.remove(),e.release())}))}},{key:"getGroupGraphicItem",value:function(){if(this.elements&&this.elements[0]&&this.elements[0].getGraphicItem)return this.elements[0].getGraphicItem()}},{key:"getBounds",value:function(){var t;return this.graphicItem?this.graphicItem.AABBBounds:null===(t=this.getGroupGraphicItem())||void 0===t?void 0:t.AABBBounds}},{key:"getMorphConfig",value:function(){var t;return{morph:null!==(t=this.spec.morph)&&void 0!==t&&t,morphKey:this.spec.morphKey,morphElementKey:this.spec.morphElementKey}}},{key:"getAttributeTransforms",value:function(){var t;return null!==(t=this.spec.attributeTransforms)&&void 0!==t?t:wT[this.markType]}},{key:"getContext",value:function(){return this._context}},{key:"needSkipBeforeLayout",value:function(){var t,e;if(!0===(null===(t=this.spec.layout)||void 0===t?void 0:t.skipBeforeLayouted))return!0;for(var i=this.group;i;){if(!0===(null===(e=i.getSpec().layout)||void 0===e?void 0:e.skipBeforeLayouted))return!0;i=i.group}return!1}},{key:"initEvent",value:function(){this._delegateEvent&&this.view.renderer.stage().on("*",this._delegateEvent)}},{key:"releaseEvent",value:function(){if(this._delegateEvent){var t=this.view.renderer.stage();t&&t.off("*",this._delegateEvent)}}},{key:"clear",value:function(){var t;Xs(de(n.prototype),"clear",this).call(this),this.transforms=null,this.elementMap=null,this.elements=null,this.graphicItem=null,this.animate=null,null===(t=this.group)||void 0===t||t.removeChild(this),this.group=null}},{key:"prepareRelease",value:function(){this.animate.stop(),this.elementMap.forEach((function(t){return t.diffState=aw.exit})),this._finalParameters=this.parameters()}},{key:"release",value:function(){this.releaseEvent(),this.elements.forEach((function(t){return t.release()})),this.elementMap.clear(),this._finalParameters=null,this.animate&&this.animate.release(),this.graphicItem&&kT(this.graphicItem),this.detachAll(),Xs(de(n.prototype),"release",this).call(this)}}]),n}(uz);function mj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var _j=function(e){ue(n,e);var i=mj(n);function n(t,e){var r;return jt(this,n),(r=i.call(this,t,sw.group,e)).children=[],r}return zt(n,[{key:"parseRenderContext",value:function(){return{large:!1}}},{key:"appendChild",value:function(t){return this.children.push(t),this}},{key:"removeChild",value:function(t){return this.children=this.children.filter((function(e){return e!==t})),this}},{key:"includesChild",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!!this.children.includes(t)||!!e&&this.children.some((function(e){return e.markType===sw.group&&e.includesChild(t,!0)}))}},{key:"updateLayoutChildren",value:function(){return this.children.length?(this.layoutChildren||(this.layoutChildren=[]),this.layoutChildren=this.children.filter((function(t){return t.needLayout()})),this):this}},{key:"getAttributeTransforms",value:function(){return wT.rect}},{key:"evaluateJoin",value:function(t){if(!this.elements.length){var e=Qz(this);e.updateData(Uw,Yw,(function(){return""}),this.view),this.elements=[e],this.elementMap.set(Uw,e)}}},{key:"addGraphicItem",value:function(e,i,n){var r=null!=n?n:xT(this,this.markType,e);if(r)return this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ADD_VRENDER_MARK),r.name="".concat(this.id()||this.markType),this.graphicParent.insertIntoKeepIdx(r,this.graphicIndex),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ADD_VRENDER_MARK),r}}]),n}(gj);function bj(t,e){if(F(t))return t;var i=t.trim();if("auto"===i)return 0;if(i.endsWith("%")){var n=parseFloat(i.substring(0,i.length-1));return F(n)?n*e:0}return 0}function xj(t,e){return Math.min(t<0?t+e:t-1,e)}function kj(t,e,i){var n=xj(t,i),r=xj(e,i);if(F(t)||F(e)?F(t)?F(e)||(n=xj(Math.max(0,r-1),i)):r=xj(n+1,i):(n=1,r=2),n>r){var o=r;r=n,n=o}return{start:n,end:r}}var Sj=function(t,e,i,n){var r=function(t,e,i){var n,r,o,a,s=null!==(n=t.gridTemplateRows)&&void 0!==n?n:[i],l=null!==(r=t.gridTemplateColumns)&&void 0!==r?r:[e],u=null!==(o=t.gridRowGap)&&void 0!==o?o:0,c=null!==(a=t.gridColumnGap)&&void 0!==a?a:0,h=s.map((function(t){return bj(t,i)})),d=l.map((function(t){return bj(t,e)})),f=Math.max(0,h.reduce((function(t,e){return t-e}),i)-h.length*u)/s.filter((function(t){return"auto"===t})).length,p=Math.max(0,d.reduce((function(t,e){return t-e}),e)-d.length*c)/l.filter((function(t){return"auto"===t})).length,v=0,y=h.map((function(t,e){var i="auto"===s[e]?f:t,n=v;return v+=i+u,n}));y.push(v);var g=0,m=d.map((function(t,e){var i="auto"===l[e]?p:t,n=g;return g+=i+c,n}));return m.push(g),{rows:y,columns:m,rowGap:u,columnGap:c}}(t.getSpec().layout,i.width(),i.height());e&&e.forEach((function(t){var e=t.getSpec().layout;t.layoutBounds=function(t,e,i,n,r){var o=t.rows.length,a=t.columns.length,s=kj(e,i,o),l=s.start,u=s.end,c=kj(n,r,a),h=c.start,d=c.end,f=t.columns[l],p=t.columns[u]-(d===a?0:t.columnGap),v=t.rows[h],y=t.rows[d]-(u===o?0:t.rowGap);return(new ve).set(f,v,p,y)}(r,e.gridRowStart,e.gridRowEnd,e.gridColumnStart,e.gridColumnEnd),t.commit()}))},Aj=v(v(v(v(v({},lw.axis,0),lw.legend,1),lw.slider,2),lw.player,3),lw.datazoom,4),wj=function(t){var e,i,n;return null!==(i=null===(e=t.getSpec().layout)||void 0===e?void 0:e.order)&&void 0!==i?i:"component"===t.markType&&null!==(n=Aj[t.componentType])&&void 0!==n?n:1/0},Tj=function(t,e,i,n){var r=i.clone(),o=t.getSpec().layout,a=cS(o.maxChildWidth,r.width()),s=cS(o.maxChildHeight,r.width()),l=0,u=0,c=0,h=0;e.forEach((function(t){var e=t.getSpec().layout,o=Yz(e.padding),d=n.parseMarkBounds?n.parseMarkBounds(t.getBounds(),t):t.getBounds();if("top"===e.position||"bottom"===e.position){var f=Math.min(d.height()+o.top+o.bottom,s);"top"===e.position?r.y1+=f:r.y2-=f,d.x1<i.x1&&(l=Math.max(l,i.x1-d.x1)),d.x2>i.x2&&(u=Math.max(u,d.x2-i.x2))}if("left"===e.position||"right"===e.position){var p=Math.min(d.width()+o.left+o.right,a);"left"===e.position?r.x1+=p:r.x2-=p,d.y1<i.y1&&(c=Math.max(c,i.y1-d.y1)),d.y2>i.y2&&(h=Math.max(h,d.y2-i.y2))}"outside"===e.position&&(r.x1+=Math.max(i.x1-d.x1,0)+o.left,r.x2-=Math.max(d.x2-i.x2,0)+o.right,r.y1+=Math.max(i.y1-d.y1,0)+o.top,r.y2-=Math.max(d.y2-i.y2)+o.bottom)})),l>r.x1-i.x1&&l<i.width()&&(r.x1=i.x1+l),u>i.x2-r.x2&&u<i.width()&&(r.x2=i.x2-u),c>r.y1-i.y1&&c<i.height()&&(r.y1=i.y1+c),h>i.y2-r.y2&&h<i.height()&&(r.y2=i.y2-h);for(var d=r.y1,f=r.y2,p=r.x1,v=r.x2,y=e.slice().sort((function(t,e){return wj(t)-wj(e)})),g=0,m=y.length;g<m;g++){var _=y[g],b=_.getSpec().layout,x=Yz(b.padding),k=n.parseMarkBounds?n.parseMarkBounds(_.getBounds(),_):_.getBounds();if("top"===b.position||"bottom"===b.position){var S=Math.min(k.height()+x.top+x.bottom,s);if("top"===b.position?(_.layoutBounds=(new ve).set(r.x1,d-S,r.x2,d),d-=S):(_.layoutBounds=(new ve).set(r.x1,f,r.x2,f+S),f+=S),_.relativePosition={top:_.layoutBounds.y1-r.y1,bottom:_.layoutBounds.y1-r.y2},b.align){var A=k.width()+x.left+x.right;A<r.width()&&("center"===b.align?(_.layoutBounds.x1=(r.x1+r.x2)/2-A/2,_.layoutBounds.x2=_.layoutBounds.x1+A,_.relativePosition.left=_.relativePosition.right=(r.width()-A)/2):"right"===b.align?(_.layoutBounds.x1=r.x2-A,_.layoutBounds.x2=r.x2,_.relativePosition.right=0,_.relativePosition.left=r.width()-A):"left"===b.align&&(_.layoutBounds.x1=r.x1,_.layoutBounds.x2=r.x1+A,_.relativePosition.left=0,_.relativePosition.right=r.width()-A))}}else if("left"===b.position||"right"===b.position){var w=Math.min(k.width()+x.left+x.right,a);if("left"===b.position?(_.layoutBounds=(new ve).set(p-w,r.y1,p,r.y2),p-=w):(_.layoutBounds=(new ve).set(v,r.y1,v+w,r.y2),v+=w),_.relativePosition={left:_.layoutBounds.x1-r.x1,right:_.layoutBounds.x1-r.x2},b.align){var T=k.height()+x.top+x.bottom;w<r.width()&&("middle"===b.align?(_.layoutBounds.y1=(r.y1+r.y2)/2-T/2,_.layoutBounds.y2=_.layoutBounds.y1+T,_.relativePosition.top=_.relativePosition.bottom=(r.height()-T)/2):"bottom"===b.align?(_.layoutBounds.y1=r.y2-T,_.layoutBounds.y2=r.y2,_.relativePosition.top=r.height()-T,_.relativePosition.bottom=0):"top"===b.align&&(_.layoutBounds.y1=r.y1,_.layoutBounds.y2=r.y1+T,_.relativePosition.bottom=r.height()-T,_.relativePosition.top=0))}}else"outside"===b.position?(p-=Math.max(i.x1-k.x1,0)+x.left,v-=Math.max(k.x2-i.x2,0)+x.right,d-=Math.max(i.y1-k.y1,0)+x.top,f+=Math.max(k.y2-i.y2)+x.bottom):_.layoutBounds=r}return r},Mj=function t(e,i,n){null==e||e.forEach((function(e){var r;if(e.markType===sw.group){var o=e.layoutChildren,a=e.getSpec().layout,s=null!==(r=e.layoutBounds)&&void 0!==r?r:e.getBounds();if(s){if(A(a))a.call(null,e,o,s,i);else if(A(a.callback))a.callback.call(null,e,o,s,i);else if("relative"===a.display)if(a.updateViewSignals){var l=n.getViewBox();l&&s.intersect(l);var u=Tj(e,o,s,i),c=u.width(),h=u.height(),d={top:u.y1,right:n.width()-u.x2,left:u.x1,bottom:n.height()-u.y2};n.updateSignal(wz,c),n.updateSignal(Tz,h),n.updateSignal(Mz,d)}else Tj(e,o,s,i);else"grid"===a.display&&Sj(e,o,s);t(o,i,n)}}}))};function Cj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Ej=function(t){ue(i,t);var e=Cj(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,t,sw.glyph,r)).glyphType=n,o.glyphMeta=gT.getGlyph(n),o}return zt(i,[{key:"configureGlyph",value:function(t){return this.spec.glyphConfig=t,this.commit(),this}},{key:"getGlyphMeta",value:function(){return this.glyphMeta}},{key:"getGlyphConfig",value:function(){return this.spec.glyphConfig}},{key:"addGraphicItem",value:function(t,e){var n=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gT.getGraphicType(sw.glyph)){var n=gT.createGraphic(sw.glyph,i),r=e.getMarks(),o=Object.keys(r).map((function(t){if(gT.getGraphicType(r[t])){var e=gT.createGraphic(r[t]);if(e)return e.name=t,e}}));return n.setSubGraphic(o),n}}(this,this.glyphMeta,t);return Xs(de(i.prototype),"addGraphicItem",this).call(this,t,e,n)}}]),i}(gj),Rj=Symbol.for("key"),Pj=function(){function t(){jt(this,t)}return zt(t,[{key:"diffGrammar",value:function(t,e){return function(t,e,i){var n={enter:[],exit:[],update:[]},r=new tj(t,i);return r.setCallback((function(t,e,i){w(e)?n.exit.push({prev:i[0]}):w(i)?n.enter.push({next:e[0]}):n.update.push({next:e[0],prev:i[0]})})),r.setCurrentData($z(e,i)),r.doDiff(),n}(t,e,(function(t){var e;return null!==(e=t.id())&&void 0!==e?e:Symbol()}))}},{key:"diffMark",value:function(t,e,i){var n={enter:[],exit:[],update:[]},r=[],o=[];t.forEach((function(t){t.markType!==sw.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?r.push(t):n.exit.push({prev:[t]})})),e.forEach((function(t){t.markType!==sw.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?o.push(t):n.enter.push({next:[t]})}));var a=this.diffUpdateByGroup(r,o,(function(t){return t.getMorphConfig().morphKey}),(function(t){return t.getMorphConfig().morphKey}));r=a.prev,o=a.next,n.update=n.update.concat(a.update);var s=this.diffUpdateByGroup(r,o,(function(t){return t.id()}),(function(t){return t.id()}));r=s.prev,o=s.next,n.update=n.update.concat(s.update);var l=$z(r,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)})),u=$z(o,(function(t){var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)}));return Object.keys(u).forEach((function(t){var e=l.data.get(t),i=u.data.get(t);if(e&&i){for(var a=0;a<Math.max(e.length,i.length);a+=1){var s=e[a],c=i[a];s&&c?n.update.push({prev:[s],next:[c]}):s?n.exit.push({prev:[s]}):c&&n.enter.push({next:[c]})}r=r.filter((function(t){return!e.includes(t)})),o=o.filter((function(t){return!i.includes(t)}))}})),r.forEach((function(t){return n.exit.push({prev:[t]})})),o.forEach((function(t){return n.enter.push({next:[t]})})),n}},{key:"_appendMorphKeyToElements",value:function(t){var e=t.getMorphConfig();if(!w(e.morphElementKey)){var i=cT(e.morphElementKey);t.elements&&t.elements.forEach((function(t){t.morphKey=i(t.getDatum())}))}}},{key:"morph",value:function(t,e,i){var n=this,r=function(t,e,i){var n={enter:[],exit:[],update:[]},r=new tj(t,i);return r.setCallback((function(t,e,i){w(e)?n.exit.push({prev:i}):w(i)?n.enter.push({next:e}):n.update.push({next:e,prev:i})})),r.setCurrentData($z(e,i)),r.doDiff(),n}(t.reduce((function(t,e){return n._appendMorphKeyToElements(e),t.concat(e.elements)}),[]),e.reduce((function(t,e){return n._appendMorphKeyToElements(e),t.concat(e.elements)}),[]),(function(t){var e;return null!==(e=t.morphKey)&&void 0!==e?e:t.key}));t.forEach((function(t){var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)})),e.forEach((function(t){var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)}));var o=t.concat(e).reduce((function(t,e){return Object.assign(t,e.parameters()),t}),{}),a=0,s=function(){0===(a-=1)&&e.forEach((function(t){var e,i;null===(i=null===(e=t.animate)||void 0===e?void 0:e.enable)||void 0===i||i.call(e)}))};r.enter.forEach((function(t){t.next.forEach((function(t){n.doMorph([],[t],i,s,o)})),a+=1})),r.update.forEach((function(t){for(var e=Math.min(t.prev.length,t.next.length),r=n.divideElements(t.prev,e),l=n.divideElements(t.next,e),u=0;u<e;u++)n.doMorph(r[u],l[u],i,s,o),a+=1}))}},{key:"diffUpdateByGroup",value:function(t,e,i,n){var r=$z(t,(function(t){var e;return null!==(e=i(t))&&void 0!==e?e:Rj})),o=$z(e,(function(t){var e;return null!==(e=n(t))&&void 0!==e?e:Rj})),a=t,s=e,l=[];return o.keys.forEach((function(t){if(t!==Rj){var e=r.data.get(t),i=o.data.get(t);e&&i&&(l.push({prev:e,next:i}),a=a.filter((function(t){return!e.includes(t)})),s=s.filter((function(t){return!i.includes(t)})))}})),{prev:a,next:s,update:l}}},{key:"doMorph",value:function(t,e,i,n,r){var o,a,s={prev:t.map((function(t){return t.getDatum()})),next:e.map((function(t){return t.getDatum()}))},l={prev:t.slice(),next:e.slice()},u=i.animation.easing,c=aT(i.animation.delay,r,s,l),h=aT(i.animation.duration,r,s,l),d=aT(i.animation.oneByOne,r,s,l),f=aT(i.animation.splitPath,r,s,l),p=F(d)&&d>0?function(t){return I(d)?t*d:!0===d?t*h:0}:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?function(t,e,i){var n,r=e.filter((function(t){return t&&t.toCustomPath&&t.valid}));r.length||__DEV__&&console.error(r," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");var o=("clone"===(null==i?void 0:i.splitPath)?od:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:ad)(t,r.length,!1),a=null==i?void 0:i.onEnd,s=r.length,l=function(){0==--s&&a&&a()};r.forEach((function(e,n){var a,s=o[n],u=(null!==(a=null==i?void 0:i.delay)&&void 0!==a?a:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(n,r.length,s,e):0);ed(s,e,Object.assign({},i,{onEnd:l,delay:u}),t.globalTransMatrix)}))}(t[0].getGraphicItem(),e.map((function(t){return t.getGraphicItem()})),{delay:c,duration:h,easing:u,onEnd:n,individualDelay:p,splitPath:f}):t.length>1&&1===e.length&&function(t,e,i){var n,r,o,a=t.filter((function(t){return t.toCustomPath&&t.valid}));a.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");var s=("clone"===(null==i?void 0:i.splitPath)?od:null!==(n=null==i?void 0:i.splitPath)&&void 0!==n?n:ad)(e,a.length,!0),l=e.attribute;e.setAttribute("visible",!1);var u=a.map((function(t,e){return Jh(t.toCustomPath(),s[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:s[e].globalTransMatrix})})),c=a.map((function(t,e){return $h(t.attribute,l)}));if(null==i?void 0:i.individualDelay){var h=i.onEnd,d=a.length,f=function(){0==--d&&(e.setAttributes({visible:!0,ratio:null},!1,{type:Rs.ANIMATE_END}),e.detachShadow(),h&&h())};s.forEach((function(e,n){var r,o,s,l=(null!==(r=i.delay)&&void 0!==r?r:0)+i.individualDelay(n,a.length,t[n],e),h=e.animate(Object.assign({},i,{onEnd:f}));h.wait(l),h.play(new td({morphingData:u[n],saveOnEnd:!0,otherAttrs:c[n]},null!==(o=i.duration)&&void 0!==o?o:th,null!==(s=i.easing)&&void 0!==s?s:eh))}))}else{var p=null==i?void 0:i.onEnd,v=i?Object.assign({},i):{};v.onEnd=function(){e.setAttribute("visible",!0,!1,{type:Rs.ANIMATE_END}),e.detachShadow(),p&&p()};var y=e.animate(v);(null==i?void 0:i.delay)&&y.wait(i.delay),y.play(new id({morphingData:u,otherAttrs:c},null!==(r=null==i?void 0:i.duration)&&void 0!==r?r:th,null!==(o=null==i?void 0:i.easing)&&void 0!==o?o:eh))}}(t.map((function(t){return t.getGraphicItem()})),e[0].getGraphicItem(),{delay:c,duration:h,easing:u,onEnd:n,individualDelay:p,splitPath:f}):ed(null===(a=null===(o=t[0])||void 0===o?void 0:o.getGraphicItem)||void 0===a?void 0:a.call(o),e[0].getGraphicItem(),{delay:c,duration:h,easing:u,onEnd:n})}},{key:"divideElements",value:function(t,e){var i=Math.floor(t.length/e);return new Array(e).fill(0).map((function(n,r){return t.slice(i*r,r===e-1?t.length:i*(r+1))}))}}]),t}();function Bj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Lj=function(){function t(e,i){jt(this,t),this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}},this._size=0,this._mapKey=P(e)?function(t){return t[e]}:e,this._warning=i}return zt(t,[{key:"record",value:function(t){var e,i,n=t.grammarType,r=this._mapKey(t);return this._grammarMap[n]?(this._grammars[n].push(t),w(r)||(this._grammarMap[n][r]?null===(e=this._warning)||void 0===e||e.call(this,r,t):this._grammarMap[n][r]=t)):(this._grammars.customized.push(t),w(r)||(this._grammarMap.customized[r]?null===(i=this._warning)||void 0===i||i.call(this,r,t):this._grammarMap.customized[r]=t)),this._size+=1,this}},{key:"unrecord",value:function(t){var e=t.grammarType,i=this._mapKey(t);return this._grammarMap[e]?(this._grammars[e]=this._grammars[e].filter((function(e){return e!==t})),w(i)||this._grammarMap[e][i]!==t||delete this._grammarMap[e][i]):(this._grammars.customized=this._grammars.customized.filter((function(e){return e!==t})),w(i)||this._grammarMap.customized[i]!==t||delete this._grammarMap.customized[i]),this._size-=1,this}},{key:"size",value:function(){return this._size}},{key:"getSignal",value:function(t){var e;return null!==(e=this._grammarMap.signal[t])&&void 0!==e?e:null}},{key:"getData",value:function(t){var e;return null!==(e=this._grammarMap.data[t])&&void 0!==e?e:null}},{key:"getScale",value:function(t){var e;return null!==(e=this._grammarMap.scale[t])&&void 0!==e?e:null}},{key:"getCoordinate",value:function(t){var e;return null!==(e=this._grammarMap.coordinate[t])&&void 0!==e?e:null}},{key:"getMark",value:function(t){var e;return null!==(e=this._grammarMap.mark[t])&&void 0!==e?e:null}},{key:"getCustomized",value:function(t){var e;return null!==(e=this._grammarMap.customized[t])&&void 0!==e?e:null}},{key:"getGrammar",value:function(t){return this._grammarMap.data[t]?this._grammarMap.data[t]:this._grammarMap.signal[t]?this._grammarMap.signal[t]:this._grammarMap.scale[t]?this._grammarMap.scale[t]:this._grammarMap.coordinate[t]?this._grammarMap.coordinate[t]:this._grammarMap.mark[t]?this._grammarMap.mark[t]:this._grammarMap.customized[t]?this._grammarMap.customized[t]:null}},{key:"getAllSignals",value:function(){return this._grammars.signal}},{key:"getAllData",value:function(){return this._grammars.data}},{key:"getAllScales",value:function(){return this._grammars.scale}},{key:"getAllCoordinates",value:function(){return this._grammars.coordinate}},{key:"getAllMarks",value:function(){return this._grammars.mark}},{key:"getAllCustomized",value:function(){return this._grammars.customized}},{key:"traverse",value:function(t){var e;Object.values(null!==(e=this._grammars)&&void 0!==e?e:{}).forEach((function(e){return(null!=e?e:[]).forEach((function(e){t.call(null,e)}))}))}},{key:"find",value:function(t){var e=null;return this.traverse((function(i){return!0===t.call(null,i)&&(e=i,!0)})),e}},{key:"filter",value:function(t){var e=[];return this.traverse((function(i){!0===t.call(null,i)&&e.push(i)})),e}},{key:"clear",value:function(){this._size=0,this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}}}},{key:"release",value:function(){this._size=0,this._grammars=null,this._grammarMap=null}}]),t}(),Oj=function(t){ue(i,t);var e=Bj(i);function i(){var t;return jt(this,i),(t=e.apply(this,arguments))._markNodes=[],t}return zt(i,[{key:"record",value:function(t){if(Xs(de(i.prototype),"record",this).call(this,t),"mark"===t.grammarType){var e=t,n={mark:e,parent:null,children:[]};this._markNodes.forEach((function(t){var i=t.mark;i.markType===sw.group&&i.includesChild(e,!1)?(t.children.push(n),n.parent=t):e.markType===sw.group&&e.includesChild(i,!1)&&(n.children.push(t),t.parent=n)})),this._markNodes.push(n)}return this}},{key:"unrecord",value:function(t){if(Xs(de(i.prototype),"unrecord",this).call(this,t),"mark"===t.grammarType){var e=t,n=this._markNodes.find((function(t){return t.mark===e}));this._markNodes.forEach((function(t){var i=t.mark;i.markType===sw.group&&i.includesChild(e,!1)?(t.children=t.children.filter((function(t){return t!==n})),n.parent=null):e.markType===sw.group&&e.includesChild(i,!1)&&(n.children=n.children.filter((function(e){return e!==t})),t.parent=null)})),this._markNodes=this._markNodes.filter((function(t){return t!==n}))}return this}},{key:"getAllMarkNodes",value:function(){return this._markNodes}},{key:"clear",value:function(){Xs(de(i.prototype),"clear",this).call(this),this._markNodes=[]}},{key:"release",value:function(){Xs(de(i.prototype),"release",this).call(this),this._markNodes=null}}]),i}(Lj),Ij=function(){function e(i){var n=this;jt(this,e),this._animations=[],this._additionalAnimateMarks=[],this.isEnabled=!0,this._onAnimationStart=function(e){n._additionalAnimateMarks=n._additionalAnimateMarks.filter((function(t){var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()})),0===n._animations.length&&0===n._additionalAnimateMarks.length&&n._view.emit(t.VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_START,{}),n._animations=n._animations.concat({config:e.animationConfig,mark:e.mark})},this._onAnimationEnd=function(e){n._additionalAnimateMarks=n._additionalAnimateMarks.filter((function(t){var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()})),n._animations=n._animations.filter((function(t){return t.config!==e.animationConfig||t.mark!==e.mark})),0===n._animations.length&&0===n._additionalAnimateMarks.length&&n._view.emit(t.VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_END,{})},this._view=i,this._view.addEventListener(t.VGRAMMAR_HOOK_EVENT.ANIMATION_START,this._onAnimationStart),this._view.addEventListener(t.VGRAMMAR_HOOK_EVENT.ANIMATION_END,this._onAnimationEnd)}return zt(e,[{key:"stop",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks=[],this}},{key:"pause",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))})),this}},{key:"resume",value:function(){return this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))})),this}},{key:"enable",value:function(){return this.isEnabled=!0,this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).enable)||void 0===i||i.call(e))})),this}},{key:"disable",value:function(){return this.isEnabled=!1,this._view.traverseMarkTree((function(t){var e,i;t.animate&&(null===(i=(e=t.animate).disable)||void 0===i||i.call(e))})),this._additionalAnimateMarks.forEach((function(t){var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))})),this._additionalAnimateMarks=[],this}},{key:"enableAnimationState",value:function(t){return this._view.traverseMarkTree((function(e){var i,n;e.animate&&(null===(n=(i=e.animate).enableAnimationState)||void 0===n||n.call(i,t))})),this}},{key:"disableAnimationState",value:function(t){return this._view.traverseMarkTree((function(e){var i,n;e.animate&&(null===(n=(i=e.animate).disableAnimationState)||void 0===n||n.call(i,t))})),this}},{key:"isAnimating",value:function(){return 0!==this._animations.length||this._additionalAnimateMarks.some((function(t){var e;return(null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating())||!1}))}},{key:"animate",value:function(){return this.isEnabled?(this._view.traverseMarkTree((function(t){t.isUpdated&&t.animate&&t.animate.animate(),t.cleanExitElements(),t.isUpdated=!1}),null,!0),this):this}},{key:"animateAddition",value:function(t){return t.animate.animate(),this._additionalAnimateMarks.push(t),this}},{key:"release",value:function(){this._additionalAnimateMarks=[],this._view.removeEventListener(t.VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_START,this._onAnimationStart),this._view.removeEventListener(t.VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_END,this._onAnimationEnd)}}]),e}();function Dj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Fj=function(t){ue(i,t);var e=Dj(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"addGraphicItem",value:function(t,e){var n=null==t?void 0:t.text,r="rich"===(null==n?void 0:n.type),o=xT(this,r?sw.richtext:sw.text,t);return r&&(t.textConfig=[]),Xs(de(i.prototype),"addGraphicItem",this).call(this,t,e,o)}},{key:"getAttributeTransforms",value:function(){var t;return"richtext"===(null===(t=this.getGroupGraphicItem())||void 0===t?void 0:t.type)?wT.richtext:wT.text}},{key:"release",value:function(){Xs(de(i.prototype),"release",this).call(this)}}]),i}(gj);Fj.markType=sw.text;var zj={axis:{label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#89909d",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],start:{x:0,y:0},end:{x:100,y:0},x:0,y:0},circleAxis:{title:{space:4,padding:[0,0,0,0],textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1},text:"theta"},label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#6F6F6F",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],startAngle:0,endAngle:2*Math.PI,radius:100,innerRadius:0,center:{x:0,y:0},x:0,y:0},grid:{style:{stroke:"#f1f2f5"}},circleGrid:{style:{stroke:"#f1f2f5"}},discreteLegend:{layout:"vertical",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:10,spaceRow:10,shape:{space:4,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",stroke:"#D8D8D8",fillOpacity:.5}}},label:{space:4,style:{fontSize:12,fill:"black",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",fillOpacity:.5}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"},state:{selectedHover:{fillOpacity:.7,fill:"gray"},unSelectedHover:{fillOpacity:.2,fill:"gray"}}},focus:!1,focusIconStyle:{size:10,fill:"#333",cursor:"pointer"},visible:!0,padding:{top:2,bottom:2,left:2,right:2}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!1,items:[{index:0,id:"",label:"",shape:{fill:"#6690F2",stroke:"#6690F2",symbolType:"circle"}}]},colorLegend:{title:{visible:!1,text:""},colors:[],layout:"horizontal",railWidth:200,railHeight:8,railStyle:{cornerRadius:5}},sizeLegend:{title:{visible:!1,text:""},trackStyle:{fill:"#ccc"},layout:"horizontal",align:"bottom",railWidth:200,railHeight:6,min:0,max:1,value:[0,1]},lineCrosshair:{start:{x:0,y:0},end:{x:0,y:0}},rectCrosshair:{start:{x:0,y:0},end:{x:0,y:0},rectStyle:{width:10,height:10}},sectorCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:Math.PI/6},circleCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI},polygonCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI,sides:6},slider:{layout:"horizontal",railWidth:200,railHeight:10,railStyle:{cornerRadius:5},range:{draggableTrack:!0},startText:{visible:!0,text:"",space:8},endText:{visible:!0,text:"",space:8},min:0,max:1,value:[0,1]},dataLabel:{size:{width:400,height:400},dataLabels:[]},pointLabel:{data:[{text:"",fill:"#606773",data:{}}],overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},lineLabel:{type:"line",data:[{text:"",data:{}}],position:"start",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},areaLabel:{type:"area",data:[{text:"",data:{}}],position:"end",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},rectLabel:{type:"rect",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},symbolLabel:{type:"symbol",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{avoidBaseMark:!0,size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},arcLabel:{type:"arc",data:[{text:"",fill:"#606773",data:{}}],width:800,height:600,position:"outside",zIndex:302},lineDataLabel:{type:"line-data",data:[{text:""}],position:"top",overlap:{avoidBaseMark:!1,clampForce:!1},smartInvert:!1},datazoom:{orient:"bottom",showDetail:"auto",brushSelect:!0,start:0,end:1,position:{x:0,y:0},size:{width:500,height:40},previewData:[]},continuousPlayer:{},discretePlayer:{},tooltip:{},title:{textStyle:{fill:"#21252c"},subtextStyle:{fill:"#606773"}},scrollbar:{width:12,height:12,padding:[2,2],railStyle:{fill:"rgba(0, 0, 0, .1)"}}},jj={symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}},Hj=Object.assign({},zj);Hj.axis=Object.assign({},Hj.axis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),Hj.circleAxis=Object.assign({},Hj.circleAxis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),Hj.grid=Object.assign({},Hj.grid,{style:{stroke:"#404349"}}),Hj.circleGrid=Object.assign({},Hj.circleGrid,{style:{stroke:"#404349"}}),Hj.rectLabel=Object.assign({},Hj.rectLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),Hj.lineLabel=Object.assign({},Hj.lineLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),Hj.symbolLabel=Object.assign({},Hj.symbolLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),Hj.title=Object.assign({},Hj.title,{textStyle:{fill:"#fdfdfd"},subtextStyle:{fill:"#888c93"}});var Nj={name:"dark",padding:5,background:"#202226",palette:{default:["#5383F4","#7BCF8E","#FF9D2C","#FFDB26","#7568D9","#80D8FB","#1857A3","#CAB0E8","#FF8867","#B9E493","#2CB4A8","#B9E4E3"]},marks:jj,components:Hj},Vj={name:"default",padding:5,palette:{default:["#6690F2","#70D6A3","#B4E6E2","#63B5FC","#FF8F62","#FFDC83","#BCC5FD","#A29BFE","#63C4C7","#F68484"]},marks:jj,components:zj},Gj=function(){function t(){jt(this,t)}return zt(t,null,[{key:"registerTheme",value:function(e,i){e&&t._themes.set(e,i)}},{key:"unregisterTheme",value:function(e){t._themes.delete(e)}},{key:"getTheme",value:function(e){return t._themes.get(e)}},{key:"getDefaultTheme",value:function(){return t.getTheme("default")}}]),t}();function Wj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Gj._themes=new Map,Gj.registerTheme("default",Vj),Gj.registerTheme("dark",Nj);var Uj=function(e){ue(n,e);var i=Wj(n);function n(t,e,r,o){var a;return jt(this,n),(a=i.call(this,t,sw.component,r))._componentDatum=v({},Uw,0),a.componentType=e,a.spec.type="component",a.spec.componentType=e,a.mode=o,a._updateComponentEncoders(),a}return zt(n,[{key:"configureComponent",value:function(t){return this.spec.componentConfig=t,this.commit(),this}},{key:"addGraphicItem",value:function(e,i,n){var r=null!=n?n:gT.createGraphicComponent(this.componentType,e,{mode:this.mode,skipDefault:this.spec.skipTheme});return this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_ADD_VRENDER_MARK),this.graphicParent.appendChild(r),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_ADD_VRENDER_MARK),r}},{key:"join",value:function(t){return Xs(de(n.prototype),"join",this).call(this,t,Uw)}},{key:"encodeState",value:function(t,e,i){return Xs(de(n.prototype),"encodeState",this).call(this,t,e,i),this._updateComponentEncoders(),this}},{key:"parseRenderContext",value:function(){return{large:!1}}},{key:"_prepareRejoin",value:function(){this._componentDatum[Uw]+=1}},{key:"evaluateJoin",value:function(t){return this.spec.key=Uw,Xs(de(n.prototype),"evaluateJoin",this).call(this,[this._componentDatum])}},{key:"_updateComponentEncoders",value:function(){this._encoders=this.spec.encode}},{key:"_getEncoders",value:function(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}}]),n}(gj);function Yj(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Yj=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function Kj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var Xj=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},Zj=function(e){ue(n,e);var i=Kj(n);function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jt(this,n),(t=i.call(this))._observer=null,t._onResize=Pt((function(){var e=t._getContainerSize();e&&t.resize(e.width,e.height)}),100),t.delegateEvent=function(e,i){var n,r=null===(n=e.target)||void 0===n?void 0:n[Vw],o=Nz(ce(t),e,r,0,xz);t.emit(i,o,r)},t.handleProgressiveFrame=function(){t._progressiveMarks.length&&t._progressiveMarks.forEach((function(t){t.isDoingProgressive()&&t.evaluateProgressive()})),t.doPreProgressive()},t._config=r,t._options=Object.assign({mode:"browser"},e),t.initialize(),t}return zt(n,[{key:"getGrammarById",value:function(t){return this.grammars.getGrammar(t)}},{key:"getSignalById",value:function(t){return this.grammars.getSignal(t)}},{key:"getDataById",value:function(t){return this.grammars.getData(t)}},{key:"getScaleById",value:function(t){return this.grammars.getScale(t)}},{key:"getCoordinateById",value:function(t){return this.grammars.getCoordinate(t)}},{key:"getMarkById",value:function(t){return this.grammars.getMark(t)}},{key:"getCustomizedById",value:function(t){return this.grammars.getCustomized(t)}},{key:"getGrammarsByName",value:function(t){return this.grammars.filter((function(e){return e.name()===t}))}},{key:"getGrammarsByType",value:function(t){return this.grammars.filter((function(e){return e.grammarType===t}))}},{key:"getMarksByType",value:function(t){return this.grammars.getAllMarks().filter((function(e){return e.markType===t}))}},{key:"getMarksByName",value:function(t){return this.grammars.getAllMarks().filter((function(e){return e.name()===t}))}},{key:"getMarksBySelector",value:function(t){var e=this;if(!t)return null;var i=lt(t),n=[];return i.forEach((function(t){if(uT(t))n.push(t);else if("#"!==t[0]){var i="@"===t[0]?e.getMarksByName(t.slice(1)):bT(t)?e.getMarksByType(t):null;i&&i.length&&i.forEach((function(t){n.push(t)}))}else{var r=e.getMarkById(t.slice(1));r&&n.push(r)}})),n}},{key:"updateSignal",value:function(t,e){P(t)&&(t=this.getSignalById(t)),t.set(e),this.commit(t)}},{key:"signal",value:function(t,e){var i=new Gz(this);return arguments.length>=1&&i.value(t),arguments.length>=2&&i.update(e),this.grammars.record(i),this._dataflow.add(i),i}},{key:"data",value:function(t){var e=new _z(this,t);return this.grammars.record(e),this._dataflow.add(e),e}},{key:"scale",value:function(t){var e=gT.createGrammar("scale",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}},{key:"coordinate",value:function(t){var e=gT.createGrammar("coordinate",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}},{key:"mark",value:function(t,e,i){var n,r=P(e)?this.getMarkById(e):e;switch(t){case sw.group:n=new _j(this,r);break;case sw.glyph:n=new Ej(this,null==i?void 0:i.glyphType,r);break;case sw.component:n=gT.hasComponent(null==i?void 0:i.componentType)?gT.createComponent(null==i?void 0:i.componentType,this,r,null==i?void 0:i.mode):new Uj(this,null==i?void 0:i.componentType,r,null==i?void 0:i.mode);break;case sw.text:n=new Fj(this,t,r);break;default:n=gT.hasMark(t)?gT.createMark(t,this,r):new gj(this,t,r)}return this.grammars.record(n),this._dataflow.add(n),n}},{key:"group",value:function(t){return this.mark(sw.group,t)}},{key:"glyph",value:function(t,e){return this.mark(sw.glyph,e,{glyphType:t})}},{key:"component",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2d";return this.mark(sw.component,e,{componentType:t,mode:i})}},{key:"axis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2d";return this.mark(sw.component,t,{componentType:lw.axis,mode:e})}},{key:"grid",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2d";return this.mark(sw.component,t,{componentType:lw.grid,mode:e})}},{key:"legend",value:function(t){return this.mark(sw.component,t,{componentType:lw.legend})}},{key:"slider",value:function(t){return this.mark(sw.component,t,{componentType:lw.slider})}},{key:"label",value:function(t){return this.mark(sw.component,t,{componentType:lw.label})}},{key:"datazoom",value:function(t){return this.mark(sw.component,t,{componentType:lw.datazoom})}},{key:"player",value:function(t){return this.mark(sw.component,t,{componentType:lw.player})}},{key:"title",value:function(t){return this.mark(sw.component,t,{componentType:lw.title})}},{key:"scrollbar",value:function(t){return this.mark(sw.component,t,{componentType:lw.scrollbar})}},{key:"customized",value:function(t,e){var i=gT.createGrammar(t,this,null==e?void 0:e.type);if(i)return i.parse(e),this.grammars.record(i),this._dataflow.add(i),i}},{key:"addGrammar",value:function(t){return this.grammars.find((function(e){return e.uid===t.uid}))||(this.grammars.record(t),this._dataflow.add(t),t.parse(t.getSpec()),this._needBuildLayoutTree=!0),this}},{key:"removeGrammar",value:function(t){var e=P(t)?this.getGrammarById(t):t;return e&&this.grammars.find((function(t){return t.uid===e.uid}))?("mark"===e.grammarType&&e.prepareRelease(),this._cachedGrammars.record(e),this._dataflow.remove(e),this.grammars.unrecord(e),this._needBuildLayoutTree=!0,this):this}},{key:"removeAllGrammars",value:function(){var t=this;return this.grammars.traverse((function(e){"signal"===e.grammarType&&Uz.includes(e.id())||"mark"===e.grammarType&&"root"===e.id()||t.removeGrammar(e)})),this}},{key:"removeAllGraphicItems",value:function(){return this.traverseMarkTree((function(t){t.graphicItem&&(kT(t.graphicItem),t.elementMap.forEach((function(t){t.resetGraphicItem()})),t.graphicItem=null)})),this}},{key:"parseSpec",value:function(e){var i,n,r,o,a,s,l=this;if(this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_PARSE_VIEW),this._spec=e,Kz(e),e.theme?this.theme(e.theme):this.theme(Gj.getDefaultTheme()),e.width&&this.width(e.width),e.height&&this.height(e.height),this.padding(null!==(n=null!==(i=e.padding)&&void 0!==i?i:this._options.padding)&&void 0!==n?n:this._theme.padding),!this.width()||!this.height()){var u=this._getContainerSize();u&&(this.updateSignal(Sz,u.width),this.updateSignal(Az,u.height))}(null===(r=e.signals)||void 0===r?void 0:r.length)&&e.signals.forEach((function(t){l.signal().parse(t)})),(null===(o=e.data)||void 0===o?void 0:o.length)&&e.data.forEach((function(t){l.data(null).parse(t)})),(null===(a=e.coordinates)||void 0===a?void 0:a.length)&&e.coordinates.forEach((function(t){var e;null===(e=l.coordinate(t.type))||void 0===e||e.parse(t)})),(null===(s=e.scales)||void 0===s?void 0:s.length)&&e.scales.forEach((function(t){var e;null===(e=l.scale(t.type))||void 0===e||e.parse(t)}));var c=gT.getGrammars();return Object.keys(c).forEach((function(t){var i=c[t].specKey;e[i]&&e[i].length&&e[i].forEach((function(e){l.customized(t,e)}))})),e.marks&&e.marks.length&&e.marks.forEach((function(t){l.parseMarkSpec(t)})),e.events&&e.events.length&&e.events.forEach((function(t){l.event(t)})),e.interactions&&e.interactions.length&&e.interactions.forEach((function(t){l.interaction(t.type,t)})),!1===e.animation?this.animate.disable():this.animate.enable(),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_PARSE_VIEW),this._needBuildLayoutTree=!0,this._layoutState=yw.before,this}},{key:"updateSpec",value:function(t){return this.removeAllInteractions(),this.removeAllGrammars(),this.parseSpec(t)}},{key:"parseBuiltIn",value:function(){var t=this;(function(t,e,i){var n,r,o,a,s;return[{id:Sz,value:null!==(n=t[Sz])&&void 0!==n?n:0},{id:Az,value:null!==(r=t[Az])&&void 0!==r?r:0},{id:Mz,value:Yz(null!==(a=null!==(o=t[Mz])&&void 0!==o?o:e[Mz])&&void 0!==a?a:null==i?void 0:i.padding)},{id:wz,update:{callback:function(t,e){var i=Yz(e[Mz]);return e[Sz]-i.left-i.right},dependency:[Sz,Mz]}},{id:Tz,update:{callback:function(t,e){var i=Yz(e[Mz]);return e[Az]-i.top-i.bottom},dependency:[Az,Mz]}},{id:Cz,update:{callback:function(t,e){var i=Yz(e[Mz]);return(t||new ve).setValue(i.left,i.top,i.left+e[wz],i.top+e[Tz])},dependency:[wz,Tz,Mz]}},{id:Ez,value:null!==(s=t[Ez])&&void 0!==s?s:e[Ez]}]})(this._options,this._config,this.getCurrentTheme()).forEach((function(e){var i=t.signal().parse(e);e.value&&i.set(e.value)})),this.parseMarkSpec({id:"root",type:"group",encode:{enter:{x:0,y:0},update:{width:{signal:"width"},height:{signal:"height"}}}}),this.rootMark=this.getMarkById("root")}},{key:"parseMarkSpec",value:function(t){var e,i=this,n=t.type===sw.glyph?{glyphType:t.glyphType}:t.type===sw.component?{componentType:t.componentType,mode:t.mode}:null;this.mark(t.type,t.group,n).parse(t),null===(e=t.marks)||void 0===e||e.forEach((function(t){i.parseMarkSpec(t)}))}},{key:"theme",value:function(t){var e,i,n,r,o,a;P(t)?this._theme=null!==(e=Gj.getTheme(t))&&void 0!==e?e:Gj.getDefaultTheme():this._theme=t;var s=null!==(i=this._spec)&&void 0!==i?i:{},l=s.background,u=s.padding;return this._theme?(this.background(null!==(n=null!=l?l:this._options.background)&&void 0!==n?n:this._theme.background),this.padding(null!==(r=null!=u?u:this._options.padding)&&void 0!==r?r:this._theme.padding),null===(a=null===(o=this.renderer.stage())||void 0===o?void 0:o.setTheme)||void 0===a||a.call(o,Object.assign({},this._theme.marks))):(this.background(null!=l?l:this._options.background),this.padding(null!=u?u:this._options.padding)),this}},{key:"getCurrentTheme",value:function(){return this._theme}},{key:"setCurrentTheme",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Xj(this,void 0,void 0,Yj().mark((function i(){return Yj().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(this._isReleased){i.next=12;break}if(this.theme(t),this.grammars.getAllMarks().forEach((function(t){t.commit()})),!e){i.next=9;break}return i.next=4,this.evaluate();case 4:if(!this._isReleased){i.next=6;break}return i.abrupt("return");case 6:this.renderer.render(!0),i.next=11;break;case 9:return i.next=11,this._dataflow.evaluate();case 11:return i.abrupt("return",this);case 12:case"end":return i.stop()}}),i,this)})))}},{key:"background",value:function(t){return arguments.length?(this._background=t,this.renderer.background(t),t):this._background}},{key:"width",value:function(t){var e=this.getSignalById(Sz);return arguments.length?(this._options.width=t,this.updateSignal(e,t),t):e.output()}},{key:"height",value:function(t){var e=this.getSignalById(Az);return arguments.length?(this._options.height=t,this.updateSignal(e,t),t):e.output()}},{key:"viewWidth",value:function(t){var e=this.getSignalById(wz);if(arguments.length){var i=this.padding();return this.width(t+i.left+i.right),t}return e.output()}},{key:"viewHeight",value:function(t){var e=this.getSignalById(Tz);if(arguments.length){var i=this.padding();return this.height(t+i.top+i.bottom),t}return e.output()}},{key:"padding",value:function(t){var e=this.getSignalById(Mz);if(arguments.length){var i=Yz(t);return this.updateSignal(e,i),i}return Yz(e.output())}},{key:"autoFit",value:function(t){var e=this.getSignalById(Ez);return arguments.length?(this.updateSignal(e,t),t):e.output()}},{key:"getViewBox",value:function(){var t=this.getSignalById(Cz);return null==t?void 0:t.output()}},{key:"updateLayoutTag",value:function(){return this._layoutState=yw.before,this}},{key:"getLayoutState",value:function(){return this._layoutState}},{key:"buildLayoutTree",value:function(){var t={},e=[];this.traverseMarkTree((function(i){t[i.id()]=!0,i.group&&t[i.group.id()]||e.push(i),i.markType===sw.group&&i.updateLayoutChildren()}),(function(t){return t.needLayout()})),this._layoutMarks=e}},{key:"doLayout",value:function(){var e,i=this._options.doLayout||Mj;i&&(null===(e=this._layoutMarks)||void 0===e?void 0:e.length)&&(this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_DO_LAYOUT),i(this._layoutMarks,this._options,this),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_DO_LAYOUT))}},{key:"handleLayoutEnd",value:function(){this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_LAYOUT_END),this._layoutMarks.forEach((function(t){Fz(t,"layoutChildren",(function(t){t.handleLayoutEnd()}),(function(e){return e!==t}))})),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_LAYOUT_END)}},{key:"handleRenderEnd",value:function(){this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_MARK_RENDER_END),Fz(this.rootMark,"children",(function(t){t.handleRenderEnd()})),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_RENDER_END)}},{key:"commit",value:function(t){return this._dataflow.commit(t),this}},{key:"run",value:function(t){return this.evaluate(t),this}},{key:"runSync",value:function(t){return this.evaluateSync(t),this}},{key:"isRunning",value:function(){return this._running}},{key:"runAsync",value:function(t){return Xj(this,void 0,void 0,Yj().mark((function e(){var i,n=this;return Yj().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isReleased){e.next=2;break}return e.abrupt("return");case 2:if(e.t0=this._running,!e.t0){e.next=7;break}return e.next=6,this._running;case 6:e.t0=!this._isReleased;case 7:if(!e.t0){e.next=11;break}case 9:e.next=2;break;case 11:return i=function(){n._running=null},e.abrupt("return",((this._running=this.evaluate(t)).then(i,i),this._running));case 13:case"end":return e.stop()}}),e,this)})))}},{key:"runNextTick",value:function(t){return Xj(this,void 0,void 0,Yj().mark((function e(){var i=this;return Yj().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._currentDataflow||(this._currentDataflow=Promise.resolve().then((function(){return i.runAsync(t).then((function(){i._currentDataflow=null})).catch((function(t){i._currentDataflow=null,i.logger.error(t)}))}))),e.next=3,this._currentDataflow;case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"doRender",value:function(e){this.emit(t.VGRAMMAR_HOOK_EVENT.BEFORE_DO_RENDER),this.renderer&&(this._progressiveMarks||this.animate.animate(),this.renderer.render(e),this.handleRenderEnd()),this.emit(t.VGRAMMAR_HOOK_EVENT.AFTER_DO_RENDER)}},{key:"evaluate",value:function(t){var e,i,n,r;return Xj(this,void 0,void 0,Yj().mark((function o(){var a,s,l,u,c=this;return Yj().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!this._isReleased){o.next=2;break}return o.abrupt("return");case 2:if(a=Xz(t),(s=this._cachedGrammars.size()>0)&&(this.reuseCachedGrammars(a),this.detachCachedGrammar()),l=this._resizeRenderer(),u=this._dataflow.hasCommitted(),s||u||this._layoutState||l){o.next=7;break}return o.abrupt("return",this);case 7:return this.clearProgressive(),null===(e=this.renderer)||void 0===e||e.preventRender(!0),o.next=11,this._dataflow.evaluate();case 11:if(this._isReleased){o.next=25;break}if(this._needBuildLayoutTree&&(this.buildLayoutTree(),this._needBuildLayoutTree=!1),!this._layoutState){o.next=24;break}if(this._layoutState=yw.layouting,this.doLayout(),o.t0=this._dataflow.hasCommitted(),!o.t0){o.next=21;break}return this._layoutState=yw.reevaluate,o.next=20,this._dataflow.evaluate();case 20:o.t0=this._isReleased;case 21:if(!o.t0){o.next=23;break}return o.abrupt("return");case 23:this._layoutState=yw.after,(null===(i=this._layoutMarks)||void 0===i?void 0:i.length)&&this.handleLayoutEnd();case 24:return o.abrupt("return",(null===(n=this.renderer)||void 0===n||n.preventRender(!1),this._layoutState=null,this.findProgressiveMarks(),this._resizeRenderer(),this.doRender(!1),null===(r=this._willMorphMarks)||void 0===r||r.forEach((function(t){c._morph.morph(t.prev,t.next,a)})),this._willMorphMarks=null,this.releaseCachedGrammars(a),this.doPreProgressive(),this));case 25:case"end":return o.stop()}}),o,this)})))}},{key:"evaluateSync",value:function(t){var e,i,n=this,r=Xz(t),o=this._cachedGrammars.size()>0;o&&(this.reuseCachedGrammars(r),this.detachCachedGrammar());var a=this._resizeRenderer(),s=this._dataflow.hasCommitted();return o||s||this._layoutState||a?(this.clearProgressive(),this._dataflow.evaluateSync(),this._needBuildLayoutTree&&(this.buildLayoutTree(),this._needBuildLayoutTree=!1),this._layoutState&&(this._layoutState=yw.layouting,this.doLayout(),this._dataflow.hasCommitted()&&(this._layoutState=yw.reevaluate,this._dataflow.evaluateSync()),this._layoutState=yw.after,(null===(e=this._layoutMarks)||void 0===e?void 0:e.length)&&this.handleLayoutEnd()),this._layoutState=null,this.findProgressiveMarks(),this._resizeRenderer(),this.doRender(!0),null===(i=this._willMorphMarks)||void 0===i||i.forEach((function(t){n._morph.morph(t.prev,t.next,r)})),this._willMorphMarks=null,this.releaseCachedGrammars(r),this.doPreProgressive(),this):this}},{key:"reuseCachedGrammars",value:function(t){var e=this;if(this._willMorphMarks||(this._willMorphMarks=[]),t.reuse){var i=function(t){t.next.reuse(t.prev),t.prev.detachAll(),t.prev.clear(),e._cachedGrammars.unrecord(t.prev)};this._morph.diffGrammar(this._cachedGrammars.getAllSignals(),this.grammars.getAllSignals().filter((function(t){return!Uz.includes(t.id())}))).update.forEach(i),this._morph.diffGrammar(this._cachedGrammars.getAllData(),this.grammars.getAllData()).update.forEach(i),this._morph.diffGrammar(this._cachedGrammars.getAllScales(),this.grammars.getAllScales()).update.forEach(i),this._morph.diffGrammar(this._cachedGrammars.getAllCoordinates(),this.grammars.getAllCoordinates()).update.forEach(i)}this._morph.diffMark(this._cachedGrammars.getAllMarks(),this.grammars.getAllMarks().filter((function(t){return"root"!==t.id()})),t).update.forEach((function(i){var n=1===i.prev.length&&1===i.next.length&&i.prev[0].markType===i.next[0].markType,r=i.prev.every((function(t){return t.getMorphConfig().morph}))&&i.next.every((function(t){return t.getMorphConfig().morph}));n&&t.reuse?(i.next[0].reuse(i.prev[0]),i.prev[0].detachAll(),i.prev[0].clear(),e._cachedGrammars.unrecord(i.prev[0])):(t.morph&&r||t.morphAll)&&e._willMorphMarks.push({prev:i.prev,next:i.next})}))}},{key:"detachCachedGrammar",value:function(){this._cachedGrammars.traverse((function(t){var e,i;if(t.detachAll(),"mark"===t.grammarType){var n=t;null===(i=null===(e=n.group)||void 0===e?void 0:e.removeChild)||void 0===i||i.call(e,n)}}))}},{key:"releaseCachedGrammars",value:function(t){var e=this;this._cachedGrammars.traverse((function(t){"mark"!==t.grammarType&&t.release()}));var i=this._cachedGrammars.getAllMarkNodes();i.forEach((function(i){i.mark.animate.stop(),t.enableExitAnimation&&e.animate.animateAddition(i.mark)}));var n=function t(e){if(e.mark.view&&0===e.mark.animate.getAnimatorCount()&&(!e.children||0===e.children.length)){e.mark.release();var i=e.parent;i&&(e.parent.children=e.parent.children.filter((function(t){return t!==e})),e.parent=null,t(i))}};i.forEach((function(t){var e=t.mark;0===e.animate.getAnimatorCount()?n(t):e.addEventListener("animationEnd",(function(){0===e.animate.getAnimatorCount()&&n(t)}))})),this._cachedGrammars.clear()}},{key:"runAfter",value:function(t){var e=this;return this._dataflow.runAfter((function(){t.call(null,e)})),this}},{key:"runBefore",value:function(t){var e=this;return this._dataflow.runBefore((function(){t.call(null,e)})),this}},{key:"getImageBuffer",value:function(){var t,e;if("node"===this._options.mode){var i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t);return i?(i.render(),i.window.getImageBuffer()):(this.logger.error(new ReferenceError("render is not defined")),null)}this.logger.error(new TypeError("getImageBuffer() now only support node environment."))}},{key:"traverseMarkTree",value:function(t,e,i){return Fz(this.rootMark,"children",t,e,i),this}},{key:"_bindResizeEvent",value:function(){var t,e,i,n,r,o;if(this.autoFit()){var a=null===(r=null===(n=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===n?void 0:n.getContainer)||void 0===r?void 0:r.call(n);if(a){var s=window.ResizeObserver;this._observer=new s(this._onResize),null===(o=this._observer)||void 0===o||o.observe(a)}window.addEventListener("resize",this._onResize)}}},{key:"_unBindResizeEvent",value:function(){this.autoFit()&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}},{key:"_getContainerSize",value:function(){var t,e,i,n,r,o,a,s,l,u,c,h=null===(r=null===(n=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===n?void 0:n.getContainer)||void 0===r?void 0:r.call(n);if(h){var d=_i(h),f=d.width,p=d.height;return{width:null!==(s=null!==(a=null===(o=this._spec)||void 0===o?void 0:o.width)&&void 0!==a?a:this._options.width)&&void 0!==s?s:f,height:null!==(c=null!==(u=null===(l=this._spec)||void 0===l?void 0:l.height)&&void 0!==u?u:this._options.height)&&void 0!==c?c:p}}return null}},{key:"resize",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Xj(this,void 0,void 0,Yj().mark((function n(){var r;return Yj().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!1,t!==this.width()&&(r=!0,this.updateSignal(Sz,t)),e!==this.height()&&(r=!0,this.updateSignal(Az,e)),n.t0=r,!n.t0){n.next=12;break}if(!i){n.next=10;break}return n.next=8,this.evaluate();case 8:n.next=12;break;case 10:return n.next=12,this._dataflow.evaluate();case 12:return n.abrupt("return",this);case 13:case"end":return n.stop()}}),n,this)})))}},{key:"_resizeRenderer",value:function(){var t=this.width(),e=this.height();return!!this.renderer.shouldResize(t,e)&&(this.renderer.resize(t,e),this.emit("resize",{},{width:t,height:e}),!0)}},{key:"bindEvents",value:function(t){var e=this;if(!this._eventConfig.disable){var i=t.type,n=t.filter,r=t.callback,o=t.throttle,a=t.debounce,s=t.consume,l=t.target,u=t.dependency,c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xz,i={},n=t.split(":");if(2===n.length){var r=Mt(n,2),o=r[0],a=r[1];"#"===o[0]?(i.markId=o.slice(1),i.source=e):"@"===o[0]?(i.markName=o.slice(1),i.source=e):bT(o)?(i.markType=o,i.source=e):i.source=o===bz?bz:e,i.type=a}else 1===n.length&&(i.type=t,i.source=e);return i}(i);if(c){var h,d=c.source,f=c.type,p=w((h=c).markId)?function(t){return t&&t.mark.id()===h.markId}:w(h.markName)?function(t){return t&&t.mark.name()===h.markName}:w(h.type)?function(t){return t&&t.mark.markType===h.type}:function(){return!0},v=(Array.isArray(l)&&l.length?l.map((function(t){return{signal:e.getSignalById(t.target),callback:t.callback}})):[{signal:P(l)?this.getSignalById(l):null,callback:r}]).filter((function(t){return t.signal||t.callback})),y=nT(u,this),g=Zz((function(t,i){var r=d===xz&&function(t,e){var i=t.defaults,n=i.prevent,r=i.allow;return!1!==n&&!0!==r&&(!0===n||!1===r||(n?n[e]:!!r&&!r[e]))}(e._eventConfig,f)||s&&(void 0===t.cancelable||t.cancelable);d===bz&&(t=Nz(0,t,i,0,bz));var o=!1;if((!n||n(t))&&(!p||p(i))&&v.length){var a=y.reduce((function(t,e){return t[e.id()]=e.output(),t}),{});v.forEach((function(i){i.callback&&i.signal?i.signal.set(i.callback(t,a))&&(e.commit(i.signal),o=!0):i.callback?i.callback(t,a):(e.commit(i.signal),o=!0)}))}r&&t.preventDefault(),s&&t.stopPropagation(),o&&e.runAsync()}),{throttle:o,debounce:a});if(d===xz){if(function(t,e,i){var n=null==t?void 0:t[e];return!(!1===n||M(n)&&!n[i])}(this._eventConfig,xz,f))return this.addEventListener(f,g,kz),function(){e.removeEventListener(f,g)}}else if(d===bz)return ux.addEventListener(f,g),this._eventListeners.push({type:f,source:ux,handler:g}),function(){ux.removeEventListener(f,g);var t=e._eventListeners.findIndex((function(t){return t.type===f&&t.source===ux&&t.handler===g}));t>=0&&e._eventListeners.splice(t,1)}}}}},{key:"event",value:function(t){var e=this;if("between"in t){var i,n=Mt(t.between,2),r=n[0],o=n[1],a="".concat(r.type,"-").concat(t.type,"-").concat(o.type);this.bindEvents(Object.assign({},r,{callback:function(){if(e._eventCache||(e._eventCache={}),!e._eventCache[a]){var n=e.bindEvents(t);e._eventCache[a]=n}i||(i=e.bindEvents(Object.assign({},o,{callback:function(){e._eventCache[a]&&(e._eventCache[a](),e._eventCache[a]=null)}})))}}))}else"merge"in t?t.merge.forEach((function(i){var n=Object.assign({},t);P(i)?n.type=i:M(i)&&Object.assign(n,i),n.debounce=50,e.bindEvents(n)})):this.bindEvents(t)}},{key:"interaction",value:function(t,e){var i=gT.createInteraction(t,this,e);return i&&(i.bind(),this._boundInteractions||(this._boundInteractions=[]),this._boundInteractions.push(i)),i}},{key:"removeInteraction",value:function(t,e){if(this._boundInteractions){var i=this._boundInteractions.filter((function(i){var n;return w(e)?P(t)?i.type===t:t?i===t:void 0:(null===(n=i.options)||void 0===n?void 0:n.id)===e}));i.length&&i.forEach((function(t){t.unbind()}))}return this}},{key:"removeAllInteractions",value:function(){return this._boundInteractions&&(this._boundInteractions.forEach((function(t){t.unbind()})),this._boundInteractions=null),this}},{key:"initEvent",value:function(){var t=this.renderer.stage();t&&t.on("*",this.delegateEvent)}},{key:"addEventListener",value:function(t,e,i){var n=e;return i&&!1===i.trap||((n=e).raw=e),i&&i.target&&(n.target=i.target),this.on(t,n),this}},{key:"removeEventListener",value:function(t,e){return e?this.off(t,e):this.off(t),this}},{key:"initializeRenderer",value:function(){var t=this._options.width,e=this._options.height;this.renderer=new zz(this),this.renderer.initialize(t,e,this._options,this._eventConfig).background(this._background)}},{key:"initialize",value:function(){var t,e,i=this;this.grammars=new Lj((function(t){return t.id()}),(function(t,e){return i.logger.warn("Grammar id '".concat(t,"' has been occupied"),e)})),this._cachedGrammars=new Oj((function(t){return t.id()})),this._options.logger&&gi.setInstance(this._options.logger),this.logger=gi.getInstance(null!==(t=this._options.logLevel)&&void 0!==t?t:0),this._dataflow=new Dz,this.animate=new Ij(this),this._morph=new Pj,this._options.hooks&&(Object.keys(this._options.hooks).forEach((function(t){i.on(t,i._options.hooks[t])})),this.hooks=this._options.hooks),this.container=null,this.renderer=null,this._eventListeners=[],this._eventConfig=function(t){var e=Object.assign({defaults:{}},t),i=function(t,e){e.forEach((function(e){B(t[e])&&(t[e]=t[e].reduce((function(t,e){return t[e]=!0,t}),{}))}))};return i(e.defaults,["prevent","allow"]),i(e,[xz,bz]),e}(this._options.eventConfig),this._theme=this._options.disableTheme?null:Gj.getDefaultTheme(),this.parseBuiltIn(),(e=this._options).mode&&ux.setEnv(e.mode,e.modeParams||{}),this.initializeRenderer(),this._eventConfig.disable||this.initEvent(),this._bindResizeEvent(),this._currentDataflow=null,this._needBuildLayoutTree=!0,this._layoutState=yw.before,this.theme(this._theme)}},{key:"pauseProgressive",value:function(){return!1}},{key:"resumeProgressive",value:function(){return!1}},{key:"restartProgressive",value:function(){return!1}},{key:"findProgressiveMarks",value:function(){var t=[];return this.traverseMarkTree((function(e){t.push(e)}),(function(t){return t.markType!==sw.group&&t.isProgressive()})),t.length?(this._progressiveMarks=t,this.renderer&&this.renderer.combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}},{key:"doPreProgressive",value:function(){if(this._progressiveMarks&&this._progressiveMarks.some((function(t){return t.isDoingProgressive()}))){var t=ux.getRequestAnimationFrame();this._progressiveRafId=t(this.handleProgressiveFrame)}}},{key:"clearProgressive",value:function(){this._progressiveRafId&&ux.getCancelAnimationFrame()(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach((function(t){t.clearProgressive()})),this._progressiveMarks=null)}},{key:"release",value:function(){var t,e,i;this._isReleased=!0,this._unBindResizeEvent(),this.clearProgressive(),gT.unregisterRuntimeTransforms(),this.animate.stop(),this.grammars.release(),this._cachedGrammars.release(),this._dataflow.release(),this._dataflow=null,null===(e=null===(t=this.renderer)||void 0===t?void 0:t.release)||void 0===e||e.call(t),this.renderer=null,this._boundInteractions=null,this.removeAllListeners(),null===(i=this._eventListeners)||void 0===i||i.forEach((function(t){t.source.removeEventListener(t.type,t.handler)})),this._eventListeners=null}}],[{key:"useRegisters",value:function(t){t.forEach((function(t){t()}))}}]),n}(x),qj=function(){jL(),hL(),gT.registerGraphic(sw.arc,Uy)},Jj=function(){jL(),ML(),gT.registerGraphic(sw.path,Fy)},Qj=function(){jL(),LL(),gT.registerGraphic(sw.rect,dy)},$j=function(){jL(),wL(),gT.registerGraphic(sw.rule,ly)},tH=function(){jL(),NL(),gT.registerGraphic(sw.symbol,ry)},eH=function(){jL(),GL(),FL(),gT.registerGraphic(sw.text,np)},iH=function(){jL(),_L(),gT.registerGraphic(sw.glyph,_y)},nH=function(t){return function(e,i,n){var r,o,a,s=null!==(a=null!==(r=e.getGraphicAttribute("direction",!1))&&void 0!==r?r:null===(o=e.mark.getGlyphConfig())||void 0===o?void 0:o.direction)&&void 0!==a?a:"vertical",l=t(e,s,i);if(!F(l))return{};var u=e.getGraphicAttribute("x",!1),c=e.getGraphicAttribute("y",!1),h=e.getGraphicAttribute("min",!1),d=e.getGraphicAttribute("max",!1),f=e.getGraphicAttribute("q1",!1),p=e.getGraphicAttribute("q3",!1),v=e.getGraphicAttribute("median",!1),y={from:{x:u,y:c},to:{x:u,y:c}};return F(h)&&(y.from.min=l,y.to.min=h),F(d)&&(y.from.max=l,y.to.max=d),F(f)&&(y.from.q1=l,y.to.q1=f),F(p)&&(y.from.q3=l,y.to.q3=p),F(v)&&(y.from.median=l,y.to.median=v),y}},rH=function(t){return function(e,i,n){var r,o,a,s=null!==(a=null!==(r=e.getGraphicAttribute("direction",!1))&&void 0!==r?r:null===(o=e.mark.getGlyphConfig())||void 0===o?void 0:o.direction)&&void 0!==a?a:"vertical",l=t(e,s,i);if(!F(l))return{};var u=e.getGraphicAttribute("x",!0),c=e.getGraphicAttribute("y",!0),h=e.getGraphicAttribute("min",!0),d=e.getGraphicAttribute("max",!0),f=e.getGraphicAttribute("q1",!0),p=e.getGraphicAttribute("q3",!0),v=e.getGraphicAttribute("median",!0),y={from:{x:u,y:c},to:{x:u,y:c}};return F(h)&&(y.to.min=l,y.from.min=h),F(d)&&(y.to.max=l,y.from.max=d),F(f)&&(y.to.q1=l,y.from.q1=f),F(p)&&(y.to.q3=l,y.from.q3=p),F(v)&&(y.to.median=l,y.from.median=v),y}},oH=function(t,e,i){var n,r,o,a,s,l,u,c,h,d,f,p,v,y,g,m,_;if(i&&F(i.center))return i.center;if(pS(e)){v=null===(r=null===(n=t.getGraphicAttribute("points",!1,"median"))||void 0===n?void 0:n[0])||void 0===r?void 0:r.x,y=null===(a=null===(o=t.getGraphicAttribute("points",!1,"max"))||void 0===o?void 0:o[0])||void 0===a?void 0:a.x,g=null===(l=null===(s=t.getGraphicAttribute("points",!1,"min"))||void 0===s?void 0:s[0])||void 0===l?void 0:l.x;var b=t.getGraphicAttribute("width",!1,"box"),x=t.getGraphicAttribute("x",!1,"box");m=x,_=x+b}else{v=null===(c=null===(u=t.getGraphicAttribute("points",!1,"median"))||void 0===u?void 0:u[0])||void 0===c?void 0:c.y,y=null===(d=null===(h=t.getGraphicAttribute("points",!1,"max"))||void 0===h?void 0:h[0])||void 0===d?void 0:d.y,g=null===(p=null===(f=t.getGraphicAttribute("points",!1,"min"))||void 0===f?void 0:f[0])||void 0===p?void 0:p.y;var k=t.getGraphicAttribute("height",!1,"box"),S=t.getGraphicAttribute("y",!1,"box");m=S,_=S+k}return F(v)?v:F(m)&&F(_)?(m+_)/2:F(y)&&F(g)?(y+g)/2:F(g)?g:F(y)?y:NaN},aH=function(t,e,i,n){var r,o,a,s,l,u,c,h,d={shaft:{},box:{},max:{},min:{},median:{}},f=null!==(r=t.x)&&void 0!==r?r:i.getGraphicAttribute("x",!1),p=null!==(o=t.y)&&void 0!==o?o:i.getGraphicAttribute("y",!1),v=null!==(a=t.width)&&void 0!==a?a:i.getGraphicAttribute("width",!1),y=null!==(s=t.height)&&void 0!==s?s:i.getGraphicAttribute("height",!1),g=null!==(l=t.boxWidth)&&void 0!==l?l:i.getGraphicAttribute("boxWidth",!1),m=null!==(u=t.boxHeight)&&void 0!==u?u:i.getGraphicAttribute("boxHeight",!1),_=null!==(c=t.ruleWidth)&&void 0!==c?c:i.getGraphicAttribute("ruleWidth",!1),b=null!==(h=t.ruleHeight)&&void 0!==h?h:i.getGraphicAttribute("ruleHeight",!1);return n&&pS(n.direction)?(F(m)?(Object.assign(d.box,{y:p-m/2,y1:p+m/2}),Object.assign(d.median,{y:p-m/2,y1:p+m/2})):(Object.assign(d.box,{y:p-y/2,y1:p+y/2}),Object.assign(d.median,{y:p-y/2,y1:p+y/2})),F(b)?(Object.assign(d.max,{y:p-b/2,y1:p+b/2}),Object.assign(d.min,{y:p-b/2,y1:p+b/2})):(Object.assign(d.max,{y:p-y/2,y1:p+y/2}),Object.assign(d.min,{y:p-y/2,y1:p+y/2}))):(F(g)?(Object.assign(d.box,{x:f-g/2,x1:f+g/2}),Object.assign(d.median,{x:f-g/2,x1:f+g/2})):(Object.assign(d.box,{x:f-v/2,x1:f+v/2}),Object.assign(d.median,{x:f-v/2,x1:f+v/2})),F(_)?(Object.assign(d.max,{x:f-_/2,x1:f+_/2}),Object.assign(d.min,{x:f-_/2,x1:f+_/2})):(Object.assign(d.max,{x:f-v/2,x1:f+v/2}),Object.assign(d.min,{x:f-v/2,x1:f+v/2}))),d},sH=nH(oH),lH=rH(oH);var uH=function(t,e,i){var n,r,o,a,s,l,u,c,h;if(F(null==i?void 0:i.center))return i.center;if(pS(e)){s=null===(r=null===(n=t.getGraphicAttribute("points",!1,"median"))||void 0===n?void 0:n[0])||void 0===r?void 0:r.x;var d=t.getGraphicAttribute("width",!1,"minMaxBox"),f=t.getGraphicAttribute("x",!1,"minMaxBox");u=f,l=f+d;var p=t.getGraphicAttribute("width",!1,"q1q3Box"),v=t.getGraphicAttribute("x",!1,"q1q3Box");c=v,h=v+p}else{s=null===(a=null===(o=t.getGraphicAttribute("points",!1,"median"))||void 0===o?void 0:o[0])||void 0===a?void 0:a.y;var y=t.getGraphicAttribute("height",!1,"minMaxBox"),g=t.getGraphicAttribute("y",!1,"minMaxBox");u=g,l=g+y;var m=t.getGraphicAttribute("height",!1,"q1q3Box"),_=t.getGraphicAttribute("y",!1,"q1q3Box");c=_,h=_+m}return F(s)?s:F(c)&&F(h)?(c+h)/2:F(l)&&F(u)?(l+u)/2:F(u)?u:F(l)?l:NaN},cH=function(t,e,i,n){var r,o,a,s,l,u,c,h,d={minMaxBox:{},q1q3Box:{},median:{}},f=null!==(r=t.x)&&void 0!==r?r:i.getGraphicAttribute("x",!1),p=null!==(o=t.y)&&void 0!==o?o:i.getGraphicAttribute("y",!1),v=null!==(a=t.width)&&void 0!==a?a:i.getGraphicAttribute("width",!1),y=null!==(s=t.minMaxWidth)&&void 0!==s?s:i.getGraphicAttribute("minMaxWidth",!1),g=null!==(l=t.q1q3Width)&&void 0!==l?l:i.getGraphicAttribute("q1q3Width",!1),m=null!==(u=t.height)&&void 0!==u?u:i.getGraphicAttribute("height",!1),_=null!==(c=t.minMaxHeight)&&void 0!==c?c:i.getGraphicAttribute("minMaxHeight",!1),b=null!==(h=t.q1q3Height)&&void 0!==h?h:i.getGraphicAttribute("q1q3Height",!1);return n&&pS(n.direction)?(F(_)?Object.assign(d.minMaxBox,{y:p-_/2,y1:p+_/2}):Object.assign(d.minMaxBox,{y:p-m/2,y1:p+m/2}),F(b)?(Object.assign(d.q1q3Box,{y:p-b/2,y1:p+b/2}),Object.assign(d.median,{y:p-b/2,y1:p+b/2})):(Object.assign(d.q1q3Box,{y:p-m/2,y1:p+m/2}),Object.assign(d.median,{y:p-m/2,y1:p+m/2}))):(F(y)?Object.assign(d.minMaxBox,{x:f-y/2,x1:f+y/2}):Object.assign(d.minMaxBox,{x:f-v/2,x1:f+v/2}),F(g)?(Object.assign(d.q1q3Box,{x:f-g/2,x1:f+g/2}),Object.assign(d.median,{x:f-g/2,x1:f+g/2})):(Object.assign(d.q1q3Box,{x:f-v/2,x1:f+v/2}),Object.assign(d.median,{x:f-v/2,x1:f+v/2}))),d},hH=nH(uH),dH=rH(uH);var fH=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,o=t.x0,a=t.x1,s=t.y0,l=t.y1,u=o+n*(a-o),c=a+n*(o-a),h=function(t){return t};!1!==t.round&&(o=Math.round(o),a=Math.round(a),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(s=h(t.y0-r/2),l=h(t.y1-r/2)):"end"===t.align?(s=h(t.y0+t.thickness/2-r),l=h(t.y1+t.thickness/2-r)):(s=h(t.y0-t.thickness/2),l=h(t.y1-t.thickness/2));var d=h(s+r),f=h(l+r),p=Math.abs(a-o)>1e-6,v=t.endArrow&&p?"L".concat(a,",").concat(h(l-r/2),"L").concat(h(a+r),",").concat(h((l+f)/2),"L").concat(a,",").concat(h(f+r/2)):"",y=t.startArrow&&p?"L".concat(o,",").concat(h(d+r/2),"L").concat(h(o-r),",").concat(h((s+d)/2),"L").concat(o,",").concat(h(s-r/2)):"";return"line"===t.pathType?"M".concat(o,",").concat(s,"L").concat(a,",").concat(l).concat(v,"L").concat(a,",").concat(f,"L").concat(o,",").concat(d).concat(y,"Z"):"polyline"===t.pathType?"M".concat(o,",").concat(s,"L").concat(u,",").concat(s,"L").concat(u,",").concat(l,"L").concat(a,",").concat(l,"\n    ").concat(v,"L").concat(a,",").concat(f,"L").concat(u,",").concat(f,"L").concat(u,",").concat(d,"L").concat(o,",").concat(d).concat(y,"Z"):"M".concat(o,",").concat(s,"C").concat(u,",").concat(s,",").concat(c,",").concat(l,",").concat(a,",").concat(l,"\n  ").concat(v,"L").concat(a,",").concat(f,"C").concat(c,",").concat(f,",").concat(u,",").concat(d,",").concat(o,",").concat(d).concat(y,"Z")},pH=function(t,e){var i,n=null!==(i=t.curvature)&&void 0!==i?i:.5,r="number"==typeof e?t.thickness*e:t.thickness,o=t.y0,a=t.y1,s=t.x0,l=t.x1,u=o+n*(a-o),c=a+n*(o-a),h=function(t){return t};!1!==t.round&&(h=Math.round,o=Math.round(o),a=Math.round(a),s=Math.round(s),l=Math.round(l),u=Math.round(u),c=Math.round(c)),"line"===t.pathType||t.pathType,"center"===t.align?(s=h(t.x0-r/2),l=h(t.x1-r/2)):"end"===t.align?(s=h(t.x0+t.thickness/2-r),l=h(t.x1+t.thickness/2-r)):(s=h(t.x0-t.thickness/2),l=h(t.x1-t.thickness/2));var d=h(s+r),f=h(l+r),p=Math.abs(a-o)>1e-6,v=t.endArrow&&p?"L".concat(h(l-r/2),",").concat(a,"L").concat(h((l+f)/2),",").concat(h(a+r),"L").concat(h(f+r/2),",").concat(a):"",y=t.startArrow&&p?"L".concat(h(d+r/2),",").concat(o,"L").concat(h((d+s)/2),",").concat(h(o-r),"L").concat(h(s-r/2),",").concat(o):"";return"line"===t.pathType?"M".concat(s,",").concat(o,"L").concat(l,",").concat(a).concat(v,"L").concat(f,",").concat(a,"L").concat(d,",").concat(o).concat(y,"Z"):"polyline"===t.pathType?"M".concat(s,",").concat(o,"L").concat(s,",").concat(u,"L").concat(l,",").concat(u,"L").concat(l,",").concat(a,"\n    ").concat(v,"L").concat(f,",").concat(a,"L").concat(f,",").concat(u,"L").concat(d,",").concat(u,"L").concat(d,",").concat(o).concat(y,"Z"):"M".concat(s,",").concat(o,"C").concat(s,",").concat(u,",").concat(l,",").concat(c,",").concat(l,",").concat(a,"\n  ").concat(v,"L").concat(f,",").concat(a,"C").concat(f,",").concat(c,",").concat(d,",").concat(u,",").concat(d,",").concat(o).concat(y,"Z")},vH=function(t,e,i,n){var r,o=null!==(r=t.direction)&&void 0!==r?r:null==n?void 0:n.direction,a=["vertical","TB","BT"].includes(o)?pH:fH,s="number"==typeof t.ratio&&t.ratio>=0&&t.ratio<=1,l=Object.keys(t);return["x0","y0","x1","y1"].every((function(t){return l.includes(t)}))?{back:{path:s?a(t,1):""},front:{path:a(t,s?t.ratio:1)}}:{}},yH=function(t,e,i){var n={x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1),thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach((function(t){w(n[t])&&delete n[t]})),{from:Object.assign({},n,{x1:n.x0,y1:n.y0}),to:n}},gH=function(t,e,i){var n={x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0),thickness:t.getGraphicAttribute("thickness",!0),round:t.getGraphicAttribute("round",!0),align:t.getGraphicAttribute("align",!0),pathType:t.getGraphicAttribute("pathType",!0),endArrow:t.getGraphicAttribute("endArrow",!0),startArrow:t.getGraphicAttribute("startArrow",!0)};return Object.keys(n).forEach((function(t){w(n[t])&&delete n[t]})),{from:n,to:Object.assign({},n,{x1:n.x0,y1:n.y0})}},mH=function(t,e,i){var n={thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach((function(t){w(n[t])&&delete n[t]})),{from:Object.assign(Object.assign({x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0)},n),n),to:Object.assign({x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1)},n)}};function _H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var bH=function(t){ue(i,t);var e=_H(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"parseAddition",value:function(t){return Xs(de(i.prototype),"parseAddition",this).call(this,t),this.scale(t.scale),this}},{key:"scale",value:function(t){if(this.spec.scale){var e=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this.detach(e),this.spec.scale=void 0}var i=P(t)?this.view.getScaleById(t):t;return this.spec.scale=i,this.attach(i),this._updateComponentEncoders(),this.commit(),this}},{key:"getScale",value:function(){return P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale}}]),i}(Uj);function xH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var kH=function(t,e,i,n,r,o){var a,s=t.getCoordinateAxisPosition();r&&"auto"===r.position&&(r.position=i?"content":s);var l=t.getCoordinateAxisPoints(n);if(l){var u={start:l[0],end:l[1],verticalFactor:("top"===s||"left"===s?-1:1)*(i?-1:1)*((null===(a=t.getSpec().range)||void 0===a?void 0:a.reversed)?-1:1)};if(o&&"polar"===e.type){var c=e.angle();u.center=e.origin(),u.startAngle=c[0],u.endAngle=c[1]}return u}var h=e.radius(),d=e.angle();return{center:e.origin(),radius:h[1],innerRadius:h[0],inside:i,startAngle:d[0],endAngle:d[1]}},SH=function(t){ue(i,t);var e=xH(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,t,lw.axis,n)).spec.componentType=lw.axis,o.mode=r,o}return zt(i,[{key:"parseAddition",value:function(t){return Xs(de(i.prototype),"parseAddition",this).call(this,t),this.axisType(t.axisType),this.tickCount(t.tickCount),this.inside(t.inside),this.baseValue(t.baseValue),this}},{key:"scale",value:function(t){return Xs(de(i.prototype),"scale",this).call(this,t),this._axisComponentType=null,this}},{key:"axisType",value:function(t){return this.spec.axisType=t,this._axisComponentType=null,this._prepareRejoin(),this.commit(),this}},{key:"addGraphicItem",value:function(t,e){var n=Q({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=gT.createGraphicComponent(this._getAxisComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return Xs(de(i.prototype),"addGraphicItem",this).call(this,n,e,r)}},{key:"tickCount",value:function(t){var e=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}},{key:"inside",value:function(t){return this.setFunctionSpec(t,"inside")}},{key:"baseValue",value:function(t){return this.setFunctionSpec(t,"baseValue")}},{key:"getAxisComponentType",value:function(){return this._axisComponentType}},{key:"_updateComponentEncoders",value:function(){var t=this,e=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale,i=Object.assign({update:{}},this.spec.encode),n=Object.keys(i).reduce((function(n,r){var o=i[r];return o&&(n[r]={callback:function(i,n,r){var a,s,l=t.spec.skipTheme?null:t.view.getCurrentTheme(),u=_T(o,i,n,r),c=aT(t.spec.inside,r,i,n),h=aT(t.spec.baseValue,r,i,n),d=null===(a=null==e?void 0:e.getCoordinate)||void 0===a?void 0:a.call(e);d&&(u=Object.assign(kH(e,d,c,h,t.spec.layout),u));var f=null===(s=null==e?void 0:e.getScale)||void 0===s?void 0:s.call(e),p=aT(t.spec.tickCount,r,i,n);switch(t._getAxisComponentType()){case cw.lineAxis:return function(t,e,i,n){var r,o,a,s,l=null!==(o=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.axis)&&void 0!==o?o:{};return t?Q({},l,{items:[(null!==(s=null===(a=t.tickData)||void 0===a?void 0:a.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))]},null!=i?i:{}):Q({},l,null!=i?i:{})}(f,l,u,p);case cw.circleAxis:return function(t,e,i,n){var r,o,a,s,l=null!==(o=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.circleAxis)&&void 0!==o?o:{};return t?Q({},l,{items:[(null!==(s=null===(a=t.tickData)||void 0===a?void 0:a.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))]},null!=i?i:{}):Q({},l,null!=i?i:{})}(f,l,u,p)}return u}}),n}),{});this._encoders=n}},{key:"_getAxisComponentType",value:function(){var t;if(this._axisComponentType)return this._axisComponentType;var e=this.spec.axisType;if(w(e)){var i=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;e=(null===(t=null==i?void 0:i.getCoordinate)||void 0===t?void 0:t.call(i))?i.getCoordinateAxisPoints()?"line":"circle":"line"}return this._axisComponentType="circle"===e?cw.circleAxis:cw.lineAxis,this._axisComponentType}}]),i}(bH);SH.componentType=lw.axis;function AH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var wH=function(t){ue(i,t);var e=AH(i);function i(t,n){var r;return jt(this,i),(r=e.call(this,t,lw.label,n)).spec.componentType=lw.label,r}return zt(i,[{key:"parseAddition",value:function(t){return Xs(de(i.prototype),"parseAddition",this).call(this,t),this.labelStyle(t.labelStyle),this.size(t.size),this.target(t.target),this}},{key:"labelStyle",value:function(t){return this.setFunctionSpec(t,"labelStyle")}},{key:"size",value:function(t){return this.setFunctionSpec(t,"size")}},{key:"target",value:function(t){var e=this;if(this.spec.target){var i=lt(this.spec.target).map((function(t){return P(t)?e.view.getMarkById(t):t}));this.detach(i)}if(this.spec.target=t,t){var n=lt(t).map((function(t){return P(t)?e.view.getMarkById(t):t}));this.attach(n)}return this.commit(),this}},{key:"_updateComponentEncoders",value:function(){var t=this,e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((function(i,n){var r=e[n];return r&&(i[n]={callback:function(e,i,n){var o,a,s,l,u=lt(t.spec.target).map((function(e){return P(e)?t.view.getMarkById(e):e})),c=null===(a=null===(o=t.group)||void 0===o?void 0:o.getGroupGraphicItem)||void 0===a?void 0:a.call(o),h=aT(t.spec.size,n);h||(h=c?{width:null!==(s=c.attribute.width)&&void 0!==s?s:c.AABBBounds.width(),height:null!==(l=c.attribute.height)&&void 0!==l?l:c.AABBBounds.height()}:{width:1/0,height:1/0});var d=t.spec.skipTheme?null:t.view.getCurrentTheme();return function(t,e,i,n,r){var o,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=null===(o=a.components)||void 0===o?void 0:o.dataLabel,l=t.map((function(t,e){var o,s,l,u,c,h=Object.assign(Object.assign({},r),{labelIndex:e}),d=null!==(o=aT(n,h,t))&&void 0!==o?o:{},f=a.components,p=void 0===f?{}:f,v={};switch(t.markType){case sw.line:case sw.area:v="line"===d.type?p.lineLabel:"area"===d.type?p.areaLabel:p.lineDataLabel;break;case sw.rect:case sw.rect3d:case sw.interval:v=p.rectLabel;break;case sw.symbol:case sw.circle:case sw.cell:v=p.symbolLabel;break;case sw.arc:case sw.arc3d:v=p.arcLabel;break;case sw.polygon:case sw.path:default:v=p.pointLabel}var y=null!==(s=d.data)&&void 0!==s?s:[],g=null!==(u=null===(l=null==v?void 0:v.data)||void 0===l?void 0:l[0])&&void 0!==u?u:{};y&&y.length>0?y.forEach((function(e,n){if(t.elements[n]){var r=_T(i,e,t.elements[n],h);Q(e,g,r)}})):t.elements.forEach((function(e){if("willRelease"!==e.getGraphicItem().releaseStatus)if(t.isCollectionMark())e.getDatum().forEach((function(t){var n=_T(i,t,e,h);y.push(Q({},g,n))}));else{var n=_T(i,e.getDatum(),e,h),r=Q({},g,n);y.push(r)}}));var m=null===(c=t.graphicItem)||void 0===c?void 0:c.name;return Q({},v,{data:y,baseMarkGroupName:m,getBaseMarks:function(){return t.elements.map((function(t){return t.getGraphicItem()}))}},null!=d?d:{})})).filter((function(t){return!w(t)}));return Q({},s,{size:e,dataLabels:l})}(u,h,r,t.spec.labelStyle,n,d)}}),i}),{});this._encoders=i}}]),i}(Uj);wH.componentType=lw.label;var TH=function(){gT.registerGraphicComponent(lw.label,(function(t){return new EI(t)})),gT.registerComponent(lw.label,wH)};function MH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var CH=function(t){ue(i,t);var e=MH(i);function i(t,n,r){var o;return jt(this,i),(o=e.call(this,t,lw.grid,n)).spec.componentType=lw.grid,o.mode=r,o}return zt(i,[{key:"parseAddition",value:function(t){return Xs(de(i.prototype),"parseAddition",this).call(this,t),this.target(t.target),this.gridType(t.gridType),this.gridShape(t.gridShape),this}},{key:"scale",value:function(t){return Xs(de(i.prototype),"scale",this).call(this,t),this._gridComponentType=null,this}},{key:"gridType",value:function(t){return this.spec.gridType=t,this._gridComponentType=null,this._prepareRejoin(),this.commit(),this}},{key:"gridShape",value:function(t){return this.spec.gridShape=t,this.commit(),this}},{key:"target",value:function(t){if(this.spec.target){var e=P(this.spec.target)?this.view.getMarkById(this.spec.target):this.spec.target;this.detach(e)}this.spec.target=t;var i=P(t)?this.view.getMarkById(t):t;return this.attach(i),this._targetAxis=i,this._gridComponentType=null,this._updateComponentEncoders(),this.commit(),this}},{key:"tickCount",value:function(t){var e=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}},{key:"inside",value:function(t){return this.setFunctionSpec(t,"inside")}},{key:"baseValue",value:function(t){return this.setFunctionSpec(t,"baseValue")}},{key:"addGraphicItem",value:function(t,e){var n=Q({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=gT.createGraphicComponent(this._getGridComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return Xs(de(i.prototype),"addGraphicItem",this).call(this,n,e,r)}},{key:"_updateComponentEncoders",value:function(){var t=this,e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((function(i,n){var r=e[n];return r&&(i[n]={callback:function(e,i,n){var o,a,s,l,u,c=t.spec.skipTheme?null:t.view.getCurrentTheme(),h=_T(r,e,i,n),d=aT(t.spec.baseValue,n,e,i);if(t._targetAxis){var f=null===(o=t._targetAxis.getSpec())||void 0===o?void 0:o.scale;u=P(f)?t.view.getScaleById(f):f;var p=t._targetAxis.elements[0];if(p)switch(t._getGridComponentType()){case hw.lineAxisGrid:h=Object.assign({x:p.getGraphicAttribute("x"),y:p.getGraphicAttribute("y"),start:p.getGraphicAttribute("start"),end:p.getGraphicAttribute("end"),verticalFactor:null!==(a=p.getGraphicAttribute("verticalFactor"))&&void 0!==a?a:1},h);break;case hw.circleAxisGrid:h=Object.assign({x:p.getGraphicAttribute("x"),y:p.getGraphicAttribute("y"),center:p.getGraphicAttribute("center"),radius:p.getGraphicAttribute("radius"),innerRadius:p.getGraphicAttribute("innerRadius"),inside:p.getGraphicAttribute("inside"),startAngle:p.getGraphicAttribute("startAngle"),endAngle:p.getGraphicAttribute("endAngle")},h)}}else{u=P(t.spec.scale)?t.view.getScaleById(t.spec.scale):t.spec.scale;var v=aT(t.spec.inside,n,e,i),y=null===(s=null==u?void 0:u.getCoordinate)||void 0===s?void 0:s.call(u);y&&(h=Object.assign(kH(u,y,v,d,t.spec.layout,!0),h))}t._getGridComponentType()===hw.lineAxisGrid&&(h="line"!==t.spec.gridShape&&t.spec.gridShape?Object.assign({center:h.start,closed:!0},h,{type:t.spec.gridShape}):Object.assign({},h,{type:"line"}));var g=null===(l=null==u?void 0:u.getScale)||void 0===l?void 0:l.call(u),m=aT(t.spec.tickCount,n,e,i);switch(t._getGridComponentType()){case hw.lineAxisGrid:return function(t,e,i,n){var r,o,a,s,l=null!==(o=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.grid)&&void 0!==o?o:{};return t?Q({},l,{items:(null!==(s=null===(a=t.tickData)||void 0===a?void 0:a.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))},null!=i?i:{}):Q({},l,null!=i?i:{})}(g,c,h,m);case hw.circleAxisGrid:return function(t,e,i,n){var r,o,a,s,l=null!==(o=null===(r=null==e?void 0:e.components)||void 0===r?void 0:r.circleGrid)&&void 0!==o?o:{};return t?Q({},l,{items:(null!==(s=null===(a=t.tickData)||void 0===a?void 0:a.call(t,n))&&void 0!==s?s:[]).map((function(t){return{id:t.index,label:t.tick,value:t.value,rawValue:t.tick}}))},null!=i?i:{}):Q({},l,null!=i?i:{})}(g,c,h,m)}return h}}),i}),{});this._encoders=i}},{key:"_getGridComponentType",value:function(){var t;if(this._gridComponentType)return this._gridComponentType;if(this.spec.gridType)"circle"===this.spec.gridType?this._gridComponentType=hw.circleAxisGrid:this._gridComponentType=hw.lineAxisGrid;else if(this._targetAxis)switch(this._targetAxis.getAxisComponentType()){case cw.circleAxis:this._gridComponentType=hw.circleAxisGrid;break;case cw.lineAxis:default:this._gridComponentType=hw.lineAxisGrid}else if(this.spec.scale){var e=P(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this._gridComponentType=(null===(t=null==e?void 0:e.getCoordinate)||void 0===t?void 0:t.call(e))?e.getCoordinateAxisPoints()?hw.lineAxisGrid:hw.circleAxisGrid:hw.lineAxisGrid}else this._gridComponentType=hw.lineAxisGrid;return this._gridComponentType}}]),i}(bH);CH.componentType=lw.grid;var EH=function(t,e,i){return e.filter((function(e){return t.callback(e,i)}))},RH=function(t,e,i){var n=t.callback,r=t.as;if(!t.all)return e.forEach((function(t){var e=n(t,i);if(!w(r)){if(w(t))return;t[r]=e}return e})),e;var o=n(e,i);return w(r)||w(e)?o:(e[r]=o,e)};function PH(t){return t.reduce((function(t,e){return t+e}),0)}var BH={min:ht,max:ct,average:function(t){return 0===t.length?0:PH(t)/t.length},sum:PH};function LH(t,e,i,n){var r,o,a,s=Math.floor(e.length/t),l=[],u=e.length,c=0,h=0;l[h++]=c;for(var d=1;d<u-1;d+=s){for(var f=Math.min(d+s,u-1),p=Math.min(d+2*s,u),v=(p+f)/2,y=0,g=f;g<p;g++){var m=e[g][n];Number.isNaN(m)||(y+=m)}y/=p-f;var _=d,b=Math.min(d+s,u),x=d-1,k=e[c][n];r=-1,a=_;for(var S=_;S<b;S++){var A=e[S][n];Number.isNaN(n)||(o=Math.abs((x-v)*(A-k)-(x-S)*(y-k)))>r&&(r=o,a=S)}l[h++]=a,c=a}return l[h-1]!==u-1&&(l[h++]=u-1),l.map((function(t){return i?e[t].i:t}))}function OH(t,e,i,n,r){var o=Math.floor(e.length/t),a=[],s=e.length,l=0,u=[];a.push(l),e[l][r]=e[l][r];for(var c=1;c<s-1;c+=o){o>s-c&&(o=s-c,u.length=o),u=[];for(var h=0;h<o;h++)u.push(e[c+h][r]);var d=BH[n](u);l=Math.min(Math.round(c+u.length/2)||0,s-1),e[l][r]=d,a.push(l)}return a.map((function(t){return i?e[t].i:t}))}function IH(t,e,i,n){return OH(t,e,i,"min",n)}function DH(t,e,i,n){return OH(t,e,i,"max",n)}function FH(t,e,i,n){return OH(t,e,i,"average",n)}function zH(t,e,i,n){return OH(t,e,i,"sum",n)}var jH=function(t,e){var i=t.size,n=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=n)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);var r=t.mode,o=t.yfield,a=t.groupBy,s=null!=o?o:"y",l=LH;if("min"===r?l=IH:"max"===r?l=DH:"average"===r?l=FH:"sum"===r&&(l=zH),e.length){var u={};if(a){for(var c=0,h=e.length;c<h;c++){var d=e[c],f=d[a];u[f]||(u[f]=[]),u[f].push(v(v({},s,d[s]),"i",c))}var p=[];return Object.keys(u).forEach((function(t){var n=u[t];if(n.length<=i){var r=n.map((function(t){return t.i}));p=p.concat(r)}else{var o=l(i,n,!0,s);p=p.concat(o),n.forEach((function(t){return e[t.i][s]=t[s]}))}})),p.sort((function(t,e){return t-e})),p.map((function(t){return e[t]}))}return l(i,e,!1,s).map((function(t){return e[t]}))}return[]},HH="_mo_hide_";var NH=function(t,e){if(e&&0!==e.length){var i=t.radius;w(i)&&"symbol"===e[0].mark.markType&&(i=!0);var n=t.direction,r=t.delta,o=t.deltaMul,a=void 0===o?1:o,s=t.groupBy,l=function(t){!function(t){t.forEach((function(t){t.getGraphicAttribute("HIDE_KEY")&&(t.setGraphicAttribute("visible",!0),t.setGraphicAttribute(HH,!1))}))}(t);var e=t.slice().sort((function(t,e){return t.getGraphicAttribute("x")-e.getGraphicAttribute("x")}));0===n?function(t,e,i,n){if(n){var r=-1/0,o=0,a=w(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("x"),l=t.getGraphicAttribute("y");a&&(s=(e+o)*i),Math.pow(-1/0-n,2)+Math.pow(r-l,2)<Math.pow(s+o+e,2)?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(HH,!0),t.setGraphicAttribute("visible",!1)):r=l,o=e}}))}}(e,r,a,i):1===n?function(t,e,i,n){if(n){var r=-1/0,o=0,a=w(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("x");a&&(s=(e+o)*i),Math.abs(n-r)<s+o+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(HH,!0),t.setGraphicAttribute("visible",!1)):r=n,o=e}}))}}(e,r,a,i):function(t,e,i,n){if(n){var r=-1/0,o=0,a=w(e),s=e;t.forEach((function(t){if(!1!==t.getGraphicAttribute("visible")){var e=t.getGraphicAttribute("size")/2,n=t.getGraphicAttribute("y");a&&(s=(e+o)*i),Math.abs(n-r)<s+o+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(HH,!0),t.setGraphicAttribute("visible",!1)):r=n,o=e}}))}}(e,r,a,i)};if(s){var u=e.reduce((function(t,e){var i=e.getDatum()[s];return t[i]?t[i].push(e):t[i]=[e],t}),{});Object.keys(u).forEach((function(t){l(u[t])}))}else l(e);return e}},VH=function(){gT.registerTransform("filter",{transform:EH,markPhase:"beforeJoin"},!0)},GH=function(){gT.registerTransform("map",{transform:RH,markPhase:"beforeJoin"},!0)},WH=function(){gT.registerTransform("sampling",{transform:jH,markPhase:"afterEncode"},!0)},UH=function(){gT.registerTransform("markoverlap",{transform:NH,markPhase:"afterEncode"},!0)},YH=function(t,e,i){var n,r=t.getGraphicAttribute("clipRangeByDimension",!1),o=null!==(n=t.getGraphicAttribute("clipRange",!1))&&void 0!==n?n:1;return e&&e.clipDimension?{from:{clipRange:0,clipRangeByDimension:e.clipDimension},to:{clipRange:o,clipRangeByDimension:r}}:{from:{clipRange:0},to:{clipRange:o}}},KH=function(t,e,i){var n,r=t.getGraphicAttribute("clipRangeByDimension",!0),o=null!==(n=t.getGraphicAttribute("clipRange",!0))&&void 0!==n?n:1;return e&&e.clipDimension?{from:{clipRange:o,clipRangeByDimension:e.clipDimension},to:{clipRange:0,clipRangeByDimension:r}}:{from:{clipRange:o},to:{clipRange:0}}},XH=function(t,e,i){var n,r,o;return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(n=t.getGraphicAttribute("opacity",!1))&&void 0!==n?n:1,fillOpacity:null!==(r=t.getGraphicAttribute("fillOpacity",!1))&&void 0!==r?r:1,strokeOpacity:null!==(o=t.getGraphicAttribute("strokeOpacity",!1))&&void 0!==o?o:1}}},ZH=function(t,e,i){var n,r,o;return{from:{opacity:null!==(n=t.getGraphicAttribute("opacity",!0))&&void 0!==n?n:1,fillOpacity:null!==(r=t.getGraphicAttribute("fillOpacity",!0))&&void 0!==r?r:1,strokeOpacity:null!==(o=t.getGraphicAttribute("strokeOpacity",!0))&&void 0!==o?o:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}},qH=function(t,e,i){switch(null==e?void 0:e.direction){case"x":var n=t.getGraphicAttribute("x",!1),r=t.getGraphicAttribute("x1",!1),o=t.getGraphicAttribute("width",!1);return{from:T(o)?{x:n+o/2,x1:void 0,width:0}:{x:(n+r)/2,x1:(n+r)/2,width:void 0},to:{x:n,x1:r,width:o}};case"y":var a=t.getGraphicAttribute("y",!1),s=t.getGraphicAttribute("y1",!1),l=t.getGraphicAttribute("height",!1);return{from:T(l)?{y:a+l/2,y1:void 0,height:0}:{y:(a+s)/2,y1:(a+s)/2,height:void 0},to:{y:a,y1:s,height:l}};default:var u=t.getGraphicAttribute("x",!1),c=t.getGraphicAttribute("x1",!1),h=t.getGraphicAttribute("width",!1),d=t.getGraphicAttribute("y",!1),f=t.getGraphicAttribute("y1",!1),p=t.getGraphicAttribute("height",!1),v={};return T(h)?(v.x=u+h/2,v.width=0,v.x1=void 0):(v.x=(u+c)/2,v.x1=(u+c)/2,v.width=void 0),T(p)?(v.y=d+p/2,v.height=0,v.y1=void 0):(v.y=(d+f)/2,v.y1=(d+f)/2,v.height=void 0),{from:v,to:{x:u,y:d,x1:c,y1:f,width:h,height:p}}}},JH=function(t,e,i){switch(null==e?void 0:e.direction){case"x":var n=t.getGraphicAttribute("x",!1),r=t.getGraphicAttribute("x1",!1),o=t.getGraphicAttribute("width",!1);return{to:T(o)?{x:n+o/2,x1:void 0,width:0}:{x:(n+r)/2,x1:(n+r)/2,width:void 0}};case"y":var a=t.getGraphicAttribute("y",!1),s=t.getGraphicAttribute("y1",!1),l=t.getGraphicAttribute("height",!1);return{to:T(l)?{y:a+l/2,y1:void 0,height:0}:{y:(a+s)/2,y1:(a+s)/2,height:void 0}};default:var u=t.getGraphicAttribute("x",!1),c=t.getGraphicAttribute("y",!1),h=t.getGraphicAttribute("x1",!1),d=t.getGraphicAttribute("y1",!1),f=t.getGraphicAttribute("width",!1),p=t.getGraphicAttribute("height",!1),v={};return T(f)?(v.x=u+f/2,v.width=0,v.x1=void 0):(v.x=(u+h)/2,v.x1=(u+h)/2,v.width=void 0),T(p)?(v.y=c+p/2,v.height=0,v.y1=void 0):(v.y=(c+d)/2,v.y1=(c+d)/2,v.height=void 0),{to:v}}};var QH=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,o=t.getGraphicAttribute("x",!1),a=t.getGraphicAttribute("x1",!1),s=t.getGraphicAttribute("width",!1);return e&&"negative"===e.orient?I(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=I(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:r,x1:w(a)?void 0:r,width:w(s)?void 0:0},to:{x:o,x1:a,width:s}}}(t,e,i):function(t,e,i){var n=t.getGraphicAttribute("x",!1),r=t.getGraphicAttribute("x1",!1),o=t.getGraphicAttribute("width",!1);if(e&&"negative"===e.orient){var a=T(o)?Math.max(n,n+o):Math.max(n,r);return{from:{x:a,x1:w(r)?void 0:a,width:w(o)?void 0:0},to:{x:n,x1:r,width:o}}}var s=T(o)?Math.min(n,n+o):Math.min(n,r);return{from:{x:s,x1:w(r)?void 0:s,width:w(o)?void 0:0},to:{x:n,x1:r,width:o}}}(t,e)};var $H=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,o=t.getGraphicAttribute("x1",!1),a=t.getGraphicAttribute("width",!1);return e&&"negative"===e.orient?I(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r):r=i.width:r=I(null==e?void 0:e.overall)?e.overall:0,{to:{x:r,x1:w(o)?void 0:r,width:w(a)?void 0:0}}}(t,e,i):function(t,e,i){var n=t.getGraphicAttribute("x",!1),r=t.getGraphicAttribute("x1",!1),o=t.getGraphicAttribute("width",!1);if(e&&"negative"===e.orient){var a=T(o)?Math.max(n,n+o):Math.max(n,r);return{to:{x:a,x1:w(r)?void 0:a,width:w(o)?void 0:0}}}var s=T(o)?Math.min(n,n+o):Math.min(n,r);return{to:{x:s,x1:w(r)?void 0:s,width:w(o)?void 0:0}}}(t,e)};var tN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,o=t.getGraphicAttribute("y",!1),a=t.getGraphicAttribute("y1",!1),s=t.getGraphicAttribute("height",!1);return e&&"negative"===e.orient?I(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r):r=i.height:r=I(null==e?void 0:e.overall)?e.overall:0,{from:{y:r,y1:w(a)?void 0:r,height:w(s)?void 0:0},to:{y:o,y1:a,height:s}}}(t,e,i):function(t,e,i){var n=t.getGraphicAttribute("y",!1),r=t.getGraphicAttribute("y1",!1),o=t.getGraphicAttribute("height",!1);if(e&&"negative"===e.orient){var a=T(o)?Math.max(n,n+o):Math.max(n,r);return{from:{y:a,y1:w(r)?void 0:a,height:w(o)?void 0:0},to:{y:n,y1:r,height:o}}}var s=T(o)?Math.min(n,n+o):Math.min(n,r);return{from:{y:s,y1:w(r)?void 0:s,height:w(o)?void 0:0},to:{y:n,y1:r,height:o}}}(t,e)};var eN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n,r,o=t.getGraphicAttribute("y1",!1),a=t.getGraphicAttribute("height",!1);return e&&"negative"===e.orient?I(e.overall)?r=e.overall:i.group?(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r):r=i.height:r=I(null==e?void 0:e.overall)?e.overall:0,{to:{y:r,y1:w(o)?void 0:r,height:w(a)?void 0:0}}}(t,e,i):function(t,e,i){var n=t.getGraphicAttribute("y",!1),r=t.getGraphicAttribute("y1",!1),o=t.getGraphicAttribute("height",!1);if(e&&"negative"===e.orient){var a=T(o)?Math.max(n,n+o):Math.max(n,r);return{to:{y:a,y1:w(r)?void 0:a,height:w(o)?void 0:0}}}var s=T(o)?Math.min(n,n+o):Math.min(n,r);return{to:{y:s,y1:w(r)?void 0:s,height:w(o)?void 0:0}}}(t,e)},iN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){if(e&&"anticlockwise"===e.orient){var n=I(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:n,endAngle:n},to:{startAngle:t.getGraphicAttribute("startAngle",!1),endAngle:t.getGraphicAttribute("endAngle",!1)}}}var r=I(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:r,endAngle:r},to:{startAngle:t.getGraphicAttribute("startAngle",!1),endAngle:t.getGraphicAttribute("endAngle",!1)}}}(t,e):function(t,e,i){return e&&"anticlockwise"===e.orient?{from:{startAngle:t.getGraphicAttribute("endAngle",!1)},to:{startAngle:t.getGraphicAttribute("startAngle",!1)}}:{from:{endAngle:t.getGraphicAttribute("startAngle",!1)},to:{endAngle:t.getGraphicAttribute("endAngle",!1)}}}(t,e)},nN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){if(e&&"anticlockwise"===e.orient){var n=I(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:n,endAngle:n}}}var r=I(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:r,endAngle:r}}}(t,e):function(t,e,i){return e&&"anticlockwise"===e.orient?{from:{startAngle:t.getGraphicAttribute("startAngle",!0)},to:{startAngle:t.getGraphicAttribute("endAngle",!1)}}:{from:{endAngle:t.getGraphicAttribute("endAngle",!0)},to:{endAngle:t.getGraphicAttribute("startAngle",!1)}}}(t,e)},rN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=I(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:n,outerRadius:n},to:{innerRadius:t.getGraphicAttribute("innerRadius",!1),outerRadius:t.getGraphicAttribute("outerRadius",!1)}}}(t,e):function(t,e,i){return e&&"inside"===e.orient?{from:{innerRadius:t.getGraphicAttribute("outerRadius",!1)},to:{innerRadius:t.getGraphicAttribute("innerRadius",!1)}}:{from:{outerRadius:t.getGraphicAttribute("innerRadius",!1)},to:{outerRadius:t.getGraphicAttribute("outerRadius",!1)}}}(t,e)},oN=function(t,e,i){var n;return!1!==(null!==(n=null==e?void 0:e.overall)&&void 0!==n&&n)?function(t,e,i){var n=I(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0),outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{innerRadius:n,outerRadius:n}}}(t,e):function(t,e,i){return e&&"inside"===e.orient?{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0)},to:{innerRadius:t.getGraphicAttribute("outerRadius",!1)}}:{from:{outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{outerRadius:t.getGraphicAttribute("innerRadius",!1)}}}(t,e)},aN=function(t,e,i){var n=t.getGraphicAttribute("points",!1),r={x:0,y:0};return n.forEach((function(t){r.x+=t.x,r.y+=t.y})),r.x/=n.length,r.y/=n.length,e&&e.center&&(F(e.center.x)&&(r.x=e.center.x),F(e.center.y)&&(r.y=e.center.y)),"area"===t.mark.markType&&(r.x1=r.x,r.y1=r.y),n.map((function(){return Object.assign(r)}))},sN=function(t,e,i){return{from:{points:aN(t,e)},to:{points:t.getGraphicAttribute("points",!1)}}},lN=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:aN(t,e)}}},uN=function(t,e,i){return t.getGraphicAttribute("points",!1).map((function(t){var n;if(e&&"negative"===e.orient){var r=i.width;return i.group&&(r=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),i.groupWidth=r),{x:r,y:t.y,x1:r,y1:t.y1,defined:!1!==t.defined}}return{x:0,y:t.y,x1:0,y1:t.y1,defined:!1!==t.defined}}))},cN=function(t,e,i){return{from:{points:uN(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}},hN=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:uN(t,e,i)}}},dN=function(t,e,i){return t.getGraphicAttribute("points",!1).map((function(t){var n;if(e&&"negative"===e.orient){var r=i.height;return i.group&&(r=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupHeight=r),{x:t.x,y:r,x1:t.x1,y1:r,defined:!1!==t.defined}}return{x:t.x,y:0,x1:t.x1,y1:0,defined:!1!==t.defined}}))},fN=function(t,e,i){return{from:{points:dN(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}},pN=function(t,e,i){return{from:{points:t.getGraphicAttribute("points",!0)},to:{points:dN(t,e,i)}}},vN=function(t,e,i){var n,r,o=null!=e?e:{},a=o.offset,s=void 0===a?0:a,l=o.orient,u=o.direction,c=o.point,h=0,d=0;"negative"===l&&(i.group?(h=null!==(n=i.groupWidth)&&void 0!==n?n:i.group.getBounds().width(),d=null!==(r=i.groupHeight)&&void 0!==r?r:i.group.getBounds().height(),i.groupWidth=h,i.groupHeight=d):(h=i.width,d=i.height)),h+=s,d+=s;var f=A(c)?c.call(null,t.getDatum(),t,i):c,p=f&&F(f.x)?f.x:h,v=f&&F(f.y)?f.y:d;switch(u){case"x":return{from:{x:p},to:{x:t.getGraphicAttribute("x",!1)}};case"y":return{from:{y:v},to:{y:t.getGraphicAttribute("y",!1)}};default:return{from:{x:p,y:v},to:{x:t.getGraphicAttribute("x",!1),y:t.getGraphicAttribute("y",!1)}}}},yN=function(t,e,i){var n,r,o=null!=e?e:{},a=o.offset,s=void 0===a?0:a,l=o.orient,u=o.direction,c=o.point,h=i.group?i.group.getBounds():null,d=null!==(n=null==h?void 0:h.width())&&void 0!==n?n:i.width,f=null!==(r=null==h?void 0:h.height())&&void 0!==r?r:i.height,p=("negative"===l?d:0)+s,v=("negative"===l?f:0)+s,y=A(c)?c.call(null,t.getDatum(),t,i):c,g=y&&F(y.x)?y.x:p,m=y&&F(y.y)?y.y:v;switch(u){case"x":return{from:{x:t.getGraphicAttribute("x",!0)},to:{x:g}};case"y":return{from:{y:t.getGraphicAttribute("y",!0)},to:{y:m}};default:return{from:{x:t.getGraphicAttribute("x",!0),y:t.getGraphicAttribute("y",!0)},to:{x:g,y:m}}}},gN=function(t,e,i){var n,r,o,a;switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:0},to:{scaleX:null!==(n=t.getGraphicAttribute("scaleX",!1))&&void 0!==n?n:1}};case"y":return{from:{scaleY:0},to:{scaleY:null!==(r=t.getGraphicAttribute("scaleY",!1))&&void 0!==r?r:1}};default:return{from:{scaleX:0,scaleY:0},to:{scaleX:null!==(o=t.getGraphicAttribute("scaleX",!1))&&void 0!==o?o:1,scaleY:null!==(a=t.getGraphicAttribute("scaleY",!1))&&void 0!==a?a:1}}}},mN=function(t,e,i){var n,r,o,a;switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:null!==(n=t.getGraphicAttribute("scaleX",!0))&&void 0!==n?n:1},to:{scaleX:0}};case"y":return{from:{scaleY:null!==(r=t.getGraphicAttribute("scaleY",!0))&&void 0!==r?r:1},to:{scaleY:0}};default:return{from:{scaleX:null!==(o=t.getGraphicAttribute("scaleX",!0))&&void 0!==o?o:1,scaleY:null!==(a=t.getGraphicAttribute("scaleY",!0))&&void 0!==a?a:1},to:{scaleX:0,scaleY:0}}}},_N=function(t,e,i){var n=Object.assign({},t.getPrevGraphicAttributes()),r=Object.assign({},t.getNextGraphicAttributes());return e&&lt(e.excludeChannels).forEach((function(t){delete n[t],delete r[t]})),Object.keys(r).forEach((function(t){uS(t,n,r)&&(delete n[t],delete r[t])})),{from:n,to:r}},bN=function(t,e,i){var n,r=null!==(n=t.getGraphicAttribute("angle",!1))&&void 0!==n?n:0;return{from:{angle:kt(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:F(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2},to:{angle:r}}},xN=function(t,e,i){var n,r=null!==(n=t.getGraphicAttribute("angle",!0))&&void 0!==n?n:0;return{from:{angle:r},to:{angle:kt(r/(2*Math.PI),0)?Math.round(r/(2*Math.PI))*Math.PI*2:F(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(r/(2*Math.PI))*Math.PI*2:Math.floor(r/(2*Math.PI))*Math.PI*2}}},kN=function(){gT.registerAnimationType("clipIn",YH)},SN=function(){gT.registerAnimationType("clipOut",KH)},AN=function(){gT.registerAnimationType("fadeIn",XH)},wN=function(){gT.registerAnimationType("fadeOut",ZH)},TN=function(){gT.registerAnimationType("growCenterIn",qH)},MN=function(){gT.registerAnimationType("growCenterOut",JH)},CN=function(){gT.registerAnimationType("growHeightIn",tN)},EN=function(){gT.registerAnimationType("growHeightOut",eN)},RN=function(){gT.registerAnimationType("growWidthIn",QH)},PN=function(){gT.registerAnimationType("growWidthOut",$H)},BN=function(){gT.registerAnimationType("growPointsIn",sN)},LN=function(){gT.registerAnimationType("growPointsOut",lN)},ON=function(){gT.registerAnimationType("growPointsXIn",cN)},IN=function(){gT.registerAnimationType("growPointsXOut",hN)},DN=function(){gT.registerAnimationType("growPointsYIn",fN)},FN=function(){gT.registerAnimationType("growPointsYOut",pN)},zN=function(){gT.registerAnimationType("growAngleIn",iN)},jN=function(){gT.registerAnimationType("growAngleOut",nN)},HN=function(){gT.registerAnimationType("growRadiusIn",rN)},NN=function(){gT.registerAnimationType("growRadiusOut",oN)},VN=function(){gT.registerAnimationType("moveIn",vN)},GN=function(){gT.registerAnimationType("moveOut",yN)},WN=function(){gT.registerAnimationType("scaleIn",gN)},UN=function(){gT.registerAnimationType("scaleOut",mN)},YN=function(){gT.registerAnimationType("rotateIn",bN)},KN=function(){gT.registerAnimationType("rotateOut",xN)},XN=function(){gT.registerAnimationType("update",_N)};function ZN(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var qN=function(t){ue(i,t);var e=ZN(i);function i(){return jt(this,i),e.apply(this,arguments)}return zt(i,[{key:"encodeState",value:function(t,e,n){return Xs(de(i.prototype),"encodeState",this).call(this,t,e,n),this._updateComponentEncoders(t),this}},{key:"_updateComponentEncoders",value:function(t){this._encoders||(this._encoders={});var e=this.spec.encode[t];if(e&&"update"===t){var i=this.parameters(),n=oT(e)?null:Object.keys(e).reduce((function(t,n){return hT(e[n])&&(t[n]=lT(e[n].scale,i)),t}),{});this._encoders[t]={callback:function(t,i,r){var o=_T(e,t,i,r);if(w(o.size)){var a=n.x?iz(n.x):void 0,s=n.y?iz(n.y):void 0;w(a)&&w(s)?o.size=10:w(a)?o.size=s:w(s)&&(o.size=a),o.size=[a,s]}return w(o.shape)&&(o.shape="rect"),o}}}else this._encoders[t]=e}},{key:"_getEncoders",value:function(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}},{key:"getAttributeTransforms",value:function(){return[{channels:["size","padding"],transform:function(t,e,i){if(I(i.padding)&&i.padding>0)t.size=B(i.size)?i.size.map((function(t){return Math.max(t-i.padding,1)})):Math.max(i.size-i.padding,1);else if(B(i.padding)&&2===i.padding.length){var n=B(i.size)?i.size:[i.size,i.size];t.size=[Math.max(n[0]-i.padding[0],1),Math.max(n[1]-i.padding[1],1)]}else t.size=i.size},storedAttrs:"paddingAttrs"}].concat(wT.symbol)}},{key:"release",value:function(){Xs(de(i.prototype),"release",this).call(this),this._encoders=null}}]),i}(gj);qN.markType=sw.cell;var JN,QN,$N,tV=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];t.ChartEvent=void 0,(JN=t.ChartEvent||(t.ChartEvent={})).initialized="initialized",JN.rendered="rendered",JN.renderFinished="renderFinished",JN.animationFinished="animationFinished",JN.regionSeriesDataFilterOver="regionSeriesDataFilterOver",JN.afterInitData="afterInitData",JN.afterInitEvent="afterInitEvent",JN.afterInitMark="afterInitMark",JN.rawDataUpdate="rawDataUpdate",JN.viewDataFilterOver="viewDataFilterOver",JN.viewDataUpdate="viewDataUpdate",JN.viewDataStatisticsUpdate="viewDataStatisticsUpdate",JN.markDeltaYUpdate="markDeltaYUpdate",JN.viewDataLabelUpdate="viewDataLabelUpdate",JN.scaleDomainUpdate="scaleDomainUpdate",JN.scaleUpdate="scaleUpdate",JN.dataZoomChange="dataZoomChange",JN.drill="drill",JN.layoutStart="layoutStart",JN.layoutEnd="layoutEnd",JN.layoutRectUpdate="layoutRectUpdate",JN.playerPlay="playerPlay",JN.playerPause="playerPause",JN.playerEnd="playerEnd",JN.playerChange="playerChange",JN.playerForward="playerForward",JN.playerBackward="playerBackward",JN.scrollBarChange="scrollBarChange",JN.brushStart="brushStart",JN.brushChange="brushChange",JN.brushEnd="brushEnd",JN.brushClear="brushClear",JN.legendSelectedDataChange="legendSelectedDataChange",JN.legendFilter="legendFilter",JN.legendItemClick="legendItemClick",JN.legendItemHover="legendItemHover",JN.legendItemUnHover="legendItemUnHover",JN.tooltipShow="tooltipShow",JN.tooltipHide="tooltipHide",JN.tooltipRelease="tooltipRelease",JN.afterResize="afterResize",JN.afterRender="afterRender",JN.afterLayout="afterLayout",t.Event_Source_Type=void 0,(QN=t.Event_Source_Type||(t.Event_Source_Type={})).chart="chart",QN.window="window",QN.canvas="canvas",t.Event_Bubble_Level=void 0,($N=t.Event_Bubble_Level||(t.Event_Bubble_Level={})).vchart="vchart",$N.chart="chart",$N.model="model",$N.mark="mark";var eV,iV="".concat(bw,"_waterfall_default_seriesField"),nV="".concat(bw,"_CORRELATION_X"),rV="".concat(bw,"_CORRELATION_Y"),oV="".concat(bw,"_CORRELATION_SIZE"),aV="".concat(bw,"_MEASURE_CANVAS_ID"),sV="".concat(bw,"_DEFAULT_DATA_INDEX"),lV="".concat(bw,"_DEFAULT_DATA_KEY"),uV="".concat(bw,"_DEFAULT_DATA_SERIES_FIELD"),cV="".concat(bw,"_DEFAULT_SERIES_STYLE_NAME");t.AttributeLevel=void 0,(eV=t.AttributeLevel||(t.AttributeLevel={}))[eV.Default=0]="Default",eV[eV.Theme=1]="Theme",eV[eV.Chart=2]="Chart",eV[eV.Base_Series=3]="Base_Series",eV[eV.Series=4]="Series",eV[eV.Mark=5]="Mark",eV[eV.User_Chart=6]="User_Chart",eV[eV.User_Series=7]="User_Series",eV[eV.User_Mark=8]="User_Mark",eV[eV.Built_In=99]="Built_In";var hV,dV,fV="".concat(bw,"_STACK_START"),pV="".concat(bw,"_STACK_END"),vV="".concat(bw,"_STACK_START_PERCENT"),yV="".concat(bw,"_STACK_END_PERCENT"),gV="".concat(bw,"_STACK_START_OffsetSilhouette"),mV="".concat(bw,"_STACK_END_OffsetSilhouette"),_V="".concat(bw,"_STACK_TOTAL"),bV="".concat(bw,"_STACK_TOTAL_PERCENT"),xV="".concat(bw,"_STACK_TOTAL_TOP"),kV="".concat(bw,"_SEGMENT_START"),SV="".concat(bw,"_SEGMENT_END");t.LayoutZIndex=void 0,(hV=t.LayoutZIndex||(t.LayoutZIndex={}))[hV.Axis_Grid=50]="Axis_Grid",hV[hV.CrossHair_Grid=100]="CrossHair_Grid",hV[hV.Region=450]="Region",hV[hV.Mark=300]="Mark",hV[hV.Node=400]="Node",hV[hV.Axis=100]="Axis",hV[hV.MarkLine=500]="MarkLine",hV[hV.MarkArea=100]="MarkArea",hV[hV.MarkPoint=500]="MarkPoint",hV[hV.DataZoom=500]="DataZoom",hV[hV.ScrollBar=500]="ScrollBar",hV[hV.Player=500]="Player",hV[hV.Legend=500]="Legend",hV[hV.CrossHair=500]="CrossHair",hV[hV.Indicator=500]="Indicator",hV[hV.Title=500]="Title",hV[hV.Label=500]="Label",hV[hV.Brush=500]="Brush",hV[hV.CustomMark=500]="CustomMark",hV[hV.Interaction=700]="Interaction",t.LayoutLevel=void 0,(dV=t.LayoutLevel||(t.LayoutLevel={}))[dV.Indicator=10]="Indicator",dV[dV.Region=20]="Region",dV[dV.Axis=30]="Axis",dV[dV.DataZoom=40]="DataZoom",dV[dV.Player=40]="Player",dV[dV.ScrollBar=40]="ScrollBar",dV[dV.Legend=50]="Legend",dV[dV.Title=70]="Title",dV[dV.CustomMark=70]="CustomMark";var AV,wV,TV,MV,CV,EV,RV,PV,BV,LV,OV,IV,DV,FV,zV,jV,HV,NV,VV,GV,WV,UV,YV,KV,XV,ZV,qV,JV,QV,$V,tG,eG,iG,nG=["linear","radial","conical"],rG={x0:0,y0:0,x1:1,y1:1},oG={x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},aG={x:.5,y:.5,startAngle:0,endAngle:2*Math.PI},sG={linear:rG,radial:oG,conical:aG},lG=((AV={}).label={name:"label",type:"text"},AV),uG="".concat(bw,"_rect_x"),cG="".concat(bw,"_rect_x1"),hG="".concat(bw,"_rect_y"),dG="".concat(bw,"_rect_y1"),fG=o(o({},lG),((wV={}).bar={name:"bar",type:"rect"},wV.barBackground={name:"barBackground",type:"rect"},wV)),pG=o(o({},lG),((TV={}).bar3d={name:"bar3d",type:"rect3d"},TV)),vG=((MV={}).point={name:"point",type:"symbol"},MV.line={name:"line",type:"line"},MV),yG=o(o({},lG),vG),gG=o(o({},lG),((CV={}).point={name:"point",type:"symbol"},CV)),mG=o(o(o({},lG),vG),((EV={}).area={name:"area",type:"area"},EV)),_G=o(o(o({},lG),vG),((RV={}).area={name:"area",type:"area"},RV)),bG=o(o({},lG),((PV={}).pie={name:"pie",type:"arc"},PV.labelLine={name:"labelLine",type:"path"},PV)),xG=o(o({},lG),((BV={}).pie3d={name:"pie3d",type:"arc3d"},BV.labelLine={name:"labelLine",type:"path"},BV)),kG=o(o({},lG),((LV={}).rose={name:"rose",type:"arc"},LV)),SG=o(o({},lG),((OV={}).area={name:"area",type:"path"},OV)),AG=o(o({},lG),((IV={}).group={name:"group",type:"group"},IV)),wG=o(o({},AG),((DV={}).track={name:"track",type:"progressArc"},DV.progress={name:"progress",type:"progressArc"},DV)),TG=o(o({},lG),((FV={}).group={name:"group",type:"group"},FV.link={name:"link",type:"rule"},FV.arrow={name:"arrow",type:"symbol"},FV)),MG=o(o({},lG),((zV={}).group={name:"group",type:"group"},zV.grid={name:"grid",type:"rule"},zV.gridBackground={name:"gridBackground",type:"rect"},zV.dot={name:"dot",type:"symbol"},zV.title={name:"title",type:"text"},zV.subTitle={name:"subTitle",type:"text"},zV.symbol={name:"symbol",type:"symbol"},zV)),CG=o(o({},lG),((jV={}).word={name:"word",type:"text"},jV.fillingWord={name:"fillingWord",type:"text"},jV)),EG=o(o({},lG),((HV={}).funnel={name:"funnel",type:"polygon"},HV.transform={name:"transform",type:"polygon"},HV.transformLabel={name:"transformLabel",type:"text"},HV.outerLabel={name:"outerLabel",type:"text"},HV.outerLabelLine={name:"outerLabelLine",type:"rule"},HV)),RG=o(o({},lG),((NV={}).funnel3d={name:"funnel3d",type:"pyramid3d"},NV.transform3d={name:"transform3d",type:"pyramid3d"},NV.transformLabel={name:"transformLabel",type:"text"},NV.outerLabel={name:"outerLabel",type:"text"},NV.outerLabelLine={name:"outerLabelLine",type:"rule"},NV)),PG=o(o({},lG),((VV={}).track={name:"track",type:"rect"},VV.progress={name:"progress",type:"rect"},VV.group={name:"group",type:"group"},VV)),BG=o(o({},fG),((GV={}).leaderLine={name:"leaderLine",type:"rule"},GV.stackLabel={name:"stackLabel",type:"text"},GV)),LG=o(o({},lG),((WV={}).boxPlot={name:"boxPlot",type:"boxPlot"},WV.outlier={name:"outlier",type:"symbol"},WV)),OG=o(o({},lG),((UV={}).nonLeaf={name:"nonLeaf",type:"rect"},UV.leaf={name:"leaf",type:"rect"},UV.nonLeafLabel={name:"nonLeafLabel",type:"text"},UV)),IG=o(o({},lG),((YV={}).node={name:"node",type:"rect"},YV.link={name:"link",type:"linkPath"},YV)),DG=o(o({},AG),((KV={}).segment={name:"segment",type:"progressArc"},KV.track={name:"track",type:"progressArc"},KV)),FG=o(o({},lG),((XV={}).pin={name:"pin",type:"path"},XV.pinBackground={name:"pinBackground",type:"path"},XV.pointer={name:"pointer",type:["path","rect"]},XV)),zG=o(o({},lG),((ZV={}).sunburst={name:"sunburst",type:"arc"},ZV)),jG=o(o({},fG),((qV={}).minLabel={name:"minLabel",type:"text"},qV.maxLabel={name:"maxLabel",type:"text"},qV)),HG=o(o({},pG),((JV={}).minLabel={name:"minLabel",type:"text"},JV.maxLabel={name:"maxLabel",type:"text"},JV)),NG=o(o({},lG),((QV={}).circlePacking={name:"circlePacking",type:"arc"},QV)),VG=o(o({},lG),(($V={}).cell={name:"cell",type:"cell"},$V.cellBackground={name:"cellBackground",type:"cell"},$V)),GG=o(o({},lG),((tG={}).nodePoint={name:"nodePoint",type:"symbol"},tG.ripplePoint={name:"ripplePoint",type:"ripple"},tG.centerPoint={name:"centerPoint",type:"symbol"},tG.centerLabel={name:"centerLabel",type:"text"},tG)),WG=o({},mG);t.SeriesTypeForThemeEnum=void 0,(iG=t.SeriesTypeForThemeEnum||(t.SeriesTypeForThemeEnum={})).area_horizontal="area_horizontal",iG.area_vertical="area_vertical",iG.line_horizontal="line_horizontal",iG.line_vertical="line_vertical",iG.bar_horizontal="bar_horizontal",iG.bar_vertical="bar_vertical",iG.bar3d_horizontal="bar3d_horizontal",iG.bar3d_vertical="bar3d_vertical",iG.rangeColumn_horizontal="rangeColumn_horizontal",iG.rangeColumn_vertical="rangeColumn_vertical",iG.rangeColumn3d_horizontal="rangeColumn3d_horizontal",iG.rangeColumn3d_vertical="rangeColumn3d_vertical",iG.rangeArea_horizontal="rangeArea_horizontal",iG.rangeArea_vertical="rangeArea_vertical",iG.linearProgress_horizontal="linearProgress_horizontal",iG.linearProgress_vertical="linearProgress_vertical",iG.boxPlot_horizontal="boxPlot_horizontal",iG.boxPlot_vertical="boxPlot_vertical",iG.sankey_horizontal="sankey_horizontal",iG.sankey_vertical="sankey_vertical",iG.waterfall_horizontal="waterfall_horizontal",iG.waterfall_vertical="waterfall_vertical";var UG=((eG={})[t.SeriesTypeEnum.bar]=fG,eG[t.SeriesTypeEnum.bar3d]=pG,eG[t.SeriesTypeEnum.line]=yG,eG[t.SeriesTypeEnum.scatter]=gG,eG[t.SeriesTypeEnum.area]=mG,eG[t.SeriesTypeEnum.radar]=_G,eG[t.SeriesTypeEnum.pie]=bG,eG[t.SeriesTypeEnum.pie3d]=xG,eG[t.SeriesTypeEnum.rose]=kG,eG[t.SeriesTypeEnum.geo]=lG,eG[t.SeriesTypeEnum.map]=SG,eG[t.SeriesTypeEnum.circularProgress]=wG,eG[t.SeriesTypeEnum.link]=TG,eG[t.SeriesTypeEnum.dot]=MG,eG[t.SeriesTypeEnum.wordCloud]=CG,eG[t.SeriesTypeEnum.wordCloud3d]=CG,eG[t.SeriesTypeEnum.funnel]=EG,eG[t.SeriesTypeEnum.funnel3d]=RG,eG[t.SeriesTypeEnum.linearProgress]=PG,eG[t.SeriesTypeEnum.waterfall]=BG,eG[t.SeriesTypeEnum.boxPlot]=LG,eG[t.SeriesTypeEnum.treemap]=OG,eG[t.SeriesTypeEnum.sankey]=IG,eG[t.SeriesTypeEnum.gauge]=DG,eG[t.SeriesTypeEnum.gaugePointer]=FG,eG[t.SeriesTypeEnum.sunburst]=zG,eG[t.SeriesTypeEnum.rangeColumn]=jG,eG[t.SeriesTypeEnum.rangeColumn3d]=HG,eG[t.SeriesTypeEnum.circlePacking]=NG,eG[t.SeriesTypeEnum.heatmap]=VG,eG[t.SeriesTypeEnum.correlation]=GG,eG[t.SeriesTypeEnum.rangeArea]=WG,eG);function YG(e){var i,n;return e.type===t.SeriesTypeEnum.sankey?null!==(i=e.direction)&&void 0!==i?i:"horizontal":null!==(n=e.direction)&&void 0!==n?n:"vertical"}var KG={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},XG={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function ZG(t,e){var i;if(!t)return[];var n=iW(t,e);if(!n||B(n))return null!==(i=n)&&void 0!==i?i:[];if(M(n)){var r=n.dataScheme;return r?tW(r)?r.map((function(i){return o(o({},i),{scheme:i.scheme.map((function(i){return $G(i)?JG(t,i,e):i})).filter(T)})})):r.map((function(i){return $G(i)?JG(t,i,e):i})).filter(T):[]}return[]}function qG(t,e){var i,n;return tW(t)?null!==(n=null===(i=t.find((function(t){return T(t.isAvailable)?A(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!T(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength})))||void 0===i?void 0:i.scheme)&&void 0!==n?n:t[t.length-1].scheme:t}function JG(t,e,i){var n,r=iW(t,i);if(r){var o,a=r.palette;if(M(a)&&(o=null!==(n=function(t,e){var i=KG[e];if(i&&t[i])return t[i];if(t[e])return t[e];var n=XG[e];return n?t[n]:void 0}(a,e.key))&&void 0!==n?n:e.default),o){if(w(e.a)&&w(e.l)||!P(o))return o;var s=new Ye(o);if(T(e.l)){var l=s.color,u=we(l.r,l.g,l.b),c=Ae(u.h,u.s,e.l),h=new Ye("rgb(".concat(c.r,", ").concat(c.g,", ").concat(c.b,")"));h.setOpacity(s.color.opacity),s=h}return T(e.a)&&s.setOpacity(e.a),s.toRGBA()}}}var QG=function(t,e,i){if(e&&$G(t)){var n=JG(e,t,i);if(n)return n}return t};function $G(t){return t&&"palette"===t.type&&!!t.key}function tW(t){return!(!B(t)||0===t.length)&&t.every((function(t){return T(t.scheme)}))}function eW(t){return B(t)?{dataScheme:t}:t}function iW(t,e){var i,n,r,o=(null!=e?e:{}).type;if(!e||w(o))r=null==t?void 0:t.default;else{var a=YG(e);r=null!==(n=null!==(i=null==t?void 0:t["".concat(o,"_").concat(a)])&&void 0!==i?i:null==t?void 0:t[o])&&void 0!==n?n:null==t?void 0:t.default}return r}var nW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.range=function(e){return e?(this._range=e,this._resetRange(),this):t.prototype.range.call(this)},e.prototype.domain=function(e){return e?(t.prototype.domain.call(this,e),this._resetRange(),this):t.prototype.domain.call(this)},e.prototype._resetRange=function(){if(tW(this._range)){var e=qG(this._range,this._domain);t.prototype.range.call(this,e)}else t.prototype.range.call(this,this._range)},e}(GS),rW={linear:pA,band:YS,point:bA,ordinal:GS,threshold:wA,colorOrdinal:nW};function oW(t){var e=rW[t];return e?new e:null}function aW(t,e){if(!e)return t;var i=e.range(),n=Math.min(i[0],i[i.length-1]),r=Math.max(i[0],i[i.length-1]);return Math.min(Math.max(n,t),r)}function sW(t){return T(null==t?void 0:t.field)&&T(null==t?void 0:t.scale)}function lW(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function uW(t){return!!P(t)&&(!!t.endsWith("%")&&Qk(t.substring(0,t.length-1)))}function cW(t,e,i){var n,r;return I(t)?t:uW(t)?Number(t.substring(0,t.length-1))*e/100:A(t)?t(i):M(t)?e*(null!==(n=t.percent)&&void 0!==n?n:0)+(null!==(r=t.offset)&&void 0!==r?r:0):0}function hW(t,e,i){var n,r,o,a,s={top:0,bottom:0,left:0,right:0};return Object.values(t).every((function(t){return I(t)}))?(s.top=null!==(n=t.top)&&void 0!==n?n:0,s.right=null!==(r=t.right)&&void 0!==r?r:0,s.bottom=null!==(o=t.bottom)&&void 0!==o?o:0,s.left=null!==(a=t.left)&&void 0!==a?a:0,s):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach((function(e){e.orients.forEach((function(n){s[n]=cW(t[n],e.size,i)}))})),s)}function dW(t){var e,i={};return B(t)?(w(t[0])||(i.top=i.left=i.bottom=i.right=t[0]),w(t[1])||(i.left=i.right=t[1]),w(t[2])||(i.bottom=t[2]),w(t[3])||(i.left=t[3]),i):I(t)||uW(t)||A(t)||M(e=t)&&("percent"in e||"offset"in e)?(i.top=i.left=i.bottom=i.right=t,i):M(t)?i=o({},t):i}function fW(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}var pW=function(t,e){var i=Number(t),n=t.toString();return isNaN(i)&&"%"===n[n.length-1]?e*(Number(n.slice(0,n.length-1))/100):i};var vW=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],yW={default:{dataScheme:vW,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2"}}},gW="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",mW=14,_W=32,bW=20,xW=16,kW="150%",SW=14,AW="150%",wW=12,TW="130%",MW=10,CW=4,EW="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",RW={scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}}},bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},bar3d:{bar3d:{style:{length:3}},label:{visible:!1,style:{offset:12,position:"outside"}}},pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}}},pie3d:{outerRadius:.6,pie3d:{style:{height:10,fillOpacity:1}},label:{visible:!1,position:"outside"}},map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:MW,lineHeight:"120%",textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:wW,lineHeight:TW}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:wW,lineHeight:TW}}},link:{arrow:{style:{size:10}}},wordCloud:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},wordCloud3d:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},funnel:{transform:{style:{fill:{type:"palette",key:"axisGridColor"}}},label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:SW,lineHeight:AW,fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:SW,lineHeight:AW,fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}},funnel3d:{transform3d:{style:{fill:"#f5f5f5"}},label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:SW,lineHeight:AW,fill:"#707070"},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:SW,lineHeight:AW,fill:"#707070",textBaseline:"middle"}}},linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:"#E7EBED",fillOpacity:1}}},circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:SW,lineHeight:AW}},label:{visible:!1,offset:12,position:"inside"}},gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},gaugePointer:{pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:EW,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:EW,fill:"#ddd"}}},treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:wW,lineHeight:TW}},nonLeafLabel:{padding:2*wW,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:wW,lineHeight:TW,textBaseline:"middle",textAlign:"center"}}},sunburst:{innerRadius:0,outerRadius:1,startAngle:jw,endAngle:Hw,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:wW,lineHeight:TW}}},rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:wW,lineHeight:TW}}},heatmap:{cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},sankey:{link:{style:{fillOpacity:.15,round:!0}}},rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},boxPlot:{boxPlot:{style:{lineWidth:1}}},correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}}},PW={text:{style:{fontSize:SW,lineHeight:AW,fontWeight:"normal",fillOpacity:1}}},BW={label:{style:{fontSize:SW,fontWeight:"normal",fillOpacity:1}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontSize:null}},fillingWord:{style:{fontSize:null}},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},circlePacking:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},funnel3d:{style:{stroke:!1}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06}}}},LW={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:wW,fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},OW={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:wW,fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},IW=o(o({},LW),{label:{space:0}}),DW={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:CW,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:CW/2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:wW,fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:wW,lineHeight:TW,fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},FW=function(){return{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:wW},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},zW={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineDash:[]}},label:FW()},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineDash:[2,3]}},label:FW()}},jW="M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",HW={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:{area:{style:{visible:!1,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:!1,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}},startHandler:{style:{symbolType:jW,fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},endHandler:{style:{symbolType:jW,fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},startText:{padding:8,style:{fontSize:wW,lineHeight:TW,fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:wW,lineHeight:TW,fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:{area:{style:{stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}},NW={title:{visible:!0,autoLimit:!1,autoFit:!1,style:{fontSize:_W,fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{visible:!0,style:{fontSize:bW,fill:{type:"palette",key:"tertiaryFontColor"},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}},VW={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:wW,lineHeight:TW,fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:wW,lineHeight:TW,fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:wW,lineHeight:TW,fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:wW,lineHeight:TW,fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},GW={style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}},WW={horizontal:o(o({},VW),{rail:{width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:GW}),vertical:o(o({},VW),{rail:{width:8,height:200,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:GW})},UW={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:wW,lineHeight:TW,fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:wW,lineHeight:TW,opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},YW={style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}},KW={horizontal:o(o({},VW),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:{width:200,height:4,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:YW}),vertical:o(o({},VW),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:{width:4,height:200,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:YW})},XW={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:gW,colorScheme:yW,mark:PW,markByName:BW,series:RW,component:{discreteLegend:UW,colorLegend:WW,sizeLegend:KW,axis:DW,axisBand:{domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},axisLinear:{domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},axisX:LW,axisY:OW,axisZ:IW,axisAngle:{grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},axisRadius:{grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},markLine:{line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:{visible:!1,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{visible:!0,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},label:{refY:5,style:{fontSize:SW,fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},markArea:{area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:{style:{fontSize:SW,fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},markPoint:{itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}},tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:SW,lineHeight:AW,fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textAlign:"left",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:SW,lineHeight:AW,fontColor:{type:"palette",key:"secondaryFontColor"},textAlign:"left",textBaseline:"middle",spacing:26},valueLabel:{fontSize:SW,lineHeight:AW,fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},dataZoom:HW,crosshair:zW,player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:0,style:{size:25,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:0,style:{size:25,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"end",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},indicator:NW,title:{padding:{top:4,bottom:20},textStyle:{fontSize:xW,lineHeight:kW,fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:SW,lineHeight:AW,fill:{type:"palette",key:"tertiaryFontColor"}}},mapLabel:{visible:!0,offset:12,position:"top",space:10,nameLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:MW}},valueLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:MW}},background:{visible:!0,padding:{top:4,bottom:4,left:6,right:6},style:{cornerRadius:2,lineWidth:1,fill:"white",stroke:"grey"}},leader:{visible:!1,style:{lineWidth:1,stroke:"red"}}},poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:wW,fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:wW,fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}},totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:SW,fill:{type:"palette",key:"primaryFontColor"}}},scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},animationThreshold:2e3},ZW={name:"dark",colorScheme:{default:{dataScheme:vW,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}};function qW(t,e,i){if(void 0===i&&(i=!1),e){if(t===e)return;if(T(e)&&"object"==typeof e){var n=Object(e),r=[];for(var o in n)r.push(o);for(var a=r.length,s=-1;a--;){o=r[++s];T(n[o])&&"object"==typeof n[o]&&!B(t[o])?JW(t,e,o,i):QW(t,o,n[o])}}}}function JW(t,e,i,n){void 0===n&&(n=!1);var r=t[i],o=e[i],a=e[i],s=!0;if(B(o)){if(n)a=[];else if(B(r))a=r;else if(L(r)){a=new Array(r.length);for(var l=-1,u=r.length;++l<u;)a[l]=r[l]}}else E(o)?(a=null!=r?r:{},"function"!=typeof r&&"object"==typeof r||(a={})):s=!1;s&&qW(a,o,n),QW(t,i,a)}function QW(t,e,i){(void 0!==i&&!function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i)||void 0===i&&!(e in t))&&(t[e]=i)}function $W(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=-1,r=e.length;++n<r;){qW(t,e[n],!0)}return t}function tU(t,e,i,n){Object.keys(t).forEach((function(r){if(M(e))e.type===r&&(B(t[r])?t[r].length>=e.index&&(t[r][e.index]=n?$W({},t[r][e.index],i):i):t[r]=n?$W({},t[r],i):i);else if(B(t[r])){var o=t[r].findIndex((function(t){return t.id===e}));o>=0&&(t[r][o]=n?$W({},t[r][o],i):i)}else t.id===e&&(t[r]=n?$W({},t[r],i):i)}))}function eU(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return $W.apply(void 0,h([iU(t)],c(e.map(iU)),!1))}function iU(t){if(!t)return t;var e,i=function(t){t&&(t=Object.keys(t).reduce((function(e,i){var n=t[i];return e[i]=eW(n),e}),{}));return t}(t.colorScheme),n=t.series,r=t.mark,o=t.markByName;return(r||o)&&(e=Object.keys(UG).reduce((function(t,e){var i,a=null!==(i=null==n?void 0:n[e])&&void 0!==i?i:{};return t[e]=nU(a,e,r,o),t}),{})),Object.assign({},t,{colorScheme:i,series:Object.assign({},t.series,e)})}function nU(t,e,i,n){if(!UG[e])return t;var r={};return Object.values(UG[e]).forEach((function(e){var o=e.type,a=e.name;r[a]=$W({},null==i?void 0:i[lt(o)[0]],null==n?void 0:n[a],null==t?void 0:t[a])})),o(o({},t),r)}var rU,oU=["animationThreshold","colorScheme","fontFamily","name","padding"];function aU(t,e,i){if(!t)return t;var n={};return Object.keys(t).forEach((function(r){var o=t[r];oU.includes(r)?n[r]=o:E(o)?$G(o)?n[r]=QG(o,e,i):n[r]=aU(o,e,i):n[r]=o})),n}var sU=((rU={})[XW.name]=XW,rU),lU=XW.name,uU=new Map(Object.keys(sU).map((function(t){return[t,sU[t]]}))),cU=new Map(Object.keys(sU).map((function(t){return[t,aU(sU[t],sU[t].colorScheme)]}))),hU=new Map(Object.keys(sU).map((function(t){return[t,t===lU]}))),dU=function(t,e){if(t){var i=yU(e);uU.set(t,i),cU.set(t,aU(i,i.colorScheme)),hU.set(t,!0)}},fU=function(t,e){return void 0===t&&(t=lU),void 0===e&&(e=!1),hU.has(t)&&!hU.get(t)&&dU(t,uU.get(t)),e?cU.get(t):uU.get(t)},pU=function(t){return uU.delete(t)&&cU.delete(t)&&hU.delete(t)},vU=function(t){return!!P(t)&&uU.has(t)},yU=function(t){var e,i=null!==(e=t.type)&&void 0!==e?e:lU;return eU({},fU(i),t)},gU=function(){function t(){}return t.registerInstance=function(e){t.instances.set(e.id,e)},t.unregisterInstance=function(e){t.instances.delete(e.id)},t.getInstance=function(e){return t.instances.get(e)},t.instanceExist=function(e){return t.instances.has(e)},t.forEach=function(e,i,n){void 0===i&&(i=[]);var r=lt(i);return t.instances.forEach((function(t,i,n){r.includes(i)||e(t,i,n)}),n)},t.instances=new Map,t}(),mU=function(){function t(){}return t.registerTheme=function(t,e){dU(t,e)},t.getTheme=function(t,e){return void 0===e&&(e=!1),fU(t,e)},t.removeTheme=function(t){return pU(t)},t.themeExist=function(t){return vU(t)},t.getDefaultTheme=function(){return t.themes.get(lU)},t.setCurrentTheme=function(e){t.themeExist(e)&&(t._currentThemeName=e,gU.forEach((function(t){return null==t?void 0:t.setCurrentTheme(e)})))},t.getCurrentTheme=function(){return t.getTheme(t._currentThemeName)},t.getCurrentThemeName=function(){return t._currentThemeName},t.themes=uU,t._currentThemeName=lU,t}();function _U(t,e){return P(t)?mU.themeExist(t)?mU.getTheme(t,e):{}:M(t)?t:{}}function bU(t,e){void 0===e&&(e=["data"]);var i,n=t;if(!T(n)||"object"!=typeof n)return n;if(n instanceof Ma||function(t){try{return t instanceof Element}catch(i){var e=Object.keys(t);return["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"].every((function(t){return e.includes(t)}))}}(n))return n;var r=B(n),o=n.length;i=r?new Array(o):"object"==typeof n?{}:S(n)||I(n)||P(n)?n:O(n)?new Date(+n):void 0;var a=r?void 0:Object.keys(Object(n)),s=-1;if(i)for(;++s<(a||n).length;){var l=a?a[s]:s,u=n[l];(null==e?void 0:e.includes(l.toString()))?i[l]=u:i[l]=bU(u,e)}return i}function xU(t,e){if(void 0===e&&(e={data:function(t){return t}}),!t)return t;if(t.constructor===Object){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e[n]){i[n]=e[n](t[n]);continue}i[n]=xU(t[n],e)}return i}return B(t)?t.map((function(t){return xU(t,e)})):t}function kU(t,e){if(!t)return t;if(E(t)){var i={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(P(t[n])&&e.getFunction(t[n])){i[n]=e.getFunction(t[n]);continue}i[n]=kU(t[n],e)}return i}return B(t)?t.map((function(t){return kU(t,e)})):t}function SU(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=AU(t,n.key);r?r.operations=h([],c(new Set(r.operations.concat(n.operations))),!1):t.push(n)}return t}function AU(t,e){return t.find((function(t){return t.key===e}))}function wU(t,e){var i;if(!t)return null!=e?e:null;var n=t.getFields();return n&&n[e]?null!==(i=n[e].alias)&&void 0!==i?i:e:null!=e?e:null}function TU(t,e,i){var n={};return t.getSeries().forEach((function(t){var r,o=t.getStackData(),a=t.getStackValue(),s=t.getStackValueField(),l=!i||i(t);o&&s&&l&&(n[a]=null!==(r=n[a])&&void 0!==r?r:{nodes:{}},RU(t,o,n[a],s,e))})),n}function MU(t,e){if("values"in t&&t.values.length){var i=ZA(t.values,e),n=XA(t.values,yV);t.values.forEach((function(t){t[_V]=i,t[bV]=n,delete t[xV]}));var r=t.values.reduce((function(t,e){return e[pV]>t[pV]?e:t}));r[xV]=!0}else for(var o in t.nodes)MU(t.nodes[o],e)}function CU(t){if(t.values.length)for(var e=t.values[t.values.length-1][pV]/2,i=0;i<t.values.length;i++)t.values[i][gV]=t.values[i][fV]-e,t.values[i][mV]=t.values[i][pV]-e}function EU(t,e,i){if(t.values.length>0){for(var n=0,r=0,o=1,a=0,s=t.values.length,l=0;l<s;l++){(a=(u=t.values[e?s-1-l:l])[pV])>=0?(u[fV]=n,n+=u[pV],u[pV]=n):(u[fV]=r,r+=u[pV],u[pV]=r)}if(i)for(l=0;l<s;l++){var u,c=(a=(u=t.values[e?s-1-l:l])[pV])>=0?n:r;o=a>=0?1:-1,u[vV]=0===c?0:Math.min(1,u[fV]/c)*o,u[yV]=0===c?0:Math.min(1,u[pV]/c)*o}}for(var h in t.nodes)EU(t.nodes[h],e,i)}function RU(t,e,i,n,r){var o;if("values"in e)return r&&e.values.forEach((function(t){return t[pV]=function(t){if(F(t))return t;var e=+t;return F(e)?e:0}(t[n])})),(o=i.values).push.apply(o,h([],c(e.values),!1)),void i.series.push({s:t,values:e.values});for(var a in e.nodes)!i.nodes[a]&&(i.nodes[a]={values:[],series:[],nodes:{}}),RU(t,e.nodes[a],i.nodes[a],n,r)}var PU=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var o=t[r];if(o[i]===e)return o;if(o[n]){var a=PU(o[n],e,i,n);if(a)return a}}return null},BU=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");for(var r=0;r<t.length;r++){var o=t[r];if(o[n])for(var a=0;a<o[n].length;a++){var s=o[n][a];if(s[i]===e)return o;var l=BU([s],e,i,n);if(l)return l}}return null};function LU(t){void 0===t&&(t={});var e=o({},t);if(A(t.style)?e.style=function(e,i,n,r){return DU(t.style(e,i,n,r))}:W(t.style)||(e.style=DU(t.style)),!W(t.state)){var i={};Object.keys(t.state).forEach((function(e){A(t.state[e])?i[e]=function(i,n,r,o){return DU(t.state[e](i,n,r,o))}:W(t.state[e])||(i[e]=DU(t.state[e]))})),e.state=i}return e}function OU(t){if(W(t))return null;var e={};return Object.keys(t).forEach((function(i){A(t[i])?e[i]=function(e,n,r,o){return DU(t[i](e,n,r,o))}:W(t[i])||(e[i]=DU(t[i]))})),e}function IU(t){if(W(t))return null;var e={};return Object.keys(t).forEach((function(i){A(t[i])?e[i]=function(e,n,r,o){return DU(t[i](e.rawValue,n,e,r,o))}:W(t[i])||(e[i]=DU(t[i]))})),e}function DU(t){return(null==t?void 0:t.angle)&&(t.angle=ge(t.angle)),t}var FU=function(){function t(){}return t.registerChart=function(e,i){t._charts[e]=i},t.registerSeries=function(e,i){t._series[e]=i},t.registerComponent=function(e,i,n){t._components[e]={cmp:i,alwaysCheck:n}},t.registerMark=function(e,i){t._marks[e]=i},t.registerRegion=function(e,i){t._regions[e]=i},t.registerTransform=function(e,i){t.transforms[e]=i},t.registerLayout=function(e,i){t._layout[e]=i},t.registerAnimation=function(e,i){t._animations[e]=i},t.registerImplement=function(e,i){t._implements[e]=i},t.registerChartPlugin=function(e,i){t._chartPlugin[e]=i},t.createChart=function(e,i,n){return t._charts[e]?new(0,t._charts[e])(i,n):null},t.createChartSpecTransformer=function(e,i){if(!t._charts[e])return null;var n=t._charts[e];return new(0,n.transformerConstructor)(o({seriesType:n.seriesType},i))},t.createRegion=function(e,i,n){return t._regions[e]?new(0,t._regions[e])(i,n):null},t.createRegionSpecTransformer=function(e,i){return t._regions[e]?new(0,t._regions[e].transformerConstructor)(i):null},t.createSeries=function(e,i,n){return t._series[e]?new(0,t._series[e])(i,n):null},t.createSeriesSpecTransformer=function(e,i){return t._series[e]?new(0,t._series[e].transformerConstructor)(i):null},t.createMark=function(e,i,n){if(!t._marks[e])return null;var r=new(0,t._marks[e])(i,n);return"group"===r.type&&r.setInteractive(!1),r},t.getComponents=function(){return Object.values(t._components)},t.getComponentInKey=function(e){return t._components[e].cmp},t.getLayout=function(){return Object.values(t._layout)},t.getLayoutInKey=function(e){return t._layout[e]},t.getSeries=function(){return Object.values(t._series)},t.getSeriesInType=function(e){return t._series[e]},t.getRegionInType=function(e){return t._regions[e]},t.getAnimationInKey=function(e){return t._animations[e]},t.getImplementInKey=function(e){return t._implements[e]},t.getSeriesMarkMap=function(e){return t._series[e]?t._series[e].mark:{}},t.getChartPlugins=function(){return Object.values(t._chartPlugin)},t._charts={},t._series={},t._components={},t._marks={},t._regions={},t._animations={},t._implements={},t._chartPlugin={},t.transforms={simplify:Ho,fields:Vo,filter:Ti,fold:No},t.dataParser={csv:ta,dsv:$o,tsv:ea},t._layout={},t}(),zU=function(t,e){var i,n;return t===e||!w(t)&&!w(e)&&(t.value===e.value&&(null===(i=t.axis)||void 0===i?void 0:i.id)===(null===(n=e.axis)||void 0===n?void 0:n.id))},jU=function(t,e,i,n){var r,o,a,s,l,c=_S(e.getScale().type),h=[],d=e.getRegions();try{for(var f=u(d),p=f.next();!p.done;p=f.next()){var v=p.value.getSeries(),y=function(r){if(r.coordinate===i){var o=lt(n(r)),a=null===(l=r.getViewData())||void 0===l?void 0:l.latestData;if(o&&a)if(c)h.push({series:r,datum:a.filter((function(e){var i;return(null===(i=e[o[0]])||void 0===i?void 0:i.toString())===(null==t?void 0:t.toString())}))});else if(T(o[1]))h.push({series:r,datum:a.filter((function(e){var i;return(null===(i=e[o[0]])||void 0===i?void 0:i.toString())===(null==t?void 0:t.toString())||T(e[o[0]])&&T(e[o[1]])&&t>=e[o[0]]&&t<e[o[1]]}))});else{var s=e.getSpec().tooltipFilterRange,u=F(s)?[-s,s]:s,d=[];if(u)a.forEach((function(e){if(T(e[o[0]])){var i=e[o[0]]-t;i>=u[0]&&i<=u[1]&&d.push(e)}}));else{var f=1/0,p=0;a.forEach((function(e){if(T(e[o[0]])){var i=Math.abs(e[o[0]]-t),n=Math.sign(e[o[0]]-t);i<f?(f=i,d=[e],p=n):i===f&&n===p&&d.push(e)}}))}h.push({series:r,datum:d})}}};try{for(var g=(a=void 0,u(v)),m=g.next();!m.done;m=g.next()){y(m.value)}}catch(t){a={error:t}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}return h},HU=function(t,e,i){var n=t.getAllComponents().filter((function(n){return"axes"===n.specKey&&e(n)&&function(t,e,i){var n=t.getRegionsInIds(lt(e.layout.layoutBindRegionID));return null==n?void 0:n.some((function(t){var e=t.getLayoutRect(),n=t.getLayoutStartPoint();return function(t,e,i){return t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y}(i,{x:n.x,y:n.y},{x:e.width+n.x,y:e.height+n.y})}))}(t,n,i)}));return n.length?n:null},NU=function(t,e){if(!t)return null;if(!nw(t.getRegionsInIndex(),"polar"))return null;var i=e.x,n=e.y,r=HU(t,(function(t){return"angle"===t.getOrient()}),e),o=HU(t,(function(t){return"radius"===t.getOrient()}),e),a=[],s=function(t){return t.getDimensionField()[0]};return r&&r.forEach((function(t){var e,r=t.getScale();if(r&&_S(r.type)){var l=r.domain(),u=r.range(),c=t.getCenter(),h={x:i-t.getLayoutStartPoint().x-c.x,y:n-t.getLayoutStartPoint().y-c.y},d=QA({x:1,y:0},h);d=function(t,e){var i=2*Math.PI,n=ht(e),r=ct(e);return t<n?t+=Math.ceil((n-t)/i)*i:t>r&&(t-=Math.ceil((t-r)/i)*i),t}(d,u);var f=$A(h),p=null===(e=o[0])||void 0===e?void 0:e.getScale(),v=null==p?void 0:p.range();if((d-(null==u?void 0:u[0]))*(d-(null==u?void 0:u[1]))>0||(f-(null==v?void 0:v[0]))*(f-(null==v?void 0:v[1]))>0)return;var y=t.invert(d);if(w(y))return;var g=l.findIndex((function(t){return(null==t?void 0:t.toString())===y.toString()}));g<0&&(g=void 0);var m=jU(y,t,"polar",s);a.push({index:g,value:y,axis:t,data:m})}})),o&&o.forEach((function(t){var e,o=t.getScale(),l=null==o?void 0:o.range();if(o&&_S(o.type)){var u=t.getCenter(),c={x:i-t.getLayoutStartPoint().x-u.x,y:n-t.getLayoutStartPoint().y-u.y},h=QA({x:1,y:0},c);h<-Math.PI/2&&(h=2*Math.PI+h);var d=$A(c),f=null===(e=r[0])||void 0===e?void 0:e.getScale(),p=null==f?void 0:f.range();if((h-(null==p?void 0:p[0]))*(h-(null==p?void 0:p[1]))>0||(d-(null==l?void 0:l[0]))*(d-(null==l?void 0:l[1]))>0)return;var v=o.invert(d);if(w(v))return;var y=o.domain().findIndex((function(t){return(null==t?void 0:t.toString())===v.toString()}));y<0&&(y=void 0);var g=jU(v,t,"polar",s);a.push({index:y,value:v,axis:t,data:g})}})),a.length?a:null};function VU(t){return"bottom"===t||"top"===t}function GU(t){return"left"===t||"right"===t}function WU(t){return"z"===t}function UU(t,e){return lW(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function YU(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function KU(t,e){var i,n=null!==(i=t.type)&&void 0!==i?i:function(t,e){return e?VU(t)?"linear":"band":VU(t)?"band":"linear"}(t.orient,e);return{axisType:n,componentName:"".concat(f.cartesianAxis,"-").concat(n)}}var XU,ZU,qU=function(t){return t.fieldX[0]},JU=function(t){return t.fieldY[0]},QU=function(t){return[t.fieldX[0],t.fieldX2]},$U=function(t){return[t.fieldY[0],t.fieldY2]},tY=function(t,e){var i,n;if(!t)return null;if(!nw(t.getRegionsInIndex(),"cartesian"))return null;var r=e.x,o=e.y,a=null!==(i=HU(t,(function(t){return VU(t.getOrient())}),e))&&void 0!==i?i:[],s=null!==(n=HU(t,(function(t){return GU(t.getOrient())}),e))&&void 0!==n?n:[],l=new Set,u=new Set;[a,s].forEach((function(t){return t.forEach((function(t){_S(t.getScale().type)?l.add(t):u.add(t)}))}));var c=[],h=function(t,e){("x"===t?a:s).forEach((function(i){if((e?l:u).has(i)){var n=eY(i,"x"===t?r:o,t,"x"===t?e?qU:QU:e?JU:$U);n&&c.push(n)}}))};return"horizontal"===t.getSpec().direction?(h("y",l.size>0),0===c.length&&h("x",l.size>0)):(h("x",l.size>0),0===c.length&&h("y",l.size>0)),c.length?c:null},eY=function(t,e,i,n){var r=t.getScale(),o=e-t.getLayoutStartPoint()[i];if((o-r.range()[0])*(o-r.range()[1])>0)return null;var a=r.invert(o);return iY(t,a,n)},iY=function(t,e,i){var n=t.getScale();if(w(e))return null;var r=n.domain().findIndex((function(t){return(null==t?void 0:t.toString())===e.toString()}));r<0&&(r=void 0);var o=jU(e,t,"cartesian",null!=i?i:VU(t.getOrient())?qU:JU);return{index:r,value:e,axis:t,data:o}},nY=function(){function t(t,e){this._eventDispatcher=t,this._mode=e}return Object.defineProperty(t.prototype,"chart",{get:function(){var t,e;return this._chart||(this._chart=null===(e=(t=this._eventDispatcher.globalInstance).getChart)||void 0===e?void 0:e.call(t)),this._chart},enumerable:!1,configurable:!0}),t.prototype.register=function(t,e){var i,n;(null!==(n=null===(i=this.chart)||void 0===i?void 0:i.getOption().onError)&&void 0!==n?n:Ra)("Method not implemented.")},t.prototype.unregister=function(){var t,e;(null!==(e=null===(t=this.chart)||void 0===t?void 0:t.getOption().onError)&&void 0!==e?e:Ra)("Method not implemented.")},t.prototype.getTargetDimensionInfo=function(t,e){var i,n,r=null!==(i=tY(this.chart,{x:t,y:e}))&&void 0!==i?i:[],o=null!==(n=NU(this.chart,{x:t,y:e}))&&void 0!==n?n:[],a=[].concat(r,o);return 0===a.length?null:a},t.prototype.dispatch=function(t,e){var i,n=null===(i=this.chart)||void 0===i?void 0:i.getAllComponents().filter((function(t){return"axes"===t.specKey&&(!!_S(t.getScale().type)&&(!(null==e?void 0:e.filter)||e.filter(t)))})),r=[];return n.forEach((function(e){var i=iY(e,t);i&&r.push(i)})),this._callback.call(null,{action:"enter",dimensionInfo:r}),r},t}(),rY=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){if(e){var i=e.event.viewX,n=e.event.viewY,r=t.getTargetDimensionInfo(i,n);r&&t._callback.call(null,o(o({},e),{action:"click",dimensionInfo:r.slice()}))}},t}return r(i,e),i.prototype.register=function(e,i){this._callback=i.callback,this._eventDispatcher.register("pointertap",{query:o(o({},i.query),{source:t.Event_Source_Type.chart}),callback:this.onClick})},i.prototype.unregister=function(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})},i}(nY),oY=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._cacheDimensionInfo=null,t.onMouseMove=function(e){if(e){var i=e.event.viewX,n=e.event.viewY,r=t.getTargetDimensionInfo(i,n);null===r&&null!==t._cacheDimensionInfo?(t._callback.call(null,o(o({},e),{action:"leave",dimensionInfo:t._cacheDimensionInfo.slice()})),t._cacheDimensionInfo=r):null===r||null!==t._cacheDimensionInfo&&r.length===t._cacheDimensionInfo.length&&!r.some((function(e,i){return!zU(e,t._cacheDimensionInfo[i])}))?null!==r&&t._callback.call(null,o(o({},e),{action:"move",dimensionInfo:r.slice()})):(t._callback.call(null,o(o({},e),{action:"enter",dimensionInfo:r.slice()})),t._cacheDimensionInfo=r)}},t.onMouseOut=function(e){e&&(t._callback.call(null,o(o({},e),{action:"leave",dimensionInfo:t._cacheDimensionInfo?t._cacheDimensionInfo.slice():[]})),t._cacheDimensionInfo=null)},t}return r(i,e),i.prototype.register=function(e,i){this._callback=i.callback,this._eventDispatcher.register("pointermove",{query:o(o({},i.query),{source:t.Event_Source_Type.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:o(o({},i.query),{source:t.Event_Source_Type.canvas}),callback:this.onMouseOut}),Xk(this._mode)&&this._eventDispatcher.register("pointerdown",{query:o(o({},i.query),{source:t.Event_Source_Type.chart}),callback:this.onMouseMove})},i.prototype.unregister=function(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),Xk(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})},i}(nY);t.DimensionEventEnum=void 0,(XU=t.DimensionEventEnum||(t.DimensionEventEnum={})).dimensionHover="dimensionHover",XU.dimensionClick="dimensionClick";var aY=((ZU={})[t.DimensionEventEnum.dimensionHover]=oY,ZU[t.DimensionEventEnum.dimensionClick]=rY,ZU),sY=function(){function t(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}return t.prototype.getComposedEventMap=function(){return this._composedEventMap},t.prototype.on=function(t,e,i){var n="function"==typeof e?{query:null,callback:e}:{query:e,callback:i};if(aY[t]){var r=new aY[t](this._eventDispatcher,this._mode);r.register(t,n),this._composedEventMap.set(i,{eventType:t,event:r})}else this._eventDispatcher.register(t,n);return this},t.prototype.off=function(t,e,i){var n,r,o,a,s=null!=i?i:e;if(aY[t])if(s)null===(o=this._composedEventMap.get(s))||void 0===o||o.event.unregister(),this._composedEventMap.delete(s);else try{for(var l=u(this._composedEventMap.entries()),c=l.next();!c.done;c=l.next()){var h=c.value;h[1].eventType===t&&(null===(a=this._composedEventMap.get(h[0]))||void 0===a||a.event.unregister(),this._composedEventMap.delete(h[0]))}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}else if(s){var d={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,d)}else this._eventDispatcher.unregister(t);return this},t.prototype.emit=function(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this},t.prototype.release=function(){this._eventDispatcher.release(),this._composedEventMap.clear()},t}(),lY=function(){function e(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(t.Event_Bubble_Level.vchart,[]),this._levelNodes.set(t.Event_Bubble_Level.chart,[]),this._levelNodes.set(t.Event_Bubble_Level.model,[]),this._levelNodes.set(t.Event_Bubble_Level.mark,[])}return e.prototype.addHandler=function(t,e){var i,n={level:e,handler:t};return null===(i=this._levelNodes.get(e))||void 0===i||i.push(n),this._map.set(t.callback,n),this},e.prototype.removeHandler=function(t){var e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);var i=this._levelNodes.get(e.level),n=null==i?void 0:i.findIndex((function(e){return e.handler.callback===t.callback}));return void 0!==n&&n>=0&&(null==i||i.splice(n,1)),this},e.prototype.getHandlers=function(t){var e;return(null===(e=this._levelNodes.get(t))||void 0===e?void 0:e.map((function(t){return t.handler})))||[]},e.prototype.getCount=function(){return this._map.size},e.prototype.release=function(){this._map.clear(),this._levelNodes.clear()},e}(),uY={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend",label:"label"},cY=function(){function e(t,e){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.globalInstance=t,this._compiler=e}return e.prototype.register=function(e,i){var n,r,o,a;this._parseQuery(i);var s=this.getEventBubble((null===(n=i.filter)||void 0===n?void 0:n.source)||t.Event_Source_Type.chart),l=this.getEventListeners((null===(r=i.filter)||void 0===r?void 0:r.source)||t.Event_Source_Type.chart);if(s.get(e)||s.set(e,new lY),s.get(e).addHandler(i,null===(o=i.filter)||void 0===o?void 0:o.level),this._isValidEvent(e)&&!l.has(e)){var u=this._onDelegate.bind(this);this._compiler.addEventListener(null===(a=i.filter)||void 0===a?void 0:a.source,e,u),l.set(e,u)}return this},e.prototype.unregister=function(e,i){var n,r,o,a,s,l=!1,u=this.getEventBubble((null===(n=null==i?void 0:i.filter)||void 0===n?void 0:n.source)||t.Event_Source_Type.chart),c=this.getEventListeners((null===(r=null==i?void 0:i.filter)||void 0===r?void 0:r.source)||t.Event_Source_Type.chart);i?(null==(s=u.get(e))||s.removeHandler(i),0===(null==s?void 0:s.getCount())&&(null==s||s.release(),u.delete(e),l=!0),(null===(o=null==i?void 0:i.wrappedCallback)||void 0===o?void 0:o.cancel)&&i.wrappedCallback.cancel()):(null==(s=u.get(e))||s.release(),u.delete(e),l=!0);if(l&&this._isValidEvent(e)){var h=c.get(e);this._compiler.removeEventListener((null===(a=null==i?void 0:i.filter)||void 0===a?void 0:a.source)||t.Event_Source_Type.chart,e,h),c.delete(e)}return this},e.prototype.dispatch=function(e,i,n){var r=this.getEventBubble(i.source||t.Event_Source_Type.chart).get(e);if(!r)return this;var o=!1;if(n){var a=r.getHandlers(n);o=this._invoke(a,e,i)}else{a=r.getHandlers(t.Event_Bubble_Level.mark);if(!(o=this._invoke(a,e,i))){var s=r.getHandlers(t.Event_Bubble_Level.model);o=this._invoke(s,e,i)}if(!o){var l=r.getHandlers(t.Event_Bubble_Level.chart);o=this._invoke(l,e,i)}if(!o){var u=r.getHandlers(t.Event_Bubble_Level.vchart);o=this._invoke(u,e,i)}}return this},e.prototype.release=function(){var e,i,n,r,o,a,s,l,c,h,d,f;try{for(var p=u(this._viewListeners.entries()),v=p.next();!v.done;v=p.next()){var y=v.value;this._compiler.removeEventListener(t.Event_Source_Type.chart,y[0],y[1])}}catch(t){e={error:t}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(e)throw e.error}}this._viewListeners.clear();try{for(var g=u(this._windowListeners.entries()),m=g.next();!m.done;m=g.next()){y=m.value;this._compiler.removeEventListener(t.Event_Source_Type.window,y[0],y[1])}}catch(t){n={error:t}}finally{try{m&&!m.done&&(r=g.return)&&r.call(g)}finally{if(n)throw n.error}}this._windowListeners.clear();try{for(var _=u(this._canvasListeners.entries()),b=_.next();!b.done;b=_.next()){y=b.value;this._compiler.removeEventListener(t.Event_Source_Type.canvas,y[0],y[1])}}catch(t){o={error:t}}finally{try{b&&!b.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}this._canvasListeners.clear();try{for(var x=u(this._viewBubbles.values()),k=x.next();!k.done;k=x.next()){k.value.release()}}catch(t){s={error:t}}finally{try{k&&!k.done&&(l=x.return)&&l.call(x)}finally{if(s)throw s.error}}this._viewBubbles.clear();try{for(var S=u(this._windowBubbles.values()),A=S.next();!A.done;A=S.next()){A.value.release()}}catch(t){c={error:t}}finally{try{A&&!A.done&&(h=S.return)&&h.call(S)}finally{if(c)throw c.error}}this._windowBubbles.clear();try{for(var w=u(this._canvasBubbles.values()),T=w.next();!T.done;T=w.next()){T.value.release()}}catch(t){d={error:t}}finally{try{T&&!T.done&&(f=w.return)&&f.call(w)}finally{if(d)throw d.error}}this._canvasBubbles.clear()},e.prototype._filter=function(t,e,i){var n,r,o;if(A(t.filter)&&!t.filter(i))return!1;if(t.nodeName&&U(i,"node.name")!==t.nodeName)return!1;if(t.markName&&(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)!==t.markName)return!1;var a=null===(r=i.model)||void 0===r?void 0:r.type;return uY[a]&&(a=uY[a]),(!t.type||a===t.type)&&(!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&(!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!T(t.userId)||(null===(o=i.model)||void 0===o?void 0:o.userId)===t.userId)))},e.prototype._prepareParams=function(t,e){if(t.markName&&e.mark&&e.itemMap){var i=e.mark.getProductId(),n=e.itemMap.get(i),r=null==n?void 0:n.getDatum();return o(o({},e),{item:n,datum:r})}return o({},e)},e.prototype._onDelegate=function(t){var e,i=this.globalInstance.getChart(),n=T(t.modelId)&&(null==i?void 0:i.getModelById(t.modelId))||void 0,r=T(t.markId)&&(null==i?void 0:i.getMarkById(t.markId))||null,o=new Map,a=null===(e=t.item)||void 0===e?void 0:e.mark;for(a&&T(a.id())&&o.set(a.id(),t.item);null==a?void 0:a.elements;){var s=a.id();T(s)&&!o.has(s)&&o.set(s,a.elements[0]),a=a.group}var l={event:t.event,item:t.item,datum:t.datum,source:t.source,itemMap:o,chart:i,model:n,mark:null!=r?r:void 0,node:U(t.event,"target")};this.dispatch(t.type,l)},e.prototype._invoke=function(t,e,i){var n=this,r=t.map((function(t){var r,o,a,s=t.filter;if(!t.query||n._filter(s,e,i)){var l=(t.wrappedCallback||t.callback).call(null,n._prepareParams(s,i)),u=null!=l?l:null===(r=t.query)||void 0===r?void 0:r.consume;return u&&(null===(o=i.event)||void 0===o||o.stopPropagation(),null===(a=i.event)||void 0===a||a.preventDefault()),!!u}}));return r.some((function(t){return!0===t}))},e.prototype._getQueryLevel=function(e){return e?e.level?e.level:T(e.id)?t.Event_Bubble_Level.model:t.Event_Bubble_Level.vchart:t.Event_Bubble_Level.vchart},e.prototype._parseQuery=function(e){var i,n=e.query;(null==n?void 0:n.throttle)?e.wrappedCallback=Bt(e.callback,n.throttle):(null==n?void 0:n.debounce)&&(e.wrappedCallback=Pt(e.callback,n.debounce));var r=this._getQueryLevel(n),o=null,a=t.Event_Source_Type.chart,s=null,l=null,u=null;return(null==n?void 0:n.nodeName)&&(s=n.nodeName),(null==n?void 0:n.markName)&&(l=n.markName),!(null==n?void 0:n.type)||r!==t.Event_Bubble_Level.model&&r!==t.Event_Bubble_Level.mark||(o=n.type),(null==n?void 0:n.source)&&(a=n.source),T(null==n?void 0:n.id)&&(u=null==n?void 0:n.id,r=t.Event_Bubble_Level.model),e.filter={level:r,markName:l,type:o,source:a,nodeName:s,userId:u,filter:null!==(i=null==n?void 0:n.filter)&&void 0!==i?i:null},e},e.prototype.getEventBubble=function(e){switch(e){case t.Event_Source_Type.chart:return this._viewBubbles;case t.Event_Source_Type.window:return this._windowBubbles;case t.Event_Source_Type.canvas:return this._canvasBubbles;default:return this._viewBubbles}},e.prototype.getEventListeners=function(e){switch(e){case t.Event_Source_Type.chart:return this._viewListeners;case t.Event_Source_Type.window:return this._windowListeners;case t.Event_Source_Type.canvas:return this._canvasListeners;default:return this._viewListeners}},e.prototype._isValidEvent=function(e){return tV.includes(e)||Object.values(t.VGRAMMAR_HOOK_EVENT).includes(e)||Object.values(t.ChartEvent).includes(e)},e}();function hY(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function dY(t,e,i){t.getParser(e)||t.registerParser(e,i)}var fY,pY=new Map;function vY(t,e,i){void 0===i&&(i={type:"geojson",centroid:!0}),pY.has(t)&&Ea("map type of '".concat(t,"' already exists, will be overwritten.")),fY||(dY(fY=new wa,"geojson",_a),dY(fY,"topojson",xa),hY(fY,"simplify",Ho));var n=new Ma(fY),r=Q({},{centroid:!0,simplify:!1},i);"topojson"===i.type?n.parse(e,{type:"topojson",options:r}):n.parse(e,{type:"geojson",options:r}),!0===i.simplify&&n.transform({type:"simplify"}),pY.set(t,n)}function yY(t){pY.has(t)?pY.delete(t):Ea("map type of '".concat(t,"' does not exists."))}function gY(t,e){void 0===e&&(e=!1);var i=e;return t.latestData instanceof Ma&&(i=!1),i?X(t.latestData):t.latestData.slice()}var mY,_Y=function(t,e){return 0===t.length?[]:1===t.length?gY(t[0],null==e?void 0:e.deep):t.map((function(t){return gY(t,null==e?void 0:e.deep)}))};function bY(t,e,i){hY(e=e instanceof wa?e:t.dataSet,"copyDataView",_Y);var n=new Ma(e,i);return n.parse([t],{type:"dataview"}),n.transform({type:"copyDataView",level:mY.copyDataView}),n}function xY(t,e,i,n){var r,o,a;if(void 0===i&&(i=[]),void 0===n&&(n={}),t instanceof Ma)return t;var s,l=t.id,u=t.values,c=void 0===u?[]:u,h=t.fromDataIndex,d=t.fromDataId,f=t.transforms,p=void 0===f?[]:f,v=t.parser?X(t.parser):{clone:!0},y=X(t.fields);v.clone=!(!1===v.clone);var g=i.find((function(t){return t.name===l}));if(g)s=g;else{var m={name:l};if(y&&(m.fields=y),s=new Ma(e,m),"string"==typeof d){if(!(_=i.find((function(t){return t.name===d}))))return(null!==(r=n.onError)&&void 0!==r?r:Ra)("no data matches fromDataId ".concat(d)),null;s.parse([_],{type:"dataview"}),s.transform({type:"copyDataView"})}else if("number"==typeof h){var _;if(!(_=i[h]))return(null!==(o=n.onError)&&void 0!==o?o:Ra)("no data matches fromDataIndex ".concat(h)),null;s.parse([_],{type:"dataview"}),s.transform({type:"copyDataView"})}else Array.isArray(c)?s.parse(c,v):!P(c)||v&&!["csv","dsv","tsv"].includes(v.type)?(s.parse([]),Ea("values should be array")):s.parse(c,null!==(a=v)&&void 0!==a?a:{type:"csv"});p&&p.length&&p.forEach((function(t){e.getTransform(t.type)&&s.transform(t)}))}return s}function kY(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}!function(t){t[t.copyDataView=-10]="copyDataView",t[t.treemapFilter=-8]="treemapFilter",t[t.treemapFlatten=-7]="treemapFlatten",t[t.dotObjFlat=-7]="dotObjFlat",t[t.linkDotInfo=-7]="linkDotInfo",t[t.sankeyLayout=-7]="sankeyLayout",t[t.dataZoomFilter=-6]="dataZoomFilter",t[t.legendFilter=-5]="legendFilter"}(mY||(mY={}));var SY,AY,wY=function(t,e){var i={nodes:{}},n=e.fields;if(!(null==n?void 0:n.length))return i;var r,o=n.length-1,a=i;return t.forEach((function(t){t.latestData.forEach((function(t){a=i;for(var e=0;e<n.length;e++){var s=t[n[e]];if(w(s))break;a.nodes[s]||(e===o?a.nodes[s]={values:[]}:(r={nodes:{}},a.nodes[s]=r)),e===o?a.nodes[s].values.push(t):a=a.nodes[s]}}))})),i};function TY(e){switch(e){case t.RenderModeEnum["desktop-browser"]:case t.RenderModeEnum["mobile-browser"]:return"browser";case t.RenderModeEnum.node:case t.RenderModeEnum.worker:return"node";case t.RenderModeEnum.miniApp:case t.RenderModeEnum["desktop-miniApp"]:return"feishu";case t.RenderModeEnum.lynx:return"lynx";case t.RenderModeEnum.wx:return"wx"}return"browser"}!function(t){t.appear="appear",t.disappear="disappear",t.enter="enter",t.update="update",t.state="state",t.exit="exit",t.normal="normal",t.none="none"}(SY||(SY={})),function(t){t.data="data",t.signal="signal",t.mark="mark"}(AY||(AY={}));var MY,CY,EY=function(){function e(t,e){var i;this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this.isReleased=!1,this._model=((i={})[AY.signal]={},i[AY.data]={},i[AY.mark]={},i),this._compileChart=null,this._container=t,this._option=e}return e.prototype.getVGrammarView=function(){return this._view},e.prototype.getModel=function(){return this._model},e.prototype.getRenderer=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer},e.prototype.getCanvas=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.canvas()},e.prototype.getStage=function(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.stage()},e.prototype.initView=function(){var e,i,n,r,a=this;if(!this.isReleased&&(this.isInited=!0,!this._view)){var s=new gi(null!==(e=this._option.logLevel)&&void 0!==e?e:pi.Error);(null===(i=this._option)||void 0===i?void 0:i.onError)&&s.addErrorHandler((function(){for(var t,e,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];null===(e=null===(t=a._option)||void 0===t?void 0:t.onError)||void 0===e||e.call.apply(e,h([t],c(i),!1))})),this._view=new Zj(o(o({width:this._width,height:this._height,container:null!==(n=this._container.dom)&&void 0!==n?n:null,renderCanvas:null!==(r=this._container.canvas)&&void 0!==r?r:null,hooks:this._option.performanceHook},this._option),{mode:TY(this._option.mode),autoFit:!1,eventConfig:{gesture:Xk(this._option.mode),disable:!1===this._option.interactive},doLayout:function(){var t;null===(t=a._compileChart)||void 0===t||t.onLayout(a._view)},logger:s,logLevel:s.level()})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",(function(){var e,i;null===(i=null===(e=a._compileChart)||void 0===e?void 0:e.getEvent())||void 0===i||i.emit(t.ChartEvent.afterRender,{chart:a._compileChart})})),!1!==this._option.interactive&&this._viewListeners.forEach((function(t){var e;null===(e=a._view)||void 0===e||e.addEventListener(t.type,t.callback)}))}},e.prototype._setCanvasStyle=function(){if(this._view&&this._container.dom&&!P(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";var t=this.getCanvas();t&&(t.style.display="block")}},e.prototype.compile=function(t,e){var i=t.chart;this._compileChart=i,this.initView(),this._view&&(i.compile(),i.afterCompile(),this.updateDepend())},e.prototype.clear=function(t,e){void 0===e&&(e=!1),t.chart.clear(),this.releaseGrammar(e)},e.prototype.renderAsync=function(t){var e;return s(this,void 0,void 0,(function(){return l(this,(function(i){switch(i.label){case 0:return this.isReleased?[2]:(this.initView(),this._view?[4,null===(e=this._view)||void 0===e?void 0:e.runNextTick(t)]:[2,Promise.reject("srView init fail")]);case 1:return i.sent(),[2,this]}}))}))},e.prototype.renderSync=function(t){var e;this.initView(),this._view&&(null===(e=this._view)||void 0===e||e.runSync(t))},e.prototype.updateViewBox=function(t,e){void 0===e&&(e=!0),this._view&&this._view.renderer.setViewBox(t,e)},e.prototype.resize=function(t,e,i){return void 0===i&&(i=!0),this._view?(this._width=t,this._height=e,this._view.resize(t,e),i?this.renderAsync({morph:!1}):this):Promise.reject()},e.prototype.setBackground=function(t){var e;null===(e=this._view)||void 0===e||e.background(t)},e.prototype.setSize=function(t,e){this._width=t,this._height=e,this._view&&(this._view.width(t),this._view.height(e))},e.prototype.setViewBox=function(t,e){void 0===e&&(e=!0),this._view&&this._view.renderer.setViewBox(t,e)},e.prototype.addEventListener=function(e,i,n){var r,o;if(!1!==this._option.interactive)if(e===t.Event_Source_Type.chart){var a=function(t,r){var o,a,s,l=null!==(a=null===(o=null==r?void 0:r.mark)||void 0===o?void 0:o.getContext())&&void 0!==a?a:{},u=T(l.modelId)?l.modelId:null,c=T(l.markId)?l.markId:null,h=T(l.modelUserId)?l.modelUserId:null,d=T(l.markUserId)?l.markUserId:null,f={event:t,type:i,source:e,item:r,datum:(null===(s=null==r?void 0:r.getDatum)||void 0===s?void 0:s.call(r))||null,markId:c,modelId:u,markUserId:d,modelUserId:h};n.call(null,f)}.bind(this);this._viewListeners.set(n,{type:i,callback:a}),null===(r=this._view)||void 0===r||r.addEventListener(i,a)}else if(e===t.Event_Source_Type.window){a=function(t){var r={event:t,type:i,source:e,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};n.call(null,r)}.bind(this);this._windowListeners.set(n,{type:i,callback:a});var s=this._getGlobalThis();null==s||s.addEventListener(i,a)}else if(e===t.Event_Source_Type.canvas){a=function(t){var r={event:t,type:i,source:e,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};n.call(null,r)}.bind(this);this._canvasListeners.set(n,{type:i,callback:a});var l=null===(o=this.getStage())||void 0===o?void 0:o.window;null==l||l.addEventListener(i,a)}},e.prototype.removeEventListener=function(e,i,n){var r,o,a,s;if(!1!==this._option.interactive)if(e===t.Event_Source_Type.chart)(u=null===(r=this._viewListeners.get(n))||void 0===r?void 0:r.callback)&&(null===(o=this._view)||void 0===o||o.removeEventListener(i,u)),this._viewListeners.delete(n);else if(e===t.Event_Source_Type.window){var l=this._getGlobalThis();(u=null===(a=this._windowListeners.get(n))||void 0===a?void 0:a.callback)&&(null==l||l.removeEventListener(i,u)),this._windowListeners.delete(n)}else if(e===t.Event_Source_Type.canvas){var u,c=this._getGlobalThis();(u=null===(s=this._canvasListeners.get(n))||void 0===s?void 0:s.callback)&&(null==c||c.removeEventListener(i,u)),this._canvasListeners.delete(n)}},e.prototype.releaseEvent=function(){this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()},e.prototype.release=function(){var t;this.releaseEvent(),this._option=this._container=null,this._releaseModel(),null===(t=this._view)||void 0===t||t.release(),this._view=null,this.isInited=!1,this.isReleased=!0},e.prototype.releaseGrammar=function(t){var e,i;void 0===t&&(t=!1),this._releaseModel(),t&&(null===(e=this._view)||void 0===e||e.removeAllGraphicItems()),null===(i=this._view)||void 0===i||i.removeAllGrammars()},e.prototype._releaseModel=function(){var t=this;Object.keys(this._model).forEach((function(e){Object.values(t._model[e]).forEach((function(t){Object.values(t).forEach((function(t){t.removeProduct(!0)}))})),t._model[e]={}}))},e.prototype.addGrammarItem=function(t){var e=t.getProduct();if(!w(e)){var i=e.id(),n=t.grammarType;w(this._model[n][i])&&(this._model[n][i]={}),this._model[n][i][t.id]=t}},e.prototype.removeGrammarItem=function(t,e){var i,n=t.getProduct();if(!w(n)){var r=n.id(),o=t.grammarType,a=this._model[o][r];T(a)&&(delete a[t.id],0===Object.keys(a).length&&delete this._model[o][r]),e||null===(i=this._view)||void 0===i||i.removeGrammar(n)}},e.prototype.updateDepend=function(t){return T(t)&&t.length>0?t.every((function(t){return t.updateDepend()})):(Object.values(this._model).forEach((function(t){Object.values(t).forEach((function(t){var e=Object.values(t),i=e[0].getProduct(),n=e.reduce((function(t,e){return e.getDepend().length>0?t.concat(e.getDepend()):t}),[]).filter((function(t){return!!t})).map((function(t){return t.getProduct()}));i.depend(n)}))})),!0)},e.prototype._getGlobalThis=function(){var t;return Kk(this._option.mode)?globalThis:null===(t=this.getStage())||void 0===t?void 0:t.window},e}();function RY(t){return new Promise((function(e){t.convertToBlob().then((function(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){e(i.result)}}))}))}function PY(t,e){var i;return s(this,void 0,void 0,(function(){return l(this,(function(n){if(!t)return[2,""];try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas)return[2,RY(t)]}catch(t){(null!==(i=null==e?void 0:e.onError)&&void 0!==i?i:Ra)("getCanvasDataURL error : ".concat(t.toString()))}return[2,t.toDataURL()]}))}))}function BY(t){t.crosshair=lt(t.crosshair||{}).map((function(e){var i;return $W(((i={})["horizontal"===t.direction?"yField":"xField"]={visible:!0,line:{visible:!0,type:"rect"}},i),e)}))}function LY(t,e,i){var n,r=t.width,o=t.height;if(T(r)&&T(o))return{width:r,height:o};var a=i.width,s=i.height,l=e.container,u=e.canvas;if(l){var c=_i(l,i.width,i.height);a=c.width,s=c.height}else if(u&&Kk(e.mode)){var h=_i(P(u)?null===document||void 0===document?void 0:document.getElementById(u):u,i.width,i.height);a=h.width,s=h.height}else if(Zk(e.mode)&&(null===(n=e.modeParams)||void 0===n?void 0:n.domref)){var d=e.modeParams.domref;a=d.width,s=d.height}return{width:a=null!=r?r:a,height:s=null!=o?o:s}}function OY(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=function(i){return e.reduce((function(t,e){return t||(null==e?void 0:e[i])}),t[i])};return Object.assign(t,{change:n("change"),reCompile:n("reCompile"),reMake:n("reMake"),reRender:n("reRender"),reSize:n("reSize")}),t}function IY(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every((function(t){return"area"===t.type||"line"===t.type}))?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}!function(t){t.STATE_NORMAL="normal",t.STATE_HOVER="hover",t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER="dimension_hover",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED="selected",t.STATE_SELECTED_REVERSE="selected_reverse"}(MY||(MY={})),function(t){t.STATE_HOVER_REVERSE="hover_reverse",t.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",t.STATE_SELECTED_REVERSE="selected_reverse"}(CY||(CY={}));var DY,FY=function(){function t(){this._children=[],this._markNameMap={},this._infoMap=new Map}return t.prototype.getMarkNameMap=function(){return this._markNameMap},t.prototype.addMark=function(e,i){w(e)||(this._children.push(e),this._markNameMap[e.name]=e,this._infoMap.set(e,Q({},t.defaultMarkInfo,i)))},t.prototype.removeMark=function(t){var e=this._children.findIndex((function(e){return e.name===t}));e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))},t.prototype.clear=function(){this._children=[],this._markNameMap={},this._infoMap.clear()},t.prototype.forEach=function(t){this._children.forEach(t)},t.prototype.includes=function(t,e){return this._children.includes(t,e)},t.prototype.get=function(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]},t.prototype.getMarks=function(){return this._children.slice()},t.prototype.getMarksInType=function(t){var e=lt(t);return this._children.filter((function(t){return e.includes(t.type)}))},t.prototype.getMarkInId=function(t){return this._children.find((function(e){return e.id===t}))},t.prototype.getMarkWithInfo=function(t){var e=this;return this._children.find((function(i){return Object.keys(t).every((function(n){return t[n]===e._infoMap.get(i)[n]}))}))},t.defaultMarkInfo={},t}(),zY=function(){function e(t){var e=this;this._marks=new FY,this._markReverse=new FY,this._lastDimensionEvent=null,this.onHover=function(t){var i=e.getEventElement(t);switch(t.action){case"enter":e.interaction.getEventElement(MY.STATE_DIMENSION_HOVER).forEach((function(t){e.interaction.addEventElement(MY.STATE_DIMENSION_HOVER_REVERSE,t)})),e.interaction.clearEventElement(MY.STATE_DIMENSION_HOVER,!1),i.forEach((function(t){var i=t.el;t.mark,e.interaction.addEventElement(MY.STATE_DIMENSION_HOVER,i)})),e.interaction.reverseEventElement(MY.STATE_DIMENSION_HOVER);break;case"leave":e.interaction.clearEventElement(MY.STATE_DIMENSION_HOVER,!0),t=null}e._lastDimensionEvent=t},this._option=t,this.event=this._option.model.getOption().getChart().getEvent(),this.interaction=t.interaction,this.initConfig(t.mode)}return Object.defineProperty(e.prototype,"hover",{get:function(){return this._hover},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},enumerable:!1,configurable:!0}),e.prototype.setStateKeys=function(t){},e.prototype.registerMark=function(t){W(t.stateStyle[MY.STATE_DIMENSION_HOVER])||this._marks.addMark(t),W(t.stateStyle[MY.STATE_DIMENSION_HOVER_REVERSE])||this._markReverse.addMark(t)},e.prototype.init=function(){this.initEvent()},e.prototype.release=function(){this.releaseEvent()},e.prototype.initEvent=function(){this.event.on(t.DimensionEventEnum.dimensionHover,this.onHover)},e.prototype.releaseEvent=function(){this.event.release()},e.prototype.initConfig=function(t){},e.prototype.getEventElement=function(t,e){var i=this;void 0===e&&(e=!1);var n=[];return t.dimensionInfo.forEach((function(t){t.data.forEach((function(t){var r=(e?i._markReverse:i._marks).getMarks().filter((function(e){return e.model===t.series&&e.getVisible()}));r.forEach((function(i){var r=i.getProduct().elements.filter((function(i){var n,r=i.getDatum();return n=B(r)?r.every((function(e,i){return e===t.datum[i]})):t.datum.some((function(t){return t===r})),e?!n:n})).map((function(t){return{el:t,mark:i}}));n.push.apply(n,h([],c(r),!1))}))}))})),n},e.prototype.dimensionDataEqual=function(t){if(this._lastDimensionEvent===t)return!0;if(!this._lastDimensionEvent||!t)return!1;if(this._lastDimensionEvent.dimensionInfo.length!==t.dimensionInfo.length)return!1;for(var e=0;e<this._lastDimensionEvent.dimensionInfo.length;e++){var i=this._lastDimensionEvent.dimensionInfo[e],n=t.dimensionInfo[e];if(i.value!==n.value)return!1;if(i.axis!==n.axis)return!1;if(i.data.length!==n.data.length)return!1;for(var r=0;r<i.data.length;r++){var o=i.data[r],a=n.data[r];if(o.series!==a.series)return!1;if(o.datum.length!==a.datum.length)return!1;for(var s=0;s<o.datum.length;s++)if(o.datum[s]!==a.datum[s])return!1}}return!0},e}();var jY={};Object.values(MY).forEach((function(t){jY[t]=!0}));var HY=((DY={})[MY.STATE_HOVER]=MY.STATE_HOVER_REVERSE,DY[MY.STATE_SELECTED]=MY.STATE_SELECTED_REVERSE,DY[MY.STATE_DIMENSION_HOVER]=MY.STATE_DIMENSION_HOVER_REVERSE,DY);function NY(t){return HY[t]}var VY=function(){function t(){this._stateMarks=new Map,this._stateElements=new Map,this._disableTriggerEvent=!1}return t.markStateEnable=function(t,e){return!W(t.stateStyle[e])},t.prototype.setDisableActiveEffect=function(t){this._disableTriggerEvent=t},t.prototype.registerMark=function(t,e){var i;this._stateMarks.has(t)||this._stateMarks.set(t,[]),null===(i=this._stateMarks.get(t))||void 0===i||i.push(e)},t.prototype.getStateMark=function(t){return this._stateMarks.get(t)},t.prototype.filterEventMark=function(t,e){var i;return!(!t.mark||!(null===(i=this._stateMarks.get(e))||void 0===i?void 0:i.includes(t.mark)))},t.prototype.getEventElement=function(t){var e;return null!==(e=this._stateElements.get(t))&&void 0!==e?e:[]},t.prototype.getEventElementData=function(t){return this.getEventElement(t).map((function(t){return t.getDatum()}))},t.prototype.exchangeEventElement=function(t,e){var i,n=this;if(!this._disableTriggerEvent){var r=NY(t);null===(i=this._stateElements.get(t))||void 0===i||i.forEach((function(e){e.removeState(t),r&&n.addEventElement(r,e)})),e.getStates().includes(t)||(e.addState(t),r&&e.removeState(r)),this._stateElements.set(t,[e])}},t.prototype.removeEventElement=function(t,e){var i,n;if(!this._disableTriggerEvent){e.removeState(t);var r=null!==(n=null===(i=this._stateElements.get(t))||void 0===i?void 0:i.filter((function(t){return t!==e})))&&void 0!==n?n:[];this._stateElements.set(t,r);var o=NY(t);o&&(0===r.length?this.clearEventElement(o,!1):this.addEventElement(o,e))}},t.prototype.addEventElement=function(t,e){var i;if(!this._disableTriggerEvent){e.getStates().includes(t)||e.addState(t);var n=null!==(i=this._stateElements.get(t))&&void 0!==i?i:[];n.push(e),this._stateElements.set(t,n)}},t.prototype.clearEventElement=function(t,e){var i;if(!this._disableTriggerEvent&&(null===(i=this._stateElements.get(t))||void 0===i||i.forEach((function(e){e.removeState(t)})),this._stateElements.set(t,[]),e)){var n=NY(t);n&&this.clearEventElement(n,!1)}},t.prototype.reverseEventElement=function(t){var e=this;if(!this._disableTriggerEvent){var i=NY(t);if(i){var n=this.getStateMark(i);if(n){var r=this.getEventElement(t);if(r.length)this.getEventElement(i).length||(1===r.length?n.forEach((function(t){t.getProduct().elements.filter((function(t){return t!==r[0]})).forEach((function(t){e.addEventElement(i,t)}))})):n.forEach((function(t){t.getProduct().elements.filter((function(t){return!r.includes(t)})).forEach((function(t){e.addEventElement(i,t)}))})))}}}},t}(),GY=function(){function t(t){this._option=t,this.getCompiler=this._option.getCompiler}return t.prototype.getOption=function(){return this._option},t.prototype.getVGrammarView=function(){var t;return null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView()},t.prototype.release=function(){this._option=null},t}(),WY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=Jk(),e._compiledProductId=null,e._depend=[],e}return r(e,t),e.prototype.getProduct=function(){if(T(this._product))return this._product;var t=this.getVGrammarView(),e=this.getProductId();return T(e)&&T(t)&&(this._product=this._lookupGrammar(e)),this._product},e.prototype.getProductId=function(){var t;return null!==(t=this._compiledProductId)&&void 0!==t?t:this.generateProductId()},e.prototype.getDepend=function(){return this._depend},e.prototype.setDepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._depend=t},e.prototype.compile=function(t){this._compileProduct(t),this._afterCompile(t)},e.prototype._afterCompile=function(t){var e;T(this._product)&&(null===(e=this.getCompiler())||void 0===e||e.addGrammarItem(this))},e.prototype.updateDepend=function(){if(T(this._product)){var t=this.getDepend().map((function(t){return t.getProduct()})).filter(T);return this._product.depend(t),t.length===this.getDepend().length}return!1},e.prototype.release=function(){this.removeProduct(),t.prototype.release.call(this),this._depend=[]},e.prototype.removeProduct=function(t){this.getCompiler().removeGrammarItem(this,t),this._product=null,this._compiledProductId=null},e}(GY),UY=function(t){function e(e,i,n,r){var o=t.call(this,e)||this;return o.grammarType=AY.signal,o.name=i,o._value=n,o._updateFunc=r,o}return r(e,t),e.prototype.getValue=function(){return this._value},e.prototype.getUpdateFunc=function(){return this._updateFunc},e.prototype.updateSignal=function(t,e){this._value=t,this._updateFunc=e,this.compile()},e.prototype._compileProduct=function(){var t=this.getVGrammarView();if(t){if(!this.getProduct()){var e=this.getProductId();this._product=t.signal().id(e),this._compiledProductId=e}T(this._value)&&this._product.value(this._value),T(this._updateFunc)&&this._product.update(this._updateFunc)}},e.prototype.generateProductId=function(){return this.name},e.prototype._lookupGrammar=function(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getSignalById(t)},e}(WY),YY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._signalMap={},e}return r(e,t),e.prototype.getSignalMap=function(){return this._signalMap},e.prototype.getSignal=function(t){return this._signalMap[t]},e.prototype.updateSignal=function(t,e,i){this._signalMap[t]?this._signalMap[t].updateSignal(e,i):(this._signalMap[t]=new UY(this._option,t,e,i),this._signalMap[t].compile())},e.prototype.compile=function(){Object.values(this._signalMap).forEach((function(t){t.compile()}))},e.prototype.release=function(){t.prototype.release.call(this),Object.values(this._signalMap).forEach((function(t){t.release()})),this._signalMap={}},e}(GY),KY=function(t){function e(e){var i=t.call(this,e)||this;return e.stateKeyToSignalName?i.stateKeyToSignalName=e.stateKeyToSignalName:i.stateKeyToSignalName=function(){return"state_signal"},i.initStateMap(),i}return r(e,t),e.prototype.getStateMap=function(){return this._stateMap},e.prototype._getDefaultStateMap=function(){return{}},e.prototype.initStateMap=function(t){this._stateMap=null!=t?t:this._getDefaultStateMap()},e.prototype.compile=function(t){var e=this,i=null!=t?t:this._stateMap;Object.keys(i).forEach((function(t){var n=e.stateKeyToSignalName(t),r=i[t];e.updateSignal(n,r)}))},e.prototype.updateState=function(t,e){return t?(Q(this._stateMap,t),this.compile(t),e?Promise.resolve():this.getCompiler().renderAsync()):Promise.resolve()},e}(YY),XY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=Jk(),e.stateKeyToSignalName=function(t){return"".concat(bw,"_animate_").concat(e.id,"_").concat(t)},e}return r(e,t),e.prototype.getAnimationStateSignalName=function(){return this.stateKeyToSignalName("animationState")},e.prototype.updateAnimateState=function(t,e){t===SY.update?this.updateState({animationState:{callback:function(t,e){return e.diffState}}},e):t===SY.appear?this.updateState({animationState:{callback:function(t,e){return"exit"===e.diffState?SY.none:SY.appear}}},e):this.updateState({animationState:{callback:function(e,i){return t}}},e)},e.prototype._getDefaultStateMap=function(){return{animationState:{callback:function(t,e){return"exit"===e.diffState?SY.exit:SY.appear}}}},e}(KY),ZY=function(){function t(t){this._option=t,this.type=t.type}return t.prototype._initTheme=function(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)},t.prototype.getTheme=function(t,e){},t.prototype.transformSpec=function(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);var n=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(n.spec,e,i),n},t.prototype._transformSpecBeforeMergingTheme=function(t,e,i){},t.prototype._transformSpecAfterMergingTheme=function(t,e,i){},t.prototype._mergeThemeToSpec=function(t,e){var i=this._theme;if(this._shouldMergeThemeToSpec()){var n=this._getDefaultSpecFromChart(e),r=function(t){return $W({},i,n,t)};return B(t)?{spec:t.map((function(t){return r(t)})),theme:i}:{spec:r(t),theme:i}}return{spec:t,theme:i}},t.prototype._shouldMergeThemeToSpec=function(){return!0},t.prototype._getDefaultSpecFromChart=function(t){},t}(),qY=function(t){function e(e,i){var n,r,o=this;return(o=t.call(this,i)||this).transformerConstructor=ZY,o.type="null",o.modelType="null",o.userId=void 0,o._data=null,o._layout=null,o._specIndex=0,o.specKey="",o._marks=new FY,o._lastLayoutRect=null,o.id=Jk(),o.userId=e.id,o._spec=e,o._specIndex=null!==(n=i.specIndex)&&void 0!==n?n:0,o.effect={},o.event=new sY(i.eventDispatcher,i.mode),null===(r=i.map)||void 0===r||r.set(o.id,o),o}return r(e,t),e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getSpecPath=function(){return this._option.specPath},e.prototype.getSpecInfoPath=function(){var t;return null!==(t=this._option.specInfoPath)&&void 0!==t?t:this._option.specPath},e.prototype.getData=function(){return this._data},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!1,configurable:!0}),e.prototype.getSpecIndex=function(){return this._specIndex},e.prototype.getOption=function(){return this._option},e.prototype.getMarks=function(){var t,e;return null!==(e=null===(t=this._marks)||void 0===t?void 0:t.getMarks())&&void 0!==e?e:[]},e.prototype.getMarkNameMap=function(){var t;return null===(t=this._marks)||void 0===t?void 0:t.getMarkNameMap()},e.prototype.getMarkSet=function(){return this._marks},e.prototype.getMarkInfoList=function(){return this.getMarks().map((function(t){return{type:t.type,name:t.name}}))},e.prototype.getChart=function(){return this._option.getChart()},Object.defineProperty(e.prototype,"_theme",{get:function(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.theme},enumerable:!1,configurable:!0}),e.prototype._releaseEvent=function(){this.event.release()},e.prototype.created=function(){this.setAttrFromSpec()},e.prototype.init=function(t){},e.prototype.afterInit=function(){},e.prototype.getVisible=function(){var t;return!1!==(null===(t=this._spec)||void 0===t?void 0:t.visible)},e.prototype.onLayoutStart=function(t,e,i){var n;null===(n=this._layout)||void 0===n||n.onLayoutStart(t,e,i)},e.prototype.onLayoutEnd=function(t){var e;null===(e=this._layout)||void 0===e||e.onLayoutEnd(t),this.getMarks().forEach((function(t){return t.updateLayoutState(!0,!0)}))},e.prototype.onEvaluateEnd=function(t){},e.prototype.onDataUpdate=function(){},e.prototype.beforeRelease=function(){},e.prototype.release=function(){var e;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach((function(t){return t.release()})),null===(e=this._data)||void 0===e||e.release(),this._data=this._specIndex=null,this._marks.clear(),t.prototype.release.call(this)},e.prototype.updateSpec=function(t){var e=this._compareSpec(t,this._spec);return this._spec=t,e.reMake||this.reInit(),e},e.prototype._compareSpec=function(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}},e.prototype.reInit=function(t){t&&(this._spec=t),this.setAttrFromSpec()},e.prototype.updateLayoutAttribute=function(){},e.prototype.setAttrFromSpec=function(){var t;null===(t=this._layout)||void 0===t||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())},e.prototype._convertMarkStyle=function(t){return o({},t)},e.prototype.setMarkStyle=function(t,e,i,n){T(t)&&T(e)&&t.setStyle(this._convertMarkStyle(e),i,n)},e.prototype.initMarkStyleWithSpec=function(t,e,i){var n=this;if(T(t)&&T(e)){var r=e.style,a=e.state,s=o({},e);r&&(s.style=this._convertMarkStyle(r)),a&&(s.state={},Object.keys(a).forEach((function(t){s.state[t]=n._convertMarkStyle(a[t])}))),t.initStyleWithSpec(s,i)}},e.prototype.stateKeyToSignalName=function(t,e){var i="".concat(bw,"_").concat(this.modelType,"_").concat(this.type,"_").concat(this.id,"_").concat(t);return e&&(i+="_".concat(e)),i},e.prototype.compileData=function(){var t;null===(t=this._data)||void 0===t||t.compile()},e.prototype.compileMarks=function(t){this.getMarks().forEach((function(e){e.compile({group:t})}))},e.prototype._createMark=function(t,e){void 0===e&&(e={});var i=t.type,n=t.name,r=FU.createMark(i,n,o({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},e));return null==r||r.created(),r},e.prototype._getDataIdKey=function(){},e.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme},e.prototype.getSpecInfo=function(){var t,e,i;return function(t,e,i){if(!w(e))return U(t,e,i)}(null!==(i=null===(e=(t=this._option).getSpecInfo)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{},this.getSpecInfoPath())},e}(GY),JY=function(){function e(e,i){var n,r=this;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:0,height:0},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=function(){return r._layoutRect},this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=t.LayoutLevel.Region,this._model=e,this._option=i,this.layoutLevel=i.layoutLevel,this.layoutType=i.layoutType,i.layoutOrient&&(this.layoutOrient=i.layoutOrient),this._spec=null===(n=null==e?void 0:e.getSpec)||void 0===n?void 0:n.call(e)}return e.prototype.getSpec=function(){return this._spec||{}},e.prototype.getLayoutStartPoint=function(){return this._layoutStartPoint},Object.defineProperty(e.prototype,"layoutRectLevelMap",{get:function(){return this._layoutRectLevelMap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){return this._minWidth},set:function(t){this._minWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){return this._minHeight},set:function(t){this._minHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=t},enumerable:!1,configurable:!0}),e.prototype.getLastComputeOutBounds=function(){return this._lastComputeOutBounds},Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._layoutOrient},set:function(t){this._layoutOrient=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._model.type},enumerable:!1,configurable:!0}),e.prototype._setLayoutAttributeFromSpec=function(t,e){var i,n,r,o;if(this._spec&&!1!==this._spec.visible){var a=hW(dW(t.padding),e,e);this.layoutPaddingLeft=a.left,this.layoutPaddingRight=a.right,this.layoutPaddingTop=a.top,this.layoutPaddingBottom=a.bottom,this._minHeight=w(t.minHeight)?null!==(i=this._minHeight)&&void 0!==i?i:null:cW(t.minHeight,e.height,e),this._maxHeight=w(t.maxHeight)?null!==(n=this._maxHeight)&&void 0!==n?n:null:cW(t.maxHeight,e.height,e),this._minWidth=w(t.minWidth)?null!==(r=this._minWidth)&&void 0!==r?r:null:cW(t.minWidth,e.width,e),this._maxWidth=w(t.maxWidth)?null!==(o=this._maxWidth)&&void 0!==o?o:null:cW(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:cW(t.width,e.width,e)},{width:9}),t.height&&this.setLayoutRect({height:cW(t.height,e.height,e)},{height:9}),w(t.offsetX)||(this.layoutOffsetX=cW(t.offsetX,e.width,e)),w(t.offsetY)||(this.layoutOffsetY=cW(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}},e.prototype.setAttrFromSpec=function(t,e){var i,n,r,o;this._spec=t,this.layoutType=null!==(i=t.layoutType)&&void 0!==i?i:this.layoutType,this.layoutLevel=null!==(n=t.layoutLevel)&&void 0!==n?n:this.layoutLevel,this.layoutOrient=null!==(r=t.orient)&&void 0!==r?r:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!==(o=t.clip)&&void 0!==o?o:this.layoutClip},e.prototype.onLayoutStart=function(t,e,i){this._setLayoutAttributeFromSpec(this._spec,e)},e.prototype.onLayoutEnd=function(t){},e.prototype._getAbsoluteSpecValue=function(t){var e=this,i={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach((function(n){w(e._spec[n])||(i[n]=cW(e._spec[n],"top"===n||"bottom"===n?t.height:t.width,t))})),i},e.prototype.absoluteLayoutInRect=function(t){var e=this._getAbsoluteSpecValue(t),i=e.top,n=e.bottom,r=e.left,o=e.right,a={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};w(r)||(a.width-=r),w(o)||(a.width-=o),w(i)||(a.height-=i),w(n)||(a.height-=n),this.setLayoutRect(a);var s=this.computeBoundsInRect(this.getLayoutRect()),l=s.width,u=s.height;this.setLayoutRect({width:l,height:u});var c={x:t.x,y:t.y};!0===this._spec.center?(c.x=t.x+.5*t.width-.5*l,c.y=t.y+.5*t.height-.5*u):(w(r)?w(o)||(c.x=t.x+t.width-this.layoutPaddingRight-o-l):c.x=t.x+r+this.layoutPaddingLeft,w(i)?w(n)||(c.y=t.y+t.height-this.layoutPaddingBottom-n-u):c.y=t.y+i+this.layoutPaddingTop),this.setLayoutStartPosition(c)},e.prototype.setLayoutStartPosition=function(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),F(t.x)&&(this._layoutStartPoint.x=t.x),F(t.y)&&(this._layoutStartPoint.y=t.y),null===(i=(e=this._model).afterSetLayoutStartPoint)||void 0===i||i.call(e,this._layoutStartPoint)},e.prototype.setLayoutRect=function(t,e){var i,n,r,o,a=t.width,s=t.height;F(a)&&(null!==(i=null==e?void 0:e.width)&&void 0!==i?i:0)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=a,this._layoutRectLevelMap.width=null!==(n=null==e?void 0:e.width)&&void 0!==n?n:0),F(s)&&(null!==(r=null==e?void 0:e.height)&&void 0!==r?r:0)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=s,this._layoutRectLevelMap.height=null!==(o=null==e?void 0:e.height)&&void 0!==o?o:0),this.setRectInSpec(this._layoutRect)},e.prototype.getLayout=function(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}},e.prototype.mergeLayoutRect=function(t){var e={width:t.width,height:t.height};return this._layoutRectLevelMap.width>0&&(e.width=this._layoutRect.width),this._layoutRectLevelMap.height>0&&(e.height=this._layoutRect.height),e},e.prototype.getOrientPosAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"},e.prototype.getOrientSizeAttribute=function(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"},e.prototype.changeBoundsBySetting=function(t){return this._layoutRectLevelMap.width>0&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>0&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t},e.prototype.setRectInSpec=function(t){var e=o({},t);return this._layoutRectLevelMap.width<9?(w(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),w(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<9?(w(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),w(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e},e.prototype.computeBoundsInRect=function(t){if(this._lastComputeRect=t,"region-relative"===this.layoutType&&(9===this._layoutRectLevelMap.width&&("left"===this.layoutOrient||"right"===this.layoutOrient)||9===this._layoutRectLevelMap.height&&("bottom"===this.layoutOrient||"top"===this.layoutOrient)))return this._layoutRect;var e=o({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(e),this.autoIndent&&e.x2-e.x1>0&&e.y2-e.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-e.x1),this._lastComputeOutBounds.x2=Math.ceil(e.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-e.y1),this._lastComputeOutBounds.y2=Math.ceil(e.y2-t.height));var i=this.setRectInSpec(function(t,e){return t?{width:Math.ceil(Math.min(t.x2-t.x1,e.width)),height:Math.ceil(Math.min(t.y2-t.y1,e.height))}:{width:0,height:0}}(e,t));return this._option.transformLayoutRect&&(i=this._option.transformLayoutRect(i)),i},e.prototype.getModelId=function(){return this._model.id},e.prototype.getModelVisible=function(){return this._model.getVisible()},e}(),QY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="normal",e.layoutLevel=0,e.layoutZIndex=0,e._forceLayoutTag=!1,e._layout=null,e._orient=null,e._layoutRect={width:0,height:0},e._layoutStartPos={x:0,y:0},e._isLayout=!0,e.getGraphicBounds=function(){return e._layout?{x1:e._layout.getLayoutStartPoint().x,y1:e._layout.getLayoutStartPoint().y,x2:e._layout.getLayoutStartPoint().x+e._layout.getLayoutRect().width,y2:e._layout.getLayoutStartPoint().y+e._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0}},e._transformLayoutRect=null,e._transformLayoutPosition=null,e}return r(e,t),Object.defineProperty(e.prototype,"layoutOrient",{get:function(){return this._orient},set:function(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)},enumerable:!1,configurable:!0}),e.prototype.initLayout=function(){"none"!==this.layoutType&&(this._layout=new JY(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this.layout&&(this._layout.layoutOrient=this._orient))},e.prototype.onLayoutStart=function(e,i,n){this._isLayout=!0,t.prototype.onLayoutStart.call(this,e,i,n)},e.prototype.onLayoutEnd=function(e){t.prototype.onLayoutEnd.call(this,e),this.updateLayoutAttribute();var i=this.getLayoutRect();!this._forceLayoutTag&&nt(this._lastLayoutRect,i)||(this._lastLayoutRect=o({},i)),this._forceLayoutTag=!1,this._isLayout=!1},e.prototype.afterSetLayoutStartPoint=function(t){},e.prototype._forceLayout=function(){var t;this._isLayout||(this._forceLayoutTag=!0,null===(t=this._option.globalInstance.getChart())||void 0===t||t.setLayoutTag(!0))},e.prototype.getLayoutStartPoint=function(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos},e.prototype.setLayoutStartPosition=function(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=Q(this._layoutStartPos,t)},e.prototype.getLayoutRect=function(){return this._layout?this._layout.getLayoutRect():this._layoutRect},e.prototype.setLayoutRect=function(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=Q(this._layoutRect,t)},e.prototype.getLastComputeOutBounds=function(){var t;return null===(t=this._layout)||void 0===t?void 0:t.getLastComputeOutBounds()},e.prototype.setAttrFromSpec=function(){var e,i,n;t.prototype.setAttrFromSpec.call(this),this.layoutClip=null!==(e=this._spec.clip)&&void 0!==e?e:this.layoutClip,this.layoutZIndex=null!==(i=this._spec.zIndex)&&void 0!==i?i:this.layoutZIndex,this.layoutType=null!==(n=this._spec.layoutType)&&void 0!==n?n:this.layoutType},e}(qY),$Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(ZY),tK=function(e){function i(n,r){var o,a=this;return(a=e.call(this,n,r)||this).transformerConstructor=$Y,a.modelType="region",a.specKey="region",a.type=i.type,a._series=[],a.layoutType="region",a.layoutZIndex=t.LayoutZIndex.Region,a.interaction=new VY,a.seriesDataFilterOver=function(){a.event.emit(t.ChartEvent.regionSeriesDataFilterOver,{model:a}),a._series.forEach((function(t){t.getViewDataFilter()&&t.reTransformViewData()}))},a.getBoundsInRect=function(){return{x1:a._layout.getLayoutStartPoint().x,y1:a._layout.getLayoutStartPoint().y,x2:a._layout.getLayoutStartPoint().x+a._layout.getLayoutRect().width,y2:a._layout.getLayoutStartPoint().y+a._layout.getLayoutRect().height}},a.userId=n.id,a.coordinate=null!==(o=n.coordinate)&&void 0!==o?o:"cartesian",a._option.animation&&(a.animate=new XY({getCompiler:r.getCompiler})),a.interaction.setDisableActiveEffect(a._option.disableTriggerEvent),a}return r(i,e),i.prototype.getMaxWidth=function(){return this._layout.maxWidth},i.prototype.setMaxWidth=function(t){this._layout.maxWidth=t},i.prototype.getMaxHeight=function(){return this._layout.maxHeight},i.prototype.setMaxHeight=function(t){this._layout.maxHeight=t},i.prototype.getGroupMark=function(){return this._groupMark},i.prototype.getInteractionMark=function(){return this._interactionMark},i.prototype.getStackInverse=function(){return!0===this._spec.stackInverse},i.prototype._getClipDefaultValue=function(){var t,e,i,n,r=this._option.getChart().getSpec(),o=null===(e=null===(t=r.dataZoom)||void 0===t?void 0:t.some)||void 0===e?void 0:e.call(t,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"filter")})),a=null===(n=null===(i=r.scrollBar)||void 0===i?void 0:i.some)||void 0===n?void 0:n.call(i,(function(t){var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"axis")}));return!(!o&&!a)||this._layout.layoutClip},i.prototype.created=function(){var i,n=this;this.initLayout(),e.prototype.created.call(this);var r=null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._interactionMark=this._createGroupMark("regionInteractionGroup",this.userId+"_interaction",t.LayoutZIndex.Interaction),this._spec.style&&(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"}),r&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"})),[this._backgroundMark,this._foregroundMark].forEach((function(e){e&&(e.created(),n.setMarkStyle(e,{width:function(){return n.getLayoutRect().width},height:function(){return n.getLayoutRect().height}},"normal",t.AttributeLevel.Built_In),n._groupMark.addMark(e))})),this._backgroundMark&&this._backgroundMark.setZIndex(0),this._foregroundMark&&this._foregroundMark.setZIndex(t.LayoutZIndex.Mark+1)),this.createTrigger()},i.prototype._createGroupMark=function(e,i,n){var r,o,a=this,s=this._createMark({type:"group",name:e});s.setUserId(i),s.setZIndex(n);var l=null!==(r=this._spec.clip)&&void 0!==r?r:this._getClipDefaultValue();return this.setMarkStyle(s,{x:function(){return a.getLayoutStartPoint().x},y:function(){return a.getLayoutStartPoint().y},width:function(){return a.getLayoutRect().width},height:function(){return a.getLayoutRect().height},clip:l},"normal",t.AttributeLevel.Built_In),this.setMarkStyle(s,{cornerRadius:null===(o=this._spec.style)||void 0===o?void 0:o.cornerRadius},"normal",t.AttributeLevel.User_Mark),this._marks.addMark(s),s},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initMark(),this.initSeriesDataflow(),this.initInteraction(),this.initTrigger()},i.prototype.initMark=function(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype._initBackgroundMarkStyle=function(){var e,i;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,o({fillOpacity:(null===(e=this._spec.style)||void 0===e?void 0:e.fill)?1:0},this._spec.style),"normal",t.AttributeLevel.User_Mark),(null!==(i=this._spec.clip)&&void 0!==i?i:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",t.AttributeLevel.Built_In))},i.prototype._initForegroundMarkStyle=function(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,o(o({},this._spec.style),{fillOpacity:0}),"normal",t.AttributeLevel.User_Mark)},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return nt(null==i?void 0:i.style,null==t?void 0:t.style)||(n.reMake=!0),n},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()},i.prototype.addSeries=function(t){t&&(this._series.includes(t)||this._series.push(t))},i.prototype.removeSeries=function(t){if(t){var e=this._series.findIndex((function(e){return e===t}));e>=0&&this._series.splice(e,1)}},i.prototype.getSeries=function(t){return void 0===t&&(t={}),this._series.filter((function(e){var i,n;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||lt(t.userId).includes(e.userId))&&(!T(t.specIndex)||!e.getSpecIndex||lt(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null===(n=null===(i=e.getRawData)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.name)===t.dataName)}))},i.prototype.getSeriesInName=function(t){return this.getSeries({name:t})[0]},i.prototype.getSeriesInUserId=function(t){return this.getSeries({userId:t})[0]},i.prototype.getSeriesInId=function(t){return this.getSeries({id:t})[0]},i.prototype.getSeriesInType=function(t){return this.getSeries({type:t})},i.prototype.getSeriesInCoordinateType=function(t){return this.getSeries({coordinateType:t})},i.prototype.getSeriesInDataName=function(t){return this.getSeries({dataName:t})},i.prototype.onRender=function(t){},i.prototype.initSeriesDataflow=function(){var t=this._series.map((function(t){var e;return null!==(e=t.getViewDataFilter())&&void 0!==e?e:t.getViewData()})).filter((function(t){return!!t}));this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)},i.prototype.release=function(){e.prototype.release.call(this),this._series=[]},i.prototype.createTrigger=function(){var t=o(o({},this._option),{model:this,interaction:this.interaction});this._trigger=new zY(t)},i.prototype.initTrigger=function(){var t=this;this._series.forEach((function(e){e.getMarksWithoutRoot().forEach((function(e){t._trigger.registerMark(e)}))})),this._trigger.init()},i.prototype.initInteraction=function(){var t=this;this._series.forEach((function(e){e.getMarksWithoutRoot().forEach((function(e){for(var i in CY)W(e.stateStyle[CY[i]])||t.interaction.registerMark(CY[i],e)}))}))},i.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){var n;i.compile({group:t}),null===(n=i.getProduct())||void 0===n||n.configure({context:{model:e}}).layout((function(t,e,i,n){}))}))},i.prototype.compile=function(){var t;null===(t=this.animate)||void 0===t||t.compile(),this.compileMarks()},i.prototype.onLayoutEnd=function(t){this._series.forEach((function(e){return e.onLayoutEnd(t)})),e.prototype.onLayoutEnd.call(this,t)},i.type="region",i.transformerConstructor=$Y,i.specKey="region",i}(QY);function eK(t){var e=[],i=[],n=[];return t.forEach((function(t){w(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&n.push(t)})),{startItems:e,endItems:n,middleItems:i}}function iK(t,e,i){e?t.forEach((function(t){var e=ut(t),n=e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})}))})):t.forEach((function(t){var e=ut(t),n=e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x,r=(i-n)/2;t.forEach((function(t){t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})}))}))}function nK(t,e,i,n){var r;t.forEach((function(t,o){t.length>1&&(r=i[o],t.forEach((function(t){if(t.alignSelf&&"start"!==t.alignSelf){var i=t.getLayoutStartPoint(),o="middle"===t.alignSelf?.5:1,a=e?r-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):r-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+n*a*o,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+n*a*o})}})))}))}function rK(t,e,i,n,r){if(t.length){var o=0,a="right"===r,s=a?-1:1,l=a?e.rightCurrent:e.leftCurrent,u=e.topCurrent,c=[],h=[],d=[];t.forEach((function(t){var n=e.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);t.setLayoutRect(r);var f=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=a?-r.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:l+t.layoutOffsetX+v,y:u+t.layoutOffsetY+t.layoutPaddingTop}),(u+=f)>i&&h.length?(d.push(o),l+=s*o,o=p,u=e.topCurrent+f,t.setLayoutStartPosition({x:l+t.layoutOffsetX+v,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),c.push(h),h=[t]):(o=Math.max(o,p),h.push(t))})),d.push(o),c.push(h),nK(c,!0,d,s),n&&iK(c,!0,i),a?e.rightCurrent=l+s*o:e.leftCurrent=l+s*o}}function oK(t,e,i,n){if(t.length){var r=0,o="right"===n,a=o?-1:1,s=o?e.rightCurrent:e.leftCurrent,l=e.bottomCurrent,u=[],c=[],h=[];t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n);var d=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,f=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,p=o?-n.width-t.layoutPaddingRight:t.layoutPaddingLeft;l<d&&c.length?(h.push(r),s+=a*r,r=f,l=e.bottomCurrent,t.setLayoutStartPosition({x:s+t.layoutOffsetX+p,y:l+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),u.push(c),c=[t]):(t.setLayoutStartPosition({x:s+t.layoutOffsetX+p,y:l+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),r=Math.max(r,f),l-=d,c.push(t))})),h.push(r),u.push(c),nK(u,!0,h,a),o?e.rightCurrent=s+a*r:e.leftCurrent=s+a*r}}function aK(t,e,i,n,r){if(t.length){var o="top"===r,a=o?1:-1,s=0,l=e.leftCurrent,u=o?e.topCurrent:e.bottomCurrent,c=[],h=[],d=[];t.forEach((function(t){var n=e.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);t.setLayoutRect(r);var f=r.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=r.width+t.layoutPaddingLeft+t.layoutPaddingRight,v=o?t.layoutPaddingTop:-r.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:l+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+v}),(l+=p)>i&&h.length?(d.push(s),l=e.leftCurrent+p,u+=a*s,s=f,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:u+t.layoutOffsetY+v}),c.push(h),h=[t]):(s=Math.max(s,f),h.push(t))})),d.push(s),c.push(h),nK(c,!1,d,a),n&&iK(c,!1,i),o?e.topCurrent=u+a*s:e.bottomCurrent=u+a*s}}function sK(t,e,i,n){if(t.length){var r="top"===n,o=r?1:-1,a=0,s=e.rightCurrent,l=r?e.topCurrent:e.bottomCurrent,u=[],c=[],h=[];t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n);var h=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,d=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=r?t.layoutPaddingTop:-n.height-t.layoutPaddingBottom;s<d&&c.length?(s=e.rightCurrent,l+=o*a,a=h,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:l+t.layoutOffsetY+f}),u.push(c),c=[t]):(c.push(t),t.setLayoutStartPosition({x:s+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:l+t.layoutOffsetY+f}),a=Math.max(a,h),s-=d)})),h.push(a),u.push(c),nK(u,!1,h,o),r?e.topCurrent=l+o*a:e.bottomCurrent=l+o*a}}var lK=function(){function t(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this._onError=null==e?void 0:e.onError}return t.prototype._layoutInit=function(t,e,i,n){this._chartLayoutRect=i,this._chartViewBox=n,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}))},t.prototype._layoutNormalItems=function(t){this.layoutNormalInlineItems(t.filter((function(t){return"normal-inline"===t.layoutType}))),this.layoutNormalItems(t.filter((function(t){return"normal"===t.layoutType})))},t.prototype._groupItems=function(t){var e=t.filter((function(t){return"region"===t.layoutType})),i=t.filter((function(t){return"region-relative"===t.layoutType})),n=t.filter((function(t){return"region-relative-overlap"===t.layoutType})),r=i.concat(n),o={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return n.forEach((function(t){o[t.layoutOrient].items.push(t)})),{regionItems:e,relativeItems:i,relativeOverlapItems:n,allRelatives:r,overlapItems:o}},t.prototype.layoutItems=function(t,e,i,n){this._layoutInit(t,e,i,n),this._layoutNormalItems(e);var r={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},o=this._groupItems(e),a=o.regionItems,s=o.relativeItems,l=o.relativeOverlapItems,u=o.allRelatives,c=o.overlapItems;this.layoutRegionItems(a,s,l,c),this._processAutoIndent(a,s,l,c,u,r),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType})))},t.prototype._processAutoIndent=function(t,e,i,n,r,o){if(void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}),r.some((function(t){return t.autoIndent}))){var a=this._checkAutoIndent(r,o),s=a.top,l=a.bottom,u=a.left,c=a.right;(s||l||u||c)&&(this.topCurrent=o.top+s,this.bottomCurrent=o.bottom-l,this.leftCurrent=o.left+u,this.rightCurrent=o.right-c,this.layoutRegionItems(t,e,i,n))}},t.prototype.layoutNormalItems=function(t){var e=this;t.forEach((function(t){var i=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(i);t.setLayoutRect(n),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.leftCurrent+=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.topCurrent+=n.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-n.width-t.layoutPaddingRight,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),e.rightCurrent-=n.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:e.bottomCurrent+t.layoutOffsetY-n.height-t.layoutPaddingBottom}),e.bottomCurrent-=n.height+t.layoutPaddingTop+t.layoutPaddingBottom)}))},t.prototype.layoutNormalInlineItems=function(t){var e=t.filter((function(t){return"left"===t.layoutOrient})),i=t.filter((function(t){return"right"===t.layoutOrient})),n=t.filter((function(t){return"top"===t.layoutOrient})),r=t.filter((function(t){return"bottom"===t.layoutOrient})),o=this._chartLayoutRect.width+this._chartLayoutRect.x,a=this._chartLayoutRect.height+this._chartLayoutRect.y;e.length&&function(t,e,i){var n=eK(t),r=n.startItems,o=n.middleItems,a=n.endItems;r.length&&rK(r,e,i,!1,"left"),o.length&&rK(o,e,i,!0,"left"),a.length&&oK(a,e,0,"left")}(e,this,a),n.length&&function(t,e,i){var n=eK(t),r=n.startItems,o=n.middleItems,a=n.endItems;r.length&&aK(r,e,i,!1,"top"),o.length&&aK(o,e,i,!0,"top"),a.length&&sK(a,e,0,"top")}(n,this,o),i.length&&function(t,e,i){var n=eK(t),r=n.startItems,o=n.middleItems,a=n.endItems;r.length&&rK(r,e,i,!1,"right"),o.length&&rK(o,e,i,!0,"right"),a.length&&oK(a,e,0,"right")}(i,this,a),r.length&&function(t,e,i){var n=eK(t),r=n.startItems,o=n.middleItems,a=n.endItems;r.length&&aK(r,e,i,!1,"bottom"),o.length&&aK(o,e,i,!0,"bottom"),a.length&&sK(a,e,0,"bottom")}(r,this,o)},t.prototype._layoutRelativeOverlap=function(t,e){var i=this;e.items.forEach((function(t){var n=i.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(n);e.rect.width=Math.max(r.width,e.rect.width),e.rect.height=Math.max(r.height,e.rect.height)})),e.items.forEach((function(n){n.setLayoutRect(e.rect),"left"===t?n.setLayoutStartPosition({x:i.leftCurrent+n.layoutOffsetX+n.layoutPaddingLeft}):"right"===t?n.setLayoutStartPosition({x:i.rightCurrent+n.layoutOffsetX+n.layoutPaddingLeft}):"top"===t?n.setLayoutStartPosition({x:i.topCurrent+n.layoutOffsetX+n.layoutPaddingLeft}):n.setLayoutStartPosition({x:i.bottomCurrent+n.layoutOffsetX+n.layoutPaddingLeft})})),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height},t.prototype._layoutRelativeItem=function(t,e){var i=t.computeBoundsInRect(e);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))},t.prototype._layoutRegionItem=function(t,e,i){var n=this,r=Math.max(Math.min.apply(Math,h([e],c(t.map((function(t){var e;return null!==(e=t.maxWidth)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0),o=Math.max(Math.min.apply(Math,h([i],c(t.map((function(t){var e;return null!==(e=t.maxHeight)&&void 0!==e?e:Number.MAX_VALUE}))),!1)),0);return t.forEach((function(t){t.setLayoutRect({width:r,height:o}),t.setLayoutStartPosition({x:n.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:n.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})})),{regionHeight:o,regionWidth:r}},t.prototype.layoutRegionItems=function(t,e,i,n){var r=this;void 0===n&&(n={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}});var o=(this.rightCurrent,this.leftCurrent),a=(this.bottomCurrent,this.topCurrent);e.filter((function(t){return"left"===t.layoutOrient||"right"===t.layoutOrient})).forEach((function(t){r._layoutRelativeItem(t,r.getItemComputeLayoutRect(t))})),this._layoutRelativeOverlap("left",n.left),this._layoutRelativeOverlap("right",n.right),o=this.rightCurrent-this.leftCurrent,e.filter((function(t){return"top"===t.layoutOrient||"bottom"===t.layoutOrient})).forEach((function(t){r._layoutRelativeItem(t,r.getItemComputeLayoutRect(t))})),this._layoutRelativeOverlap("top",n.top),this._layoutRelativeOverlap("bottom",n.bottom),a=this.bottomCurrent-this.topCurrent;var s=this._layoutRegionItem(t,o,a),l=s.regionWidth,u=s.regionHeight;e.concat(i).forEach((function(e){if(["left","right"].includes(e.layoutOrient)){var i=r.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+l-o})}else if(["top","bottom"].includes(e.layoutOrient)){i=r.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+u-a})}}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.filterRegionsWithID=function(t,e){var i,n=t.find((function(t){return t.getModelId()===e}));return n||(null!==(i=this._onError)&&void 0!==i?i:Ra)("can not find target region item, invalid id"),n},t.prototype.getItemComputeLayoutRect=function(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype._checkAutoIndent=function(t,e){var i=this,n={top:0,left:0,bottom:0,right:0};return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var r="left"===t.layoutOrient||"right"===t.layoutOrient,o=t.getLastComputeOutBounds(),a=i._getOutInLayout(o,t,e);r?(n.top=Math.max(n.top,a.top),n.bottom=Math.max(n.bottom,a.bottom)):(n.left=Math.max(n.left,a.left),n.right=Math.max(n.right,a.right))}})),n},t.prototype._getOutInLayout=function(t,e,i){var n=e.getLayoutStartPoint(),r=n.x,o=n.y,a=e.getLayoutRect(),s=a.width,l=a.height;return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(o-t.y1),bottom:o+l+t.y2-i.bottom}},t.type="base",t}(),uK=["line","area","trail"];function cK(t){return uK.includes(t)}var hK=function(t){function e(e,i){var n=t.call(this,e)||this;return n._stateInfoList=[],n._mark=i,n}return r(e,t),e.prototype.getStateInfoList=function(){return this._stateInfoList},e.prototype._getDefaultStateMap=function(){return{markUpdateRank:1}},e.prototype.getStateInfo=function(t){return this._stateInfoList.find((function(e){return e.stateValue===t}))},e.prototype.addStateInfo=function(t){if(!this.getStateInfo(t.stateValue)){t.level=t.level||0;for(var e=!0,i=0;i<this._stateInfoList.length;i++){var n=this._stateInfoList[i].level;if(n&&n>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}},e.prototype._clearStateBeforeSet=function(t){t.datums=null,t.items=null,t.fields=null,t.filter=null},e.prototype.changeStateInfo=function(t){var e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields)if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(var i in e.fields=e.fields||{},t.fields){var n=t.fields[i];e.fields[i]=e.fields[i]||{};var r=e.fields[i];T(n.domain)&&(r.domain=n.domain),T(n.type)&&(r.type=n.type)}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)},e.prototype.clearStateInfo=function(t){var e=this;t.forEach((function(t){e.getStateInfo(t)&&e.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})}))},e.prototype.checkOneState=function(t,e,i,n){var r;n=S(cK)?n:!t.mark||cK(t.mark.markType);var o=!1,a=!1;if(T(i.datums)&&i.datums.length>0)o=this.checkDatumState(i,e,n),a=!0;else if(i.items)o=null!==(r=this.checkItemsState(i,t))&&void 0!==r&&r,a=!0;else if(i.fields)o=this.checkFieldsState(i,e,t,n),a=!0;else if(!o&&i.filter){var s={mark:this._mark,renderNode:t,type:t.mark.markType};o=i.filter(e,s),a=!0}return a?o?"in":"out":"skip"},e.prototype.checkState=function(t,e){for(var i=t.getStates().filter((function(t){return function(t){return!!jY[t]}(t)})).map((function(t){return[t,10]})),n=!t.mark||cK(t.mark.markType),r=0;r<this._stateInfoList.length;r++){var o=this._stateInfoList[r],a=this.checkOneState(t,e,o,n);"skip"!==a&&("in"===a&&i.push([o.stateValue,o.level]))}return i.map((function(t){return t[0]}))},e.prototype.checkDatumState=function(t,e,i){var n=!1,r=i?e[0]:e;if(B(t.datums)){var o=t.datumKeys||Object.keys(t.datums[0]).filter((function(t){return!t.startsWith(bw)}));n=t.datums.some((function(t){return i&&B(null==t?void 0:t.items)?o.every((function(e){var i,n;return(null===(n=null===(i=null==t?void 0:t.items)||void 0===i?void 0:i[0])||void 0===n?void 0:n[e])===(null==r?void 0:r[e])})):o.every((function(e){return(null==t?void 0:t[e])===(null==r?void 0:r[e])}))}))}else if(M(t.datums)){var a=t.datumKeys||Object.keys(t.datums).filter((function(t){return!t.startsWith(bw)}));n=a.every((function(e){var n,o;return i?(null===(n=t.datums.items)||void 0===n?void 0:n[0][e])===r[e]:(null===(o=t.datums)||void 0===o?void 0:o[e])===r[e]}))}else n=e===t.datums;return n},e.prototype.checkItemsState=function(t,e){var i;return null===(i=t.items)||void 0===i?void 0:i.includes(e)},e.prototype.checkFieldsState=function(t,e,i,n){var r,o=!0,a=function(a){var l=t.fields[a],u=l.type,c=l.domain,h=n?null===(r=e[0])||void 0===r?void 0:r[a]:e[a];if(gS(u)&&c.length>1){if(s.checkLinearFieldState(c,a,e,i,n))return o=!1,"break";o=!0}else{if(!c.some((function(t){return t===h})))return o=!1,"break";o=!0}},s=this;for(var l in t.fields){if("break"===a(l))break}return o},e.prototype.checkLinearFieldState=function(t,e,i,n,r){var o,a=r?null===(o=i[0])||void 0===o?void 0:o[e]:i[e];return a<t[0]||a>t[t.length-1]},e.prototype.updateLayoutState=function(t){return this._stateMap.markUpdateRank++,this.updateState({markUpdateRank:this._stateMap.markUpdateRank},t)},e.prototype.compileState=function(t){var e=this;t.state({callback:function(t,i){return e.checkState(i,t)}})},e}(KY),dK=function(t){function e(e,i){var n=t.call(this,e)||this;return n.grammarType=AY.data,n._data=null,n._data=i,n}return r(e,t),e.prototype.getDataView=function(){return this._data},e.prototype.setDataView=function(t){this._data=t},e.prototype.getLatestData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.latestData},e.prototype.release=function(){t.prototype.release.call(this),this._data=null},e.prototype.updateData=function(t){var e=this.getProduct(),i=this.getLatestData();return e&&i&&(e.values(i),!t)?this.getCompiler().renderAsync():Promise.resolve()},e.prototype._compileProduct=function(){var t=this.getLatestData();w(t)||(w(this.getProduct())?this._initProduct(t):this._product.values(t))},e.prototype._initProduct=function(t){var e=this.getVGrammarView();if(e&&t){var i=this.getProductId();this._product=e.data(t).id(i),this._compiledProductId=i}},e.prototype.generateProductId=function(){var t;return"".concat(null===(t=this.getDataView())||void 0===t?void 0:t.name)},e.prototype._lookupGrammar=function(t){var e,i;return null===(i=null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getDataById)||void 0===i?void 0:i.call(e,t)},e}(WY),fK=function(t){function e(e){var i=t.call(this,e)||this;return i._mark=e.mark,i}return r(e,t),e.prototype.setCompiledProductId=function(t){this._compiledProductId=t},e.prototype.generateProductId=function(){var e=t.prototype.generateProductId.call(this);return T(e)?e:"".concat(bw,"_markData_").concat(this._mark.id)},e.prototype._compileProduct=function(){var t,e=null===(t=this._data)||void 0===t?void 0:t.latestData;w(e)||T(this.getProduct())||this._initProduct(e)},e}(dK),pK=function(e){function i(i,n,r){var a=e.call(this,i)||this;return a.grammarType=AY.mark,a.type=void 0,a.name="mark",a._interactive=!0,a._zIndex=t.LayoutZIndex.Mark,a._visible=!0,a.stateStyle={},a._unCompileChannel={},a._skipBeforeLayouted=!1,a._morph=!1,a.name=n,a.model=r,a.key=i.key,a.state=new hK(o(o({},i),{stateKeyToSignalName:a.stateKeyToSignalName.bind(a)}),a),a._option.support3d&&a.setSupport3d(!0),a._option.skipTheme&&a.setSkipTheme(!0),a._event=new sY(r.getOption().eventDispatcher,r.getOption().mode),a}return r(i,e),i.prototype.getSkipTheme=function(){return this._skipTheme},i.prototype.setSkipTheme=function(t){this._skipTheme=t},i.prototype.getSupport3d=function(){return this._support3d},i.prototype.setSupport3d=function(t){this._support3d=t},i.prototype.getFacet=function(){return this._facet},i.prototype.setFacet=function(t){this._facet=t},i.prototype.getInteractive=function(){return this._interactive},i.prototype.setInteractive=function(t){this._interactive=t},i.prototype.getZIndex=function(){return this._zIndex},i.prototype.setZIndex=function(t){this._zIndex=t},i.prototype.getVisible=function(){return this._visible},i.prototype.setVisible=function(t){this._visible=t},i.prototype.getUserId=function(){return this._userId},i.prototype.setUserId=function(t){T(t)&&(this._userId=t)},i.prototype.getDataView=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.setDataView=function(t,e){w(this._data)&&this.initMarkData(o(o({},this._option),{mark:this})),T(e)&&this._data.setCompiledProductId(e),this._data.setDataView(t)},i.prototype.getData=function(){return this._data},i.prototype.setData=function(t){this._data=t},i.prototype.hasState=function(t){return t in this.state.getStateMap()},i.prototype.getState=function(t){return this.state.getStateMap()[t]},i.prototype.getAnimationConfig=function(){return this._animationConfig},i.prototype.setAnimationConfig=function(t){this._animationConfig=t},i.prototype.setSkipBeforeLayouted=function(t){this._skipBeforeLayouted=t},i.prototype.getSkipBeforeLayouted=function(){return this._skipBeforeLayouted},i.prototype.getMorph=function(){return this._morph},i.prototype.setMorph=function(t){this._morph=t},i.prototype.getMorphKey=function(){return this._morphKey},i.prototype.setMorphKey=function(t){this._morphKey=t},i.prototype.getMorphElementKey=function(){return this._morphElementKey},i.prototype.setMorphElementKey=function(t){this._morphElementKey=t},i.prototype.getGroupKey=function(){return this._groupKey},i.prototype.setGroupKey=function(t){this._groupKey=t},i.prototype.getProgressiveConfig=function(){return this._progressiveConfig},i.prototype.setProgressiveConfig=function(t){this._progressiveConfig=t},i.prototype.setCustomizedShapeCallback=function(t){this._setCustomizedShape=t},i.prototype.setEnableSegments=function(t){this._enableSegments=t},i.prototype.setTransform=function(t){this._transform=t},i.prototype.initMarkData=function(t){this._data=new fK(t)},i.prototype.stateKeyToSignalName=function(t){return"".concat(bw,"_").concat(this.type,"_").concat(this.id,"_").concat(t)},i.prototype.getAttribute=function(t,e,i,n){},i.prototype._compileProduct=function(t){var e=this.getProduct();this.getVisible()?T(e)||this.getCompiler().isInited&&(this._initProduct(null==t?void 0:t.group),w(this._product)||(this.compileSignal(),this.compileData(),this.compileState(),this.compileEncode(),this.compileAnimation(),this.compileContext(),this.compileTransform())):T(e)&&this.removeProduct()},i.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(this.type,null!=t?t:e.rootMark).id(i),this._compiledProductId=i},i.prototype.generateProductId=function(){return this._userId?"".concat(this._userId):"".concat(this.name,"_").concat(this.id)},i.prototype.compileData=function(){var t;if(!w(this._data)){this._data.compile();var e=this._data.getProduct();T(this._product)&&T(e)&&this._product.join(e,this.key,void 0,null!==(t=this._groupKey)&&void 0!==t?t:this._facet)}},i.prototype.updateStaticEncode=function(){if(this._product){var t=this._separateStyle(),e=t.enterStyles,i=t.updateStyles;this._product.encodeState("group",e,!0),this._product.encode(i,!0)}},i.prototype._separateStyle=function(){var t=this,e=this.stateStyle,i=MY.STATE_NORMAL,n=e[i];a(e,["symbol"==typeof i?i:i+""]);var r=this._option.noSeparateStyle?null:{},o={};return Object.keys(n).forEach((function(e){t._unCompileChannel[e]||(t._option.noSeparateStyle||function(t,e,i){var n,r=null===(n=e[t])||void 0===n?void 0:n.style,o=function(t,e){return("fill"===t||"stroke"===t)&&(null==e?void 0:e.gradient)&&(null==e?void 0:e.stops)}(t,r);return!!o||!!A(r)||!(!(null==r?void 0:r.scale)||r.field===i)}(e,n,t.getFacet())?o[e]={callback:t.compileCommonAttributeCallback(e,"normal"),dependency:[t.stateKeyToSignalName("markUpdateRank")]}:r[e]=t.compileCommonAttributeCallback(e,"normal"))})),{enterStyles:r,updateStyles:o}},i.prototype.compileEncode=function(){var t=this,e=this.stateStyle,i=MY.STATE_NORMAL;e[i];var n=a(e,["symbol"==typeof i?i:i+""]),r=this._separateStyle(),o=r.enterStyles,s=r.updateStyles;this._product.encode(s,!0),this._product.encodeState("group",o,!0),Object.keys(n).forEach((function(e){var i={};Object.keys(n[e]).forEach((function(n){t._unCompileChannel[n]||(i[n]={callback:t.compileCommonAttributeCallback(n,e),dependency:[t.stateKeyToSignalName("markUpdateRank")]})})),t._product.encodeState(e,i,!0)})),this._skipBeforeLayouted&&this._product.layout({skipBeforeLayouted:this._skipBeforeLayouted})},i.prototype.compileState=function(){this.state.compileState(this._product)},i.prototype.compileAnimation=function(){var e,i,n=this;if(this._animationConfig){var r;if("component"===this.type)r=null===(e=this.model.animate)||void 0===e?void 0:e.getAnimationStateSignalName();else{var o=this.model.getRegion();r=null===(i=o.animate)||void 0===i?void 0:i.getAnimationStateSignalName()}this._product.animation(this._animationConfig),this._product.animationState({callback:function(t,e,i){var n;return null===(n=i[r])||void 0===n?void 0:n.callback(t,e)},dependency:r}),this._animationConfig.normal&&this._event.on(t.VGRAMMAR_HOOK_EVENT.ANIMATION_END,(function(t){var e=t.event;e.mark===n.getProduct()&&e.animationState===SY.appear&&n.runAnimationByState(SY.normal)}))}},i.prototype.compileContext=function(){var t={interactive:this.getInteractive(),zIndex:this.getZIndex(),context:{markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},skipTheme:this.getSkipTheme(),support3d:this.getSupport3d(),enableSegments:!!this._enableSegments};this._progressiveConfig&&(t.progressiveStep=this._progressiveConfig.progressiveStep,t.progressiveThreshold=this._progressiveConfig.progressiveThreshold,t.large=this._progressiveConfig.large,t.largeThreshold=this._progressiveConfig.largeThreshold),this._morph&&this._morphKey&&(t.morph=this._morph,t.morphKey=this._morphKey,t.morphElementKey=this._morphElementKey),this._setCustomizedShape&&(t.setCustomizedShape=this._setCustomizedShape),this._product.configure(t)},i.prototype.compileSignal=function(){this.state.compile()},i.prototype._computeAttribute=function(t,e){return function(t,e){}},i.prototype.compileCommonAttributeCallback=function(t,e){var i=this._computeAttribute(t,e),n={mark:null,parent:null,element:null};return function(t,e){return n.mark=e.mark,n.parent=e.mark.group,n.element=e,i(t,n)}},i.prototype.compileTransform=function(){var t;(null===(t=this._transform)||void 0===t?void 0:t.length)&&this.getProduct().transform(this._transform)},i.prototype._lookupGrammar=function(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getMarkById(t)},i.prototype.updateState=function(t,e){return this.state.updateState(t,e)},i.prototype.updateLayoutState=function(t,e){return e&&this.getMarks().length>0&&this.getMarks().forEach((function(t){return t.state.updateLayoutState(!0)})),this.state.updateLayoutState(t)},i.prototype.updateMarkState=function(t){var e=this;if(this._product){var i=this.state.getStateInfo(t);this._product.elements.forEach((function(n){"in"===e.state.checkOneState(n,n.getDatum(),i)?n.addState(t):n.removeState(t)}))}},i.prototype.getMarks=function(){return[]},i.prototype.runAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.runAnimationByState(t)},i.prototype.stopAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.stopAnimationByState(t)},i.prototype.pauseAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.pauseAnimationByState(t)},i.prototype.resumeAnimationByState=function(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.resumeAnimationByState(t)},i.prototype.release=function(){e.prototype.release.call(this),this.state.release()},i}(WY),vK=function(e){function i(t,i){var n,r=this;return(r=e.call(this,i,t,i.model)||this)._extensionChannel={},r._computeExChannel={},r._attributeContext=i.attributeContext,null===(n=i.map)||void 0===n||n.set(r.id,r),r}return r(i,e),i.prototype.created=function(){this._initStyle()},i.prototype.initStyleWithSpec=function(t,e){t&&(T(t.id)&&(this._userId=t.id),S(t.interactive)&&(this._interactive=t.interactive),T(t.zIndex)&&this.setZIndex(t.zIndex),S(t.visible)&&this.setVisible(t.visible),this._initSpecStyle(t,this.stateStyle,e))},i.prototype.convertAngleToRadian=function(t){if(I(t))return ge(t);if(t.scale){var e=t.scale.range();return t.scale.range(e.map(ge)),t}return"function"==typeof t?function(e,i,n,r){return ge(t(e,i,n,r))}:t},i.prototype.isUserLevel=function(e){return[t.AttributeLevel.User_Mark,t.AttributeLevel.User_Series,t.AttributeLevel.User_Chart].includes(e)},i.prototype.setStyle=function(t,e,i,n){var r=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),void 0===n&&(n=this.stateStyle),!w(t)){t=this._filterStyle(t,e,i,n),void 0===n[e]&&(n[e]={});var o=this.isUserLevel(i);Object.keys(t).forEach((function(a){var s=t[a];w(s)||(s=r._filterAttribute(a,s,e,i,o,n),r.setAttribute(a,s,e,i,n))}))}},i.prototype.getStyle=function(t,e){var i;return void 0===e&&(e="normal"),null===(i=this.stateStyle[e][t])||void 0===i?void 0:i.style},i.prototype._filterStyle=function(t,e,i,n){return void 0===n&&(n=this.stateStyle),t},i.prototype._filterAttribute=function(t,e,i,n,r,o){void 0===o&&(o=this.stateStyle);var a=this._styleConvert(e);return r&&"angle"===t&&(a=this.convertAngleToRadian(a)),a},i.prototype.setReferer=function(t,e,i,n){var r,a;if(void 0===n&&(n=this.stateStyle),t)if(e&&i){var s=null!==(a=n[i])&&void 0!==a?a:((r={})[e]={},r);n[i][e]=o(o({},s[e]),{referer:t})}else Object.entries(n).forEach((function(e){var i=c(e,2),r=i[0],o=i[1];Object.entries(o).forEach((function(e){var i=c(e,2),o=i[0];i[1],n[r][o].referer=t}))}))},i.prototype.setPostProcess=function(t,e,i){var n;void 0===i&&(i="normal"),(null===(n=this.stateStyle[i])||void 0===n?void 0:n[t])&&(this.stateStyle[i][t].postProcess=e)},i.prototype.getAttribute=function(t,e,i,n){return void 0===i&&(i="normal"),this._computeAttribute(t,i)(e,n)},i.prototype.setAttribute=function(t,e,i,n,r){var o;void 0===i&&(i="normal"),void 0===n&&(n=0),void 0===r&&(r=this.stateStyle),void 0===r[i]&&(r[i]={}),void 0===r[i][t]&&(r[i][t]={level:n,style:e,referer:void 0});var a=null===(o=r[i][t])||void 0===o?void 0:o.level;T(a)&&a<=n&&$W(r[i][t],{style:e,level:n}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach((function(t){void 0===r[i][t]&&(r[i][t]=r.normal[t])}))},i.prototype._getDefaultStyle=function(){return{visible:!0,x:0,y:0}},i.prototype._styleConvert=function(t){if(!t)return t;if(mS(t.type)||t.scale){var e=function(t,e){if("scale"in t&&t.scale)return P(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;var i=oW(t.type);return i&&function(t,e){t&&e&&(e.domain&&t.domain(e.domain),e.range&&t.range(e.range),e.specified&&t.specified&&t.specified(e.specified))}(i,t),i}(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t},i.prototype._computeAttribute=function(t,e){var i,n=this,r=null===(i=this.stateStyle[e])||void 0===i?void 0:i[t];r||(r=this.stateStyle.normal[t]);var o=this._computeStateAttribute(r,t,e),a=A(null==r?void 0:r.postProcess),s=t in this._computeExChannel;if(a&&s){var l=this._computeExChannel[t];return function(i,a){var s=o(i,a);return s=r.postProcess(s,i,n._attributeContext,a,n.getDataView()),l(t,i,e,a,s)}}if(a)return function(t,e){return r.postProcess(o(t,e),t,n._attributeContext,e,n.getDataView())};if(s){var u=this._computeExChannel[t];return function(i,n){return u(t,i,e,n,o(i,n))}}return o},i.prototype._computeStateAttribute=function(t,e,i){var n,r=this;return t?t.referer?t.referer._computeAttribute(e,i):"function"==typeof t.style?function(e,i){return t.style(e,r._attributeContext,i,r.getDataView())}:nG.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):mS(null===(n=t.style.scale)||void 0===n?void 0:n.type)?function(e,i){return t.style.scale.scale(e[t.style.field])}:function(e,i){return t.style}:function(t,e){}},i.prototype._initStyle=function(){var t=this._getDefaultStyle();this.setStyle(t,"normal",0)},i.prototype._initSpecStyle=function(e,i,n){var r=this;e.style&&this.setStyle(e.style,"normal",t.AttributeLevel.User_Mark,i);var a=e.state;a&&Object.keys(a).forEach((function(e){var n=a[e];if("style"in n){var s=n.style,l={stateValue:e};"level"in n&&(l.level=n.level),"filter"in n&&(l=A(n.filter)?o({filter:n.filter},l):o(o({},n.filter),l)),r.state.addStateInfo(l),r.setStyle(s,e,t.AttributeLevel.User_Mark,i)}else r.setStyle(n,e,t.AttributeLevel.User_Mark,i)}))},i.prototype._computeGradientAttr=function(t){var e,i,n=this,r=t.gradient,s=t.scale,l=t.field,u=a(t,["gradient","scale","field"]),c=s,h=l;if(!(s&&l||"series"!==this.model.modelType)){var d=this.model.getColorAttribute(),f=d.scale,p=d.field;s||(c=f),h||(h=p)}var v=qG(ZG(this.model.getColorScheme(),"series"===this.model.modelType?null===(i=(e=this.model).getSpec)||void 0===i?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),y=o(o({},sG[r]),u);return function(t,e){var i={},o=n.getDataView();return Object.keys(y).forEach((function(r){var a=y[r];"stops"===r?i.stops=a.map((function(i){var r=i.opacity,a=i.color,s=i.offset,l=null!=a?a:null==c?void 0:c.scale(t[h]);return A(a)&&(l=a(t,n._attributeContext,e,o)),T(r)&&(l=Ye.SetOpacity(l,r)),{offset:A(s)?s(t,n._attributeContext,e,o):s,color:l||v[0]}})):A(a)?i[r]=a(t,n._attributeContext,e,o):i[r]=a})),i.gradient=r,i}},i.prototype._computeBorderAttr=function(t){var e=this,i=t.scale,n=t.field,r=a(t,["scale","field"]);return function(t,o){var a,s,l,u={};if(Object.keys(r).forEach((function(i){var n=r[i];A(n)?u[i]=n(t,e._attributeContext,o,e.getDataView()):u[i]=n})),"stroke"in u)nG.includes(null===(l=r.stroke)||void 0===l?void 0:l.gradient)&&(u.stroke=e._computeGradientAttr(r.stroke)(t,o));else{var c=qG(ZG(e.model.getColorScheme(),"series"===e.model.modelType?null===(s=(a=e.model).getSpec)||void 0===s?void 0:s.call(a):void 0),e.model.getDefaultColorDomain()),h=i,d=n;if(!(i&&n||"series"!==e.model.modelType)){var f=e.model.getColorAttribute(),p=f.scale,v=f.field;i||(h=p),d||(d=v),u.stroke=(null==h?void 0:h.scale(t[d]))||c[0]}}return u}},i}(pK),yK=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._marks=[],i}return r(e,t),e.prototype.getMarks=function(){return this._marks},e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{clip:!1})},e.prototype.isMarkExist=function(t){return void 0!==this._marks.find((function(e){return e.id===t.id||e.name===t.name}))},e.prototype.addMark=function(t){return this.isMarkExist(t)?(Ea("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)},e.prototype.removeMark=function(t){var e=this._marks.findIndex((function(e){return e.id===t.id||e.name===t.name}));return-1===e?(Ea("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)},e.prototype.getMarkInType=function(t){return this._marks.filter((function(e){return e.type===t}))},e.prototype.getMarkInId=function(t){return this._marks.find((function(e){return e.id===t}))},e.prototype.getMarkInName=function(t){return this._marks.find((function(e){return e.name===t}))},e.prototype._compileProduct=function(e){var i=this;t.prototype._compileProduct.call(this,e),this._product.configure({zIndex:this.getZIndex()}),(null==e?void 0:e.ignoreChildren)||this.getMarks().forEach((function(t){t.getProduct()&&t.removeProduct(),t.compile({group:i._product})}))},e.type="group",e}(vK),gK=function(){jL(),xL(),gT.registerGraphic(sw.group,lf),FU.registerMark(yK.type,yK)},mK={type:"clipIn"},_K={type:"fadeIn"};function bK(t,e){switch(e){case"grow":return function(t){return{type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}}(t);case"fadeIn":return _K;default:return mK}}var xK={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"}},kK={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},SK={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},AK=function(){FU.registerAnimation("scaleInOut",(function(){return kK}))},wK=function(){FU.registerAnimation("fadeInOut",(function(){return SK}))},TK=function(){FU.registerAnimation("line",(function(t,e){return{appear:bK(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined"]}},{channel:["points"],custom:mh,duration:xK.update.duration,easing:xK.update.easing}],disappear:{type:"clipOut"}}}))},MK=function(){Zj.useRegisters([CN,EN,RN,PN,TN,MN])},CK=function(){Zj.useRegisters([HN,NN,zN,jN])},EK=function(){Zj.useRegisters([BN,LN,ON,IN,DN,FN,kN,SN])},RK=function(){Zj.useRegisters([BN,LN])},PK={measureText:function(t,e,i,n){return function(t,e,i){return TA(t,e,i,{fontFamily:gW,fontSize:mW})}(e,i,n).measure(t)}},BK=function(){function t(){this.functions={}}return t.instance=function(){return t.instance_||(t.instance_=new t),t.instance_},t.prototype.registerFunction=function(t,e){t&&e&&(this.functions[t]=e)},t.prototype.unregisterFunction=function(t){t&&delete this.functions[t]},t.prototype.getFunction=function(t){return this.functions[t]||null},t.prototype.getFunctionNameList=function(){return Object.keys(this.functions)},t}(),LK=function(){qM(_u)},OK=function(){pE(_u)},IK=function(){function t(){this.id=Jk(),this._plugins=[]}return t.prototype.add=function(t){var e=this;if(!t||0===t.length)return null;var i=[];return t.forEach((function(t){e._plugins.find((function(e){return e.id===t.id}))?Ea("不要重复添加相同的plugin"):(e._plugins.push(t),i.push(t),t.onAdd&&t.onAdd(e))})),i},t.prototype.load=function(t){var e=this.add(t);e&&e.length&&this.activate(t)},t.prototype.activate=function(t){t.length&&t.forEach((function(t){t.init&&t.init()}))},t.prototype.get=function(t){return this._plugins.find((function(e){return e.id===t}))},t.prototype.getAll=function(){return this._plugins.slice()},t.prototype.dispose=function(t){var e=this._plugins.find((function(e){return e.id===t}));e&&e.dispose&&e.dispose(this)},t.prototype.disposeAll=function(){var t=this;this._plugins.forEach((function(e){e.dispose&&e.dispose(t)}))},t}(),DK=function(t){function e(e){var i=t.call(this)||this;return i.globalInstance=e,i}return r(e,t),e.prototype.onInit=function(t){var e=this;this._plugins.forEach((function(i){i.onInit&&i.onInit(e,t)}))},e.prototype.onBeforeResize=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeResize&&n.onBeforeResize(i,t,e)}))},e.prototype.onAfterChartSpecTransform=function(t,e){var i=this;this._plugins.forEach((function(n){n.onAfterChartSpecTransform&&n.onAfterChartSpecTransform(i,t,e)}))},e.prototype.onBeforeInitChart=function(t,e){var i=this;this._plugins.forEach((function(n){n.onBeforeInitChart&&n.onBeforeInitChart(i,t,e)}))},e}(IK),FK=function(){function e(e,i){var n,r,s,l,u,c,h,d=this;this.id=Jk(),this._userEvents=[],this._autoSize=!0,this._option={mode:t.RenderModeEnum["desktop-browser"],onError:function(t){throw new Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._onResize=Pt((function(){d._doResize()}),100),this._option=Q(this._option,{animation:!1!==e.animation},i),this._onError=null===(n=this._option)||void 0===n?void 0:n.onError;var f=this._option,p=f.dom,v=f.renderCanvas,y=f.mode,g=f.stage,m=f.poptip,_=a(f,["dom","renderCanvas","mode","stage","poptip"]),b=Kk(y);b&&p&&(this._container=P(p)?null===document||void 0===document?void 0:document.getElementById(p):p),v&&(this._canvas=v),g&&(this._stage=g),"node"===y||this._container||this._canvas||this._stage?(b?LK():"node"===y&&OK(),this._viewBox=this._option.viewBox,this._currentThemeName=mU.getCurrentThemeName(),this._setNewSpec(e),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize(),this._compiler=new EY({dom:null!==(s=this._container)&&void 0!==s?s:"none",canvas:v},o(o({mode:this._option.mode,stage:g,pluginList:!1!==m?["poptipForText"]:[]},_),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new cY(this,this._compiler),this._event=new sY(this._eventDispatcher,y),this._compiler.initView(),null===(l=this.getStage())||void 0===l||l.setTheme({text:{fontFamily:null===(u=this._currentTheme)||void 0===u?void 0:u.fontFamily}}),this._initDataSet(this._option.dataSet),this._autoSize=!!b&&(null===(h=null!==(c=e.autoFit)&&void 0!==c?c:this._option.autoFit)||void 0===h||h),this._bindResizeEvent(),this._bindVGrammarViewEvent(),this._initChartPlugin(),gU.registerInstance(this)):null===(r=this._option)||void 0===r||r.onError("please specify container or renderCanvas!")}return e.useRegisters=function(t){t.forEach((function(t){"function"==typeof t?t():console.error("Invalid function:",t)}))},e.useChart=function(t){t.forEach((function(t){return FU.registerChart(t.type,t)}))},e.useSeries=function(t){t.forEach((function(t){return FU.registerSeries(t.type,t)}))},e.useComponent=function(t){t.forEach((function(t){return FU.registerComponent(t.type,t)}))},e.useMark=function(t){t.forEach((function(t){var e;return FU.registerMark(null!==(e=t.constructorType)&&void 0!==e?e:t.type,t)}))},e.useLayout=function(t){t.forEach((function(t){return FU.registerLayout(t.type,t)}))},e.registerDataSetTransform=function(t,e){FU.registerTransform(t,e)},e.registerFunction=function(t,e){t&&e&&BK.instance().registerFunction(t,e)},e.unregisterFunction=function(t){t&&BK.instance().unregisterFunction(t)},e.getFunction=function(t){return t?BK.instance().getFunction(t):null},e.getFunctionList=function(){return BK.instance().getFunctionNameList()},e.registerMap=function(t,e,i){var n=FU.getImplementInKey("registerMap");n&&n(t,e,i)},e.unregisterMap=function(t){var e=FU.getImplementInKey("unregisterMap");e&&e(t)},e.getMap=function(t){return e=t,pY.get(e);var e},e.hideTooltip=function(t){void 0===t&&(t=[]),gU.forEach((function(t){var e;return null===(e=null==t?void 0:t.hideTooltip)||void 0===e?void 0:e.call(t)}),t)},e.getLogger=function(){return gi.getInstance()},e.prototype.getSpec=function(){return this._spec},e.prototype.getSpecInfo=function(){return this._specInfo},e.prototype.getDataSet=function(){return this._dataSet},e.prototype._setNewSpec=function(t,e){return!!t&&(P(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=$W({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)},e.prototype._getSpecFromOriginalSpec=function(){var t,e=xU(this._originalSpec);return e.data=null!==(t=e.data)&&void 0!==t?t:[],e},e.prototype._initChartSpec=function(t,i){var n,r=this;e.getFunctionList()&&e.getFunctionList().length&&(t=kU(t,e)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=FU.createChartSpecTransformer(this._spec.type,{type:this._spec.type,getTheme:function(){var t;return null!==(t=r._currentTheme)&&void 0!==t?t:{}},animation:this._option.animation})),this._chartSpecTransformer.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,i),this._specInfo=null===(n=this._chartSpecTransformer)||void 0===n?void 0:n.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,i)},e.prototype._updateSpecInfo=function(){var t,e=this;this._chartSpecTransformer||(this._chartSpecTransformer=FU.createChartSpecTransformer(this._spec.type,{type:this._spec.type,getTheme:function(){var t;return null!==(t=e._currentTheme)&&void 0!==t?t:{}}})),this._specInfo=null===(t=this._chartSpecTransformer)||void 0===t?void 0:t.createSpecInfo(this._spec)},e.prototype._initChart=function(e){var i,n,r=this;if(this._compiler){var o=FU.createChart(e.type,e,{type:e.type,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._option.mode||t.RenderModeEnum["desktop-browser"],modeParams:this._option.modeParams,getCompiler:function(){return r._compiler},performanceHook:this._option.performanceHook,viewBox:this._viewBox,animation:this._option.animation,getTheme:function(){var t;return null!==(t=r._currentTheme)&&void 0!==t?t:{}},getSpecInfo:function(){var t;return null!==(t=r._specInfo)&&void 0!==t?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent});o?(this._chart=o,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(),this._chart.init(),this._event.emit(t.ChartEvent.initialized,{})):null===(n=this._option)||void 0===n||n.onError("init chart fail")}else null===(i=this._option)||void 0===i||i.onError("compiler is not initialized")},e.prototype._releaseData=function(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)},e.prototype._bindVGrammarViewEvent=function(){var e=this;this._compiler&&!this._compiler.isReleased&&(this._compiler.getVGrammarView().addEventListener(t.VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_END,(function(){e._event.emit(t.ChartEvent.animationFinished,{})})),this._compiler.getVGrammarView().addEventListener(t.VGRAMMAR_HOOK_EVENT.AFTER_VRENDER_NEXT_RENDER,(function(){e._event.emit(t.ChartEvent.renderFinished,{})})))},e.prototype._bindResizeEvent=function(){var t;if(this._autoSize){if(this._container){var e=window.ResizeObserver;this._observer=new e(this._onResize),null===(t=this._observer)||void 0===t||t.observe(this._container)}window.addEventListener("resize",this._onResize)}},e.prototype._unBindResizeEvent=function(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))},e.prototype.getCurrentSize=function(){var e,i,n,r;return LY(this._spec,{container:this._container,canvas:this._canvas,mode:this._option.mode||t.RenderModeEnum["desktop-browser"],modeParams:this._option.modeParams},{width:null!==(i=null===(e=this._currentSize)||void 0===e?void 0:e.width)&&void 0!==i?i:xw,height:null!==(r=null===(n=this._currentSize)||void 0===n?void 0:n.height)&&void 0!==r?r:kw})},e.prototype._doResize=function(){var t=this.getCurrentSize(),e=t.width,i=t.height;this._currentSize.width===e&&this._currentSize.height===i||(this._currentSize={width:e,height:i},this.resize(e,i))},e.prototype._initDataSet=function(t){for(var e in this._dataSet=t instanceof wa?t:new wa,dY(this._dataSet,"dataview",ka),dY(this._dataSet,"array",p),hY(this._dataSet,"stackSplit",wY),hY(this._dataSet,"copyDataView",_Y),FU.transforms)hY(this._dataSet,e,FU.transforms[e]);for(var e in FU.dataParser)dY(this._dataSet,e,FU.dataParser[e])},e.prototype.updateCustomConfigAndRerender=function(t,e,i){if(void 0===i&&(i={}),!this._isReleased&&t)return A(t)&&(t=t()),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)},e.prototype._updateCustomConfigAndRecompile=function(t,e){return void 0===e&&(e={}),!!t&&(this._reCompile(t),this._beforeRender(e))},e.prototype._reCompile=function(t,e){var i,n,r,o,a,s,l,u=this;if(t.reMake)this._releaseData(),this._initDataSet(),this._chartSpecTransformer=null,this._chart.release(),this._chart=null,null===(i=this._compiler)||void 0===i||i.releaseGrammar(!1===(null===(n=this._option)||void 0===n?void 0:n.animation)||!1===(null===(r=this._spec)||void 0===r?void 0:r.animation)),this._userEvents.forEach((function(t){var e;return null===(e=u._event)||void 0===e?void 0:e.on(t.eType,t.query,t.handler)})),t.reSize&&this._doResize();else if(t.reCompile&&(null===(o=this._compiler)||void 0===o||o.clear({chart:this._chart,vChart:this},!this._option.animation||!this._spec.animation),null===(a=this._compiler)||void 0===a||a.compile({chart:this._chart,vChart:this},{})),t.reSize){var c=this.getCurrentSize(),h=c.width,d=c.height;this._chart.onResize(h,d,!1),null===(l=(s=this._compiler).resize)||void 0===l||l.call(s,h,d,!1)}},e.prototype._beforeRender=function(t){var e,i,n,r,o,a,s,l;if(void 0===t&&(t={}),this._isReleased)return!1;if(this._chart)return!0;var u=t.transformSpec,c=t.actionSource;return u&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,c),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeInitializeChart)||void 0===i||i.call(e),this._initChart(this._spec),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterInitializeChart)||void 0===r||r.call(n),!(!this._chart||!this._compiler)&&(null===(a=null===(o=this._option.performanceHook)||void 0===o?void 0:o.beforeCompileToVGrammar)||void 0===a||a.call(o),this._compiler.compile({chart:this._chart,vChart:this},{performanceHook:this._option.performanceHook}),null===(l=null===(s=this._option.performanceHook)||void 0===s?void 0:s.afterCompileToVGrammar)||void 0===l||l.call(s),!0)},e.prototype._afterRender=function(){return!this._isReleased&&(this._updateAnimateState(),this._event.emit(t.ChartEvent.rendered,{}),!0)},e.prototype.renderSync=function(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})},e.prototype.renderAsync=function(t){return s(this,void 0,void 0,(function(){return l(this,(function(e){return[2,this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})]}))}))},e.prototype._renderSync=function(t){var e;void 0===t&&(t={});return this._beforeRender(t)?(null===(e=this._compiler)||void 0===e||e.renderSync(t.morphConfig),this._afterRender(),this):this},e.prototype._renderAsync=function(t){var e;return void 0===t&&(t={}),s(this,void 0,void 0,(function(){var i;return l(this,(function(n){switch(n.label){case 0:return i=this,this._beforeRender(t)?[4,null===(e=this._compiler)||void 0===e?void 0:e.renderAsync(t.morphConfig)]:[2,i];case 1:return n.sent(),this._afterRender(),[2,i]}}))}))},e.prototype._updateAnimateState=function(){var t,e;this._option.animation&&(null===(t=this._chart)||void 0===t||t.getAllRegions().forEach((function(t){var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(SY.update,!0)})),null===(e=this._chart)||void 0===e||e.getAllComponents().forEach((function(t){var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(SY.update,!0)})))},e.prototype.release=function(){var t,e,i,n;(null===(t=this._onResize)||void 0===t?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("disposeAll"),this._chartSpecTransformer=null,null===(e=this._chart)||void 0===e||e.release(),null===(i=this._compiler)||void 0===i||i.release(),null===(n=this._eventDispatcher)||void 0===n||n.release(),this._unBindResizeEvent(),this._releaseData(),this._chart=null,this._compiler=null,this._spec=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,gU.unregisterInstance(this)},e.prototype.updateData=function(t,e,i){return s(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return w(this._dataSet)?[2,this]:this._chart?(this._chart.updateData(t,e,!0,i),[4,this._compiler.renderAsync()]):[3,2];case 1:return r.sent(),[2,this];case 2:return this._spec.data=lt(this._spec.data),(n=this._spec.data.find((function(e){return e.name===t||e.id===t})))?n.id===t?n.values=e:n.name===t&&n.parse(e,i):B(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e),[2,this]}}))}))},e.prototype.updateDataInBatches=function(t){return s(this,void 0,void 0,(function(){var e=this;return l(this,(function(i){switch(i.label){case 0:return this._chart?(this._chart.updateFullData(t.map((function(t){return{id:t.id,values:t.data,parser:t.options}}))),this._chart.updateGlobalScaleDomain(),[4,this._compiler.renderAsync()]):[3,2];case 1:return i.sent(),[2,this];case 2:return t.forEach((function(t){var i=t.id,n=t.data,r=t.options,o=e._spec.data.find((function(t){return t.name===i}));if(o)o.parse(n,r);else{var a=new Ma(e._dataSet,{name:i});a.parse(n,r),e._spec.data.push(a)}})),[2,this]}}))}))},e.prototype.updateDataSync=function(t,e,i){if(w(this._dataSet))return this;if(this._chart)return this._chart.updateData(t,e,!0,i),this._compiler.renderSync(),this;var n=this._spec.data.find((function(e){return e.name===t}));if(n)n.parse(e,i);else{var r=new Ma(this._dataSet,{name:t});r.parse(e,i),this._spec.data.push(r)}return this},e.prototype.updateFullDataSync=function(t,e){var i=this;return void 0===e&&(e=!0),this._chart?(this._chart.updateFullData(t),e&&this._compiler.renderSync(),this):(lt(t).forEach((function(t){var e,n=t.id,r=t.values,o=t.parser,a=t.fields,s=i._spec.data.find((function(t){return t.name===n}));if(s)s.setFields(X(a)),s.parse(r,X(o));else{var l=xY(t,i._dataSet,i._spec.data,{onError:null===(e=i._option)||void 0===e?void 0:e.onError});i._spec.data.push(l)}})),this)},e.prototype.updateFullData=function(t,e){return void 0===e&&(e=!0),s(this,void 0,void 0,(function(){var i=this;return l(this,(function(n){switch(n.label){case 0:return this._chart?(this._chart.updateFullData(t),e?[4,this._compiler.renderAsync()]:[3,2]):[3,3];case 1:n.sent(),n.label=2;case 2:return[2,this];case 3:return lt(t).forEach((function(t){var e,n=t.id,r=t.values,o=t.parser,a=t.fields,s=i._spec.data.find((function(t){return t.name===n}));if(s)s.setFields(X(a)),s.parse(r,X(o));else{var l=xY(t,i._dataSet,i._spec.data,{onError:null===(e=i._option)||void 0===e?void 0:e.onError});i._spec.data.push(l)}})),[2,this]}}))}))},e.prototype.updateSpec=function(t,e,i){return void 0===e&&(e=!1),s(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return n=this._updateSpec(t,e),[4,this.updateCustomConfigAndRerender(n,!1,{morphConfig:i,transformSpec:!0,actionSource:"updateSpec"})];case 1:return r.sent(),[2,this]}}))}))},e.prototype.updateSpecSync=function(t,e,i){void 0===e&&(e=!1);var n=this._updateSpec(t,e);return this.updateCustomConfigAndRerender(n,!0,{morphConfig:i,transformSpec:!0,actionSource:"updateSpec"}),this},e.prototype.updateSpecAndRecompile=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i={});var n=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(n,o({actionSource:"updateSpecAndRecompile"},i))},e.prototype._updateSpec=function(t,e){var i,n;void 0===e&&(e=!1);var r=this._spec;if(this._setNewSpec(t,e)){nt(r.theme,this._spec.theme)||this._setCurrentTheme();var o=this._shouldChartResize(r);return null===(n=null===(i=this._compiler)||void 0===i?void 0:i.getVGrammarView())||void 0===n||n.updateLayoutTag(),OY(this._chart.updateSpec(this._spec),{change:o,reMake:!1,reCompile:!1,reSize:o})}},e.prototype.updateModelSpec=function(t,e,i,n){return void 0===i&&(i=!1),s(this,void 0,void 0,(function(){var r;return l(this,(function(o){return e&&this._spec?(P(e)&&(e=JSON.parse(e)),A(t)||tU(this._spec,t,e,i),this._chart&&(r=this._chart.getModelInFilter(t))?[2,this._updateModelSpec(r,e,!1,i,n)]:[2,this]):[2,this]}))}))},e.prototype.updateModelSpecSync=function(t,e,i,n){if(void 0===i&&(i=!1),!e||!this._spec)return this;if(P(e)&&(e=JSON.parse(e)),A(t)||tU(this._spec,t,e,i),this._chart){var r=this._chart.getModelInFilter(t);if(r)return this._updateModelSpec(r,e,!0,i,n)}return this},e.prototype._updateModelSpec=function(t,e,i,n,r){void 0===i&&(i=!1),void 0===n&&(n=!1),n&&(e=$W({},t.getSpec(),e));var o=t.updateSpec(e);return t.reInit(e),(o.change||o.reCompile||o.reMake||o.reSize||o.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(o,i,{morphConfig:r,transformSpec:!1,actionSource:"updateModelSpec"})},e.prototype.resize=function(e,i){var n,r,o,a,u,c;return s(this,void 0,void 0,(function(){var s;return l(this,(function(l){switch(l.label){case 0:return this._chart&&this._compiler?(s=this._chart.getCanvasRect())&&s.width===e&&s.height===i?[2,this]:(this._chartPluginApply("onBeforeResize",e,i),null===(r=null===(n=this._option.performanceHook)||void 0===n?void 0:n.beforeResizeWithUpdate)||void 0===r||r.call(n),this._chart.onResize(e,i,!1),null===(a=null===(o=this._option.performanceHook)||void 0===o?void 0:o.afterResizeWithUpdate)||void 0===a||a.call(o),[4,null===(c=(u=this._compiler).resize)||void 0===c?void 0:c.call(u,e,i)]):[2,this];case 1:return l.sent(),this._isReleased?[2,this]:(this._event.emit(t.ChartEvent.afterResize,{chart:this._chart}),[2,this])}}))}))},e.prototype.updateViewBox=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),this._chart&&this._compiler?(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.renderSync(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e),this):this},e.prototype.on=function(t,e,i){var n;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null===(n=this._event)||void 0===n||n.on(t,e,i))},e.prototype.off=function(t,e){var i,n=this;if(this._userEvents&&0!==this._userEvents.length)if(e){var r=this._userEvents.findIndex((function(i){return i.eType===t&&i.handler===e}));r>=0&&(this._userEvents.splice(r,1),null===(i=this._event)||void 0===i||i.off(t,e))}else this._userEvents.forEach((function(e){var i;e.eType===t&&(null===(i=n._event)||void 0===i||i.off(t,e.handler))})),this._userEvents=this._userEvents.filter((function(e){return e.eType!==t}))},e.prototype.updateState=function(t,e){this._chart&&this._chart.updateState(t,e)},e.prototype.setSelected=function(t,e,i){this._chart&&this._chart.setSelected(t,e,i)},e.prototype.setHovered=function(t,e,i){this._chart&&this._chart.setHovered(t,e,i)},e.prototype._updateCurrentTheme=function(t){var e,i,n,r=this._option.theme,o=null===(e=this._spec)||void 0===e?void 0:e.theme;if(t&&(this._currentThemeName=t),W(r)&&W(o))this._currentTheme=_U(this._currentThemeName,!0);else if(P(r)&&(!o||P(o))||P(o)&&(!r||P(r))){var a=eU({},_U(this._currentThemeName,!0),_U(r,!0),_U(o,!0));this._currentTheme=a}else{a=eU({},_U(this._currentThemeName),_U(r),_U(o));this._currentTheme=aU(a,a.colorScheme)}n=U(this._currentTheme,"component.poptip"),Q(mO.poptip,gO,n),null===(i=this._compiler)||void 0===i||i.setBackground(this._getBackground())},e.prototype._shouldChartResize=function(t){var e,i,n=!1;w(this._spec.width)?this._spec.width=t.width:this._spec.width!==t.width&&(n=!0),w(this._spec.height)?this._spec.height=t.height:this._spec.height!==t.height&&(n=!0);var r=this._autoSize;return this._autoSize=!!Kk(this._option.mode)&&(null===(i=null!==(e=this._spec.autoFit)&&void 0!==e?e:this._option.autoFit)||void 0===i||i),this._autoSize!==r&&(n=!0),n},e.prototype._getBackground=function(){return("string"==typeof this._spec.background?this._spec.background:null)||this._currentTheme.background||this._option.background},e.prototype.getCurrentTheme=function(){return _U(this._currentThemeName)},e.prototype.getCurrentThemeName=function(){return this._currentThemeName},e.prototype.setCurrentTheme=function(t){return s(this,void 0,void 0,(function(){var e;return l(this,(function(i){switch(i.label){case 0:return mU.themeExist(t)?(e=this._setCurrentTheme(t),[4,this.updateCustomConfigAndRerender(e,!1,{transformSpec:!1,actionSource:"setCurrentTheme"})]):[2,this];case 1:return i.sent(),[2,this]}}))}))},e.prototype.setCurrentThemeSync=function(t){if(!mU.themeExist(t))return this;var e=this._setCurrentTheme(t);return this.updateCustomConfigAndRerender(e,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this},e.prototype._setCurrentTheme=function(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null===(e=this._chart)||void 0===e||e.setCurrentTheme(),{change:!0,reMake:!1}},e.prototype._getTooltipComponent=function(){var t,e=null===(t=this._chart)||void 0===t?void 0:t.getAllComponents().find((function(t){return t.type===f.tooltip}));return e},e.prototype.setTooltipHandler=function(t){var e,i;this._context.tooltipHandler=t;var n=this._getTooltipComponent();n&&(null===(i=null===(e=n.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),n.tooltipHandler=t)},e.prototype.getTooltipHandlerByUser=function(){var t;return null===(t=this._context)||void 0===t?void 0:t.tooltipHandler},e.prototype.getTooltipHandler=function(){var t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler},e.prototype.showTooltip=function(t,e){var i,n=this._getTooltipComponent();return null!==(i=T(t)&&"none"!==(null==n?void 0:n.showTooltip(t,e)))&&void 0!==i&&i},e.prototype.hideTooltip=function(){var t,e=this._getTooltipComponent();return null!==(t=null==e?void 0:e.hideTooltip())&&void 0!==t&&t},e.prototype.getLegendDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]},e.prototype.getLegendDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getAllComponents().filter((function(t){return t.type===f.discreteLegend}));return i[t]?i[t].getLegendData():[]},e.prototype.getLegendSelectedDataById=function(t){var e,i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]},e.prototype.getLegendSelectedDataByIndex=function(t){var e;void 0===t&&(t=0);var i=null===(e=this._chart)||void 0===e?void 0:e.getAllComponents().filter((function(t){return t.type===f.discreteLegend}));return i[t]?i[t].getSelectedData():[]},e.prototype.setLegendSelectedDataById=function(t,e){var i,n=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);n&&n.setSelectedData(e)},e.prototype.setLegendSelectedDataByIndex=function(t,e){var i;void 0===t&&(t=0);var n=null===(i=this._chart)||void 0===i?void 0:i.getAllComponents().filter((function(t){return t.type===f.discreteLegend}));n[t]&&n[t].setSelectedData(e)},e.prototype.getDataURL=function(){var t;return s(this,void 0,void 0,(function(){var e;return l(this,(function(i){switch(i.label){case 0:return e=this.getStage(),this._chart&&e?(e.render(),[4,PY(this._chart.getCanvas(),{onError:this._onError})]):[3,2];case 1:return[2,i.sent()];case 2:return null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined")),[2,null]}}))}))},e.prototype.exportImg=function(t){var e,i;return s(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return Kk(this._option.mode)?[4,this.getDataURL()]:(null===(e=this._option)||void 0===e||e.onError(new TypeError("non-browser environment can not export img")),[2]);case 1:return(n=r.sent())?function(t,e){void 0===t&&(t="vchart");var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download","".concat(t,".png")),i.dispatchEvent(new MouseEvent("click"))}(t,n):null===(i=this._option)||void 0===i||i.onError(new ReferenceError("render is not defined")),[2]}}))}))},e.prototype.exportCanvas=function(){var t,e=this.getStage();if(this._chart&&e)return e.toCanvas();null===(t=this._option)||void 0===t||t.onError(new ReferenceError("render is not defined"))},e.prototype.getImageBuffer=function(){var t,e;if("node"===this._option.mode){var i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null===(e=this._option)||void 0===e||e.onError(new ReferenceError("render is not defined")),null)}null===(t=this._option)||void 0===t||t.onError(new TypeError("getImageBuffer() now only support node environment."))},e.prototype.setLayout=function(t){var e;this._option.layout=t,null===(e=this._chart)||void 0===e||e.setLayout(t)},e.prototype.reLayout=function(){var t;null===(t=this._chart)||void 0===t||t.setLayoutTag(!0)},e.prototype.getCompiler=function(){return this._compiler},e.prototype.getChart=function(){return this._chart},e.prototype.getStage=function(){return this._compiler.getStage()},e.prototype.getCanvas=function(){var t;return null===(t=this._compiler)||void 0===t?void 0:t.getCanvas()},e.prototype.getContainer=function(){var t,e;return T(this._container)?this._container:(e=P(this._canvas)?null===document||void 0===document?void 0:document.getElementById(this._canvas):this._canvas,T(e)?e.parentElement:null===(t=this.getCanvas())||void 0===t?void 0:t.parentElement)},e.prototype.getComponents=function(){return this._chart.getAllComponents()},e.prototype.setDimensionIndex=function(t,e){var i;return void 0===e&&(e={}),null===(i=this._chart)||void 0===i?void 0:i.setDimensionIndex(t,e)},e.prototype.stopAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.stop()},e.prototype.pauseAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.pause()},e.prototype.resumeAnimation=function(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.resume()},e.prototype.convertDatumToPosition=function(t,e,i){var n;if(void 0===e&&(e={}),void 0===i&&(i=!1),!this._chart)return null;if(W(t))return null;var r,o=e.seriesId,a=e.seriesIndex,s=void 0===a?0:a;if(T(o)?r=this._chart.getSeriesInUserId(o):T(s)&&(r=null===(n=this._chart.getSeriesInIndex([s]))||void 0===n?void 0:n[0]),r){var l=Object.keys(t),u=r.getViewData().latestData.find((function(e){return l.every((function(i){return e[i]==t[i]}))})),c=r.getRegion().getLayoutStartPoint();return fW(u?r.dataToPosition(u):r.dataToPosition(t),c,i)}return null},e.prototype.convertValueToPosition=function(t,e,i){var n,r;if(void 0===i&&(i=!1),!this._chart||w(t)||W(e))return null;if(!B(t)){var o=e,a=o.axisId,s=o.axisIndex,l=void 0;if(T(a)?l=this._chart.getComponentsByKey("axes").find((function(t){return t.userId===a})):T(s)&&(l=null===(n=this._chart.getComponentsByKey("axes"))||void 0===n?void 0:n[s]),!l)return Ea("Please check whether the `axisId` or `axisIndex` is set!"),null;var u=null==l?void 0:l.valueToPosition(t);if(i){var c=l.getLayoutStartPoint(),h=l.getOrient();return u+("bottom"===h||"top"===h?c.x:c.y)}return u}var d,f=e,p=f.seriesId,v=f.seriesIndex;return T(p)?d=this._chart.getSeriesInUserId(p):T(v)&&(d=null===(r=this._chart.getSeriesInIndex([v]))||void 0===r?void 0:r[0]),d?fW(d.valueToPosition(t[0],t[1]),d.getRegion().getLayoutStartPoint(),i):(Ea("Please check whether the `seriesId` or `seriesIndex` is set!"),null)},e.prototype.getFunction=function(t){return BK.instance().getFunction(t)},e.prototype.registerFunction=function(t,e){t&&e&&BK.instance().registerFunction(t,e)},e.prototype.unregisterFunction=function(t){t&&BK.instance().unregisterFunction(t)},e.prototype.getFunctionList=function(){return BK.instance().getFunctionNameList()},e.prototype.setRuntimeSpec=function(t){this._spec=t,this._updateSpecInfo()},e.prototype._initChartPlugin=function(){var t=FU.getChartPlugins();t.length>0&&(this._chartPlugin=new DK(this),this._chartPlugin.load(t.map((function(t){return new t}))),this._chartPluginApply("onInit",this._spec))},e.prototype._chartPluginApply=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)},e.InstanceManager=gU,e.ThemeManager=mU,e.globalConfig={uniqueTooltip:!0},e.Utils=PK,e}();FU.registerRegion("region",tK),FU.registerLayout("base",lK),gK(),Zj.useRegisters([VH,GH]),Zj.useRegisters([WN,UN,AN,wN,VN,GN,YN,KN,XN]),dU(ZW.name,ZW),gi.getInstance(pi.Error);var zK=function(t,e,i,n,r,a){void 0===t&&(t="chart");var s=jK(t,r,a);return o(o({},s),{modelInfo:s.modelInfo.filter((function(t){return!!w(e)||lt(e).some((function(e){return A(e)?e(t,i,n):WA(t.spec,e)}))}))})},jK=function(e,i,n){var r,a,s,l,u,c,h,d,p;void 0===e&&(e="chart");var v={modelInfo:[]};if("chart"===e)v.isChart=!0,v.modelInfo.push({spec:i,type:"chart"});else if("region"===e)v.modelType="region",v.specKey="region",null===(r=i.region)||void 0===r||r.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["region",e],specIndex:e,type:"region"})}));else if("series"===e)v.modelType="series",v.specKey="series",null===(a=i.series)||void 0===a||a.forEach((function(t,e){v.modelInfo.push({spec:t,specPath:["series",e],specIndex:e,type:t.type})}));else if(Object.values(t.SeriesTypeEnum).includes(e))v.modelType="series",v.specKey="series",v.type=e,null===(s=i.series)||void 0===s||s.forEach((function(t,i){t.type===e&&v.modelInfo.push({spec:t,specPath:["series",i],specIndex:i,type:e})}));else if(Object.values(f).includes(e)){v.modelType="component",v.type=e,v.specKey=null===(l=FU.getComponentInKey(e))||void 0===l?void 0:l.specKey;var y=lt(null!==(u=n[m=v.specKey])&&void 0!==u?u:[]);null===(h=lt(null!==(c=i[m])&&void 0!==c?c:[]))||void 0===h||h.forEach((function(t,i){var n=y[i];n.type===e&&v.modelInfo.push(o(o({},n),{spec:t}))}))}else{var g=FU.getComponents().filter((function(t){return t.cmp.specKey===e})).map((function(t){return t.cmp.type}));if(g.length>0){v.modelType="component";var m=e;v.specKey=m;var _=lt(null!==(d=n[m])&&void 0!==d?d:[]);lt(null!==(p=i[m])&&void 0!==p?p:[]).forEach((function(t,e){var i=_[e];g.includes(i.type)&&v.modelInfo.push(o(o({},i),{spec:t}))}))}}return v},HK=function(){function t(t){this.id=Jk(),this.name="".concat(t,"_").concat(this.id)}return t.prototype.onAdd=function(t){this.service=t},t}(),NK=function(t){FU.registerChartPlugin(t.type,t)},VK=function(t){function e(){var i=t.call(this,e.type)||this;return i.type="MediaQueryPlugin",i._currentMediaInfo={},i.currentActiveItems=new Set,i._initialized=!1,i}return r(e,t),e.prototype.onInit=function(t,i){if(null==i?void 0:i[e.specKey]){var n=t.globalInstance;this._option={globalInstance:t.globalInstance,updateSpec:function(t,e,i){i?n.updateSpecSync(t):e?n.updateSpecAndRecompile(t,!1,{transformSpec:!0}):n.setRuntimeSpec(t)}},this._spec=i[e.specKey],this._initialized=!0}},e.prototype.onBeforeResize=function(t,e,i){this._initialized&&this._changeSize(e,i,!0,!1)},e.prototype.onAfterChartSpecTransform=function(t,e,i){this._initialized&&"setCurrentTheme"===i&&this._reInit(!1,!1)},e.prototype.onBeforeInitChart=function(t,e,i){if(this._initialized){var n,r;switch(i){case"render":case"updateModelSpec":n=!1,r=!0;break;case"updateSpec":case"setCurrentTheme":n=!0,r=!1;break;case"updateSpecAndRecompile":n=!1,r=!1}if(n&&this.dispose(),this._initialized||this.onInit(t,e),n||r){var o=this._option.globalInstance.getCurrentSize(),a=o.width,s=o.height;this._changeSize(a,s,!1,!1)}}},e.prototype._changeSize=function(t,e,i,n){return(this._currentMediaInfo.width!==t||this._currentMediaInfo.height!==e)&&(this._currentMediaInfo.width=t,this._currentMediaInfo.height=e,this._applyQueries(i,n))},e.prototype._applyQueries=function(t,i){var n,r,o=this,a=[],s=[];if(this._spec.forEach((function(t){var e=o._check(t),i=e.hasChanged,n=e.isActive;i&&(n?a.push(t):s.push(t))})),!a.length&&!s.length)return!1;this._baseChartSpec||(this._baseChartSpec=bU(this._option.globalInstance.getSpec(),["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo());var l=!1;return s.length>0?(n=bU(this._baseChartSpec,["data",e.specKey]),r=this._baseChartSpecInfo,Array.from(this.currentActiveItems).forEach((function(t){if(s.includes(t))o.currentActiveItems.delete(t);else{var e=o._apply(t,n,r);n=e.chartSpec}})),l=!0):(n=this._option.globalInstance.getSpec(),r=this._option.globalInstance.getSpecInfo()),a.forEach((function(t){o.currentActiveItems.add(t);var e=o._apply(t,n,r);n=e.chartSpec,l||(l=e.hasChanged)})),l&&this._option.updateSpec(n,t,i),!0},e.prototype._check=function(t){var e=this._option.globalInstance,i=function(t,e,i){for(var n in t)switch(n){case"maxHeight":if(T(t.maxHeight)&&e.height>t.maxHeight)return!1;break;case"minHeight":if(T(t.minHeight)&&e.height<t.minHeight)return!1;break;case"maxWidth":if(T(t.maxWidth)&&e.width>t.maxWidth)return!1;break;case"minWidth":if(T(t.minWidth)&&e.width<t.minWidth)return!1;break;case"onResize":if(T(t.onResize)&&!t.onResize(e,i))return!1}return!0}(t.query,this._currentMediaInfo,e);return{isActive:i,hasChanged:i!==this.currentActiveItems.has(t)}},e.prototype._apply=function(t,e,i){var n=t.query,r=t.action,a=!1;return lt(r).forEach((function(t){var r=function(t,e,i,n){var r,a,s=t.spec,l=t.filter,c=t.filterType,h=t.forceAppend,d=zK(c,l,t,e,i,n),f=d.isChart,p=d.modelType,v=d.specKey,y=d.type,g=d.modelInfo;if(0===g.length&&!h)return{chartSpec:i,hasChanged:!1};var m=$W({},i),_=A(s)?s(g,t,e):s;try{for(var b=u(g),x=b.next();!x.done;x=b.next()){var k=x.value,S=k.spec,T=k.specPath;if(f)return{chartSpec:$W(m,_),hasChanged:!0};var M=$W({},S,_);UA(m,T,M)}}catch(t){r={error:t}}finally{try{x&&!x.done&&(a=b.return)&&a.call(b)}finally{if(r)throw r.error}}if(0===g.length&&h){var C=o({type:y},_);B(m[v])?m[v].push(C):w(m[v])?m[v]="component"===p?C:[C]:m[v]=[m[v],C]}return{chartSpec:m,hasChanged:!0}}(t,n,e,i);e=r.chartSpec,a||(a=r.hasChanged)})),{chartSpec:e,hasChanged:a}},e.prototype._reInit=function(t,i){var n=this,r=this._option.globalInstance.getSpec();this._baseChartSpec=bU(r,["data",e.specKey]),this._baseChartSpecInfo=this._option.globalInstance.getSpecInfo();var o=!1;this.currentActiveItems.forEach((function(t){var e=n._apply(t,r,n._baseChartSpecInfo);r=e.chartSpec,o||(o=e.hasChanged)})),o&&this._option.updateSpec(r,t,i)},e.prototype.dispose=function(){this._initialized=!1,this._spec=[],this._option=void 0,this._currentMediaInfo={},this.currentActiveItems.clear()},e.pluginType="chart",e.specKey="media",e.type="MediaQueryPlugin",e}(HK),GK=function(t,e){var i=e.beforeCall();return t.forEach((function(t,n){return e.call(t,n,i)})),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};var WK=function(){function e(t,e){var i=this;this._fields=null,this._marks=new FY,this._markReverse=new FY,this.onHover=function(t){i.filterEventMark(t)?(i._isHovered=!0,i.hoverItem(t)):i._isHovered&&(i._isHovered=!1,i.unhoverItem())},this.onUnHover=function(t){i.filterEventMark(t)||i.interaction.filterEventMark(t,MY.STATE_HOVER)||i.interaction.getEventElement(MY.STATE_HOVER)[0]&&i.unhoverItem()},this.onSelect=function(t){i.handleSingleEventSelect(t)},this.onUnSelect=function(t){i.interaction.filterEventMark(t,MY.STATE_SELECTED)||i.clearSelectedItems()},this._spec=t,this._option=e,this.event=new sY(e.eventDispatcher,e.mode),this.interaction=e.interaction,this.initConfig(e.mode)}return Object.defineProperty(e.prototype,"hover",{get:function(){return this._hover},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},enumerable:!1,configurable:!0}),e.prototype.setStateKeys=function(t){this._fields=t.slice()},e.prototype.registerMark=function(t){this._marks.addMark(t),this._hover.enable&&this.interaction.registerMark(MY.STATE_HOVER,t),this._select.enable&&this.interaction.registerMark(MY.STATE_SELECTED,t)},e.prototype.init=function(){this.initEvent()},e.prototype.release=function(){this.releaseEvent(),this._marks.clear()},e.prototype.initEvent=function(){var e=this,i=this.event,n=this._hover,r=n.enable,o=n.trigger,a=n.triggerOff,s=this._select,l=s.enable,u=s.trigger,c=s.triggerOff;r&&(lt(o).forEach((function(n){i.on(n,{level:t.Event_Bubble_Level.chart},e.onHover)})),a&&"none"!==a&&lt(a).forEach((function(n){i.on(n,{level:t.Event_Bubble_Level.vchart,source:t.Event_Source_Type.chart},e.onUnHover)}))),l&&(lt(u).forEach((function(n){i.on(n,{level:t.Event_Bubble_Level.mark},e.onSelect)})),c&&"none"!==c&&lt(c).forEach((function(n){i.on(n,{level:t.Event_Bubble_Level.mark},e.onUnSelect)})),c||lt(null!=c?c:u).forEach((function(n){i.on(n,{level:t.Event_Bubble_Level.vchart},e.onUnSelect)})))},e.prototype.releaseEvent=function(){this.event.release()},e.prototype.initConfig=function(e){var i=function(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"pointerleave"},select:{enable:!0,trigger:"pointertap"}}:Xk(e)||Zk(e)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"pointerleave"},select:{enable:!0,trigger:"tap"}}:null}(e);this._hover=o({},null==i?void 0:i.hover),this._select=o({},null==i?void 0:i.select);var n=this._spec.hover;S(n)?this._hover.enable=n:M(n)&&(this._hover.enable=!0,this._hover=$W(this._hover,n));var r=this._spec.select;S(r)?this._select.enable=r:M(r)&&(this._select.enable=!0,this._select=$W(this._select,r))},e.prototype.hoverItem=function(t){var e=t.datum,i=this.interaction.getEventElement(MY.STATE_HOVER)[0];t.item!==i&&(this.interaction.exchangeEventElement(MY.STATE_HOVER,t.item),this.interaction.reverseEventElement(MY.STATE_HOVER),this.event.emit("hovered",{model:this._option.model,value:[e]}))},e.prototype.unhoverItem=function(){var t=this.interaction.getEventElementData(MY.STATE_HOVER);this.interaction.clearEventElement(MY.STATE_HOVER,!0),this.event.emit("unhovered",{model:this._option.model,value:t})},e.prototype.handleSingleEventHover=function(t){this.filterEventMark(t)?this.hoverItem(t):this.interaction.getEventElement(MY.STATE_HOVER)[0]&&!this.interaction.filterEventMark(t,MY.STATE_HOVER)&&this.unhoverItem()},e.prototype.selectItems=function(t){this.event.emit("selected",{model:this._option.model,value:t})},e.prototype.clearSelectedItems=function(){var t=this.interaction.getEventElementData(MY.STATE_SELECTED);this.interaction.clearEventElement(MY.STATE_SELECTED,!0),this.event.emit("unselected",{model:this._option.model,value:t})},e.prototype.unselectItems=function(t){"none"!==this._select.triggerOff&&(this.interaction.removeEventElement(MY.STATE_SELECTED,t.item),this.event.emit("unselected",{model:this._option.model,value:t.item}))},e.prototype.handleSingleEventSelect=function(t){if(this.filterEventMark(t))if(t.item.getStates().includes(MY.STATE_SELECTED))this.unselectItems(t);else{if("multiple"===this._select.mode)this.interaction.addEventElement(MY.STATE_SELECTED,t.item);else this.interaction.exchangeEventElement(MY.STATE_SELECTED,t.item);this.interaction.reverseEventElement(MY.STATE_SELECTED);var e=this.interaction.getEventElementData(MY.STATE_SELECTED);this.selectItems(e)}else this.interaction.filterEventMark(t,MY.STATE_SELECTED)||this.clearSelectedItems()},e.prototype.filterEventMark=function(t){return!(!t.mark||!this._marks.includes(t.mark))},e.prototype.isDatumEqual=function(t,e){return(this._fields?this._fields:Object.keys(t)).every((function(i){return t[i]===e[i]}))},e}(),UK=function(t){var e,i;if(!1===(null==t?void 0:t.visible))return[];var n={mark:!1!==(null===(e=null==t?void 0:t.mark)||void 0===e?void 0:e.visible),dimension:!1!==(null===(i=null==t?void 0:t.dimension)||void 0===i?void 0:i.visible)};return T(null==t?void 0:t.activeType)&&Object.keys(n).forEach((function(e){var i;n[e]=null===(i=null==t?void 0:t.activeType)||void 0===i?void 0:i.includes(e)})),Object.keys(n).filter((function(t){return n[t]}))};var YK=function(t){function e(e){var i=t.call(this)||this;return i._getSeriesCacheInfo=function(){var t,e,n,r=i.series,o=r.getSeriesField();return{seriesFields:T(o)?lt(o):null!==(t=r.getSeriesKeys())&&void 0!==t?t:[],dimensionFields:null!==(e=r.getDimensionField())&&void 0!==e?e:[],measureFields:null!==(n=r.getMeasureField())&&void 0!==n?n:[],type:r.type}},i._getDimensionData=function(t){var e=i._seriesCacheInfo.dimensionFields;return e[0]&&(null==t?void 0:t[e[0]])},i._getMeasureData=function(t){var e=i._seriesCacheInfo.measureFields;return e[0]&&(null==t?void 0:t[e[0]])},i._getSeriesStyle=function(t,e,n){var r,o,a;try{for(var s=u(lt(e)),l=s.next();!l.done;l=s.next()){var c=l.value,h=null===(a=i.series.getSeriesStyle(t))||void 0===a?void 0:a(c);if(T(h))return h}}catch(t){r={error:t}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return n},i.contentKeyCallback=function(t,e){var n=i._seriesCacheInfo,r=n.dimensionFields,o=n.seriesFields,a=r[r.length-1];return T(o[0])&&(null==t?void 0:t[o[0]])?null==t?void 0:t[o[0]]:(r.length>1&&(0===o.length||i.series.getSeriesKeys().length),null==t?void 0:t[a])},i.contentValueCallback=function(t,e){return i._getMeasureData(t)},i.contentShapeTypeCallback=function(t,e){var n;return null!==(n=i._getSeriesStyle(t,"shape",null))&&void 0!==n?n:i._getSeriesStyle(t,"symbolType",i.series.getDefaultShapeType())},i.contentShapeColorCallback=function(t,e){return i._getSeriesStyle(t,["fill","stroke"])},i.titleValueCallback=function(t,e){return i._getDimensionData(t)},i.series=e,i.updateTooltipSpec(),i}return r(e,t),e.prototype.updateTooltipSpec=function(){var t,e,i,n,r=this,a=null!==(e=null===(t=this.series.getSpec())||void 0===t?void 0:t.tooltip)&&void 0!==e?e:{},s=null!==(n=null===(i=this.series.getChart().getSpec())||void 0===i?void 0:i.tooltip)&&void 0!==n?n:{},l=o(o({},s),a);["mark","dimension"].forEach((function(t){var e=l[t];T(e)&&(l[t]=o(o({},e),{title:T(e.title)?A(e.title)?e.title:o(o({},e.title),{seriesId:r.series.id}):void 0,content:T(e.content)?A(e.content)?e.content:lt(e.content).map((function(t){return A(t)?t:o(o({},t),{seriesId:r.series.id})})):void 0}))})),this.spec=l,this.activeType=UK(l),this._seriesCacheInfo=this._getSeriesCacheInfo()},e.prototype.getDefaultTooltipPattern=function(t,e){var i=this;if("mark"===t)return{visible:!0,activeType:t,title:{key:void 0,value:this.titleValueCallback,hasShape:!1},content:[{seriesId:this.series.id,key:this.contentKeyCallback,value:this.contentValueCallback,hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1}]};if("dimension"===t&&e){var n={key:void 0,value:this._getDimensionData,hasShape:!1},r=[];return e.forEach((function(t){return t.data.forEach((function(t){var e=t.series;r.push({seriesId:e.id,key:i.contentKeyCallback,value:i.contentValueCallback,hasShape:!0,shapeType:i.contentShapeTypeCallback,shapeColor:i.contentShapeColorCallback,shapeStroke:i.contentShapeColorCallback,shapeHollow:!1})}))})),{visible:!0,activeType:t,title:n,content:r}}return null},e}((function(){this.activeTriggerSet={mark:new Set,dimension:new Set},this.ignoreTriggerSet={mark:new Set,dimension:new Set}})),KK={min:function(t){return t.length?ht(t.map((function(t){return 1*t}))):0},max:function(t){return t.length?ct(t.map((function(t){return 1*t}))):0},"array-min":function(t){return t.length?ht(t.map((function(t){return 1*t}))):0},"array-max":function(t){return t.length?ct(t.map((function(t){return 1*t}))):0},values:function(t){var e,i,n={},r=[];try{for(var o=u(t),a=o.next();!a.done;a=o.next()){var s=a.value;n[s]||(r.push(s),n[s]=1)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return r}},XK=function(t,e){var i,n,r=e.fields;if(A(r)&&(r=r()),!(null==r?void 0:r.length)||!(null==t?void 0:t.length))return{};r=SU([],r);var o="parser"===e.target?"parserData":"latestData",a=t[0][o]?t[0][o]:t||[],s=null===(n=(i=t[0]).getFields)||void 0===n?void 0:n.call(i);return ZK(a,r,s)},ZK=function(t,e,i){var n={},r=[],o=[];return e.forEach((function(e){var a=e.key;n[a]={};var s=null==i?void 0:i[a],l=e.operations,u=l.some((function(t){return"min"===t||"max"===t||"allValid"===t})),c=!0;r.length=0,t.forEach((function(t){t&&r.push(t[a])}));var h=r.length;if(u){o.length=0,r.forEach((function(t,e){Qk(t)&&o.push(t)}));var d=r;r=o,o=d,c=r.length===h}else r=l.some((function(t){return"array-min"===t||"array-max"===t}))?r.reduce((function(t,e){return e&&e.forEach((function(e){Qk(e)&&t.push(e)})),t}),[]):r.filter((function(t){return void 0!==t}));l.forEach((function(t){if(e.customize)n[a][t]=e.customize;else{if(s&&s.lockStatisticsByDomain&&!w(s.domain)){if("values"===t)return void(n[a][t]=s.domain.slice())}else if("allValid"===t)return;n[a][t]=KK[t](r),"array-max"===t&&(n[a].max=n[a][t]),"array-min"===t&&(n[a].min=n[a][t])}})),u&&(n[a].allValid=c)})),n},qK=function(t,e){var i=e.config;if(!i)return t;var n=i(),r=n.invalidType,o=n.checkField;return"zero"!==r||t.forEach((function(t){Qk(t[o])||(t[o]=0)})),t},JK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._compileProduct=function(){var t,e=null===(t=this._data)||void 0===t?void 0:t.latestData;w(e)||T(this.getProduct())||this._initProduct([])},e.prototype.generateProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.name},e}(dK),QK="".concat(bw,"_HIERARCHY_DEPTH"),$K="".concat(bw,"_HIERARCHY_ROOT"),tX="".concat(bw,"_HIERARCHY_ROOT_INDEX");function eX(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function iX(t,e,i){t&&(i.needDefaultSeriesField&&(t[uV]=i.defaultSeriesField),t[sV]=e,t[lV]=i.getKey(t,e,i))}function nX(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function rX(t,e,i,n,r,o){void 0===n&&(n=0),void 0===o&&(o=e),iX(t,e,i),t[QK]=n,t[$K]=r||t[i.categoryField],t[tX]=o,t.children&&t.children.length&&t.children.forEach((function(e,n){return rX(e,n,i,t[QK]+1,t[$K],o)}))}var oX=["appear","enter","update","exit","disappear","normal"];function aX(t,e,i){void 0===t&&(t={});for(var n={},r=function(r){var a,s=oX[r],l=e?e[s]:void 0;if(!1===l)return"continue";if("normal"===s)return l&&(n.normal=l),"continue";if("update"!==s&&!l&&!t[s])return"continue";if(a=B(t[s])?t[s]:[o(o({},xK[s]),t[s])],"exit"===s&&a.forEach((function(t){t.controlOptions={stopWhenStateChange:!0}})),!l)return n[s]=a,"continue";var u=void 0;u=B(l)?l.map((function(t,e){var n,r=t;return hX(r)&&delete r.type,r.oneByOne&&(r=lX(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:uX,null==i?void 0:i.dataCount)),r})):a.map((function(t,e){var n,r=$W({},a[e],l);return hX(r)&&delete r.type,r.oneByOne&&(r=lX(r,null!==(n=null==i?void 0:i.dataIndex)&&void 0!==n?n:uX,null==i?void 0:i.dataCount)),r})),n[s]=u},a=0;a<oX.length;a++)r(a);return n.state=n.update,n}function sX(t,e,i){var n,r,o,a,s,l={};return e.animationAppear&&(l.appear=null!==(n=e.animationAppear[t])&&void 0!==n?n:e.animationAppear),e.animationDisappear&&(l.disappear=null!==(r=e.animationDisappear[t])&&void 0!==r?r:e.animationDisappear),e.animationEnter&&(l.enter=null!==(o=e.animationEnter[t])&&void 0!==o?o:e.animationEnter),e.animationExit&&(l.exit=null!==(a=e.animationExit[t])&&void 0!==a?a:e.animationExit),e.animationUpdate&&(l.update=null!==(s=e.animationUpdate[t])&&void 0!==s?s:e.animationUpdate),e.animationNormal&&e.animationNormal[t]&&(l.normal=e.animationNormal[t]),function(t,e){if(!t)return t;return t=X(t),dX(t,(function(t){var i;if(A(t)&&(null===(i=t.prototype)||void 0===i?void 0:i.constructor)!==t){var n=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return t.apply(void 0,h(h([],c(i),!1),[e],!1))};return n}return t})),t}(l,i)}function lX(t,e,i){var n=t.oneByOne,r=t.duration,o=t.delay,a=t.delayAfter;return t.delay=function(t,i,a){var s=e(t),l=A(r)?r(t,i,a):F(r)?r:0,u=A(o)?o(t,i,a):F(o)?o:0,c=A(n)?n(t,i,a):n;return!1===c?u:u+s*(l+(c=!0===c?0:c))},t.delayAfter=function(t,o,s){var l=e(t),u=A(r)?r(t,o,s):F(r)?r:0,c=A(a)?a(t,o,s):F(a)?a:0,h=A(n)?n(t,o,s):n;return!1===h?c:c+((i?i():o.mark.elements.length)-l)*(u+(h=!0===h?0:h))},delete t.oneByOne,t}function uX(t){return null==t?void 0:t[sV]}function cX(t,e){var i,n,r,o,a;if(!1===t.animation)return!1;if(!1===(null===(i=t.morph)||void 0===i?void 0:i.enable))return!1;var s=!1!==(null!==(r=null===(n=t.animationAppear)||void 0===n?void 0:n[e])&&void 0!==r?r:t.animationAppear),l=!1!==(null!==(a=null===(o=t.animationUpdate)||void 0===o?void 0:o[e])&&void 0!==a?a:t.animationUpdate);return!(!s||!l)}function hX(t){return!function(t){return T(t.timeSlices)}(t)&&T(t.channel)}function dX(t,e){if(B(t))t.forEach((function(i,n){t[n]=e(t[n],n),dX(t[n],e)}));else if(M(t))for(var i in t)t[i]=e(t[i],i),dX(t[i],e)}var fX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.markLabelSpec={},e}return r(e,t),e.prototype.getLabelSpec=function(t){return this.markLabelSpec[t]},e.prototype.setLabelSpec=function(t,e){this.markLabelSpec[t]=lt(e)},e.prototype.addLabelSpec=function(t,e,i){void 0===i&&(i=!1),this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)},e.prototype.getTheme=function(t,e){var i,n=YG(t),r=null===(i=this._option)||void 0===i?void 0:i.getTheme(),o=r.markByName,a=r.mark,s=this._option.type;return $W({},nU(U(r,"series.".concat(s)),s,a,o),nU(U(r,"series.".concat(s,"_").concat(n)),"".concat(s,"_").concat(n),a,o))},e.prototype.transformSpec=function(e,i,n){var r=t.prototype.transformSpec.call(this,e,i,n);return this._transformLabelSpec(r.spec),o(o({},r),{markLabelSpec:this.markLabelSpec})},e.prototype._transformLabelSpec=function(t){},e.prototype._addMarkLabelSpec=function(t,e,i,n,r,a){void 0===i&&(i="label"),void 0===n&&(n="initLabelMarkStyle");var s=null==t?void 0:t[i];(null==s?void 0:s.visible)&&this.addLabelSpec(e,o(o({animation:null!=r?r:t.animation},s),{getStyleHandler:function(t){var e;return null===(e=t[n])||void 0===e?void 0:e.bind(t)}}),a)},e.prototype._getDefaultSpecFromChart=function(e){var i,n=null!==(i=t.prototype._getDefaultSpecFromChart.call(this,e))&&void 0!==i?i:{},r=e.outerRadius,o=e.innerRadius;return T(r)&&(n.outerRadius=r),T(o)&&(n.innerRadius=o),Object.keys(n).length>0?n:void 0},e}(ZY),pX=function(e){function i(t,i){var n,r=this;return(r=e.call(this,t,i)||this).specKey="series",r.type="series",r.layoutType="absolute",r.modelType="series",r.name=void 0,r.transformerConstructor=fX,r.coordinate="none",r._region=null,r._layoutStartPoint={x:0,y:0},r._layoutRect={width:null,height:null},r.getLayoutRect=function(){var t,e;return{width:null!==(t=r._layoutRect.width)&&void 0!==t?t:r._region.getLayoutRect().width,height:null!==(e=r._layoutRect.height)&&void 0!==e?e:r._region.getLayoutRect().height}},r._rootMark=null,r._seriesMark=null,r._viewDataMap=new Map,r._viewDataFilter=null,r._data=null,r._percent=!1,r._stackOffsetSilhouette=!1,r.layoutZIndex=0,r._invalidType="break",r._getInvalidDefined=function(t){return Qk(t[r.getStackValueField()])},r._region=i.region,r._dataSet=i.dataSet,(null===(n=r._spec)||void 0===n?void 0:n.name)&&(r.name=r._spec.name),r}return r(i,e),i.prototype.getTrigger=function(){return this._trigger},i.prototype.getRegion=function(){return this._region},i.prototype.getLayoutStartPoint=function(){return this._region.getLayoutStartPoint()},i.prototype.getRootMark=function(){return this._rootMark},i.prototype.getRawData=function(){return this._rawData},i.prototype.getViewDataFilter=function(){return this._viewDataFilter},i.prototype.getViewData=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()},i.prototype.getViewDataProductId=function(){var t;return null===(t=this._data)||void 0===t?void 0:t.getProductId()},i.prototype.getViewDataStatistics=function(){return this._viewDataStatistics},i.prototype.getViewStackData=function(){return this._viewStackData},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){var e=this;T(t)&&(this._seriesField=t,this.getMarks().filter((function(t){return t.getDataView()===e.getViewData()})).forEach((function(t){t.setFacet(e._seriesField)})))},i.prototype.getGroups=function(){return this._groups},i.prototype.getStack=function(){return this._stack},i.prototype.getStackValue=function(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:"".concat(bw,"_series_").concat(this.type)},i.prototype.getPercent=function(){return this._percent},i.prototype.getStackOffsetSilhouette=function(){return this._stackOffsetSilhouette},Object.defineProperty(i.prototype,"tooltipHelper",{get:function(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper},enumerable:!1,configurable:!0}),i.prototype.getInvalidType=function(){return this._invalidType},i.prototype.setInvalidType=function(t){var e;this._invalidType=t,null===(e=this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.getMarkAttributeContext=function(){return this._markAttributeContext},i.prototype.created=function(){e.prototype.created.call(this),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(t.ChartEvent.afterInitData,{model:this}),this.initTrigger(),this.initRootMark(),this.initMark();var i=function(t){return!1!==t.getSpec().animation&&T(t.getRegion().animate)}(this);this._initExtensionMark({hasAnimation:i}),this.initMarkStyle(),this.initMarkState(),i&&this.initAnimation(),this.afterInitMark(),this.initEvent(),this.event.emit(t.ChartEvent.afterInitEvent,{model:this})},i.prototype._buildMarkAttributeContext=function(){var t=this;this._markAttributeContext={vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)},seriesColor:function(e){var i;return w(e)&&(e=t.getSeriesKeys()[0]),null===(i=t._option.globalScale.getScale("color"))||void 0===i?void 0:i.scale(e)},getRegion:function(){return t._region}}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setSeriesField(this._spec.seriesField),S(this._spec.stack)&&(this._stack=this._spec.stack),S(this._spec.percent)&&(this._percent=this._spec.percent,this._stack=this._spec.percent||this._stack),S(this._spec.stackOffsetSilhouette)&&(this._stackOffsetSilhouette=this._spec.stackOffsetSilhouette,this._stack=this._spec.stackOffsetSilhouette||this._stack),T(this._spec.stackValue)&&(this._stack=!0),w(this._stack)&&this._supportStack&&this._seriesField&&(this._stack=!0),T(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)},i.prototype.initData=function(){var t,e,i,n,r,o,a=this,s=null!==(t=this._spec.data)&&void 0!==t?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(s&&(this._rawData=xY(s,this._dataSet,this._option.sourceDataList,{onError:null===(e=this._option)||void 0===e?void 0:e.onError})),null===(n=null===(i=this._rawData)||void 0===i?void 0:i.target)||void 0===n||n.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this._stack&&(this._viewDataFilter=bY(this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewDataFilter")}));var l=bY(this._stack?this._viewDataFilter:this._rawData,this._dataSet,{name:"".concat(this.type,"_").concat(this.id,"_viewData")});this._data=new JK(this._option,l),this._stack&&this._viewDataFilter.target.removeListener("change",l.reRunAllTransform)}"zero"===this._invalidType&&(null===(r=this._rawData)||void 0===r?void 0:r.dataSet)&&(hY(this._rawData.dataSet,"invalidTravel",qK),null===(o=this._rawData)||void 0===o||o.transform({type:"invalidTravel",options:{config:function(){return{invalidType:a._invalidType,checkField:a.getStackValueField()}}}},!1))},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})},i.prototype.initStatisticalData=function(){this._data&&this._statisticViewData()},i.prototype.getRawDataStatisticsByField=function(t,e){var i,n;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t])if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){var r=null===(n=this._rawData.getFields())||void 0===n?void 0:n[t];r&&r.lockStatisticsByDomain&&r.domain?(this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=ht(r.domain),this._rawStatisticsCache[t].max=ct(r.domain)):this._rawStatisticsCache[t].values=r.domain):this._rawStatisticsCache[t]=ZK(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t]}return e&&(w(this._rawStatisticsCache[t].min)||w(this._rawStatisticsCache[t].max))&&(this._rawStatisticsCache[t].min=ht(this._rawStatisticsCache[t].values),this._rawStatisticsCache[t].max=ct(this._rawStatisticsCache[t].values)),this._rawStatisticsCache[t]},i.prototype._statisticViewData=function(){var t=this;hY(this._dataSet,"dimensionStatistics",XK);var e="".concat(this.type,"_").concat(this.id,"_viewDataStatic");this._viewDataStatistics=new Ma(this._dataSet,{name:e}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:function(){var e=t.getStatisticFields();return t._seriesField&&SU(e,[{key:t._seriesField,operations:["values"]}]),e},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this._stack&&this.createdStackData()},i.prototype.createStatisticalData=function(t,e,i){var n=this;hY(this._dataSet,"dimensionStatistics",XK);var r=new Ma(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:function(){var t,r=SU(n.getStatisticFields(),null!==(t=null==i?void 0:i(e.name))&&void 0!==t?t:[]);return n._seriesField&&SU(r,[{key:n._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r},i.prototype.createdStackData=function(){var t="".concat(this.type,"_").concat(this.id,"_viewStackData");this._viewStackData=new Ma(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.generateDefaultDataKey=function(t){var e,i=this;return w(t)?function(t,e,n){if(!1===i._spec.animation){var r=i._noAnimationDataKey(t,e);if(void 0!==r)return r}var o=n.keyMap,a=i._getSeriesDataKey(t);return void 0===o.get(a)?(o.set(a,0),a):(o.set(a,o.get(a)+1),"".concat(a,"_").concat(o.get(a)))}:P(t)?function(e){return e[t]}:B(t)&&t.every((function(t){return P(t)}))?function(e){return t.map((function(t){return e[t]})).join("-")}:A(t)?function(e,i){return t(e,i)}:(null===(e=this._option)||void 0===e||e.onError("invalid dataKey: ".concat(t)),function(t,e){})},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(hY(this._rawData.dataSet,"addVChartProperty",GK),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:eX.bind(this),call:iX}},!1))},i.prototype.updateRawData=function(t){this._rawData&&this._rawData.updateRawData(t)},i.prototype.rawDataUpdate=function(e){var i;null===(i=this._rawDataStatistics)||void 0===i||i.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(t.ChartEvent.rawDataUpdate,{model:this})},i.prototype.viewDataFilterOver=function(e){this.event.emit(t.ChartEvent.viewDataFilterOver,{model:this})},i.prototype.viewDataUpdate=function(e){var i;this.event.emit(t.ChartEvent.viewDataUpdate,{model:this}),null===(i=this._data)||void 0===i||i.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()},i.prototype.viewDataStatisticsUpdate=function(e){this.event.emit(t.ChartEvent.viewDataStatisticsUpdate,{model:this})},i.prototype.getDatumPositionValue=function(t,e){return!t||w(e)?null:t[e]},i.prototype.getDatumPositionValues=function(t,e){return!t||w(e)?[]:P(e)?[t[e]]:e.map((function(e){return t[e]}))},i.prototype.setValueFieldToStack=function(){},i.prototype.setValueFieldToPercent=function(){},i.prototype.setValueFieldToStackOffsetSilhouette=function(){},i.prototype.initRootMark=function(){var t,e;this._rootMark=this._createMark({type:"group",name:"seriesGroup_".concat(this.type,"_").concat(this.id)},{parent:null===(e=(t=this._region).getGroupMark)||void 0===e?void 0:e.call(t),dataView:!1}),this._rootMark.setZIndex(this.layoutZIndex)},i.prototype._initExtensionMark=function(t){var e,i=this;this._spec.extensionMark&&(null===(e=this._spec.extensionMark)||void 0===e||e.forEach((function(e,n){i._createExtensionMark(e,null,"".concat(bw,"_series_").concat(i.id,"_extensionMark"),n,t)})))},i.prototype._createExtensionMark=function(t,e,i,n,r){var o,a=this,s=this._createMark({type:t.type,name:"".concat(i,"_").concat(n)},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,customShape:null==t?void 0:t.customShape});if(s){if(r.hasAnimation){var l=aX({},sX(t.type,t,this._markAttributeContext));s.setAnimationConfig(l)}if("group"===t.type)i="".concat(i,"_").concat(n),null===(o=t.children)||void 0===o||o.forEach((function(t,e){a._createExtensionMark(t,s,i,e,r)}));else if(!(e||w(t.dataId)&&w(t.dataIndex))){var u=this._option.getSeriesData(t.dataId,t.dataIndex);u===this._rawData?s.setDataView(this.getViewData(),this.getViewDataProductId()):s.setDataView(u)}}},i.prototype._updateExtensionMarkSpec=function(t){var e,i=this;null===(e=this._spec.extensionMark)||void 0===e||e.forEach((function(e,n){var r,o=i._marks.getMarkWithInfo({name:"".concat(i.type,"_").concat(i.id,"_extensionMark_").concat(n)});o&&(t&&nt(null===(r=t.extensionMark)||void 0===r?void 0:r[n],e)||(i.initMarkStyleWithSpec(o,e),o.updateStaticEncode(),o.updateLayoutState()))}))},i.prototype.getStackData=function(){var t;return null===(t=this._viewStackData)||void 0===t?void 0:t.latestData},i.prototype.initTrigger=function(){var t={hover:this._spec.hover,select:this._spec.select},e=o(o({},this._option),{model:this,interaction:this._region.interaction});this._trigger=new WK(t,e)},i.prototype.initAnimation=function(){},i.prototype.initMarkState=function(){this.initSeriesStyleState()},i.prototype.initSeriesStyleState=function(){var t,e=this,i=this._spec.seriesStyle;if(i&&i.length){var n=null!==(t=this._seriesField)&&void 0!==t?t:uV;this.getMarksWithoutRoot().forEach((function(t){var r={},o={},a={};i.forEach((function(e){var i,n=null===(i=e[t.name])||void 0===i?void 0:i.style;n&&(r[e.name]=!0,a[e.name]=a[e.name]||{},Object.keys(n).forEach((function(t){o[t]=!0,a[e.name][t]=n[t]})))})),t.state.addStateInfo({stateValue:cV,level:-1,filter:function(t){return Array.isArray(t)?0!==t.length&&!0===r[t[0][n]]:!0===r[t[n]]}});var s={};Object.keys(o).forEach((function(e){s[e]=function(i){var r,o;if(Array.isArray(i)){if(0===i.length)return;null===(r=a[i[0][n]])||void 0===r?void 0:r[e]}return(null===(o=a[i[n]])||void 0===o?void 0:o[e])||t.getAttribute(e,i)}})),e.setMarkStyle(t,s,cV)}))}},i.prototype.afterInitMark=function(){var e,i,n,r=this;this.event.emit(t.ChartEvent.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField);var o=null!==(e=this._spec.animationThreshold)&&void 0!==e?e:Number.MAX_SAFE_INTEGER;this.getMarks().forEach((function(e){var i,n;(null===(n=null===(i=e.stateStyle)||void 0===i?void 0:i.normal)||void 0===n?void 0:n.lineWidth)&&e.setAttribute("stroke",r.getColorAttribute(),"normal",t.AttributeLevel.Base_Series);var a=e.getProgressiveConfig();a&&(a.large&&a.largeThreshold&&(o=Math.min(o,a.largeThreshold)),a.progressiveThreshold&&(o=Math.min(o,a.progressiveThreshold)))})),(null===(n=null===(i=this._rawData)||void 0===i?void 0:i.latestData)||void 0===n?void 0:n.length)>=o&&(this._spec.animation=!1)},i.prototype.getMarksWithoutRoot=function(){return this.getMarks().filter((function(t){return!t.name.includes("seriesGroup")}))},i.prototype.getMarksInType=function(t){return this._marks.getMarksInType(t)},i.prototype.getMarkInName=function(t){return this._marks.get(t)},i.prototype.getMarkInId=function(t){return this.getMarks().find((function(e){return e.id===t}))},i.prototype.initEvent=function(){var t,e,i;this._trigger.init(),null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.target.addListener("change",this.viewDataUpdate.bind(this)),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))},i.prototype._releaseEvent=function(){e.prototype._releaseEvent.call(this),this._trigger.release()},i.prototype.initTooltip=function(){this._tooltipHelper=new YK(this)},i.prototype._compareSpec=function(t,i,n){var r,o,a=e.prototype._compareSpec.call(this,t,i),s=Object.keys(i||{}).sort();return nt(s,Object.keys(t||{}).sort())?((n=null!=n?n:{data:!0}).invalidType=!0,t.invalidType!==i.invalidType&&(a.reCompile=!0),n.extensionMark=!0,(lt(t.extensionMark).length!==lt(i.extensionMark).length||(null===(r=i.extensionMark)||void 0===r?void 0:r.some((function(e,i){return e.type!==t.extensionMark[i].type||e.id!==t.extensionMark[i].id}))))&&(a.reMake=!0),a.reMake?a:((null===(o=i.extensionMark)||void 0===o?void 0:o.some((function(e,i){return e.visible!==t.extensionMark[i].visible})))&&(a.reCompile=!0),this._marks.getMarks().some((function(e){var r,o;return n[e.name]=!0,(null===(r=i[e.name])||void 0===r?void 0:r.visible)!==(null===(o=t[e.name])||void 0===o?void 0:o.visible)}))&&(a.reCompile=!0),s.some((function(e){return!n[e]&&!nt(t[e],i[e])}))?(a.reMake=!0,a):a)):(a.reMake=!0,a)},i.prototype._updateSpecData=function(){!this._rawData||!this._spec.data||this._spec.data instanceof Ma||kY(this._rawData,this._spec.data,!0)},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t);var n=this.getMarksWithoutRoot();n.forEach((function(t){i._spec[t.name]&&i.initMarkStyleWithSpec(t,i._spec[t.name])})),this.initMarkStyle(),n.forEach((function(t){t.updateStaticEncode(),t.updateLayoutState(!0)})),this._updateExtensionMarkSpec(t),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec()},i.prototype.onEvaluateEnd=function(t){this._data.updateData()},i.prototype.onRender=function(t){},i.prototype.release=function(){var t,i,n;e.prototype.release.call(this),this._viewDataMap.clear();var r=null===(i=null===(t=this._rawData)||void 0===t?void 0:t.transformsArr)||void 0===i?void 0:i.findIndex((function(t){return"addVChartProperty"===t.type}));r>=0&&this._rawData.transformsArr.splice(r,1),null===(n=this._data)||void 0===n||n.release(),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null},i.prototype.setLayoutStartPosition=function(t){F(t.x)&&(this._layoutStartPoint.x=t.x),F(t.y)&&(this._layoutStartPoint.y=t.y)},i.prototype.setLayoutRect=function(t,e){var i=t.width,n=t.height;F(i)&&(this._layoutRect.width=i),F(n)&&(this._layoutRect.height=n)},i.prototype.getSeriesKeys=function(){var t,e;return this._seriesField?null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r;return null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0}},i.prototype._getSeriesInfo=function(t,e){var i=this,n=this.getDefaultShapeType();return e.map((function(e){var r;return{key:e,style:i.getSeriesStyle((r={},r[t]=e,r)),shapeType:n}}))},i.prototype.getSeriesInfoInField=function(t){var e,i;return this._getSeriesInfo(t,null!==(i=null===(e=this.getRawDataStatisticsByField(t))||void 0===e?void 0:e.values)&&void 0!==i?i:[])},i.prototype.getSeriesInfoList=function(){var t;return this._getSeriesInfo(null!==(t=this._seriesField)&&void 0!==t?t:uV,this.getSeriesKeys())},i.prototype._getDefaultColorScale=function(){var t,e,i=this.getDefaultColorDomain(),n=this._getDataScheme();return null===(e=(t=(new nW).domain(i)).range)||void 0===e?void 0:e.call(t,n)},i.prototype._getDataScheme=function(){return ZG(this.getColorScheme(),this.type)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesField?null===(e=null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesField])||void 0===e?void 0:e.values:[]},i.prototype.getColorAttribute=function(){var t,e;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(e=this._seriesField)&&void 0!==e?e:uV}},i.prototype.getDimensionField=function(){return[]},i.prototype.getMeasureField=function(){return[]},i.prototype.onMarkPositionUpdate=function(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())},i.prototype.onMarkTreePositionUpdate=function(t){},i.prototype._createMark=function(t,i){var n,r,o,a;void 0===i&&(i={});var s=i.key,l=i.groupKey,u=i.skipBeforeLayouted,d=i.themeSpec,f=void 0===d?{}:d,p=i.markSpec,v=i.dataView,y=i.dataProductId,g=i.parent,m=i.isSeriesMark,_=i.depend,b=i.progressive,x=i.support3d,k=void 0===x?this._spec.support3d||!!this._spec.zField:x,A=i.morph,M=void 0!==A&&A,C=i.customShape,E=e.prototype._createMark.call(this,t,{key:null!=s?s:this._getDataIdKey(),support3d:k,seriesId:this.id,attributeContext:this._markAttributeContext});if(T(E)){this._marks.addMark(E,{name:t.name}),m&&(this._seriesMark=E),w(g)?null===(n=this._rootMark)||void 0===n||n.addMark(E):!1!==g&&g.addMark(E),w(v)?(E.setDataView(this.getViewData(),this.getViewDataProductId()),E.setSkipBeforeLayouted(!0)):!1!==v&&E.setDataView(v,y),S(u)&&E.setSkipBeforeLayouted(u),T(_)&&E.setDepend.apply(E,h([],c(lt(_)),!1));var R=this.getSpec()||{};E.setMorph(M),E.setMorphKey((null===(r=R.morph)||void 0===r?void 0:r.morphKey)||"".concat(this._specIndex)),E.setMorphElementKey(null!==(a=null===(o=R.morph)||void 0===o?void 0:o.morphElementKey)&&void 0!==a?a:i.defaultMorphElementKey),w(b)||E.setProgressiveConfig(b),w(l)||E.setGroupKey(l),C&&E.setCustomizedShapeCallback(C),this.initMarkStyleWithSpec(E,$W({},f,p||R[E.name]))}return E},i.prototype._getDataIdKey=function(){var t;return null!==(t=e.prototype._getDataIdKey.call(this))&&void 0!==t?t:lV},i.prototype._getSeriesDataKey=function(t){var e="";if(!t)return e;var i=this.getDimensionField();e=i.map((function(e){return t[e]})).join("_");var n=this.getSeriesField();return n&&!i.includes(n)&&(e+="_".concat(t[n])),e},i.prototype.addViewDataFilter=function(t){var e,i;null===(i=null!==(e=this._viewDataFilter)&&void 0!==e?e:this.getViewData())||void 0===i||i.transform(t,!1)},i.prototype.reFilterViewData=function(){var t,e;null===(e=null!==(t=this._viewDataFilter)&&void 0!==t?t:this.getViewData())||void 0===e||e.reRunAllTransform()},i.prototype.reTransformViewData=function(){var t,e;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()},i.prototype.fillData=function(){var t;null===(t=this.getRawData())||void 0===t||t.reRunAllTransform()},i.prototype.compile=function(){this.compileData()},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getFieldAlias=function(t){var e;return t!==pV&&t!==yV&&t!==fV&&t!==vV||(t=this.getStackValueField()),null!==(e=wU(this.getRawData(),t))&&void 0!==e?e:t},i.prototype.getMarkInfoList=function(){var t,i=e.prototype.getMarkInfoList.call(this);return i.length?i:Object.values(null!==(t=UG[this.type])&&void 0!==t?t:{})},i.prototype._getInvalidConnectType=function(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"},i.mark=lG,i.transformerConstructor=fX,i}(qY);function vX(t,e,i){var n=t.getScale(0),r="isInverse"in t&&t.isInverse();gS(n.type)?i.sort((function(t,i){return(t[e]-i[e])*(r?-1:1)})):i.sort((function(t,i){return(n._index.get(t[e])-n._index.get(i[e]))*(r?-1:1)}))}function yX(t){return{dataIndex:function(e){var i,n,r="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],o=null==e?void 0:e[r],a="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!==(n=null===(i=null==a?void 0:a.domain)||void 0===i?void 0:i.call(a))&&void 0!==n?n:[]).indexOf(o)||0},dataCount:function(){var e,i,n,r="horizontal"===t.direction?t.scaleY:t.scaleX;return null!==(n=(null!==(i=null===(e=null==r?void 0:r.domain)||void 0===e?void 0:e.call(r))&&void 0!==i?i:[]).length)&&void 0!==n?n:0}}}var gX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coordinate="cartesian",e._bandPosition=.5,e._scaleConfig={bandPosition:e._bandPosition},e._direction="vertical",e._sortDataByAxis=!1,e._getInvalidDefined=function(t){var i,n;return!((null===(i=e._xAxisHelper)||void 0===i?void 0:i.isContinuous)&&!Qk(t[e._specXField[0]]))&&!((null===(n=e._yAxisHelper)||void 0===n?void 0:n.isContinuous)&&!Qk(t[e._specYField[0]]))},e}return r(e,t),e.prototype._buildScaleConfig=function(){this._scaleConfig={bandPosition:this._bandPosition}},Object.defineProperty(e.prototype,"fieldX",{get:function(){return this._fieldX},enumerable:!1,configurable:!0}),e.prototype.setFieldX=function(t){this._fieldX=lt(t)},Object.defineProperty(e.prototype,"fieldY",{get:function(){return this._fieldY},enumerable:!1,configurable:!0}),e.prototype.setFieldY=function(t){this._fieldY=lt(t)},Object.defineProperty(e.prototype,"fieldZ",{get:function(){return this._fieldZ},enumerable:!1,configurable:!0}),e.prototype.setFieldZ=function(t){this._fieldZ=t&&lt(t)},Object.defineProperty(e.prototype,"fieldX2",{get:function(){return this._fieldX2},enumerable:!1,configurable:!0}),e.prototype.setFieldX2=function(t){this._fieldX2=t},Object.defineProperty(e.prototype,"fieldY2",{get:function(){return this._fieldY2},enumerable:!1,configurable:!0}),e.prototype.setFieldY2=function(t){this._fieldY2=t},Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!1,configurable:!0}),e.prototype.setScaleX=function(t){this._scaleX=t},Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!1,configurable:!0}),e.prototype.setScaleY=function(t){this._scaleY=t},Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this._scaleZ},enumerable:!1,configurable:!0}),e.prototype.setScaleZ=function(t){this._scaleZ=t},e.prototype.getXAxisHelper=function(){return this._xAxisHelper},e.prototype.setXAxisHelper=function(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()},e.prototype.getYAxisHelper=function(){return this._yAxisHelper},e.prototype.setYAxisHelper=function(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()},e.prototype.getZAxisHelper=function(){return this._zAxisHelper},e.prototype.setZAxisHelper=function(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()},Object.defineProperty(e.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),e.prototype.getStatisticFields=function(){var t,e,i,n=this,r=[];return(null===(t=this.getXAxisHelper())||void 0===t?void 0:t.getScale)&&(this._fieldX2?h(h([],c(this._fieldX),!1),[this._fieldX2],!1):this._fieldX).forEach((function(t){var e={key:t,operations:[]};gS(n.getXAxisHelper().getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],r.push(e)})),(null===(e=this.getYAxisHelper())||void 0===e?void 0:e.getScale)&&(this._fieldY2?h(h([],c(this._fieldY),!1),[this._fieldY2],!1):this._fieldY).forEach((function(t){var e={key:t,operations:[]};gS(n.getYAxisHelper().getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],r.push(e)})),this._fieldZ&&(null===(i=this.getZAxisHelper())||void 0===i?void 0:i.getScale)&&this._fieldZ.forEach((function(t){var e={key:t,operations:[]};gS(n.getZAxisHelper().getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],r.push(e)})),this.getStack()&&r.push({key:this.getStackValueField(),operations:["allValid"]}),r},e.prototype.getGroupFields=function(){return"vertical"===this.direction?this._fieldX:this._fieldY},e.prototype.getStackGroupFields=function(){return this.getGroupFields()},e.prototype.getStackValue=function(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:"".concat(bw,"_series_").concat(this.type,"_").concat(("horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper()).getAxisId())},e.prototype.getStackValueField=function(){return"vertical"===this.direction?lt(this._spec.yField)[0]:lt(this._spec.xField)[0]},e.prototype.setValueFieldToStack=function(){"vertical"===this.direction?(this.setFieldY(pV),this.setFieldY2(fV)):(this.setFieldX(pV),this.setFieldX2(fV))},e.prototype.setValueFieldToPercent=function(){"vertical"===this.direction?(this.setFieldY(yV),this.setFieldY2(vV)):(this.setFieldX(yV),this.setFieldX2(vV))},e.prototype.setValueFieldToStackOffsetSilhouette=function(){"vertical"===this.direction?(this.setFieldY(mV),this.setFieldY2(gV)):(this.setFieldX(mV),this.setFieldX2(gV))},e.prototype.onXAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onYAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onZAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.setAttrFromSpec=function(){var e,i;t.prototype.setAttrFromSpec.call(this),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=lt(this._spec.xField),this._specYField=lt(this._spec.yField),T(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null===(e=this._spec)||void 0===e?void 0:e.x2Field),this.setFieldY2(null===(i=this._spec)||void 0===i?void 0:i.y2Field),this._stack&&this.setValueFieldToStack(),this._percent&&this.setValueFieldToPercent(),this._stackOffsetSilhouette&&this.setValueFieldToStackOffsetSilhouette(),T(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},e.prototype.dataToPosition=function(t){return t?{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null},e.prototype._buildMarkAttributeContext=function(){var e=this;t.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=function(t){var i,n,r;return void 0===t&&(t=0),null!==(r=null===(n=(i=e.getXAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,t))&&void 0!==r?r:0},this._markAttributeContext.yBandwidth=function(t){var i,n,r;return void 0===t&&(t=0),null!==(r=null===(n=(i=e.getYAxisHelper()).getBandwidth)||void 0===n?void 0:n.call(i,t))&&void 0!==r?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)},e.prototype.valueToPosition=function(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}},e.prototype._axisPosition=function(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(lt(e),this._scaleConfig)},e.prototype.valueToPositionX=function(t,e){return this._axisPosition(this._xAxisHelper,t,e)},e.prototype.valueToPositionY=function(t,e){return this._axisPosition(this._yAxisHelper,t,e)},e.prototype.dataToPositionX=function(t){var e=this;if(this._positionXEncoder)return this._positionXEncoder(t);if(!this._xAxisHelper)return this._positionXEncoder=function(t){return Number.NaN},Number.NaN;var i=this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._fieldX;return i&&0!==i.length?(this._xAxisHelper.isContinuous?this._positionXEncoder=function(t){return e._scaleConfig.datum=t,e._xAxisHelper.valueToPosition(e.getDatumPositionValue(t,i[0]),e._scaleConfig)}:this._positionXEncoder=function(t){return e._scaleConfig.datum=t,e._xAxisHelper.dataToPosition(lt(e.getDatumPositionValues(t,i)),e._scaleConfig)},this._positionXEncoder(t)):(this._positionXEncoder=function(t){return null},null)},e.prototype.dataToPositionY=function(t){var e=this;if(this._positionYEncoder)return this._positionYEncoder(t);if(!this._yAxisHelper)return this._positionYEncoder=function(t){return Number.NaN},Number.NaN;var i=this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._fieldY;return i&&0!==i.length?(this._yAxisHelper.isContinuous?this._positionYEncoder=function(t){return e._scaleConfig.datum=t,e._yAxisHelper.valueToPosition(e.getDatumPositionValue(t,i[0]),e._scaleConfig)}:this._positionYEncoder=function(t){return e._scaleConfig.datum=t,e._yAxisHelper.dataToPosition(lt(e.getDatumPositionValues(t,i)),e._scaleConfig)},this._positionYEncoder(t)):(this._positionYEncoder=function(t){return null},null)},e.prototype.dataToPositionZ=function(t){return this._zAxisHelper?(0,this._zAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition}):Number.NaN},e.prototype.dataToPositionX1=function(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN},e.prototype.dataToPositionY1=function(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN},e.prototype.positionToData=function(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null},e.prototype.positionToDataX=function(t){return this._scaleX?this._scaleX.invert(t):null},e.prototype.positionToDataY=function(t){return this._scaleY?this._scaleY.invert(t):null},e.prototype.getRegionRectLeft=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[0]:Number.NaN},e.prototype.getRegionRectRight=function(){return this._xAxisHelper?(0,this._xAxisHelper.getScale)(0).range()[1]:Number.NaN},e.prototype.afterInitMark=function(){t.prototype.afterInitMark.call(this),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._trigger.setStateKeys(h(h([],c(this._fieldX),!1),c(this._fieldY),!1)),this._buildScaleConfig()},e.prototype.getDimensionField=function(){return"vertical"===this._direction?this._specXField:this._specYField},e.prototype.getMeasureField=function(){return"vertical"===this._direction?this._specYField:this._specXField},e.prototype.viewDataUpdate=function(e){t.prototype.viewDataUpdate.call(this,e),this.sortDataByAxis&&this._sortDataInAxisDomain()},e.prototype._sortDataInAxisDomain=function(){var t,e,i;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&(vX("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null===(i=this._data)||void 0===i||i.updateData(!0))},e.prototype.reInit=function(e){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),t.prototype.reInit.call(this,e)},e}(pX),mX="monotone",_X="linear",bX=function(){function e(){}return e.prototype.addSamplingCompile=function(){if(this._spec.sampling){var t=this._region.getLayoutRect(),e=t.width,i=t.height,n=[],r=this._fieldY,o=this._fieldX;n.push({type:"sampling",size:"vertical"===this._direction?e:i,factor:this._spec.samplingFactor,yfield:"vertical"===this._direction?r[0]:o[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(n)}},e.prototype.addOverlapCompile=function(){var t;if(this._spec.markOverlap){var e=[];e.push({type:"markoverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null===(t=this._symbolMark)||void 0===t||t.getProduct().transform(e)}},e.prototype.reCompileSampling=function(){this._spec.sampling&&this.compile()},e.prototype.initLineMark=function(t,e){var i;return this._lineMark=this._createMark(vG.line,{defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:null==e||e,progressive:t,customShape:null===(i=this._spec.line)||void 0===i?void 0:i.customShape}),this._lineMark},e.prototype.initLineMarkStyle=function(e,i){var n,r,o=this,a=this._lineMark;if(a){if(this.setMarkStyle(a,{stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(a,{defined:this._getInvalidDefined,connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===o}},(function(){o.encodeDefined(a,"defined")})),"polar"===this.coordinate)this.setMarkStyle(a,{lineJoin:"bevel",curveType:_X,closePath:!0},"normal",t.AttributeLevel.Series);else{var s=null!=i?i:null===(r=null===(n=this.getSpec().line)||void 0===n?void 0:n.style)||void 0===r?void 0:r.curveType,l=s===mX?"vertical"===e?"monotoneX":"monotoneY":s;this.setMarkStyle(a,{curveType:l},"normal",t.AttributeLevel.Built_In)}this.setMarkStyle(a,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series),this._trigger.registerMark(a)}return a},e.prototype._getEventElement=function(t,e){var i=this,n=[];return t.dimensionInfo.some((function(t){return t.data.some((function(t){return t.series===i&&(n=t.datum,!0)})),!n.length})),n},e.prototype._dimensionTrigger=function(t){var e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}},e.prototype.initSymbolMark=function(t,e){var i,n,r;if(!1!==(null===(i=this._spec.point)||void 0===i?void 0:i.visible)&&(this._symbolMark=this._createMark(vG.point,{morph:cX(this._spec,vG.point.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,progressive:t,isSeriesMark:!!e,customShape:null===(n=this._spec.point)||void 0===n?void 0:n.customShape})),!0===this._spec.activePoint){var o=new Ma(this._option.dataSet,{name:"".concat(bw,"_series_").concat(this.id,"_active_point")});o.parse([]),this._symbolActiveMark=this._createMark({name:"active_point",type:"symbol"},{morph:!1,groupKey:this._seriesField,isSeriesMark:!1,dataView:o,parent:this._region.getInteractionMark(),customShape:null===(r=this._spec.point)||void 0===r?void 0:r.customShape}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark},e.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;if(!e)return this._initSymbolActiveMarkAlone(),e;if(this._initSymbolMark(e),this._trigger.registerMark(e),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(var i in this._symbolActiveMark.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(var n in this._symbolActiveMark.stateStyle[i]={},this._symbolMark.stateStyle[i])this._symbolActiveMark.stateStyle[i][n]={style:null,level:t.AttributeLevel.Series,referer:e};this._symbolActiveMark.state.changeStateInfo({stateValue:MY.STATE_DIMENSION_HOVER,filter:function(){return!0}})}return e},e.prototype._initSymbolMark=function(e){var i=this;e&&(this.setMarkStyle(e,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===i}},(function(){i.encodeDefined(e,"visible")})),this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series))},e.prototype._initSymbolActiveMarkAlone=function(){var e,i,n=this._symbolActiveMark;n&&(this._initSymbolMark(n),n&&(null===(i=null===(e=this._spec[vG.point.name])||void 0===e?void 0:e.state)||void 0===i?void 0:i.dimension_hover)&&(n.setVisible(!0),this.event.on(t.DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(n,$W({},this._spec[vG.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:MY.STATE_DIMENSION_HOVER,filter:function(){return!0}})))},e.prototype.initLabelMarkStyle=function(e){var i,n=this;e&&("symbol"!==(null===(i=e.getTarget())||void 0===i?void 0:i.type)&&e.setRule("line-data"),this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[n.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===n}},(function(){n.encodeDefined(e,"visible")})))},e.prototype.initLineLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getSeriesField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},e.prototype.encodeDefined=function(e,i){var n,r,o,a,s,l,u,c;if(e){var h=null===(a=null===(o=this.getViewDataStatistics())||void 0===o?void 0:o.latestData)||void 0===a?void 0:a[this.getStackValueField()];if("zero"===this._invalidType||h&&(null==h?void 0:h.allValid)){if(!0===(null===(l=null===(s=e.stateStyle.normal)||void 0===s?void 0:s[i])||void 0===l?void 0:l.style))return;this.setMarkStyle(e,((n={})[i]=!0,n),"normal",t.AttributeLevel.Series)}else{if(!0!==(null===(c=null===(u=e.stateStyle.normal)||void 0===u?void 0:u[i])||void 0===c?void 0:c.style))return;this.setMarkStyle(e,((r={})[i]=this._getInvalidDefined,r),"normal",t.AttributeLevel.Series)}e.getProduct()&&e.compileEncode()}},e}(),xX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setStyle=function(t,e,i,n){var r=this;if(void 0===e&&(e="normal"),void 0===i&&(i=0),void 0===n&&(n=this.stateStyle),!w(t)){void 0===n[e]&&(n[e]={});var o=this._getIgnoreAttributes(),a=["strokeWidth","lineWidth","lineDash","strokeDash","lineJoin","stroke","strokeOpacity","opacity","fill","fillOpacity","texture","texturePadding","textureSize","textureColor"],s=this.isUserLevel(i),l=!1;Object.keys(t).forEach((function(u){var c=t[u];if(!w(c)&&!o.includes(u)){s&&a.includes(u)&&(mS(null==c?void 0:c.type)||(null==c?void 0:c.scale)||A(c))&&(l=!0);var h=r._styleConvert(c);s&&"angle"===u&&(h=r.convertAngleToRadian(h)),r.setAttribute(u,h,e,i,n)}})),l&&this.setEnableSegments(l)}},e}(vK),kX=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return r(i,e),i.prototype._getDefaultStyle=function(){return o(o({},e.prototype._getDefaultStyle.call(this)),{lineWidth:1})},i.prototype._getIgnoreAttributes=function(){var e,i;return(null===(e=this.model)||void 0===e?void 0:e.type)===t.SeriesTypeEnum.radar&&"polar"===(null===(i=this.model)||void 0===i?void 0:i.coordinate)?[]:["fill","fillOpacity"]},i.type="line",i}(xX),SX=function(){FU.registerMark(kX.type,kX),jL(),wL(),gT.registerGraphic(sw.line,ly),EK()},AX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})},e}(vK),wX=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.type="symbol",e}(AX),TX=function(){FU.registerMark(wX.type,wX),tH()},MX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){var e,i,n;!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(n=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===n?void 0:n.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)},e}(fX),CX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.line,i.transformerConstructor=MX,i._sortDataByAxis=!1,i}return r(i,e),i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},i=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"line";this.initLineMark(e,"line"===i),this.initSymbolMark(e,"point"===i)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._lineMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._lineMark),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.initMarkStyle=function(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._lineMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("line"))||void 0===i?void 0:i(r,o),sX("line",this._spec,this._markAttributeContext))),this._symbolMark){var a=yX(this);this._symbolMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),sX("point",this._spec,this._markAttributeContext),a))}},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e,i=this,n="point"!==(null===(e=this._spec)||void 0===e?void 0:e.seriesMark);return function(e){var r,o;return n&&"fill"===e&&(e="stroke"),null!==(o=null===(r=i._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==o?o:void 0}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._lineMark,this._symbolMark]},i.type=t.SeriesTypeEnum.line,i.mark=yG,i.transformerConstructor=MX,i}(gX);ot(CX,bX);var EX=function(){WH(),UH(),SX(),TX(),TK(),AK(),FU.registerSeries(CX.type,CX)},RX=function(){function t(t,e){this._dataArr=[],this._onError=e,this._dataSet=t}return Object.defineProperty(t.prototype,"dataList",{get:function(){return this._dataArr},enumerable:!1,configurable:!0}),t.prototype.parseData=function(t){this._dataArr=[];for(var e=lt(t),i=0;i<e.length;i++)this._dataArr.push(xY(e[i],this._dataSet,this._dataArr,{onError:this._onError}))},t.prototype.updateData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);var n=lt(t);return(!e||n.length===this._dataArr.length)&&(this._dataValueForEach(n,(function(t,e){e.markRunning()})),this._dataValueForEach(n,(function(t,e){kY(e,t,i)})),!0)},t.prototype._dataValueForEach=function(t,e){var i=this;t.forEach((function(t,n){if(!(t instanceof Ma)){var r=i.getSeriesData(t.id,n);r&&e(t,r,n)}}))},t.prototype.getSeriesData=function(t,e){var i,n;if(!this._dataArr.length)return null;if("string"==typeof t){var r=this._dataArr.filter((function(e){return e.name===t}));return r[0]?r[0]:(null===(i=this._onError)||void 0===i||i.call(this,"no data matches dataId ".concat(t,"!")),null)}return"number"==typeof e?this._dataArr[e]?this._dataArr[e]:(null===(n=this._onError)||void 0===n||n.call(this,"no data matches dataIndex ".concat(e,"!")),null):this._dataArr[0]},t}(),PX=function(){function t(t,e){var i=this;this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=function(t){var e=[];return i._scaleSpecMap.forEach((function(i,n){$k(i.domain)&&i.domain.forEach((function(n){n.dataId===t&&n.fields.forEach((function(t){SU(e,[{key:t,operations:gS(i.type)?["max","min"]:["values"]}])}))}))})),i._markAttributeScaleMap.forEach((function(n,r){var o=i.getScale(r);n.forEach((function(n){i._getSeriesBySeriesId(n.seriesId).getRawData().name===t&&n.field&&SU(e,[{key:n.field,operations:gS(o.type)?["max","min"]:["values"]}])}))})),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}return t.prototype._createFromSpec=function(t){if(!t.id)return null;var e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?oW("colorOrdinal"):oW(t.type)),e?(B(t.range)&&e.range(t.range),B(t.domain)&&($k(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),e):null},t.prototype._setAttrFromSpec=function(){var t,e=this;if(null===(t=this._spec)||void 0===t?void 0:t.length){var i=new Map,n=new Map;this._spec.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._modelScaleSpecMap.forEach((function(t){var r=e._createFromSpec(t);r&&(i.set(t.id,r),n.set(t.id,t))})),this._scaleSpecMap=n,this._scaleMap=i}},t.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(nt(t,this._spec))return e;e.change=!0;for(var i=function(i){var r=t[i],o=n._scaleMap.get(r.id);if(!o)return e.reMake=!0,{value:e};var a=n._spec.find((function(t){return t.id===r.id}));return a.id?a.type!==r.type?(e.reMake=!0,{value:e}):(r.range&&!nt(r.range,o.range())&&(o.range(r.range),e.reRender=!0),$k(r.domain)?e.reRender=!0:nt(r.domain,o.domain())||(o.domain(r.domain),e.reRender=!0),void n._scaleSpecMap.set(r.id,r)):(e.reMake=!0,{value:e})},n=this,r=0;r<t.length;r++){var o=i(r);if("object"==typeof o)return o.value}return this._spec=t,e},t.prototype.registerModelScale=function(t){var e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))},t.prototype.removeModelScale=function(t){var e=this;this._modelScaleSpecMap.forEach((function(i){t(i)&&(e._modelScaleSpecMap.delete(i.id),e._scaleSpecMap.delete(i.id),e._scaleMap.delete(i.id))}))},t.prototype.getScale=function(t){return this._scaleMap.get(t)},t.prototype.getScaleSpec=function(t){return this._scaleSpecMap.get(t)},t.prototype._getSeriesByRawDataId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.getRawData().name===t)return n}return null},t.prototype._getSeriesBySeriesId=function(t){for(var e=this._chart.getAllSeries(),i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}return null},t.prototype.updateScaleDomain=function(t){var e=this;this._scaleSpecMap.forEach((function(i,n){var r=e._scaleMap.get(n);if(r){if(!$k(i.domain))return i.domain&&0!==i.domain.length||r.domain(t),void e._updateMarkScale(n,r,r.domain().slice());var o;o=gS(i.type)?[null,null]:new Set,i.domain.forEach((function(t){var n=e._getSeriesByRawDataId(t.dataId);if(n){var r=gS(i.type);t.fields.forEach((function(t){var e=n.getRawDataStatisticsByField(t,r);e&&(r?(w(o[0])?o[0]=e.min:o[0]=Math.min(e.min,o[0]),w(o[1])?o[1]=e.max:o[1]=Math.max(e.max,o[1])):e.values.forEach((function(t){o.add(t)})))}))}}));var a=o;gS(i.type)||(o=Array.from(o)),r.domain(o),e._updateMarkScale(n,r,a)}}))},t.prototype._updateMarkScale=function(t,e,i){var n=this,r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach((function(t){if(t.field&&t.markScale&&t.markScale!==e)if(w(t.changeDomain)||"none"===t.changeDomain||w(t.seriesId))gS(e.type)?t.markScale.domain(i):e.domain(Array.from(i));else{var r=n._getSeriesBySeriesId(t.seriesId),o=gS(e.type),a=r.getRawDataStatisticsByField(t.field,o);if(!W(a))return"expand"===t.changeDomain?(o?(i[0]=Math.min(i[0],a.min),i[1]=Math.max(i[1],a.max)):(a.values.forEach((function(t){i.add(t)})),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(o?t.markScale.domain([a.min,a.max]):t.markScale.domain(a.values)));gS(e.type)?t.markScale.domain(i):e.domain(Array.from(i))}}))},t.prototype.registerMarkAttributeScale=function(t,e){var i=this._scaleMap.get(t.scale),n=this._markAttributeScaleMap.get(t.scale);n||(n=[],this._markAttributeScaleMap.set(t.scale,n));var r=i;return(w(t.field)||!w(t.changeDomain)&&"none"!==t.changeDomain&&!w(e))&&(r=i.clone()),n.push(o(o({},t),{seriesId:e,markScale:r})),r},t}(),BX=function(){function e(t){this.stackRegion=function(t){var e=t.model,i=e.getSeries(),n=i.some((function(t){return t.getStack()}));if(n){var r=i.some((function(t){var e,i;return null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.totalLabel)||void 0===i?void 0:i.visible})),o=r||i.some((function(t){return t.getPercent()})),a=i.some((function(t){return t.getStackOffsetSilhouette()})),s=TU(e,!0);for(var l in s)for(var u in s[l].nodes)EU(s[l].nodes[u],e.getStackInverse(),o);if(a)for(var l in s)for(var u in s[l].nodes)CU(s[l].nodes[u]);r&&e.getSeries().forEach((function(t){var e=t.getStackData(),i=t.getStackValue(),n=t.getStackValueField();e&&n&&MU(s[i],n)}))}},this._chart=t}return e.prototype.init=function(){var e=this;this._chart.getAllRegions().forEach((function(i){i.event.on(t.ChartEvent.regionSeriesDataFilterOver,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},e.stackRegion)}))},e.prototype.stackAll=function(){var t=this;this._chart.getAllRegions().forEach((function(e){t.stackRegion({model:e})}))},e}(),LX=function(e){function i(t,i){var n,r,a,s,l=this;return(l=e.call(this,i)||this).type="chart",l.id=Jk(),l._regions=[],l._series=[],l._components=[],l._layoutRect={x:0,y:0,width:xw,height:kw},l._viewRect={width:xw,height:kw},l._viewBox={x1:0,y1:0,x2:xw,y2:kw},l._layoutTag=!0,l._idMap=new Map,l.state={layoutUpdateRank:1},l.padding={top:0,left:0,right:0,bottom:0},l.getAllSeries=function(){var t;return null!==(t=l._series)&&void 0!==t?t:[]},l.getRegionsInIndex=function(t){return t&&0!==t.length?l._regions.filter((function(e,i){return t.includes(i)})):[l._regions[0]]},l.getAllRegions=function(){return l._regions},l.getRegionsInIds=function(t){return t?l._regions.filter((function(e){return t.includes(e.id)})):[]},l.getRegionsInQuerier=function(t){return t?l._regions.filter((function(e,i){return lt(t).some((function(t){return T(t.regionId)&&t.regionId===e.userId||t.regionIndex===i}))})):l._regions},l.getRegionsInUserId=function(t){if(t)return l._regions.find((function(e){return e.userId===t}))},l.getRegionsInUserIdOrIndex=function(t,e){return l.getAllRegions().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},l.getComponents=function(){return l._components},l.getSeriesInIndex=function(t){return t&&0!==t.length?l._series.filter((function(e,i){return t.includes(i)})):[l._series[0]]},l.getSeriesInIds=function(t){return t?l._series.filter((function(e){return t.includes(e.id)})):[]},l.getSeriesInUserId=function(t){if(t)return l._series.find((function(e){return e.userId===t}))},l.getSeriesInUserIdOrIndex=function(t,e){return l.getAllSeries().filter((function(i){return(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())}))},l.getComponentByIndex=function(t,e){var i=l._components.filter((function(e){return(e.specKey||e.type)===t}));if(i&&0!==i.length)return i[e]},l.getComponentsByKey=function(t){return l._components.filter((function(e){return(e.specKey||e.type)===t}))},l.getComponentByUserId=function(t){var e=l._components.find((function(e){return e.userId===t}));if(e)return e},l._paddingSpec=dW(null!==(n=t.padding)&&void 0!==n?n:i.getTheme().padding),l._event=new sY(i.eventDispatcher,i.mode),l._dataSet=i.dataSet,l._chartData=new RX(l._dataSet,null===(r=l._option)||void 0===r?void 0:r.onError),l._modelOption=o(o({},i),{mode:l._option.mode,map:l._idMap,getChartLayoutRect:function(){return l._layoutRect},getChartViewRect:function(){return l._viewRect},getChart:function(){return l},globalScale:l._globalScale,onError:null===(a=l._option)||void 0===a?void 0:a.onError,disableTriggerEvent:!0===(null===(s=l._option)||void 0===s?void 0:s.disableTriggerEvent),getSeriesData:l._chartData.getSeriesData.bind(l._chartData)}),l._spec=t,l}return r(i,e),i.prototype.getSpec=function(){return this._spec},i.prototype.setSpec=function(t){this._spec=t},i.prototype.getOption=function(){return this._option},i.prototype.getLayoutRect=function(){return this._layoutRect},i.prototype.getViewRect=function(){return this._viewRect},i.prototype.getLayoutTag=function(){return this._layoutTag},i.prototype.setLayoutTag=function(t,e,i){var n;return void 0===i&&(i=!0),this._layoutTag=t,(null===(n=this.getCompiler())||void 0===n?void 0:n.getVGrammarView())&&(this.getCompiler().getVGrammarView().updateLayoutTag(),t&&i&&this.getCompiler().renderAsync(e)),this._layoutTag},i.prototype.getEvent=function(){return this._event},Object.defineProperty(i.prototype,"chartData",{get:function(){return this._chartData},enumerable:!1,configurable:!0}),i.prototype.created=function(){this._transformer=new this.transformerConstructor({type:this.type,seriesType:this.seriesType,getTheme:this._option.getTheme,animation:this._option.animation}),this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._spec.background&&"object"==typeof this._spec.background&&this._createBackground(),this._createLayout(),this._transformer.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),this._transformer.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),this._transformer.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())},i.prototype.init=function(){var t=this;this._regions.forEach((function(t){return t.init({})})),this._series.forEach((function(t){return t.init({})})),this._components.forEach((function(e){return e.init({dataSet:t._dataSet})})),this._initEvent(),this._canStack&&(this._stack=new BX(this),this._stack.init()),this.reDataFlow()},i.prototype.reDataFlow=function(){this._series.forEach((function(t){var e;return null===(e=t.getRawData())||void 0===e?void 0:e.markRunning()})),this._series.forEach((function(t){return t.fillData()})),this.updateGlobalScaleDomain()},i.prototype.onResize=function(t,e,i){void 0===i&&(i=!0);var n={width:t,height:e};this._canvasRect=n,this._updateLayoutRect(this._option.viewBox),this.setLayoutTag(!0,null,i)},i.prototype.updateViewBox=function(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.setLayoutTag(!0,null,e)},i.prototype._createBackground=function(){var t=this,e=function(t){if(!t)return null;if("string"==typeof t)return{fill:t,fillOpacity:1};if("object"!=typeof t)return null;var e=$(t,["x","y","width","height","x1","y1","image"]);return e.background=t.image,e}(this._spec.background);e&&(this._backgroundMark=FU.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(o(o({},e),{x:function(){return t._viewBox.x1},y:function(){return t._viewBox.y1},width:function(){return t._viewBox.x2-t._viewBox.x1},height:function(){return t._viewBox.y2-t._viewBox.y1}})))},i.prototype._createRegion=function(t,e){if(t){var i=e.spec,n=a(e,["spec"]),r=new t(i,o(o({},this._modelOption),n));r&&(r.created(),this._regions.push(r))}},i.prototype._createSeries=function(t,e){if(t){var i,n=e.spec,r=a(e,["spec"]);if(T(n.regionId)?i=this.getRegionsInUserId(n.regionId):T(n.regionIndex)&&(i=this.getRegionsInIndex([n.regionIndex])[0]),i||(i=this._regions[0])){var s=new t(n,o(o(o({},this._modelOption),r),{type:n.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));s&&(s.created(),this._series.push(s),i.addSeries(s))}}},i.prototype.getSeriesById=function(t){return this._series.find((function(e){return e.id===t}))},i.prototype._createComponent=function(t,e){var i=t.createComponent(e,o(o({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey}));i&&(i.created(),this._components.push(i))},i.prototype.getAllComponents=function(){return this._components},i.prototype.getAllModels=function(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())},i.prototype.getModelInFilter=function(t){if(P(t))return this.getAllModels().find((function(e){return e.userId===t}));if(A(t))return this.getAllModels().find((function(e){return t(e)}));var e=0;return this.getAllModels().find((function(i){var n;if((null!==(n=i.specKey)&&void 0!==n?n:i.type)===t.type){if(e===t.index)return!0;e++}return!1}))},i.prototype._createLayout=function(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()},i.prototype.setLayout=function(t){this._option.layout=t,this._initLayoutFunc()},i.prototype._initLayoutFunc=function(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){var n=!1;(this._spec.zField||this._spec.series&&this._spec.series.some((function(t){return t.zField})))&&(n=!0);var r=FU.getLayoutInKey(null!==(e=null===(t=this._spec.layout)||void 0===t?void 0:t.type)&&void 0!==e?e:n?"layout3d":"base");if(r){var o=new r(this._spec.layout,{onError:null===(i=this._option)||void 0===i?void 0:i.onError});this._layoutFunc=o.layoutItems.bind(o)}}},i.prototype.layout=function(e){var i,n,r,o;if(null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.beforeLayoutWithSceneGraph)||void 0===n||n.call(i),this.getLayoutTag()){this._event.emit(t.ChartEvent.layoutStart,{chart:this}),this.onLayoutStart(e);var a=this.getLayoutElements();this._layoutFunc(this,a,this._layoutRect,this._viewBox),this._event.emit(t.ChartEvent.afterLayout,{elements:a}),this.setLayoutTag(!1),this.onLayoutEnd(e),this._event.emit(t.ChartEvent.layoutEnd,{chart:this})}null===(o=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterLayoutWithSceneGraph)||void 0===o||o.call(r)},i.prototype.onLayoutStart=function(t){var e=this;this.getAllModels().forEach((function(i){return i.onLayoutStart(e._layoutRect,e._viewRect,t)}))},i.prototype.onLayoutEnd=function(t){this.getAllModels().forEach((function(e){return e.onLayoutEnd(t)}))},i.prototype.onEvaluateEnd=function(t){h(h(h([],c(this._components),!1),c(this._regions),!1),c(this._series),!1).forEach((function(e){return e.onEvaluateEnd(t)}))},i.prototype.getLayoutElements=function(){return this.getAllModels().map((function(t){return t.layout})).filter((function(t){return!!t}))},i.prototype.getModelById=function(t){var e=this._idMap.get(t);if(e&&e instanceof qY)return e},i.prototype.getModelByUserId=function(t){var e=this._series.find((function(e){return e.userId===t}));if(e)return e;var i=this._regions.find((function(e){return e.userId===t}));if(i)return i;var n=this._components.find((function(e){return e.userId===t}));return n||void 0},i.prototype.getAllMarks=function(){return Array.from(this._idMap.values()).filter((function(t){return t&&t instanceof vK}))},i.prototype.getMarkById=function(t){var e=this._idMap.get(t);if(e&&e instanceof vK)return e},i.prototype.updateData=function(t,e,i,n){void 0===i&&(i=!0);var r=this._dataSet.getDataView(t);r&&(r.markRunning(),r.parseNewData(e,n)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.updateFullData=function(t,e){var i=this;void 0===e&&(e=!0),lt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&e.markRunning()})),lt(t).forEach((function(t){var e=i._dataSet.getDataView(t.id);e&&kY(e,t,!0)})),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach((function(t){return t.onDataUpdate()}))},i.prototype.onRender=function(t){},i.prototype.setCanvasRect=function(t,e){this._canvasRect={width:t,height:e}},i.prototype.getCanvasRect=function(){return this._canvasRect||(this._canvasRect=LY(this._spec,this._option,{width:xw,height:kw})),this._canvasRect},i.prototype.getSeriesData=function(t,e){return this._chartData.getSeriesData(t,e)},i.prototype._transformSpecScale=function(){var t,e,i=null!==(t=this._spec.scales)&&void 0!==t?t:[],n=i.find((function(t){return"color"===t.id})),r=this.getColorScheme();if(!n&&(n={type:"ordinal",id:"color",domain:null,range:null},i.push(n),this._spec.color)){var o=this._spec.color;if(B(o))n.range=o;else{var a=o;Object.prototype.hasOwnProperty.call(a,"type")&&(n.type=a.type),Object.prototype.hasOwnProperty.call(a,"domain")&&(n.domain=a.domain),Object.prototype.hasOwnProperty.call(a,"range")&&(n.range=a.range),Object.prototype.hasOwnProperty.call(a,"specified")&&(n.specified=a.specified)}}return(null===(e=n.range)||void 0===e?void 0:e.length)||(n.range=ZG(r),n.rangeTheme=!0),i},i.prototype._createGlobalScale=function(){this._globalScale=new PX(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale},i.prototype.updateGlobalScaleDomain=function(){var t=new Set;this._series.forEach((function(e){var i=e.getSeriesKeys();i&&i.forEach((function(e){return t.add(e)}))}));var e=Array.from(t);this._globalScale.updateScaleDomain(e)},i.prototype.updateGlobalScale=function(t){OY(t,this._globalScale.updateSpec(this._transformSpecScale()))},i.prototype.updateGlobalScaleTheme=function(){var t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=ZG(e),this._globalScale.getScale("color").range(t.range))},i.prototype.updateSpec=function(t){var e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;var i=Object.keys(this._spec).sort(),n=Object.keys(t).sort();if(JSON.stringify(i)!==JSON.stringify(n))return e.reMake=!0,e;var r=this._spec;return this._spec=t,this.updateChartConfig(e,r),e.reMake?e:(this.updateGlobalScale(e),e.reMake?e:(this.updateRegionSpec(e),e.reMake?e:(this.updateComponentSpec(e),e.reMake?e:(this.updateSeriesSpec(e),e.reMake?e:(this.updateDataSpec(e),e.reMake||this.updateGlobalScaleDomain(),e)))))},i.prototype.updateChartConfig=function(t,e){var i,n;this._paddingSpec=dW(null!==(i=this._spec.padding)&&void 0!==i?i:null===(n=this._option)||void 0===n?void 0:n.getTheme().padding),this._updateLayoutRect(this._viewBox),nt(this._spec.background,e.background)||(t.reMake=!0)},i.prototype.updateDataSpec=function(t){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)},i.prototype.updateRegionSpec=function(t){var e,i=this;(null===(e=this._spec)||void 0===e?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach((function(e){OY(t,e.updateSpec(i._spec.region[e.getSpecIndex()]))})):t.reMake=!0)},i.prototype.updateComponentSpec=function(t){var e=this,i={};for(var n in this._components.forEach((function(n){var r,o,a=n.specKey||n.type,s=null!==(r=e._spec[a])&&void 0!==r?r:{};B(s)?(i[a]=i[a]||{specCount:s.length,componentCount:0},i[a].componentCount++,OY(t,n.updateSpec(null!==(o=s[n.getSpecIndex()])&&void 0!==o?o:{},s))):OY(t,n.updateSpec(s))})),i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];r.componentCount!==r.specCount&&(t.reMake=!0)}},i.prototype.updateSeriesSpec=function(t){var e=this;this._spec.series.length===this._series.length?this._series.forEach((function(i){var n=e._spec.series[i.getSpecIndex()];OY(t,i.updateSpec(n))})):t.reMake=!0},i.prototype.getCanvas=function(){var t,e;return null!==(e=null===(t=this.getCompiler())||void 0===t?void 0:t.getCanvas())&&void 0!==e?e:null},i.prototype._updateLayoutRect=function(e){var i=this.getCanvasRect();if(e){this._viewBox=e;var n=e.x1,r=void 0===n?0:n,o=e.y1,a=void 0===o?0:o;i={width:e.x2-r,height:e.y2-a}}else this._viewBox={x1:0,y1:0,x2:i.width,y2:i.height};this._viewRect=i,this.padding=hW(this._paddingSpec,i,i),this._layoutRect.width=i.width-this.padding.left-this.padding.right,this._layoutRect.height=i.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(t.ChartEvent.layoutRectUpdate,{})},i.prototype.setCurrentTheme=function(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this._regions.forEach((function(t){return t.reInit(t.getSpecInfo().spec)})),this._series.forEach((function(t){return t.reInit(t.getSpecInfo().spec)})),this._components.forEach((function(t){return t.reInit(t.getSpecInfo().spec)}))},i.prototype.clear=function(){this.getAllModels().forEach((function(t){var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)}))},i.prototype.compile=function(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()},i.prototype.afterCompile=function(){this.getAllRegions().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllSeries().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})),this.getAllComponents().forEach((function(t){var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}))},i.prototype.compileLayout=function(){var t=this.getCanvasRect(),e=t.width,i=t.height;this.getCompiler().setSize(e,i)},i.prototype.compileBackground=function(){var t;this._backgroundMark&&(this._backgroundMark.compile(),null===(t=this._backgroundMark.getProduct())||void 0===t||t.configure({context:{model:this}}).layout((function(){})))},i.prototype.compileRegions=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeRegionCompile)||void 0===e||e.call(t),this.getAllRegions().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterRegionCompile)||void 0===n||n.call(i)},i.prototype.compileSeries=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeSeriesCompile)||void 0===e||e.call(t),this.getAllSeries().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterSeriesCompile)||void 0===n||n.call(i)},i.prototype.compileComponents=function(){var t,e,i,n;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeComponentCompile)||void 0===e||e.call(t),this.getAllComponents().forEach((function(t){t.compile()})),null===(n=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterComponentCompile)||void 0===n||n.call(i)},i.prototype.release=function(){h(h(h([],c(this._components),!1),c(this._regions),!1),c(this._series),!1).forEach((function(t){t.beforeRelease()})),e.prototype.release.call(this),this.clear(),h(h(h([],c(this._components),!1),c(this._regions),!1),c(this._series),!1).forEach((function(t){t.release()})),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()},i.prototype.onLayout=function(t){var e=t.rootMark;this.layout({group:e,srView:t})},i.prototype.updateState=function(t,e){var i=this.getAllSeries(),n=function(n){if(W(t[n]))return"continue";var r=t[n],a={stateValue:n};a=A(r.filter)?o({filter:r.filter},a):o(o({},r.filter),a),r.level&&(a.level=r.level),i.forEach((function(t){t.getMarks().forEach((function(i){i.stateStyle[n]&&(e&&!e(t,i,n)||(i.state.changeStateInfo(a),i.updateMarkState(n)))}))}))};for(var r in t)n(r)},i.prototype.setSelected=function(t,e,i){this._setStateInDatum(MY.STATE_SELECTED,!0,t,e,i)},i.prototype.setHovered=function(t,e,i){this._setStateInDatum(MY.STATE_HOVER,!0,t,e,i)},i.prototype._initEvent=function(){var e=this;[t.ChartEvent.dataZoomChange,t.ChartEvent.scrollBarChange].forEach((function(i){e._event.on(i,(function(i){if(i.value.filterData){e._disableMarkAnimation(["exit","update"]);var n=function(){e._enableMarkAnimation(["exit","update"]),e._event.off(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_RENDER_END,n)};e._event.on(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_RENDER_END,n)}}))}))},i.prototype._enableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){var i=e.getProduct();i&&i.animate&&i.animate.enableAnimationState(t)}))},i.prototype._disableMarkAnimation=function(t){this.getAllMarks().forEach((function(e){var i=e.getProduct();i&&i.animate&&i.animate.disableAnimationState(t)}))},i.prototype._setStateInDatum=function(t,e,i,n,r){var o=(i=i?lt(i):null)?Object.keys(i[0]):null;this.getRegionsInQuerier(r).forEach((function(r){i?(r.getSeries().forEach((function(e){e.getMarks().forEach((function(a){if(a.getProduct()&&(!n||A(n)&&n(e,a))){var s=a.getProduct().isCollectionMark(),l=a.getProduct().elements,u=l;if(s)u=l.filter((function(t){var e=t.getDatum();i.every((function(t,i){return o.every((function(n){return t[n]==e[i][n]}))}))}));else if(i.length>1){var c=i.slice();u=l.filter((function(t){if(0===c.length)return!1;var e=t.getDatum(),i=c.findIndex((function(t){return o.every((function(i){return t[i]==e[i]}))}));return i>=0&&(c.splice(i,1),!0)}))}else{var h=l.find((function(t){return o.every((function(e){return i[0][e]==t.getDatum()[e]}))}));h&&(u=[h])}u.forEach((function(e){r.interaction.addEventElement(t,e)}))}}))})),e&&r.interaction.reverseEventElement(t)):r.interaction.clearEventElement(t,!0)}))},i.prototype.setDimensionIndex=function(e,i){var n,r,o,a,s=null;Array.from(this._event.getComposedEventMap().values()).forEach((function(n){var r=n.eventType,o=n.event;if(r===t.DimensionEventEnum.dimensionHover||r===t.DimensionEventEnum.dimensionClick){var a=o.dispatch(e,i);(null==a?void 0:a.length)&&(s=a)}}));var l=w(e)||!s||s.every((function(t){return _S(t.axis.getScale().type)&&w(t.index)}));if(!1!==i.tooltip){var u=this._components.find((function(t){return t.type===f.tooltip}));if(null==u?void 0:u.getVisible())if(l)null===(r=(n=u).hideTooltip)||void 0===r||r.call(n);else{var c={};s.forEach((function(t){var e=t.axis,i=t.value,n=t.data,r="left"===e.getOrient()||"right"===e.getOrient();n.forEach((function(t){r?c[t.series.fieldY[0]]=i:c[t.series.fieldX[0]]=i}))})),u.showTooltip(c,i.showTooltipOption)}}if(!1!==i.crosshair){var h=this._components.find((function(t){return t.type===f.cartesianCrosshair}));h&&h.clearAxisValue&&h.setAxisValue&&(l?(null===(o=h.clearAxisValue)||void 0===o||o.call(h),null===(a=h.hide)||void 0===a||a.call(h)):s.forEach((function(t){var e=t.axis,i=t.value;h.clearAxisValue(),h.setAxisValue(i,e),h.layoutByValue()})))}},i.prototype.getColorScheme=function(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme},i}(GY),OX=function(){function t(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}return t.prototype.initChartSpec=function(t){return this.transformSpec(t),this.transformModelSpec(t)},t.prototype.transformSpec=function(t){t.region&&0!==t.region.length||(t.region=[{}]),K(t,"tooltip")||(t.tooltip={}),T(t.stackInverse)&&t.region.forEach((function(e){return!T(e.stackInverse)&&(e.stackInverse=t.stackInverse)}))},t.prototype.transformModelSpec=function(t){var e=this;return this.createSpecInfo(t,(function(i,n,r){var a=n.spec,s=n.specPath,l=n.specInfoPath,u=n.type,c=new i.transformerConstructor({type:u,getTheme:e._option.getTheme}).transformSpec(a,t,r);UA(t,s,c.spec),UA(r,null!=l?l:s,o(o({},n),c))}))},t.prototype.createSpecInfo=function(t,e){var i,n=this;e||(e=function(e,i,r){var a=i.spec,s=i.specPath,l=i.specInfoPath,u=i.type,c=new e.transformerConstructor({type:u,getTheme:n._option.getTheme});UA(r,null!=l?l:s,o(o({},i),{theme:c.getTheme(a,t)}))});var r,a={};return this.forEachRegionInSpec(t,e,a),this.forEachSeriesInSpec(t,e,a),null===(i=a.series)||void 0===i||i.forEach((function(t,e){var i,n,o,s=t.spec,l=s.regionId,u=s.regionIndex;T(l)?r=null===(i=a.region)||void 0===i?void 0:i.find((function(t){return t.spec.id===l})):T(u)&&(r=null===(n=a.region)||void 0===n?void 0:n[u]),(r||(r=null===(o=a.region)||void 0===o?void 0:o[0]))&&(r.seriesIndexes||(r.seriesIndexes=[]),r.seriesIndexes.push(e))})),this.forEachComponentInSpec(t,e,a),a},t.prototype._isValidSeries=function(t){return!0},t.prototype._getDefaultSeriesSpec=function(t){var e,i,n,r;return{dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!==(e=t.animation)&&void 0!==e?e:this._option.animation,animationThreshold:null!==(i=t.animationThreshold)&&void 0!==i?i:null===(r=(n=this._option).getTheme)||void 0===r?void 0:r.call(n).animationThreshold,animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph}},t.prototype.forEachRegionInSpec=function(t,e,i){var n;return(null!==(n=t.region)&&void 0!==n?n:[]).map((function(t,n){return e(FU.getRegionInType("region"),{spec:t,specIndex:n,specPath:["region",n],type:"region"},i)}))},t.prototype.forEachSeriesInSpec=function(t,e,i){var n;return(null!==(n=t.series)&&void 0!==n?n:[]).map((function(t,n){return e(FU.getSeriesInType(t.type),{spec:t,specIndex:n,specPath:["series",n],type:t.type},i)}))},t.prototype.forEachComponentInSpec=function(t,e,i){for(var n,r,o,a,s,l,u,c,h,d=[],p=FU.getComponents(),v=[],y=0;y<p.length;y++){var g=p[y],m=g.cmp,_=g.alwaysCheck;m.type.startsWith(f.cartesianAxis)?s=m:m.type.startsWith(f.polarAxis)?l=m:m.type===f.geoCoordinate?u=m:(_||t[null!==(n=m.specKey)&&void 0!==n?n:m.type])&&(m.type===f.label?c=m:m.type===f.totalLabel&&(h=m),v.push(m))}var b,x=!1;s&&((null==(b=s.getSpecInfo(t))?void 0:b.length)>0&&(x=!0,b.forEach((function(t){var n=FU.getComponentInKey(t.type);d.push(e(n,t,i))}))));l&&!x&&((null==(b=l.getSpecInfo(t))?void 0:b.length)>0&&(x=!0,b.forEach((function(t){var n=FU.getComponentInKey(t.type);d.push(e(n,t,i))}))));return u&&!x&&(null===(r=u.getSpecInfo(t))||void 0===r||r.forEach((function(t){d.push(e(u,t,i))}))),c&&i&&(null===(o=c.getSpecInfo(t,i))||void 0===o||o.forEach((function(t){d.push(e(c,t,i))}))),h&&i&&(null===(a=h.getSpecInfo(t,i))||void 0===a||a.forEach((function(t){d.push(e(h,t,i))}))),v.forEach((function(n){var r;null===(r=n.getSpecInfo(t))||void 0===r||r.forEach((function(t){d.push(e(n,t,i))}))})),d},t}(),IX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!0},e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{xField:e.xField,yField:e.yField,zField:e.zField,seriesField:e.seriesField,seriesStyle:e.seriesStyle,direction:e.direction,stack:e.stack,percent:e.percent,stackOffsetSilhouette:e.stackOffsetSilhouette,totalLabel:e.totalLabel,sortDataByAxis:e.sortDataByAxis}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e.prototype.transformSpec=function(e){var i=this;if(t.prototype.transformSpec.call(this,e),this.needAxes()){e.axes||(e.axes=[]);var n={x:!1,y:!1,z:!1};e.axes.forEach((function(t){var r=t.orient;"top"!==r&&"bottom"!==r||(n.x=!0),"left"!==r&&"right"!==r||(n.y=!0),"z"===r&&(n.z=!0),U(t,"trimPadding")&&$W(t,IY(i.type,e))})),n.x||e.axes.push({orient:"bottom"}),n.y||e.axes.push({orient:"left"}),e.zField&&!n.z&&e.axes.push({orient:"z"})}var r=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(r).forEach((function(e){e in t||(t[e]=r[e])}))})):e.series=[r]},e}(OX),DX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i;return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{point:e.point,line:e.line,seriesMark:null!==(i=e.seriesMark)&&void 0!==i?i:"line",activePoint:e.activePoint,sampling:e.sampling,samplingFactor:e.samplingFactor,pointDis:e.pointDis,pointDisMul:e.pointDisMul,markOverlap:e.markOverlap,lineLabel:e.lineLabel})},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(IX),FX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=DX,i.type="line",i.seriesType=t.SeriesTypeEnum.line,i._canStack=!0,i}return r(i,e),i.type="line",i.seriesType=t.SeriesTypeEnum.line,i.view="singleDefault",i.transformerConstructor=DX,i}(LX),zX=function(){EX(),FU.registerChart(FX.type,FX)},jX=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.prototype._getIgnoreAttributes=function(){return[]},e.type="area",e}(xX),HX=function(){FU.registerMark(jX.type,jX),jL(),vL(),gT.registerGraphic(sw.area,Ny),EK()},NX=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._getSeriesStyle=function(t,i,n){var r,o,a,s,l,c;try{for(var h=u(lt(i)),d=h.next();!d.done;d=h.next()){var f=d.value,p=null===(a=e.series.getSeriesStyle(t))||void 0===a?void 0:a(f);if(!1!==p||"fill"!==f&&"stroke"!==f||(p="fill"===f?null===(l=null===(s=e.series.getSeriesStyle(t))||void 0===s?void 0:s("stroke"))||void 0===l?void 0:l[0]:null===(c=e.series.getSeriesStyle(t))||void 0===c?void 0:c("fill")),T(p))return p}}catch(t){r={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}return n},e}return r(e,t),e}(YK),VX={type:"clipIn"},GX={type:"fadeIn"};function WX(t,e){if(!1===e)return{};switch(e){case"grow":return function(t){return{type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}}(t);case"fadeIn":return GX;default:return VX}}var UX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(e){var i,n,r;t.prototype._transformLabelSpec.call(this,e),this._addMarkLabelSpec(e,"area","areaLabel","initLineLabelMarkStyle",void 0,!0),!1!==(null===(i=e.point)||void 0===i?void 0:i.visible)&&!1!==(null===(r=null===(n=e.point)||void 0===n?void 0:n.style)||void 0===r?void 0:r.visible)||this._addMarkLabelSpec(e,"area")},e.prototype._transformSpecAfterMergingTheme=function(e,i,n){var r,o,a,s,l;t.prototype._transformSpecAfterMergingTheme.call(this,e,i,n);var u=e.area,c=void 0===u?{}:u,h=e.line,d=void 0===h?{}:h,f=e.seriesMark,p=void 0===f?"area":f,v=!1!==c.visible&&!1!==(null===(r=c.style)||void 0===r?void 0:r.visible),y=!1!==d.visible&&!1!==(null===(o=d.style)||void 0===o?void 0:o.visible);c.interactive=!(!c.interactive&&null!==(a=d.interactive)&&void 0!==a&&!a),c.support3d=!(!c.support3d&&!d.support3d),c.zIndex=T(c.zIndex)||T(d.zIndex)?Math.max(null!==(s=c.zIndex)&&void 0!==s?s:0,null!==(l=d.zIndex)&&void 0!==l?l:0):void 0,c.style&&delete c.style.stroke,c.state&&Object.keys(c.state).forEach((function(t){"style"in c.state[t]?delete c.state[t].style.stroke:delete c.state[t].stroke}));var g=c,m=d;("line"===p||y&&!v)&&(g=d,m=c),c.style=$W({},m.style,g.style),c.state=$W({},m.state,g.state),v||(c.style.fill=!1),y||(c.style.stroke=!1),c.visible=!(!v&&!y),e.area=c,e.line=d},e}(MX),YX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.area,i.transformerConstructor=UX,i._supportStack=!0,i._sortDataByAxis=!1,i}return r(i,e),i.prototype.initMark=function(){var t,e,n,r,o,a={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},s=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(n=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===n?void 0:n.visible),l=null!==(r=this._spec.seriesMark)&&void 0!==r?r:"area";this._areaMark=this._createMark(i.mark.area,{groupKey:this._seriesField,defaultMorphElementKey:this.getDimensionField()[0],progressive:a,isSeriesMark:s&&"point"!==l,customShape:null===(o=this._spec.area)||void 0===o?void 0:o.customShape}),this.initSymbolMark(a,"point"===l)},i.prototype.initMarkStyle=function(){var e,i,n,r,o,a=this,s=null!==(n=null===(i=null===(e=this.getSpec().area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.curveType)&&void 0!==n?n:null===(o=null===(r=this.getSpec().line)||void 0===r?void 0:r.style)||void 0===o?void 0:o.curveType,l=s===mX?"vertical"===this._direction?"monotoneX":"monotoneY":s,u=this._areaMark;u&&("vertical"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),y1:function(t){var e,i;return aW(a.dataToPositionY1(t),null===(i=null===(e=a._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:function(t){var e,i;return aW(a.dataToPositionX1(t),null===(i=null===(e=a._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{fill:this.getColorAttribute(),stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(u,{defined:this._getInvalidDefined,connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{curveType:l},"normal",t.AttributeLevel.Built_In),this._trigger.registerMark(u),Object.keys(u.stateStyle).forEach((function(t){u.stateStyle[t].stroke&&u.setPostProcess("stroke",(function(t){return[t,!1,!1,!1]}),t)}))),this.initLineMarkStyle(this._direction,s),this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},o=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("line"))||void 0===e?void 0:e(r,o),sX("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("area"))||void 0===i?void 0:i(r,o),sX("area",this._spec,this._markAttributeContext))),this._symbolMark){var a=yX(this);this._symbolMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("scaleInOut"))||void 0===n?void 0:n(),sX("point",this._spec,this._markAttributeContext),a))}},i.prototype.initTooltip=function(){this._tooltipHelper=new NX(this),this._areaMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._areaMark),this._lineMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._lineMark),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.viewDataStatisticsUpdate=function(t){e.prototype.viewDataStatisticsUpdate.call(this,t),this.encodeDefined(this._areaMark,"defined")},i.prototype.compile=function(){e.prototype.compile.call(this),this.addSamplingCompile(),this.addOverlapCompile()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.reCompileSampling()},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,o,a,s,l=null!==(n=e._spec.seriesMark)&&void 0!==n?n:"area",u=null!==(o=null===(r=e._seriesMark)||void 0===r?void 0:r.getAttribute(i,t))&&void 0!==o?o:void 0;return"fill"!==i||u&&"line"!==l||(i="stroke",u=null!==(s=null===(a=e._seriesMark)||void 0===a?void 0:a.getAttribute(i,t))&&void 0!==s?s:void 0),"stroke"===i&&B(u)?u[0]:u}},i.type=t.SeriesTypeEnum.area,i.mark=mG,i.transformerConstructor=UX,i}(gX);ot(YX,bX);var KX=function(){WH(),UH(),SX(),HX(),TX(),FU.registerAnimation("area",(function(t,e){return{appear:WX(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"clipOut"}}})),TK(),AK(),FU.registerSeries(YX.type,YX)},XX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i;return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{point:e.point,line:e.line,area:e.area,seriesMark:null!==(i=e.seriesMark)&&void 0!==i?i:"area",activePoint:e.activePoint,sampling:e.sampling,samplingFactor:e.samplingFactor,pointDis:e.pointDis,pointDisMul:e.pointDisMul,markOverlap:e.markOverlap,areaLabel:e.areaLabel})},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(IX),ZX=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=XX,i.type="area",i.seriesType=t.SeriesTypeEnum.area,i._canStack=!0,i}return r(i,e),i.type="area",i.seriesType=t.SeriesTypeEnum.area,i.view="singleDefault",i.transformerConstructor=XX,i}(LX),qX=function(){KX(),FU.registerChart(ZX.type,ZX)};function JX(t,e){return void 0===e&&(e=!0),function(i,n,r){var o="vertical"===t.direction?t.yField:t.xField,a=null==i?void 0:i[o];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:a>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:a>0?"positive":"negative"}}}var QX=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:JX(t,e)}},$X=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:JX(t,e)}},tZ={type:"fadeIn"},eZ={type:"growCenterIn"};function iZ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return tZ;case"scaleIn":return eZ;default:return QX(t)}}var nZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="rect",e}(vK),rZ=function(){FU.registerMark(nZ.type,nZ),Qj(),MK()};function oZ(t,e,i){if(t.values.length>0){var n,r=t.series;e&&(r=r.slice().reverse()),r.forEach((function(t,r){for(var o,a,s=t.s,l=t.values,u=s.getSpec().barMinHeight,c=null===(a=(o=s[i.axisHelper]).getScale)||void 0===a?void 0:a.call(o,0),h=s[i.axisHelper].isInverse(),d=0;d<l.length;d++){var f=l[e?l.length-1-d:d],p=aW(s[i.startMethod](f),c),v=aW(s[i.endMethod](f),c);0===d&&0===r&&(n=p);var y=Math.abs(p-v);y<u&&(y=u);var g=1;v<p?g=-1:v===p&&(g=i.isVertical?h?1:-1:h?-1:1),v=n+g*y,f[i.start]=n,f[i.end]=v,n=v}}))}for(var o in t.nodes)oZ(t.nodes[o],e,i)}var aZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar")},e}(fX),sZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar,i._barMarkName="bar",i._barMarkType="rect",i.transformerConstructor=aZ,i._supportStack=!0,i._bandPosition=0,i}return r(i,e),i.prototype.initMark=function(){var t,e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._initBarBackgroundMark(e),this._barMark=this._createMark(o(o({},i.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{morph:cX(this._spec,this._barMarkName),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,progressive:e,customShape:null===(t=this._spec.bar)||void 0===t?void 0:t.customShape})},i.prototype._initBarBackgroundMark=function(t){var e,n;(null===(e=this._spec.barBackground)||void 0===e?void 0:e.visible)&&(this._barBackgroundMark=this._createMark(i.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId(),progressive:t,customShape:null===(n=this._spec.barBackground)||void 0===n?void 0:n.customShape}))},i.prototype.initMarkStyle=function(){this._barMark&&(this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this._trigger.registerMark(this._barMark))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null})},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark)},i.prototype._statisticViewData=function(){var t,i,n=this;if(e.prototype._statisticViewData.call(this),null===(t=this._spec.barBackground)||void 0===t?void 0:t.visible){hY(this._option.dataSet,"addVChartProperty",GK),hY(this._option.dataSet,"dimensionItems",(function(t,e){for(var i,r,a=c(t,1)[0],s=[{}],l=n.getDimensionField(),u=0;u<l.length;u++){var h=l[u],d=null===(r=a.latestData[h])||void 0===r?void 0:r.values;if(null==d?void 0:d.length){for(var f=[],p=0;p<d.length;p++)for(var v=0;v<s.length;v++)f.push(o(o({},s[v]),((i={})[h]=d[p],i)));s=f}}return s}));var r=new Ma(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:eX.bind(this),call:iX}},!1);null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",r.reRunAllTransform),this._barBackgroundViewData=new JK(this._option,r)}},i.prototype.init=function(t){var i,n;e.prototype.init.call(this,t),"vertical"===this.direction?"band"===(null===(i=this._xAxisHelper)||void 0===i?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()},i.prototype._shouldDoPreCalculate=function(){var t=this,e=this.getRegion();return this._stack&&e.getSeries().filter((function(e){return e.type===t.type&&e.getSpec().barMinHeight})).length},i.prototype._calculateStackRectPosition=function(t){var e=this,i=this.getRegion();if(!i._bar_series_position_calculated){var n,r,o,a,s;i._bar_series_position_calculated=!0,t?(n=dG,r=hG,o="_dataToPosY1",a="_dataToPosY",s="_yAxisHelper"):(n=cG,r=uG,o="_dataToPosX1",a="_dataToPosX",s="_xAxisHelper");var l=TU(i,!1,(function(t){return t.type===e.type}));for(var u in l)for(var c in l[u].nodes)oZ(l[u].nodes[c],i.getStackInverse(),{isVertical:t,start:n,end:r,startMethod:o,endMethod:a,axisHelper:s})}},i.prototype._calculateRectPosition=function(t,e){var i,n,r,o,a;e?(r="_dataToPosY1",o="_dataToPosY",a="_yAxisHelper"):(r="_dataToPosX1",o="_dataToPosX",a="_xAxisHelper");var s=null===(n=(i=this[a]).getScale)||void 0===n?void 0:n.call(i,0),l=this[a].isInverse(),u=this._spec.barMinHeight,c=aW(this[r](t),s),h=aW(this[o](t),s),d=Math.abs(c-h);d<u&&(d=u);var f=1;return h<c?f=-1:h===c&&(f=e?l?1:-1:l?-1:1),c+f*d},i.prototype._dataToPosX=function(t){return this.dataToPositionX(t)},i.prototype._dataToPosX1=function(t){return this.dataToPositionX1(t)},i.prototype._dataToPosY=function(t){return this.dataToPositionY(t)},i.prototype._dataToPosY1=function(t){return this.dataToPositionY1(t)},i.prototype.initBandRectMarkStyle=function(){var e,i,n,r,o=this,a=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!1),t[uG]):o._spec.barMinHeight?o._calculateRectPosition(t,!1):aW(o._dataToPosX(t),a)},x1:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!1),t[cG]):aW(o._dataToPosX1(t),a)},y:function(t){return o._getPosition(o.direction,t)},height:function(){return o._getBarWidth(o._yAxisHelper)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barMark,{x:function(t){return o._getPosition(o.direction,t)},y:function(t,e,i,n){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!0),t[hG]):o._spec.barMinHeight?o._calculateRectPosition(t,!0):aW(o._dataToPosY(t),s)},y1:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!0),t[dG]):aW(o._dataToPosY1(t),s)},width:function(){return o._getBarWidth(o._xAxisHelper)}},"normal",t.AttributeLevel.Series),this._initBarBackgroundMarkStyle()},i.prototype._initBarBackgroundMarkStyle=function(){var e,i,n,r,o=this;if(this._barBackgroundMark){var a=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:function(){var t=a.range();return Math.min(t[0],t[t.length-1])},x1:function(){var t=a.range();return Math.max(t[0],t[t.length-1])},y:function(t){return o._getPosition(o.direction,t)},height:function(){return o._getBarWidth(o._yAxisHelper)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barBackgroundMark,{x:function(t){return o._getPosition(o.direction,t)},y:function(){var t=s.range();return Math.min(t[0],t[t.length-1])},y1:function(){var t=s.range();return Math.max(t[0],t[t.length-1])},width:function(){return o._getBarWidth(o._xAxisHelper)}},"normal",t.AttributeLevel.Series)}},i.prototype.initLinearRectMarkStyle=function(){var e,i,n,r,o=this,a=null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0),s=null===(r=null===(n=this._yAxisHelper)||void 0===n?void 0:n.getScale)||void 0===r?void 0:r.call(n,0);"vertical"===this.direction?this.setMarkStyle(this._barMark,{x:function(t){return aW(o.dataToPositionX(t),a)},x1:function(t){return aW(o.dataToPositionX1(t),a)},y:function(t,e,i,n){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!0),t[hG]):o._spec.barMinHeight?o._calculateRectPosition(t,!0):aW(o.dataToPositionY(t),s)},y1:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!0),t[dG]):aW(o.dataToPositionY1(t),s)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._barMark,{x:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!1),t[uG]):o._spec.barMinHeight?o._calculateRectPosition(t,!1):aW(o.dataToPositionX(t),a)},x1:function(t){return o._shouldDoPreCalculate()?(o._calculateStackRectPosition(!1),t[cG]):aW(o.dataToPositionX1(t),a)},y:function(t){return aW(o.dataToPositionY(t),s)},y1:function(t){return aW(o.dataToPositionY1(t),s)}},"normal",t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i=this,n={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:function(){var t,e;return"horizontal"===i.direction?null===(t=i._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=i._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset,o=yX(this);this._barMark.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("bar"))||void 0===e?void 0:e(n,r),sX(this._barMarkName,this._spec,this._markAttributeContext),o))},i.prototype._getBarWidth=function(t){var e,i,n=void 0!==this._spec.barWidth,r=null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:6;if(n)return pW(this._spec.barWidth,r);var o=void 0!==this._spec.barMinWidth,a=void 0!==this._spec.barMaxWidth,s=r;return o&&(s=Math.max(s,pW(this._spec.barMinWidth,r))),a&&(s=Math.min(s,pW(this._spec.barMaxWidth,r))),s},i.prototype._getPosition=function(t,e){var i,n,r,o,a,s,l,u,c,h,d,f;"horizontal"===t?(h=this.getYAxisHelper(),d="height",f=this.dataToPositionY.bind(this)):(h=this.getXAxisHelper(),d="width",f=this.dataToPositionX.bind(this));var p=h.getScale(0),v=this._barMark.getAttribute(d,e),y=null!==(n=null===(i=h.getBandwidth)||void 0===i?void 0:i.call(h,this._groups?this._groups.fields.length-1:0))&&void 0!==n?n:6;if((null===(o=null===(r=this._groups)||void 0===r?void 0:r.fields)||void 0===o?void 0:o.length)>1&&T(this._spec.barGapInGroup)){for(var g=this._groups.fields,m=lt(this._spec.barGapInGroup),_=0,b=0,x=g.length-1;x>=1;x--){var k=g[x],S=null!==(u=null===(l=null===(s=null===(a=this.getViewDataStatistics())||void 0===a?void 0:a.latestData)||void 0===s?void 0:s[k])||void 0===l?void 0:l.values)&&void 0!==u?u:[],A=S.length,w=pW(null!==(c=m[x-1])&&void 0!==c?c:ut(m),y),M=S.indexOf(e[k]);x===g.length-1?(_+=A*v+(A-1)*w,b+=M*(v+w)):(b+=M*(_+w),_+=_+(A-1)*w)}return p.scale(e[g[0]])+h.getBandwidth(0)/2-_/2+b}var C=gS(p.type||"band");return f(e)+.5*(y-v)+(C?-y/2:0)},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()},i.prototype.compile=function(){if(e.prototype.compile.call(this),this._spec.sampling){var t=this._region.getLayoutRect(),i=t.width,n=t.height,r=[],o=this._fieldY,a=this._fieldX;r.push({type:"sampling",size:"vertical"===this._direction?i:n,factor:this._spec.samplingFactor,yfield:"vertical"===this._direction?o[0]:a[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(r)}},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._barMark]},i.prototype.compileData=function(){var t;e.prototype.compileData.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.compile()},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(i=null===(t=this._barBackgroundViewData)||void 0===t?void 0:t.getDataView())||void 0===i||i.reRunAllTransform()},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._barBackgroundViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._barBackgroundViewData)||void 0===r||r.updateData()},i.prototype.release=function(){var t;e.prototype.release.call(this),null===(t=this._barBackgroundViewData)||void 0===t||t.release(),this._barBackgroundViewData=null},i.type=t.SeriesTypeEnum.bar,i.mark=fG,i.transformerConstructor=aZ,i}(gX),lZ=function(){WH(),rZ(),FU.registerAnimation("bar",(function(t,e){return{appear:iZ(t,e),enter:QX(t,!1),exit:$X(t,!1),disappear:$X(t)}})),FU.registerSeries(sZ.type,sZ)},uZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{barWidth:e.barWidth,barMaxWidth:e.barMaxWidth,barMinWidth:e.barMinWidth,barGapInGroup:e.barGapInGroup,barMinHeight:e.barMinHeight,sampling:e.sampling,samplingFactor:e.samplingFactor,barBackground:e.barBackground})},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(IX),cZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=uZ,i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i._canStack=!0,i}return r(i,e),i.type="bar",i.seriesType=t.SeriesTypeEnum.bar,i.view="singleDefault",i.transformerConstructor=uZ,i}(LX),hZ=function(){lZ(),FU.registerChart(cZ.type,cZ)},dZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,length:3})},e.type="rect3d",e}(vK),fZ=function(){FU.registerMark(dZ.type,dZ),jL(),IL(),gT.registerGraphic(sw.rect3d,yy),MK()},pZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.bar3d,i._barMarkName="bar3d",i._barMarkType="rect3d",i}return r(i,e),i.type=t.SeriesTypeEnum.bar3d,i.mark=pG,i}(sZ),vZ=function(){FU.registerAnimation("bar3d",(function(t,e){return{appear:iZ(t,e),enter:QX(t,!1),exit:$X(t,!1),disappear:$X(t)}})),fZ(),FU.registerSeries(pZ.type,pZ)},yZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{barWidth:e.barWidth,barMaxWidth:e.barMaxWidth,barMinWidth:e.barMinWidth,barGapInGroup:e.barGapInGroup})},e}(uZ),gZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=yZ,i.type="bar3d",i.seriesType=t.SeriesTypeEnum.bar3d,i}return r(i,e),i.type="bar3d",i.seriesType=t.SeriesTypeEnum.bar3d,i.view="singleDefault",i.transformerConstructor=yZ,i}(cZ),mZ=function(){vZ(),FU.registerChart(gZ.type,gZ)},_Z=[10,20],bZ=sS.Linear,xZ="circle",kZ=sS.Ordinal,SZ=["circle","square","triangle","diamond","star"],AZ=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},wZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"point")},e}(fX),TZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.scatter,i.transformerConstructor=wZ,i._invalidType="zero",i}return r(i,e),i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField},i.prototype._getSeriesAttribute=function(t,e,i,n){var r,a,s,l,u=i.defaultScaleType,c=i.defaultRange;if(A(e))return e;if(B(e)){if(w(t))return null===(r=this._option)||void 0===r||r.onError("".concat(n,"Field is required.")),e;if("ordinal"!==u&&e.length>2)return null===(a=this._option)||void 0===a||a.onError("".concat(n," length is invalid, specify up to 2 ").concat(n,"s.")),e;var h="".concat(bw,"_series_scatter_").concat(this.id,"_scale_").concat(n);return this._option.globalScale.registerModelScale({id:h,type:u,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:h,field:t}}if(M(e)){if(w(t))return null===(s=this._option)||void 0===s||s.onError("".concat(n,"Field is required.")),e;h="".concat(bw,"_series_scatter_").concat(this.id,"_scale_").concat(n);var d=o({id:h,type:u,domain:[{dataId:this._rawData.name,fields:[t]}],range:c},e);return this._option.globalScale.registerModelScale(d),{scale:d.id,field:t}}return null===(l=this._option)||void 0===l||l.onError("".concat(n," attribute is invalid.")),e},i.prototype.getSizeAttribute=function(t,e){return w(e)?10:I(e)?e:P(e)&&D(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:bZ,defaultRange:_Z},"size")},i.prototype.getShapeAttribute=function(t,e){return w(e)?xZ:P(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:kZ,defaultRange:SZ},"shape")},i.prototype.initMark=function(){var t,e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._symbolMark=this._createMark(i.mark.point,{morph:cX(this._spec,i.mark.point.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,progressive:e,isSeriesMark:!0,customShape:null===(t=this._spec.point)||void 0===t?void 0:t.customShape})},i.prototype.initMarkStyle=function(){this.initSymbolMarkStyle()},i.prototype.initAnimation=function(){var t,e,i,n=yX(this),r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._symbolMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("scatter"))||void 0===i?void 0:i({},r),sX("point",this._spec,this._markAttributeContext),n))},i.prototype.initSymbolMarkStyle=function(){var e=this._symbolMark;e&&("zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined}),this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:I(this._size)||A(this._size)?this._size:10,symbolType:P(this._shape)||A(this._shape)?this._shape:xZ},MY.STATE_NORMAL,t.AttributeLevel.Series),(T(this._sizeField)||T(this._size))&&this.setMarkStyle(e,{size:this.getSizeAttribute(this._sizeField,this._size)},MY.STATE_NORMAL,t.AttributeLevel.User_Mark),(T(this._shapeField)||T(this._shape))&&this.setMarkStyle(e,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},MY.STATE_NORMAL,t.AttributeLevel.User_Mark),this._trigger.registerMark(e))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)},i.prototype.viewDataStatisticsUpdate=function(i){var n=this;e.prototype.viewDataStatisticsUpdate.call(this,i);var r=[this.getDimensionField()[0],this.getStackValueField()].every((function(t){var e,i,r;return t&&(null===(r=null===(i=null===(e=n.getViewDataStatistics())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[t])||void 0===r?void 0:r.allValid)}));"zero"===this._invalidType||r?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i.getStackValueField()]},z:this._fieldZ?this.dataToPositionZ.bind(this):null},MY.STATE_NORMAL,t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(e,{visible:this._getInvalidDefined},MY.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.handleZoom=function(t){var e,i,n=this;this.getMarksWithoutRoot().forEach((function(t){var e=t.getProduct();e&&e.elements&&e.elements.length&&e.elements.forEach((function(t,e){var i=t.getGraphicItem(),r=t.getDatum(),o=n.dataToPosition(r);o&&i&&i.translateTo(o.x,o.y)}))}));var r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluateSync(null,null)},i.prototype.handlePan=function(t){var e,i,n=this;this.getMarksWithoutRoot().forEach((function(t){var e=t.getProduct();e&&e.elements&&e.elements.length&&e.elements.forEach((function(t,e){var i=t.getGraphicItem(),r=t.getDatum(),o=n.dataToPosition(r);o&&i&&i.translateTo(o.x,o.y)}))}));var r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluateSync(null,null)},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._symbolMark]},i.type=t.SeriesTypeEnum.scatter,i.mark=gG,i.transformerConstructor=wZ,i}(gX),MZ=function(){TX(),FU.registerAnimation("scatter",(function(t,e){return o({appear:AZ(0,e)},kK)})),FU.registerSeries(TZ.type,TZ)},CZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{point:e.point,size:e.size,sizeField:e.sizeField,shape:e.shape,shapeField:e.shapeField})},e}(IX),EZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=CZ,i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i._canStack=!0,i}return r(i,e),i.type="scatter",i.seriesType=t.SeriesTypeEnum.scatter,i.view="singleDefault",i.transformerConstructor=CZ,i}(LX),RZ=function(){MZ(),FU.registerChart(EZ.type,EZ)};jr();var PZ={},BZ=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function LZ(t,e){t&&P(t)||iS("Projection type must be a name string.");var i=t.toLowerCase();return arguments.length>1&&(PZ[i]=function(t,e){return function i(){var n=e();return n.type=t,n.path=jr().projection(n),n.copy=n.copy||function(){var t=i();return BZ.forEach((function(e){n[e]&&t[e](n[e]())})),t.path.pointRadius(n.path.pointRadius()),t},n}}(i,e)),PZ[i]||null}var OZ={albers:ro,albersusa:function(){var t,e,i,n,r,o,a=ro(),s=no().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=no().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,i.point(e,a),o||(n.point(e,a),o)||(r.point(e,a),o)}function h(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),i=a.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&r<.234&&n>=-.425&&n<-.214?s:r>=.166&&r<.234&&n>=-.214&&n<-.115?l:a).invert(t)},c.stream=function(i){return t&&e===i?t:(n=[a.stream(e=i),s.stream(i),l.stream(i)],r=n.length,t={point:function(t,e){for(var i=-1;++i<r;)n[i].point(t,e)},sphere:function(){for(var t=-1;++t<r;)n[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)n[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)n[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)n[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)n[t].polygonEnd()}});var n,r},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),l.precision(t),h()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),l.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return i=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),n=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+Pi,c+.12*e+Pi],[o-.214*e-Pi,c+.234*e-Pi]]).stream(u),r=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+Pi,c+.166*e+Pi],[o-.115*e-Pi,c+.234*e-Pi]]).stream(u),h()},c.fitExtent=function(t,e){return Gr(c,t,e)},c.fitSize=function(t,e){return Wr(c,t,e)},c.fitWidth=function(t,e){return Ur(c,t,e)},c.fitHeight=function(t,e){return Yr(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return $r(so).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return $r(lo).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return eo(fo).scale(109.5).parallels([30,30])},conicequalarea:no,conicequidistant:function(){return eo(vo).scale(131.154).center([0,13.9389])},equalEarth:function(){return $r(xo).scale(177.158)},equirectangular:function(){return $r(po).scale(152.63)},gnomonic:function(){return $r(ko).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,n,r,o,a,s=1,l=0,u=0,c=1,h=1,d=0,f=null,p=1,v=1,y=Hr({point:function(t,e){var i=_([t,e]);this.stream.point(i[0],i[1])}}),g=zn;function m(){return p=s*c,v=s*h,o=a=null,_}function _(i){var n=i[0]*p,r=i[1]*v;if(d){var o=r*t-n*e;n=n*t+r*e,r=o}return[n+l,r+u]}return _.invert=function(i){var n=i[0]-l,r=i[1]-u;if(d){var o=r*t+n*e;n=n*t-r*e,r=o}return[n/p,r/v]},_.stream=function(t){return o&&a===t?o:o=y(g(a=t))},_.postclip=function(t){return arguments.length?(g=t,f=i=n=r=null,m()):g},_.clipExtent=function(t){return arguments.length?(g=null==t?(f=i=n=r=null,zn):Fn(f=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),m()):null==f?null:[[f,i],[n,r]]},_.scale=function(t){return arguments.length?(s=+t,m()):s},_.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],m()):[l,u]},_.angle=function(i){return arguments.length?(e=Ui(d=i%360*Fi),t=Ni(d),m()):d*Di},_.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},_.reflectY=function(t){return arguments.length?(h=t?-1:1,m()):h<0},_.fitExtent=function(t,e){return Gr(_,t,e)},_.fitSize=function(t,e){return Wr(_,t,e)},_.fitWidth=function(t,e){return Ur(_,t,e)},_.fitHeight=function(t,e){return Yr(_,t,e)},_},mercator:function(){return co(uo).scale(961/Ii)},naturalEarth1:function(){return $r(So).scale(175.295)},orthographic:function(){return $r(Ao).scale(249.5).clipAngle(90+Pi)},stereographic:function(){return $r(wo).scale(250).clipAngle(142)},transversemercator:function(){var t=co(To),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}};function IZ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}Object.keys(OZ).forEach((function(t){LZ(t,OZ[t])}));var DZ="Feature",FZ="FeatureCollection";function zZ(t){var e=lt(t);return 1===e.length?e[0]:{type:FZ,features:e.reduce((function(t,e){return t.concat(function(t){return t.type===FZ?t.features:lt(t).filter((function(t){return!w(t)})).map((function(t){return t.type===DZ?t:{type:DZ,geometry:t}}))}(e))}),[])}}var jZ=BZ.concat(["pointRadius","fit","extent","size"]);function HZ(t,e){var i=[];return t?(Object.keys(t).forEach((function(n){jZ.includes(n)&&(i=i.concat(rT(t[n],e)))})),i):i}var NZ=function(t){ue(i,t);var e=IZ(i);function i(t){var n;return jt(this,i),(n=e.call(this,t)).grammarType="projection",n}return zt(i,[{key:"parse",value:function(t){return Xs(de(i.prototype),"parse",this).call(this,t),this.pointRadius(t.pointRadius),this.size(t.size),this.extent(t.extent),this.fit(t.fit),this.configure(t),this.commit(),this}},{key:"pointRadius",value:function(t){return w(this.spec.pointRadius)||this.detach(rT(this.spec.pointRadius,this.view)),this.spec.pointRadius=t,this.attach(rT(t,this.view)),this.commit(),this}},{key:"size",value:function(t){return w(this.spec.size)||this.detach(rT(this.spec.size,this.view)),this.spec.size=t,this.attach(rT(t,this.view)),this.commit(),this}},{key:"extent",value:function(t){return w(this.spec.extent)||this.detach(rT(this.spec.extent,this.view)),this.spec.extent=t,this.attach(rT(t,this.view)),this.commit(),this}},{key:"fit",value:function(t){return w(this.spec.fit)||this.detach(rT(this.spec.fit,this.view)),this.spec.fit=t,this.attach(rT(t,this.view)),this.commit(),this}},{key:"configure",value:function(t){return this.detach(HZ(this.spec,this.view)),w(t)?this.spec={type:this.spec.type,fit:this.spec.fit,extent:this.spec.extent,size:this.spec.size,pointRadius:this.spec.pointRadius}:(Object.assign(this.spec,t),this.attach(HZ(this.spec,this.view))),this.commit(),this}},{key:"evaluate",value:function(t,e){var i,n,r=this;if(this.projection&&this.projection.type===this.spec.type||(this.projection=(i=this.spec.type,(n=LZ((i||"mercator").toLowerCase()))||iS("Unrecognized projection type: "+i),n()),this.projection.type=this.spec.type),BZ.forEach((function(t){w(r.spec[t])||function(t,e,i){A(t[e])&&t[e](i)}(r.projection,t,aT(r.spec[t],e,LZ))})),w(this.spec.pointRadius)||this.projection.path.pointRadius(aT(this.spec.pointRadius,e,LZ)),!(w(this.spec.fit)||w(this.spec.extent)&&w(this.spec.size))){var o=zZ(aT(this.spec.fit,e,LZ));this.spec.extent?this.projection.fitExtent(aT(this.spec.extent,e,LZ),o):this.spec.size&&this.projection.fitSize(aT(this.spec.size,e,LZ),o)}return this.projection}},{key:"output",value:function(){return this.projection}}]),i}(uz),VZ=function(t,e){if(!e.from||!e.from())return t;var i,n=e.fields,r=e.key,o=e.values,a=e.default,s=e.as||[n],l=e.from().reduce((function(t,e){return e[n]&&t.set(e[n],e),t}),new Map);if(A(e.set))i=function(t){var i=l.get(t[r]);e.set(t,i)};else if(o){var u=o.length;i=function(t){var e=l.get(t[r]);if(w(e))for(var i=0;i<u;++i)t[s[i]]=a;else for(i=0;i<u;++i)t[s[i]]=e[o[i]]}}else i=function(t){var e=l.get(t[r]);t[s[0]]=T(e)?e:a};return 0===t.length?[]:t.map((function(t){return i(t),t}))},GZ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.geo,i.coordinate="geo",i._nameProperty="name",i}return r(i,e),i.prototype.getMapViewData=function(){var t;return null===(t=this._mapViewData)||void 0===t?void 0:t.getDataView()},Object.defineProperty(i.prototype,"nameField",{get:function(){return this._nameField},set:function(t){this._nameField=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"valueField",{get:function(){return this._valueField},set:function(t){this._valueField=t},enumerable:!1,configurable:!0}),i.prototype.getNameProperty=function(){return this._nameProperty},i.prototype.getCentroidProperty=function(){return this._centroidProperty},i.prototype.getCoordinateHelper=function(){return this._coordinateHelper},i.prototype.setCoordinateHelper=function(t){this._coordinateHelper=t},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.getGroupFields=function(){return null},i.prototype.dataToPosition=function(t){var e,i=null;if(!t)return i;var n=this._coordinateHelper,r=n.dataToPosition,o=n.latitudeField,a=n.longitudeField;if(null===(i=this.nameToPosition(t))){var s=a?null==t?void 0:t[a]:Number.NaN,l=o?null==t?void 0:t[o]:Number.NaN;i=null!==(e=null==r?void 0:r([s,l]))&&void 0!==e?e:null}return i},i.prototype.nameToPosition=function(t){var e,i,n=this,r=this.getDatumName(t);if(w(r))return null;var o=null===(i=null===(e=this.getMapViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.filter((function(t){return n.getDatumName(t)===r}))[0];if(w(o))return null;var a=this._coordinateHelper.dataToPosition,s=this.getDatumCenter(o),l=null==a?void 0:a(s);return w(l)||isNaN(l.x)||isNaN(l.y)?null:l},i.prototype.dataToLatitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.dataToLongitude=function(t){return this._coordinateHelper?(0,this._coordinateHelper.dataToLatitude)(t):Number.NaN},i.prototype.valueToPosition=function(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}},i.prototype.positionToData=function(t){},i.prototype.latitudeToData=function(t){},i.prototype.longitudeToData=function(t){},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionZ=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.release=function(){e.prototype.release.call(this),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null},i.prototype.getStackGroupFields=function(){return[this._nameField]},i.prototype.getStackValueField=function(){return this._spec.valueField},i.prototype.compileData=function(){var t;null===(t=this._mapViewData)||void 0===t||t.compile()},i.prototype.initStatisticalData=function(){if(e.prototype.initStatisticalData.call(this),this._mapViewData){var t="".concat(bw,"_series_").concat(this.id,"_mapViewDataStatic");this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}},i.prototype.getSeriesKeys=function(){var t,e,i,n,r;return this._seriesField?null!==(r=null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:null===(n=null===(i=this._mapViewDataStatistics)||void 0===i?void 0:i.latestData[this._seriesField])||void 0===n?void 0:n.values)&&void 0!==r?r:[]:this.name?[this.name]:this.userId?["".concat(this.userId)]:["".concat(this.type,"_").concat(this.id)]},i.prototype.fillData=function(){var t,i;e.prototype.fillData.call(this),null===(t=this._mapViewData.getDataView())||void 0===t||t.reRunAllTransform(),null===(i=this._mapViewDataStatistics)||void 0===i||i.reRunAllTransform()},i.prototype.getActiveMarks=function(){return[]},i}(pX),WZ="".concat(bw,"_MAP_LOOK_UP_KEY"),UZ=function(t,e){return t.features&&t.features.forEach((function(t,i){var n,r;t[sV]=i,e.nameMap?t[WZ]=e.nameMap[null===(n=t.properties)||void 0===n?void 0:n[e.nameProperty]]:t[WZ]=null===(r=t.properties)||void 0===r?void 0:r[e.nameProperty]})),t.features},YZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleValueCallback=function(t){var i,n=e.series;return null!==(i=e._getDimensionData(t))&&void 0!==i?i:n.getDatumName(t)},e}return r(e,t),e}(YK),KZ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0,path:""})},e.type="path",e}(vK),XZ=function(){FU.registerMark(KZ.type,KZ),Jj()},ZZ=function(){function t(t){this.projection=LZ(t.type)()}return t.prototype.fit=function(t,e,i){var n={type:"FeatureCollection",features:i};this.projection.fitExtent([t,e],n)},t.prototype.center=function(t){var e,i;null===(i=null===(e=this.projection)||void 0===e?void 0:e.center)||void 0===i||i.call(e,t)},t.prototype.project=function(t){var e;return null===(e=this.projection)||void 0===e?void 0:e.call(this,t)},t.prototype.shape=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.path)||void 0===i?void 0:i.call(e,t)},t.prototype.invert=function(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.invert)||void 0===i?void 0:i.call(e,t)},t.prototype.scale=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}},t.prototype.translate=function(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}},t.prototype.evaluate=function(t,e,i){var n=this.projection.copy();return null==n?void 0:n.fitExtent([t,e],{type:"FeatureCollection",features:i})},t}(),qZ=function(t){function e(e){var i=t.call(this)||this;return i.component=e,i}return r(e,t),e}(IK);function JZ(t,e){return U(e,"component.".concat(t))}var QZ={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function $Z(t){var e=0;return U(t,"tick.visible")&&(e+=U(t,"tick.tickSize")),U(t,"label.visible")&&(e+=U(t,"label.space")),e}function tq(t,e){var i,n,r,o,a,s;return{min:null!==(r=null!==(i=t.min)&&void 0!==i?i:null===(n=t.range)||void 0===n?void 0:n.min)&&void 0!==r?r:null==e?void 0:e.min,max:null!==(s=null!==(o=t.max)&&void 0!==o?o:null===(a=t.range)||void 0===a?void 0:a.max)&&void 0!==s?s:null==e?void 0:e.max}}function eq(t){var e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}function iq(t){var e=null==t?void 0:t.orient;return"angle"===e||"radius"===e}var nq=function(t,e,i){var n,r=null!==(n="band"===e?JZ("axisBand",i):["linear","log","symlog"].includes(e)?JZ("axisLinear",i):{})&&void 0!==n?n:{},o=VU(t)?JZ("axisX",i):GU(t)?JZ("axisY",i):JZ("axisZ",i);return $W({},JZ("axis",i),r,o)},rq=function(t,e,i){var n,r=null!==(n="band"===e?JZ("axisBand",i):"linear"===e?JZ("axisLinear",i):{})&&void 0!==n?n:{},o=JZ("angle"===t?"axisAngle":"axisRadius",i);return $W({},JZ("axis",i),r,o)},oq=function(t){return"band"===t||"ordinal"===t||"point"===t};function aq(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,a=t.AABBBounds,s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=t.attribute,d=h.dx,f=void 0===d?0:d,p=h.dy,v=void 0===p?0:p,y=0,g=0;s<i&&(y=i-s),l<n&&(g=n-l),u>r&&(y=r-u),c>o&&(g=o-c),y&&t.setAttribute("dx",y+f),g&&t.setAttribute("dy",g+v)}function sq(t,e,i,n){for(var r=0,o=t.length-1;r<=o;){var a=Math.floor((r+o)/2),s=t[a];if(s[i]<=e&&s[n||i]>=e)return s;s[i]>e?o=a-1:r=a+1}return null}var lq=function(t,e){var i=e.getNewDomain,n=e.isContinuous,r=(0,e.field)(),o=i();if(w(o)||w(r))return t;if(0===o.length)return[];var a=null;return a=n()?function(t){return t[r]>=o[0]&&t[r]<=o[1]}:function(t){return o.indexOf(t[r]+"")>=0||o.indexOf(t[r])>=0},t.filter(a)},uq=function(t,e){var i=e.input,n=i.stateFields,r=i.valueFields,o=i.dataCollection,a=e.output,s=a.stateField,l=a.valueField,u={},c=[];return o.forEach((function(t,e){var i;if(!w(n[e])){var o=null===(i=t.getFields())||void 0===i?void 0:i[n[e]];o&&o.lockStatisticsByDomain&&o.domain.forEach((function(t){u[t]=0})),t.latestData.forEach((function(t){lt(n[e]).forEach((function(i){w(t[i])||(w(u[t[i]])&&(u[t[i]]=0),w(r[e])||(u[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))}))}))}})),Object.keys(u).forEach((function(t,e){var i,n=((i={})[s]=t,i);l&&(n[l]=u[t]),c.push(n)})),c};function cq(t){var e,i,n=o({},t);return W(t.style)||(n.textStyle=DU(t.style)),W(t.textStyle)||$W(n.textStyle,DU(t.textStyle)),(null===(e=t.shape)||void 0===e?void 0:e.style)&&DU(n.shape.style),(null===(i=t.background)||void 0===i?void 0:i.style)&&DU(n.background.style),n}function hq(t,e,i,n){switch(t){case f.cartesianBandAxis:return nq(UU(i,["z"]),"band",e);case f.cartesianLinearAxis:return nq(UU(i,["z"]),"linear",e);case f.cartesianLogAxis:return nq(UU(i,["z"]),"log",e);case f.cartesianSymlogAxis:return nq(UU(i,["z"]),"symlog",e);case f.cartesianAxis:case f.cartesianTimeAxis:return nq(UU(i),void 0,e);case f.polarBandAxis:return rq(i.orient,"band",e);case f.polarLinearAxis:return rq(i.orient,"linear",e);case f.polarAxis:return rq(i.orient,void 0,e);case f.cartesianCrosshair:return function(t,e){var i,n,r,o=lt(null!==(i=e.axes)&&void 0!==i?i:[]),a=null!==(n=JZ(f.crosshair,t))&&void 0!==n?n:{},s=a.bandField,l=a.linearField,u=a.xField,c=a.yField,h=o.find((function(t){return VU(t.orient)}));r=T(h)?$W({},oq(h.type)?s:l,u):u;var d=o.find((function(t){return GU(t.orient)}));return{xField:r,yField:T(d)?$W({},_S(d.type)?s:l,c):c}}(e,n);case f.polarCrosshair:return function(t,e){var i,n,r,o=lt(null!==(i=e.axes)&&void 0!==i?i:[]),a=null!==(n=JZ(f.crosshair,t))&&void 0!==n?n:{},s=a.bandField,l=a.linearField,u=a.categoryField,c=a.valueField,h=o.find((function(t){return"angle"===t.orient}));r=T(h)?$W({},oq(h.type)?s:l,u):u;var d=o.find((function(t){return"radius"===t.orient}));return{categoryField:r,valueField:T(d)?$W({},_S(d.type)?s:l,c):c}}(e,n);case f.colorLegend:case f.sizeLegend:return JZ("".concat(t,".").concat("bottom"===(r=i).orient||"top"===r.orient?"horizontal":"vertical"),e);case f.dataZoom:case f.scrollBar:return function(t,e,i){var n=JZ(e,i),r=$W({},n,n[YU(t)]);return delete r.horizontal,delete r.vertical,r}(UU(i),t,e);default:return JZ(t,e)}var r}var dq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getTheme=function(t,e){return hq(this.type,this._option.getTheme(),t,e)},e.prototype._mergeThemeToSpec=function(e,i){var n=t.prototype._mergeThemeToSpec.call(this,e,i),r=n.spec,o=n.theme;return this._adjustPadding(r),{spec:r,theme:o}},e.prototype._adjustPadding=function(t){var e,i=t.padding,n=t.noOuterPadding,r=void 0===n||n,a=t.orient;r&&i&&a&&(t.padding=o(o({},dW(i)),((e={})[a]=0,e)))},e}(ZY),fq=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.name="component",r.modelType="component",r.transformerConstructor=dq,r._delegateEvent=function(e,i,n,o,a){var s,l;void 0===o&&(o=null),void 0===a&&(a=null),r.event.emit(n,{model:r,node:e,event:i,item:o,datum:a,source:t.Event_Source_Type.chart,chart:null===(l=null===(s=r._option)||void 0===s?void 0:s.globalInstance)||void 0===l?void 0:l.getChart()},"model")},r._option.animation&&(r.animate=new XY({getCompiler:n.getCompiler})),r}return r(i,e),i.createComponent=function(t,e){var i=t.spec,n=a(t,["spec"]);return new this(i,o(o({},e),n))},i.prototype.getRegions=function(){return this._regions},i.prototype.created=function(){this.initLayout(),e.prototype.created.call(this),this.pluginService=new qZ(this)},i.prototype.initLayout=function(){var t;e.prototype.initLayout.call(this),this._regions=null!==(t=this._regions)&&void 0!==t?t:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map((function(t){return null==t?void 0:t.id})))},i.prototype.changeRegions=function(t){throw new Error("Method not implemented.")},i.prototype._getNeedClearVRenderComponents=function(){throw new Error("Method not implemented.")},i.prototype.onRender=function(t){throw new Error("Method not implemented.")},i.prototype.getVRenderComponents=function(){return this._getNeedClearVRenderComponents()},i.prototype.callPlugin=function(t){this.pluginService&&this.pluginService.getAll().forEach((function(e){return t(e)}))},i.prototype.eventPos=function(t){return{x:t.event.viewX-this.getLayoutStartPoint().x,y:t.event.viewY-this.getLayoutStartPoint().y}},i.prototype.getContainer=function(){var t;return this._container||(this._container=null===(t=this._option)||void 0===t?void 0:t.globalInstance.getStage().find((function(t){return"root"===t.name}),!0)),this._container},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||(n.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some((function(e){return nt(null==i?void 0:i[e],t[e])}))),(null==i?void 0:i.visible)!==t.visible&&(n.reCompile=!0),n},i.prototype.release=function(){e.prototype.release.call(this),this.clear()},i.prototype.clear=function(){var t,e=this,i=this._getNeedClearVRenderComponents();i&&i.length&&i.forEach((function(t){var i;t&&(null===(i=e.getContainer())||void 0===i||i.removeChild(t),t=null)})),this._container=null,null===(t=this.pluginService)||void 0===t||t.disposeAll(),this.pluginService=null},i.prototype.compile=function(){this.compileMarks()},i.prototype.compileMarks=function(t){var e=this;this.getMarks().forEach((function(i){var n;i.compile({group:t}),null===(n=i.getProduct())||void 0===n||n.configure({context:{model:e}})}))},i.prototype.getBoundsInRect=function(t,e){return{x1:0,x2:0,y1:0,y2:0}},i.transformerConstructor=dq,i}(QY),pq=function(){function t(){}return t.prototype.parserScrollEvent=function(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t},t.prototype.parserZoomEvent=function(t){if(!t)return t;var e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t},t.prototype.clearZoom=function(){},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t.prototype.parserDragEvent=function(){return!0},t}(),vq=function(){function t(){this._lastScale=0}return t.prototype.clearZoom=function(){this._lastScale=0,this.pointerId=null},t.prototype.parserDragEvent=function(t){return this.pointerId?this.pointerId===t.pointerId:(this.pointerId=t.pointerId,!0)},t.prototype.parserZoomEvent=function(t){var e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;var i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t},t.prototype.parserScrollEvent=function(t){return t},t.prototype.clearScroll=function(){},t.prototype.clearDrag=function(){},t}();function yq(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:"pointerup",zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:pq}:Xk(e)||Zk(e)?{start:"pointerdown",move:"pointermove",end:"pointerup",zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:vq}:null}var gq={debounce:Pt,throttle:Bt},mq=function(){function e(){this._isGestureListener=!1}return e.prototype.initZoomable=function(e,i){void 0===i&&(i=t.RenderModeEnum["desktop-browser"]),this._eventObj=e,this._renderMode=i,this._gestureController=this._option.getChart().getVGrammarView().renderer._gestureController,this._isGestureListener=Xk(this._renderMode)||Zk(this._renderMode),yq(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))},e.prototype._getZoomTriggerEvent=function(t){return yq(this._renderMode)[t]},e.prototype._zoomEventDispatch=function(t,e,i){if(this._isGestureListener||t.event){var n=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(n);var r=n,o=r.zoomDelta,a=r.zoomX,s=r.zoomY;w(o)||$e({x:a,y:s},this._getRegionOrSeriesLayout(e),!1)&&(this._clickEnable=!1,i&&i({zoomDelta:o,zoomX:a,zoomY:s},n),this._eventObj.emit("zoom",{scale:n.zoomDelta,scaleCenter:{x:n.zoomX,y:n.zoomY},model:this}))}},e.prototype._getRegionOrSeriesLayout=function(t){"region"!==t.type&&(t=t.getRegion());var e=t.layout.getLayout(),i=e.x,n=e.y;return{x1:i,y1:n,x2:i+e.width,y2:n+e.height}},e.prototype._bindZoomEventAsRegion=function(e,i,n,r){var o,a,s,l,u=this,d=null!==(s=null==r?void 0:r.delayType)&&void 0!==s?s:"throttle",f=null!==(l=null==r?void 0:r.delayTime)&&void 0!==l?l:0,p=this._isGestureListener?this._gestureController:e,v=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:t.Event_Bubble_Level.chart,consume:!0}],y=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:t.Event_Bubble_Level.chart,consume:!1}];(o=p).on.apply(o,h(h([],c(y),!1),[gq[d]((function(t){u._zoomableTrigger.clearZoom()}),f)],!1)),(a=p).on.apply(a,h(h([],c(v),!1),[gq[d]((function(t){u._zoomEventDispatch(t,i,n)}),f)],!1))},e.prototype.initZoomEventOfSeries=function(t,e,i){this._option.disableTriggerEvent||yq(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)},e.prototype.initZoomEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yq(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindZoomEventAsRegion(t.event,t,i,n)})):r._bindZoomEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._scrollEventDispatch=function(t,e,i){var n=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return n;var r=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(r);var o=r,a=o.scrollX,s=o.scrollY,l=o.canvasX,u=o.canvasY;return w(a)&&w(s)?n:$e({x:l,y:u},this._getRegionOrSeriesLayout(e),!1)?(this._clickEnable=!1,i&&(n=i({scrollX:a,scrollY:s},r)),this._eventObj.emit("scroll",{scrollX:a,scrollY:s,model:this}),n):n},e.prototype._bindScrollEventAsRegion=function(e,i,n,r){var o,a,s,l,u=this,d=null!==(s=null==r?void 0:r.delayType)&&void 0!==s?s:"throttle",f=null!==(l=null==r?void 0:r.delayTime)&&void 0!==l?l:0,p=this._isGestureListener?this._gestureController:e,v=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:t.Event_Bubble_Level.chart,consume:!0}],y=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:t.Event_Bubble_Level.chart,consume:!1}];(o=p).on.apply(o,h(h([],c(y),!1),[gq[d]((function(t){u._zoomableTrigger.clearScroll()}),f)],!1)),(a=p).on.apply(a,h(h([],c(v),!1),[gq[d]((function(t){return u._scrollEventDispatch(t,i,n)}),f)],!1))},e.prototype.initScrollEventOfSeries=function(t,e,i){yq(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)},e.prototype.initScrollEventOfRegions=function(t,e,i,n){var r=this;this._option.disableTriggerEvent||yq(this._renderMode)&&t.forEach((function(t){e?t.getSeries().forEach((function(t){e(t)&&r._bindScrollEventAsRegion(t.event,t,i,n)})):r._bindScrollEventAsRegion(r._eventObj,t,i,n)}))},e.prototype._bindDragEventAsRegion=function(e,i,n,r){var o=this;e.on(this._getZoomTriggerEvent("start"),{level:t.Event_Bubble_Level.chart},(function(t){if(t.event){var e=t.event;$e({x:e.canvasX,y:e.canvasY},o._getRegionOrSeriesLayout(i),!1)&&o._handleDrag(t,n,r)}})),e.on("click",{level:t.Event_Bubble_Level.chart},(function(){return!o._clickEnable}))},e.prototype.initDragEventOfSeries=function(e,i,n){var r=this;this._option.disableTriggerEvent||yq(this._renderMode)&&e.event.on(this._getZoomTriggerEvent("start"),{level:t.Event_Bubble_Level.model,filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},(function(t){r._handleDrag(t,i,n)}))},e.prototype.initDragEventOfRegions=function(e,i,n,r){var o=this;this._option.disableTriggerEvent||yq(this._renderMode)&&e.forEach((function(e){i?e.getSeries().forEach((function(e){i(e)&&(e.event.on(o._getZoomTriggerEvent("start"),{level:t.Event_Bubble_Level.model,filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},(function(t){o._handleDrag(t,n)})),e.event.on("click",{level:t.Event_Bubble_Level.model,filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},(function(){return!o._clickEnable})))})):o._bindDragEventAsRegion(o._eventObj,e,n,r)}))},e.prototype._handleDrag=function(e,i,n){var r,o,a,s=this;if(!this._option.disableTriggerEvent&&(this._clickEnable=!0,this._zoomableTrigger.parserDragEvent(e.event))){var l=null!==(r=null==n?void 0:n.delayType)&&void 0!==r?r:"throttle",u=null!==(o=null==n?void 0:n.delayTime)&&void 0!==o?o:0,c=null===(a=null==n?void 0:n.realTime)||void 0===a||a,h=this._getZoomTriggerEvent("move"),d=this._getZoomTriggerEvent("end"),f=e.event,p=f.canvasX,v=f.canvasY,y=f.canvasX,g=f.canvasY,m=gq[l]((function(e){s._clickEnable=!1;var n=e.event,r=[n.canvasX-y,n.canvasY-g];y=n.canvasX,g=n.canvasY,!c&&i&&i(r,e.event),s._eventObj.emit("panend",{delta:r,model:s}),s._zoomableTrigger.pointerId=null,s._eventObj.off(h,{level:t.Event_Bubble_Level.chart,source:t.Event_Source_Type.chart},_),s._eventObj.off(d,{level:t.Event_Bubble_Level.chart,source:t.Event_Source_Type.window},m)}),u),_=gq[l]((function(t){if(s._zoomableTrigger.parserDragEvent(t.event)){s._clickEnable=!1;var e=t.event,n=[e.canvasX-p,e.canvasY-v];p=e.canvasX,v=e.canvasY,c&&i&&i(n,t.event),s._eventObj.emit("panmove",{delta:n,model:s})}}),u);this._eventObj.on(h,{level:t.Event_Bubble_Level.chart,source:t.Event_Source_Type.chart},_),this._eventObj.on(d,{level:t.Event_Bubble_Level.chart,source:t.Event_Source_Type.chart},m)}},e}();function _q(t,e){return"".concat(bw,"_").concat(e,"_").concat(t)}var bq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.geoCoordinate,i.name=f.geoCoordinate,i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Mark,i._projectionSpec={name:_q(i.type,i.id),type:"mercator"},i._actualScale=1,i._initialScale=1,i.effect={scaleUpdate:function(){i.coordinateHelper()}},i._handleChartZoom=function(t,e){var n,r,o,a,s,l,u=t.zoomDelta,c=i._actualScale;return i._actualScale*=u,i._actualScale<(null===(n=i._spec.zoomLimit)||void 0===n?void 0:n.min)?(i._actualScale=null===(r=i._spec.zoomLimit)||void 0===r?void 0:r.min,u=(null===(o=i._spec.zoomLimit)||void 0===o?void 0:o.min)/c):i._actualScale>(null===(a=i._spec.zoomLimit)||void 0===a?void 0:a.max)&&(i._actualScale=null===(s=i._spec.zoomLimit)||void 0===s?void 0:s.max,u=(null===(l=i._spec.zoomLimit)||void 0===l?void 0:l.max)/c),e&&(e.zoomDelta=u),i.zoom(u,[t.zoomX,t.zoomY]),u},i.pan=function(t){var e,n,r;void 0===t&&(t=[0,0]);var o=null!==(n=null===(e=i._projection)||void 0===e?void 0:e.translate())&&void 0!==n?n:[0,0],a=o[0],s=o[1];a+=t[0],s+=t[1],null===(r=i._projection)||void 0===r||r.translate([a,s])},i}return r(i,e),Object.defineProperty(i.prototype,"longitudeField",{get:function(){return this._longitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"latitudeField",{get:function(){return this._latitudeField},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"projectionSpec",{get:function(){return this._projectionSpec},enumerable:!1,configurable:!0}),i.prototype.setProjection=function(t){this._projectionSpec=o(o({},t),{name:this._projectionSpec.name})},i.prototype.getZoom=function(){return this._actualScale},i.getSpecInfo=function(t){if(w(t))return null;var e=[];return t.region.forEach((function(t,i){if("geo"===t.coordinate){var n=o(o({},t),{padding:0});e.push({spec:n,regionIndex:i,type:f.geoCoordinate,specInfoPath:["region",i,"geoCoordinate"]})}})),e},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=$W(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null===(t=this._spec.zoomLimit)||void 0===t?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null===(i=this._spec.zoomLimit)||void 0===i?void 0:i.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!==(n=this._projectionSpec.zoom)&&void 0!==n?n:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()},i.prototype.dispatchZoom=function(t,e){var i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},n=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y});1!==n&&this.event.emit("zoom",{scale:n,scaleCenter:i,model:this})},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},this.effect.scaleUpdate.bind(this)),this._spec.roam&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,(function(){return!0}),this.pan),this._regions.forEach((function(t){t.getSeries().forEach((function(t){t.event.on("zoom",(function(e){return t.handleZoom(e),!0})),t.event.on("panmove",(function(e){return t.handlePan(e),!0}))}))})))},i.prototype.initProjection=function(){var t;this._projection=new ZZ(this._projectionSpec),null!==this._projection.projection||null===(t=this._option)||void 0===t||t.onError("unsupported projection type!")},i.prototype.coordinateHelper=function(){var e=this,i={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:function(){return e.id}};this._regions.forEach((function(n){n.getSeries().forEach((function(n){n.type===t.SeriesTypeEnum.map?n.setCoordinateHelper(i):(n.setXAxisHelper(o(o({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,o=t[0];if(w(o)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];o=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.x}return e.dataToLongitude(o)},valueToPosition:function(t,i){var r;if(w(t)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.x}return e.dataToLongitude(t)},getFields:function(){return[e._longitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})),n.setYAxisHelper(o(o({},i),{isContinuous:!0,dataToPosition:function(t,i){var r,o=t[0];if(w(o)&&(null==i?void 0:i.datum)){var a=i.datum[n.getDimensionField()[0]];o=null===(r=e._centerCache.get(a))||void 0===r?void 0:r.y}return e.dataToLatitude(o)},valueToPosition:function(t,i){var r;if(w(t)&&(null==i?void 0:i.datum)){var o=i.datum[n.getDimensionField()[0]];t=null===(r=e._centerCache.get(o))||void 0===r?void 0:r.y}return e.dataToLatitude(t)},getFields:function(){return[e._latitudeField]},getAxisType:function(){return e.type},getAxisId:function(){return e.id},isInverse:function(){return!1}})))}))}))},i.prototype.onLayoutEnd=function(i){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());var n=this.getLayoutRect(),r=n.width,o=n.height,a=this.evaluateProjection([0,0],[r,o]),s=a.translate,l=a.scale,u=a.center;s&&this._projection.translate(s),l&&this._projection.scale(l),u&&this._projection.center(u),tw(this._regions,(function(e){var i;if(e.type===t.SeriesTypeEnum.map){e.areaPath.clear();var n=null===(i=e.getRootMark().getProduct())||void 0===i?void 0:i.getGroupGraphicItem();n&&n.attribute.postMatrix&&n.setAttributes({postMatrix:new ke})}})),this._actualScale=this._initialScale,e.prototype.onLayoutEnd.call(this,i)},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.prototype.collectFeatures=function(){var e=[];return this._regions.forEach((function(i){i.getSeries().forEach((function(i){var n,r;i.type===t.SeriesTypeEnum.map&&e.push.apply(e,h([],c(null!==(r=null===(n=i.getMapViewData())||void 0===n?void 0:n.latestData)&&void 0!==r?r:[]),!1))}))})),e},i.prototype.dataToPosition=function(t){var e;void 0===t&&(t=[]);var i=null===(e=this._projection)||void 0===e?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}},i.prototype.dataToLatitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([0,t]);return null==i?void 0:i[1]},i.prototype.dataToLongitude=function(t){var e,i=null===(e=this._projection)||void 0===e?void 0:e.project([t,0]);return null==i?void 0:i[0]},i.prototype.zoom=function(t,e){var i,n,r,o,a,s;void 0===e&&(e=[0,0]);var l=null!==(n=null===(i=this._projection)||void 0===i?void 0:i.scale())&&void 0!==n?n:0,u=null!==(o=null===(r=this._projection)||void 0===r?void 0:r.translate())&&void 0!==o?o:[0,0],c=u[0],h=u[1];l*=t,c-=(e[0]-c)*(t-1),h-=(e[1]-h)*(t-1),null===(a=this._projection)||void 0===a||a.scale(l),null===(s=this._projection)||void 0===s||s.translate([c,h])},i.prototype.shape=function(t){return this._projection.shape(t)},i.prototype.invert=function(t){return this._projection.invert(t)},i.prototype.evaluateProjection=function(t,e){var i,n=this._projection.evaluate(t,e,this.collectFeatures()),r=n.translate(),o=n.scale()*this._initialScale,a=null!==(i=this._projectionSpec.center)&&void 0!==i?i:n.invert([e[0]/2,e[1]/2]);return a&&(r=[e[0]/2,e[1]/2]),{translate:r,scale:o,center:a}},i.prototype._initCenterCache=function(){var t=this;this._centerCache||(this._centerCache=new Map),this._regions.forEach((function(e){e.getSeries().forEach((function(e){var i,n;"map"===e.type&&(null!==(n=null===(i=e.getMapViewData())||void 0===i?void 0:i.latestData)&&void 0!==n?n:[]).forEach((function(i){void 0===i&&(i={});var n=i[e.getDimensionField()[0]]||i[WZ],r=e.getDatumCenter(i);n&&T(r)&&t._centerCache.set(n,{x:r[0],y:r[1]})}))}))}))},i.prototype.release=function(){e.prototype.release.call(this),this._centerCache&&this._centerCache.clear(),this._centerCache=null},i.type=f.geoCoordinate,i}(fq);ot(bq,mq);var xq=function(){FU.registerComponent(bq.type,bq)},kq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)},e}(fX),Sq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.map,i.transformerConstructor=kq,i._areaCache=new Map,i}return r(i,e),i.prototype.getNameMap=function(){return this._nameMap},Object.defineProperty(i.prototype,"areaPath",{get:function(){return this._areaCache},enumerable:!1,configurable:!0}),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null===(t=this._option)||void 0===t||t.onError("map type '".concat(this.map,"' is not specified !")),pY.get(this.map)||null===(i=this._option)||void 0===i||i.onError("'".concat(this.map,"' data is not registered !"))},i.prototype.initData=function(){var t,i,n=this;e.prototype.initData.call(this),hY(this._dataSet,"copyDataView",_Y),hY(this._dataSet,"map",UZ),hY(this._dataSet,"lookup",VZ);var r=pY.get(this.map);r||null===(t=this._option)||void 0===t||t.onError("no valid map data found!");var o=new Ma(this._dataSet,{name:"map_".concat(this.id,"_data")});o.parse([r],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:mY.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:function(){var t;return null===(t=n._data)||void 0===t?void 0:t.getLatestData()},key:WZ,fields:this._nameField,set:function(t,e){e&&Object.keys(e).forEach((function(i){i in t||(t[i]=e[i])}))}}}),null===(i=this._data)||void 0===i||i.getDataView().target.addListener("change",o.reRunAllTransform),this._mapViewData=new JK(this._option,o)},i.prototype.initMark=function(){this._pathMark=this._createMark(i.mark.area,{morph:cX(this._spec,i.mark.area.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this.getDimensionField()[0],isSeriesMark:!0,skipBeforeLayouted:!0,dataView:this._mapViewData.getDataView(),dataProductId:this._mapViewData.getProductId()})},i.prototype.initMarkStyle=function(){var e=this,i=this._pathMark;i&&(this.setMarkStyle(i,{fill:function(t){var i,n,r,o;return T(t[null!==(i=e._seriesField)&&void 0!==i?i:uV])?(null!==(n=e._option.globalScale.getScale("color"))&&void 0!==n?n:e._getDefaultColorScale()).scale(t[null!==(r=e._seriesField)&&void 0!==r?r:uV]):null===(o=e._spec)||void 0===o?void 0:o.defaultFillColor},path:this.getPath.bind(this)},"normal",t.AttributeLevel.Series),i.setPostProcess("fill",(function(t){return T(t)?t:e._spec.defaultFillColor})),this.setMarkStyle(i,{smoothScale:!0},"normal",t.AttributeLevel.Built_In),this._trigger.registerMark(i))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this._labelMark=t,this.setMarkStyle(t,{text:function(t){return e.getDatumName(t)},x:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.x},y:function(t){var i;return null===(i=e.dataToPosition(t))||void 0===i?void 0:i.y}}))},i.prototype.initAnimation=function(){var t;this._pathMark.setAnimationConfig(aX(null===(t=FU.getAnimationInKey("fadeInOut"))||void 0===t?void 0:t(),sX("area",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new YZ(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)},i.prototype.getPath=function(t){var e,i=this._areaCache.get(t[sV]);if(i)return i.shape;var n=null===(e=this._coordinateHelper)||void 0===e?void 0:e.shape(t);return this._areaCache.set(t[sV],{shape:n}),n},i.prototype.onEvaluateEnd=function(){this._mapViewData.updateData()},i.prototype.getDimensionField=function(){return[this.nameField]},i.prototype.getMeasureField=function(){return[this.valueField]},i.prototype.release=function(){e.prototype.release.call(this),this._areaCache.clear(),this._nameMap={},this._trigger=this._mapViewData=null},i.prototype.handleZoom=function(t){var e,i,n,r=t.scale,o=t.scaleCenter;if(1!==r){var a=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();a&&(a.attribute.postMatrix||a.setAttributes({postMatrix:new ke}),a.scale(r,r,o));var s=null===(n=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.getProduct();s&&s.evaluateSync(null,null)}},i.prototype.handlePan=function(t){var e,i,n,r=t.delta;if(0!==r[0]||0!==r[1]){var o=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();o&&(o.attribute.postMatrix||o.setAttributes({postMatrix:new ke}),o.translate(r[0],r[1]));var a=null===(n=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===n?void 0:n.getProduct();a&&a.evaluateSync(null,null)}},i.prototype.getDatumCenter=function(t){var e,i,n,r;return this._centroidProperty&&(null===(e=t.properties)||void 0===e?void 0:e[this._centroidProperty])?null===(i=t.properties)||void 0===i?void 0:i[this._centroidProperty]:F(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null===(n=t.properties)||void 0===n?void 0:n.center)?t.properties.center:(null===(r=t.properties)||void 0===r?void 0:r.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]},i.prototype.getDatumName=function(t){var e,i,n,r;return t[this.nameField]?t[this.nameField]:(null===(e=t.properties)||void 0===e?void 0:e[this._nameProperty])?(null===(i=this._spec)||void 0===i?void 0:i.nameMap)?null!==(n=this._spec.nameMap[t.properties[this._nameProperty]])&&void 0!==n?n:"":null!==(r=t.properties[this._nameProperty])&&void 0!==r?r:"":""},i.prototype.dataToPositionX=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.dataToPositionY=function(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0},i.prototype.viewDataUpdate=function(t){var i,n,r;e.prototype.viewDataUpdate.call(this,t),null===(n=null===(i=this._mapViewData)||void 0===i?void 0:i.getDataView())||void 0===n||n.reRunAllTransform(),null===(r=this._mapViewData)||void 0===r||r.updateData()},i.prototype._getDataIdKey=function(){return sV},i.prototype.getActiveMarks=function(){return[this._pathMark]},i.type=t.SeriesTypeEnum.map,i.mark=SG,i.transformerConstructor=kq,i}(GZ),Aq=function(){gT.registerGrammar("projection",NZ,"projections"),xq(),XZ(),FU.registerSeries(Sq.type,Sq),FU.registerImplement("registerMap",vY),FU.registerImplement("unregisterMap",yY),wK()},wq=function(t,e){if(!t||0===t.length)return t;var i=e.indexField,n=e.valueField,r=e.startAs,a=e.endAs,s=e.total,l=e.seriesField,u=e.seriesFieldName,c=e.groupData,h=[],d=c().latestData,f=d.dimensionValues,p=d.dimensionData,v=Array.from(f[i]),y={start:0,end:0,lastIndex:null};return v.forEach((function(t,e){var i={start:y.end,end:y.end,lastIndex:y.lastIndex,lastEnd:y.end,index:t,isTotal:!1};p[t].forEach((function(t){var o=!1;if(s&&"end"!==s.type){if("field"===s.type||"custom"===s.type){if(t[s.tagField])if(o=!0,"custom"===s.type){var c=s.product(t,y),d=c.start,f=c.end;t[r]=d,t[a]=f,i.end=f,i.start=d}else{d=0,f=i.end;if(s.collectCountField&&!w(t[s.collectCountField])){var p=h.length-+t[s.collectCountField],g=h.length-1;p<0?console.warn("total.collectCountField error"):d=h[p].start,g<0?console.warn("total.collectCountField error"):f=h[g].end}else s.startField&&!w(t[s.startField])&&(d=+t[s.startField]),s.valueField&&!w(t[s.valueField])&&(f=oe(d,+t[s.valueField]));t[r]=d,t[a]=f,t[n]=f-d,i.start=d,i.end=f}}}else e===v.length-1&&(i.start=0,t[r]=i.start,t[a]=i.end,o=!0);o||(t[r]=+i.end,t[a]=oe(t[r],+t[n]),i.end=t[a]),i.isTotal=o,(w(l)||l===iV)&&(t[iV]=o?u.total:+t[n]>=0?u.increase:u.decrease)})),y=o(o({},i),{lastIndex:t}),h.push(i)})),h},Tq=function(t,e){var i;if(!t)return t;var n=e.indexField,r=e.valueField,o=e.total,a=e.seriesField,s=((i={})[n]=(null==o?void 0:o.text)||"total",i[r]=t.reduce((function(t,e){return oe(t,+e[r])}),0),i);return a&&(s[a]="total"),t.push(s),t},Mq={type:"fadeIn"},Cq={type:"growCenterIn"};function Eq(t,e){switch(e){case"fadeIn":return Mq;case"scaleIn":return Cq;default:return QX(t,!1)}}var Rq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{x1:0,y1:0})},e.type="rule",e}(vK),Pq=function(){FU.registerMark(Rq.type,Rq),$j()},Bq=function(t,e){if(!e.fields)return t;var i={};return{dimensionValues:i,dimensionData:Lq(t.map((function(t){return t.latestData})).flat(),e.fields,i)}};function Lq(t,e,i){if(0===e.length)return t;var n=e[0],r=e.slice(1);i[n]=new Set;var o,a,s=function(t,e,i){var n={};return t.forEach((function(t){var r=t[e];n[r]||(n[r]=[],i.add(r)),n[r].push(t)})),n}(t,n,i[n]);return r.length?(o=s,a=function(t,e){return Lq(t,r,i)},Object.keys(o).reduce((function(t,e){return t[e]=a(o[e],e),t}),{})):s}var Oq,Iq=function(){function t(t){this._fields=[],this._fields=t}return Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupData",{get:function(){return this._groupData},enumerable:!1,configurable:!0}),t.prototype.initData=function(t,e){var i=t.name,n=new Ma(e instanceof wa?e:t.dataSet);n.name=i,n.parse([t],{type:"dataview"}),hY(e,"dimensionTree",Bq),n.transform({type:"dimensionTree",options:{fields:this._fields}},!1),n.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=n},t.prototype.groupDataUpdate=function(){},t.prototype.getGroupValueInField=function(t){var e,i,n,r=null===(n=null===(i=null===(e=this.groupData)||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.dimensionValues)||void 0===n?void 0:n[t];return r?Array.from(r):[]},t}(),Dq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel")},e}(aZ),Fq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.waterfall,i.transformerConstructor=Dq,i._stack=!1,i._leaderLineMark=null,i._stackLabelMark=null,i._labelMark=null,i}return r(i,e),i.prototype.getTotalData=function(){var t;return null===(t=this._totalData)||void 0===t?void 0:t.getLatestData()},i.prototype.initGroups=function(){var t=this.getGroupFields();t&&t.length&&(this._groups=new Iq(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],w(this._seriesField)&&(this._seriesField=iV)},i.prototype.getSeriesKeys=function(){return this._seriesField===iV?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:e.prototype.getSeriesKeys.call(this)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),hY(this._dataSet,"waterfallFillTotal",Tq),hY(this._dataSet,"waterfall",wq),(w(this._spec.total)||"end"===this._spec.total.type)&&(null===(t=this._rawData)||void 0===t||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total}},!1));var n=bY(this.getViewData(),this._dataSet,{name:"".concat(bw,"_series_").concat(this.id,"_totalData")});this.getViewData().target.removeListener("change",n.reRunAllTransform),this._totalData=new JK(this._option,n),n.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:fV,endAs:pV,total:this._spec.total,groupData:function(){return i.getGroups().groupData}}},!1)},i.prototype.initAnimation=function(){var t,e,i,n,r=this,o={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:function(){var t,e;return"horizontal"===r.direction?null===(t=r._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=r._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,s=yX(this);this._barMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("waterfall"))||void 0===i?void 0:i(o,a),sX("bar",this._spec,this._markAttributeContext),s)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),sX("leaderLine",this._spec,this._markAttributeContext)))},i.prototype.viewDataUpdate=function(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),e.prototype.viewDataUpdate.call(this,t)},i.prototype.addViewDataFilter=function(t){},i.prototype.reFilterViewData=function(){},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._totalData.updateData()},i.prototype.initMark=function(){var t;e.prototype.initMark.call(this);var n=this._createMark(i.mark.leaderLine,{key:"index",customShape:null===(t=this._spec.leaderLine)||void 0===t?void 0:t.customShape});n&&(this._leaderLineMark=n,n.setDataView(this._totalData.getDataView(),this._totalData.getProductId()))},i.prototype.initLabelMarkStyle=function(t){var i,n=this;if(t){if(!this._labelMark&&(null===(i=this._spec.label)||void 0===i?void 0:i.visible))return e.prototype.initLabelMarkStyle.call(this,t),void(this._labelMark=t);this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setDataView(this._totalData.getDataView(),this._totalData.getProductId()),this.setMarkStyle(t,{text:function(t){var e;return"absolute"===(null===(e=n._spec.stackLabel)||void 0===e?void 0:e.valueType)?t.end:function(t,e){return ne(t-e,Math.pow(10,Math.max(re(t),re(e))))}(t.end,t.start)}})}},i.prototype.totalPositionX=function(t,e,i){void 0===i&&(i=.5);var n=this._xAxisHelper,r=n.dataToPosition,o=n.getBandwidth;return"vertical"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*o(0)-this._barMark.getAttribute("width",t)*(.5-i):aW(r([t[e]],{bandPosition:this._bandPosition}))},i.prototype.totalPositionY=function(t,e,i){void 0===i&&(i=.5);var n=this._yAxisHelper,r=n.dataToPosition,o=n.getBandwidth;return"vertical"===this._direction?aW(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*o(0)-this._barMark.getAttribute("height",t)*(.5-i)},i.prototype.initMarkStyle=function(){var i=this;e.prototype.initMarkStyle.call(this),this._leaderLineMark&&("vertical"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:function(t){return!w(t.lastIndex)},x:function(t){return t.lastIndex?i.totalPositionX(t,"lastIndex",1):0},x1:function(t){return i.totalPositionX(t,"index",0)},y:function(t){return i.totalPositionY(t,"lastEnd",0)},y1:function(t){return i.totalPositionY(t,t.isTotal?"end":"start",0)}},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._leaderLineMark,{visible:function(t){return!w(t.lastIndex)},x:function(t){return i.totalPositionX(t,"lastEnd",0)},x1:function(t){return i.totalPositionX(t,t.isTotal?"end":"start",0)},y:function(t){return t.lastIndex?i.totalPositionY(t,"lastIndex",1):0},y1:function(t){return i.totalPositionY(t,"index",0)}},"normal",t.AttributeLevel.Series))},i.type=t.SeriesTypeEnum.waterfall,i.mark=BG,i.transformerConstructor=Dq,i}(sZ),zq=function(){Pq(),rZ(),FU.registerAnimation("waterfall",(function(t,e){return{appear:Eq(t,e),enter:QX(t,!1),exit:$X(t,!1),disappear:$X(t,!1)}})),wK(),FU.registerSeries(Fq.type,Fq)},jq="".concat(bw,"_BOX_PLOT_OUTLIER_VALUE");!function(t){t.OUTLIER="outlier",t.MAX="max",t.MIN="min",t.MEDIAN="median",t.Q1="q1",t.Q3="q3",t.SERIES_FIELD="seriesField"}(Oq||(Oq={}));var Hq=function(t,e){var i=[],n=e.outliersField,r=e.dimensionField;return(t[0].latestData||[]).forEach((function(t){var e=t[n];B(e)||(e=[e]),i.push.apply(i,h([],c(e.map((function(e){var i,n=((i={})[jq]=e,i);return r.forEach((function(e){n[e]=t[e]})),n}))),!1))})),i},Nq=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getContentKey=function(t){return function(i){if(e.isOutlierMark(i))return t===Oq.OUTLIER?e.series.getOutliersField():t===Oq.SERIES_FIELD?e.series.getSeriesField():null;switch(t){case Oq.MIN:return e.series.getMinField();case Oq.MAX:return e.series.getMaxField();case Oq.MEDIAN:return e.series.getMedianField();case Oq.Q1:return e.series.getQ1Field();case Oq.Q3:return e.series.getQ3Field();case Oq.SERIES_FIELD:return e.series.getSeriesField()}return null}},e.getContentValue=function(t){return function(i){if(e.isOutlierMark(i))return t===Oq.OUTLIER?i[jq]:t===Oq.SERIES_FIELD?i[e.series.getSeriesField()]:null;switch(t){case Oq.MIN:return i[e.series.getMinField()];case Oq.MAX:return i[e.series.getMaxField()];case Oq.MEDIAN:return i[e.series.getMedianField()];case Oq.Q1:return i[e.series.getQ1Field()];case Oq.Q3:return i[e.series.getQ3Field()];case Oq.SERIES_FIELD:return i[e.series.getSeriesField()]}return null}},e.contentShapeColorCallback=function(t){return"line"===e.series.getShaftShape()?e.series.getMarkInName("boxPlot").getAttribute("stroke",t):e.series.getMarkInName("boxPlot").getAttribute("fill",t)},e.getOutlierFillColor=function(t){var i,n=e.series.getOutliersStyle();return null!==(i=null==n?void 0:n.fill)&&void 0!==i?i:e.series.getMarkInName("outlier").getAttribute("fill",t)},e.isOutlierMark=function(t){return T(t[jq])},e}return r(e,t),e.prototype.getDefaultTooltipPattern=function(t){return{visible:!0,activeType:t,title:{key:void 0,value:this.titleValueCallback,hasShape:!1},content:[{key:this.getContentKey(Oq.OUTLIER),value:this.getContentValue(Oq.OUTLIER),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor,shapeHollow:!1},{key:this.getContentKey(Oq.MAX),value:this.getContentValue(Oq.MAX),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1},{key:this.getContentKey(Oq.Q3),value:this.getContentValue(Oq.Q3),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1},{key:this.getContentKey(Oq.MEDIAN),value:this.getContentValue(Oq.MEDIAN),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1},{key:this.getContentKey(Oq.Q1),value:this.getContentValue(Oq.Q1),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1},{key:this.getContentKey(Oq.MIN),value:this.getContentValue(Oq.MIN),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1},{key:this.getContentKey(Oq.SERIES_FIELD),value:this.getContentValue(Oq.SERIES_FIELD),hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1}]}},e}(YK),Vq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})},e.prototype._initProduct=function(t){var e=this.getStyle("shaftShape"),i=this.getVGrammarView(),n=this.getProductId(),r="bar"===e?"barBoxplot":"boxplot",o=this.getStyle("direction");this._product=i.glyph(r,null!=t?t:i.rootMark).id(n).configureGlyph({direction:o}),this._compiledProductId=n},e.type="boxPlot",e}(vK),Gq=function(){FU.registerMark(Vq.type,Vq),gT.registerGlyph("boxplot",{shaft:"rule",box:"rect",max:"rule",min:"rule",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","boxWidth","boxHeight","ruleWidth","ruleHeight"]).registerFunctionEncoder(aH).registerChannelEncoder("x",(function(t,e,i,n,r,o){return o&&pS(o.direction)?null:{shaft:{x:e,x1:e}}})).registerChannelEncoder("y",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{shaft:{y:e,y1:e}}:null})).registerChannelEncoder("q1",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{box:{x:e}}:{box:{y:e}}})).registerChannelEncoder("q3",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{box:{x1:e}}:{box:{y1:e}}})).registerChannelEncoder("min",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{shaft:{x:e},min:{x:e,x1:e,visible:!0}}:{shaft:{y:e},min:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("max",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{shaft:{x1:e},max:{x:e,x1:e,visible:!0}}:{shaft:{y1:e},max:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("median",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("angle",(function(t,e,i,n,r,o){var a,s=o&&pS(o.direction)?[(i.min+i.max)/2,i.y]:[i.x,(i.min+i.max)/2],l=null!==(a=i.anchor)&&void 0!==a?a:s;return{shaft:{angle:e,anchor:l},box:{angle:e,anchor:l},max:{angle:e,anchor:l},min:{angle:e,anchor:l},median:{angle:e,anchor:l}}})).registerDefaultEncoder((function(){return{max:{visible:!1},min:{visible:!1},median:{visible:!1}}})),gT.registerAnimationType("boxplotScaleIn",sH),gT.registerAnimationType("boxplotScaleOut",lH),iH(),Qj(),$j(),gT.registerGlyph("barBoxplot",{minMaxBox:"rect",q1q3Box:"rect",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","minMaxWidth","q1q3Width","minMaxHeight","q1q3Height"]).registerFunctionEncoder(cH).registerChannelEncoder("q1",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{q1q3Box:{x:e}}:{q1q3Box:{y:e}}})).registerChannelEncoder("q3",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{q1q3Box:{x1:e}}:{q1q3Box:{y1:e}}})).registerChannelEncoder("min",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{minMaxBox:{x:e}}:{minMaxBox:{y:e}}})).registerChannelEncoder("max",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{minMaxBox:{x1:e}}:{minMaxBox:{y1:e}}})).registerChannelEncoder("median",(function(t,e,i,n,r,o){return o&&pS(o.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}})).registerChannelEncoder("angle",(function(t,e,i,n,r,o){var a,s=null!==(a=i.anchor)&&void 0!==a?a:[i.x,(i.min+i.max)/2];return{minMaxBox:{angle:e,anchor:s},q1q3Box:{angle:e,anchor:s},median:{angle:e,anchor:s}}})).registerChannelEncoder("lineWidth",(function(t,e,i,n,r,o){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}}})).registerChannelEncoder("minMaxFillOpacity",(function(t,e,i,n,r,o){return{minMaxBox:{fillOpacity:e}}})).registerChannelEncoder("stroke",(function(t,e,i,n,r,o){return{minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}}})).registerDefaultEncoder((function(){return{minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0},median:{visible:!1}}})),gT.registerAnimationType("barBoxplotScaleIn",hH),gT.registerAnimationType("barBoxplotScaleOut",dH),iH(),Qj(),$j()},Wq=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.boxPlot,i}return r(i,e),i.prototype.getMinField=function(){return this._minField},i.prototype.getMaxField=function(){return this._maxField},i.prototype.getQ1Field=function(){return this._q1Field},i.prototype.getMedianField=function(){return this._medianField},i.prototype.getQ3Field=function(){return this._q3Field},i.prototype.getOutliersField=function(){return this._outliersField},i.prototype.getShaftShape=function(){return this._shaftShape},i.prototype.getBoxFillColor=function(){return this._boxFillColor},i.prototype.getStrokeColor=function(){return this._strokeColor},i.prototype.getOutliersStyle=function(){return this._outliersStyle},i.prototype.setAttrFromSpec=function(){var t,i,n,r,o;e.prototype.setAttrFromSpec.call(this);var a=null!==(i=null===(t=this._spec.boxPlot)||void 0===t?void 0:t.style)&&void 0!==i?i:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!==(n=a.lineWidth)&&void 0!==n?n:2,this._boxWidth=a.boxWidth,this._shaftShape=null!==(r=a.shaftShape)&&void 0!==r?r:"line",this._shaftWidth=a.shaftWidth,this._boxFillColor=a.boxFill,this._strokeColor=a.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!==(o=a.shaftFillOpacity)&&void 0!==o?o:.5:void 0,this._outliersStyle=this._spec.outliersStyle},i.prototype.initMark=function(){var t={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._boxPlotMark=this._createMark(i.mark.boxPlot,{isSeriesMark:!0,progressive:t}),this._outlierMark=this._createMark(i.mark.outlier,{progressive:t,key:sV,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()})},i.prototype.initMarkStyle=function(){var e,i,n,r,a,s=this,l=this._boxPlotMark;if(l){var u={direction:this._direction,lineWidth:this._lineWidth,shaftShape:this._shaftShape,fill:null!==(e=this._boxFillColor)&&void 0!==e?e:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!==(i=this._strokeColor)&&void 0!==i?i:"line"===this._shaftShape?this.getColorAttribute():"#000"},c="vertical"===this._direction?o(o({x:this.dataToPositionX.bind(this)},u),{boxWidth:function(){var t;return null!==(t=s._boxWidth)&&void 0!==t?t:s._getMarkWidth()},ruleWidth:function(){var t;return null!==(t=s._shaftWidth)&&void 0!==t?t:s._getMarkWidth()},q1q3Width:function(){var t;return null!==(t=s._boxWidth)&&void 0!==t?t:s._getMarkWidth()},minMaxWidth:function(){var t;return null!==(t=s._shaftWidth)&&void 0!==t?t:s._getMarkWidth()}}):o(o({y:this.dataToPositionY.bind(this)},u),{boxHeight:function(){var t;return null!==(t=s._boxWidth)&&void 0!==t?t:s._getMarkWidth()},ruleHeight:function(){var t;return null!==(t=s._shaftWidth)&&void 0!==t?t:s._getMarkWidth()},q1q3Height:function(){var t;return null!==(t=s._boxWidth)&&void 0!==t?t:s._getMarkWidth()},minMaxHeight:function(){var t;return null!==(t=s._shaftWidth)&&void 0!==t?t:s._getMarkWidth()}});this.setMarkStyle(l,c,MY.STATE_NORMAL,t.AttributeLevel.Series),this._trigger.registerMark(l)}var h=this._outlierMark;h&&(this.setMarkStyle(h,{fill:null!==(r=null===(n=this._outliersStyle)||void 0===n?void 0:n.fill)&&void 0!==r?r:this.getColorAttribute(),size:I(null===(a=this._outliersStyle)||void 0===a?void 0:a.size)?this._outliersStyle.size:10,symbolType:"circle"},MY.STATE_NORMAL,t.AttributeLevel.Series),this._trigger.registerMark(h))},i.prototype.initBoxPlotMarkStyle=function(){var e,i,n=this,r=this._boxPlotMark,o="vertical"===this._direction?this._yAxisHelper:this._xAxisHelper;if(r&&o){var a=o.dataToPosition,s=null===(e=null==o?void 0:o.getScale)||void 0===e?void 0:e.call(o,0);this.setMarkStyle(r,{min:function(t){return aW(a(n.getDatumPositionValues(t,n._minField),{bandPosition:n._bandPosition}),s)},q1:function(t){return aW(a(n.getDatumPositionValues(t,n._q1Field),{bandPosition:n._bandPosition}),s)},median:function(t){return aW(a(n.getDatumPositionValues(t,n._medianField),{bandPosition:n._bandPosition}),s)},q3:function(t){return aW(a(n.getDatumPositionValues(t,n._q3Field),{bandPosition:n._bandPosition}),s)},max:function(t){return aW(a(n.getDatumPositionValues(t,n._maxField),{bandPosition:n._bandPosition}),s)}},MY.STATE_NORMAL,t.AttributeLevel.Series)}var l=this._outlierMark;if(l&&o){var u=o.dataToPosition,c=null===(i=null==o?void 0:o.getScale)||void 0===i?void 0:i.call(o,0),h="vertical"===this._direction?{x:this.dataToPositionX.bind(this),y:function(t){return aW(u(n.getDatumPositionValues(t,jq),{bandPosition:n._bandPosition}),c)}}:{y:this.dataToPositionY.bind(this),x:function(t){return aW(u(n.getDatumPositionValues(t,jq),{bandPosition:n._bandPosition}),c)}};this.setMarkStyle(l,h,MY.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){hY(this._dataSet,"foldOutlierData",Hq),hY(this._dataSet,"addVChartProperty",GK);var t=new Ma(this._dataSet,{name:"".concat(this.type,"_outlier_").concat(this.id,"_data")});t.parse([this.getViewData()],{type:"dataview"}),t.name="".concat(bw,"_series_").concat(this.id,"_outlierData"),t.transform({type:"foldOutlierData",options:{dimensionField:"vertical"===this._direction?this._fieldX:this._fieldY,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:eX.bind(this),call:iX}},!1),this._outlierDataView=new JK(this._option,t)}},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initBoxPlotMarkStyle()},i.prototype._getMarkWidth=function(){if(this._autoBoxWidth)return this._autoBoxWidth;var t="vertical"===this._direction?this._xAxisHelper:this._yAxisHelper,e="vertical"===this._direction?this._fieldX:this._fieldY,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._autoBoxWidth=null},i.prototype._initAnimationSpec=function(t){var e=this;void 0===t&&(t={});var i=Q({},t);return["appear","enter","update","exit","disappear"].forEach((function(t){i[t]&&"scaleIn"===i[t].type?i[t].type="line"===e._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":i[t]&&"scaleOut"===i[t].type&&(i[t].type="line"===e._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")})),i},i.prototype.initAnimation=function(){var t,e,i,n,r,o,a,s=yX(this);if(this._boxPlotMark){var l=this._initAnimationSpec(null===(t=FU.getAnimationInKey("scaleInOut"))||void 0===t?void 0:t()),u=this._initAnimationSpec(sX("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(aX(l,u,s))}if(this._outlierMark){var c={appear:null===(e=this._spec.animationAppear)||void 0===e?void 0:e.symbol,disappear:null===(i=this._spec.animationDisappear)||void 0===i?void 0:i.symbol,enter:null===(n=this._spec.animationEnter)||void 0===n?void 0:n.symbol,exit:null===(r=this._spec.animationExit)||void 0===r?void 0:r.symbol,update:null===(o=this._spec.animationUpdate)||void 0===o?void 0:o.symbol};this._outlierMark.setAnimationConfig(aX(null===(a=FU.getAnimationInKey("scaleInOut"))||void 0===a?void 0:a(),c,s))}},i.prototype.initTooltip=function(){this._tooltipHelper=new Nq(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)},i.prototype.getStatisticFields=function(){var t=this,i=e.prototype.getStatisticFields.call(this),n=i.find((function(e){return e.key===t._outliersField}));return n&&(n.operations=["array-min","array-max"]),i},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t),this._outlierDataView.updateData()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._boxPlotMark]},i.type=t.SeriesTypeEnum.boxPlot,i.mark=LG,i}(gX),Uq=function(){Gq(),TX(),AK(),FU.registerSeries(Wq.type,Wq)},Yq=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();"rich"===this.getStyle("textType")?this._product=e.mark(sw.richtext,null!=t?t:e.rootMark).id(i):this._product=e.mark(sw.text,null!=t?t:e.rootMark).id(i),this._compiledProductId=i},e.type="text",e}(vK),Kq=function(){FU.registerMark(Yq.type,Yq),eH(),jL(),FL(),gT.registerGraphic(sw.richtext,Ly)};function Xq(e,i,n,r,o,a,s,l,u){e.setMarkStyle(i,{textAlign:function(t){if("vertical"===u())return"center";var e=o(t),i=a(t);if("middle"===n)return"center";if(e>=i){if("start"===n)return"left";if("end"===n)return"right";if("outside"===n)return"left"}else{if("start"===n)return"right";if("end"===n)return"left";if("outside"===n)return"right"}return"center"},textBaseline:function(t){if("horizontal"===u())return"middle";var e=s(t),i=l(t);if("middle"===n)return"middle";if(i>=e){if("start"===n)return"bottom";if("end"===n)return"top";if("outside"===n)return"bottom"}else{if("start"===n)return"top";if("end"===n)return"bottom";if("outside"===n)return"top"}return"middle"}}),e.setMarkStyle(i,{x:function(t){var e=u(),i=o(t),s=a(t);if("vertical"===e)return(i+s)/2;if("middle"===n)return(i+s)/2;if(i>=s){if("start"===n)return s+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return s-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+s)/2},y:function(t){var e=u(),i=s(t),o=l(t);if("horizontal"===e)return(i+o)/2;if("middle"===n)return(i+o)/2;if(i>=o){if("start"===n)return o+r;if("end"===n)return i-r;if("outside"===n)return i+r}else{if("start"===n)return o-r;if("end"===n)return i+r;if("outside"===n)return i-r}return(i+o)/2}},"normal",t.AttributeLevel.Series)}var Zq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(t){var e=this;return{visible:!0,activeType:t,title:{key:void 0,value:this.titleValueCallback,hasShape:!1},content:[{key:this.contentKeyCallback,value:function(t){return"horizontal"===e.series.getSpec().direction?t[e.series.getSpec().xField[0]]+"-"+t[e.series.getSpec().xField[1]]:t[e.series.getSpec().yField[0]]+"-"+t[e.series.getSpec().yField[1]]},hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1}]}},e}(YK),qq=function(t){return{type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}},Jq={type:"fadeIn"},Qq=function(t){return{type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}};function $q(t,e){return"fadeIn"===e?Jq:qq(t)}var tJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){var e;"bothEnd"!==(null===(e=t.label)||void 0===e?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")},e}(aZ),eJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn,i._barMarkType="rect",i._barName=t.SeriesTypeEnum.bar,i.transformerConstructor=tJ,i._stack=!1,i}return r(i,e),i.prototype.initMark=function(){var t,e,n,r,o,a,s,l,u;this._initBarBackgroundMark();var c=null===(t=this._spec.label)||void 0===t?void 0:t.position;this._barMark=this._createMark(i.mark.bar,{morph:cX(this._spec,i.mark.bar.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(e=this._spec.bar)||void 0===e?void 0:e.customShape}),!1!==(null===(n=this._spec.label)||void 0===n?void 0:n.visible)&&"bothEnd"===c&&(!1!==(null===(o=null===(r=this._spec.label)||void 0===r?void 0:r.minLabel)||void 0===o?void 0:o.visible)&&(this._minLabelMark=this._createMark(i.mark.minLabel,{markSpec:null===(a=this._spec.label)||void 0===a?void 0:a.minLabel})),!1!==(null===(l=null===(s=this._spec.label)||void 0===s?void 0:s.maxLabel)||void 0===l?void 0:l.visible)&&(this._maxLabelMark=this._createMark(i.mark.maxLabel,{markSpec:null===(u=this._spec.label)||void 0===u?void 0:u.maxLabel})))},i.prototype.initMarkStyle=function(){var t,i,n,r,o,a,s,l,u,c,h=this;e.prototype.initMarkStyle.call(this);var d=this._minLabelMark,f=null===(t=this._spec.label)||void 0===t?void 0:t.minLabel;d&&(this.setMarkStyle(d,{fill:null!==(n=null===(i=null==f?void 0:f.style)||void 0===i?void 0:i.fill)&&void 0!==n?n:this.getColorAttribute(),text:function(t){var e="horizontal"===h._spec.direction?t[h._spec.xField[0]]:t[h._spec.yField[0]];return(null==f?void 0:f.formatMethod)?f.formatMethod(e,t):e}}),Xq(this,d,null!==(r=null==f?void 0:f.position)&&void 0!==r?r:"end",null!==(o=null==f?void 0:f.offset)&&void 0!==o?o:"vertical"===this._direction?-20:-25,(function(t){return h._barMark.getAttribute("x",t)}),(function(t){return"vertical"===h._direction?h._barMark.getAttribute("x",t)+h._barMark.getAttribute("width",t):h._barMark.getAttribute("x1",t)}),(function(t){return h._barMark.getAttribute("y",t)}),(function(t){return"vertical"===h._direction?h._barMark.getAttribute("y1",t):h._barMark.getAttribute("y",t)+h._barMark.getAttribute("height",t)}),(function(){return h._direction})));var p=this._maxLabelMark,v=null===(a=this._spec.label)||void 0===a?void 0:a.maxLabel;p&&(this.setMarkStyle(p,{fill:null!==(l=null===(s=null==v?void 0:v.style)||void 0===s?void 0:s.fill)&&void 0!==l?l:this.getColorAttribute(),text:function(t){var e="horizontal"===h._spec.direction?t[h._spec.xField[1]]:t[h._spec.yField[1]];return(null==v?void 0:v.formatMethod)?v.formatMethod(e,t):e}}),Xq(this,p,null!==(u=null==v?void 0:v.position)&&void 0!==u?u:"start",null!==(c=null==v?void 0:v.offset)&&void 0!==c?c:"vertical"===this._direction?-20:-25,(function(t){return h._barMark.getAttribute("x",t)}),(function(t){return"vertical"===h._direction?h._barMark.getAttribute("x",t)+h._barMark.getAttribute("width",t):h._barMark.getAttribute("x1",t)}),(function(t){return h._barMark.getAttribute("y",t)}),(function(t){return"vertical"===h._direction?h._barMark.getAttribute("y1",t):h._barMark.getAttribute("y",t)+h._barMark.getAttribute("height",t)}),(function(){return h._direction})))},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&(this.setMarkStyle(t,{text:function(t){var i,n;return"horizontal"===e._spec.direction?(i=t[e._spec.xField[0]],n=t[e._spec.xField[1]]):(i=t[e._spec.yField[0]],n=t[e._spec.yField[1]]),i+"-"+n},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)},i.prototype._dataToPosX=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosX1=function(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})},i.prototype._dataToPosY1=function(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})},i.prototype.initAnimation=function(){var t,e,i,n,r,o=yX(this),a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._barMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("rangeColumn"))||void 0===i?void 0:i({direction:this.direction},a),sX("bar",this._spec,this._markAttributeContext),o)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),sX("label",this._spec,this._markAttributeContext),o)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(aX(null===(r=FU.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),sX("label",this._spec,this._markAttributeContext),o))},i.prototype.initTooltip=function(){this._tooltipHelper=new Zq(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)},i.type=t.SeriesTypeEnum.rangeColumn,i.mark=jG,i.transformerConstructor=tJ,i}(sZ),iJ=function(){rZ(),Kq(),FU.registerAnimation("rangeColumn",(function(t,e){return{appear:$q(t,e),enter:qq(t),exit:Qq(t),disappear:Qq(t)}})),wK(),FU.registerSeries(eJ.type,eJ)},nJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeColumn3d,i._barMarkType="rect3d",i._barName=t.SeriesTypeEnum.bar3d,i}return r(i,e),i.type=t.SeriesTypeEnum.rangeColumn3d,i.mark=HG,i}(eJ),rJ=function(){fZ(),FU.registerSeries(nJ.type,nJ)},oJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(t,e){var i=this;if("mark"===t)return{visible:!0,activeType:t,title:{key:void 0,value:this.titleValueCallback,hasShape:!1},content:[{key:this.contentKeyCallback,value:this.contentValueCallback,hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1}]};if("dimension"===t&&e){var n={key:void 0,value:this._getDimensionData,hasShape:!1},r=[];return e.forEach((function(t){return t.data.forEach((function(t){var e=t.series;"rangeArea"===e.type&&r.push({seriesId:e.id,key:i.contentKeyCallback,value:function(t){return"horizontal"===i.series.getSpec().direction?t[i.series.getSpec().xField[0]]+"-"+t[i.series.getSpec().xField[1]]:t[i.series.getSpec().yField[0]]+"-"+t[i.series.getSpec().yField[1]]},hasShape:!0,shapeType:i.contentShapeTypeCallback,shapeColor:i.contentShapeColorCallback,shapeStroke:i.contentShapeColorCallback,shapeHollow:!1})}))})),{visible:!0,activeType:t,title:n,content:r}}return null},e}(YK),aJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rangeArea,i}return r(i,e),i.prototype.initMark=function(){var t;this._areaMark=this._createMark(i.mark.area,{defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(t=this._spec.area)||void 0===t?void 0:t.customShape})},i.prototype.initMarkStyle=function(){var e,i,n,r,o,a=this,s=null!==(n=null===(i=null===(e=this.getSpec().area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.curveType)&&void 0!==n?n:null===(o=null===(r=this.getSpec().line)||void 0===r?void 0:r.style)||void 0===o?void 0:o.curveType,l=s===mX?"vertical"===this._direction?"monotoneX":"monotoneY":s,u=this._areaMark;u&&("vertical"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),y1:function(t){return a._yAxisHelper?(0,a._yAxisHelper.dataToPosition)(a.getDatumPositionValues(t,a._spec.yField[1]),{bandPosition:a._bandPosition}):Number.NaN},y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:function(t){return a._xAxisHelper?(0,a._xAxisHelper.dataToPosition)(a.getDatumPositionValues(t,a._spec.xField[1]),{bandPosition:a._bandPosition}):Number.NaN},y:this.dataToPositionY.bind(this),orient:this._direction},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{fill:this.getColorAttribute(),stroke:!1},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(u,{defined:this._getInvalidDefined,connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.setMarkStyle(u,{curveType:l},"normal",t.AttributeLevel.Built_In),this._trigger.registerMark(u))},i.prototype.initTooltip=function(){this._tooltipHelper=new oJ(this),this._areaMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._areaMark)},i.prototype.viewDataStatisticsUpdate=function(t){e.prototype.viewDataStatisticsUpdate.call(this,t),this.encodeDefined(this._areaMark,"defined")},i.type=t.SeriesTypeEnum.rangeArea,i.mark=WG,i}(YX),sJ=function(){HX(),FU.registerSeries(aJ.type,aJ)},lJ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coordinate="polar",e._outerRadius=Nw,e._innerRadius=0,e._angleField=[],e._radiusField=[],e._sortDataByAxis=!1,e._getInvalidDefined=function(t){return!(e.angleAxisHelper.isContinuous&&!Qk(t[e._angleField[0]]))&&!(e.radiusAxisHelper.isContinuous&&!Qk(t[e._radiusField[0]]))},e}return r(e,t),Object.defineProperty(e.prototype,"outerRadius",{get:function(){return this._outerRadius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerRadius",{get:function(){return this._innerRadius},enumerable:!1,configurable:!0}),e.prototype.getAngleField=function(){return this._angleField},e.prototype.setAngleField=function(t){return this._angleField=T(t)?lt(t):[],this._angleField},e.prototype.getRadiusField=function(){return this._radiusField},e.prototype.setRadiusField=function(t){return this._radiusField=T(t)?lt(t):[],this._radiusField},Object.defineProperty(e.prototype,"innerRadiusField",{get:function(){return this._innerRadiusField},enumerable:!1,configurable:!0}),e.prototype.setInnerRadiusField=function(t){return this._innerRadiusField=lt(t),this._innerRadiusField},Object.defineProperty(e.prototype,"radiusScale",{get:function(){return this._radiusScale},enumerable:!1,configurable:!0}),e.prototype.setRadiusScale=function(t){return this._radiusScale=t,t},Object.defineProperty(e.prototype,"angleScale",{get:function(){return this._angleScale},enumerable:!1,configurable:!0}),e.prototype.setAngleScale=function(t){return this._angleScale=t,t},Object.defineProperty(e.prototype,"angleAxisHelper",{get:function(){return this._angleAxisHelper},set:function(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radiusAxisHelper",{get:function(){return this._radiusAxisHelper},set:function(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortDataByAxis",{get:function(){return this._sortDataByAxis},enumerable:!1,configurable:!0}),e.prototype._buildMarkAttributeContext=function(){var e=this;t.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=function(){return e.angleAxisHelper.center()},this._markAttributeContext.getLayoutRadius=function(){return e._computeLayoutRadius()}},e.prototype.valueToPosition=function(t,e){if(w(t)||w(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};var i=this.angleAxisHelper.dataToPosition(lt(t)),n=this.radiusAxisHelper.dataToPosition(lt(e));return this.angleAxisHelper.coordToPoint({angle:i,radius:n})},e.prototype.dataToPosition=function(t){return t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):{x:Number.NaN,y:Number.NaN}},e.prototype.dataToPositionX=function(t){return this.dataToPosition(t).x},e.prototype.dataToPositionY=function(t){return this.dataToPosition(t).y},e.prototype.dataToPositionZ=function(t){return 0},e.prototype.positionToData=function(t){},e.prototype.radiusToData=function(t){},e.prototype.angleToData=function(t){},e.prototype.getStatisticFields=function(){var t,e,i=this,n=[];return(null===(t=this.radiusAxisHelper)||void 0===t?void 0:t.getScale)&&this._radiusField.forEach((function(t){var e={key:t,operations:[]};gS(i.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),(null===(e=this.angleAxisHelper)||void 0===e?void 0:e.getScale)&&this._angleField.forEach((function(t){var e={key:t,operations:[]};gS(i.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],n.push(e)})),n},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),T(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),T(this._spec.radius)&&(this._outerRadius=this._spec.radius),T(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),T(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)},e.prototype.onRadiusAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.onAngleAxisHelperUpdate=function(){this.onMarkPositionUpdate()},e.prototype.afterInitMark=function(){t.prototype.afterInitMark.call(this),this._trigger.setStateKeys(h(h([],c(this._angleField),!1),c(this._radiusField),!1))},e.prototype._computeLayoutRadius=function(){var t=this._region.getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},e.prototype.fillData=function(){t.prototype.fillData.call(this),this.sortDataByAxis&&this._sortDataInAxisDomain()},e.prototype._sortDataInAxisDomain=function(){var t,e;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&vX(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)},e}(pX);var uJ=function(t,e){var i=t.map((function(t){return o({},t)}));if(!i||0===i.length)return i;for(var n,r=e.angleField,a=e.startAngle,s=e.endAngle,l=e.minAngle,u=e.asStartAngle,c=e.asEndAngle,h=e.asMiddleAngle,d=e.asRadian,f=e.asRatio,p=e.asQuadrant,v=e.asK,y=function(t,e,i){t[u]=e,t[c]=e+i,t[h]=e+i/2,t[d]=i,t[p]=function(t){return(t=MA(t))>0&&t<=Math.PI/2?2:t>Math.PI/2&&t<=Math.PI?3:t>Math.PI&&t<=3*Math.PI/2?4:1}(e+i/2)},g=0,m=-1/0,_=0;_<i.length;_++){var b=Qk(n=i[_][r])?Number.parseFloat(n):0;g+=b,m=Math.max(b,m),i[_][Ew]=b}var x=s-a,k=a,S=x,A=0;if(i.forEach((function(t){var e=t[Ew],i=g?e/g:0,n=i*x;n<l?(n=l,S-=l):A+=e;var r=k,o=k+n;t[f]=i,t[v]=m?e/m:0,y(t,r,n),k=o})),S<x)if(S<=.001){var w=x/i.length;i.forEach((function(t,e){y(t,a+e*w,w)}))}else{var T=S/A;k=a,i.forEach((function(t){var e=t[d]===l?l:t[Ew]*T;y(t,k,e),k+=e}))}return 0!==g&&(i[i.length-1][c]=s),i};function cJ(t,e,i){return function(n,r,o){return e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(n,r,i)}:{overall:!1}}}var hJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:cJ(t,!0,SY.appear)}},dJ={type:"fadeIn"},fJ=function(t){return{type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:cJ(t,!0,SY.enter)}},pJ=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:cJ(t,!0,SY.exit)}},vJ=function(t){return{type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:cJ(t,!0,SY.exit)}};function yJ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return dJ;case"growRadius":return hJ(o(o({},t),{growField:"radius"}));default:return hJ(o(o({},t),{growField:"angle"}))}}var gJ=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=mJ.type,n._unCompileChannel={centerOffset:!0,radiusOffset:!0},n.computeOuterRadius=function(t,e,i,r,o){var a;return void 0===i&&(i="normal"),o+(null!==(a=n.getAttribute("radiusOffset",e,i,r))&&void 0!==a?a:0)},n.computeCenter=function(t,e,i,r,o){return void 0===i&&(i="normal"),o+YA({angle:e[Ow],radius:n.getAttribute("centerOffset",e,i,r)})[t]},n._computeExChannel.x=n.computeCenter,n._computeExChannel.y=n.computeCenter,n._computeExChannel.outerRadius=n.computeOuterRadius,n._extensionChannel.centerOffset=["x","y"],n._extensionChannel.radiusOffset=["outerRadius"],n}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0})},e}(vK),mJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.type="arc",e}(gJ),_J=function(){qj(),CK(),FU.registerMark(mJ.type,mJ)},bJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie")},e.prototype._mergeThemeToSpec=function(t,e){var i=this._theme,n=t;if(this._shouldMergeThemeToSpec()){var r=this._getDefaultSpecFromChart(e);"inside"===(n=$W({},this._theme,r,t)).label.position?n.label=$W({},this._theme.innerLabel,n.label):n.label=$W({},this._theme.outerLabel,n.label)}return{spec:n,theme:i}},e}(fX),xJ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=bJ,t._pieMarkName="pie",t._pieMarkType="arc",t._startAngle=Fw,t._endAngle=zw,t._pieMark=null,t._labelMark=null,t._labelLineMark=null,t.dataToCentralPosition=function(e){var i=e[Ow];if(w(i))return null;var n=t.computeDatumRadius(e),r=t.computeDatumInnerRadius(e),o=t.computeCenter(e),a=YA({angle:i,radius:(n+r)/2});return{x:o.x+a.x,y:o.y+a.y}},t}return r(i,e),Object.defineProperty(i.prototype,"center",{get:function(){var t,e,i,n;return{x:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.centerX)&&void 0!==e?e:this._region.getLayoutRect().width/2,y:null!==(n=null===(i=this._spec)||void 0===i?void 0:i.centerY)&&void 0!==n?n:this._region.getLayoutRect().height/2}},enumerable:!1,configurable:!0}),i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){var e,i;return null!==(i=null===(e=t._center)||void 0===e?void 0:e.x)&&void 0!==i?i:t._region.getLayoutRect().width/2},y:function(){var e,i;return null!==(i=null===(e=t._center)||void 0===e?void 0:e.y)&&void 0!==i?i:t._region.getLayoutRect().height/2}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._centerOffset=null!==(t=this._spec.centerOffset)&&void 0!==t?t:0,this._cornerRadius=null!==(i=this._spec.cornerRadius)&&void 0!==i?i:0;var n=function(t,e){var i=0,n=2*Math.PI,r=T(t),o=T(e);for(r||o?o?r?(i=t,n=e):(i=e-2*Math.PI,n=e):(i=t,n=t+2*Math.PI):(i=0,n=2*Math.PI);n<=i;)n+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,n-=2*Math.PI;for(;n<0;)i+=2*Math.PI,n+=2*Math.PI;return{startAngle:i,endAngle:n}}(T(this._spec.startAngle)?ge(this._spec.startAngle):this._startAngle,T(this._spec.endAngle)?ge(this._spec.endAngle):this._endAngle);this._startAngle=n.startAngle,this._endAngle=n.endAngle,this._padAngle=T(this._spec.padAngle)?ge(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[]},i.prototype.initData=function(){e.prototype.initData.call(this);var t=this.getViewData();if(t){hY(this._dataSet,"pie",uJ),t.transform({type:"pie",options:{angleField:this._angleField[0],startAngle:this._startAngle,endAngle:this._endAngle,minAngle:T(this._spec.minAngle)?ge(this._spec.minAngle):0,asStartAngle:Pw,asEndAngle:Bw,asRatio:Rw,asMiddleAngle:Ow,asRadian:Dw,asQuadrant:Iw,asK:Lw}},!1);var i=new Ma(this._dataSet,{name:"".concat(bw,"_series_").concat(this.id,"_viewDataLabel")});i.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new JK(this._option,i)}},i.prototype.initMark=function(){var t;this._pieMark=this._createMark(o(o({},i.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{morph:cX(this._spec,this._pieMarkName),defaultMorphElementKey:this._seriesField,key:lV,groupKey:this._seriesField,skipBeforeLayouted:!0,isSeriesMark:!0,customShape:null===(t=this._spec.pie)||void 0===t?void 0:t.customShape})},i.prototype.startAngleScale=function(t){return rw(Pw)(t)},i.prototype.endAngleScale=function(t){return rw(Bw)(t)},i.prototype.initMarkStyle=function(){var e=this,i=this._pieMark;i&&(this.setMarkStyle(i,{x:function(){var t,i;return null!==(i=null===(t=e._center)||void 0===t?void 0:t.x)&&void 0!==i?i:e._region.getLayoutRect().width/2},y:function(){var t,i;return null!==(i=null===(t=e._center)||void 0===t?void 0:t.y)&&void 0!==i?i:e._region.getLayoutRect().height/2},fill:this.getColorAttribute(),outerRadius:sW(this._outerRadius)?this._outerRadius:function(){return e.computeLayoutRadius()*e._outerRadius},innerRadius:sW(this._innerRadius)?this._innerRadius:function(){return e.computeLayoutRadius()*e._innerRadius},cornerRadius:function(){return e.computeLayoutRadius()*e._cornerRadius},startAngle:function(t){return e.startAngleScale(t)},endAngle:function(t){return e.endAngleScale(t)},padAngle:this._padAngle,centerOffset:this._centerOffset},"normal",t.AttributeLevel.Series),this._trigger.registerMark(i))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)},i.prototype.initMarkStyleWithSpec=function(i,n,r){if(e.prototype.initMarkStyleWithSpec.call(this,i,n,r),i.name===this._pieMarkName){var o=this.getSpec()[i.name];if(o)for(var a in o.state||{})this.setMarkStyle(i,this.generateRadiusStyle(o.state[a]),a,t.AttributeLevel.User_Mark)}},i.prototype.initLabelMarkStyle=function(t){var e,i,n,r,o,a,s=this;t&&this.setMarkStyle(t,{visible:rw(Tw).bind(this),text:function(t){return t[s.getDimensionField()[0]]},fill:(null===(i=null===(e=this._spec.label)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill)||this.getColorAttribute(),angle:null===(r=null===(n=this._spec.label)||void 0===n?void 0:n.style)||void 0===r?void 0:r.angle,limit:null===(a=null===(o=this._spec.label)||void 0===o?void 0:o.style)||void 0===a?void 0:a.limit,z:this.dataToPositionZ.bind(this)})},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this),this._trigger.setStateKeys(h([this._seriesField],c(this._radiusField),!1))},i.prototype.initEvent=function(){var t;e.prototype.initEvent.call(this),null===(t=this._viewDataLabel.getDataView())||void 0===t||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))},i.prototype.initGroups=function(){},i.prototype.onLayoutEnd=function(t){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),e.prototype.onLayoutEnd.call(this,t)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.viewDataLabelUpdate=function(){this.event.emit(t.ChartEvent.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()},i.prototype.generateRadiusStyle=function(t){var e=this;if(t){var i={};return t.outerRadius&&(i.outerRadius=function(){return e.computeLayoutRadius()*t.outerRadius}),t.innerRadius&&(i.innerRadius=function(){return e.computeLayoutRadius()*t.innerRadius}),t.cornerRadius&&(i.cornerRadius=function(){return e.computeLayoutRadius()*t.cornerRadius}),i}},i.prototype.computeLayoutRadius=function(){var t=this._region.getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},i.prototype.computeCenter=function(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}},i.prototype.getRadius=function(t){var e,i,n,r,o,a,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.outerRadius:null===(s=null===(a=null===(o=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===o?void 0:o.state)||void 0===a?void 0:a[t])||void 0===s?void 0:s.outerRadius;return null!=l?l:this._outerRadius},i.prototype.getInnerRadius=function(t){var e,i,n,r,o,a,s;void 0===t&&(t="normal");var l="normal"===t?null===(n=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===n?void 0:n.innerRadius:null===(s=null===(a=null===(o=this.getSpec()[(null===(r=this._pieMark)||void 0===r?void 0:r.name)||"pie"])||void 0===o?void 0:o.state)||void 0===a?void 0:a[t])||void 0===s?void 0:s.innerRadius;return null!=l?l:this._innerRadius},i.prototype.computeRadius=function(t,e){return this.computeLayoutRadius()*t*(w(e)?1:e)+this._centerOffset},i.prototype.computeDatumRadius=function(t,e){return this.computeLayoutRadius()*this.getRadius(e)+this._centerOffset},i.prototype._compareSpec=function(t,i,n){(n=null!=n?n:{data:!0}).centerX=!0,n.centerX=!0,n.centerY=!0,n.centerOffset=!0,n.radius=!0,n.innerRadius=!0,n.cornerRadius=!0,n.startAngle=!0,n.endAngle=!0,n.padAngle=!0;var r=i.centerX,o=i.centerY,a=i.centerOffset,s=i.radius,l=i.innerRadius,u=i.cornerRadius,c=i.startAngle,h=i.endAngle,d=i.padAngle,f=e.prototype._compareSpec.call(this,t,i,n);return(t=null!=t?t:{}).centerY===o&&t.centerX===r&&t.centerOffset===a&&t.radius===s&&t.innerRadius===l&&t.cornerRadius===u&&t.startAngle===c&&t.endAngle===h&&t.padAngle===d||(f.reRender=!0,f.change=!0),f},i.prototype.computeDatumInnerRadius=function(t,e){return this.computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset},i.prototype.dataToPosition=function(t){var e=t[Ow];if(w(e))return null;var i=this.computeDatumRadius(t),n=this.computeCenter(t),r=YA({angle:e,radius:i});return{x:n.x+r.x,y:n.y+r.y}},i.prototype.initAnimation=function(){var t,e,i=this,n={growFrom:function(t,e,n){var r;if(n===SY.appear)return i._startAngle;if(n===SY.disappear)return i._endAngle;var o=[SY.disappear,SY.exit],a=e.mark.elements,s=t,l=null==s?void 0:s[sV];if(void 0===a.find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[sV])<l})))return i._startAngle;if(void 0===a.find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[sV])>l})))return i._endAngle;var u=h([],c(a),!1).reverse().find((function(t){var e;return(null===(e=t.data[0])||void 0===e?void 0:e[sV])<l}));return o.includes(n)?null===(r=null==u?void 0:u.getNextGraphicAttributes())||void 0===r?void 0:r.endAngle:null==u?void 0:u.getGraphicAttribute("endAngle",!0)}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._pieMark){var o=aX(null===(e=FU.getAnimationInKey("pie"))||void 0===e?void 0:e(n,r),sX("pie",this._spec,this._markAttributeContext));o.normal&&o.normal.type&&(o.normal=function(t,e){var i,n,r,o,a=null!==(n=null===(i=e.options)||void 0===i?void 0:i.distance)&&void 0!==n?n:10,s=F(e.duration)?e.duration/2:1e3,l=null!==(r=e.options.easing)&&void 0!==r?r:"cubicOut";return{oneByOne:e.oneByOne,loop:null!==(o=e.loop)&&void 0!==o&&o,timeSlices:[{duration:s,effects:{easing:l,channel:{x:{from:function(e){return t.getAttribute("x",e)},to:function(e){return t.getAttribute("x",e)+YA({angle:e[Ow],radius:a}).x}},y:{from:function(e){return t.getAttribute("y",e)},to:function(e){return t.getAttribute("y",e)+YA({angle:e[Ow],radius:a}).y}}}}},{duration:s,effects:{easing:l,channel:{x:{to:function(e){return t.getAttribute("x",e)},from:function(e){return t.getAttribute("x",e)+YA({angle:e[Ow],radius:a}).x}},y:{to:function(e){return t.getAttribute("y",e)},from:function(e){return t.getAttribute("y",e)+YA({angle:e[Ow],radius:a}).y}}}}}]}}(this._pieMark,o.normal)),this._pieMark.setAnimationConfig(o)}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){return e},i.prototype.getActiveMarks=function(){return[this._pieMark]},i.transformerConstructor=bJ,i.mark=bG,i}(lJ),kJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie,i}return r(i,e),i.type=t.SeriesTypeEnum.pie,i}(xJ),SJ=function(){_J(),FU.registerAnimation("pie",(function(t,e){return{appear:yJ(t,e),enter:fJ(t),exit:pJ(t),disappear:vJ(t)}})),FU.registerSeries(kJ.type,kJ)},AJ=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._support3d=!0,i}return r(e,t),e.type="arc3d",e}(gJ),wJ=function(){CK(),jL(),fL(),gT.registerGraphic(sw.arc3d,Xy),FU.registerMark(AJ.type,AJ)},TJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"pie3d")},e}(bJ),MJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.pie3d,i._pieMarkName="pie3d",i._pieMarkType="arc3d",i.transformerConstructor=TJ,i}return r(i,e),i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this._angle3d=null!==(i=null===(t=this._spec)||void 0===t?void 0:t.angle3d)&&void 0!==i?i:-Math.PI/3},i.prototype.initMarkStyle=function(){var i=this;e.prototype.initMarkStyle.call(this);var n=this._pieMark;n&&this.setMarkStyle(n,{beta:function(){return i._angle3d}},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(i){var n=this;if(i){e.prototype.initLabelMarkStyle.call(this,i);var r={};i.setSupport3d(!0),r.beta=this._angle3d,r.anchor3d=function(t){var e,i,r,o;return[null!==(i=null===(e=n._center)||void 0===e?void 0:e.x)&&void 0!==i?i:n._region.getLayoutRect().width/2,null!==(o=null===(r=n._center)||void 0===r?void 0:r.y)&&void 0!==o?o:n._region.getLayoutRect().height/2]},r.angle=function(t){var e,i=t[Ow];return"inside"===(null===(e=n._spec.label)||void 0===e?void 0:e.position)?me(i):0},this.setMarkStyle(i,o(o({},r),{z:100}),void 0,t.AttributeLevel.Mark)}},i.type=t.SeriesTypeEnum.pie3d,i.mark=xG,i.transformerConstructor=TJ,i}(xJ),CJ=function(){FU.registerAnimation("pie3d",(function(t,e){return{appear:yJ(t,e),enter:fJ(t),exit:pJ(t),disappear:vJ(t)}})),wJ(),FU.registerSeries(MJ.type,MJ)},EJ=function(t){var e="angle"===t.growField?0:t.innerRadius;return"angle"===t.growField?{type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}:{channel:{innerRadius:{from:e,to:function(t,e){return e.getGraphicAttribute("innerRadius")}},outerRadius:{from:e,to:function(t,e){return e.getGraphicAttribute("outerRadius")}}}}},RJ={type:"fadeIn"},PJ=function(t){return{type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}},BJ=function(t){return{type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}},LJ=function(t){return{type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}};function OJ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return RJ;case"growAngle":return EJ(o(o({},t),{growField:"angle"}));default:return EJ(o(o({},t),{growField:"radius"}))}}var IJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getStackGroupFields=function(){return this._angleField},e.prototype.getStackValueField=function(){return lt(this._spec.valueField)[0]||lt(this._spec.radiusField)[0]},e.prototype.getGroupFields=function(){return this._angleField},e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this._stack&&this.setValueFieldToStack(),this._percent&&this.setValueFieldToPercent()},e.prototype.setValueFieldToStack=function(){this.setRadiusField(pV),this.setInnerRadiusField(fV)},e.prototype.setValueFieldToPercent=function(){this.setRadiusField(yV),this.setInnerRadiusField(vV)},e.prototype.getDimensionField=function(){return this._specAngleField},e.prototype.getMeasureField=function(){return this._specRadiusField},e.prototype.getDefaultShapeType=function(){return"square"},e}(lJ),DJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"rose")},e}(fX),FJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.rose,i.transformerConstructor=DJ,i._supportStack=!0,i._roseMark=null,i._labelMark=null,i}return r(i,e),i.prototype.initMark=function(){this.initRoseMark()},i.prototype.initMarkStyle=function(){this.initRoseMarkStyle()},i.prototype._buildMarkAttributeContext=function(){var t=this;e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.getCenter=function(){return{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y}}},this._markAttributeContext.startAngleScale=function(e){return t.startAngleScale(e)},this._markAttributeContext.endAngleScale=function(e){return t.endAngleScale(e)}},i.prototype.initRoseMark=function(){var t;this._roseMark=this._createMark(i.mark.rose,{morph:cX(this._spec,i.mark.rose.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(t=this._spec.rose)||void 0===t?void 0:t.customShape})},i.prototype.getRoseAngle=function(){var t,e,i;return null!==(i=null===(e=(t=this.angleAxisHelper).getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:.5},i.prototype.startAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.endAngleScale=function(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)},i.prototype.initRoseMarkStyle=function(){var t=this,e=this._roseMark;e&&(this.setMarkStyle(e,{x:function(){return t.angleAxisHelper.center().x},y:function(){return t.angleAxisHelper.center().y},startAngle:function(e){return t.startAngleScale(e)},endAngle:function(e){return t.endAngleScale(e)},fill:this.getColorAttribute(),outerRadius:function(e){return aW(t.radiusAxisHelper.dataToPosition([e[t._radiusField[0]]]),t.radiusAxisHelper.getScale(0))},innerRadius:function(e){var i;if(!t._stack)return 0;var n=aW(t.radiusAxisHelper.dataToPosition([e[t._innerRadiusField[0]]]),t.radiusAxisHelper.getScale(0));return n<=Number.MIN_VALUE?t._computeLayoutRadius()*(null!==(i=t._spec.innerRadius)&&void 0!==i?i:0):n}}),this._trigger.registerMark(e))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)},i.prototype.initLabelMarkStyle=function(t){var e,i,n,r,o,a,s,l,u=this;t&&this.setMarkStyle(t,{visible:null===(i=null===(e=this._spec)||void 0===e?void 0:e.label)||void 0===i?void 0:i.visible,text:function(t){return t[u.getDimensionField()[0]]},fill:(null===(r=null===(n=this._spec.label)||void 0===n?void 0:n.style)||void 0===r?void 0:r.fill)||this.getColorAttribute(),angle:null===(a=null===(o=this._spec.label)||void 0===o?void 0:o.style)||void 0===a?void 0:a.angle,limit:null===(l=null===(s=this._spec.label)||void 0===s?void 0:s.style)||void 0===l?void 0:l.limit,z:0})},i.prototype.initAnimation=function(){var t,e,i,n=this,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._roseMark){var o={innerRadius:function(){var t;return n._computeLayoutRadius()*(null!==(t=n._spec.innerRadius)&&void 0!==t?t:0)}};this._roseMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("rose"))||void 0===i?void 0:i(o,r),sX("rose",this._spec,this._markAttributeContext)))}},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[this._roseMark]},i.type=t.SeriesTypeEnum.rose,i.mark=kG,i.transformerConstructor=DJ,i}(IJ),zJ=function(){FU.registerSeries(FJ.type,FJ),_J(),FU.registerAnimation("rose",(function(t,e){return{appear:OJ(t,e),enter:PJ(t),exit:BJ(t),disappear:LJ(t)}}))},jJ=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i,n,r,o)||this,s=a.params.pointToCoord,l=a.params.coordToPoint;return A(s)&&A(l)||(a.valid=!1),a._pointToCoord=s,a._coordToPoint=l,a}return r(e,t),e.prototype.getEndProps=function(){return!1===this.valid?{}:this._coordToPoint({angle:this._toAngle,radius:this._toRadius})},e.prototype.onBind=function(){var t=this._pointToCoord(this.from),e=t.angle,i=t.radius;F(e*i)||(this.valid=!1),this._fromAngle=e,this._fromRadius=i;var n=this._pointToCoord(this.to),r=n.angle,o=n.radius;F(r*o)||(this.valid=!1),this._toAngle=r,this._toRadius=o},e.prototype.onUpdate=function(t,e,i){if(!1!==this.valid)if(t){var n=this.getEndProps(),r=n.x,o=n.y;i.x=r,i.y=o}else{var a=this._coordToPoint({angle:this._fromAngle+(this._toAngle-this._fromAngle)*e,radius:this._fromRadius+(this._toRadius-this._fromRadius)*e});r=a.x,o=a.y;i.x=r,i.y=o}},e}(Yc),HJ=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i,n,r,o)||this,s=a.params.pointToCoord,l=a.params.coordToPoint;return a._pointToCoord=s,a._coordToPoint=l,a}return r(e,t),e.prototype.onUpdate=function(t,e,i){var n=this;this.points=this.points.map((function(t,i){var r=n.polarPointInterpolation(n.interpolatePoints[i][0],n.interpolatePoints[i][1],e);return r.context=t.context,r})),i.points=this.points},e.prototype.polarPointInterpolation=function(t,e,i){var n=this._pointToCoord(t),r=this._pointToCoord({x:t.x1,y:t.y1}),o=this._pointToCoord(e),a=this._pointToCoord({x:e.x1,y:e.y1}),s=n.angle+(o.angle-n.angle)*i,l=n.radius+(o.radius-n.radius)*i,u=r.angle+(a.angle-r.angle)*i,c=r.radius+(a.radius-r.radius)*i,h=this._coordToPoint({angle:s,radius:l}),d=h.x,f=h.y,p=this._coordToPoint({angle:u,radius:c}),v=p.x,y=p.y,g=new ae(d,f,v,y);return g.defined=e.defined,g},e}(mh),NJ=function(t){return{type:"in"===t?"fadeIn":"fadeOut"}};function VJ(t,e,i){return"fadeIn"===e?NJ(i):function(t,e){return{type:"in"===e?"growPointsIn":"growPointsOut",options:function(){return{center:t.center()}}}}(t,i)}function GJ(t,e,i){return"fadeIn"===e?NJ(i):function(t,e){var i=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.x},n=function(t,e){return e.getGraphicAttribute("x")},r=function(){var e;return null===(e=t.center())||void 0===e?void 0:e.y},o=function(t,e){return e.getGraphicAttribute("y")};return"in"===e?{channel:{x:{from:i,to:n},y:{from:r,to:o}}}:{channel:{x:{from:n,to:i},y:{from:o,to:r}}}}(t,i)}var WJ=function(t,e){return{custom:bh,customParameters:function(i,n){var r;return{group:n.getGraphicItem(),startAngle:null!==(r=t.startAngle)&&void 0!==r?r:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}},UJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.radar,i.transformerConstructor=MX,i._sortDataByAxis=!1,i}return r(i,e),i.prototype.initGroups=function(){},i.prototype.compile=function(){e.prototype.compile.call(this),this.addOverlapCompile()},i.prototype.initMark=function(){var t,e,i,n,r={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},o=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(i=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.visible),a=null!==(n=this._spec.seriesMark)&&void 0!==n?n:"area";this.initAreaMark(r,o&&"area"===a),this.initLineMark(r,"line"===a||"area"===a&&!o),this.initSymbolMark(r,"point"===a)},i.prototype.initMarkStyle=function(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle()},i.prototype.initAreaMark=function(t,e){var n;this._areaMark=this._createMark(i.mark.area,{progressive:t,isSeriesMark:e,customShape:null===(n=this._spec.area)||void 0===n?void 0:n.customShape})},i.prototype.initAreaMarkStyle=function(){var e=this,i=this._areaMark;i&&(this.setMarkStyle(i,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e._stack?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).x:Number.NaN},y1:function(t){return t&&e.angleAxisHelper&&e.radiusAxisHelper?e.valueToPosition(e.getDatumPositionValues(t,e._angleField),e._stack?e.getDatumPositionValues(t,e._innerRadiusField):e.radiusScale.domain()[0]).y:Number.NaN},fill:this.getColorAttribute(),curveType:_X,closePath:!0},"normal",t.AttributeLevel.Series),"zero"!==this._invalidType&&this.setMarkStyle(i,{defined:this._getInvalidDefined,connectedType:this._getInvalidConnectType()},"normal",t.AttributeLevel.Series),this.event.on(t.ChartEvent.viewDataStatisticsUpdate,{filter:function(t){return t.model===e}},(function(){e.encodeDefined(i,"defined")})),this._trigger.registerMark(i))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._lineMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._lineMark),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark),this._areaMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._areaMark)},i.prototype.initAnimation=function(){var t,e,i,n,r=this,o={center:function(){var t;return null===(t=r.angleAxisHelper)||void 0===t?void 0:t.center()},radius:function(){var t=r.getLayoutRect();return Math.min(t.width,t.height)},startAngle:T(this._spec.startAngle)?ge(this._spec.startAngle):Fw,pointToCoord:function(t){var e;return null===(e=r.angleAxisHelper)||void 0===e?void 0:e.pointToCoord(t)},coordToPoint:function(t){return r.angleAxisHelper.coordToPoint(t)}},a=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===a&&this._rootMark&&this._rootMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("radarGroup"))||void 0===n?void 0:n(o,a),sX("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach((function(t){var e=c(t,2),i=e[0],n=e[1];if(T(i)){var s=FU.getAnimationInKey(n);i.setAnimationConfig(aX(null==s?void 0:s(o,a),sX(i.name,r._spec,r._markAttributeContext)))}}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._areaMark,this._symbolMark,this._lineMark]},i.prototype.getSeriesStyle=function(t){var e=this;return function(i){var n,r,o,a,s=null!==(r=null===(n=e._seriesMark)||void 0===n?void 0:n.getAttribute(i,t))&&void 0!==r?r:void 0;return"fill"!==i||s||(i="stroke",s=null!==(a=null===(o=e._seriesMark)||void 0===o?void 0:o.getAttribute(i,t))&&void 0!==a?a:void 0),"stroke"===i&&B(s)?s[0]:s}},i.type=t.SeriesTypeEnum.radar,i.mark=_G,i.transformerConstructor=MX,i}(IJ);ot(UJ,bX);var YJ=function(){UH(),HX(),SX(),TX(),FU.registerAnimation("radar",(function(t,e){return{appear:"clipIn"===e?void 0:VJ(t,e,"in"),enter:VJ(t,e,"in"),exit:VJ(t,e,"out"),disappear:"clipIn"===e?void 0:VJ(t,e,"out"),update:[{options:{excludeChannels:["points","defined"]}},{channel:["points"],custom:HJ,customParameters:t,duration:xK.update.duration,easing:xK.update.easing}]}})),FU.registerAnimation("radarSymbol",(function(t,e){return{appear:"clipIn"===e?void 0:GJ(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:GJ(t,e,"out"),update:[{options:{excludeChannels:["x","y"]}},{channel:["x","y"],custom:jJ,customParameters:t,duration:xK.update.duration,easing:xK.update.easing}]}})),FU.registerAnimation("radarGroup",(function(t,e){return{appear:WJ(t,"in"),disappear:WJ(t,"out")}})),FU.registerSeries(UJ.type,UJ)},KJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.updateTooltipSpec=function(){var e,i=this;t.prototype.updateTooltipSpec.call(this),T(null===(e=this.spec)||void 0===e?void 0:e.mark)&&(this.spec.mark.updateContent=function(t,e,n){var r=[],o=t.filter((function(t){return"children"===t.key}));return o.length>0&&o[0].value.forEach((function(t){var n=!0;for(var o in t)r.push({shapeType:"circle",hasShape:n,shapeColor:i.contentShapeColorCallback(e[0].datum[0]),shapeStroke:i.contentShapeColorCallback(e[0].datum[0]),key:o,value:t[o]+""}),n=!1})),t.concat(r)})},e.prototype.getDefaultTooltipPattern=function(t){var e=this;return"mark"===t?{visible:!0,activeType:t,title:{key:"event info",value:"event info"},content:[{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:function(t){return t.type},value:function(t){return t.id}},{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"event_time",value:function(t){return Ca.getInstance().timeFormat("%Y%m%d",t.event_time)}},{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"action_type",value:function(t){return t.action_type}},{shapeType:"square",hasShape:!0,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"children",value:function(t){return t.children}}],updateContent:function(t,i,n){var r=[];return t[3].value.forEach((function(t){var n=!0;for(var o in t)r.push({shapeType:"circle",hasShape:n,shapeColor:e.contentShapeColorCallback(i[0].datum[0]),shapeStroke:e.contentShapeColorCallback(i[0].datum[0]),key:o,value:t[o]+""}),n=!1})),t.concat(r)}}:null},e}(YK),XJ=function(t,e){var i,n=(null===(i=t[0])||void 0===i?void 0:i.latestData)?t[0].latestData:t||[],r=[];return n.forEach((function(t){var i={};for(var n in t)n!==e&&(i[n]=t[n]);var o=t[e];null==o||o.forEach((function(t){r.push(Object.assign({},i,t))}))})),r},ZJ={fill:"#bbb",fillOpacity:.2},qJ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.dot,i}return r(i,e),i.prototype.getSeriesGroupField=function(){return this._seriesField},i.prototype.setSeriesGroupField=function(t){T(t)&&(this._seriesGroupField=t)},i.prototype.getTitleField=function(){return this._titleField},i.prototype.setTitleField=function(t){T(t)&&(this._titleField=t)},i.prototype.getSubTitleField=function(){return this._subTitleField},i.prototype.setSubTitleField=function(t){T(t)&&(this._subTitleField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){T(t)&&(this._dotTypeField=t)},i.prototype.getHighLightSeriesGroup=function(){return this._highLightSeriesGroup},i.prototype.setHighLightSeriesGroup=function(t){T(t)&&(this._highLightSeriesGroup=t)},i.prototype.setGridBackground=function(t){T(t)&&(this._gridBackground=t)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),this._xDimensionStatisticsDomain=this.getRawData().latestData.map((function(t){return t[i._fieldY[0]]})),hY(this._option.dataSet,"objFlat",XJ),hY(this._option.dataSet,"copyDataView",_Y),dY(this._option.dataSet,"dataview",ka),null===(t=this.getViewData())||void 0===t||t.transform({type:"objFlat",options:"dots",level:mY.dotObjFlat},!1)},i.prototype.setSeriesField=function(t){var e=this;T(t)&&(this._seriesField=t,this.getMarksInType(["line","area"]).forEach((function(t){t.setFacet(e._seriesField)})))},i.prototype.getStatisticFields=function(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground($W(ZJ,(null===(t=this._spec.grid)||void 0===t?void 0:t.background)||{}))},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(i.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(i.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(i.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(i.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(i.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(i.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})},i.prototype.initMarkStyle=function(){var e=this,i=this._clipMark;i&&(this.setMarkStyle(i,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight,clip:!0},"normal",t.AttributeLevel.Series),i.setInteractive(!1));var n=this._containerMark;n&&(this.setMarkStyle(n,{x:this._spec.leftAppendPadding},"normal",t.AttributeLevel.Series),n.setInteractive(!1));var r=this._gridBackgroundMark;r&&(this.setMarkStyle(r,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(r));var o=this._gridMark;o&&(this.setMarkStyle(o,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(o));var a=this._dotMark;a&&(this.setMarkStyle(a,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(a));var s=this._titleMark;s&&(this.setMarkStyle(s,{fill:this.getColorAttribute(),text:function(t){return t[e.getTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(s));var l=this._subTitleMark;l&&(this.setMarkStyle(l,{fill:this.getColorAttribute(),text:function(t){return t[e.getSubTitleField()]},x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(l));var u=this._symbolMark;u&&(this.setMarkStyle(u,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this._trigger.registerMark(u))},i.prototype.dataToGridBackgroundPositionY=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-n(0)/2},i.prototype.dataToGridBackgroundPositionY1=function(t){if(!this._yAxisHelper)return Number.NaN;var e=this._yAxisHelper,i=e.dataToPosition,n=e.getBandwidth;return i(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+n(0)/2},i.prototype.dataToOpacity=function(t){var e,i,n,r;if(!this._xAxisHelper)return Number.NaN;var o=this._xAxisHelper,a=o.dataToPosition,s=o.getScale;return a(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<s(0).range()[0]||a(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>s(0).range()[1]?0:null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.dot)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fillOpacity)&&void 0!==r?r:1},i.prototype.dataToGridBackgroundOpacity=function(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0},i.prototype.onLayoutEnd=function(i){var n,r;e.prototype.onLayoutEnd.call(this,i);var o=null!==(r=null===(n=this._spec)||void 0===n?void 0:n.leftAppendPadding)&&void 0!==r?r:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+o},"normal",t.AttributeLevel.Series)},i.prototype.getDefaultColorDomain=function(){var t,e;return this._seriesGroupField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._seriesGroupField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:uV}},i.prototype.getDotColorScale=function(){var t,e,i,n=this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null===(i=this.getViewDataStatistics())||void 0===i?void 0:i.latestData[this._seriesField].values:[],r=this._getDataScheme();return(new nW).domain(n).range(r)},i.prototype.getDotColorAttribute=function(){var t,e,i,n;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this.getDotColorScale(),field:null!==(n=null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesGroupField)&&void 0!==i?i:this._seriesField)&&void 0!==n?n:uV}},i.prototype.initTooltip=function(){this._tooltipHelper=new KJ(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)},i.prototype.onEvaluateEnd=function(t){e.prototype.onEvaluateEnd.call(this,t)},i.prototype.onMarkTreePositionUpdate=function(t){var e=this;t.forEach((function(t){"group"===t.type?e.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()}))},i.prototype.getDotData=function(){var t;return null===(t=this._dotMark)||void 0===t?void 0:t.getData()},i.prototype._getDataIdKey=function(){},i.prototype.getStackValueField=function(){return null},i.prototype.getActiveMarks=function(){return[this._dotMark]},i.type=t.SeriesTypeEnum.dot,i.mark=MG,i}(gX),JJ=function(){TX(),Pq(),rZ(),Kq(),FU.registerSeries(qJ.type,qJ)},QJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(t){return"mark"===t?{visible:!0,activeType:t,title:{key:"link info",value:"link info"},content:[{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"time",value:function(t){return Ca.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])}},{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"type",value:function(t){return t.action_type}},{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"from",value:function(t){return t.from}},{hasShape:!0,shapeType:"square",shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,key:"to",value:function(t){return t.to}}]}:null},e}(YK),$J=function(t,e){var i=e.infoKey,n=e.fields,r=e.linkData,o=e.dotData,a=n(),s=a.fromField,l=a.toField,u=a.xField,c=a.yField,h=r(),d=o(),f={};return d.forEach((function(t){var e={};for(var n in t)n!==i&&(e[n]=t[n]);var r=t[i];null==r||r.forEach((function(t){f[t.node_name]=Object.assign({},e,t)}))})),h.forEach((function(t){var e,i,n,r;t[s+"_xField"]=null===(e=null==f?void 0:f[t[s]])||void 0===e?void 0:e[u],t[s+"_yField"]=null===(i=null==f?void 0:f[t[s]])||void 0===i?void 0:i[c],t[l+"_xField"]=null===(n=null==f?void 0:f[t[l]])||void 0===n?void 0:n[u],t[l+"_yField"]=null===(r=null==f?void 0:f[t[l]])||void 0===r?void 0:r[c]})),h},tQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.link,i}return r(i,e),i.prototype.getFromField=function(){return this._fromField},i.prototype.setFromField=function(t){T(t)&&(this._fromField=t)},i.prototype.getToField=function(){return this._toField},i.prototype.setToField=function(t){T(t)&&(this._toField=t)},i.prototype.getDotTypeField=function(){return this._dotTypeField},i.prototype.setDotTypeField=function(t){T(t)&&(this._dotTypeField=t)},i.prototype.getDotSeriesSpec=function(){return this._dotSeriesSpec},i.prototype.setDotSeriesSpec=function(t){T(t)&&(this._dotSeriesSpec=t)},i.prototype._getDotData=function(){var t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this),hY(this._option.dataSet,"linkDotInfo",$J),null===(t=this.getViewData())||void 0===t||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:function(){return{fromField:i._fromField,toField:i._toField,xField:i._dotSeriesSpec.xField,yField:i._dotSeriesSpec.yField}},linkData:function(){return i._rawData.latestData},dotData:function(){return i._getDotData()}},level:mY.linkDotInfo},!1)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)},i.prototype.initMark=function(){this._clipMark=this._createMark(i.mark.group),this._containerMark=this._createMark(i.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(i.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(i.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})},i.prototype.initMarkStyle=function(){var e,i,n,r,o=this,a=this._clipMark;a&&(this.setMarkStyle(a,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight,clip:!0},"normal",t.AttributeLevel.Series),a.setInteractive(!1));var s=this._containerMark;s&&(this.setMarkStyle(s,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",t.AttributeLevel.Series),s.setInteractive(!1));var l=this._linkMark;l&&(this.setMarkStyle(l,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",t.AttributeLevel.Series),this._trigger.registerMark(l));var u=this._arrowMark;if(u){var c=null!==(r=null===(n=null===(i=null===(e=this._theme)||void 0===e?void 0:e.arrow)||void 0===i?void 0:i.style)||void 0===n?void 0:n.size)&&void 0!==r?r:10;this.setMarkStyle(u,{x:this.dataToPositionXTo.bind(this),y:function(t){return o.dataToPositionArrowYTo(t,c)},fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:c,symbolType:function(t){return o.isPositionYFromHigher(t)?"triangleDown":"triangleUp"}},"normal",t.AttributeLevel.Series),this._trigger.registerMark(u)}},i.prototype.afterInitMark=function(){e.prototype.afterInitMark.call(this),this._trigger.setStateKeys([this._seriesField,this._fromField])},i.prototype.dataToPositionXFrom=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYFrom=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._fromField+"_yField")):Number.NaN},i.prototype.dataToPositionXTo=function(t){return this._xAxisHelper?(0,this._xAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionYTo=function(t){return this._yAxisHelper?(0,this._yAxisHelper.dataToPosition)(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition}):Number.NaN},i.prototype.dataToPositionArrowYTo=function(t,e){if(!this._yAxisHelper)return Number.NaN;var i=this._yAxisHelper.dataToPosition,n=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+n},i.prototype.dataToOpacity=function(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1},i.prototype.isPositionYFromHigher=function(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)},i.prototype.isPositionXOuterRange=function(t,e){if(!this._xAxisHelper)return!1;var i=this._xAxisHelper,n=i.dataToPosition,r=i.getScale;return n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||n(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]},i.prototype.getDefaultColorDomain=function(){var t,e;return this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]},i.prototype.getColorAttribute=function(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:uV}},i.prototype.initTooltip=function(){this._tooltipHelper=new QJ(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)},i.prototype.onMarkTreePositionUpdate=function(t){var e=this;t.forEach((function(t){"group"===t.type?e.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()}))},i.prototype.getDotInfoData=function(){var t,e;return null===(e=null!==(t=this._linkMark)&&void 0!==t?t:this._arrowMark)||void 0===e?void 0:e.getData()},i.prototype.getActiveMarks=function(){return[this._linkMark,this._arrowMark]},i.type=t.SeriesTypeEnum.link,i.mark=TG,i}(gX),eQ=function(){Pq(),TX(),FU.registerSeries(tQ.type,tQ)},iQ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._supportStack=!0,t._arcGroupMark=null,t._getAngleValueStart=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t._stack?fV:kV],o=t._getAngleAxisSubTickData(i),a=o[1].value-o[0].value,s=ge(n.offsetAngle),l=void 0;if(T(r)){var u=IA(o,(function(t){return t.value-r})),c=r>o[u].value-a/2?Math.min(u,o.length-1):u>0?u-1:void 0;void 0!==c&&(l=t.angleAxisHelper.dataToPosition([o[c].value-a/2]))}return w(l)&&(l=t.angleAxisHelper.dataToPosition([o[0].value-a/2])),l+s}return t._getAngleValueStartWithoutMask(e)},t._getAngleValueEnd=function(e){var i=t._getAngleAxis(),n=t._spec.tickMask;if((null==n?void 0:n.forceAlign)&&t._isTickMaskVisible(i)){var r=e[t._stack?pV:t._angleField[0]],o=t._getAngleAxisSubTickData(i),a=o[1].value-o[0].value,s=ge(n.offsetAngle),l=IA(o,(function(t){return t.value-r})),u=r>o[l].value-a/2?Math.min(l,o.length-1):l>0?l-1:void 0;return(void 0!==u?t.angleAxisHelper.dataToPosition([o[u].value+a/2]):t.angleAxisHelper.dataToPosition([o[0].value-a/2]))+s}return t._getAngleValueEndWithoutMask(e)},t}return r(i,e),i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this);var r=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getSpec(),o=null!==(i=this._spec.startAngle)&&void 0!==i?i:null==r?void 0:r.startAngle;this._startAngle=T(o)?ge(o):Fw;var a=null!==(n=this._spec.endAngle)&&void 0!==n?n:null==r?void 0:r.endAngle;this._endAngle=T(a)?ge(a):zw,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()},i.prototype.getStackGroupFields=function(){return this._radiusField},i.prototype.getStackValueField=function(){var t;return null===(t=this._angleField)||void 0===t?void 0:t[0]},i.prototype.getGroupFields=function(){return this._angleField},i.prototype._convertMarkStyle=function(t){var i=e.prototype._convertMarkStyle.call(this,t),n="fill";if(i[n]){var r=t[n];"conical"!==(null==r?void 0:r.gradient)||T(null==r?void 0:r.startAngle)||T(null==r?void 0:r.endAngle)||(i[n]=o(o({},r),{startAngle:this._startAngle,endAngle:this._endAngle}))}return i},i.prototype._getAngleValueStartWithoutMask=function(t){if(this._stack){var e=aW(this.angleAxisHelper.dataToPosition([t[fV]]),this.angleAxisHelper.getScale(0));if(F(e))return e}return this._startAngle},i.prototype._getAngleValueEndWithoutMask=function(t){if(this._stack){var e=aW(this.angleAxisHelper.dataToPosition([t[pV]]),this.angleAxisHelper.getScale(0));if(F(e))return e}return this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])},i.prototype.getDimensionField=function(){return this._specRadiusField},i.prototype.getMeasureField=function(){return this._specAngleField},i.prototype.initMark=function(){this._initArcGroupMark()},i.prototype.initMarkStyle=function(){this._initArcGroupMarkStyle()},i.prototype._initArcGroupMark=function(){return this._arcGroupMark=this._createMark(i.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark},i.prototype._initArcGroupMarkStyle=function(){var e=this,i=this._arcGroupMark;i.setZIndex(this.layoutZIndex),i.created(),this.setMarkStyle(i,{clip:!0,x:0,y:0,path:function(){var t=e._getAngleAxis();if(e._isTickMaskVisible(t)){var i=e._spec.tickMask,n=i.angle,r=i.offsetAngle,a=i.style,s=void 0===a?{}:a,l=e._getAngleAxisSubTickData(t),u=e.angleAxisHelper.center(),c=u.x,h=u.y,d=e._computeLayoutRadius(),f=s;return l.map((function(t){var i=t.value,a=e.angleAxisHelper.dataToPosition([i])+ge(r),s=ge(n)/2;return Uy(o(o({},f),{x:c,y:h,startAngle:a-s,endAngle:a+s,innerRadius:d*e._innerRadius,outerRadius:d*e._outerRadius,fill:!0}))}))}var p=e.getLayoutRect();return[dy({width:p.width,height:p.height,fill:!0})]}},"normal",t.AttributeLevel.Series),this._arcGroupMark.setInteractive(!1)},i.prototype._getAngleAxis=function(){if(this.angleAxisHelper){var t=this.angleAxisHelper.getAxisId(),e=this._option.getChart().getAllComponents().find((function(e){return e.id===t}));return e}},i.prototype._getAngleAxisTickData=function(t){var e;return null===(e=null==t?void 0:t.getTickData())||void 0===e?void 0:e.getLatestData()},i.prototype._isTickMaskVisible=function(t){var e=this._getAngleAxisTickData(t),i=this._spec.tickMask;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1},i.prototype._getAngleAxisSubTickData=function(t){var e,i=this._getAngleAxisTickData(t),n=[],r=null!==(e=null==t?void 0:t.getSpec())&&void 0!==e?e:{},o=r.subTick,a=void 0===o?{}:o,s=r.tick,l=void 0===s?{}:s,u=a.tickCount,c=void 0===u?4:u,h=l.alignWithLabel;if((null==i?void 0:i.length)>=2){for(var d=i[1].value-i[0].value,f=0;f<i.length-1;f++){var p=i[f],v=i[f+1];n.push(p);for(var y=0;y<c;y++){var g=(y+1)/(c+1),m=(1-g)*p.value+g*(v?v.value:h?1:p.value+d);n.push({value:m})}}return n.push(i[i.length-1]),n}return i},i.mark=AG,i}(lJ),nQ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cacheStateStyle={},e}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{innerPadding:0,outerPadding:0})},e.prototype._filterStyle=function(t,e,i,n){var r,o,a,s,l,u,c,h,d,f,p,v,y,g,m,_,b,x;void 0===n&&(n=this.stateStyle),T(t.innerRadius)&&this.setAttribute("innerRadius",this._styleConvert(t.innerRadius),e,i,this._cacheStateStyle),T(t.outerRadius)&&this.setAttribute("outerRadius",this._styleConvert(t.outerRadius),e,i,this._cacheStateStyle);var k=null!==(r=t.innerPadding)&&void 0!==r?r:null===(a=null===(o=n[e])||void 0===o?void 0:o.innerPadding)||void 0===a?void 0:a.style,S=null!==(s=t.outerPadding)&&void 0!==s?s:null===(u=null===(l=n[e])||void 0===l?void 0:l.outerPadding)||void 0===u?void 0:u.style,w=null!==(f=null!==(c=t.innerRadius)&&void 0!==c?c:null===(d=null===(h=this._cacheStateStyle[e])||void 0===h?void 0:h.innerRadius)||void 0===d?void 0:d.style)&&void 0!==f?f:null===(v=null===(p=n[e])||void 0===p?void 0:p.innerRadius)||void 0===v?void 0:v.style,M=null!==(_=null!==(y=t.outerRadius)&&void 0!==y?y:null===(m=null===(g=this._cacheStateStyle[e])||void 0===g?void 0:g.outerRadius)||void 0===m?void 0:m.style)&&void 0!==_?_:null===(x=null===(b=n[e])||void 0===b?void 0:b.outerRadius)||void 0===x?void 0:x.style;if(0===w&&0===M)return t;var C=T(t.innerPadding)&&T(w)||T(t.outerPadding)&&T(M),E=T(t.innerRadius)&&k||T(t.outerRadius)&&S;if(C||E){var R=Object.assign({},t);return k&&T(w)&&(A(w)?R.innerRadius=function(t,e,i,n){return w(t,e,i,n)+(A(k)?k(t,e,i,n):k)}:A(k)?R.innerRadius=function(t,e,i,n){var r=k(t,e,i,n);return w+r}:R.innerRadius=w+k),S&&T(M)&&(A(M)?R.outerRadius=function(t,e,i,n){return M(t,e,i,n)-(A(S)?S(t,e,i,n):S)}:A(S)?R.outerRadius=function(t,e,i,n){var r=S(t,e,i,n);return M-r}:R.outerRadius=M-S),R}return t},e.type="arc",e.constructorType="progressArc",e}(gJ),rQ=function(){qj(),CK(),FU.registerMark(nQ.constructorType,nQ)},oQ={type:"fadeIn"};function aQ(t,e){return"fadeIn"===e?oQ:function(t){return{type:"growAngleIn",options:{overall:t.startAngle}}}(t)}var sQ=function(){FU.registerAnimation("circularProgress",(function(t,e){return{appear:aQ(t,e),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}}))},lQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circularProgress,i._progressMark=null,i._trackMark=null,i._getRadiusValueStart=function(t){if(i.getGroupFields().length>1){var e=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()));if(F(e))return e}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])},i._getRadiusValueEnd=function(t){var e,n;if(i.getGroupFields().length>1){var r=i.radiusAxisHelper.dataToPosition(i.getDatumPositionValues(t,i.getGroupFields()))+(null===(n=(e=i.radiusAxisHelper).getBandwidth)||void 0===n?void 0:n.call(e,i._groups?i._groups.fields.length-1:0));if(F(r))return r}return i.radiusAxisHelper.dataToPosition([t[i._radiusField[0]]])+i.radiusAxisHelper.getScale(0).step()},i}return r(i,e),i.prototype.getStackGroupFields=function(){return this.getGroupFields()},i.prototype.getGroupFields=function(){return this._radiusField},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t;return this._progressMark=this._createMark(i.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0,customShape:null===(t=this._spec.progress)||void 0===t?void 0:t.customShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i=this,n=this._progressMark;n&&(this.setMarkStyle(n,{x:function(){return i.angleAxisHelper.center().x},y:function(){return i.angleAxisHelper.center().y},startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!==(e=this._spec.roundCap)&&void 0!==e&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",t.AttributeLevel.Series),this._trigger.registerMark(n))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)},i.prototype._initTrackMark=function(){var t;return this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,customShape:null===(t=this._spec.track)||void 0===t?void 0:t.customShape}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&(this.setMarkStyle(i,{visible:function(t){var i=e.angleAxisHelper.getScale(0).range(),n=Math.min(i[0],i[i.length-1]),r=e._getAngleValueStartWithoutMask(t);return Math.abs(r-n)<=1e-14},x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:function(){var t,i=e._stack?fV:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueStart(((t={})[i]=n[0],t))},endAngle:function(){var t,i=e._stack?pV:e._angleField[0],n=e.angleAxisHelper.getScale(0).domain();return e._getAngleValueEnd(((t={})[i]=n[n.length-1],t))},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",t.AttributeLevel.Series),this._trigger.registerMark(i))},i.prototype.initAnimation=function(){var t,e,i,n,r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},r),sX("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),sX("track",this._spec,this._markAttributeContext)))},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.circularProgress,i.mark=wG,i}(iQ),uQ=function(){rQ(),_J(),sQ(),wK(),FU.registerSeries(lQ.type,lQ)};function cQ(t){return function(){return"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}}var hQ=function(t){return{type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:cQ(t)}},dQ={type:"fadeIn"};function fQ(t,e){return!1===e?{}:"fadeIn"===e?dQ:function(t){return{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:cQ(t)}}(t)}var pQ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(e,i){var n=t.prototype.getDefaultTooltipPattern.call(this,e,i);return"mark"===e?n:"dimension"===e?(n.visible=!1,n):null},e}(YK),vQ=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.linearProgress,i._progressMark=null,i._trackMark=null,i._progressGroupMark=null,i}return r(i,e),i.prototype.initMark=function(){this._initProgressGroupMark(),this._initTrackMark(),this._initProgressMark()},i.prototype.initMarkStyle=function(){this._initProgressGroupMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()},i.prototype._initProgressMark=function(){var t;return this._progressMark=this._createMark(i.mark.progress,{isSeriesMark:!0,parent:this._progressGroupMark,customShape:null===(t=this._spec.progress)||void 0===t?void 0:t.customShape}),this._progressMark},i.prototype._initProgressMarkStyle=function(){var e,i,n,r,o,a,s,l,u=this,c=this._progressMark;if(c){if("vertical"===this._spec.direction){var h=null!==(i=null===(e=this._spec.progress)||void 0===e?void 0:e.leftPadding)&&void 0!==i?i:0,d=null!==(r=null===(n=this._spec.progress)||void 0===n?void 0:n.rightPadding)&&void 0!==r?r:0;this.setMarkStyle(c,{x:function(t){var e,i;return aW(u.dataToPositionX(t),null===(i=null===(e=u._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-u._spec.bandWidth/2+h},y:function(t){var e,i;return aW(u.dataToPositionY(t),null===(i=null===(e=u._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},height:function(){var t;return null===(t=u._yAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:u._bandPosition})},width:this._spec.bandWidth-h-d,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}else{var f=null!==(a=null===(o=this._spec.progress)||void 0===o?void 0:o.topPadding)&&void 0!==a?a:0,p=null!==(l=null===(s=this._spec.progress)||void 0===s?void 0:s.bottomPadding)&&void 0!==l?l:0;this.setMarkStyle(c,{x:function(t){var e,i;return aW(u.dataToPositionX(t),null===(i=null===(e=u._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-u._xAxisHelper.dataToPosition([1],{bandPosition:u._bandPosition})},y:function(t){var e,i;return aW(u.dataToPositionY(t),null===(i=null===(e=u._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-u._spec.bandWidth/2+f},height:this._spec.bandWidth-f-p,width:function(){var t;return null===(t=u._xAxisHelper)||void 0===t?void 0:t.dataToPosition([1],{bandPosition:u._bandPosition})},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series)}this._trigger.registerMark(c)}},i.prototype._initTrackMark=function(){var t;return this._trackMark=this._createMark(i.mark.track,{parent:this._progressGroupMark,customShape:null===(t=this._spec.track)||void 0===t?void 0:t.customShape}),this._trackMark},i.prototype._initTrackMarkStyle=function(){var e=this,i=this._trackMark;i&&("vertical"===this._spec.direction?this.setMarkStyle(i,{x:function(t){var i,n;return aW(e.dataToPositionX(t),null===(n=null===(i=e._xAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0))-e._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:function(){return e._scaleY.range()[0]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series):this.setMarkStyle(i,{x:0,y:function(t){var i,n;return aW(e.dataToPositionY(t),null===(n=null===(i=e._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===n?void 0:n.call(i,0))-e._spec.bandWidth/2},height:this._spec.bandWidth,width:function(){return e._scaleX.range()[1]},cornerRadius:this._spec.cornerRadius},"normal",t.AttributeLevel.Series),this._trigger.registerMark(i))},i.prototype._initProgressGroupMark=function(){return this._progressGroupMark=this._createMark(i.mark.group,{skipBeforeLayouted:!1}),this._progressGroupMark},i.prototype._initProgressGroupMarkStyle=function(){var e=this,i=this._progressGroupMark;i.setZIndex(this.layoutZIndex),i.created(),this.setMarkStyle(i,{clip:!0,x:0,y:0,path:function(){var t,i=[];return null===(t=e._rawData)||void 0===t||t.rawData.forEach((function(t,n){var r,o,a,s;if("vertical"===e._spec.direction){var l=aW(e.dataToPositionX(t),null===(o=null===(r=e._xAxisHelper)||void 0===r?void 0:r.getScale)||void 0===o?void 0:o.call(r,0))-e._spec.bandWidth/2,u=e._scaleY.range()[0];i.push(dy({x:l,y:0,height:u,width:e._spec.bandWidth,cornerRadius:e._spec.cornerRadius,fill:!0}))}else{var c=aW(e.dataToPositionY(t),null===(s=null===(a=e._yAxisHelper)||void 0===a?void 0:a.getScale)||void 0===s?void 0:s.call(a,0))-e._spec.bandWidth/2,h=e._scaleX.range()[1];i.push(dy({x:0,y:c,height:e._spec.bandWidth,width:h,cornerRadius:e._spec.cornerRadius,fill:!0}))}})),i}},"normal",t.AttributeLevel.Series),this._progressGroupMark.setInteractive(!1)},i.prototype.initAnimation=function(){var t,e,i,n,r={direction:this.direction},o=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("linearProgress"))||void 0===i?void 0:i(r,o),sX("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),sX("track",this._spec,this._markAttributeContext)))},i.prototype.initTooltip=function(){this._tooltipHelper=new pQ(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)},i.prototype.getActiveMarks=function(){return[this._progressMark]},i.type=t.SeriesTypeEnum.linearProgress,i.mark=PG,i}(gX),yQ=function(){rZ(),FU.registerAnimation("linearProgress",(function(t,e){return{appear:fQ(t,e),enter:{type:"grow"},disappear:hQ(t)}})),wK(),FU.registerSeries(vQ.type,vQ)},gQ=[0],mQ=[20,40],_Q=[200,500],bQ={shrink:!1,enlarge:!1,fontSizeLimitMin:0},xQ=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon"],kQ="".concat(bw,"_WORD_CLOUD_ANGLE"),SQ="".concat(bw,"_WORD_CLOUD_FILLING_ANGLE"),AQ="".concat(bw,"_WORD_CLOUD_WEIGHT"),wQ="".concat(bw,"_WORD_CLOUD_TEXT"),TQ=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._fontSizeRange=[20,20],t._isWordCloudShape=!1,t}return r(i,e),i.prototype.setValueField=function(t){T(t)&&(this._valueField=t)},i.prototype.setFontSizeRange=function(t){T(t)?this._fontSizeRange=t:this._fontSizeRange=mQ},i.prototype.setAttrFromSpec=function(){var t,i,n,r,a,s,l,u,c,h;e.prototype.setAttrFromSpec.call(this),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._fontFamilyField=this._spec.fontFamilyField,this._fontWeightField=this._spec.fontWeightField,this._fontStyleField=this._spec.fontStyleField,this._colorHexField=this._spec.colorHexField,this._colorMode=null!==(t=this._spec.colorMode)&&void 0!==t?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!==(i=this._spec.fontWeightRange)&&void 0!==i?i:_Q,this._rotateAngles=null!==(n=this._spec.rotateAngles)&&void 0!==n?n:gQ,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!==(r=this._spec.maskShape)&&void 0!==r?r:"circle",this._keepAspect=this._spec.keepAspect,this._random=null===(a=this._spec.random)||void 0===a||a,this._fontPadding=null!==(l=null===(s=this._spec.word)||void 0===s?void 0:s.padding)&&void 0!==l?l:1,this._textField=(null===(u=this._spec.word)||void 0===u?void 0:u.formatMethod)?wQ:this._nameField,this._wordCloudConfig=o({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:bQ},this._spec.wordCloudConfig),this._wordCloudShapeConfig=o({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:gQ,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._fillingFontPadding=null!==(h=null===(c=this._spec.fillingWord)||void 0===c?void 0:c.padding)&&void 0!==h?h:1,this._isWordCloudShape=!xQ.includes(this._maskShape),this._defaultFontFamily=this._option.getTheme().fontFamily},i.prototype.initMark=function(){this._wordMark=this._createMark(i.mark.word,{defaultMorphElementKey:this._seriesField,groupKey:this._seriesField,isSeriesMark:!0}),this._isWordCloudShape&&(this._fillingWordMark=this._createMark(i.mark.fillingWord))},i.prototype.initMarkStyle=function(){var e,i,n,r,o,a=this,s=this._wordMark,l=this._fillingWordMark,u=null!==(e=this._spec.word)&&void 0!==e?e:{};s&&(this.setMarkStyle(s,{fill:this._colorHexField?function(t){return t[a._colorHexField]}:this.getWordColorAttribute(this._seriesField,!1),text:function(t){return t[a._textField]},x:function(t){return t.x},y:function(t){return t.y},fontFamily:function(t){return t.fontFamily},fontSize:function(t){return t.fontSize},fontStyle:function(t){return t.fontStyle},fontWeight:function(t){return t.fontWeight},angle:function(t){return t.angle},visible:function(t){return!t.isFillingWord&&t.visible}},"normal",t.AttributeLevel.Series),this.setMarkStyle(s,{fontFamily:null!==(n=null===(i=u.style)||void 0===i?void 0:i.fontFamily)&&void 0!==n?n:this._defaultFontFamily},"normal",t.AttributeLevel.User_Mark)),l&&(this.setMarkStyle(l,{fill:this._wordCloudShapeConfig.fillingColorHexField?function(t){return t[a._wordCloudShapeConfig.fillingColorHexField]}:this.getWordColorAttribute(this._wordCloudShapeConfig.fillingSeriesField,!0),text:function(t){return t[a._textField]},x:function(t){return t.x},y:function(t){return t.y},fontFamily:function(t){return t.fontFamily},fontSize:function(t){return t.fontSize},fontStyle:function(t){return t.fontStyle},fontWeight:function(t){return t.fontWeight},angle:function(t){return t.angle},visible:function(t){return t.isFillingWord&&t.visible}},"normal",t.AttributeLevel.Series),this.setMarkStyle(l,{fontFamily:null!==(o=null===(r=u.style)||void 0===r?void 0:r.fontFamily)&&void 0!==o?o:this._defaultFontFamily},"normal",t.AttributeLevel.User_Mark)),this._trigger.registerMark(s),this._trigger.registerMark(l)},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark),this._fillingWordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._fillingWordMark)},i.prototype.initAnimation=function(){var t=this;[this._wordMark,this._fillingWordMark].forEach((function(e){var i,n;if(e){var r=null===(n=null===(i=t._spec)||void 0===i?void 0:i.animationAppear)||void 0===n?void 0:n.preset,o={animationConfig:function(){var t,i;return null===(i=null===(t=e.getAnimationConfig())||void 0===t?void 0:t.appear)||void 0===i?void 0:i[0]}};e.setAnimationConfig(aX(FU.getAnimationInKey("wordCloud")(o,r),sX("word",t._spec,t._markAttributeContext)))}}))},i.prototype.getWordOrdinalColorScale=function(t,e){var i,n,r,o,a,s=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,l=t?null===(i=this.getViewData())||void 0===i?void 0:i.latestData.map((function(e){return e[t]})):[],u=null!==(r=null!=s?s:null===(n=this._option.globalScale.getScale("color"))||void 0===n?void 0:n.range())&&void 0!==r?r:this._getDataScheme();return null===(a=(o=(new nW).domain(l)).range)||void 0===a?void 0:a.call(o,u)},i.prototype.getWordColorAttribute=function(t,e){var i,n;if("ordinal"===this._colorMode)return{scale:this.getWordOrdinalColorScale(t,e),field:null!==(i=this._seriesField)&&void 0!==i?i:uV};var r=null!==(n=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)&&void 0!==n?n:this._option.globalScale.getScale("color").range();return 1===r.length&&(r=[r[0],r[0]]),function(t){return r[0]}},i.prototype.compile=function(){var t,i;e.prototype.compile.call(this);var n=this._region.getLayoutRect(),r=n.width,a=n.height;if(F(r)&&F(a)&&a>0&&r>0){var s=[],l=this._valueField,u=new pA,h=this._fontWeightRange,d=this._rotateAngles,f=this._wordCloudShapeConfig.fillingRotateAngles;if(l){var p=c(lS(null===(t=this.getViewData())||void 0===t?void 0:t.latestData.map((function(t){return+t[l]}))),2),v=p[0],y=p[1];u.domain([v,y],!0).range(h),s.push({type:"map",as:AQ,callback:function(t){return v===y?u.scale(y):u.scale(t[l])}})}s.push({type:"map",as:kQ,callback:function(){return d[Math.floor(Math.random()*d.length)]}}),s.push({type:"map",as:SQ,callback:function(){return f[Math.floor(Math.random()*f.length)]}});var g=null!==(i=this._spec.word)&&void 0!==i?i:{};g.formatMethod&&s.push({type:"map",as:wQ,callback:g.formatMethod}),this._isWordCloudShape?s.push(o({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):(s.push(o({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.getProduct().transform(s)),this._data.getProduct().transform(s)}},i.prototype._wordCloudTransformOption=function(){var t,e,i,n,r,o=this._region.getLayoutRect(),a=o.width,s=o.height,l=null!==(e=null===(t=this._spec.word)||void 0===t?void 0:t.style)&&void 0!==e?e:{};return{layoutType:Kk(this._option.mode)?this._wordCloudConfig.layoutMode:"fast",size:[a,s],shape:this._maskShape,dataIndexKey:lV,text:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:this._fontPadding,rotate:{field:kQ},fontFamily:null!==(n=null!==(i=this._fontFamilyField)&&void 0!==i?i:l.fontFamily)&&void 0!==n?n:this._defaultFontFamily,fontWeight:this._fontWeightField?{field:this._fontWeightField}:this._valueField?{field:AQ}:null,fontStyle:null!==(r=this._fontStyleField)&&void 0!==r?r:l.fontStyle,randomVisible:this._random,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep}},i.prototype._wordCloudShapeTransformOption=function(){var t,e,i,n,r,o,a,s,l,u,c=this._region.getLayoutRect(),h=c.width,d=c.height,f=null!==(e=null===(t=this._spec.word)||void 0===t?void 0:t.style)&&void 0!==e?e:{},p=null!==(i=this._wordCloudShapeConfig)&&void 0!==i?i:{},v=this._wordCloudShapeConfig.fillingRotateAngles;return{dataIndexKey:lV,size:[h,d],shape:this._maskShape,text:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:this._fontPadding,rotateList:this._rotateAngles,fontFamily:null!==(r=null!==(n=this._fontFamilyField)&&void 0!==n?n:f.fontFamily)&&void 0!==r?r:this._defaultFontFamily,fontWeight:this._fontWeightField?{field:this._fontWeightField}:this._valueField?{field:AQ}:null,fontStyle:null!==(o=this._fontStyleField)&&void 0!==o?o:f.fontStyle,fillingFontFamily:null!==(s=null!==(a=p.fillingFontFamilyField)&&void 0!==a?a:f.fontFamily)&&void 0!==s?s:this._defaultFontFamily,fillingPadding:this._fillingFontPadding,fillingFontStyle:null!==(l=p.fillingFontStyleField)&&void 0!==l?l:f.fontStyle,fillingFontWeight:null!==(u=p.fillingFontWeightField)&&void 0!==u?u:f.fontWeight,fillingRotateList:v,fillingTimes:p.fillingTimes,fillingXStep:p.fillingXStep,fillingYStep:p.fillingYStep,fillingXRatioStep:p.fillingXRatioStep,fillingYRatioStep:p.fillingYRatioStep,fillingInitialOpacity:p.fillingInitialOpacity,fillingDeltaOpacity:p.fillingDeltaOpacity,fillingInitialFontSize:p.fillingInitialFontSize,fillingDeltaFontSize:p.fillingDeltaFontSize,ratio:p.ratio,fillingRatio:p.fillingRatio,removeWhiteBorder:p.removeWhiteBorder,textLayoutTimes:p.textLayoutTimes,fontSizeShrinkFactor:p.fontSizeShrinkFactor,stepFactor:p.stepFactor,layoutMode:p.layoutMode,importantWordCount:p.importantWordCount,globalShinkLimit:p.globalShinkLimit,fontSizeEnlargeFactor:p.fontSizeEnlargeFactor,fillingDeltaFontSizeFactor:p.fillingDeltaFontSizeFactor}},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype.dataToPosition=function(t){return null},i.prototype.dataToPositionX=function(t){return null},i.prototype.dataToPositionY=function(t){return null},i.prototype.dataToPositionZ=function(t){return null},i.prototype.valueToPosition=function(t,e){return null},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this.compile()},i.prototype.getActiveMarks=function(){return[this._wordMark,this._fillingWordMark]},i.mark=CG,i}(pX),MQ=function(t){return{custom:kh,customParameters:function(e,i){return t},easing:"linear",loop:1/0,duration:6e3}};function CQ(t,e){return!1===e?{}:"fadeIn"===e?{type:"fadeIn"}:function(t){return{channel:{fontSize:{from:0}},duration:200,delay:function(e,i,n){var r=t.animationConfig(),o=(null==r?void 0:r.duration)||200,a=(null==r?void 0:r.totalTime)||xK.appear.duration,s=n.VGRAMMAR_ANIMATION_PARAMETERS.elementCount;return n.VGRAMMAR_ANIMATION_PARAMETERS.elementIndex*function(t,e,i){return t*i<e?t+(e-i*t)/(i-1):(e-t)/(i-1)}(o,a,s)}}}(t)}var EQ={triangleForward:function(){return function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:RQ,triangle:RQ,diamond:function(){return function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1-Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function RQ(){return function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function PQ(t,e){var i=e[0],n=e[1],r=1,o=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":o[1]=~~(n/2.7*.6),r=Math.floor(Math.min(i/2.3,n/2.6));break;case"triangleForward":r=n/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(n/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":o[1]=~~(n/1.5),r=Math.floor(Math.min(n/1.5,i/2));break;case"rect":r=Math.floor(Math.max(n/2,i/2));break;default:r=Math.floor(Math.min(i/2,n/2))}return{maxRadius:r,center:o}}var BQ=function(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"};function LQ(t){return A(t)?t:function(){return t}}var OQ=function(){function t(e){var i,n,r,o=this;switch(jt(this,t),this.options=Q({},t.defaultOptions,e),A(this.options.shape)?this.shape=this.options.shape:this.shape=(r=this.options.shape,EQ[r]?EQ[r]():EQ.circle()),this.getText=null!==(i=LQ(this.options.text))&&void 0!==i?i:function(t){return t},this.getTextFontWeight=LQ(this.options.fontWeight),this.getTextFontSize=LQ(this.options.fontSize),this.getTextFontStyle=LQ(this.options.fontStyle),this.getTextFontFamily=LQ(this.options.fontFamily),this.outputCallback=null!==(n=this.options.outputCallback)&&void 0!==n?n:function(t){return t},this.options.color){case"random-dark":this.getTextColor=function(){return BQ(10,50)};break;case"random-light":this.getTextColor=function(){return BQ(50,90)};break;default:this.getTextColor=LQ(this.options.color)}if(w(this.options.rotate))if(this.options.useRandomRotate){var a=Math.abs(this.options.maxRotation-this.options.minRotation),s=Math.abs(Math.floor(this.options.rotationSteps)),l=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=function(){return 0===o.options.rotateRatio||Math.random()>o.options.rotateRatio?0:0===a?l:s>0?l+Math.floor(Math.random()*s)*a/(s-1):l+Math.random()*a}}else this.getTextRotate=function(){return 0};else this.getTextRotate=A(this.options.rotate)?function(t){var e;return ge(null!==(e=o.options.rotate(t))&&void 0!==e?e:0)}:function(){var t;return ge(null!==(t=o.options.rotate)&&void 0!==t?t:0)}}return zt(t,[{key:"exceedTime",value:function(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!==(t=this.currentStepIndex)&&void 0!==t?t:0)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}},{key:"progressiveRun",value:function(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!==(t=this.currentStepIndex)&&void 0!==t?t:0)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex&&this.progressiveIndex<this.data.length){this.progressiveResult=[];for(var e=this.data.length,i=this.progressiveIndex;i<e&&(this.layoutWord(i),i++,this.progressiveIndex=i,!this.exceedTime()););return this.progressiveResult}return this.result}},{key:"initProgressive",value:function(){this.progressiveIndex=-1,this.options.progressiveStep>0?this.currentStepIndex=0:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}},{key:"output",value:function(){return this.result?this.outputCallback(this.result):null}},{key:"progressiveOutput",value:function(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}},{key:"unfinished",value:function(){return this.data&&this.data.length&&!w(this.progressiveIndex)&&this.progressiveIndex<this.data.length}},{key:"release",value:function(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}]),t}();OQ.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,backgroundColor:"#fff"};var IQ={archimedean:function(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}},rectangular:function(t){var e=4*t[0]/t[1],i=0,n=0;return function(t){var r=t<0?-1:1;switch(Math.sqrt(1+4*r*t)-r&3){case 0:i+=e;break;case 1:n+=4;break;case 2:i-=e;break;default:n-=4}return[i,n]}}};function DQ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var FQ=function(t){ue(i,t);var e=DQ(i);function i(t){var n,r;return jt(this,i),(n=e.call(this,Q({},i.defaultOptions,t))).cw=64,n.ch=2048,n._size=[256,256],n._isBoardExpandCompleted=!1,n._placeStatus=0,n._tTemp=null,n._dtTemp=null,n._dy=0,n.cacheMap=new Map,n.options.minFontSize<=i.defaultOptions.minFontSize&&(n.options.minFontSize=i.defaultOptions.minFontSize),n.spiral=P(n.options.spiral)?null!==(r=IQ[n.options.spiral])&&void 0!==r?r:IQ.archimedean:n.options.spiral,n.random=n.options.random?Math.random:function(){return 1},n.getTextPadding=LQ(n.options.padding),n}return zt(i,[{key:"zoomRatio",value:function(){return this._originSize[0]/this._size[0]}},{key:"dy",value:function(){return this._dy}},{key:"layoutWord",value:function(t){var e=this.data[t];if(""===(""+e.text).trim())return!0;var i=PQ(this.options.shape,this._size),n=i.maxRadius,r=i.center;if(e.x=r[0],e.y=r[1],function(t,e,i,n,r,o){if(e.sprite)return;var a=t.context,s=t.ratio;a.setTransform(s,0,0,s,0,0),a.clearRect(0,0,(r<<5)/s,o/s);var l,u,c,h,d,f=0,p=0,v=0,y=i.length;for(--n;++n<y;){if(e=i[n],a.save(),a.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/s)+"px "+e.fontFamily,l=a.measureText(e.text+"m").width*s,c=e.fontSize<<1,e.angle){var g=Math.sin(e.angle),m=Math.cos(e.angle),_=l*m,b=l*g,x=c*m,k=c*g;l=Math.max(Math.abs(_+k),Math.abs(_-k))+31>>5<<5,c=~~Math.max(Math.abs(b+x),Math.abs(b-x))}else l=l+31>>5<<5;if(c>v&&(v=c),f+l>=r<<5&&(f=0,p+=v,v=0),p+c>=o)break;a.translate((f+(l>>1))/s,(p+(c>>1))/s),e.angle&&a.rotate(e.angle),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=l,e.height=c,e.xoff=f,e.yoff=p,e.x1=l>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=l}for(var S=a.getImageData(0,0,(r<<5)/s,o/s).data,A=[];--n>=0;)if((e=i[n]).hasText){for(u=(l=e.width)>>5,c=e.y1-e.y0,h=0;h<c*u;h++)A[h]=0;if(null==(f=e.xoff))return;p=e.yoff;var w=0,T=-1;for(d=0;d<c;d++){for(h=0;h<l;h++){var M=u*d+(h>>5),C=S[(p+d)*(r<<5)+(f+h)<<2]?1<<31-h%32:0;A[M]|=C,w|=C}w?T=d:(e.y0++,c--,d--,p++)}e.y1=e.y0+T,e.sprite=A.slice(0,(e.y1-e.y0)*u)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,n))return this.result.push(e),this._bounds?function(t,e){var i=t[0],n=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>n.x&&(n.x=e.x+e.x1),e.y+e.y1>n.y&&(n.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){var o=e.fontSize*this._originSize[0]/this.options.minFontSize,a=Math.max(e.width,e.height);if(a<=o)this.expandBoard(this._board,this._bounds,a/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,o/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}},{key:"layout",value:function(t,e){var i=this;this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=m(this._size);var n=this.getContext(ux.createCanvas({width:1,height:1}));this.contextAndRatio=n,this._board=new Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null;var r=t.length,o=0;this.result=[];var a=t.map((function(t){return{text:i.getText(t),fontFamily:i.getTextFontFamily(t),fontStyle:i.getTextFontStyle(t),fontWeight:i.getTextFontWeight(t),angle:i.getTextRotate(t),fontSize:~~i.getTextFontSize(t),padding:i.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0}})).sort((function(t,e){return e.fontSize-t.fontSize}));this.data=a;for(var s=0;o<r&&(this.layoutWord(o)||s>=2?(o++,s=0):s++,this.progressiveIndex=o,!this.exceedTime()););if(!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){var l=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(l-this._size[1]/2)}return this.result}},{key:"formatTagItem",value:function(t){for(var e,i,n=this._size,r=this.zoomRatio(),o=this.dy(),a=n[0]>>1,s=n[1]>>1,l=t.length,u=[],c=0;c<l;++c)e=t[c],(i={}).datum=e.datum,i.x=(e.x+a)*r,i.y=(e.y+s+o)*r,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*r,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,u.push(i);return u}},{key:"output",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}},{key:"progressiveOutput",value:function(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}},{key:"updateBoardExpandStatus",value:function(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}},{key:"shouldShrinkContinue",value:function(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}},{key:"shrinkBoard",value:function(t){var e=t[0],i=t[1];if(!(i.x>=this._size[0]||i.y>=this._size[1])){var n=Math.min(e.x,this._size[0]-i.x),r=Math.min(e.y,this._size[1]-i.y),o=2*Math.min(n/this._size[0],r/this._size[1]);this._size=this._size.map((function(t){return t*(1-o)}))}}},{key:"expandBoard",value:function(t,e,i){var n=this._size[0]*(i||1.1)-this._size[0]>>5,r=2*n>2?n:2;r%2!=0&&r++;var o=Math.ceil(this._size[1]*(r<<5)/this._size[0]);o%2!=0&&o++;var a=this._size[0],s=this._size[1],l=new Array(r).fill(0),u=new Array(o/2*(r+(a>>5))).fill(0);this.insertZerosToArray(t,s*(a>>5),u.length+r/2);for(var c=s-1;c>0;c--)this.insertZerosToArray(t,c*(a>>5),l.length);this.insertZerosToArray(t,0,u.length+r/2),this._size=[a+(r<<5),s+o],e&&(e[0].x+=(r<<5)/2,e[0].y+=o/2,e[1].x+=(r<<5)/2,e[1].y+=o/2)}},{key:"insertZerosToArray",value:function(t,e,i){for(var n=Math.floor(i/6e4),r=i%6e4,o=0;o<n;o++)t.splice.apply(t,[e+6e4*o,0].concat(m(new Array(6e4).fill(0))));t.splice.apply(t,[e+6e4*n,0].concat(m(new Array(r).fill(0))))}},{key:"getContext",value:function(t){t.width=1,t.height=1;var e=t.getContext("2d").getImageData(0,0,1,1),i=Math.sqrt(e.data.length>>2);t.width=(this.cw<<5)/i,t.height=this.ch/i;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:i,canvas:t}}},{key:"place",value:function(t,e,i,n){var r=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;var o=this.random()<.5?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,o))return null;var a,s,l,u,c=e.x,h=e.y,d=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),f=this.spiral(this._size),p=-o;for(this._tTemp=null,this._dtTemp=null;a=f(p+=o);){s=a[0],l=a[1];var v=Math.sqrt(Math.pow(s,2)+Math.pow(l,2)),y=Math.atan(l/s);s<0?y+=Math.PI:l<0&&(y=2*Math.PI+y);var g=this.shape(y);if(Math.min(Math.abs(s),Math.abs(l))>=d)break;if(v>=n)r&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=o);else{if(e.x=c+~~(v*g*Math.cos(-y)),e.y=h+~~(v*g*Math.sin(-y)),u=e,this.options.clip)if(this.shouldShrinkContinue()){if(NQ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=o);continue}}else{if(HQ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=o);continue}NQ(u,this._size)&&(u=VQ(u,this._size))}else if(NQ(u,this._size)){r&&null===this._tTemp&&(this._tTemp=p,this._dtTemp=o);continue}if(r=!0,(!i||jQ(u,i))&&(!i||!zQ(u,t,this._size))){for(var m=u.sprite,_=u.width>>5,b=this._size[0]>>5,x=u.x-(_<<4),k=127&x,S=32-k,A=u.y1-u.y0,w=void 0,T=(u.y+u.y0)*b+(x>>5),M=0;M<A;M++){w=0;for(var C=0;C<=_;C++)t[T+C]|=w<<S|(C<_?(w=m[M*_+C])>>>k:0);T+=b}return e.sprite=null,u.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),!this.shouldShrinkContinue()&&this.setCache(u,o),!1}},{key:"clearCache",value:function(){this.cacheMap.clear()}},{key:"setCache",value:function(t,e){var i="".concat(t.angle,"-").concat(e),n=t.x1-t.x0,r=t.y1-t.y0;if(this.cacheMap.has(i)){var o=this.cacheMap.get(i),a=o.width,s=o.height;(n<a&&r<s||n<=a&&r<s)&&this.cacheMap.set(i,{width:n,height:r})}else this.cacheMap.set(i,{width:n,height:r})}},{key:"isSizeLargerThanMax",value:function(t,e){var i="".concat(t.angle,"-").concat(e);if(!this.cacheMap.has(i))return!1;var n=this.cacheMap.get(i),r=n.width,o=n.height,a=t.x1-t.x0,s=t.y1-t.y0;return a>=r&&s>=o}}]),i}(OQ);function zQ(t,e,i){for(var n,r=i[0]>>5,o=t.sprite,a=t.width>>5,s=t.x-(a<<4),l=127&s,u=32-l,c=t.y1-t.y0,h=(t.y+t.y0)*r+(s>>5),d=0;d<c;d++){n=0;for(var f=0;f<=a;f++)if((n<<u|(f<a?(n=o[d*a+f])>>>l:0))&e[h+f])return!0;h+=r}return!1}function jQ(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}FQ.defaultOptions={enlarge:!1,minFontSize:2};var HQ=function(t,e){return t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0},NQ=function(t,e){return t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1]};function VQ(t,e){for(var i=t.sprite,n=t.y1-t.y0,r=t.width>>5,o=0,a=[],s=Math.max(-(t.y0+t.y),0),l=Math.min(n+(e[1]-(t.y1+t.y)),n),u=Math.max(-(t.x0+t.x),0)>>5,c=Math.min(r+(e[0]-(t.x1+t.x)>>5)+1,r),h=0;h<n;h++){for(var d=0;d<r;d++)h<s||l<=h||d<u||c<=d||a.push(i[o+d]);o+=r}var f=u<<5,p=r-c<<5,v=s,y=n-l;return Object.assign(Object.assign({},t),{width:t.width-f-p,height:t.height-v-y,x0:t.x0+f,x1:t.x1-p,y0:t.y0+v,y1:t.y1-y,x:t.x+f/2-p/2,sprite:a})}function GQ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}var WQ=function(t){ue(i,t);var e=GQ(i);function i(t){var n;return jt(this,i),(n=e.call(this,Q({},i.defaultOptions,t))).fillGridAt=function(t,e){t>=n.ngx||e>=n.ngy||t<0||e<0||(n.grid[t][e]=!1)},n.updateGrid=function(t,e,i,r,o){for(var a=o.occupied,s=a.length;s--;){var l=t+a[s][0],u=e+a[s][1];l>=n.ngx||u>=n.ngy||l<0||u<0||n.fillGridAt(l,u)}},n.gridSize=Math.max(Math.floor(n.options.gridSize),4),n}return zt(i,[{key:"getPointsAtRadius",value:function(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];var e=8*t,i=e,n=[];for(0===t&&n.push([this.center[0],this.center[1],0]);i--;){var r=this.shape(i/e*2*Math.PI);n.push([this.center[0]+t*r*Math.cos(-i/e*2*Math.PI),this.center[1]+t*r*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=n,n}},{key:"getTextInfo",value:function(t){var e,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.options.clip?1:n,o=Math.max(Math.floor(this.getTextFontSize(t)*r),this.options.minFontSize),a=this.getText(t)+"";if(this.options.clip&&(a=a.slice(0,Math.ceil(a.length*n))),!a)return null;var s=this.getTextFontWeight(t),l=this.getTextFontStyle(t),u=this.getTextRotate&&null!==(e=this.getTextRotate(t))&&void 0!==e?e:0,c=this.getTextFontFamily(t),h=document.createElement("canvas"),d=h.getContext("2d",{willReadFrequently:!0});d.font=l+" "+s+" "+o.toString(10)+"px "+c;var f=d.measureText(a).width,p=Math.max(o,d.measureText("m").width,d.measureText("Ｗ").width),v=f+2*p,y=3*p,g=Math.ceil(v/this.gridSize),m=Math.ceil(y/this.gridSize);v=g*this.gridSize,y=m*this.gridSize;var _=-f/2,b=.4*-p,x=Math.ceil((v*Math.abs(Math.sin(u))+y*Math.abs(Math.cos(u)))/this.gridSize),k=Math.ceil((v*Math.abs(Math.cos(u))+y*Math.abs(Math.sin(u)))/this.gridSize),S=k*this.gridSize,A=x*this.gridSize;h.setAttribute("width",""+S),h.setAttribute("height",""+A),d.scale(1,1),d.translate(S/2,A/2),d.rotate(-u),d.font=l+" "+s+" "+o.toString(10)+"px "+c,d.fillStyle="#000",d.textBaseline="middle",d.fillText(a,_,b);var w=d.getImageData(0,0,S,A).data;if(this.exceedTime())return null;for(var T,M=[],C=k,E=[x/2,k/2,x/2,k/2],R=function(t,e,n){for(var r=i.gridSize;r--;)for(var o=i.gridSize;o--;)if(w[4*((e*i.gridSize+r)*S+(t*i.gridSize+o))+3])return n.push([t,e]),t<E[3]&&(E[3]=t),t>E[1]&&(E[1]=t),e<E[0]&&(E[0]=e),void(e>E[2]&&(E[2]=e))};C--;)for(T=x;T--;)R(C,T,M);return{datum:t,occupied:M,bounds:E,gw:k,gh:x,fillTextOffsetX:_,fillTextOffsetY:b,fillTextWidth:f,fillTextHeight:p,fontSize:o,fontStyle:l,fontWeight:s,fontFamily:c,angle:u,text:a}}},{key:"canFitText",value:function(t,e,i,n,r){for(var o=r.length;o--;){var a=t+r[o][0],s=e+r[o][1];if(a>=this.ngx||s>=this.ngy||a<0||s<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[a][s])return!1}return!0}},{key:"layoutWord",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.data[t],r=this.getTextInfo(n,i);if(!r)return!1;if(this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){var o=r.bounds;if(o[1]-o[3]+1>this.ngx||o[2]-o[0]+1>this.ngy)return!1}for(var a=this.maxRadius+1,s=function(t){var i=Math.floor(t[0]-r.gw/2),n=Math.floor(t[1]-r.gh/2),o=r.gw,s=r.gh;return!!e.canFitText(i,n,o,s,r.occupied)&&(r.distance=e.maxRadius-a,r.theta=t[2],e.outputText(i,n,r),e.updateGrid(i,n,o,s,r),!0)};a--;){var l=this.getPointsAtRadius(this.maxRadius-a);if(this.options.random&&ft(l=[].concat(l)),l.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*i)}},{key:"outputText",value:function(t,e,i){var n=this.getTextColor(i),r={text:i.text,datum:i.datum,color:n,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(r),this.progressiveResult&&this.progressiveResult.push(r)}},{key:"initGrid",value:function(t){var e,i=this;if(this.grid=[],t){var n=document.createElement("canvas").getContext("2d");n.fillStyle=this.options.backgroundColor,n.fillRect(0,0,1,1);for(var r=n.getImageData(0,0,1,1).data,o=t.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize).data,a=function(t,n){for(var a=i.gridSize;a--;)for(var s=i.gridSize;s--;)for(e=4;e--;)if(o[4*((n*i.gridSize+a)*i.ngx*i.gridSize+(t*i.gridSize+s))+e]!==r[e])return void(i.grid[t][n]=!1)},s=this.ngx;s--;){this.grid[s]=[];for(var l=this.ngy;l--;)a(s,l),!1!==this.grid[s][l]&&(this.grid[s][l]=!0)}o=n=r=void 0}else for(var u=this.ngx;u--;){this.grid[u]=[];for(var c=this.ngy;c--;)this.grid[u][c]=!0}}},{key:"layout",value:function(t,e){this.initProgressive(),this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);var i=PQ(this.options.shape,[e.width,e.height]),n=i.center,r=i.maxRadius;this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[n[0]/this.gridSize,n[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e.canvas),this.result=[];for(var o=0;o<t.length&&(this.layoutWord(o),o++,this.progressiveIndex=o,!this.exceedTime()););return this.result}}]),i}(OQ);function UQ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=de(t);if(e){var r=de(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return he(this,i)}}WQ.defaultOptions={gridSize:8,ellipticity:1};var YQ=function(t){ue(i,t);var e=UQ(i);function i(t){var n;return jt(this,i),(n=e.call(this,Q({},i.defaultOptions,t))).random=n.options.random?Math.random:function(){return 0},n.aspectRatio=1,n}return zt(i,[{key:"fit",value:function(t){for(var e=0,i=this.result.length;e<i;e++)if(KQ(t,this.result[e]))return!1;return!0}},{key:"getTextInfo",value:function(t){var e={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},i=Sg(e);return e.width=i.width(),e.height=i.height(),e.top=this.center[1]-e.height+.21*e.height,e.left=this.center[0]-e.width/2,e}},{key:"layoutWord",value:function(t){for(var e=this.getTextInfo(this.data[t]),i=2*Math.PI,n=0,r=e.left,o=e.top,a=e.width,s=e.height,l=1,u=this.fit(e);!u&&n<this.maxRadius;)n+=.5,l=this.shape(n/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),r=this.center[0]-a/2+n*l*Math.cos(i)*this.aspectRatio,o=this.center[1]-s/2+n*l*Math.sin(i),e.left=r,e.top=o,e.x=r+a/2,e.y=o+s/2,u=this.fit(e);return!!u&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}},{key:"layout",value:function(t,e){var i=this;if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((function(t,e){return i.getTextFontSize(e)-i.getTextFontSize(t)}));for(var n=0;n<t.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}]),i}(OQ);function KQ(t,e){return!(t.left+t.width<e.left||t.top+t.height<e.top||t.left>e.left+e.width||t.top>e.top+e.height)}YQ.defaultOptions={enlarge:!1};var XQ={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},ZQ=function(t,e){var i,n,r,o,a,s;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return gi.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];var l=e,u=(null!==(i=t.size)&&void 0!==i?i:[500,500]).slice();u[0]=Math.floor(u[0]),u[1]=Math.floor(u[1]);var c=t.fontFamily?qQ(t.fontFamily):"sans-serif",h=t.fontStyle?qQ(t.fontStyle):"normal",d=t.fontWeight?qQ(t.fontWeight):"normal",f=t.rotate?qQ(t.rotate):0,p=qQ(t.text),v=null!==(n=t.spiral)&&void 0!==n?n:"archimedean",y=t.padding?qQ(t.padding):1,g=null!==(r=t.shape)&&void 0!==r?r:"square",m=null!==(o=t.shrink)&&void 0!==o&&o,_=null!==(a=t.enlarge)&&void 0!==a&&a,b=null!==(s=t.clip)&&void 0!==s&&s,x=t.minFontSize,k=t.randomVisible,S=t.as||XQ,A=t.depth_3d,w=t.postProjection,T=t.fontSize?qQ(t.fontSize):14,M=t.fontSizeRange;if(M&&!I(T)){var C=T,E=QQ($Q(C,l),M);T=function(t){return E(C(t))}}var R=FQ;"fast"===t.layoutType?R=YQ:"grid"===t.layoutType&&(R=WQ);var P=new R({text:p,padding:y,spiral:v,shape:g,rotate:f,fontFamily:c,fontStyle:h,fontWeight:d,fontSize:T,shrink:m,clip:b,enlarge:_,minFontSize:x,random:k,progressiveStep:t.progressiveStep,progressiveTime:t.progressiveTime,outputCallback:function(t){for(var e,i,n=[],r=0,o=t.length;r<o;r++)(e=(i=t[r]).datum)[S.x]=i.x,e[S.y]=i.y,e[S.fontFamily]=i.fontFamily,e[S.fontSize]=i.fontSize,e[S.fontStyle]=i.fontStyle,e[S.fontWeight]=i.fontWeight,e[S.angle]=i.angle,"StereographicProjection"===w&&t$(u,i,e,S,A),n.push(e);return n}});return P.layout(l,{width:u[0],height:u[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:P}:P.output()},qQ=function(t){return P(t)||I(t)||A(t)?t:function(e){return e[t.field]}},JQ=function(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)},QQ=function(t,e){if(t[0]===t[1])return function(t){return e[0]};var i=JQ(t[0]),n=JQ(t[1]),r=Math.min(i,n),o=Math.max(i,n);return function(t){return(JQ(t)-r)/(o-r)*(e[1]-e[0])+e[0]}},$Q=function(t,e){for(var i,n=1/0,r=-1/0,o=e.length,a=0;a<o;++a)(i=gt(t(e[a])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]};function t$(t,e,i,n,r){var o=Math.max(t[0],t[1])/2,a=function(t,e,i,n,r){var o=r.x,a=r.y,s=o/t*Math.PI*2,l=Math.PI-a/e*Math.PI;return l+=(l<Math.PI/2?1:-1)*Math.pow(Math.min(l-Math.PI/2,1),2)/5,{x:i*Math.sin(l)*Math.cos(s)+n.x,y:i*Math.cos(l)+n.y,z:i*Math.sin(l)*Math.sin(s)+n.z}}(t[0],t[1],o,{x:o,y:o,z:null!=r?r:o},e);i[n.x]=a.x,i[n.y]=a.y,i[n.z]=a.z}var e$,i$=function(){gT.registerTransform("wordcloud",{transform:ZQ,markPhase:"beforeJoin"},!0)};function n$(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return r$(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r$(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function r$(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",t.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout"}(e$||(e$={}));var o$=function(t,e){if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},a$=function(){var t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return function(){return e[t=(t+1)%e.length]}},s$=function(t){return/^[\u4e00-\u9fa5]+$/.test(t)},l$=function(t,e){if(w(t))return 0;var i,n=0,r=n$(t);try{for(r.s();!(i=r.n()).done;){var o=i.value;s$(o)?n+=1:n+=.53}}catch(t){r.e(t)}finally{r.f()}return n};function u$(t){return t&&(z(t)||j(t)||t.startsWith("<svg"))?new Promise((function(e,i){var n,r=wy({image:t}),o=null===(n=r.resources)||void 0===n?void 0:n.get(t);o&&"success"===o.state&&o.data?e(o.data):(r.successCallback=function(){var n;if(r){var o=null===(n=r.resources)||void 0===n?void 0:n.get(t);o&&"success"===o.state&&o.data?e(o.data):i(new Error("image load failed"+t))}else i(new Error("image load failed"+t))},r.failCallback=function(){gi.getInstance().error("image 加载失败！",t)})})):null}function c$(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c$=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var h$=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};function d$(t){return h$(this,void 0,void 0,c$().mark((function e(){var i;return c$().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u$(t.shapeUrl);case 2:return i=e.sent,e.abrupt("return",t.removeWhiteBorder&&i?v$(i,t.tempCanvas,t.tempCtx):i);case 4:case"end":return e.stop()}}),e)})))}function f$(t,e){var i=e.size,n=e.tempCanvas,r=e.tempCtx,o=function(t,e){var i=t.width,n=t.height,r=e[0]/i;n*r>e[1]&&(r=e[1]/n);var o=Math.floor(r*i),a=Math.floor(r*n);return{x:(e[0]-o)/2,y:(e[1]-a)/2,width:o,height:a,scale:r}}(t,i);n.width=i[0],n.height=i[1],r.clearRect(0,0,n.width,n.height),r.drawImage(t,o.x,o.y,o.width,o.height);for(var a=r.getImageData(0,0,i[0],i[1]),s=new Array(i[0]*i[1]).fill(0),l=1,u=[[0,1],[1,0],[-1,0],[0,-1]],c=[],h=0;h<i[1];h++)for(var d=0;d<i[0];d++)if(0===s[h*i[0]+d]&&!p$(a,h,d)){s[h*i[0]+d]=l,c.push([h,d]);for(var f=0;f<c.length;f++)for(var p=0;p<4;p++){var v=c[f][0]+u[p][0],y=c[f][1]+u[p][1];v=v<0?0:v>=i[1]?i[1]-1:v,y=y<0?0:y>=i[0]?i[0]-1:y,0!==s[v*i[0]+y]||p$(a,v,y)||(s[v*i[0]+y]=l,c.push([v,y]))}l++,c=[]}for(var g={},_={},b={},x={},k={},S={},A={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0},w=0;w<i[1];w++)for(var T=0;T<i[0];T++){var M=s[w*i[0]+T];0!==M&&(U(w,T)&&(g[M]=g[M]||[],g[M].push([T,w]),x[M]||(x[M]=[1/0,-1/0,1/0,-1/0]),w<x[M][0]&&(x[M][0]=w),w>x[M][1]&&(x[M][1]=w),T<x[M][2]&&(x[M][2]=T),T>x[M][3]&&(x[M][3]=T),T<A.x1&&(A.x1=T),T>A.x2&&(A.x2=T),w<A.y1&&(A.y1=w),w>A.y2&&(A.y2=w)),_[M]=_[M]||0,_[M]++)}var C=[];for(var E in g){var R=g[E],P=~~(R.reduce((function(t,e){return t+e[0]}),0)/R.length),B=~~(R.reduce((function(t,e){return t+e[1]}),0)/R.length);b[E]=[P,B],C.push.apply(C,m(R));var L=Mt(x[E],4),O=L[0],I=L[1],D=L[2],F=L[3];k[E]=~~Math.max(Math.sqrt(Math.pow(P-D,2)+Math.pow(B-O,2)),Math.sqrt(Math.pow(P-F,2)+Math.pow(B-I,2)),Math.sqrt(Math.pow(P-D,2)+Math.pow(B-I,2)),Math.sqrt(Math.pow(P-F,2)+Math.pow(B-O,2))),S[E]=(F-D)/(I-O)}var z=Object.keys(b).map((function(t){return{label:t-1,boundary:g[t],area:_[t],center:b[t],maxPoint:x[t],maxR:k[t],ratio:S[t]}}));A.width=A.x2-A.x1+1,A.height=A.y2-A.y1+1;var j=~~(C.reduce((function(t,e){return t+e[0]}),0)/C.length),H=~~(C.reduce((function(t,e){return t+e[1]}),0)/C.length),N=~~Math.max(Math.sqrt(Math.pow(j-A.x1,2)+Math.pow(H-A.y1,2)),Math.sqrt(Math.pow(j-A.x2,2)+Math.pow(H-A.y2,2)),Math.sqrt(Math.pow(j-A.x1,2)+Math.pow(H-A.y2,2)),Math.sqrt(Math.pow(j-A.x2,2)+Math.pow(H-A.y1,2))),V=A.width/A.height,G=Object.keys(_).reduce((function(t,e){return t+_[e]}),0),W={regions:z,labels:s,labelNumber:l-1};return Object.assign(e,{segmentation:W,shapeConfig:o,shapeBounds:A,shapeMaxR:N,shapeRatio:V,shapeCenter:[j,H],shapeArea:G});function U(t,e){var n=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===e||t===i[1]-1||e===i[0]-1)return!0;for(var r=0;r<4;r++){var o=t+n[r][0],a=e+n[r][1];if(o=o<0?0:o>=i[1]?i[1]-1:o,a=a<0?0:a>=i[0]?i[0]-1:a,0===s[o*i[0]+a])return!0}return!1}}function p$(t,e,i){var n=t.width;return 0===t.data[e*n*4+4*i+3]||255===t.data[e*n*4+4*i+0]&&255===t.data[e*n*4+4*i+1]&&255===t.data[e*n*4+4*i+2]}function v$(t,e,i){e.width=t.width,e.height=t.height,i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0);for(var n=e.width,r=i.getImageData(0,0,e.width,e.height),o=0,a=r.height,s=0,l=r.width;o<a&&y$(r,n,o);)++o;for(;a-1>o&&y$(r,n,a-1);)--a;for(;s<l&&g$(r,n,s,o,a);)++s;for(;l-1>s&&g$(r,n,l-1,o,a);)--l;var u=i.getImageData(s,o,l-s,a-o);return e.width=u.width,e.height=u.height,i.clearRect(0,0,e.width,e.height),i.putImageData(u,0,0),e}function y$(t,e,i){for(var n=0;n<e;++n)if(!p$(t,i,n))return!1;return!0}function g$(t,e,i,n,r){for(var o=n;o<r;++o)if(!p$(t,o,i))return!1;return!0}function m$(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return _$(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _$(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function _$(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function b$(t,e,i){var n=e.stepFactor,r=e.importantWordCount,o=e.globalShinkLimit,a=i.size,s=i.segmentation.regions,l=i.tempCtx,u=i.tempCanvas,c=i.boardSize,h=i.shapeCenter,d=i.shapeMaxR,f=i.shapeRatio,p=w$(i),v=p.slice(0),y=e.fontSizeShrinkFactor,g=null,m=1,_=1,b=r,x=0;t.length>b&&(x=t.sort((function(t,e){return e.weight-t.weight}))[b].weight);for(var k=0;k<s.length;k++){for(var S=s[k],A=S.words,w=S.center,T=S.maxR,M=S.ratio,C=!1,E=0;E<A.length;E++){A$(u,l,t,E);var R=A[E];if(R.x=w[0],R.y=w[1],!R.skip&&R.hasText&&R.sprite&&x$(v,R,T,M,a,c,n))R.hasPlaced=!0;else{if(!R.skip&&R.weight>x&&_>o){var P=R.datum[Symbol.for("vGrammar_id")];P!==g&&(g=P,m=_),_*=y,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*y})),v=p.slice(0),C=!0;break}if(!R.skip&&R.datum[Symbol.for("vGrammar_id")]===g){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_})),R.skip=!0,_=m,g=null,v=p.slice(0),C=!0;break}}}C&&(k=-1)}for(var B=0;B<e.textLayoutTimes;B++){var L=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===L.length)break;for(var O=0;O<L.length;O++){var I=L[O];A$(u,l,L,O),I.x=h[0],I.y=h[1],I.hasText&&x$(v,I,d,f,a,c,n)&&(I.hasPlaced=!0)}}e.board=v}function x$(t,e,i,n,r,o,a){for(var s,l,u,c=e.x,h=e.y,d=function(t){return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}(n),f=1*a,p=-f;s=d(p+=f);){e.wordSize;var v=e.bounds,y=v.dTop,g=v.dBottom,m=v.dLeft,_=v.dRight;if(l=s[0],u=s[1],Math.min(Math.abs(l),Math.abs(u))>=i)break;if(e.x=~~(c+l),e.y=~~(h+u),!(e.x-m<0||e.x+_>r[0]||e.y-y<0||e.y+g>r[1]||S$(e,t,o)))return k$(e,t,o),!0}return!1}function k$(t,e,i){var n,r=t.wordSize,o=t.sprite,a=r[0]>>5,s=i[0]>>5,l=t.x-(a<<4),u=l%32,c=32-u,h=r[1],d=(t.y-(r[1]>>1))*s+(l>>5);if(0===u)for(var f=0;f<h;f++){for(var p=0;p<a;p++)e[d+p]|=o[f*a+p];d+=s}else for(var v=0;v<h;v++){n=0;for(var y=0;y<=a;y++)e[d+y]|=n<<c|(y<a?(n=o[v*a+y])>>>u:0);d+=s}}function S$(t,e,i){var n,r=t.sprite,o=t.wordSize,a=i[0]>>5,s=o[0]>>5,l=t.x-(s<<4),u=l%32,c=32-u,h=o[1],d=(t.y-(o[1]>>1))*a+(l>>5);if(0===u)for(var f=0;f<h;f++){for(var p=0;p<s;p++)if(e[d+p]&r[f*s+p])return!0;d+=a}else for(var v=0;v<h;v++){n=0;for(var y=0;y<=s;y++)if((n<<c|(y<s?(n=r[v*s+y])>>>u:0))&e[d+y])return!0;d+=a}return!1}function A$(t,e,i,n){if(!i[n].sprite&&0!==i[n].fontSize){var r=2048,o=Math.PI/180,a=i.length;t.width=r,t.height=2048,e.clearRect(0,0,r,2048),e.textAlign="center";var s,l,u=0,c=0,h=0,d=0,f=n;for(--n;++n<a;){var p=i[n],v=Math.max(p.fontSize,2);if(e.save(),e.font=p.fontStyle+" "+p.fontWeight+" "+v+"px "+p.fontFamily,s=e.measureText(p.text+"m").width+2*p.padding,l=2*v+2*p.padding,0!==p.rotate){var y=Math.sin(p.rotate*o),g=Math.cos(p.rotate*o),m=s*g,_=s*y,b=l*g,x=l*y;s=Math.max(Math.abs(m+x),Math.abs(m-x)),l=~~Math.max(Math.abs(_+b),Math.abs(_-b))}if(s=s+31>>5<<5,(l=Math.ceil(l))>h&&(h=l),u+s>=r&&(u=0,c+=h,h=l),c+l>=2048){if(0===c){p.hasText=!1;continue}break}c+l>=d&&(d=c+l),e.translate(u+(s>>1),c+(l>>1)),0!==p.rotate&&e.rotate(p.rotate*o),e.fillText(p.text,0,0),p.padding&&(e.lineWidth=2*p.padding,e.strokeText(p.text,0,0)),e.restore(),p.LT=[u,c],p.wordSize=[s,l],p.hasText=!0,u+=s}if(0!==d)for(var k,S,A=e.getImageData(0,0,r,d).data;--n>=f;){var w=i[n];if(!w.hasText){w.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}var T=w.LT,M=void 0===T?[0,0]:T,C=w.wordSize,E=Mt(M,2);u=E[0],c=E[1];var R=C[0]>>5,P=new Array(R*C[1]).fill(0),B=1/0,L=-1/0,O=1/0,I=-1/0;for(S=0;S<C[1];S++){var D=void 0;for(k=0;k<C[0];k++)if(A[4*((c+S)*r+(u+k))+3]>0){var F=1<<31-k%32;P[R*S+(k>>5)]|=F,k<O&&(O=k),k>I&&(I=k),D|=F}D&&(S<B&&(B=S),S>L&&(L=S))}w.bounds={dTop:(C[1]>>1)-B,dBottom:L-(C[1]>>1),dLeft:(C[0]>>1)-O,dRight:I-(C[0]>>1)},w.sprite=P,delete w.LT}}}function w$(t){for(var e=t.segmentation.labels,i=t.boardSize,n=t.size,r=i[0]>>5,o=new Array(r*n[1]).fill(0),a=0;a<n[1];a++)for(var s=0;s<n[0];s++)if(0===e[a*n[0]+s]){var l=1<<31-s%32;o[r*a+(s>>5)]|=l}if(i[0]>n[0])for(var u=(1<<i[0]-n[0])-1,c=0;c<n[1];c++)o[r*c+r-1]|=u;return o}function T$(t,e,i){(function(t,e){var i=e.segmentation.regions,n=-1/0,r=0,o=0;i.forEach((function(t,e){var i=t.area;i>n&&(n=i,o=e),r+=i}));var a=0;i.forEach((function(e){var i=e.area,o=Math.ceil(i/r*t.length),s=i/n;e.words=[],e.regionNum=o,e.regionWeight=s,a+=o})),a<t.length&&(i[o].wordsNum+=t.length-a);var s=o,l=i.map((function(t){return t.regionNum}));t.forEach((function(t){var e=0,n=0;t.regionIndex=-1;do{if(l[s]>0&&t.weight<=i[s].regionWeight){t.regionIndex=s,i[s].words.push(t),l[s]--,s=(s+1)%i.length;break}s=(s+1)%i.length,e++,++n>i.length+1&&(i.forEach((function(t){t.regionWeight+=.15})),n=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=o,i[o].words.push(t),l[o]--)})),i.forEach((function(t){t.words.sort((function(t,e){return e.weight-t.weight}))}))})(t,i),"ensureMapping"===e.layoutMode?b$(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){var n=e.size,r=e.stepFactor,o=e.importantWordCount,a=i.segmentation.regions,s=i.tempCtx,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,f=w$(i),p=f.slice(0),v=e.fontSizeEnlargeFactor,y=Math.min(o,t.length),g=0;t.length>y&&(g=t.sort((function(t,e){return e.weight-t.weight}))[y-1].weight);for(var m=0,_=1,b=!1,x=0;x<a.length;x++){for(var k=a[x],S=k.words,A=k.center,w=k.maxR,T=k.ratio,M=!1,C=0;C<S.length;C++){A$(l,s,t,C);var E=S[C];if(E.x=A[0],E.y=A[1],E.hasText&&E.sprite&&x$(p,E,w,T,n,u,r)){if(E.hasPlaced=!0,E.weight>=g&&m++,m>=y&&!b){_*=v,t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*v})),p=f.slice(0),M=!0,m=0;break}}else{if(E.weight>=g&&_>1){t.forEach((function(t){t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/v})),_/=v,b=!0,p=f.slice(0),M=!0;break}if(E.weight>=g)return b$(t,e,i)}}M&&(x=-1)}for(var R=0;R<e.textLayoutTimes;R++){var P=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===P.length)break;for(var B=0;B<P.length;B++){var L=P[B];A$(l,s,P,B),L.x=c[0],L.y=c[1],L.hasText&&x$(p,L,h,d,n,u,r)&&(L.hasPlaced=!0)}}e.board=p}(t,e,i):function(t,e,i){var n,r=e.size,o=e.stepFactor,a=i.segmentation.regions,s=i.tempCtx,l=i.tempCanvas,u=i.boardSize,c=i.shapeCenter,h=i.shapeMaxR,d=i.shapeRatio,f=w$(i),p=m$(a);try{for(p.s();!(n=p.n()).done;)for(var v=n.value,y=v.words,g=v.center,m=v.maxR,_=v.ratio,b=0;b<y.length;b++){A$(l,s,t,b);var x=y[b];x.x=g[0],x.y=g[1],x.hasText&&x.sprite&&x$(f,x,m,_,r,u,o)&&(x.hasPlaced=!0)}}catch(t){p.e(t)}finally{p.f()}for(var k=0;k<e.textLayoutTimes;k++){var S=t.filter((function(t){return t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced}));if(0===S.length)break;for(var A=0;A<S.length;A++){var w=S[A];A$(l,s,S,A),w.x=c[0],w.y=c[1],w.hasText&&x$(f,w,h,d,r,u,o)&&(w.hasPlaced=!0)}}e.board=f}(t,e,i);for(var n=function(t,e,i){for(var n=e.size,r=e.fillingTimes,o=e.fillingXStep,a=e.fillingYStep,s=e.getFillingFontStyle,l=e.getFillingFontWeight,u=e.getFillingFontFamily,c=e.fillingInitialFontSize,h=e.fillingDeltaFontSize,d=e.fillingInitialOpacity,f=e.fillingDeltaOpacity,p=e.fillingRotateList,v=e.getFillingPadding,y=e.random,g=e.board,m=e.minFillFoontSize,_=i.boardSize,b=i.shapeBounds,x=i.tempCtx,k=i.tempCanvas,S=i.randomGenerator,A=c,w=d,T=[],M=0;M<r;M++)C(A,w),A=Math.max(A>h?A-h:h,m),w=w>f?w-f:f;return T;function C(e,i){var r=t.map((function(t){var n=t.text,r=t.color,o=t.fillingColor,a=t.hasPlaced,c=t.datum;return{x:0,y:0,weight:0,text:n,fontFamily:u(c),fontStyle:s(c),fontWeight:l(c),fontSize:e,rotate:p[~~(S()*p.length)],padding:v(c),opacity:i,visible:!0,color:r,fillingColor:o,hasPlaced:a,datum:c}}));E(r);for(var c=0,h=b.x1,d=b.y1,f=b.x2,m=b.y2,A=h+~~(S()*o*2),w=d+~~(S()*a*2);w<=m;w+=a)for(var M=A;M<=f;M+=o){A$(k,x,r,c);var C=r[c];C.x=M,C.y=w,C.wordSize;var R=C.bounds;if(C.hasPlaced&&R){var P=R.dTop,B=R.dBottom,L=R.dLeft,O=R.dRight;C.x-L<0||C.x+O>n[0]||C.y-P<0||C.y+B>n[1]||C.hasText&&C.sprite&&!S$(C,g,_)&&(k$(C,g,_),T.push(Object.assign({},C)),++c===r.length&&(c=0,y&&E(r)))}else++c===r.length&&(c=0,y&&E(r))}}function E(t){return t.sort((function(){return S()-.5}))}}(t,e,i),r=[],o=[],a=0;a<t.length;a++)t[a].hasPlaced?o.push(t[a]):r.push(t[a]);return r.forEach((function(t){return t.visible=!1})),{fillingWords:n,successedWords:o,failedWords:r}}function M$(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */M$=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,i){t[e]=i.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,a=Object.create(r.prototype),s=new P(n||[]);return o(a,"_invoke",{value:M(t,i,s)}),a}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",v="executing",y="completed",g={};function m(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var k=Object.getPrototypeOf,S=k&&k(k(B([])));S&&S!==n&&r.call(S,s)&&(x=S);var A=b.prototype=m.prototype=Object.create(x);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,a,s,l){var u=d(t[o],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return a=a?a.then(r,r):r()}})}function M(e,i,n){var r=f;return function(o,a){if(r===v)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var l=C(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var u=d(e,i,n);if("normal"===u.type){if(r=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=y,n.method="throw",n.arg=u.arg)}}}function C(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,C(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function i(){for(;++o<e.length;)if(r.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return _.prototype=b,o(A,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(A),t},e.awrap=function(t){return{__await:t}},w(T.prototype),c(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new T(h(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(A),c(A,u,"Generator"),c(A,s,(function(){return this})),c(A,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),R(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;R(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:B(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}var C$=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},E$={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"},R$=function(t,e,i,n){return C$(void 0,void 0,void 0,M$().mark((function i(){var r,o,a,s,l,u,c,h,d,f,p,v,y,g,m,_,b,x,k,S,A,T,M,C,E,R,P,B,L,O,I,D,F,z,j,H,N,V,G,W,U;return M$().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(!t.size||w(t.size[0])||w(t.size[1])||t.size[0]<=0||t.size[1]<=0)){i.next=2;break}return i.abrupt("return",(gi.getInstance().info("Wordcloud size dimensions must be greater than 0"),[]));case 2:if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||iS("WordcloudShape shape must be specified."),t.text||iS("WordcloudShape text must be specified."),(null==n?void 0:n.emit)&&n.emit(e$.BEFORE_WORDCLOUD_SHAPE_LAYOUT),s=e,l=t.as||E$,s&&0!==s.length){i.next=6;break}return i.abrupt("return",[]);case 6:return u={shapeUrl:t.shape,size:t.size,ratio:t.ratio||.8,tempCanvas:void 0,tempCtx:void 0,removeWhiteBorder:t.removeWhiteBorder||!1,boardSize:[0,0],random:!1,randomGenerator:void 0},c=ux.createCanvas({width:t.size[0],height:t.size[1]}),(h=c.getContext("2d")).textAlign="center",h.textBaseline="middle",u.tempCanvas=c,u.tempCtx=h,d=t.size[0]+31>>5<<5,u.boardSize=[d,t.size[1]],u.random?u.randomGenerator=Math.random:u.randomGenerator=a$(),i.next=12,d$(u);case 12:if(f=i.sent){i.next=15;break}return i.abrupt("return",[]);case 15:for(p=f$(f,u),v=t.colorMode||"ordinal",y={getText:D$(t.text),getFontSize:D$(t.fontSize),fontSizeRange:t.fontSizeRange,colorMode:v,getColor:t.colorField?D$(t.colorField):D$(t.text),getFillingColor:D$(t.fillingColorField),colorList:t.colorList||("ordinal"===v?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:D$(t.colorHexField),getFontFamily:D$(t.fontFamily||"sans-serif"),rotateList:t.rotateList||[0],getPadding:D$(t.padding||1),getFontStyle:D$(t.fontStyle||"normal"),getFontWeight:D$(t.fontWeight||"normal"),getFontOpacity:t.fontOpacity?D$(t.fontOpacity):function(){return 1}},B$(s,y,p),g={size:t.size,ratio:t.ratio||.8,shapeUrl:t.shape,random:void 0===t.random||t.random,textLayoutTimes:t.textLayoutTimes||3,removeWhiteBorder:t.removeWhiteBorder||!1,layoutMode:t.layoutMode||"default",fontSizeShrinkFactor:t.fontSizeShrinkFactor||.8,stepFactor:t.stepFactor||1,importantWordCount:t.importantWordCount||10,globalShinkLimit:t.globalShinkLimit||.2,fontSizeEnlargeFactor:t.fontSizeEnlargeFactor||1.5,fillingRatio:t.fillingRatio||.7,fillingTimes:t.fillingTimes||4,fillingXStep:t.fillingXRatioStep?Math.max(Math.floor(t.size[0]*t.fillingXRatioStep),1):t.fillingXStep||4,fillingYStep:t.fillingYRatioStep?Math.max(Math.floor(t.size[1]*t.fillingYRatioStep),1):t.fillingYStep||4,fillingInitialFontSize:t.fillingInitialFontSize,fillingDeltaFontSize:t.fillingDeltaFontSize,fillingInitialOpacity:t.fillingInitialOpacity||.8,fillingDeltaOpacity:t.fillingDeltaOpacity||.05,getFillingFontFamily:D$(t.fillingFontFamily||"sans-serif"),getFillingFontStyle:D$(t.fillingFontStyle||"normal"),getFillingFontWeight:D$(t.fillingFontWeight||"normal"),getFillingPadding:D$(t.fillingPadding||.4),fillingRotateList:t.fillingRotateList||[0,90],fillingDeltaFontSizeFactor:t.fillingDeltaFontSizeFactor||.2,fillingColorList:t.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:t.minInitFontSize||10,minFontSize:t.minFontSize||4,minFillFoontSize:t.minFillFoontSize||2},m=o$(y.colorList,g.fillingColorList),g.sameColorList=m,P$(s,y,g,t),O$(s,y,g,p),_=y.getText,b=y.getFontFamily,x=y.getFontStyle,k=y.getFontWeight,S=y.getPadding,A=y.getColor,T=y.getFillingColor,M=y.getColorHex,C=y.fontSizeScale,E=y.colorScale,R=y.fillingColorScale,P=y.getFontOpacity,B=y.rotateList,L=s.map((function(e){var i,n;return{x:0,y:0,weight:0,text:_(e),fontFamily:b(e),fontWeight:k(e),fontStyle:x(e),rotate:B[~~(u.randomGenerator()*B.length)],fontSize:Math.max(g.minInitFontSize,~~C(e)),opacity:P(e),padding:S(e),color:M&&M(e)||E&&E(A(e))||"black",fillingColor:!T||(null===(i=t.colorField)||void 0===i?void 0:i.field)===(null===(n=t.fillingColorField)||void 0===n?void 0:n.field)&&m?void 0:M&&M(e)||R&&R(T(e))||"black",datum:e,visible:!0,hasPlaced:!1}})),O=ct(L.map((function(t){return t.fontSize}))),L.forEach((function(t){return t.weight=t.fontSize/O})),L.sort((function(t,e){return e.weight-t.weight})),I=T$(L,g,p),D=I.fillingWords,F=I.successedWords,z=I.failedWords,N=[],V=0;V<L.length;++V)j=L[V],(H=j.datum)[l.x]=j.x,H[l.y]=j.y,H[l.fontFamily]=j.fontFamily,H[l.fontSize]=j.fontSize,H[l.fontStyle]=j.fontStyle,H[l.fontWeight]=j.fontWeight,H[l.angle]=ge(j.rotate),H[l.opacity]=j.opacity,H[l.visible]=j.visible,H[l.isFillingWord]=!1,H[l.color]=j.color,N.push(H);return G=null!==(o=null===(r=t.text)||void 0===r?void 0:r.field)&&void 0!==o?o:"textKey",W=null!==(a=t.dataIndexKey)&&void 0!==a?a:"defaultDataIndexKey",U=[],i.abrupt("return",(D.forEach((function(e,i){var n,r,o={};o[l.x]=e.x,o[l.y]=e.y,o[l.fontFamily]=e.fontFamily,o[l.fontSize]=e.fontSize,o[l.fontStyle]=e.fontStyle,o[l.fontWeight]=e.fontWeight,o[l.angle]=ge(e.rotate),o[l.opacity]=e.opacity,o[l.visible]=e.visible,o[l.isFillingWord]=!0,o[l.color]=T?(null===(n=t.colorField)||void 0===n?void 0:n.field)===(null===(r=t.fillingColorField)||void 0===r?void 0:r.field)&&m?e.color:e.fillingColor:g.fillingColorList[~~(u.randomGenerator()*g.fillingColorList.length)],o[G]=e.text,o[W]="".concat(e.text,"_").concat(i,"_fillingWords"),U.push(o)})),(null==n?void 0:n.emit)&&n.emit(e$.AFTER_WORDCLOUD_SHAPE_LAYOUT,{successedWords:F,failedWords:z}),N.concat(U)));case 26:case"end":return i.stop()}}),i)})))},P$=function(t,e,i,n){var r,o,a,s,l,u,c=e.colorMode,h=e.getColor,d=e.getFillingColor,f=i.sameColorList,p=e.colorList,v=i.fillingColorList;if("ordinal"===c){var y=t.map((function(t){return h(t)}));if(l=function(t){return(new GS).domain(y).range(p).scale(t)},d&&((null===(r=n.colorField)||void 0===r?void 0:r.field)!==(null===(o=n.fillingColorField)||void 0===o?void 0:o.field)||!f)){var g=t.map((function(t){return d(t)}));u=function(t){return(new GS).domain(g).range(v).scale(t)}}}else{1===p.length&&(p=[p[0],p[0]]);var m=(new pA).domain(I$(h,t)).range(p);if(l=function(t){return m.scale(t)},d&&((null===(a=n.colorField)||void 0===a?void 0:a.field)!==(null===(s=n.fillingColorField)||void 0===s?void 0:s.field)||!f)){1===v.length&&(v=[v[0],v[0]]);var _=(new pA).domain(I$(d,t)).range(v);u=function(t){return _.scale(t)}}}Object.assign(e,{colorScale:l,fillingColorScale:u})},B$=function(t,e,i){var n,r,o=e.fontSizeRange,a=e.getFontSize,s=e.getText;if(a){if(a&&o){var l=(new kA).domain(I$(a,t)).range(o);n=function(t){return l.scale(a(t))}}else if(a&&A(a)&&!o){var u=Mt(I$(a,t),2),c=u[0],h=u[1],d=t.map((function(t){return{text:s(t),value:a(t),weight:h===c?1:(a(t)-c)/(h-c)}})),f=L$(d,i,!0);o=[~~(.5*f),~~f];var p=(new kA).domain(I$(a,t)).range(o);n=function(t){return p.scale(a(t))}}}else{var v=t.map((function(t){return{text:s(t)}})),y=L$(v,i,!1);n="function"==typeof(r=y)?r:function(){return r}}Object.assign(e,{getFontSize:a,fontSizeRange:o,fontSizeScale:n})},L$=function(t,e,i){var n=e.shapeArea,r=e.ratio,o=e.segmentation.regions,a=Math.ceil(Math.sqrt(n)/12),s=t.reduce((function(t,e){var n=l$(e.text);return n<a?t+n*(i?Math.pow(.5+.5*e.weight,2):1):t}),0);if(0===s)return 12;var l=20;if(1===o.length)l=Math.sqrt(r*(n/(1.7*s)));else{for(var u=[],c=0;c<o.length;c++){var h=o[c].area,d=o[c].ratio,f=h/n;if(!(f<.1)){var p=f*(s*(d<1?2.7-d:1.7)),v=Math.sqrt(r*(h/p));u.push(v)}}l=u.length?Math.min.apply(Math,u):Math.sqrt(r*(n/(1.7*s)))}return l};function O$(t,e,i,n){var r=e.getText,o=i.fillingInitialFontSize,a=i.fillingDeltaFontSize,s=i.fillingRatio,l=Math.ceil(Math.sqrt(n.shapeArea)/4);if(!o||!a){var u,c=s/100,h=t.reduce((function(t,e){var i=l$(r(e));return i>l?t:t+i}),0)/t.length;if(0===h)u=8;else{var d=.2*n.shapeArea;u=Math.sqrt(c*(d/h))}o=~~u,a=u*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:o,fillingDeltaFontSize:a})}}var I$=function(t,e){for(var i,n=1/0,r=-1/0,o=e.length,a=0;a<o;++a)(i=gt(t(e[a])))<n&&(n=i),i>r&&(r=i);return 1===e.length&&n===r&&(n-=1e4),[n,r]},D$=function(t){return t?"string"==typeof t||"number"==typeof t?function(){return t}:A(t)?t:function(e){return e[t.field]}:null},F$=function(){gT.registerTransform("wordcloudShape",{transform:R$,markPhase:"beforeJoin"},!0)},z$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud,i}return r(i,e),i.type=t.SeriesTypeEnum.wordCloud,i}(TQ),j$=function(){i$(),Kq(),FU.registerAnimation("wordCloud",(function(t,e){return{appear:CQ(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})),FU.registerSeries(z$.type,z$)},H$=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.wordCloud3d,i}return r(i,e),i.prototype._wordCloudTransformOption=function(){var t;return o(o({},e.prototype._wordCloudTransformOption.call(this)),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})},i.prototype._wordCloudShapeTransformOption=function(){var t;return o(o({},e.prototype._wordCloudShapeTransformOption.call(this)),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})},i.prototype.initMark=function(){this._wordMark=this._createMark(TQ.mark.word,{groupKey:this._seriesField,support3d:!0,isSeriesMark:!0}),this._isWordCloudShape&&(this._fillingWordMark=this._createMark(TQ.mark.fillingWord,{groupKey:this._seriesField,support3d:!0,isSeriesMark:!0}))},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this);var i=this._wordMark,n=this._fillingWordMark;i&&this.setMarkStyle(i,{z:function(t){var e;return null!==(e=t.z)&&void 0!==e?e:0}},"normal",t.AttributeLevel.Series),n&&this.setMarkStyle(n,{z:function(t){var e;return null!==(e=t.z)&&void 0!==e?e:0}},"normal",t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i,n=this,r=null!==(t=this._padding)&&void 0!==t?t:{};this._wordMark&&this._wordMark.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("wordCloud3d"))||void 0===e?void 0:e((function(){var t,e=n.getCompiler().getVGrammarView(),i=e.width()-r.left||0-r.right||0,o=e.height()-r.top||0-r.bottom||0,a=Math.max(i,o)/2;return{center:{x:a,y:a,z:null!==(t=n._spec.depth_3d)&&void 0!==t?t:a},r:a}})),sX("word",this._spec,this._markAttributeContext))),this._fillingWordMark&&this._fillingWordMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("wordCloud3d"))||void 0===i?void 0:i((function(){var t,e=n.getCompiler().getVGrammarView(),i=e.width()-r.left||0-r.right||0,o=e.height()-r.top||0-r.bottom||0,a=Math.max(i,o)/2;return{center:{x:a,y:a,z:null!==(t=n._spec.depth_3d)&&void 0!==t?t:a},r:a}})),sX("fillingWord",this._spec,this._markAttributeContext)))},i.type=t.SeriesTypeEnum.wordCloud3d,i}(TQ),N$=function(){i$(),Kq(),FU.registerAnimation("wordCloud3d",(function(t){return{appear:MQ(t)}})),FU.registerSeries(H$.type,H$)},V$=function(t,e){var i,n,r=t.map((function(t){return o({},t)}));if(!r||0===r.length)return r;var a=e.valueField,s=e.asTransformRatio,l=e.asReachRatio,u=e.asHeightRatio,c=e.asValueRatio,h=e.asNextValueRatio,d=e.asLastValueRatio,f=e.asLastValue,p=e.asCurrentValue,v=e.asNextValue,y=e.heightVisual,g=void 0!==y&&y,m=e.isCone,_=void 0===m||m,b=e.range,x=r.reduce((function(t,e){return Math.max(t,Number.parseFloat(e[a])||-1/0)}),-1/0),k=r.reduce((function(t,e){return Math.min(t,Number.parseFloat(e[a])||1/0)}),1/0),S=[null!==(i=null==b?void 0:b.min)&&void 0!==i?i:k,null!==(n=null==b?void 0:b.max)&&void 0!==n?n:x];return r.forEach((function(t,e){var i,n,o=Number.parseFloat(t[a]),y=Number.parseFloat(null===(i=r[e-1])||void 0===i?void 0:i[a]),m=Number.parseFloat(null===(n=r[e+1])||void 0===n?void 0:n[a]),b=F(m*o)&&0!==o?m/o:0,x=F(o*y)&&0!==y?o/y:0;f&&(t[f]=y),v&&(t[v]=m),s&&(t[s]=b),l&&(t[l]=0===e?1:x),u&&(t[u]=!0===g?b:1/r.length),c&&(t[c]=o/S[1]),h&&(t[h]=e===r.length-1?_?0:t[c]:m/S[1]),d&&(t[d]=0===e?1:y/S[1]),p&&(t[p]=o)})),r},G$=function(t,e){var i,n,r=null===(n=null===(i=t[0])||void 0===i?void 0:i.latestData)||void 0===n?void 0:n.map((function(t){return o({},t)}));return r&&0!==r.length?(r.shift(),r.forEach((function(t){t[e.asIsTransformLevel]=!0})),r):r},W$="".concat(bw,"_FUNNEL_TRANSFORM_RATIO"),U$="".concat(bw,"_FUNNEL_REACH_RATIO"),Y$="".concat(bw,"_FUNNEL_HEIGHT_RATIO"),K$="".concat(bw,"_FUNNEL_VALUE_RATIO"),X$="".concat(bw,"_FUNNEL_LAST_VALUE_RATIO"),Z$="".concat(bw,"_FUNNEL_NEXT_VALUE_RATIO"),q$="".concat(bw,"_FUNNEL_LAST_VALUE"),J$="".concat(bw,"_FUNNEL_CURRENT_VALUE"),Q$="".concat(bw,"_FUNNEL_NEXT_VALUE"),$$="".concat(bw,"_FUNNEL_TRANSFORM_LEVEL"),t0=20,e0=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleValueCallback=function(t,i){var n,r,o,a=e.series;return"transform"===(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)?"转化率":null!==(r=e._getDimensionData(t))&&void 0!==r?r:null===(o=t.properties)||void 0===o?void 0:o["".concat(a.getCategoryField())]},e.contentValueCallback=function(t,i){var n;if("transform"===(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name)){var r=null==t?void 0:t[U$];return"".concat((100*r).toFixed(1),"%")}return e._getMeasureData(t)},e.contentKeyCallback=function(t,i){var n;if("transform"===(null===(n=null==i?void 0:i.mark)||void 0===n?void 0:n.name))return"转化率";var r=e._seriesCacheInfo,o=r.dimensionFields,a=r.seriesFields,s=o[o.length-1];return T(a[0])?null==t?void 0:t[a[0]]:null==t?void 0:t[s]},e}return r(e,t),e}(YK),i0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{points:[]})},e}(vK),n0=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{lineWidth:0})},e.type="polygon",e}(i0),r0=function(){FU.registerMark(n0.type,n0),jL(),EL(),gT.registerGraphic(sw.polygon,Qy),RK()},o0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")},e}(fX),a0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel,i._funnelMarkName="funnel",i._funnelMarkType="polygon",i._transformMarkName="transform",i._transformMarkType="polygon",i.transformerConstructor=o0,i._funnelMark=null,i._funnelTransformMark=null,i._labelMark=null,i._transformLabelMark=null,i._funnelOuterLabelMark={},i}return r(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!==(t=this._spec.funnelOrient)&&void 0!==t?t:"top",this._shape=null!==(i=this._spec.shape)&&void 0!==i?i:"trapezoid",this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)},i.prototype.initData=function(){if(e.prototype.initData.call(this),this._data){hY(this._dataSet,"funnel",V$),hY(this._dataSet,"funnelTransform",G$);var t=new Ma(this._dataSet,{name:"".concat(bw,"_series_").concat(this.id,"_viewDataTransform")});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new JK(this._option,t)}},i.prototype.getStatisticFields=function(){var t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t},i.prototype._statisticViewData=function(){var t,i,n,r,o,a,s,l,u;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:J$,asTransformRatio:W$,asReachRatio:U$,asHeightRatio:Y$,asValueRatio:K$,asNextValueRatio:Z$,asLastValueRatio:X$,asLastValue:q$,asNextValue:Q$,range:{min:null!==(i=null===(t=this._spec.range)||void 0===t?void 0:t.min)&&void 0!==i?i:null===(r=null===(n=this.getViewDataStatistics().latestData)||void 0===n?void 0:n[this.getValueField()])||void 0===r?void 0:r.min,max:null!==(a=null===(o=this._spec.range)||void 0===o?void 0:o.max)&&void 0!==a?a:null===(l=null===(s=this.getViewDataStatistics().latestData)||void 0===s?void 0:s[this.getValueField()])||void 0===l?void 0:l.max}}}),null===(u=this._viewDataTransform.getDataView())||void 0===u||u.transform({type:"funnelTransform",options:{asIsTransformLevel:$$}})},i.prototype.initMark=function(){var t,e,n,r,a,s,l,u,c,h;if(this._funnelMark=this._createMark(o(o({},i.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel,morph:cX(this._spec,this._funnelMarkName),defaultMorphElementKey:this._seriesField,groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(e=this._spec.funnel)||void 0===e?void 0:e.customShape}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(o(o({},i.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(n=this._theme)||void 0===n?void 0:n.transform,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId(),customShape:null===(r=this._spec.transform)||void 0===r?void 0:r.customShape})),null===(s=null===(a=this._spec)||void 0===a?void 0:a.outerLabel)||void 0===s?void 0:s.visible){var d=(null!==(l=this._spec.outerLabel)&&void 0!==l?l:{}).line,f=(null!==(c=null===(u=this._theme)||void 0===u?void 0:u.outerLabel)&&void 0!==c?c:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(h=this._theme)||void 0===h?void 0:h.outerLabel,markSpec:this._spec.outerLabel,skipBeforeLayouted:!0}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:f,markSpec:d,depend:[this._funnelOuterLabelMark.label]})}},i.prototype.initTooltip=function(){this._tooltipHelper=new e0(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)},i.prototype.getDimensionField=function(){return this._seriesField?[this._seriesField]:[]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getGroupFields=function(){return null},i.prototype.initMarkStyle=function(){var e=this,i=this._funnelMark;i&&(this.setMarkStyle(i,{points:function(t){return e.getPoints(t)},visible:function(t){return T(t[e._valueField])},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this._trigger.registerMark(i));var n=this._funnelTransformMark;n&&(this.setMarkStyle(n,{points:function(t){return e.getPoints(t)}},"normal",t.AttributeLevel.Series),this._trigger.registerMark(n));var r=this._funnelOuterLabelMark.label;r&&this.setMarkStyle(r,{text:function(t){var i="".concat(t[e.getCategoryField()]);return A(e._spec.outerLabel.formatMethod)?e._spec.outerLabel.formatMethod(i,t):i},x:function(t){return e._computeOuterLabelPosition(t).x},y:function(t){return e._computeOuterLabelPosition(t).y},textAlign:function(t){return e._computeOuterLabelPosition(t).align},textBaseline:function(t){return e._computeOuterLabelPosition(t).textBaseline},limit:function(t){return e._computeOuterLabelLimit(t)}},"normal",t.AttributeLevel.Series);var o=this._funnelOuterLabelMark.line;o&&r&&this.setMarkStyle(o,{x:function(t){return e._computeOuterLabelLinePosition(t).x1},y:function(t){return e._computeOuterLabelLinePosition(t).y1},x1:function(t){return e._computeOuterLabelLinePosition(t).x2},y1:function(t){return e._computeOuterLabelLinePosition(t).y2}},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(e){var i,n,r,o=this;if(e){var a=e.getTarget(),s=e.getComponent();a===this._funnelMark?(this._labelMark=e,this.setMarkStyle(e,{text:function(t){return"".concat(t[o.getCategoryField()]," ").concat(t[o.getValueField()])},x:function(t){return o._computeLabelPosition(t).x},y:function(t){return o._computeLabelPosition(t).y},maxLineWidth:function(t){return o._computeLabelLimit(t,o._spec.label)},stroke:this.getColorAttribute()},"normal",t.AttributeLevel.Series),(null===(n=this._funnelOuterLabelMark)||void 0===n?void 0:n.label)&&this._funnelOuterLabelMark.label.setDepend(s),(null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.line)&&(i=this._funnelOuterLabelMark.line).setDepend.apply(i,h([],c(this._funnelOuterLabelMark.line.getDepend()),!1))):this._funnelTransformMark&&a===this._funnelTransformMark&&(this._transformLabelMark=e,this.setMarkStyle(e,{text:function(t){var e=rw(U$).bind(o)(t);return"".concat((100*e).toFixed(1),"%")},x:function(t){return o._computeLabelPosition(t).x},y:function(t){return o._computeLabelPosition(t).y},maxLineWidth:function(t){return o._computeLabelLimit(t,o._spec.transformLabel)}},"normal",t.AttributeLevel.Series))}},i.prototype.initAnimation=function(){var t,e,i,n,r,o,a,s=this,l=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===l&&this._rootMark&&this._rootMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("cartesianGroupClip"))||void 0===n?void 0:n({direction:function(){return s._isHorizontal()?"x":"y"},width:function(){var t=s.getRootMark().getProduct();if(t){var e=t.getBounds(),i=e.x1,n=e.x2;return Math.max(i,n)}return s.getLayoutRect().width},height:function(){var t=s.getRootMark().getProduct();if(t){var e=t.getBounds(),i=e.y1,n=e.y2;return Math.max(i,n)}return s.getLayoutRect().height},orient:function(){return s._isReverse()?"negative":"positive"}},l),sX("group",this._spec,this._markAttributeContext))),[null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.label].forEach((function(t){t&&t.setAnimationConfig(aX(FU.getAnimationInKey("fadeInOut")(),sX(t.name,s._spec,s._markAttributeContext)))})),[this._funnelMark,this._funnelTransformMark].forEach((function(t){t&&t.setAnimationConfig(aX(FU.getAnimationInKey("funnel")({},l),sX(t.name,s._spec,s._markAttributeContext)))})),(null===(o=this._funnelOuterLabelMark)||void 0===o?void 0:o.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(aX(null===(a=FU.getAnimationInKey("fadeInOut"))||void 0===a?void 0:a(),sX("outerLabelLine",this._spec,this._markAttributeContext)))},i.prototype.initGroups=function(){},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return null},i.prototype.initEvent=function(){var t,i=this;e.prototype.initEvent.call(this),null===(t=this._viewDataTransform.getDataView())||void 0===t||t.target.addListener("change",(function(t){i._viewDataTransform.updateData()}))},i.prototype.getPoints=function(t){var e,i,n=this.isTransformLevel(t),r=this._getMainAxisLength(n)/2;n?(e="rect"===this._shape?this._getSecondaryAxisLength(t[X$])/2:this._getSecondaryAxisLength(t[K$])/2,i=this._getSecondaryAxisLength(t[K$])/2):(e=this._getSecondaryAxisLength(t[K$])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[Z$])/2);var o=this._getPositionByData(t),a=o.x,s=o.y,l=this._getPolygonPoints([a,s],e,i,e,i,r);return"center"!==this._funnelAlign&&this._adjustPoints(l),l},i.prototype.isTransformLevel=function(t){return!!(null==t?void 0:t[$$])},i.prototype._buildMarkAttributeContext=function(){e.prototype._buildMarkAttributeContext.call(this),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)},i.prototype.valueToPosition=function(t){var e,i,n,r=this,o=null===(n=null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.find)||void 0===n?void 0:n.call(i,(function(e){return e[r._categoryField]===t}));return T(o)?this._getPolygonCenter(this.getPoints(o)):null},i.prototype.dataToPosition=function(t){return this.valueToPosition(t[this._categoryField])},i.prototype.dataToPositionX=function(t){return this.dataToPosition(t).x},i.prototype.dataToPositionY=function(t){return this.dataToPosition(t).y},i.prototype.dataToPositionZ=function(t){return 0},i.prototype._getMainAxisLength=function(t){var e;void 0===t&&(t=!1);var i=this.getViewData().latestData.length,n=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,r=!!this._spec.isTransform,o=r?0:null!==(e=this._spec.gap)&&void 0!==e?e:0,a=r?Math.max(0,i-1):0,s=(n-o*Math.max(0,i-1))/(i+.5*a);return t?r?.5*s:0:s},i.prototype._getSecondaryAxisLength=function(t){var e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),n=this._computeMinSize();return n+(i-n)*e},i.prototype._getPositionByData=function(t){var e,i=this,n=null===(e=this.getViewData().latestData)||void 0===e?void 0:e.findIndex((function(e){return e[i._categoryField]===t[i._categoryField]&&e[lV]===t[lV]}));if(!T(n)||n<0)return{};var r=this.isTransformLevel(t),o=this._isHorizontal(),a=o?this.getLayoutRect().height:this.getLayoutRect().width,s=o?this.getLayoutRect().width:this.getLayoutRect().height,l=a/2,u=0,c=this._getMainAxisLength(),h=this._getMainAxisLength(!0);return u+=n*(c+h),u+=r?-h/2:c/2,!this._spec.isTransform&&this._spec.gap&&(u+=this._spec.gap*n),this._isReverse()&&(u=s-u),this._isHorizontal()?{x:u,y:l}:{x:l,y:u}},i.prototype._getPolygonPoints=function(t,e,i,n,r,o){var a=t[0],s=t[1];switch(this._funnelOrient){case"left":return[{x:a-o,y:s+e},{x:a-o,y:s-n},{x:a+o,y:s-r},{x:a+o,y:s+i}];case"right":return[{x:a+o,y:s-n},{x:a+o,y:s+n},{x:a-o,y:s+i},{x:a-o,y:s-i}];case"bottom":return[{x:a+e,y:s+o},{x:a-n,y:s+o},{x:a-r,y:s-o},{x:a+i,y:s-o}];default:return[{x:a-e,y:s-o},{x:a+n,y:s-o},{x:a+r,y:s+o},{x:a-i,y:s+o}]}},i.prototype._getPolygonCenter=function(t){if(this._isHorizontal()){var e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}var n=(t[0].x+t[3].x)/2,r=(t[0].y+t[3].y)/2;return{x:(n+(t[1].x+t[2].x)/2)/2,y:(r+(t[1].y+t[2].y)/2)/2}},i.prototype._adjustPoints=function(t){var e,i,n;return this._isHorizontal()?(n="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(n="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][n]-=e,t[1][n]-=e,t[2][n]-=i,t[3][n]-=i,t},i.prototype._computeLabelPosition=function(t){var e=this.getPoints(t);return this._getPolygonCenter(e)},i.prototype._computeLabelLimit=function(t,e){var i=null==e?void 0:e.limit;if(I(i))return i;var n=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(n[3].x-n[0].x):(Math.abs(n[0].x-n[1].x)+Math.abs(n[2].x-n[3].x))/2:this._isHorizontal()?Math.abs(n[3].x-n[0].x):void 0},i.prototype._computeOuterLabelPosition=function(t){var e,i,n,r,o,a=null===(i=this._spec.outerLabel)||void 0===i?void 0:i.position,s="center",l="middle";if(a=this._isHorizontal()?["top","bottom"].includes(a)?a:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(a)?a:"left"===this._funnelAlign?"right":"left",!1!==(null===(n=this._spec.outerLabel)||void 0===n?void 0:n.alignLabel))r=(e=this._getPositionByData(t)).x,o=e.y,"left"===a?(r=0,s="left"):"right"===a?(r=this.getLayoutRect().width,s="right"):"top"===a?(o=0,l="top"):"bottom"===a&&(o=this.getLayoutRect().height,l="bottom");else{var u=this._computeOuterLabelLinePosition(t);r=u.x2,o=u.y2,"left"===a?(r-=5,s="right"):"right"===a?(r+=5,s="left"):"top"===a?(o-=5,l="bottom"):"bottom"===a&&(o+=5,l="top")}return{x:r,y:o,align:s,textBaseline:l}},i.prototype._computeOuterLabelLimit=function(t){var e,i,n,r,o;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));var a=this.getPoints(t),s=(Math.abs(a[0].x-a[1].x)+Math.abs(a[2].x-a[3].x))/2,l=this.getCategoryField(),u=null===(n=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct().getGroupGraphicItem().find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[l])===t[l]}),!0))||void 0===n?void 0:n.AABBBounds,c=u?u.x2-u.x1:0;return this.getLayoutRect().width/2-Math.max(s/2,c/2)-t0-2*(null!==(o=null===(r=this._spec.outerLabel)||void 0===r?void 0:r.spaceWidth)&&void 0!==o?o:5)},i.prototype._computeOuterLabelLinePosition=function(t){var e,i,n,r,o,a,s,l,u,c,h,d,f,p,v,y=this.getCategoryField(),g=null===(o=null===(r=null===(n=null===(i=null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)||void 0===i?void 0:i.getProduct())||void 0===n?void 0:n.elements)||void 0===r?void 0:r.find((function(e){var i;return(null===(i=e.data[0])||void 0===i?void 0:i[y])===t[y]})))||void 0===o?void 0:o.getBounds(),m=null===(l=null===(s=null===(a=this._labelMark)||void 0===a?void 0:a.getComponent())||void 0===s?void 0:s.getProduct().getGroupGraphicItem().find((function(e){var i,n=e.attribute;return"text"===e.type&&(null===(i=n.data)||void 0===i?void 0:i[y])===t[y]}),!0))||void 0===l?void 0:l.AABBBounds,_=null!==(u=this._spec.outerLabel)&&void 0!==u?u:{};if(this._isHorizontal()){var b=null!==(c=_.spaceWidth)&&void 0!==c?c:5,x=this.getPoints(t),k=(Math.abs(x[0].y-x[1].y)+Math.abs(x[2].y-x[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(p=this._getPolygonCenter(x).y-k/2-b,v=!1!==_.alignLabel?(null==g?void 0:g.y2)+b:p-b,d=this._getPolygonCenter(x).x,p-v<t0&&(v=p-t0),f=d):(p=this._getPolygonCenter(x).y+k/2+b,v=!1!==_.alignLabel?(null==g?void 0:g.y1)-b:p+b,d=this._getPolygonCenter(x).x,v-p<t0&&(v=p+t0),f=d),{x1:d,x2:f,y1:p,y2:v}}var S=this.getPoints(t),A=(Math.abs(S[0].x-S[1].x)+Math.abs(S[2].x-S[3].x))/2,w=(null==m?void 0:m.x2)-(null==m?void 0:m.x1)||0,T=null!==(h=_.spaceWidth)&&void 0!==h?h:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(d=this._getPolygonCenter(S).x+Math.max(w/2,A/2)+T,f=!1!==_.alignLabel?(null==g?void 0:g.x1)-T:d+T,p=this._getPolygonCenter(S).y,f-d<t0&&(f=d+t0),v=p):(d=this._getPolygonCenter(S).x-Math.max(w/2,A/2)-T,f=!1!==_.alignLabel?(null==g?void 0:g.x2)+T:d-T,p=this._getPolygonCenter(S).y,d-f<t0&&(f=d-t0),v=p),{x1:d,x2:f,y1:p,y2:v}},i.prototype._computeMaxSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return cW(null!==(t=this._spec.maxSize)&&void 0!==t?t:"80%",e)},i.prototype._computeMinSize=function(){var t,e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return cW(null!==(t=this._spec.minSize)&&void 0!==t?t:0,e)},i.prototype._isHorizontal=function(){return"left"===this._funnelOrient||"right"===this._funnelOrient},i.prototype._isReverse=function(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._funnelMark]},i.type=t.SeriesTypeEnum.funnel,i.mark=EG,i.transformerConstructor=o0,i}(pX),s0=function(){r0(),Kq(),Pq(),FU.registerSeries(a0.type,a0),FU.registerAnimation("funnel",(function(t,e){return o({appear:"clipIn"===e?void 0:{type:"fadeIn"}},SK)})),FU.registerAnimation("cartesianGroupClip",(function(t){return{appear:{custom:xh,customParameters:function(e,i){return{animationType:"in",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}},disappear:{custom:xh,customParameters:function(e,i){return{animationType:"out",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()}}}}})),wK()},l0=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.type="pyramid3d",e}(i0),u0=function(){FU.registerMark(l0.type,l0),jL(),PL(),gT.registerGraphic(sw.pyramid3d,eg),RK()},c0=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"funnel3d"),t.isTransform&&this._addMarkLabelSpec(t,"transform3d","transformLabel")},e}(o0),h0=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.funnel3d,i._funnelMarkName="funnel3d",i._funnelMarkType="pyramid3d",i._transformMarkName="transform3d",i._transformMarkType="pyramid3d",i.transformerConstructor=c0,i}return r(i,e),i.prototype.initMark=function(){var t,e,n,r,a,s,l,u;if(this._funnelMark=this._createMark(o(o({},i.mark.funnel3d),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel3d,key:this._seriesField,isSeriesMark:!0,support3d:!0}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(o(o({},i.mark.transform3d),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(e=this._theme)||void 0===e?void 0:e.transform3d,key:this._seriesField,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId()})),null===(r=null===(n=this._spec)||void 0===n?void 0:n.outerLabel)||void 0===r?void 0:r.visible){var c=(null!==(a=this._spec.outerLabel)&&void 0!==a?a:{}).line,h=(null!==(l=null===(s=this._theme)||void 0===s?void 0:s.outerLabel)&&void 0!==l?l:{}).line;this._funnelOuterLabelMark.label=this._createMark(i.mark.outerLabel,{themeSpec:null===(u=this._theme)||void 0===u?void 0:u.outerLabel,key:this._seriesField,markSpec:this._spec.outerLabel}),this._funnelOuterLabelMark.line=this._createMark(i.mark.outerLabelLine,{themeSpec:h,key:this._seriesField,markSpec:c,depend:[this._funnelOuterLabelMark.label]})}},i.prototype.initMarkStyle=function(){var i=this;e.prototype.initMarkStyle.call(this);var n=this._funnelMark;n&&this.setMarkStyle(n,{z:function(t){if(i._isHorizontal())return 0;var e=i.getPoints(t),n=Math.max(Math.abs(e[0].x-e[1].x),Math.abs(e[2].x-e[3].x));return(i._computeMaxSize()-n)/2}},"normal",t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(i){var n,r,o,a=this;e.prototype.initLabelMarkStyle.call(this,i),this.setMarkStyle(i,{z:function(t){if(a._isHorizontal())return 0;var e=a.getPoints(t),i=Math.max(Math.abs(e[0].x-e[1].x),Math.abs(e[2].x-e[3].x));return(a._computeMaxSize()-i)/2}},"normal",t.AttributeLevel.Series),this._labelMark=i,(null===(r=this._funnelOuterLabelMark)||void 0===r?void 0:r.label)&&this._funnelOuterLabelMark.label.setDepend(i.getComponent()),(null===(o=this._funnelOuterLabelMark)||void 0===o?void 0:o.line)&&(n=this._funnelOuterLabelMark.line).setDepend.apply(n,h([],c(this._funnelOuterLabelMark.line.getDepend()),!1))},i.type=t.SeriesTypeEnum.funnel3d,i.mark=RG,i.transformerConstructor=c0,i}(a0),d0=function(){u0(),Kq(),Pq(),FU.registerSeries(h0.type,h0)},f0=function(t,e){var i=(t-e[0])/(e[1]-e[0]||1);return Math.max(0,Math.min(1,i))},p0=function(t){var e=t.mark.elements.filter((function(t){return t.diffState===aw.update})),i=ht(e.map((function(t){var e;return null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth})));return e.filter((function(t){var e;return(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth)===i}))},v0=function(t,e,i){if(W(t))return[e,i];var n=ht(t.map((function(t){return 1*t.getGraphicAttribute("startAngle",!1)}))),r=ct(t.map((function(t){return 1*t.getGraphicAttribute("endAngle",!1)})));return[n,r]},y0=function(t){return{channel:{startAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,o=n.endAngle,a=p0(i),s=v0(a,r,o);return f0(e.startAngle,s)*(o-r)+r},to:function(t){return t.startAngle}},endAngle:{from:function(e,i){var n=t.animationInfo(),r=n.startAngle,o=n.endAngle,a=p0(i),s=v0(a,r,o);return f0(e.endAngle,s)*(o-r)+r},to:function(t){return t.endAngle}},outerRadius:{from:function(t){return t.innerRadius},to:function(t){return t.outerRadius}},innerRadius:{from:function(t){return t.innerRadius},to:function(t){return t.innerRadius}}}}},g0=function(t){var e=ht(t.map((function(t){return 1*t.getGraphicAttribute("startAngle",!1)}))),i=ct(t.map((function(t){return 1*t.getGraphicAttribute("endAngle",!1)})));return[e,i]},m0=function(t){return{channel:{startAngle:{from:function(t,e){return e.getGraphicAttribute("startAngle",!1)},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,o=n.endAngle,a=p0(i),s=g0(a);return f0(i.getGraphicAttribute("startAngle",!1),s)*(o-r)+r}},endAngle:{from:function(t,e){return e.getGraphicAttribute("endAngle",!1)},to:function(e,i){var n=t.animationInfo(),r=n.startAngle,o=n.endAngle,a=p0(i),s=g0(a);return f0(i.getGraphicAttribute("endAngle",!1),s)*(o-r)+r}},outerRadius:{from:function(t,e){return e.getGraphicAttribute("outerRadius",!1)},to:function(){return t.animationInfo().innerRadius}},innerRadius:{from:function(t,e){return e.getGraphicAttribute("innerRadius",!1)},to:function(){return t.animationInfo().innerRadius}}}}},_0=function(t,e){switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},b0=function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=(null==n?void 0:n.maxDepth)>=0;return e.forEach((function(e){(!r||e.depth<=n.maxDepth)&&(i.push((null==n?void 0:n.callback)?n.callback(e):e),e.children&&(r&&e.depth===n.maxDepth?(e.children=null,e.isLeaf=!0):t(e.children,i,n)))})),i};function x0(t,e,i,n,r){for(var o,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x0:"x0",x1:"x1",y0:"y0",y1:"y1"},s=t.children,l=-1,u=s.length,c=t.value&&(n-e)/t.value;++l<u;)(o=s[l])[a.y0]=i,o[a.y1]=r,o[a.x0]=e,o[a.x1]=e+=o.value*c}function k0(t,e,i,n,r){for(var o,a=t.children,s=-1,l=a.length,u=t.value&&(r-i)/t.value;++s<l;)(o=a[s]).x0=e,o.x1=n,o.y0=i,i+=o.value*u,o.y1=i}var S0=function(t){return function(e,i,n,r,o){!function(t,e,i,n,r,o){for(var a,s,l,u,c,h,d,f,p,v,y,g=[],m=e.children,_=0,b=0,x=m.length,k=e.value;_<x;){l=r-i,u=o-n;do{c=m[b++].value}while(!c&&b<x);for(h=c,d=c,y=c*c*(v=Math.max(u/l,l/u)/(k*t)),p=Math.max(d/y,y/h);b<x;++b){if((s=m[b].value)<h&&(h=s),s>d&&(d=s),y=(c+=s)*c*v,(f=Math.max(d/y,y/h))>p){c-=s;break}p=f}a=Object.assign({},e,{value:c,children:m.slice(_,b)}),g.push(a),l<u?x0(a,i,n,r,k?n+=u*c/k:o):k0(a,i,n,k?i+=l*c/k:r,o),k-=c,_=b}}(t,e,i,n,r,o)}},A0=function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=0,l=null!=r?r:-1,u=n;return e.forEach((function(e,r){var c,h,d={flattenIndex:++l,key:a?a(e):"".concat(null!==(c=null==o?void 0:o.key)&&void 0!==c?c:"","-").concat(r),maxDepth:-1,depth:n,index:r,value:e.value,isLeaf:!0,datum:o?o.datum.concat(e):[e],parentKey:null==o?void 0:o.key};if(null===(h=e.children)||void 0===h?void 0:h.length){d.children=[],d.isLeaf=!1;var f=t(e.children,d.children,n+1,l,d,a);d.value=w(e.value)?f.sum:Math.max(f.sum,d.value),l=f.flattenIndex,u=Math.max(f.maxDepth,u)}else d.isLeaf=!0,d.value=w(e.value)?0:e.value;s+=Math.abs(d.value),i.push(d)})),{sum:s,maxDepth:u,flattenIndex:l}},w0=function t(e,i,n,r){var o=r;return e.forEach((function(e,r){var a;o=i(e,r,n,o),(null===(a=e.children)||void 0===a?void 0:a.length)&&(o=t(e.children,i,e,o))})),r},T0=function t(e,i,n,r){var o=r;return e.forEach((function(e,r){var a;(null===(a=e.children)||void 0===a?void 0:a.length)&&(o=t(e.children,i,e,o)),o=i(e,r,n,o)})),o},M0={binary:function(t,e,i,n,r){var o=t.children,a=o.length,s=0,l=new Array(a+1);l[0]=0;for(var u=0;u<a;++u)s+=o[u].value,l[u+1]=s;!function t(e,i,n,r,a,s,u){if(e>=i-1){var c=o[e];return c.x0=r,c.y0=a,c.x1=s,void(c.y1=u)}for(var h=l[e],d=n/2+h,f=e+1,p=i-1;f<p;){var v=f+p>>>1;l[v]<d?f=v+1:p=v}d-l[f-1]<l[f]-d&&e+1<f&&--f;var y=l[f]-h,g=n-y;if(s-r>u-a){var m=n?(r*g+s*y)/n:s;t(e,f,y,r,a,m,u),t(f,i,g,m,a,s,u)}else{var _=n?(a*g+u*y)/n:u;t(e,f,y,r,a,s,_),t(f,i,g,r,_,s,u)}}(0,a,t.value,e,i,n,r)},dice:x0,slice:k0,sliceDice:function(t,e,i,n,r){(t.depth%2==1?k0:x0)(t,e,i,n,r)}},C0=function(){function t(e){var i,n=this;jt(this,t),this._filterByArea=function(t,e){var i,r=n._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null===(i=t.children)||void 0===i?void 0:i.length){var o=t.children.filter((function(t){return n._filterByArea(t,e)}));o.length?o.length!==t.children.length&&(t.children=o):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=function(t){var e;return t<0?0:null!==(e=B(n.options.minVisibleArea)?n.options.minVisibleArea[t]:n.options.minVisibleArea)&&void 0!==e?e:0},this._getGapWidthByDepth=function(t){var e;return t<0?0:null!==(e=B(n.options.gapWidth)?n.options.gapWidth[t]:n.options.gapWidth)&&void 0!==e?e:0},this._getPaddingByDepth=function(t){var e;return t<0?0:null!==(e=B(n.options.padding)?n.options.padding[t]:n.options.padding)&&void 0!==e?e:0},this._getLabelPaddingByDepth=function(t){var e;return t<0?0:null!==(e=B(n.options.labelPadding)?n.options.labelPadding[t]:n.options.labelPadding)&&void 0!==e?e:0},this._layoutNode=function(t){var e=n._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,o=t.x1,a=t.y1;if(t.maxDepth=n._maxDepth,e>0&&((i+=e/2)>(o-=e/2)&&(o=i=(i+o)/2),(r+=e/2)>(a-=e/2)&&(a=r=(r+a)/2),t.x0=i,t.x1=o,t.y0=r,t.y1=a),t.children){var s=n._getLabelPaddingByDepth(t.depth),l=n._getPaddingByDepth(t.depth);l>0&&l<Math.min(o-i,a-r)/2&&(r+=l,a-=l,i+=l,o-=l),s>0&&("top"===n.options.labelPosition&&r+s<a?(t.labelRect={x0:i,y0:r,x1:o,y1:r+s},r+=s):"bottom"===n.options.labelPosition&&a-s>r?(t.labelRect={x0:i,y0:a-s,x1:o,y1:a},a-=s):"left"===n.options.labelPosition&&i+s<o?(t.labelRect={x0:i,y0:r,x1:i+s,y1:a},i+=s):"right"===n.options.labelPosition&&o-s>i&&(t.labelRect={x0:o-s,y0:r,x1:o,y1:a},o-=s));var u=n._getGapWidthByDepth(t.depth+1);u>0&&(i-=u/2,o+=u/2,r-=u/2,a+=u/2),n._splitNode(t,i,r,o,a)}},this.options=Object.assign({},t.defaultOpionts,e);var r=this.options.nodeKey,o=A(r)?r:r?rS(r):null;this._getNodeKey=o,this._splitNode="squarify"===this.options.splitType?S0(this.options.aspectRatio):null!==(i=M0[this.options.splitType])&&void 0!==i?i:M0.binary,this._maxDepth=-1}return zt(t,[{key:"layout",value:function(t,e){var i;if(!t||!t.length)return[];var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},r=[],o=A0(t,r,0,-1,null,this._getNodeKey);if(this._maxDepth=o.maxDepth,o.sum<=0)return[];var a={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:o.sum,datum:null,x0:n.x0,x1:n.x1,y0:n.y0,y1:n.y1,children:r},s=n.width*n.height/o.sum;return this._filterByArea(a,s),this._layout(a),null!==(i=a.children)&&void 0!==i?i:[]}},{key:"_filterChildren",value:function(t){var e=this.options.maxDepth;if(I(e)&&e>=0&&t.depth>=e)return!1;var i=this.options.minChildrenVisibleArea;if(I(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;var n=this.options.minChildrenVisibleSize;return!I(n)||!(Math.abs(t.x1-t.x0)<n||Math.abs(t.y1-t.y0)<n)}},{key:"_layout",value:function(t){var e,i=this;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null===(e=t.children)||void 0===e?void 0:e.length)&&t.children.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t):i._layoutNode(t)}))}}]),t}();C0.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};var E0={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"},R0=function(){function t(e){var i=this;jt(this,t),this._layoutNode=function(t){if(t.maxDepth=i._maxDepth,t.children){var e=i._parsedInnerRadius[t.depth+1],n=i._parsedOutterRadius[t.depth+1];x0(t,t.startAngle,Math.min(e,n),t.endAngle,Math.max(e,n),E0);var r=B(i.options.label)?i.options.label[t.depth+1]:i.options.label;t.children.forEach((function(t){if(t.x=i._parsedCenter[0],t.y=i._parsedCenter[1],r)return i._layoutLabel(t,S(r)?{align:"center",rotate:"radial"}:r)}))}},this.options=e?Object.assign({},t.defaultOpionts,e):Object.assign({},t.defaultOpionts);var n=this.options.nodeKey,r=A(n)?n:n?rS(n):null;this._getNodeKey=r,this._maxDepth=-1}return zt(t,[{key:"_parseRadius",value:function(t,e){var i=this,n=t.x0+cS(this.options.center[0],t.width),r=t.y0+cS(this.options.center[1],t.height),o=Math.min(t.width/2,t.height/2),a=this.options.innerRadius,s=this.options.outerRadius,l=B(a),u=l?a.map((function(t){return cS(t,o)})):cS(a,o),c=B(s),h=this.options.gapRadius,d=c?s.map((function(t){return cS(t,o)})):cS(s,o),f=vt(0,e+1);if(l)this._parsedInnerRadius=f.map((function(t,e){var i=u[e];return w(i)?o:i})),this._parsedOutterRadius=f.map((function(t,n){var r;return c?d[n]:n<e?i._parsedInnerRadius[n+1]-(B(h)?null!==(r=h[n])&&void 0!==r?r:0:h):d}));else if(c)this._parsedOutterRadius=f.map((function(t,e){return w(d[e])?o:d[e]})),this._parsedInnerRadius=f.map((function(t,e){var n;return 0===e?u:i._parsedOutterRadius[e-1]-(B(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}));else{var p=cS(a,o),v=(d-p)/(e+1);this._parsedInnerRadius=f.map((function(t,e){return p+e*v})),this._parsedOutterRadius=f.map((function(t,e){var n;return i._parsedInnerRadius[e]+v-(B(h)?null!==(n=h[e])&&void 0!==n?n:0:h)}))}this._parsedCenter=[n,r],this._maxRadius=o}},{key:"layout",value:function(t,e){var i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];var n=[],r=A0(t,n,0,-1,null,this._getNodeKey);return this._parseRadius(i,r.maxDepth),this._maxDepth=r.maxDepth,this._layout(n,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:r.sum,datum:null,children:n,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),n}},{key:"_layout",value:function(t,e){var i=this;this._layoutNode(e),t.forEach((function(t){var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?i._layout(t.children,t):i._layoutNode(t)}))}},{key:"_layoutLabel",value:function(t,e){var i,n=(t.startAngle+t.endAngle)/2,r=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!==(i=e.offset)&&void 0!==i?i:0),o=be({x:this._parsedCenter[0],y:this._parsedCenter[1]},r,n);if(t.label={x:o.x,y:o.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=n-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*r;else{var a=n%(2*Math.PI),s=a<0?a+2*Math.PI:a;s>Math.PI/2&&s<1.5*Math.PI?(t.label.angle=s+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=s,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}]),t}();R0.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};var P0=4294967296;function B0(t,e){var i,n;if(I0(e,t))return[e];for(i=0;i<t.length;++i)if(L0(e,t[i])&&I0(F0(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(n=i+1;n<t.length;++n)if(L0(F0(t[i],t[n]),e)&&L0(F0(t[i],e),t[n])&&L0(F0(t[n],e),t[i])&&I0(z0(t[i],t[n],e),t))return[t[i],t[n],e];gi.getInstance().error("error when packEncloseRandom")}function L0(t,e){var i=t.radius-e.radius,n=e.x-t.x,r=e.y-t.y;return i<0||i*i<n*n+r*r}function O0(t,e){var i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function I0(t,e){for(var i=0;i<e.length;++i)if(!O0(t,e[i]))return!1;return!0}function D0(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,radius:t.radius}}(t[0]);case 2:return F0(t[0],t[1]);case 3:return z0(t[0],t[1],t[2])}}function F0(t,e){var i=t.x,n=t.y,r=t.radius,o=e.x,a=e.y,s=e.radius,l=o-i,u=a-n,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(i+o+l/h*c)/2,y:(n+a+u/h*c)/2,radius:(h+r+s)/2}}function z0(t,e,i){var n=t.x,r=t.y,o=t.radius,a=e.x,s=e.y,l=e.radius,u=i.x,c=i.y,h=i.radius,d=n-a,f=n-u,p=r-s,v=r-c,y=l-o,g=h-o,m=n*n+r*r-o*o,_=m-a*a-s*s+l*l,b=m-u*u-c*c+h*h,x=f*p-d*v,k=(p*b-v*_)/(2*x)-n,S=(v*y-p*g)/x,A=(f*_-d*b)/(2*x)-r,w=(d*g-f*y)/x,T=S*S+w*w-1,M=2*(o+k*S+A*w),C=k*k+A*A-o*o,E=-(Math.abs(T)>1e-6?(M+Math.sqrt(M*M-4*T*C))/(2*T):C/M);return{x:n+k+S*E,y:r+A+w*E,radius:E}}function j0(t,e,i){var n,r,o,a,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.radius+i.radius,r*=r,a=t.radius+i.radius,r>(a*=a)?(n=(u+a-r)/(2*u),o=Math.sqrt(Math.max(0,a/u-n*n)),i.x=t.x-n*s-o*l,i.y=t.y-n*l+o*s):(n=(u+r-a)/(2*u),o=Math.sqrt(Math.max(0,r/u-n*n)),i.x=e.x+n*s-o*l,i.y=e.y+n*l+o*s)):(i.x=e.x+i.radius,i.y=e.y)}function H0(t,e){var i=t.radius+e.radius-1e-6,n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function N0(t){var e=t._,i=t.next._,n=e.radius+i.radius,r=(e.x*i.radius+i.x*e.radius)/n,o=(e.y*i.radius+i.y*e.radius)/n;return r*r+o*o}function V0(t){return{_:t,next:null,prev:null}}function G0(t,e){var i=(t=lt(t)).length;if(!i)return 0;var n=t[0];if(n.x=0,n.y=0,1===i)return n.radius;var r=t[1];if(n.x=-r.radius,r.x=n.radius,r.y=0,2===i)return n.radius+r.radius;var o=t[2];j0(r,n,o);var a,s,l,u,c,h,d,f=V0(n),p=V0(r),v=V0(o);f.next=p,v.prev=p,p.next=v,f.prev=v,v.next=f,p.prev=f;for(var y=3;y<i;++y){d=!1,o=t[y],j0(f._,p._,o),v=V0(o),a=p.next,s=f.prev,l=p._.radius,u=f._.radius;do{if(l<=u){if(H0(a._,v._)){p=a,f.next=p,p.prev=f,--y,d=!0;break}l+=a._.radius,a=a.next}else{if(H0(s._,v._)){(f=s).next=p,p.prev=f,--y,d=!0;break}u+=s._.radius,s=s.prev}}while(a!==s.next);if(!d){for(v.prev=f,v.next=p,f.next=p.prev=p=v,c=N0(f),v=v.next;v!==p;)(h=N0(v))<c&&(f=v,c=h),v=v.next;p=f.next}}var g=[p._];for(v=p.next;v!==p;)g.push(v._),v=v.next;o=function(t,e){for(var i,n,r=0,o=ft(Array.from(t),e),a=o.length,s=[];r<a;)i=o[r],n&&O0(n,i)?++r:(n=D0(s=B0(s,i)),r=0);return n}(g,e);for(var m=0;m<i;++m)(n=t[m]).x-=o.x,n.y-=o.y;return o.radius}function W0(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function U0(t,e,i){return function(n){var r=null==n?void 0:n.children;if(r){var o,a=r.length,s=t(n)*e||0;if(s)for(o=0;o<a;++o)r[o].radius+=s;var l=G0(r,i);if(s)for(o=0;o<a;++o)r[o].radius-=s;n.radius=l+s}}}function Y0(t,e){return function(i,n,r){i.radius*=t,i.maxDepth=e,r&&(i.x=r.x+t*i.x,i.y=r.y+t*i.y)}}var K0=function(){function t(e){jt(this,t),this.options=e;var i=null==e?void 0:e.nodeKey,n=A(i)?i:i?rS(i):null;this._getNodeKey=n,this._getPadding=I(null==e?void 0:e.padding)?function(t){return e.padding}:B(null==e?void 0:e.padding)?function(t){var i;return null!==(i=e.padding[t.depth+1])&&void 0!==i?i:0}:function(){return 0},this._maxDepth=-1}return zt(t,[{key:"layout",value:function(e,i){var n,r="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];var o=[],a=A0(e,o,0,-1,null,this._getNodeKey);this._maxDepth=a.maxDepth;var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(){return(t=(1664525*t+1013904223)%P0)/P0}}(),l={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:a.sum,datum:null,children:o,x:r.x0+r.width/2,y:r.y0+r.height/2},u=null!==(n=this.options)&&void 0!==n?n:{},c=u.nodeSort,h=u.setRadius,d=u.padding,f=u.includeRoot;if(!1!==c){var p=A(c)?this.options.nodeKey:t.defaultOpionts.nodeSort;w0([l],(function(t){t.children&&t.children.length&&t.children.sort(p)}))}if(h)w0([l],W0(h)),T0([l],U0(this._getPadding,.5,s)),w0([l],Y0(1,this._maxDepth));else{var v=Math.min(r.width,r.height);w0([l],W0(t.defaultOpionts.setRadius)),T0([l],U0(aS,1,s)),d&&T0([l],U0(this._getPadding,l.radius/v,s)),w0([l],Y0(v/(2*l.radius),this._maxDepth))}return f?[l]:o}}]),t}();K0.defaultOpionts={setRadius:function(t){return Math.sqrt(t.value)},padding:0,nodeSort:function(t,e){return e.value-t.value}};var X0,Z0=function(t,e){if(void 0===e&&(e={}),!t)return[];var i=[];return b0(t,i,e),i},q0=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return new R0(i).layout(t,{width:n,height:r})},J0=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return r(e,t),e}(YK);!function(t){t.DrillDown="drillDown",t.DrillUp="drillUp"}(X0||(X0={}));var Q0=function(t,e){var i,n=e.info(),r=e.keyField(),o=null==n?void 0:n.key;if(w(o))return t;if(n.type===X0.DrillDown)return lt(i=PU(t,o,r,"children"));if(n.type===X0.DrillUp&&(i=BU(t,o,r,"children")))return lt(i);return t},$0=function(){function e(){}return e.prototype._getDrillTriggerEvent=function(t){var e;return null===(e=yq(this._drillParams.mode))||void 0===e?void 0:e[t]},e.prototype._hideTooltip=function(){var t=this.getChart().getAllComponents().find((function(t){return t.type===f.tooltip}));t&&t.hideTooltip()},e.prototype.initDrillable=function(t){this._drillParams=t},e.prototype.initDrillableData=function(t){var e=this,i=this._drillParams.getRawData;hY(t,"drillFilter",Q0),i().transform({type:"drillFilter",options:{info:function(){return e._drillInfo},keyField:function(){return e._drillParams.drillField()}}})},e.prototype.bindDrillEvent=function(){var t=this,e=this._drillParams,i=e.event,n=e.getRawData,r=(0,e.drillField)();this._getDrillTriggerEvent("start")&&i.on(this._getDrillTriggerEvent("start"),(function(e){var i,o,a;if(w(e.datum)||w(null===(i=e.datum)||void 0===i?void 0:i[r]))t.drillUp();else{t._hideTooltip();var s=e.datum[r],l=null!==(a=null===(o=t._drillInfo)||void 0===o?void 0:o.path)&&void 0!==a?a:[],d=function(t,e,i,n){void 0===i&&(i="key"),void 0===n&&(n="children");var r=[],o=function(t,a){var s,l;try{for(var d=u(t),f=d.next();!f.done;f=d.next()){var p=f.value;if(p[i]===e)return r.push.apply(r,h(h([],c(a),!1),[p[i].toString()],!1)),!0;if(p[n]){var v=o(p[n],h(h([],c(a),!1),[p[i]],!1));if(!0===v)return v}}}catch(t){s={error:t}}finally{try{f&&!f.done&&(l=d.return)&&l.call(d)}finally{if(s)throw s.error}}return!1};return o(t,[]),r}(n().rawData,s,r,"children");l[l.length-1]===d[d.length-1]?t.drillUp():t.drillDown(d)}}))},e.prototype.drillDown=function(e){void 0===e&&(e=[]);var i=this._drillParams,n=i.getRawData,r=i.event;if(!B(e)||W(e))return e;var o=e[e.length-1];return this._drillInfo={key:o,path:e,type:X0.DrillDown},n().reRunAllTransform(),r.emit(t.ChartEvent.drill,{value:{path:e,type:X0.DrillDown},model:this}),e},e.prototype.drillUp=function(){var e,i,n=this._drillParams,r=n.getRawData,o=n.event,a=null!==(i=null===(e=this._drillInfo)||void 0===e?void 0:e.path)&&void 0!==i?i:[];if(!B(a)||W(a))return a;var s=a.pop();return this._drillInfo={key:s,path:a,type:X0.DrillUp},r().reRunAllTransform(),o.emit(t.ChartEvent.drill,{value:{path:a,type:X0.DrillUp},model:this}),a},e}(),t1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sunburst,i}return r(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:$K),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:lV},getRawData:function(){return i.getRawData()}}),this._startAngle=ge(this._spec.startAngle),this._endAngle=ge(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();i&&(this._spec.drill&&this.initDrillableData(this._dataSet),hY(this._dataSet,"sunburstLayout",q0),hY(this._dataSet,"flatten",Z0),i.transform({type:"sunburstLayout",options:function(){var e=t._computeLevel(),i=e.innerRadius,n=e.outerRadius,r=e.gap,o=e.label;return{nodeKey:t._categoryField,width:t.getLayoutRect().width,height:t.getLayoutRect().height,center:[T(t._centerX)?t._centerX:t.getLayoutRect().width/2,T(t._centerY)?t._centerY:t.getLayoutRect().height/2],startAngle:t._startAngle,endAngle:t._endAngle,innerRadius:i,outerRadius:n,gapRadius:r,label:o}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return o(o({},t),e)}return t}}}))},i.prototype.getStatisticFields=function(){return e.prototype.getStatisticFields.call(this).concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:QK,operations:["max","min","values"]},{key:$K,operations:["values"]}])},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();w(null==t?void 0:t.dataSet)||(hY(t.dataSet,"addVChartProperty",GK),t.transform({type:"addVChartProperty",options:{beforeCall:nX.bind(this),call:rX}}))},i.prototype.initMark=function(){this._initArcMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initArcMarkStyle(),this._initLabelMarkStyle()},i.prototype._initArcMark=function(){var t;if(!1!==this._sunburst.visible){var e=this._createMark(i.mark.sunburst,{isSeriesMark:!0,customShape:null===(t=this._spec.sunburst)||void 0===t?void 0:t.customShape});this._sunburstMark=e,this._trigger.registerMark(this._sunburstMark)}},i.prototype._initArcMarkStyle=function(){var e=this;w(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:function(t){return t.x+(T(e._offsetX)?e._offsetX:0)},y:function(t){return t.y+(T(e._offsetY)?e._offsetY:0)},outerRadius:function(t){return t.outerRadius},innerRadius:function(t){return t.innerRadius},startAngle:function(t){return t.startAngle},endAngle:function(t){return t.endAngle},fill:this.getColorAttribute()},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){if(!0===this._label.visible){var t=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=t,this._trigger.registerMark(t)}},i.prototype._initLabelMarkStyle=function(){var e=this;w(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:function(t){var i,n=e._labelAutoVisible;return M(n)&&!0===n.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!==(i=null==n?void 0:n.circumference)&&void 0!==i?i:10):e._spec.label.visible},x:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.x)+(T(e._offsetX)?e._offsetX:0)},y:function(t){var i;return(null===(i=t.label)||void 0===i?void 0:i.y)+(T(e._offsetY)?e._offsetY:0)},textBaseline:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textBaseline},textAlign:function(t){var e;return null===(e=t.label)||void 0===e?void 0:e.textAlign},angle:function(t){var e,i;return null!==(i=null===(e=t.label)||void 0===e?void 0:e.angle)&&void 0!==i?i:0},fontSize:10,text:function(t){return t.name}},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initTooltip=function(){this._tooltipHelper=new J0(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e,i=this,n={animationInfo:function(){return{innerRadius:i._computeRadius(lt(i.__innerRadius))[0],outerRadius:i._computeRadius(lt(i.__outerRadius))[0],startAngle:lt(i._startAngle)[0],endAngle:lt(i._endAngle)[0]}}},r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this.getMarksInType("arc").forEach((function(t){var e;t.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("sunburst"))||void 0===e?void 0:e(n,r),sX(t.name,i._spec,i._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var e;t.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("fadeInOut"))||void 0===e?void 0:e(),sX(t.name,i._spec,i._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._rawData.reRunAllTransform()},i.prototype._computeRadius=function(t){var e=this;if(B(t))return t.map((function(t){var i=e.getRegion().getLayoutRect(),n=i.width,r=i.height;return Math.min(n/2,r/2)*t}));var i=this.getRegion().getLayoutRect(),n=i.width,r=i.height;return Math.min(n/2,r/2)*t},i.prototype._computeLevel=function(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._sunburstMark]},i.type=t.SeriesTypeEnum.sunburst,i.mark=zG,i}(lJ);ot(t1,$0);var e1=function(){FU.registerSeries(t1.type,t1),_J(),Kq(),wK(),FU.registerAnimation("sunburst",(function(t,e){return{appear:_0(0,e),enter:y0(t),exit:m0(t),disappear:m0(t)}}))},i1=function(t,e){if(!t)return t;var i=e(),n=i.width,r=i.height;return 0===n||0===r?t:new K0(i).layout(t,{width:n,height:r})},n1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return r(e,t),e}(YK),r1=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"}},o1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.circlePacking,i}return r(i,e),i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getValueField=function(){return this._valueField},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:$K),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t;return null!==(t=i._spec.drillField)&&void 0!==t?t:lV},getRawData:function(){return i.getRawData()}}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding},i.prototype.initData=function(){var t=this;e.prototype.initData.call(this);var i=this.getRawData();w(i)||(this._spec.drill&&this.initDrillableData(this._dataSet),hY(this._dataSet,"circlePackingLayout",i1),hY(this._dataSet,"flatten",Z0),i.transform({type:"circlePackingLayout",options:function(){return{nodeKey:t._categoryField,padding:t._layoutPadding,includeRoot:!1,width:t.getLayoutRect().width||1,height:t.getLayoutRect().height||1}}}),i.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return o(o({},t),e)}return t}}}))},i.prototype._addDataIndexAndKey=function(){var t=this.getRawData();w(null==t?void 0:t.dataSet)||(hY(t.dataSet,"addVChartProperty",GK),t.transform({type:"addVChartProperty",options:{beforeCall:nX.bind(this),call:rX}}))},i.prototype.initMark=function(){this._initCirclePackingMark(),this._initLabelMark()},i.prototype.initMarkStyle=function(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()},i.prototype._initCirclePackingMark=function(){var t,e;if(!1!==(null===(t=this._circlePacking)||void 0===t?void 0:t.visible)){var n=this._createMark(i.mark.circlePacking,{isSeriesMark:!0,customShape:null===(e=this._spec.circlePacking)||void 0===e?void 0:e.customShape});this._circlePackingMark=n,this._trigger.registerMark(n)}},i.prototype._initCirclePackingMarkStyle=function(){w(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:function(t){return t.x},y:function(t){return t.y},outerRadius:function(t){return t.radius},innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:function(t){return t.depth}},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initLabelMark=function(){var t;if(!1!==(null===(t=this._label)||void 0===t?void 0:t.visible)){var e=this._createMark(i.mark.label,{isSeriesMark:!1});this._labelMark=e,this._trigger.registerMark(e)}},i.prototype._initLabelMarkStyle=function(){w(this._labelMark)||this.setMarkStyle(this._labelMark,{x:function(t){return t.x},y:function(t){return t.y},text:function(t){return t.key},cursor:"pointer"},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.getStatisticFields=function(){return e.prototype.getStatisticFields.call(this).concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:QK,operations:["max","min","values"]},{key:$K,operations:["values"]}])},i.prototype.initTooltip=function(){this._tooltipHelper=new n1(this),this._tooltipHelper.updateTooltipSpec(),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype.initAnimation=function(){var t,e=this,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this.getMarksInType("arc").forEach((function(t){var n;t.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("circlePacking"))||void 0===n?void 0:n(void 0,i),sX(t.name,e._spec,e._markAttributeContext)))})),this.getMarksInType("text").forEach((function(t){var i;t.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("scaleInOut"))||void 0===i?void 0:i(),sX(t.name,e._spec,e._markAttributeContext)))}))},i.prototype.initEvent=function(){e.prototype.initEvent.call(this),this._spec.drill&&this.bindDrillEvent()},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._rawData.reRunAllTransform()},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._circlePackingMark]},i.type=t.SeriesTypeEnum.circlePacking,i.mark=NG,i}(gX);ot(o1,$0);var a1=function(){FU.registerSeries(o1.type,o1),_J(),Kq(),AK(),FU.registerAnimation("circlePacking",(function(t,e){return{appear:r1(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}}))},s1=function t(e){var i=0;return e.forEach((function(e,n){var r;w(e.value)&&((null===(r=e.children)||void 0===r?void 0:r.length)?e.value=t(e.children):e.value=0),i+=Math.abs(e.value)})),i};function l1(t){return t.depth}function u1(t,e){return e-1-t.endDepth}var c1=function(t,e){return t.y0-e.y0},h1=function(t,e){if(w(t.value))return null;var i=(e?t.targetLinks:t.sourceLinks).reduce((function(t,e){return w(e.value)?t.count+=1:t.sum+=e.value,t}),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},d1={left:l1,right:u1,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?ht(t.sourceLinks.map((function(t){return i[t.target].depth})))-1:0},start:l1,end:u1},f1=function(){function t(e){var i=this;jt(this,t),this._ascendingSourceBreadth=function(t,e){return c1(i._nodeMap[t.source],i._nodeMap[e.source])||t.index-e.index},this._ascendingTargetBreadth=function(t,e){return c1(i._nodeMap[t.target],i._nodeMap[e.target])||t.index-e.index},this.options=Object.assign({},t.defaultOptions,e);var n=this.options.nodeKey,r=A(n)?n:n?rS(n):null;this._getNodeKey=r,this._logger=gi.getInstance(),this._alignFunc=A(this.options.setNodeLayer)?function(t){return i.options.setNodeLayer(t.datum)}:d1[this.options.nodeAlign]}return zt(t,[{key:"layout",value:function(t,e){var i=this;if(!t)return null;var n="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};vS(this.options.direction)?this._viewBox={x0:n.y0,x1:n.y1,y0:n.x0,y1:n.x1,width:n.height,height:n.width}:this._viewBox=n;var r=this.computeNodeLinks(t),o=r.nodes,a=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(o),this.computeNodeDepths(o),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(o),this._maxDepth<=1)return null;var s=this.computeNodeBreadths(o);return this.computeLinkBreadths(o),vS(this.options.direction)&&(o.forEach((function(t){var e=t.y0,i=t.y1;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i})),a.forEach((function(t){t.vertical=!0;var e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i}))),a.forEach((function(t){var e=i._nodeMap[t.source],n=i._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:n.x0,x1:n.x1,y1:n.y1,y0:n.y0}})),{nodes:o,links:a,columns:s}}},{key:"computeHierarchicNodeLinks",value:function(t){var e=this,i=[],n=[],r={},o={},a=[];s1(t);return function t(n,o,s){n.forEach((function(n,l){var u,c,h=e._getNodeKey?e._getNodeKey(n):s?"".concat(s[s.length-1].key,"-").concat(l):"".concat(o,"-").concat(l);if(r[h])r[h].value=void 0;else{var d={depth:o,datum:n,index:l,key:h,value:null!==(u=n.value)&&void 0!==u?u:0,sourceLinks:[],targetLinks:[]};r[h]=d,i.push(d)}s&&a.push({source:s[s.length-1].key,target:h,value:null!==(c=n.value)&&void 0!==c?c:0,parents:s}),n.children&&n.children.length&&t(n.children,o+1,s?s.concat([r[h]]):[r[h]])}))}(t,0,null),a.forEach((function(t,e){var i="".concat(t.source,"-").concat(t.target);if(o[i])return o[i].value+=t.value,void o[i].datum.push(t);var a={index:e,key:"".concat(t.source,"-").concat(t.target),source:t.source,target:t.target,datum:[t],value:t.value,parents:t.parents.map((function(t){return t.key}))};n.push(a),r[t.source].sourceLinks.push(a),r[t.target].targetLinks.push(a),o[i]=a})),{nodes:i,links:n,nodeMap:r}}},{key:"computeSourceTargetNodeLinks",value:function(t){var e=this,i=[],n=[],r={};t.nodes&&t.nodes.forEach((function(t,n){var o={depth:-1,datum:t,index:n,key:e._getNodeKey?e._getNodeKey(t):n,value:t.value,sourceLinks:[],targetLinks:[]};r[o.key]=o,i.push(o)}));var o=[];return t.links.forEach((function(a,s){if(!w(a.source)&&!w(a.target)&&(!t.nodes||r[a.source]&&r[a.target])){t.nodes||r[a.source]||(r[a.source]={value:void 0,depth:-1,index:i.length,key:a.source,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[a.source])),t.nodes||r[a.target]||(r[a.target]={value:void 0,depth:-1,index:i.length,key:a.target,datum:null,sourceLinks:[],targetLinks:[]},i.push(r[a.target]));var l={index:s,source:a.source,target:a.target,datum:a,value:a.value};e.options.divideNodeValueToLink&&w(a.value)&&o.push(l),n.push(l),r[a.source].sourceLinks.push(l),r[a.target].targetLinks.push(l)}})),this.options.divideNodeValueToLink&&o.length&&o.forEach((function(t){var e=[h1(r[t.source]),h1(r[t.target],!0)].filter((function(t){return!w(t)}));e.length&&(t.value=ht(e))})),{nodeMap:r,nodes:i,links:n}}},{key:"computeNodeLinks",value:function(t){var e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));var i=e.nodes,n=e.links;if(this.options.linkSortBy)for(var r=0,o=i.length;r<o;r++)i[r].sourceLinks.sort(this.options.linkSortBy),i[r].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter((function(t){return t.targetLinks.length||t.sourceLinks.length}))),{nodes:i,links:n,nodeMap:e.nodeMap}}},{key:"computeNodeValues",value:function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.value=Math.max(w(n.value)?0:n.value,n.sourceLinks.reduce((function(t,e){var i;return t+(null!==(i=e.value)&&void 0!==i?i:0)}),0),n.targetLinks.reduce((function(t,e){var i;return t+(null!==(i=e.value)&&void 0!==i?i:0)}),0))}}},{key:"computeNodeDepths",value:function(t){for(var e,i,n=t.length,r=t,o=0;r.length&&o<n;){e=[],i={};for(var a=0,s=r.length;a<s;a++){var l=r[a];l.depth=o;for(var u=0,c=l.sourceLinks.length;u<c;u++){var h=l.sourceLinks[u];i[h.target]||(e.push(this._nodeMap[h.target]),i[h.target]=!0)}}r=e,o+=1}o>n&&this._logger.warn("Error: there is a circular link"),this._maxDepth=o}},{key:"computeNodeEndDepths",value:function(t){for(var e,i,n=t.length,r=t,o=0;r.length&&o<n;){e=[],i={};for(var a=0,s=r.length;a<s;a++){var l=r[a];l.endDepth=o;for(var u=0,c=l.targetLinks.length;u<c;u++){var h=l.targetLinks[u];i[h.source]||(e.push(this._nodeMap[h.source]),i[h.source]=!0)}}r=e,o+=1}o>n&&this._logger.warn("Error: there is a circular link")}},{key:"computeNodeLayers",value:function(t){var e=this.options.nodeWidth,i=this.options.linkWidth,n=this.options.minStepWidth,r=this._viewBox.width,o=null,a=null,s=!1;if(P(e)){var l=Tt(parseFloat(e.replace("%",""))/100,0,1),u=r/(this._maxDepth-1+l);n>0&&(u=Math.max(n,u)),o=u*l,a=u*(1-l),s=!0}else if(I(e)){if(o=e,I(i))a=i;else if(w(i)){var c=(r-e)/(this._maxDepth-1);n>0&&(c=Math.max(n,c)),a=c-e}s=!0}else A(e)&&I(i)&&(a=i);for(var h=[],d=0,f=t.length;d<f;d++){var p=t[d];p.layer=this._isHierarchic?p.depth:Tt(Math.floor(this._alignFunc(p,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);var v=p.layer;v===this._maxDepth-1&&(p.isLastLayer=!0),s&&(p.x0=this._viewBox.x0+v*(o+a),p.x1=p.x0+o),h[v]?h[v].push(p):h[v]=[p]}if(this.options.nodeSortBy)for(var y=0,g=h.length;y<g;y++)h[y].sort(this.options.nodeSortBy);if(!s&&A(e))for(var m=this._viewBox.x0,_=0;_<this._maxDepth;_++){for(var b=h[_],x=0,k=0,S=b.length;k<S;k++){var T=b[k],M=e(T);T.x0=m,T.x1=m+M,x=Math.max(o,M);for(var C=T.sourceLinks,E=0,R=C.length;E<R;E++){var B=C[E];A(i)&&i(B)}}m+=x}return h}},{key:"initializeNodeBreadths",value:function(t){var e=this,i=this.options.minLinkHeight,n=this.options.minNodeHeight;(w(n)||n<i)&&(n=i);var r=0,o=null;if(A(this.options.nodeGap))o=this.options.nodeGap,r=t.reduce((function(t,i){var n=i.reduce((function(t,e){return t+e.value}),0),r=i.reduce((function(t,i){return t+e.options.nodeGap(i)}),0);return Math.min(t,(e._viewBox.height-r)/n)}),1/0);else{var a=t.reduce((function(t,e){return Math.max(t,e.length)}),0),s=Math.min(n>0?Math.max(this.options.nodeGap,n):this.options.nodeGap,this._viewBox.height/a);o=function(){return s},this._gapY=s,r=t.reduce((function(t,i){var n=i.reduce((function(t,e){return t+e.value}),0);return Math.min(t,(e._viewBox.height-(i.length-1)*s)/n)}),1/0)}for(var l="start"===this.options.gapPosition,u=!l&&"end"!==this.options.gapPosition,c=0,h=t.length;c<h;c++){for(var d=t[c],f=this._viewBox.y0,p=0,v=0,y=d.length;v<y;v++){var g=d[v];p=o(g),l&&(f+=p),g.y0=f,g.y1=f+(n>0&&0!==g.value?Math.max(g.value*r,n):g.value*r),f=l?g.y1:g.y1+p;for(var m=0,_=g.sourceLinks.length;m<_;m++){var b=g.sourceLinks[m];b.thickness=i>0&&0!==b.value?Math.max(b.value*r,i):b.value*r}}var x=this._viewBox.y1-f+(u?p:0);if(x>0)if("start"===this.options.crossNodeAlign);else if("end"===this.options.crossNodeAlign)for(var k=0,S=d.length;k<S;++k){var T=d[k];T.y0+=x,T.y1+=x}else{x/=d.length+1;for(var M=0,C=d.length;M<C;++M){var E=d[M];E.y0+=x*(M+1),E.y1+=x*(M+1)}}else if(x<0&&d.length>1&&p+(x/=d.length-1)>0){p+=x;for(var R=1,P=d.length;R<P;++R){var B=d[R];B.y0+=x*R,B.y1+=x*R}}this.reorderLinks(d)}}},{key:"computeNodeBreadths",value:function(t){var e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);var i=this.options.iterations;if(!this._isHierarchic&&!A(this.options.setNodeLayer)&&!A(this.options.nodeGap))for(var n=0;n<i;++n){var r=Math.pow(.99,n),o=Math.max(1-r,(n+1)/i);this.relaxRightToLeft(e,r,o),this.relaxLeftToRight(e,r,o)}return e}},{key:"relaxLeftToRight",value:function(t,e,i){for(var n=1,r=t.length;n<r;++n){for(var o=t[n],a=0,s=o.length;a<s;a++){for(var l=o[a],u=0,c=0,h=0,d=l.targetLinks.length;h<d;h++){var f=l.targetLinks[h],p=f.value*(l.layer-this._nodeMap[f.source].layer);u+=this.targetTop(this._nodeMap[f.source],l)*p,c+=p}if(c>0){var v=(u/c-l.y0)*e;l.y0+=v,l.y1+=v,this.reorderNodeLinks(l)}}w(this.options.nodeSortBy)&&o.sort(c1),this.resolveCollisions(o,i)}}},{key:"relaxRightToLeft",value:function(t,e,i){for(var n=t.length-2;n>=0;--n){for(var r=t[n],o=0,a=r.length;o<a;o++){for(var s=r[o],l=0,u=0,c=0,h=s.sourceLinks.length;c<h;c++){var d=s.sourceLinks[c],f=d.value*(this._nodeMap[d.target].layer-s.layer);l+=this.sourceTop(s,this._nodeMap[d.target])*f,u+=f}if(u>0){var p=(l/u-s.y0)*e;s.y0+=p,s.y1+=p,this.reorderNodeLinks(s)}}void 0===this.options.nodeSortBy&&r.sort(c1),this.resolveCollisions(r,i)}}},{key:"resolveCollisions",value:function(t,e){var i=t.length>>1,n=t[i];this.resolveCollisionsBottomToTop(t,n.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,n.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}},{key:"resolveCollisionsTopToBottom",value:function(t,e,i,n){for(;i<t.length;++i){var r=t[i],o=(e-r.y0)*n;o>1e-6&&(r.y0+=o,r.y1+=o),e=r.y1+this._gapY}}},{key:"resolveCollisionsBottomToTop",value:function(t,e,i,n){for(;i>=0;--i){var r=t[i],o=(r.y1-e)*n;o>1e-6&&(r.y0-=o,r.y1-=o),e=r.y0-this._gapY}}},{key:"targetTop",value:function(t,e){var i,n,r,o=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)o+=r.thickness+this._gapY;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)o-=r.thickness;return o}},{key:"sourceTop",value:function(t,e){var i,n,r,o=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,n=e.targetLinks.length;i<n&&(r=e.targetLinks[i]).source!==t.key;i++)o+=r.thickness+this._gapY;for(i=0,n=t.sourceLinks.length;i<n&&(r=t.sourceLinks[i]).target!==e.key;i++)o-=r.thickness;return o}},{key:"computeLinkBreadths",value:function(t){for(var e=0,i=t.length;e<i;e++){for(var n=t[e],r=n.y0,o=r,a=0,s=n.sourceLinks.length;a<s;a++){var l=n.sourceLinks[a];l.y0=r+l.thickness/2,l.x0=n.x1,r+=l.thickness}for(var u=0,c=n.targetLinks.length;u<c;u++){var h=n.targetLinks[u];h.y1=o+h.thickness/2,h.x1=n.x0,o+=h.thickness}}}},{key:"reorderNodeLinks",value:function(t){if(w(this.options.linkSortBy)){for(var e=t.targetLinks,i=t.sourceLinks,n=0,r=e.length;n<r;n++){var o=e[n];this._nodeMap[o.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(var a=0,s=i.length;a<s;a++){var l=i[a];this._nodeMap[l.target].targetLinks.sort(this._ascendingSourceBreadth)}}}},{key:"reorderLinks",value:function(t){if(w(this.options.linkSortBy))for(var e=0,i=t.length;e<i;e++){var n=t[e];n.sourceLinks.sort(this._ascendingTargetBreadth),n.targetLinks.sort(this._ascendingSourceBreadth)}}}]),t}();f1.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};var p1=function(t,e){var i=new f1(t).layout(Array.isArray(e)?e[0]:e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});return i?[i]:[]},v1=function(t,e,i){e.forEach((function(e){w(e[i])||t.add(e[i]),e.children&&e.children.length>0&&v1(t,e.children,i)}))},y1=function(t){t.forEach((function(t){t.value=P(t.value)?+t.value:t.value,t.children&&t.children.length>0&&y1(t.children)}))},g1=function(t){var e;if(!t||!B(t))return[];if(t.length>1){var i={links:[],nodes:[]};return t.forEach((function(t){"links"!==t.id&&"nodes"!==t.id||(i[t.id]=t.values)})),[i]}return(null===(e=t[0])||void 0===e?void 0:e.latestData)?t[0].latestData:t},m1=function(t,e){var i,n;if(!t||!(null==e?void 0:e.view)||!t.length)return[];var r=e.view();if(r.x1-r.x0==0||r.y1-r.y0==0||r.x1-r.x0==-1/0||r.x1-r.x0==1/0||r.y1-r.y0==-1/0||r.y1-r.y0==1/0)return[];var o=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&o.links){var a=[];o.links.forEach((function(t){var i={};for(var n in t)n===e.sourceField?i.source=t[e.sourceField]:n===e.targetField?i.target=t[e.targetField]:n===e.valueField?i.value=t[e.valueField]:i[n]=t[n];a.push(i)})),o.links=a}if(o.links){var s=[];o.links.forEach((function(t){var e={};for(var i in t)"value"===i?e.value=P(t.value)?+t.value:t.value:e[i]=t[i];s.push(e)})),o.links=s}else(null===(n=null===(i=o.nodes)||void 0===i?void 0:i[0])||void 0===n?void 0:n.children)&&y1(o.nodes);var l=new f1(e),u=[];return u.push(l.layout(o,r)),u},_1=function(t){var e,i;return t&&B(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].nodes)&&void 0!==i?i:[]},b1=function(t){var e,i;return t&&B(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].links)&&void 0!==i?i:[]},x1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(t,e){var i=this;if("mark"===t)return{visible:!0,activeType:t,title:{key:void 0,value:function(t){if(t.source){if(I(t.source)){var e=i.series.getSeriesKeys();return e[t.source]+" => "+e[t.target]}return t.source+" => "+t.target}return t.datum[i.series.getSpec().categoryField]},hasShape:!1},content:[{key:this.contentKeyCallback,value:function(t){return t.value},hasShape:!0,shapeType:this.contentShapeTypeCallback,shapeColor:this.contentShapeColorCallback,shapeStroke:this.contentShapeColorCallback,shapeHollow:!1}]};if("dimension"===t&&e){var n={key:void 0,value:this._getDimensionData,hasShape:!1},r=[];return e.forEach((function(t){return t.data.forEach((function(t){var e=t.series;r.push({seriesId:e.id,key:i.contentKeyCallback,value:i.contentValueCallback,hasShape:!0,shapeType:i.contentShapeTypeCallback,shapeColor:i.contentShapeColorCallback,shapeStroke:i.contentShapeColorCallback,shapeHollow:!1})}))})),{visible:!0,activeType:t,title:n,content:r}}return null},e}(YK),k1=function(t,e){return void 0===e&&(e=!0),{type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}},S1=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:k1(t)},A1=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"}},w1=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId(),n=this.getStyle("direction");this._product=e.glyph("linkPath",null!=t?t:e.rootMark).id(i).configureGlyph({direction:n}),this._compiledProductId=i},e.type="linkPath",e}(vK),T1=function(){gT.registerGlyph("linkPath",{back:"path",front:"path"}).registerFunctionEncoder(vH).registerChannelEncoder("backgroundStyle",(function(t,e){return{back:e}})).registerDefaultEncoder((function(){return{back:{zIndex:0},front:{zIndex:1}}})),gT.registerAnimationType("linkPathGrowIn",yH),gT.registerAnimationType("linkPathGrowOut",gH),gT.registerAnimationType("linkPathUpdate",mH),iH(),Jj(),FU.registerMark(w1.type,w1)},M1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.sankey,i._nodeLayoutZIndex=t.LayoutZIndex.Node,i._labelLayoutZIndex=t.LayoutZIndex.Label,i._viewBox=new ve,i._handleAdjacencyClick=function(t){var e=t.item;e&&e.mark.id().includes("node")?i._handleNodeAdjacencyClick(e):e&&e.mark.id().includes("link")?i._handleLinkAdjacencyClick(e):i._handleClearEmpty()},i._handleRelatedClick=function(t){var e=t.item;e&&e.mark.id().includes("node")?i._handleNodeRelatedClick(e):e&&e.mark.id().includes("link")?i._handleLinkRelatedClick(e):i._handleClearEmpty()},i._handleClearEmpty=function(){var t=i._nodeMark.getProduct();if(t&&t.elements&&t.elements.length){var e=t.elements,n=i._linkMark.getProduct();if(n&&n.elements&&n.elements.length){var r=n.elements,o=i._labelMark.getProduct();if(o&&o.elements&&o.elements.length){var a=o.elements;e.forEach((function(t){t.clearStates()})),r.forEach((function(t){t.clearStates()})),a.forEach((function(t){t.clearStates()}))}}}},i._handleNodeAdjacencyClick=function(t){var e=t.getDatum(),n=[e.key];if(i._linkMark){if(!(r=i._linkMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(t,i){t.clearStates();var r=t.getDatum(),o=(null==r?void 0:r.parents)?"parents":"source";if(lt(r[o]).includes(e.key)){n.includes(r.source)||n.push(r.source),n.includes(r.target)||n.push(r.target);var a=void 0;if("parents"===o){var s=r.datum,l=s?s.filter((function(t){return t.parents.some((function(t){return t.key===e.key}))})).reduce((function(t,e){return t+e.value}),0):0;a=l/r.value}t.addState("selected",{ratio:a})}else r.target===e.key?n.includes(r.source)||n.push(r.source):t.useStates(["blur"])}))}if(i._nodeMark){if(!(r=i._nodeMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(t){t.clearStates(),n.includes(t.getDatum().key)||t.useStates(["blur"])}))}if(i._labelMark){var r;if(!(r=i._labelMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(t){t.clearStates(),n.includes(t.getDatum().key)||t.useStates(["blur"])}))}},i._handleLinkAdjacencyClick=function(t){var e=t.getDatum(),n=[e.source,e.target];if(i._linkMark){if(!(r=i._linkMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(e){e.clearStates(),e===t?e.addState("selected",{ratio:1}):e.useStates(["blur"])}))}if(i._nodeMark){if(!(r=i._nodeMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(t){t.clearStates(),n.includes(t.getDatum().key)||t.useStates(["blur"])}))}if(i._labelMark){var r;if(!(r=i._labelMark.getProduct())||!r.elements||!r.elements.length)return;r.elements.forEach((function(t){t.clearStates(),n.includes(t.getDatum().key)||t.useStates(["blur"])}))}},i._handleNodeRelatedClick=function(t){var e,n=t.getDatum(),r=i._nodeMark.getProduct();if(r&&r.elements&&r.elements.length){var o=r.elements,a=i._linkMark.getProduct();if(a&&a.elements&&a.elements.length){var s=a.elements;if("source"===((null===(e=s[0].getDatum())||void 0===e?void 0:e.parents)?"parents":"source")){var l=[n.key],u=[];if(s.forEach((function(t,e){var i,r,a,s;t.clearStates();var c=t.getDatum(),h=(null==c?void 0:c.parents)?"parents":"source";if(lt(c[h]).includes(n.key)){if(u.includes(null!==(i=c.key)&&void 0!==i?i:c.index)||u.push(null!==(r=c.key)&&void 0!==r?r:c.index),l.includes(c.source)||l.push(c.source),!l.includes(c.target)){l.push(c.target);for(var d=o.find((function(t){return t.data[0].key===c.target})).data[0].sourceLinks,f=function(){var t=[];return d.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.target))){l.push(e.target);var r=o.find((function(t){return t.data[0].key===e.target}));t.push(r.data[0].targetLinks)}})),d=t,{value:void 0}};(null==d?void 0:d.length)>0;){var p=f();if("object"==typeof p)return p.value}}}else if(c.target===n.key&&(u.includes(null!==(a=c.key)&&void 0!==a?a:c.index)||u.push(null!==(s=c.key)&&void 0!==s?s:c.index),!l.includes(c.source))){l.push(c.source);for(var v=o.find((function(t){return t.data[0].key===c.source})).data[0].targetLinks,y=function(){var t=[];return v.forEach((function(e){var i,n;if(!u.includes(null!==(i=e.key)&&void 0!==i?i:e.index)&&(u.push(null!==(n=e.key)&&void 0!==n?n:e.index),!l.includes(e.source))){l.push(e.source);var r=o.find((function(t){return t.data[0].key===e.source}));t.push(r.data[0].targetLinks)}})),v=t,{value:void 0}};(null==v?void 0:v.length)>0;){var g=y();if("object"==typeof g)return g.value}}})),i._linkMark){if(!(d=i._linkMark.getProduct())||!d.elements||!d.elements.length)return;d.elements.forEach((function(t,e){var i;t.clearStates(),u.includes(null!==(i=t.getDatum().key)&&void 0!==i?i:t.getDatum().index)?t.useStates(["selected"]):t.useStates(["blur"])}))}if(i._nodeMark){if(!(d=i._nodeMark.getProduct())||!d.elements||!d.elements.length)return;d.elements.forEach((function(t){t.clearStates(),l.includes(t.getDatum().key)||t.useStates(["blur"])}))}if(i._labelMark){if(!(d=i._labelMark.getProduct())||!d.elements||!d.elements.length)return;d.elements.forEach((function(t){t.clearStates(),l.includes(t.getDatum().key)||t.useStates(["blur"])}))}}else{var c=[n.key],h=n.targetLinks.reduce((function(t,e){return lt(e.datum).forEach((function(e){for(var i=e.parents,r=i.length,o=function(r){var o=i[r].key,a=i[r+1]?i[r+1].key:n.key,s=e.value,l=t.find((function(t){return t.source===o&&t.target===a}));l?l.value+=s:t.push({source:o,target:a,value:s})},a=0;a<r;a++)o(a)})),t}),[]);if(s.forEach((function(t,e){t.clearStates();var i=t.getDatum(),r=(null==i?void 0:i.parents)?"parents":"source",o=i.datum,a=o?o.filter((function(t){return t[r].some((function(t){return t.key===n.key}))})):null,s=h.find((function(t){return t.source===i.source&&t.target===i.target}));if(a&&a.length){c.includes(i.source)||c.push(i.source),c.includes(i.target)||c.push(i.target);var l=a.reduce((function(t,e){return t+e.value}),0),u=l/i.value;return t.useStates(["selected"]),void t.addState("selected",{ratio:u})}if(s)return c.includes(i.source)||c.push(i.source),c.includes(i.target)||c.push(i.target),t.useStates(["selected"]),void t.addState("selected",{ratio:s.value/i.value});t.useStates(["blur"])})),i._nodeMark){if(!(d=i._nodeMark.getProduct())||!d.elements||!d.elements.length)return;d.elements.forEach((function(t){t.clearStates(),c.includes(t.getDatum().key)||t.useStates(["blur"])}))}if(i._labelMark){var d;if(!(d=i._labelMark.getProduct())||!d.elements||!d.elements.length)return;d.elements.forEach((function(t){t.clearStates(),c.includes(t.getDatum().key)||t.useStates(["blur"])}))}}}}},i._handleLinkRelatedClick=function(t){var e,n=i._nodeMark.getProduct();if(n&&n.elements&&n.elements.length){var r=n.elements,o=i._linkMark.getProduct();if(o&&o.elements&&o.elements.length){var a=o.elements;if("source"===((null===(e=t.getDatum())||void 0===e?void 0:e.parents)?"parents":"source")){if(i._linkMark){if(!(c=i._linkMark.getProduct())||!c.elements||!c.elements.length)return;c.elements.forEach((function(t){t.clearStates()}))}if(i._nodeMark){if(!(c=i._nodeMark.getProduct())||!c.elements||!c.elements.length)return;c.elements.forEach((function(t){t.clearStates()}))}if(i._labelMark){if(!(c=i._labelMark.getProduct())||!c.elements||!c.elements.length)return;c.elements.forEach((function(t){t.clearStates()}))}}else{var s=t.getDatum(),l=[s.source,s.target],u=[];if(lt(s.datum).forEach((function(t){for(var e=t.parents,i=e.length,n=function(i){var n=e[i].key,r=e[i+1].key,o=t.value,a=u.find((function(t){return t.source===n&&t.target===r}));u.push({source:e[i].key,target:e[i+1].key,value:t.value}),a?a.value+=o:u.push({source:n,target:r,value:o})},r=0;r<i-1;r++)n(r)})),a.forEach((function(t){t.clearStates();var e=t.getDatum(),i=e.datum;if(e.source===s.source&&e.target===s.target)return t.useStates(["selected"]),void t.addState("selected",{ratio:1});var n=i?i.filter((function(t){var e=t.parents.map((function(t){return t.key}));return e.includes(s.source)&&e.includes(s.target)})):null;if(n&&n.length){l.includes(e.source)||l.push(e.source),l.includes(e.target)||l.push(e.target);var r=n.filter((function(t){return t.parents.some((function(e,i){var n;return e.key===s.source&&(null===(n=t.parents[i+1])||void 0===n?void 0:n.key)===s.target}))})).reduce((function(t,e){return t+e.value}),0),o=r/e.value;return t.useStates(["selected"]),void t.addState("selected",{ratio:o})}var a=u.find((function(t){return t.source===e.source&&t.target===e.target}));if(a)return l.includes(e.source)||l.push(e.source),l.includes(e.target)||l.push(e.target),t.useStates(["selected"]),void t.addState("selected",{ratio:a.value/e.value});t.useStates(["blur"])})),r.forEach((function(t){t.clearStates(),l.includes(t.getDatum().key)||t.useStates(["blur"])})),i._labelMark){var c;if(!(c=i._labelMark.getProduct())||!c.elements||!c.elements.length)return;c.elements.forEach((function(t){t.clearStates(),l.includes(t.getDatum().key)||t.useStates(["blur"])}))}}}}},i}return r(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i,n;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:this._spec.categoryField),this._labelLimit=null!==(n=null===(i=this._spec.label)||void 0===i?void 0:i.limit)&&void 0!==n?n:100},i.prototype.initData=function(){var t,i,n,r,a=this;e.prototype.initData.call(this);var s=this.getViewData(),l=this.getRawData();if(l&&s){hY(this._dataSet,"sankeyLayout",m1),hY(this._dataSet,"sankeyFormat",g1),l.transform({type:"sankeyFormat"},!1),s.transform({type:"sankeyLayout",options:{view:function(){return{x0:a._viewBox.x1,x1:a._viewBox.x2,y0:a._viewBox.y1,y1:a._viewBox.y2}},sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this._spec.direction,nodeAlign:null!==(t=this._spec.nodeAlign)&&void 0!==t?t:"justify",nodeGap:null!==(i=this._spec.nodeGap)&&void 0!==i?i:8,nodeWidth:null!==(n=this._spec.nodeWidth)&&void 0!==n?n:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!==(r=this._spec.minNodeHeight)&&void 0!==r?r:4,minLinkHeight:this._spec.minLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer},level:mY.sankeyLayout});var u=this._option.dataSet;hY(u,"sankeyNodes",_1),hY(u,"flatten",Z0);var c=new Ma(u,{name:"sankey-node-".concat(this.id,"-data")});c.parse([this.getViewData()],{type:"dataview"}),c.transform({type:"sankeyNodes"}),c.transform({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return o(o({},t),e)}return t}}},!1),c.transform({type:"addVChartProperty",options:{beforeCall:eX.bind(this),call:iX}},!1),this._nodesSeriesData=new JK(this._option,c),hY(u,"sankeyLinks",b1);var h=new Ma(u,{name:"sankey-link-".concat(this.id,"-data")});h.parse([this.getViewData()],{type:"dataview"}),h.transform({type:"sankeyLinks"}),h.transform({type:"addVChartProperty",options:{beforeCall:eX.bind(this),call:iX}},!1),this._linksSeriesData=new JK(this._option,h)}},i.prototype.initMark=function(){var t,e,n,r=this._createMark(i.mark.node,{isSeriesMark:!0,key:sV,dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId(),customShape:null===(t=this._spec.node)||void 0===t?void 0:t.customShape});r&&(r.setZIndex(this._nodeLayoutZIndex),this._nodeMark=r);var o=this._createMark(i.mark.link,{key:sV,dataView:this._linksSeriesData.getDataView(),dataProductId:this._linksSeriesData.getProductId(),customShape:null===(e=this._spec.link)||void 0===e?void 0:e.customShape});if(o&&(this._linkMark=o),null===(n=this._spec.label)||void 0===n?void 0:n.visible){var a=this._createMark(i.mark.label,{key:sV,dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId()});a&&(this._labelMark=a)}},i.prototype.initMarkStyle=function(){this._initNodeMarkStyle(),this._initLinkMarkStyle(),this._initLabelMarkStyle()},i.prototype._initNodeMarkStyle=function(){var e=this,i=this._nodeMark;i&&(this.setMarkStyle(i,{x:function(t){return t.x0},x1:function(t){return t.x1},y:function(t){return t.y0},y1:function(t){return t.y1},fill:function(t){var i,n,r,o;return null!==(r=null===(n=null===(i=e._spec.node)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fill)&&void 0!==r?r:null===(o=e._colorScale)||void 0===o?void 0:o.scale(e._getNodeNameFromData(t))}},MY.STATE_NORMAL,t.AttributeLevel.Mark),this._trigger.registerMark(i))},i.prototype._initLinkMarkStyle=function(){var e,i=this,n=this._linkMark;n&&(this.setMarkStyle(n,{x0:function(t){return t.x0},x1:function(t){return t.x1},y0:function(t){return t.y0},y1:function(t){return t.y1},thickness:function(t){return t.thickness},fill:function(t){var e,n,r,o,a,s,l=null===(n=null===(e=i._spec.link)||void 0===e?void 0:e.style)||void 0===n?void 0:n.fill;if(l)return l;var u=i._spec.nodeKey||(null===(a=null===(o=null===(r=i._rawData.latestData[0])||void 0===r?void 0:r.nodes)||void 0===o?void 0:o[0])||void 0===a?void 0:a.children)?t.source:i.getNodeList()[t.source];return null===(s=i._colorScale)||void 0===s?void 0:s.scale(u)},direction:null!==(e=this._spec.direction)&&void 0!==e?e:"horizontal"},MY.STATE_NORMAL,t.AttributeLevel.Series),this._trigger.registerMark(n))},i.prototype._initLabelMarkStyle=function(){var e=this;this._labelMark&&("vertical"===this._spec.direction?"inside-start"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x0},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"left",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"inside-middle"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"center",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"inside-end"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x1},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"right",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):this.setMarkStyle(this._labelMark,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return t.y1>=e._viewBox.y2?t.y0:t.y1},fill:function(t){var i,n,r,o;return null!==(r=null===(n=null===(i=e._spec.node)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fill)&&void 0!==r?r:null===(o=e._colorScale)||void 0===o?void 0:o.scale(e._getNodeNameFromData(t))},text:function(t){return e._createText(t)},limit:this._labelLimit,textAlign:"center",textBaseline:function(t){return t.y1>=e._viewBox.y2?"bottom":"top"}},MY.STATE_NORMAL,t.AttributeLevel.Series):"inside-start"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x0},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"left",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"inside-middle"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"center",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"inside-end"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x1},y:function(t){return(t.y0+t.y1)/2},fill:"#ffffff",text:function(t){return e._createText(t)},limit:function(t){var i;return null!==(i=e._spec.label.limit)&&void 0!==i?i:t.x1-t.x0},textAlign:"right",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"left"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x0},y:function(t){return(t.y0+t.y1)/2},fill:function(t){var i,n,r,o;return null!==(r=null===(n=null===(i=e._spec.node)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fill)&&void 0!==r?r:null===(o=e._colorScale)||void 0===o?void 0:o.scale(e._getNodeNameFromData(t))},text:function(t){return e._createText(t)},limit:this._labelLimit,textAlign:"right",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):"right"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:function(t){return t.x1},y:function(t){return(t.y0+t.y1)/2},fill:function(t){var i,n,r,o;return null!==(r=null===(n=null===(i=e._spec.node)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fill)&&void 0!==r?r:null===(o=e._colorScale)||void 0===o?void 0:o.scale(e._getNodeNameFromData(t))},text:function(t){return e._createText(t)},limit:this._labelLimit,textAlign:"left",textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series):this.setMarkStyle(this._labelMark,{x:function(t){return t.x1>=e._viewBox.x2?t.x0:t.x1},y:function(t){return(t.y0+t.y1)/2},fill:function(t){var i,n,r,o;return null!==(r=null===(n=null===(i=e._spec.node)||void 0===i?void 0:i.style)||void 0===n?void 0:n.fill)&&void 0!==r?r:null===(o=e._colorScale)||void 0===o?void 0:o.scale(e._getNodeNameFromData(t))},text:function(t){return e._createText(t)},limit:this._labelLimit,textAlign:function(t){return t.x1>=e._viewBox.x2?"right":"left"},textBaseline:"middle"},MY.STATE_NORMAL,t.AttributeLevel.Series),this._labelMark.setZIndex(this._labelLayoutZIndex),this._trigger.registerMark(this._labelMark))},i.prototype._createText=function(t){var e;if(w(t)||w(t.datum))return"";var i=t.datum[this._spec.categoryField]||"";return(null===(e=this._spec.label)||void 0===e?void 0:e.formatMethod)&&(i=this._spec.label.formatMethod(i,t.datum)),i},i.prototype.initAnimation=function(){var t,e,i,n,r,o=this,a={direction:this.direction,growFrom:function(){var t,e;return"horizontal"===o.direction?null===(t=o._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=o._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},s=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("sankeyNode"))||void 0===i?void 0:i(a,s),sX("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(aX(null===(n=FU.getAnimationInKey("sankeyLinkPath"))||void 0===n?void 0:n(a,s),sX("link",this._spec,this._markAttributeContext))),this._labelMark&&this._labelMark.setAnimationConfig(aX(null===(r=FU.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),sX("label",this._spec,this._markAttributeContext)))},i.prototype.initEvent=function(){var i,n,r;e.prototype.initEvent.call(this),null===(i=this._nodesSeriesData.getDataView())||void 0===i||i.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null===(n=this._linksSeriesData.getDataView())||void 0===n||n.target.addListener("change",this.linksSeriesDataUpdate.bind(this));var o=null!==(r=this._spec.emphasis)&&void 0!==r?r:{};!0!==this._option.disableTriggerEvent&&(o.enable&&"adjacency"===o.effect&&("hover"===o.trigger?this.event.on("pointerover",{level:t.Event_Bubble_Level.chart},this._handleAdjacencyClick):this.event.on("pointerdown",{level:t.Event_Bubble_Level.chart},this._handleAdjacencyClick)),o.enable&&"related"===o.effect&&("hover"===o.trigger?this.event.on("pointerover",{level:t.Event_Bubble_Level.chart},this._handleRelatedClick):this.event.on("pointerdown",{level:t.Event_Bubble_Level.chart},this._handleRelatedClick)))},i.prototype.nodesSeriesDataUpdate=function(){this._nodesSeriesData.updateData(),this._setNodeOrdinalColorScale()},i.prototype.linksSeriesDataUpdate=function(){this._linksSeriesData.updateData()},i.prototype.initTooltip=function(){this._tooltipHelper=new x1(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)},i.prototype._setNodeOrdinalColorScale=function(){var t,e,i,n,r,o=null===(e=null===(t=this._option)||void 0===t?void 0:t.globalScale)||void 0===e?void 0:e.getScale("color");if(null==o?void 0:o._specified)this._colorScale=o;else{var a,s;o&&(a=o.domain(),s=o.range()),s||(s=this._getDataScheme()),a&&!w(a[0])||(a=this.getNodeList()).length>10&&(s=null===(i=this._getDataScheme()[1])||void 0===i?void 0:i.scheme);var l=new nW;null===(r=(n=l.domain(a)).range)||void 0===r||r.call(n,s),this._colorScale=l}},i.prototype.getNodeList=function(){var t,e,i,n=this;return(null===(t=this._rawData.latestData[0])||void 0===t?void 0:t.nodes)?(null===(e=this._rawData.latestData[0].nodes[0])||void 0===e?void 0:e.children)?Array.from(this.extractNamesFromTree(this._rawData.latestData[0].nodes,this._spec.categoryField)):this._rawData.latestData[0].nodes.map((function(t,e){return t[n._spec.categoryField]})):null===(i=this._rawData.latestData[0])||void 0===i?void 0:i.values.map((function(t,e){return t[n._spec.categoryField]}))},i.prototype._getNodeNameFromData=function(t){return(null==t?void 0:t.datum)?null==t?void 0:t.datum[this._spec.categoryField]:t[this._spec.categoryField]},i.prototype.extractNamesFromTree=function(t,e){var i=this,n=new Set;return t.forEach((function(t){(n.add(t[e]),t.children)&&i.extractNamesFromTree(t.children,e).forEach((function(t){return n.add(t)}))})),n},i.prototype.getDimensionField=function(){return[this._spec.categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.getRawDataStatisticsByField=function(t,e){var i;(this._rawStatisticsCache||(this._rawStatisticsCache={}),this._rawStatisticsCache[t])||(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)}));return this._rawStatisticsCache[t]},i.prototype._collectByField=function(t){var e,i,n,r=this,o=[],a=null===(i=null===(e=this.getRawData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[0];if(!a)return[];if(a.links)(null===(n=a.nodes)||void 0===n?void 0:n.length)&&a.nodes.forEach((function(t){t[r._seriesField]&&o.push(t[r._seriesField])}));else if(a.nodes){var s=new Set;return v1(s,a.nodes,this._seriesField),Array.from(s)}return o},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform(),this._nodesSeriesData.updateData(),this._linksSeriesData.updateData()},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype._noAnimationDataKey=function(t,e){},i.prototype.getActiveMarks=function(){return[this._nodeMark,this._linkMark]},i.type=t.SeriesTypeEnum.sankey,i.mark=IG,i}(gX),C1=function(){gT.registerTransform("sankey",{transform:p1,markPhase:"beforeJoin"},!0),rZ(),T1(),Kq(),FU.registerAnimation("sankeyNode",(function(t,e){return o({appear:S1(t,e)},SK)})),FU.registerAnimation("sankeyLinkPath",(function(t,e){return{appear:A1(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}})),wK(),FU.registerSeries(M1.type,M1)},E1=function(t,e){if(!t||!(null==e?void 0:e.range))return t;var i=e.range();return i.x1-i.x0==0||i.y1-i.y0==0?t:new C0(e).layout(t,i)},R1=function(t,e){var i={},n=e.fields;if(A(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return i;if(!t[0].latestData)return i;var r=t[0].latestData,o=Z0(r);return i=XK([{latestData:o}],e)},P1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentKeyCallback=function(t){return null==t?void 0:t[e.series.getDimensionField()[0]]},e}return r(e,t),Object.defineProperty(e.prototype,"defaultShapeType",{get:function(){return"square"},enumerable:!1,configurable:!0}),e}(YK),B1=function(t){return"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"}},L1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")},e}(fX),O1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.treemap,i.transformerConstructor=L1,i._viewBox=new ve,i._enableAnimationHook=i.enableMarkAnimation.bind(i),i}return r(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.setAttrFromSpec=function(){var t,i=this;e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:$K),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new ke),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:function(){var t,e;return null!==(e=null!==(t=i._spec.drillField)&&void 0!==t?t:i._categoryField)&&void 0!==e?e:lV},getRawData:function(){return i.getRawData()}}),F(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)},i.prototype.initData=function(){var t,i,n,r,a=this;e.prototype.initData.call(this),this.getViewData()&&(this._spec.drill&&this.initDrillableData(this._dataSet),hY(this._dataSet,"treemap",E1),hY(this._dataSet,"flatten",Z0),this.addViewDataFilter({type:"treemap",options:{range:function(){return{x0:a._viewBox.x1,x1:a._viewBox.x2,y0:a._viewBox.y1,y1:a._viewBox.y2}},maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null===(t=this._spec.nonLeafLabel)||void 0===t?void 0:t.visible)?null===(i=this._spec.nonLeafLabel)||void 0===i?void 0:i.padding:0,labelPosition:null===(n=this._spec.nonLeafLabel)||void 0===n?void 0:n.position,minVisibleArea:null!==(r=this._spec.minVisibleArea)&&void 0!==r?r:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize},level:mY.treemapFilter}),this.addViewDataFilter({type:"flatten",options:{callback:function(t){if(t.datum){var e=t.datum[t.depth];return o(o({},t),e)}return t}},level:mY.treemapFlatten}))},i.prototype._addDataIndexAndKey=function(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(hY(this._rawData.dataSet,"addVChartProperty",GK),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:nX.bind(this),call:rX}}))},i.prototype.getRawDataStatisticsByField=function(t,e){var i;if(!this._rawDataStatistics){var n="".concat(this.type,"_").concat(this.id,"_rawDataStatic");this._rawDataStatistics=this._createHierarchyDataStatistics(n,[this._rawData]),this._rawData.target.removeListener("change",this._rawDataStatistics.reRunAllTransform),this._rawDataStatistics.reRunAllTransform()}return null===(i=this._rawDataStatistics.latestData)||void 0===i?void 0:i[t]},i.prototype._createHierarchyDataStatistics=function(t,e){var i=this;hY(this._dataSet,"hierarchyDimensionStatistics",R1),hY(this._dataSet,"flatten",Z0);var n=new Ma(this._dataSet,{name:t});return n.parse(e,{type:"dataview"}),n.transform({type:"hierarchyDimensionStatistics",options:{fields:function(){var t=i.getStatisticFields();return i._seriesField&&i._seriesField!==i._categoryField&&t.push({key:i._seriesField,operations:["values"]}),t}}},!1),n},i.prototype.getStatisticFields=function(){return e.prototype.getStatisticFields.call(this).concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:QK,operations:["max","min","values"]},{key:$K,operations:["values"]}])},i.prototype.initMark=function(){var t,e,n=this,r=this._createMark(i.mark.nonLeaf,{isSeriesMark:!0,customShape:null===(t=this._spec.nonLeaf)||void 0===t?void 0:t.customShape});r&&(r.setTransform([{type:"filter",callback:function(t){return!n._shouldFilterElement(t,"nonLeaf")}}]),this._trigger.registerMark(r),this._nonLeafMark=r);var o=this._createMark(i.mark.leaf,{isSeriesMark:!0,customShape:null===(e=this._spec.leaf)||void 0===e?void 0:e.customShape});o&&(o.setTransform([{type:"filter",callback:function(t){return!n._shouldFilterElement(t,"leaf")}}]),this._leafMark=o,this._trigger.registerMark(o))},i.prototype.initMarkStyle=function(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()},i.prototype._initLeafMarkStyle=function(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype._initNonLeafMarkStyle=function(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:function(t){return t.x0},y:function(t){return t.y0},x1:function(t){return t.x1},y1:function(t){return t.y1},fill:this.getColorAttribute()},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&(this._labelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return(t.x0+t.x1)/2},y:function(t){return(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},MY.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initNonLeafLabelMarkStyle=function(e){var i=this;e&&(this._nonLeafLabelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:function(t){return t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2},y:function(t){return t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2},text:function(t){var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[i.getDimensionField()[0]]},maxLineWidth:function(t){return t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0}},MY.STATE_NORMAL,t.AttributeLevel.Series))},i.prototype.initAnimation=function(){var t=this;this.getMarksInType("rect").forEach((function(e){var i;e.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("treemap"))||void 0===i?void 0:i(),sX(e.name,t._spec,t._markAttributeContext)))})),this.getMarksInType("text").forEach((function(e){var i;e.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("fadeInOut"))||void 0===i?void 0:i(),sX(e.name,t._spec,t._markAttributeContext)))}))},i.prototype.initEvent=function(){var t=this;e.prototype.initEvent.call(this),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",(function(e){t.handlePan(e)})),this.initZoomEventOfSeries(this),this.event.on("zoom",(function(e){t.handleZoom(e)}))),this._spec.drill&&this.bindDrillEvent()},i.prototype._getDataIdKey=function(){return"key"},i.prototype.initTooltip=function(){this._tooltipHelper=new P1(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)},i.prototype._shouldFilterElement=function(t,e){var i=t.isLeaf;return"leaf"===e?!i:i},i.prototype.handlePan=function(t){var e=t.delta;if(0!==e[0]||0!==e[1]){this._matrix.reset(),this._matrix.translate(e[0],e[1]);var i=this._matrix,n=i.a,r=i.b,o=i.c,a=i.d,s=i.e,l=i.f;this._matrix.multiply(n,r,o,a,s,l),this._viewBox.transformWithMatrix(this._matrix),this.reFilterViewData()}},i.prototype.handleZoom=function(e){var i=e.scale,n=e.scaleCenter;if(1!==i){this._matrix.reset();var r=n.x,o=n.y;this._matrix.translate(r,o),this._matrix.scale(i,i),this._matrix.translate(-r,-o);var a=this._matrix,s=a.a,l=a.b,u=a.c,c=a.d,h=a.e,d=a.f;this._matrix.multiply(s,l,u,c,h,d),this.disableMarkAnimation(),this.event.on(t.VGRAMMAR_HOOK_EVENT.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this.reFilterViewData()}},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._rawData.reRunAllTransform()},i.prototype.enableMarkAnimation=function(){this.getMarks().forEach((function(t){var e;null===(e=t.getProduct().animate)||void 0===e||e.enable()})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().enableAnimation()})),this.event.off(t.VGRAMMAR_HOOK_EVENT.AFTER_DO_RENDER,this._enableAnimationHook)},i.prototype.disableMarkAnimation=function(){this.getMarks().forEach((function(t){var e;null===(e=t.getProduct().animate)||void 0===e||e.disable()})),[this._labelMark,this._nonLeafLabelMark].forEach((function(t){t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().disableAnimation()}))},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getActiveMarks=function(){return[this._nonLeafMark,this._leafMark]},i.type=t.SeriesTypeEnum.treemap,i.mark=OG,i.transformerConstructor=L1,i}(gX);ot(O1,$0),ot(O1,mq);var I1=function(){rZ(),Kq(),FU.registerAnimation("treemap",(function(t,e){return{appear:B1(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}})),wK(),FU.registerSeries(O1.type,O1)},D1={type:"fadeIn"};function F1(t,e){return"fadeIn"===e?D1:function(t){return{channel:{angle:{from:t.startAngle+Math.PI/2}}}}(t)}var z1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gaugePointer,i._pinMark=null,i._pointerMark=null,i._pinBackgroundMark=null,i._stack=!1,i}return r(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null===(t=this._spec.pointer)||void 0===t?void 0:t.type)?"rect":"path"},i.prototype.initMark=function(){this._pinBackgroundMark=this._createMark(i.mark.pinBackground),this._pointerMark=this._createMark(o(o({},i.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(i.mark.pin)},i.prototype.initMarkStyle=function(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()},i.prototype.initGroups=function(){},i.prototype.initPointerMarkStyle=function(){var t=this,e=this._pointerMark,i=this._spec.pointer;e&&(this.setMarkStyle(e,{x:function(e){var n,r;return t._getPointerAnchor(e,i).x-t._getPointerWidth()*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[0])&&void 0!==r?r:0)},y:function(e){var n,r;return t._getPointerAnchor(e,i).y-t._getPointerHeight(e)*(null!==(r=null===(n=null==i?void 0:i.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0)},anchor:function(e){var n=t._getPointerAnchor(e,i);return[n.x,n.y]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(e,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)+Math.PI/2}}):this.setMarkStyle(e,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:function(e){return t._getPointerAngle(e)-Math.PI/2}}),this._trigger.registerMark(e))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)},i.prototype._getPointerAnchor=function(t,e){var i;return null===(i=e.isOnCenter)||void 0===i||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})},i.prototype._getPointerWidth=function(){return this._spec.pointer.width*this._computeLayoutRadius()},i.prototype._getPointerHeight=function(t){var e,i,n=this._spec.pointer,r=this._radiusField[0];return T(this.radiusAxisHelper)&&T(r)?this.radiusAxisHelper.dataToPosition([t[r]])-(null!==(e=null==n?void 0:n.innerPadding)&&void 0!==e?e:0)-(null!==(i=null==n?void 0:n.outerPadding)&&void 0!==i?i:10):n.height*this._computeLayoutRadius()},i.prototype._getPointerAngle=function(t){return this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])},i.prototype._getRotatedPointerCenterOffset=function(t){var e,i,n,r,o=this._spec.pointer,a=this._getPointerWidth()*(null!==(i=null===(e=null==o?void 0:o.center)||void 0===e?void 0:e[0])&&void 0!==i?i:0),s=-this._getPointerHeight(t)*(null!==(r=null===(n=null==o?void 0:o.center)||void 0===n?void 0:n[1])&&void 0!==r?r:0),l=this._getPointerAngle(t)-Math.PI/2,u=Math.cos(l),c=Math.sin(l);return{x:a*u+s*c,y:-(s*u-a*c)}},i.prototype.initPinBackgroundMarkStyle=function(){var t=this,e=this._pinBackgroundMark,i=this._spec.pinBackground;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:100})},i.prototype.initPinMarkStyle=function(){var t=this,e=this._pinMark,i=this._spec.pin;e&&this.setMarkStyle(e,{x:function(e){return t._getPointerAnchor(e,i).x},y:function(e){return t._getPointerAnchor(e,i).y},scaleX:function(){return i.width*t._computeLayoutRadius()},scaleY:function(){return i.height*t._computeLayoutRadius()},fill:this.getColorAttribute(),zIndex:300})},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._pointerMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("gaugePointer"))||void 0===i?void 0:i({startAngle:this._startAngle},n),sX("pointer",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gaugePointer,i.mark=FG,i}(iQ),j1=function(){XZ(),rZ(),FU.registerAnimation("gaugePointer",(function(t,e){var i=F1(t,e);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})),FU.registerSeries(z1.type,z1)},H1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"segment")},e}(fX),N1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.gauge,i.transformerConstructor=H1,i._segmentMark=null,i._trackMark=null,i._stack=!1,i._padAngle=0,i}return r(i,e),i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._padAngle=ge(null!==(t=this._spec.padAngle)&&void 0!==t?t:0)},i.prototype.initData=function(){var t,i=this;e.prototype.initData.call(this);hY(this._option.dataSet,"spiltSegment",(function(t,e){var n=t.slice();return n.sort((function(t,e){return t[i._angleField[0]]-e[i._angleField[0]]})),n.forEach((function(t,e){t[SV]=t[i._angleField[0]],t[kV]=e>0?n[e-1][SV]:void 0})),n})),null===(t=this.getViewData())||void 0===t||t.transform({type:"spiltSegment"},!1)},i.prototype.initMark=function(){e.prototype.initMark.call(this),this._trackMark=this._createMark(i.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(i.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})},i.prototype.initMarkStyle=function(){e.prototype.initMarkStyle.call(this),this.initTrackMarkStyle(),this.initSegmentMarkStyle()},i.prototype.initSegmentMarkStyle=function(){var t,e=this,i=this._segmentMark;i&&(this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0}),this._trigger.registerMark(i))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)},i.prototype.initTrackMarkStyle=function(){var t,e=this,i=this._trackMark;i&&(this.setMarkStyle(i,{x:function(){return e.angleAxisHelper.center().x},y:function(){return e.angleAxisHelper.center().y},startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:function(){var t;return e._computeLayoutRadius()*(null!==(t=e._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:function(){var t,i;return e._computeLayoutRadius()*(null!==(i=null!==(t=e._spec.radius)&&void 0!==t?t:e._spec.outerRadius)&&void 0!==i?i:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100}),this._trigger.registerMark(i))},i.prototype._getAngleValueStartWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t);return Math.min(e+this._padAngle/2,(e+i)/2)},i.prototype._getAngleValueEndWithoutMask=function(t){var e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t);return Math.max(i-this._padAngle/2,(e+i)/2)},i.prototype._getAngleValueStartWithoutPadAngle=function(t){return T(t[kV])?this.angleAxisHelper.dataToPosition([t[kV]]):this._startAngle},i.prototype._getAngleValueEndWithoutPadAngle=function(t){return this.angleAxisHelper.dataToPosition([t[SV]])},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._segmentMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},n),sX("segment",this._spec,this._markAttributeContext)))},i.prototype.getDefaultShapeType=function(){return"circle"},i.prototype.getActiveMarks=function(){return[]},i.type=t.SeriesTypeEnum.gauge,i.mark=DG,i.transformerConstructor=H1,i}(iQ),V1=function(){rQ(),sQ(),FU.registerSeries(N1.type,N1)},G1=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{padding:0})},e.type="cell",e}(AX),W1=function(){FU.registerMark(G1.type,G1),jL(),NL(),gT.registerGraphic(sw.cell,ry),gT.registerMark(sw.cell,qN)};function U1(t){return!1===t?{}:{type:"fadeIn"}}var Y1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getDefaultTooltipPattern=function(e,i){var n=t.prototype.getDefaultTooltipPattern.call(this,e,i);return T(n)&&"dimension"===e&&(n.visible=!1),n},e}(YK),K1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"cell")},e}(fX),X1=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.heatmap,i.transformerConstructor=K1,i}return r(i,e),i.prototype.getFieldValue=function(){return this._fieldValue},i.prototype.setFieldValue=function(t){this._fieldValue=lt(t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setFieldValue(this._spec.valueField)},i.prototype.initMark=function(){var t,e,n={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._cellMark=this._createMark(i.mark.cell,{morph:cX(this._spec,i.mark.cell.name),defaultMorphElementKey:this.getDimensionField()[0],isSeriesMark:!0,progressive:n,customShape:null===(t=this._spec.cell)||void 0===t?void 0:t.customShape}),this._backgroundMark=this._createMark(i.mark.cellBackground,{progressive:n,customShape:null===(e=this._spec.cellBackground)||void 0===e?void 0:e.customShape})},i.prototype.initMarkStyle=function(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()},i.prototype.initLabelMarkStyle=function(t){var e=this;t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:function(t){return t[e.getMeasureField()[0]]}})},i.prototype.initCellMarkStyle=function(){var e=this;this.setMarkStyle(this._cellMark,{x:function(t){return e.dataToPositionX(t)},y:function(t){return e.dataToPositionY(t)},size:function(){return[e.getCellSize(e._xAxisHelper),e.getCellSize(e._yAxisHelper)]},fill:this.getColorAttribute()},"normal",t.AttributeLevel.Series),this._trigger.registerMark(this._cellMark)},i.prototype.initCellBackgroundMarkStyle=function(){var e,i,n,r=this,o=mi(null!==(n=null===(i=null===(e=this._spec.cellBackground)||void 0===e?void 0:e.style)||void 0===i?void 0:i.padding)&&void 0!==n?n:0);this.setMarkStyle(this._backgroundMark,{x:function(t){var e=r.getCellSize(r._xAxisHelper);return r.dataToPositionX(t)-e/2+o[3]},y:function(t){var e=r.getCellSize(r._yAxisHelper);return r.dataToPositionY(t)-e/2+o[0]},width:function(){return r.getCellSize(r._xAxisHelper)-o[1]-o[3]},height:function(){return r.getCellSize(r._yAxisHelper)-o[0]-o[2]}},"normal",t.AttributeLevel.Series)},i.prototype.getColorAttribute=function(){var t;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}},i.prototype.initAnimation=function(){var t,e,i,n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,r=yX(this);this._cellMark.setAnimationConfig(aX(null===(i=FU.getAnimationInKey("heatmap"))||void 0===i?void 0:i(n),sX("cell",this._spec,this._markAttributeContext),r))},i.prototype.getCellSize=function(t){var e,i;return null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,0))&&void 0!==i?i:6},i.prototype.initTooltip=function(){this._tooltipHelper=new Y1(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)},i.prototype.getDefaultShapeType=function(){return"square"},i.prototype.getDimensionField=function(){return[].concat(this.fieldX,this.fieldY)},i.prototype.getMeasureField=function(){return this.getFieldValue()},i.prototype.getActiveMarks=function(){return[this._cellMark]},i.type=t.SeriesTypeEnum.heatmap,i.mark=VG,i.transformerConstructor=K1,i}(gX),Z1=function(){Kq(),W1(),FU.registerAnimation("heatmap",(function(t,e){return o(o({},SK),{appear:U1(e)})})),FU.registerSeries(X1.type,X1)},q1=function(t,e){var i,n,r,a,s,l,u,h,d,f,p,v,y,g,m;if(!t||!(null==e?void 0:e.view)||!B(t))return t;var _=e.view();if(_.x1-_.x0==0||_.y1-_.y0==0||_.x1-_.x0==-1/0||_.x1-_.x0==1/0||_.y1-_.y0==-1/0||_.y1-_.y0==1/0)return t;var b=ge(null!==(i=e.startAngle)&&void 0!==i?i:-90),x=ge(null!==(n=e.endAngle)&&void 0!==n?n:270),k=Math.max((_.x1-_.x0)/2,(_.y1-_.y0)/2),S=cS(null!==(r=e.innerRadius)&&void 0!==r?r:0,k),A=cS(e.outerRadius,k),T=[I(null===(a=e.center)||void 0===a?void 0:a[0])?e.center[0]:_.x0+cS(null!==(l=null===(s=e.center)||void 0===s?void 0:s[0])&&void 0!==l?l:"50%",_.x1-_.x0),I(null===(u=e.center)||void 0===u?void 0:u[1])?e.center[1]:_.y0+cS(null!==(d=null===(h=e.center)||void 0===h?void 0:h[1])&&void 0!==d?d:"50%",_.y1-_.y0)],M=rS(e.field),C=t.map(M),E=c(lS(C),2),R=E[0],P=E[1],L=R===P?function(t){return(S+A)/2}:function(t){return S+(A-S)*(t-R)/(P-R)},O=w(e.radiusField)?M:rS(e.radiusField),D=null!==(p=null===(f=null==e?void 0:e.radiusRange)||void 0===f?void 0:f[1])&&void 0!==p?p:5,F=function(t){return D};if(O){var z=c(O!==M?lS(t.map(O)):[R,P],2),j=z[0],H=z[1],N=null!==(y=null===(v=e.radiusRange)||void 0===v?void 0:v[0])&&void 0!==y?y:5,V=null!==(m=null===(g=e.radiusRange)||void 0===g?void 0:g[1])&&void 0!==m?m:5;j!==H&&(F=function(t){return N+(V-N)*(O(t)-j)/(H-j)})}var G=Math.min(b,x),W=Math.max(b,x),U=J1(G,W,t.length),Y=[],K=(W-G)/60;return t.forEach((function(t,e){for(var i,n,r,a=L(C[e]),s=F(t),l=U[e],u=0;u<60&&(n=T[0]+a*Math.cos(l),r=T[1]+a*Math.sin(l),Q1({x:n,y:r,size:s},Y)||n-s<_.x0||n+s>_.x1||r-s<_.y0||r+s>_.y1);u++)u<59&&((l+=K)>W?l=G:l<G&&(l=W));Y.push(o(((i={})[nV]=n,i[rV]=r,i[oV]=s,i),t))})),Y},J1=function(t,e,i){for(var n=0,r=Math.max(Math.ceil(2*(e-t)/Math.PI),2),o=(e-t)/r,a=0,s=1,l=0,u=0,c=[],h=t;l<i;)u<r&&(c.push(h+(u%2?Math.floor(u/2)+Math.floor(r/2):u/2)*o*s),u++),l++,u===r&&(u=0,0===n?n=o/2:n/=2,h=-1===(s*=-1)?e-n:t+n,(a+=1)>=2&&(o/=2,r*=2));return c},Q1=function(t,e){return!(!e||!e.length)&&e.some((function(e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)}))},$1=function(t,e){var i;if(!t||!B(t))return[];var n=e.keyword,r=e.categoryField,o=t[0].latestData[0];return(i={})[r]=n,i[sV]=null==o?void 0:o[sV],i[uV]=null==o?void 0:o[uV],i},t2=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{x:0,y:0,ripple:0})},e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.glyph("ripplePoint",null!=t?t:e.rootMark).id(i),this._compiledProductId=i},e.type="ripple",e}(vK),e2=function(){FU.registerMark(t2.type,t2),gT.registerGlyph("ripplePoint",{symbol:"symbol",ripple0:"symbol",ripple1:"symbol",ripple2:"symbol"}).registerFunctionEncoder((function(t,e,i,n){var r,o=Math.max(0,Math.min(t.ripple,1)),a=null!==(r=t.size)&&void 0!==r?r:i.getGraphicAttribute("size"),s=.5*a;return{ripple0:{size:a+s*o,fillOpacity:.75-.25*o},ripple1:{size:a+s*(1+o),fillOpacity:.5-.25*o},ripple2:{size:a+s*(2+o),fillOpacity:.25-.25*o}}})).registerDefaultEncoder((function(){return{ripple0:{fillOpacity:.75},ripple1:{fillOpacity:.5},ripple2:{fillOpacity:.25}}})),iH(),tH()},i2=function(t,e){return"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"}},n2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._transformLabelSpec=function(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")},e}(fX),r2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.SeriesTypeEnum.correlation,i.transformerConstructor=n2,i._viewBox=new ve,i}return r(i,e),i.prototype.getCategoryField=function(){return this._categoryField},i.prototype.setCategoryField=function(t){return this._categoryField=t,this._categoryField},i.prototype.getValueField=function(){return this._valueField},i.prototype.setValueField=function(t){return this._valueField=t,this._valueField},i.prototype.getSeriesField=function(){return this._seriesField},i.prototype.setSeriesField=function(t){T(t)&&(this._seriesField=t)},i.prototype.getSizeField=function(){return this._sizeField},i.prototype.setSizeField=function(t){T(t)&&(this._sizeField=t)},i.prototype.getSizeRange=function(){return this._sizeRange},i.prototype.setSizeRange=function(t){T(t)&&(this._sizeRange=t)},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)},i.prototype.initData=function(){var t,i,n;if(e.prototype.initData.call(this),this._data){hY(this._dataSet,"correlation",q1);var r=new wa;dY(r,"dataview",ka),hY(r,"correlationCenter",$1);var o=new Ma(r,{name:"".concat(this.type,"_").concat(this.id,"_center")});o.parse([this.getViewData()],{type:"dataview"}),o.transform({type:"correlationCenter",options:{keyword:null!==(n=null===(i=null===(t=this._spec.centerLabel)||void 0===t?void 0:t.style)||void 0===i?void 0:i.text)&&void 0!==n?n:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new JK(this._option,o)}},i.prototype._statisticViewData=function(){var t=this;e.prototype._statisticViewData.call(this),this._data.getDataView().transform({type:"correlation",options:{view:function(){return{x0:t._viewBox.x1,x1:t._viewBox.x2,y0:t._viewBox.y1,y1:t._viewBox.y2}},field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})},i.prototype.initMark=function(){var e,n,r=this._createMark(i.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:sV,customShape:null===(e=this._spec.nodePoint)||void 0===e?void 0:e.customShape});r&&(r.setZIndex(t.LayoutZIndex.Node),this._nodePointMark=r);var o=this._createMark(i.mark.ripplePoint,{key:sV,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});o&&(this._ripplePointMark=o);var a=this._createMark(i.mark.centerPoint,{key:sV,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId(),customShape:null===(n=this._spec.centerPoint)||void 0===n?void 0:n.customShape});a&&(a.setZIndex(t.LayoutZIndex.Node),this._centerPointMark=a)},i.prototype.initMarkStyle=function(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()},i.prototype._initNodePointMarkStyle=function(){var e,i,n,r,o=this._nodePointMark;if(o){var a=null!==(i=null===(e=this._spec.nodePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(o,{x:function(t){return t[nV]},y:function(t){return t[rV]},size:function(t){return t[oV]},fill:null!==(n=a.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(r=a.fillOpacity)&&void 0!==r?r:1,lineWidth:0},MY.STATE_NORMAL,t.AttributeLevel.Series),this._trigger.registerMark(o)}},i.prototype._initRipplePointMarkStyle=function(){var e,i,n,r,o,a=this,s=this._ripplePointMark;if(s){var l=null!==(i=null===(e=this._spec.ripplePoint)||void 0===e?void 0:e.style)&&void 0!==i?i:{};this.setMarkStyle(s,{x:function(){var t;return null!==(t=a._spec.centerX)&&void 0!==t?t:(a._viewBox.x1+a._viewBox.x2)/2},y:function(){var t;return null!==(t=a._spec.centerY)&&void 0!==t?t:(a._viewBox.y1+a._viewBox.y2)/2},size:function(){return Math.max(a._viewBox.x2-a._viewBox.x1,a._viewBox.y2-a._viewBox.y1)/2},fill:null!==(n=l.fill)&&void 0!==n?n:this.getColorAttribute(),opacity:null!==(r=l.fillOpacity)&&void 0!==r?r:.2,ripple:null!==(o=l.ripple)&&void 0!==o?o:0},MY.STATE_NORMAL,t.AttributeLevel.Series)}},i.prototype._initCenterPointMarkStyle=function(){var e,i,n,r,o,a,s=this,l=this._centerPointMark;l&&(this.setMarkStyle(l,{x:function(){var t;return null!==(t=s._spec.centerX)&&void 0!==t?t:(s._viewBox.x1+s._viewBox.x2)/2},y:function(){var t;return null!==(t=s._spec.centerY)&&void 0!==t?t:(s._viewBox.y1+s._viewBox.y2)/2},size:function(){return.2*Math.max(s._viewBox.x2-s._viewBox.x1,s._viewBox.y2-s._viewBox.y1)/2},fill:null!==(n=null===(i=null===(e=this._spec.centerPoint)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill)&&void 0!==n?n:this.getColorAttribute(),fillOpacity:null!==(a=null===(o=null===(r=this._spec.centerPoint)||void 0===r?void 0:r.style)||void 0===o?void 0:o.fillOpacity)&&void 0!==a?a:1},MY.STATE_NORMAL,t.AttributeLevel.Series),this._trigger.registerMark(l))},i.prototype.initTooltip=function(){e.prototype.initTooltip.call(this),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)},i.prototype.initLabelMarkStyle=function(e){var i=this;e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:function(t){return t[i._categoryField]},z:this.dataToPositionZ.bind(this)},MY.STATE_NORMAL,t.AttributeLevel.Series)},i.prototype.initAnimation=function(){var t,e,i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._nodePointMark.setAnimationConfig(aX(null===(e=FU.getAnimationInKey("correlation"))||void 0===e?void 0:e({},i),sX("nodePoint",this._spec,this._markAttributeContext)))},i.prototype.getGroupFields=function(){return[]},i.prototype.getStackGroupFields=function(){return[]},i.prototype.getStackValueField=function(){return""},i.prototype.getActiveMarks=function(){return[this._nodePointMark,this._centerPointMark]},i.prototype.getDimensionField=function(){return[this._categoryField]},i.prototype.getMeasureField=function(){return[this._valueField]},i.prototype.onLayoutEnd=function(t){e.prototype.onLayoutEnd.call(this,t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()},i.type=t.SeriesTypeEnum.correlation,i.mark=GG,i.transformerConstructor=n2,i}(lJ),o2=function(){TX(),e2(),FU.registerSeries(r2.type,r2),FU.registerAnimation("correlation",(function(t,e){return o({appear:i2(0,e)},kK)}))},a2=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._isValidSeries=function(e){return e===t.SeriesTypeEnum.map},i.prototype._getDefaultSeriesSpec=function(t){return o(o({},e.prototype._getDefaultSeriesSpec.call(this,t)),{type:t.type,nameField:t.nameField,valueField:t.valueField,seriesField:t.seriesField,map:t.map,nameProperty:t.nameProperty,centroidProperty:t.centroidProperty,nameMap:t.nameMap,area:t.area,defaultFillColor:t.defaultFillColor})},i.prototype.transformSpec=function(t){var i=this;e.prototype.transformSpec.call(this,t),t.region.forEach((function(t){t.coordinate="geo"}));var n=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):t.series=[n]},i}(OX),s2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=a2,i.type="map",i.seriesType=t.SeriesTypeEnum.map,i}return r(i,e),i.type="map",i.seriesType=t.SeriesTypeEnum.map,i.view="singleDefault",i.transformerConstructor=a2,i}(LX),l2=function(){Aq(),FU.registerChart(s2.type,s2)},u2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._isValidSeries=function(t){return!this.seriesType||t===this.seriesType},e.prototype.getIndicatorSpec=function(t){var e,i,n,r=lt(t.indicator),o=null!==(e=t.innerRadius)&&void 0!==e?e:null===(n=null===(i=t.series)||void 0===i?void 0:i[0])||void 0===n?void 0:n.innerRadius;return T(o)&&r.forEach((function(t){w(t.limitRatio)&&(t.limitRatio=o)})),r},e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{radius:e.radius,outerRadius:e.outerRadius,innerRadius:e.innerRadius,startAngle:e.startAngle,endAngle:e.endAngle,sortDataByAxis:e.sortDataByAxis}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e.prototype.transformSpec=function(e){var i=this;t.prototype.transformSpec.call(this,e),B(e.dataZoom)&&e.dataZoom.length>0&&e.dataZoom.forEach((function(t){"axis"===t.filterMode&&(t.filterMode="filter")}));var n=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):e.series=[n],T(e.indicator)&&(e.indicator=this.getIndicatorSpec(e))},e}(OX),c2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{seriesField:e.seriesField,categoryField:e.categoryField||e.radiusField,valueField:e.valueField||e.angleField,startAngle:e.startAngle,endAngle:e.endAngle,radius:e.radius,innerRadius:e.innerRadius,centerX:e.centerX,centerY:e.centerY})},e.prototype._transformProgressAxisSpec=function(t,e,i,n,r){var o,a;t.axes||(t.axes=[]);var s=(null!==(o=t.axes)&&void 0!==o?o:[]).find((function(t){return"radius"===t.orient})),l=(null!==(a=t.axes)&&void 0!==a?a:[]).find((function(t){return"angle"===t.orient}));l||(l=e,t.axes.push(l)),s||(s=i,t.axes.push(s)),w(l.type)&&(l.type="linear"),w(s.type)&&(s.type="band");var u=tq(l,{min:0,max:1});w(l.min)&&(l.min=u.min),w(l.max)&&(l.max=u.max),n&&Object.assign(l,$W({},n,l)),r&&Object.assign(s,$W({},r,s))},e}(u2),h2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!0},e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{categoryField:e.categoryField||e.angleField,valueField:e.valueField||e.radiusField})},e.prototype.transformSpec=function(e){var i;if(t.prototype.transformSpec.call(this,e),this.needAxes()){e.axes||(e.axes=[]);var n={radius:!1,angle:!1};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=!0),"angle"===e&&(n.angle=!0)})),n.angle||e.axes.push({orient:"angle"}),n.radius||e.axes.push({orient:"radius"})}},e}(u2),d2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{categoryField:e.categoryField||e.seriesField,valueField:e.valueField||e.angleField,center:e.center,centerOffset:e.centerOffset,cornerRadius:e.cornerRadius,padAngle:e.padAngle,minAngle:e.minAngle})},e}(u2),f2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=d2,e}return r(e,t),e.transformerConstructor=d2,e}(LX),p2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=d2,i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i}return r(i,e),i.type="pie",i.seriesType=t.SeriesTypeEnum.pie,i.view="singleDefault",i.transformerConstructor=d2,i}(f2),v2=function(){SJ(),FU.registerChart(p2.type,p2)},y2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.series.forEach((function(t){"pie3d"===t.type&&(t.angle3d=e.angle3d)}))},e}(d2),g2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=y2,i.type="pie3d",i.seriesType=t.SeriesTypeEnum.pie3d,i}return r(i,e),i.type="pie3d",i.seriesType=t.SeriesTypeEnum.pie3d,i.view="singleDefault",i.transformerConstructor=y2,i}(f2),m2=function(){CJ(),FU.registerChart(g2.type,g2)},_2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r;return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{radius:null!==(i=e.radius)&&void 0!==i?i:Nw,outerRadius:null!==(n=e.outerRadius)&&void 0!==n?n:Nw,innerRadius:null!==(r=e.innerRadius)&&void 0!==r?r:0,seriesField:e.seriesField,stack:e.stack,percent:e.percent})},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){["domainLine","grid","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),"angle"===t.orient&&w(t.bandPosition)&&(t.bandPosition=.5)})),e.crosshair=lt(e.crosshair||{}).map((function(t){return $W({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t)}))},e}(h2),b2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=_2,i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i._canStack=!0,i}return r(i,e),i.type="rose",i.seriesType=t.SeriesTypeEnum.rose,i.view="singleDefault",i.transformerConstructor=_2,i}(LX),x2=function(){zJ(),FU.registerChart(b2.type,b2)},k2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i;return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{seriesField:e.seriesField,line:e.line,point:e.point,stack:e.stack,percent:e.percent,area:$W({visible:!1},e.area),seriesMark:null!==(i=e.seriesMark)&&void 0!==i?i:"area",activePoint:e.activePoint,pointDis:e.pointDis,pointDisMul:e.pointDisMul,markOverlap:e.markOverlap})},e.prototype.transformSpec=function(e){var i;t.prototype.transformSpec.call(this,e),(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){"radius"===t.orient&&(["domainLine","label","tick"].forEach((function(e){t[e]||(t[e]={visible:!1})})),t.grid||(t.grid={visible:!0,smooth:!0}))})),e.crosshair=lt(e.crosshair||{}).map((function(t){return $W({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t)}))},e}(h2),S2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=k2,i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i._canStack=!0,i}return r(i,e),i.type="radar",i.seriesType=t.SeriesTypeEnum.radar,i.view="singleDefault",i.transformerConstructor=k2,i}(LX),A2=function(){YJ(),FU.registerChart(S2.type,S2)},w2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return delete i.data,i},e.prototype.transformSpec=function(e){var i=this;if(t.prototype.transformSpec.call(this,e),e.series&&e.series.length){var n=this._getDefaultSeriesSpec(e);e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))}))}e.axes&&e.axes.length&&e.axes.forEach((function(t){U(t,"trimPadding")&&$W(t,IY(i.type,e))}))},e}(OX),T2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=w2,e.type="common",e._canStack=!0,e}return r(e,t),e.type="common",e.view="singleDefault",e.transformerConstructor=w2,e}(LX),M2=function(){FU.registerChart(T2.type,T2)},C2=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._getSeriesDataLength=function(t,e){var i,n;if(e.data){var r=lt(e.data)[0];return r instanceof Ma?null===(i=r.latestData)||void 0===i?void 0:i.length:null===(n=r.values)||void 0===n?void 0:n.length}var o=lt(t.data).find((function(t,i){return e.dataId?t instanceof Ma?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i}));return o?o instanceof Ma?o.latestData.length:o.values.length:0},i.prototype.addAttrToComponentSpec=function(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t},i.prototype.transformSpec=function(i){var n,r,a,s,l,u,d,f,p,v,y,g=this;e.prototype.transformSpec.call(this,i);var m=0,_=[],b=[],x=[],k=[],S=[],A=i.series.filter((function(e){return e.type!==t.SeriesTypeEnum.link})).length,w=(500-20*(A-1))/A,T=(null===(n=null==i?void 0:i.appendPadding)||void 0===n?void 0:n.left)||0,M=(null===(r=null==i?void 0:i.appendPadding)||void 0===r?void 0:r.right)||0;if(null==i?void 0:i.legends){_.push({modelId:"legendRow".concat(m),col:1,row:m}),this.addAttrToComponentSpec(i.legends,"id","legendRow".concat(m));var C=lt(i.legends),E=null!==(a=C[0].height)&&void 0!==a?a:40;if(C[0].padding){var R=dW(C[0].padding);E+=Number(null!==(s=null==R?void 0:R.bottom)&&void 0!==s?s:0),E+=Number(null!==(l=null==R?void 0:R.top)&&void 0!==l?l:0),C[0].offsetY=Number(null!==(d=null===(u=C[0])||void 0===u?void 0:u.offsetY)&&void 0!==d?d:0)+Number(null!==(f=null==R?void 0:R.top)&&void 0!==f?f:0)}S.push({index:m,size:E}),m++}(null==i?void 0:i.dataZoom)&&(_.push({modelId:"dataZoomRow".concat(m),col:1,row:m}),this.addAttrToComponentSpec(i.dataZoom,"id","dataZoomRow".concat(m)),m++,S.push({index:m,size:10}),m++),b.push({id:"regionAxesRow".concat(m)}),_.push({modelId:"axesRow".concat(m),col:1,row:m}),i.axes[0].id="axesRow".concat(m),i.axes[0].regionIndex=Array.from(Array(i.series.length),(function(t,e){return e+1})),m++,null===(p=null==i?void 0:i.series)||void 0===p||p.forEach((function(e){var n,r;if([t.SeriesTypeEnum.bar,t.SeriesTypeEnum.line,t.SeriesTypeEnum.area,t.SeriesTypeEnum.dot].includes(e.type)){if(_.push({modelId:"".concat(e.type,"Row").concat(m),col:1,row:m}),_.push({modelId:"axesLeftRow".concat(m),col:0,row:m}),b.push({id:"".concat(e.type,"Row").concat(m),clip:!1}),S.push({index:m,size:(null==e?void 0:e.height)||w}),x.push({orient:"left",id:"axesLeftRow".concat(m),type:e.type===t.SeriesTypeEnum.dot?"band":"linear",visible:e.type!==t.SeriesTypeEnum.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.visible)||(null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.visible),style:function(t,i){var n,r,o,a,s,l=0;if(0===i){var u=null===(n=null==e?void 0:e.grid)||void 0===n?void 0:n.style;l=null!==(o=null!==(r=null==u?void 0:u.lineWidth)&&void 0!==r?r:null==u?void 0:u.strokeWidth)&&void 0!==o?o:1}return{lineWidth:l,stroke:(null===(s=null===(a=null==e?void 0:e.grid)||void 0===a?void 0:a.style)||void 0===s?void 0:s.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:b.length-1}),e.type===t.SeriesTypeEnum.dot){_.push({modelId:"scrollBarRightRow".concat(m),col:2,row:m});var a=g._getSeriesDataLength(i,e),s=0;a&&(s=((null==e?void 0:e.height)||w)/(30*a)),k.push(o({orient:"right",visible:e.type===t.SeriesTypeEnum.dot&&s<1,id:"scrollBarRightRow".concat(m),start:0,end:Math.min(s,1),filterMode:"axis",regionIndex:b.length-1,axisId:"axesLeftRow".concat(m)},lt(null==i?void 0:i.scrollBar)[0]))}e.regionIndex=b.length-1,m++,S.push({index:m,size:(null==e?void 0:e.padding)||20}),m++,e.leftAppendPadding=T,e.type===t.SeriesTypeEnum.dot&&(e.title.style.dx=-T,e.subTitle.style.dx=-T)}})),null===(v=null==i?void 0:i.series)||void 0===v||v.forEach((function(e){if(e.type===t.SeriesTypeEnum.link){var n=e.dotSeriesIndex+1;_.push({modelId:"".concat(e.type,"Row").concat(n),col:1,row:n-1}),e.regionIndex=i.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=T,e.height=i.series[e.dotSeriesIndex].height,e.clipHeight=i.series[e.dotSeriesIndex].clipHeight}})),(null==i?void 0:i.legends)&&this.addAttrToComponentSpec(i.legends,"regionIndex",[b.length-1]);var P={type:"grid",col:4,row:m,colWidth:[{index:0,size:T},{index:2,size:12},{index:3,size:M}],rowHeight:S,elements:_};i.layout=P,i.region=b,null===(y=i.axes)||void 0===y||y.push.apply(y,h([],c(x),!1)),i.scrollBar=k},i}(OX),E2=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformerConstructor=C2,t.type="sequence",t}return r(i,e),i.prototype._createSeries=function(e,i){if(e){var n,r=i.spec,s=a(i,["spec"]);if(r.type===t.SeriesTypeEnum.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(n=this.getRegionsInUserId(r.regionId)),n||(n=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),n){var l=new e(r,o(o(o({},this._modelOption),s),{region:n,specKey:"series",globalScale:this._globalScale}));l&&(l.created(),this._series.push(l),n.addSeries(l))}}},i.type="sequence",i.view="singleDefault",i.transformerConstructor=C2,i}(LX),R2=function(){JJ(),eQ(),FU.registerChart(E2.type,E2)},P2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes.forEach((function(t){return t.type="linear"}))},e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{x2Field:null==e?void 0:e.x2Field,y2Field:null==e?void 0:e.y2Field,barMinHeight:null==e?void 0:e.barMinHeight})},e}(IX),B2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformerConstructor=P2,e._canStack=!0,e}return r(e,t),e.transformerConstructor=P2,e}(LX),L2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(P2),O2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=L2,i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i}return r(i,e),i.type="histogram",i.seriesType=t.SeriesTypeEnum.bar,i.view="singleDefault",i.transformerConstructor=L2,i}(B2),I2=function(){lZ(),FU.registerChart(O2.type,O2)},D2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=L2,i.type="histogram3d",i.seriesType=t.SeriesTypeEnum.bar3d,i}return r(i,e),i.type="histogram3d",i.seriesType=t.SeriesTypeEnum.bar3d,i.view="singleDefault",i.transformerConstructor=L2,i}(B2),F2=function(){vZ(),FU.registerChart(D2.type,D2)},z2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return o(o({},r),{cornerRadius:null!==(i=e.cornerRadius)&&void 0!==i?i:0,roundCap:null!==(n=e.roundCap)&&void 0!==n&&n,progress:e.progress,track:e.track,tickMask:e.tickMask})},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),this._transformProgressAxisSpec(e,{orient:"angle",visible:!1},{orient:"radius",visible:!1})},e}(c2),j2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=z2,i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i._canStack=!0,i}return r(i,e),i.type="circularProgress",i.seriesType=t.SeriesTypeEnum.circularProgress,i.view="singleDefault",i.transformerConstructor=z2,i}(LX),H2=function(){uQ(),FU.registerChart(j2.type,j2)},N2=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._getDefaultSeriesSpec=function(t){var i=e.prototype._getDefaultSeriesSpec.call(this,t);return o(o({},i),{radiusField:t.radiusField,pin:t.pin,pinBackground:t.pinBackground,pointer:t.pointer})},i.prototype._getDefaultCircularProgressSeriesSpec=function(i){return o(o({},e.prototype._getDefaultSeriesSpec.call(this,i)),{type:t.SeriesTypeEnum.circularProgress})},i.prototype.transformSpec=function(i){var n,r,o,a,s;e.prototype.transformSpec.call(this,i);var l=null===(n=i.series)||void 0===n?void 0:n.find((function(e){return e.type===t.SeriesTypeEnum.gauge||e.type===t.SeriesTypeEnum.circularProgress}));w(l)&&("circularProgress"===(l=null!==(r=i.gauge)&&void 0!==r?r:this._getDefaultCircularProgressSeriesSpec(i)).type&&(w(l.radiusField)&&w(l.categoryField)&&(l.radiusField=null!==(a=null!==(o=i.radiusField)&&void 0!==o?o:i.categoryField)&&void 0!==a?a:i.seriesField),w(l.valueField)&&w(l.angleField)&&(l.valueField=null!==(s=i.valueField)&&void 0!==s?s:i.angleField)),1===i.series.length?i.series.push(l):i.series.forEach((function(t){t.type===l.type&&Object.keys(l).forEach((function(e){e in t||(t[e]=l[e])}))}))),l.type===t.SeriesTypeEnum.circularProgress?this._transformProgressAxisSpec(i,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:t.LayoutZIndex.Region+50}):this._transformGaugeAxisSpec(i)},i.prototype._transformGaugeAxisSpec=function(e){var i;e.axes||(e.axes=[]);var n={radius:null,angle:null};(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"radius"===e&&(n.radius=t),"angle"===e&&(n.angle=t)})),n.angle||(n.angle={orient:"angle",visible:!0},e.axes.push(n.angle)),n.radius||(n.radius={orient:"radius",visible:!1},e.axes.push(n.radius)),w(n.angle.type)&&(n.angle.type="linear"),w(n.radius.type)&&(n.radius.type="linear"),w(n.angle.zIndex)&&(n.angle.zIndex=t.LayoutZIndex.Region+50)},i}(c2),V2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=N2,i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i}return r(i,e),i.type="gauge",i.seriesType=t.SeriesTypeEnum.gaugePointer,i.view="singleDefault",i.transformerConstructor=N2,i}(LX),G2=function(){j1(),V1(),FU.registerChart(V2.type,V2)},W2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.transformSpec=function(e){var i=this;t.prototype.transformSpec.call(this,e);var n=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):e.series=[n]},e}(OX),U2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=W2,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return r(i,e),i.transformerConstructor=W2,i}(LX),Y2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{nameField:e.nameField,valueField:e.valueField,seriesField:e.seriesField,fontFamilyField:e.fontFamilyField,fontWeightField:e.fontWeightField,fontStyleField:e.fontStyleField,colorHexField:e.colorHexField,colorMode:e.colorMode,colorList:e.colorList,rotateAngles:e.rotateAngles,fontWeightRange:e.fontWeightRange,fontSizeRange:e.fontSizeRange,maskShape:e.maskShape,keepAspect:e.keepAspect,random:e.random,wordCloudConfig:e.wordCloudConfig,wordCloudShapeConfig:e.wordCloudShapeConfig,word:e.word,fillingWord:e.fillingWord}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e}(W2),K2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Y2,i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i}return r(i,e),i.type="wordCloud",i.seriesType=t.SeriesTypeEnum.wordCloud,i.view="singleDefault",i.transformerConstructor=Y2,i}(U2),X2=function(){j$(),FU.registerChart(K2.type,K2)},Z2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{nameField:e.nameField,valueField:e.valueField,seriesField:e.seriesField,fontFamilyField:e.fontFamilyField,fontWeightField:e.fontWeightField,fontStyleField:e.fontStyleField,colorHexField:e.colorHexField,colorMode:e.colorMode,colorList:e.colorList,rotateAngles:e.rotateAngles,fontWeightRange:e.fontWeightRange,fontSizeRange:e.fontSizeRange,depth_3d:e.depth_3d,maskShape:e.maskShape,keepAspect:e.keepAspect,random:e.random,wordCloudConfig:e.wordCloudConfig,wordCloudShapeConfig:e.wordCloudShapeConfig,word:e.word,fillingWord:e.fillingWord}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e}(W2),q2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Z2,i.type="wordCloud3d",i.seriesType=t.SeriesTypeEnum.wordCloud3d,i}return r(i,e),i.type="wordCloud3d",i.seriesType=t.SeriesTypeEnum.wordCloud3d,i.view="singleDefault",i.transformerConstructor=Z2,i}(U2),J2=function(){N$(),FU.registerChart(q2.type,q2)},Q2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{categoryField:e.categoryField,valueField:e.valueField,seriesField:e.seriesField,funnelAlign:e.funnelAlign,funnelOrient:e.funnelOrient,shape:e.shape,funnel:e.funnel,transform:e.transform,outerLabel:e.outerLabel,transformLabel:e.transformLabel,isTransform:e.isTransform,maxSize:e.maxSize,minSize:e.minSize,gap:e.gap,isCone:e.isCone,range:e.range}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e.prototype.transformSpec=function(e){var i=this;t.prototype.transformSpec.call(this,e);var n=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):e.series=[n]},e}(OX),$2=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Q2,i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i}return r(i,e),i.type="funnel",i.seriesType=t.SeriesTypeEnum.funnel,i.view="singleDefault",i.transformerConstructor=Q2,i}(LX),t3=function(){s0(),FU.registerChart($2.type,$2)},e3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=Q2,i.type="funnel3d",i.seriesType=t.SeriesTypeEnum.funnel3d,i}return r(i,e),i.type="funnel3d",i.seriesType=t.SeriesTypeEnum.funnel3d,i.view="singleDefault",i.transformerConstructor=Q2,i}(LX),i3=function(){d0(),FU.registerChart(e3.type,e3)},n3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.needAxes=function(){return!1},e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=t.prototype._getDefaultSeriesSpec.call(this,e);return o(o({},r),{direction:null!==(i=e.direction)&&void 0!==i?i:"horizontal",cornerRadius:null!==(n=e.cornerRadius)&&void 0!==n?n:0,bandWidth:e.bandWidth,progress:e.progress,track:e.track})},e.prototype.transformSpec=function(e){var i,n;if(t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[]),"vertical"===e.direction){var r=null,o=null;(null!==(i=e.axes)&&void 0!==i?i:[]).forEach((function(t){var e=t.orient;"left"===e&&(r=t),"bottom"===e&&(o=t)})),r||(r={orient:"left",visible:!1},e.axes.push(r)),o||(o={orient:"bottom",visible:!1},e.axes.push(o)),w(o.type)&&(o.type="band"),w(r.type)&&(r.type="linear");var a=tq(r,{min:0,max:1});w(r.min)&&(r.min=a.min),w(r.max)&&(r.max=a.max)}else{var s=null,l=null;(null!==(n=e.axes)&&void 0!==n?n:[]).forEach((function(t){var e=t.orient;"left"===e&&(s=t),"bottom"===e&&(l=t)})),s||(s={type:"band",orient:"left",visible:!1},e.axes.push(s)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),w(l.type)&&(l.type="linear"),w(s.type)&&(s.type="band");a=tq(l,{min:0,max:1});w(l.min)&&(l.min=a.min),w(l.max)&&(l.max=a.max)}},e}(IX),r3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=n3,i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i._canStack=!0,i}return r(i,e),i.type="linearProgress",i.seriesType=t.SeriesTypeEnum.linearProgress,i.view="singleDefault",i.transformerConstructor=n3,i}(LX),o3=function(){yQ(),FU.registerChart(r3.type,r3)},a3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{barGapInGroup:e.barGapInGroup,barBackground:e.barBackground,barMinHeight:e.barMinHeight});return r.bar=e.bar,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(IX),s3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=a3,i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i}return r(i,e),i.type="rangeColumn",i.seriesType=t.SeriesTypeEnum.rangeColumn,i.view="singleDefault",i.transformerConstructor=a3,i}(LX),l3=function(){iJ(),FU.registerChart(s3.type,s3)},u3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{barGapInGroup:e.barGapInGroup});return r.bar3d=e.bar3d,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r},e}(IX),c3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=u3,i.type="rangeColumn3d",i.seriesType=t.SeriesTypeEnum.rangeColumn3d,i}return r(i,e),i.type="rangeColumn3d",i.seriesType=t.SeriesTypeEnum.rangeColumn3d,i.view="singleDefault",i.transformerConstructor=u3,i}(LX),h3=function(){rJ(),FU.registerChart(c3.type,c3)},d3=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._getDefaultSeriesSpec=function(i){var n=T(i.startAngle)?i.startAngle:jw,r=T(i.endAngle)?i.endAngle:n+me(2*Math.PI),a=o(o({},e.prototype._getDefaultSeriesSpec.call(this,i)),{categoryField:i.categoryField,valueField:i.valueField,seriesField:i.seriesField,centerX:i.centerX,centerY:i.centerY,offsetX:i.offsetX,offsetY:i.offsetY,startAngle:n,endAngle:r,innerRadius:i.innerRadius,outerRadius:i.outerRadius,gap:i.gap,labelLayout:i.labelLayout,label:i.label,labelAutoVisible:i.labelAutoVisible,drill:i.drill,drillField:i.drillField}),s=t.SeriesTypeEnum.sunburst;return a.type=s,a[s]=i[s],a},i.prototype.transformSpec=function(t){var i=this;e.prototype.transformSpec.call(this,t);var n=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):t.series=[n]},i}(OX),f3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=d3,i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i}return r(i,e),i.type="sunburst",i.seriesType=t.SeriesTypeEnum.sunburst,i.view="singleDefault",i.transformerConstructor=d3,i}(LX),p3=function(){e1(),FU.registerChart(f3.type,f3)},v3=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._getDefaultSeriesSpec=function(i){var n=o(o({},e.prototype._getDefaultSeriesSpec.call(this,i)),{categoryField:i.categoryField,valueField:i.valueField,seriesField:i.seriesField,layoutPadding:i.layoutPadding,label:i.label,circlePacking:i.circlePacking,drill:i.drill,drillField:i.drillField}),r=t.SeriesTypeEnum.circlePacking;return n.type=r,n[r]=i[r],n},i.prototype.transformSpec=function(t){var i=this;e.prototype.transformSpec.call(this,t);var n=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):t.series=[n]},i}(OX),y3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=v3,i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i}return r(i,e),i.type="circlePacking",i.seriesType=t.SeriesTypeEnum.circlePacking,i.view="singleDefault",i.transformerConstructor=v3,i}(LX),g3=function(){a1(),FU.registerChart(y3.type,y3)},m3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{categoryField:e.categoryField,valueField:e.valueField,seriesField:e.seriesField,aspectRatio:e.aspectRatio,splitType:e.splitType,maxDepth:e.maxDepth,gapWidth:e.gapWidth,nodePadding:e.nodePadding,minVisibleArea:e.minVisibleArea,minChildrenVisibleArea:e.minChildrenVisibleArea,minChildrenVisibleSize:e.minChildrenVisibleSize,roam:e.roam,drill:e.drill,drillField:e.drillField,leaf:e.leaf,nonLeaf:e.nonLeaf,nonLeafLabel:e.nonLeafLabel}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e.prototype.transformSpec=function(e){var i=this;t.prototype.transformSpec.call(this,e);var n=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):e.series=[n]},e}(OX),_3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=m3,i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i}return r(i,e),i.type="treemap",i.seriesType=t.SeriesTypeEnum.treemap,i.view="singleDefault",i.transformerConstructor=m3,i}(LX),b3=function(){I1(),FU.registerChart(_3.type,_3)},x3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.legends&&lt(e.legends).forEach((function(t){t.select=!1,t.hover=!1,t.filter=!1})),BY(e)},e.prototype._getDefaultSeriesSpec=function(e){return o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{bar:e.bar,stackLabel:e.stackLabel,leaderLine:e.leaderLine,total:e.total})},e}(uZ),k3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=x3,i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i}return r(i,e),i.type="waterfall",i.seriesType=t.SeriesTypeEnum.waterfall,i.view="singleDefault",i.transformerConstructor=x3,i}(cZ),S3=function(){zq(),FU.registerChart(k3.type,k3)},A3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n=[e.maxField,e.medianField,e.q1Field,e.q3Field,e.minField,e.outliersField],r=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{boxPlot:e.boxPlot,direction:null!==(i=e.direction)&&void 0!==i?i:"vertical",minField:e.minField,maxField:e.maxField,q1Field:e.q1Field,medianField:e.medianField,q3Field:e.q3Field,outliersField:e.outliersField,outliersStyle:e.outliersStyle});return r["vertical"===r.direction?"yField":"xField"]=n,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),e.axes||(e.axes=[{orient:"bottom"},{orient:"left"}]),BY(e)},e}(IX),w3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=A3,i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i}return r(i,e),i.type="boxPlot",i.seriesType=t.SeriesTypeEnum.boxPlot,i.view="singleDefault",i.transformerConstructor=A3,i}(LX),T3=function(){Uq(),FU.registerChart(w3.type,w3)},M3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=o(o({},t.prototype._getDefaultSeriesSpec.call(this,e)),{categoryField:e.categoryField,valueField:e.valueField,sourceField:e.sourceField,targetField:e.targetField,direction:e.direction,nodeAlign:e.nodeAlign,nodeGap:e.nodeGap,nodeWidth:e.nodeWidth,linkWidth:e.linkWidth,minStepWidth:e.minStepWidth,minNodeHeight:e.minNodeHeight,minLinkHeight:e.minLinkHeight,iterations:e.iterations,nodeKey:e.nodeKey,linkSortBy:e.linkSortBy,nodeSortBy:e.nodeSortBy,setNodeLayer:e.setNodeLayer,node:e.node,link:e.link,label:e.label,emphasis:e.emphasis}),n=this.seriesType;return n&&(i.type=n,i[n]=e[n]),i},e.prototype.transformSpec=function(e){var i=this;t.prototype.transformSpec.call(this,e);var n=this._getDefaultSeriesSpec(e);e.series&&0!==e.series.length?e.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):e.series=[n]},e}(OX),C3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=M3,i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i}return r(i,e),i.type="sankey",i.seriesType=t.SeriesTypeEnum.sankey,i.view="singleDefault",i.transformerConstructor=M3,i}(LX),E3=function(){C1(),FU.registerChart(C3.type,C3)},R3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i,n,r=o({},t.prototype._getDefaultSeriesSpec.call(this,e));return r.area=e.area,"horizontal"===e.direction?r.xField=null!==(i=e.xField)&&void 0!==i?i:[e.minField,e.maxField]:r.yField=null!==(n=e.yField)&&void 0!==n?n:[e.minField,e.maxField],r.stack=!1,r},e.prototype.transformSpec=function(e){t.prototype.transformSpec.call(this,e),BY(e)},e}(IX),P3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=R3,i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i}return r(i,e),i.type="rangeArea",i.seriesType=t.SeriesTypeEnum.rangeArea,i.view="singleDefault",i.transformerConstructor=R3,i}(LX),B3=function(){sJ(),FU.registerChart(P3.type,P3)},L3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._getDefaultSeriesSpec=function(e){var i=t.prototype._getDefaultSeriesSpec.call(this,e);return o(o({},i),{valueField:e.valueField,cell:e.cell})},e}(IX),O3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=L3,i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i}return r(i,e),i.type="heatmap",i.seriesType=t.SeriesTypeEnum.heatmap,i.view="singleDefault",i.transformerConstructor=L3,i}(LX),I3=function(){Z1(),FU.registerChart(O3.type,O3)},D3=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),i.prototype._getDefaultSeriesSpec=function(i){var n=o(o({},e.prototype._getDefaultSeriesSpec.call(this,i)),{categoryField:i.categoryField,valueField:i.valueField,seriesField:i.seriesField,sizeField:i.sizeField,sizeRange:i.sizeRange,centerX:i.centerX,centerY:i.centerY,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,ripplePoint:i.ripplePoint,centerPoint:i.centerPoint,centerLabel:i.centerLabel,nodePoint:i.nodePoint,label:i.label}),r=t.SeriesTypeEnum.correlation;return n.type=r,n[r]=i[r],n},i.prototype.transformSpec=function(t){var i=this;e.prototype.transformSpec.call(this,t);var n=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach((function(t){i._isValidSeries(t.type)&&Object.keys(n).forEach((function(e){e in t||(t[e]=n[e])}))})):t.series=[n]},i}(OX),F3=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transformerConstructor=D3,i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i}return r(i,e),i.type="correlation",i.seriesType=t.SeriesTypeEnum.correlation,i.view="singleDefault",i.transformerConstructor=D3,i}(LX),z3=function(){o2(),FU.registerChart(F3.type,F3)};function j3(t){return 2===t.length&&F(t[0])&&F(t[1])&&t[1]>=t[0]}function H3(t,e){var i=e[1]-e[0],n=e[1]*e[0]<0,r=e[0]<=0?0-e[0]:0,o=e[1]>0?e[1]-0:0;0===i?e[0]<0?(r=1,o=0):e[0]>0&&(r=0,o=1):(r/=i,o/=i);var a=t.getDomainSpec();return{total:i,negative:r,positive:o,includeZero:n,domain:e,extendable_min:!F(a.min),extendable_max:!F(a.max)}}function N3(t,e){var i=t.positive,n=t.negative,r=t.extendable_min,o=t.extendable_max,a=t.domain,s=e.positive,l=e.negative,u=e.extendable_min,c=e.extendable_max,h=e.domain;if(s>0){if(!u)return!1;var d=n/i;o&&(d=n/Math.max(i,s),a[1]=-a[0]/d),h[0]=-h[1]*d}else if(l>0){if(!c)return!1;d=i/n;r&&(d=i/Math.max(n,n),a[0]=-a[1]/d),h[1]=-h[0]*d}return!0}function V3(t,e){var i=t.extendable_min,n=t.extendable_max,r=t.domain,o=e.positive,a=e.negative,s=e.domain;return(0!==o||0!==a)&&(!(o>0&&!n)&&(!(a>0&&!i)&&(r[0]=s[0],r[1]=s[1],!0)))}function G3(t,e){var i=t.positive,n=t.negative,r=t.extendable_max,o=t.domain,a=e.positive,s=e.negative,l=e.extendable_min,u=e.domain;if(r&&l){var c=Math.max(n,s)/Math.max(i,a);o[1]=-o[0]/c,u[0]=-u[1]*c}else if(l){c=n/i;u[0]=-u[1]*c}else{if(!r)return!1;c=s/a;o[1]=-o[0]/c}return!0}function W3(t,e){var i=t.extendable_min,n=t.domain,r=e.extendable_max,o=e.domain;return!(!i||!r)&&(n[0]=-n[1],o[1]=-o[0],!0)}var U3=function(t,e){var i,n,r,o,a;if(!t)return t;var s=null===(i=null==e?void 0:e.targetAxis)||void 0===i?void 0:i.call(e);if(!s)return t;var l=null===(n=null==e?void 0:e.currentAxis)||void 0===n?void 0:n.call(e);if(!l)return t;var u=null===(r=l.getTickData())||void 0===r?void 0:r.getDataView();if(!u)return t;if(!u.transformsArr.find((function(t){return"ticks"===t.type})))return t;var c=l.getScale();if(!c)return t;var h=null===(a=null===(o=s.getTickData())||void 0===o?void 0:o.getDataView())||void 0===a?void 0:a.latestData;if(!(null==h?void 0:h.length))return t;var d=s.getScale();if(!d)return t;var f=d.domain(),p=f[1]-f[0];if(0===p)return t;var v=c.domain(),y=v[1]-v[0];if(0===p)return t;var g=h.map((function(t){var e=(t.value-f[0])/p;return y*e+v[0]}));return EA(g)},Y3=function(e){function i(){var t=e.call(this,i.type)||this;return t.type="AxisSyncPlugin",t}return r(i,e),i.prototype._checkEnableSync=function(t){if(!gS(t.getScale().type))return!1;var e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e},i.prototype._getTargetAxis=function(t,e){var i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null},i.prototype.onInit=function(e,i){var n=this._checkEnableSync(i);if(n&&n.zeroAlign){var r=this._getTargetAxis(i,n);r&&i.event.on(t.ChartEvent.scaleDomainUpdate,{filter:function(t){var e=t.model;return e.id===i.id||e.id===r.id}},(function(){!function(t,e){var i=t.getScale(),n=e.getScale();if(i&&n&&gS(i.type)&&gS(n.type)){var r=i.domain().slice(),o=n.domain().slice();if(j3(r)&&j3(o)){var a=H3(t,r),s=H3(e,o),l=a.positive,u=a.negative,c=a.extendable_min,h=a.extendable_max,d=a.includeZero,f=s.positive,p=s.negative,v=s.extendable_min,y=s.extendable_max,g=s.includeZero;if(0===l&&0===u){if(!V3(a,s))return}else if(0===f&&0===p){if(!V3(s,a))return}else if(d||g)if(d&&!g){if(!N3(a,s))return}else if(g&&!d){if(!N3(s,a))return}else{if(u===p)return;if(u>p){if(!G3(a,s))return}else if(!G3(s,a))return}else{if(0===u&&0===f){if(!W3(a,s))return}else if(0===p&&0===l&&!W3(s,a))return;if(0===u&&0===p)if(0===r[0]&&o[0]>0){if(!v)return;o[0]=0}else{if(!(0===o[0]&&r[0]>0))return;if(!c)return;r[0]=0}if(0===l&&0===f)if(0===r[1]&&o[1]>0){if(!y)return;o[1]=0}else{if(!(0===o[1]&&r[1]>0))return;if(!h)return;r[1]=0}}i.domain(r),n.domain(o)}}}(r,i)}))}},i.prototype.onDidCompile=function(t,e){var i=this._checkEnableSync(e);if(i){var n=this._getTargetAxis(e,i);if(n&&i.tickAlign){hY(e.getOption().dataSet,"tickAlign",U3);var r={targetAxis:function(){return n},currentAxis:function(){return e}};e.addTransformToTickData({type:"tickAlign",options:r,level:Number.MAX_SAFE_INTEGER},!1)}}},i.pluginType="component",i.type="AxisSyncPlugin",i}(HK),K3={AxisSyncPlugin:Y3},X3=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type="component",n._componentType=i.componentType,n._mode=i.mode,n}return r(e,t),e.prototype._initProduct=function(t){var e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(sw.component,null!=t?t:e.rootMark,{componentType:this._componentType,mode:this._mode}).id(i),this._compiledProductId=i},e.type="component",e}(vK),Z3=function(){FU.registerMark(X3.type,X3)},q3=function(t){return t},J3=function(e){function i(t,i){var n,r=this;return(r=e.call(this,t,i)||this).specKey="axes",r._scales=[],r._visible=!0,r._tick=void 0,r._visible=null===(n=t.visible)||void 0===n||n,r}return r(i,e),i.prototype.getOrient=function(){return this._orient},i.prototype.getScale=function(){return this._scale},i.prototype.getScales=function(){return this._scales},i.prototype.getTickData=function(){return this._tickData},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.getInverse=function(){return this._inverse},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.prototype.getVRenderComponents=function(){var t,e;return lt(null===(e=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct())||void 0===e?void 0:e.getGroupGraphicItem())},i.prototype.created=function(){var i,n,r,o,a,s,l,u,c,h,d,f,p,v,y,g,m,_=this;if(e.prototype.created.call(this),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this.getVisible()&&this._initData(),this._visible){var b=this._createMark({type:"component",name:"axis-".concat(this.getOrient())},{componentType:"angle"===this.getOrient()?"circleAxis":"axis",mode:this._spec.mode,noSeparateStyle:!0,skipTheme:!0});if(this._axisMark=b,b.setZIndex(this.layoutZIndex),T(this._spec.id)&&b.setUserId(this._spec.id),this._marks.addMark(b),null===(i=this._spec.grid)||void 0===i?void 0:i.visible){var x=this._createMark({type:"component",name:"axis-".concat(this.getOrient(),"-grid")},{componentType:"angle"===this.getOrient()?hw.circleAxisGrid:hw.lineAxisGrid,mode:this._spec.mode,noSeparateStyle:!0,skipTheme:!0});x.setZIndex(null!==(s=null!==(o=null===(r=null===(n=this._spec.grid)||void 0===n?void 0:n.style)||void 0===r?void 0:r.zIndex)&&void 0!==o?o:null===(a=this._spec.grid)||void 0===a?void 0:a.zIndex)&&void 0!==s?s:t.LayoutZIndex.Axis_Grid),this._marks.addMark(x),this._gridMark=x}if(S(this._spec.interactive)&&this._marks.forEach((function(t){return t.setInteractive(_._spec.interactive)})),!1!==this._option.animation&&!1!==U(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){var k=aX(null===(l=FU.getAnimationInKey("axis"))||void 0===l?void 0:l(),{appear:null!==(c=null!==(u=this._spec.animationAppear)&&void 0!==u?u:U(this._option.getChart().getSpec(),"animationAppear.axis"))&&void 0!==c?c:U(this._option.getChart().getSpec(),"animationAppear"),disappear:null!==(d=null!==(h=this._spec.animationDisappear)&&void 0!==h?h:U(this._option.getChart().getSpec(),"animationDisappear.axis"))&&void 0!==d?d:U(this._option.getChart().getSpec(),"animationDisappear"),enter:null!==(p=null!==(f=this._spec.animationEnter)&&void 0!==f?f:U(this._option.getChart().getSpec(),"animationEnter.axis"))&&void 0!==p?p:U(this._option.getChart().getSpec(),"animationEnter"),exit:null!==(y=null!==(v=this._spec.animationExit)&&void 0!==v?v:U(this._option.getChart().getSpec(),"animationExit.axis"))&&void 0!==y?y:U(this._option.getChart().getSpec(),"animationExit"),update:null!==(m=null!==(g=this._spec.animationUpdate)&&void 0!==g?g:U(this._option.getChart().getSpec(),"animationUpdate.axis"))&&void 0!==m?m:U(this._option.getChart().getSpec(),"animationUpdate")});k.enter&&(k.update[0].customParameters={enter:k.enter[0]}),this._marks.forEach((function(t){return t.setAnimationConfig(k)}))}}},i.prototype.isSeriesDataEnable=function(){var t=!0;return tw(this._regions,(function(e){var i;B(null===(i=e.getViewDataStatistics())||void 0===i?void 0:i.latestData)&&(t=!1)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),t},i.prototype.setSeriesAndRegionsFromSpec=function(){var t=this._spec,e=t.seriesId,i=t.seriesIndex,n=t.regionId,r=t.regionIndex;T(e)&&(this._seriesUserId=lt(e)),T(n)&&(this._regionUserId=lt(n)),T(i)&&(this._seriesIndex=lt(i)),T(r)&&(this._regionIndex=lt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map((function(t){return t.id}))},i.prototype.getBindSeriesFilter=function(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.scaleUpdate,{filter:function(t){var i=t.model;return(null==i?void 0:i.id)===e.id}},this.effect.scaleUpdate.bind(this));var i=function(t,e){var i,n,r,o,a=[];try{for(var s=u(t),l=s.next();!l.done;l=s.next()){var c=l.value;try{for(var h=(r=void 0,u(c.getSeries(e))),d=h.next();!d.done;d=h.next()){var f=d.value;a.push(f)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(t){i={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a}(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map((function(t){return t.getViewDataStatistics()})).filter((function(t){return!!t}));i.length>1?this._option.dataSet.multipleDataViewAddListener(i,"change",(function(){e.updateScaleDomain()})):1===i.length&&i[0].target.addListener("change",(function(){e.updateScaleDomain()})),tw(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._clearRawDomain()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.updateScaleDomain=function(){},i.prototype._clearRawDomain=function(){},i.prototype.computeData=function(t){!this._tickData||"force"!==t&&nt(this._scale.range(),[0,1])||(this._tickData.getDataView().reRunAllTransform(),this._tickData.updateData())},i.prototype.initScales=function(){this._scales=[this._scale];var t=[];if(tw(this._regions,(function(e){var i=e.getGroups();i&&t.push(i)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length)for(var e=ct(t.map((function(t){return t.fields.length}))),i=1;i<e;i++){var n=this._scale.clone();this._scales.push(n)}},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,(null==i?void 0:i.type)!==(null==t?void 0:t.type)?(n.reMake=!0,n):n},i.prototype.getLabelFormatMethod=function(){var t=this;return this._spec.label.formatMethod?function(e,i,n){return t._spec.label.formatMethod(i.rawValue,i)}:null},i.prototype.getLabelItems=function(t){var e=this;return B(this._tickData.getLatestData())?[this._tickData.getLatestData().map((function(i){return{id:i.value,label:i.value,value:0===t?0:e.dataToPosition([i.value])/t,rawValue:i.value}})).filter((function(t){return t.value>=0&&t.value<=1}))]:[]},i.prototype._delegateAxisContainerEvent=function(t){var e=this;t.addEventListener("*",(function(i,n){return e._delegateEvent(t,i,n)}))},i.prototype._getAxisAttributes=function(){var t,e,i,n,r,a,s,l,u,c,h,d,f=this,p=this._spec,v=p.title.angle;"left"!==p.orient&&"right"!==p.orient||(null===(t=p.title)||void 0===t?void 0:t.autoRotate)&&w(p.title.angle)&&(v="left"===p.orient?-90:90,d=QZ[p.orient]);var y,g=$(p.label,["style","formatMethod","state"]),m=null!==(e=p.background)&&void 0!==e?e:{},_=null!==(i=p.title.background)&&void 0!==i?i:{};return{orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&p.select,hover:!0!==this._option.disableTriggerEvent&&p.hover,line:(y=p.domainLine,(y=LU(y)).startSymbol=LU(y.startSymbol),y.endSymbol=LU(y.endSymbol),y),label:o({style:A(p.label.style)?function(t,e,i,n){var r,o=p.label.style(t.rawValue,e,t,i,n);return DU($W({},null===(r=f._theme.label)||void 0===r?void 0:r.style,o))}:DU(p.label.style),formatMethod:p.label.formatMethod?function(t,e,i){return p.label.formatMethod(e.rawValue,e)}:null,state:IU(p.label.state)},g),tick:!1===p.tick.visible?{visible:!1}:{visible:p.tick.visible,length:p.tick.tickSize,inside:p.tick.inside,alignWithLabel:p.tick.alignWithLabel,style:A(p.tick.style)?function(t,e,i,n){var r,o=p.tick.style(t,e,i,n);return DU($W({},null===(r=f._theme.tick)||void 0===r?void 0:r.style,o))}:DU(p.tick.style),state:OU(p.tick.state),dataFilter:p.tick.dataFilter},subTick:!1===p.subTick.visible?{visible:!1}:{visible:p.subTick.visible,length:p.subTick.tickSize,inside:p.subTick.inside,count:p.subTick.tickCount,style:A(p.subTick.style)?function(t,e,i,n){var r,o=p.subTick.style(t,e,i,n);return DU($W({},null===(r=f._theme.subTick)||void 0===r?void 0:r.style,o))}:DU(p.subTick.style),state:OU(p.subTick.state)},title:!1===p.title.visible?{visible:!1}:o({visible:p.title.visible,position:p.title.position,space:p.title.space,autoRotate:!1,angle:v?ge(v):null,textStyle:$W({},d,DU(p.title.style)),padding:p.title.padding,shape:!1===(null===(n=p.title.shape)||void 0===n?void 0:n.visible)?{visible:!1}:{visible:null===(r=p.title.shape)||void 0===r?void 0:r.visible,space:null===(a=p.title.shape)||void 0===a?void 0:a.space,style:DU(null===(s=p.title.shape)||void 0===s?void 0:s.style)},background:!1===_.visible?{visible:!1}:{visible:_.visible,style:DU(_.style)},state:{text:OU(p.title.state),shape:OU(null===(l=p.title.shape)||void 0===l?void 0:l.state),background:OU(null===(u=p.title.background)||void 0===u?void 0:u.state)},pickable:!1!==(null===(c=p.title.style)||void 0===c?void 0:c.pickable),childrenPickable:!1!==(null===(h=p.title.style)||void 0===h?void 0:h.pickable)},p.title),panel:!1===m.visible?{visible:!1}:{visible:m.visible,style:DU(m.style),state:OU(m.state)}}},i.prototype._getGridAttributes=function(){var t=this,e=this._spec;return{alternateColor:e.grid.alternateColor,alignWithLabel:e.grid.alignWithLabel,style:A(e.grid.style)?function(){return function(i,n){var r,o,a=e.grid.style(null===(r=i.datum)||void 0===r?void 0:r.rawValue,n,i.datum);return DU($W({},null===(o=t._theme.grid)||void 0===o?void 0:o.style,a))}}:DU(e.grid.style),subGrid:!1===e.subGrid.visible?{visible:!1}:{type:"line",visible:e.subGrid.visible,alternateColor:e.subGrid.alternateColor,style:DU(e.subGrid.style)}}},i.prototype._initTickDataSet=function(t){return dY(this._option.dataSet,"scale",q3),hY(this._option.dataSet,"ticks",GA),new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_ticks")}).parse(this._scale,{type:"scale"}).transform({type:"ticks",options:t},!1)},i.prototype._tickTransformOption=function(t){var e=this._tick||{},i=this._spec.label||{},n=e.tickCount,r=e.forceTickCount,o=e.tickStep,a=e.tickMode,s=i.style,l=i.formatMethod,u=i.minGap;return{sampling:!1!==this._spec.sampling,tickCount:n,forceTickCount:r,tickStep:o,tickMode:a,axisOrientType:this._orient,coordinateType:t,labelStyle:s,labelFormatter:l,labelGap:u}},i.prototype.addTransformToTickData=function(t,e){var i,n;null===(n=null===(i=this._tickData)||void 0===i?void 0:i.getDataView())||void 0===n||n.transform(t,e)},i.prototype.dataToPosition=function(t){return this._scale.scale(t)},i.specKey="axes",i}(fq),Q3=function(){gT.registerGraphicComponent(cw.lineAxis,(function(t,e){return new $I(t,e)})),gT.registerGraphicComponent(cw.circleAxis,(function(t){return new oD(t)})),gT.registerComponent(lw.axis,SH),gT.registerGraphicComponent(hw.lineAxisGrid,(function(t,e){return new yD(t,e)})),gT.registerGraphicComponent(hw.circleAxisGrid,(function(t,e){return new _D(t,e)})),gT.registerComponent(lw.grid,CH),Z3(),FU.registerAnimation("axis",(function(){return{appear:{custom:uD},update:{custom:sD},exit:{custom:Sh}}}))},$3=[K3.AxisSyncPlugin],t5=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=f.cartesianAxis,r.name=f.cartesianAxis,r._defaultBandPosition=.5,r._defaultBandInnerPadding=.1,r._defaultBandOuterPadding=.3,r.layoutType="region-relative",r.layoutZIndex=t.LayoutZIndex.Axis,r.layoutLevel=t.LayoutLevel.Axis,r._orient="left",r._autoIndentOnce=!1,r._hasAutoIndent=!1,r._scales=[],r._tick=void 0,r._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},r._innerOffset={top:0,bottom:0,left:0,right:0},r.effect={scaleUpdate:function(t){r.computeData(null==t?void 0:t.value),tw(r._regions,(function(t){var e=r.getOrient();VU(e)?t.setXAxisHelper(r.axisHelper()):GU(e)?t.setYAxisHelper(r.axisHelper()):WU(e)&&t.setZAxisHelper(r.axisHelper())}),{userId:r._seriesUserId,specIndex:r._seriesIndex})}},r._transformLayoutPosition=function(t){var e=t.x,i=t.y;return F(e)&&(e+=Number("left"===r._orient)*r.getLayoutRect().width),F(i)&&(i+=Number("top"===r._orient)*r.getLayoutRect().height),{x:e,y:i}},r._transformLayoutRect=function(t){if(!r._visible)return t;var e=r._latestBounds.clone().translate(-r.getLayoutStartPoint().x,-r.getLayoutStartPoint().y);switch(r._layout.layoutOrient){case"left":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x1<0?-e.x1:0);break;case"right":0===r._layout.layoutRectLevelMap.width&&(t.width=e.x2>0?e.x2:0);break;case"top":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":0===r._layout.layoutRectLevelMap.height&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),r._layout.setRectInSpec(r._layoutCacheProcessing(t))},r._fixAxisOnZero=function(){var t=r._spec.domainLine,e=t.onZero,i=t.visible;if(r.visible&&e&&!1!==i){var n=r._spec.domainLine,a=n.onZeroAxisId,s=n.onZeroAxisIndex,l=r._option.getComponentsByKey("axes"),u=VU(r.getOrient()),c=function(t){var e;return(u?!VU(t.getOrient()):VU(t.getOrient()))&&gS(t.getScale().type)&&t.getTickData()?null===(e=t.getTickData().getLatestData())||void 0===e?void 0:e.find((function(t){return 0===t.value})):t.getScale().ticks().includes(0)},h=l.filter((function(t){return c(t)}));if(h.length){var d=void 0;if(T(a))d=h.find((function(t){return t.id===a}));else if(T(s)){var f=l[s];c(f)&&(d=f)}else d=h[0];if(d){var p=r._axisMark.getProduct(),v=d.valueToPosition(0);u?p.encode({line:o(o({},r._axisStyle.line),{dy:"bottom"===r._orient?-(d.getScale().range()[0]-v):v})}):p.encode({line:o(o({},r._axisStyle.line),{dx:"left"===r._orient?v:-(d.getScale().range()[1]-v)})})}}}},r._orient=UU(i,["z"]),WU(r._orient)&&(r.layoutType="absolute"),r._dataSet=n.dataSet,r}return r(i,e),i.prototype.getOrient=function(){return this._orient},Object.defineProperty(i.prototype,"autoIndentOnce",{set:function(t){this._autoIndentOnce=t},enumerable:!1,configurable:!0}),i.prototype.getScales=function(){return this._scales},i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i)return null;var n="horizontal"===t.direction;if(!B(i)){if(!eq(i))return null;var r=KU(i,n),o=r.axisType,a=r.componentName;return i.type=o,[{spec:i,specPath:[this.specKey],type:a}]}var s=i.filter((function(t){return"z"===t.orient}))[0],l=!0;if(s){var u=i.filter((function(t){return"bottom"===t.orient}))[0],c=i.filter((function(t){return GU(t.orient)}))[0];l=3===i.length&&u&&c}var h=i.map((function(t,e){return{spec:t,index:e}}));l||(h=h.filter((function(t){return"z"!==t.spec.orient})));var d=[];return h.forEach((function(t){var i=t.spec,r=t.index;if(eq(i)){var o=KU(i,n),a=o.axisType,s=o.componentName;i.type=a,d.push({spec:i,specIndex:r,specPath:[e.specKey,r],type:s})}})),d},i.createComponent=function(t,e){var i=t.spec,n=a(t,["spec"]),r=FU.getComponentInKey(n.type);return r?new r(i,o(o({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient},i.prototype.setLayout3dBox=function(t){this.layout3dBox=t},i.prototype.updateScaleRange=function(){var t=!1,e=this.getLayoutRect(),i=e.width,n=e.height,r=this._innerOffset,o=r.left,a=r.right,s=r.top,l=r.bottom,u=[];VU(this.getOrient())?F(i)&&(u=this._inverse?[i-a,o]:[o,i-a]):WU(this.getOrient())?F(i)&&(u=this._inverse?[i-a,o]:[o,i-a],this._scale.range(u)):F(n)&&(u=this._inverse?[s,n-l]:[n-l,s]);var h=c(this._scale.range(),2),d=h[0],f=h[1];return u[0]===d&&u[1]===f||(t=!0,this._scale.range(u)),t},i.prototype.init=function(t){var i,n=this;e.prototype.init.call(this,t),null===(i=this.pluginService)||void 0===i||i.load($3.map((function(t){return new t}))),this.callPlugin((function(t){n.pluginService&&t.onInit&&t.onInit(n.pluginService,n)}))},i.prototype.setAttrFromSpec=function(){var t;if(e.prototype.setAttrFromSpec.call(this),this.visible){VU(this.getOrient())?R(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):R(this._spec.maxWidth)&&(this._spec.maxWidth="30%");var i=this._getAxisAttributes();i.label.formatMethod=this.getLabelFormatMethod(),i.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=i}this._tick=this._spec.tick;var n=null===(t=this._option.getChart())||void 0===t?void 0:t.getSpec();this._inverse=function(t,e){var i=t.inverse;return e&&!VU(t.orient)&&(i=!T(t.inverse)||!t.inverse),i}(this._spec,"horizontal"===(null==n?void 0:n.direction))},i.prototype.onLayoutStart=function(t,i,n){var r=this;if(e.prototype.onLayoutStart.call(this,t,i,n),!WU(this.getOrient())&&this._spec.innerOffset){var o=this._spec;GU(this.getOrient())?["top","bottom"].forEach((function(t){r._innerOffset[t]=cW(o.innerOffset[t],i.height,i)})):["left","right"].forEach((function(t){r._innerOffset[t]=cW(o.innerOffset[t],i.width,i)}))}},i.prototype.getSeriesStatisticsField=function(t){var e;return e=VU(this.getOrient())?t.fieldX:WU(this.getOrient())?t.fieldZ:t.fieldY,gS(this._scale.type)?e:[e[0]]},i.prototype._tickTransformOption=function(t){var i,n;return o(o({},e.prototype._tickTransformOption.call(this,t)),{noDecimals:this._tick.noDecimals,labelLastVisible:null===(i=this._spec.label)||void 0===i?void 0:i.lastVisible,labelFlush:null===(n=this._spec.label)||void 0===n?void 0:n.flush})},i.prototype._initData=function(){var t=this._initTickDataSet(this._tickTransformOption("cartesian"));t.target.addListener("change",this._forceLayout.bind(this)),this._tickData=new dK(this._option,t)},i.prototype.axisHelper=function(){var t=this;return{isContinuous:gS(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:function(e){return void 0===e&&(e=0),t._scales[e]},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return!0===t._inverse}}},i.prototype.afterCompile=function(){var e,i=this,n=null===(e=this._axisMark)||void 0===e?void 0:e.getProduct();n&&n.addEventListener(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_ENCODE,(function(){if(!1===i._isLayout&&(VU(i.getOrient())?i.callPlugin((function(t){i.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(i.pluginService,i)})):i.callPlugin((function(t){i.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(i.pluginService,i)})),i._delegateAxisContainerEvent(n.getGroupGraphicItem()),i._unitText)){var t=n.graphicItem.AABBBounds,e=VU(i._orient)?{x:t.x2,y:i.getLayoutStartPoint().y}:{x:i.getLayoutStartPoint().x,y:t.y1};i._unitText.setAttributes(e)}})),this.callPlugin((function(t){i.pluginService&&t.onDidCompile&&t.onDidCompile(i.pluginService,i)}))},i.prototype.onLayoutEnd=function(i){this.updateScaleRange()?this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"range"}):this.updateSeriesScale(),e.prototype.onLayoutEnd.call(this,i)},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype.update=function(t){},i.prototype.resize=function(t){},i.prototype.collectScale=function(){var t=this,e=[];return tw(this._regions,(function(i){e.push("left"===t.getOrient()||"right"===t.getOrient()?i.scaleY:i.scaleX)}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),e},i.prototype.collectData=function(t,e){var i=this,n=[];return tw(this._regions,(function(r){var o,a,s,l;if(l=t>0?null===(a=null===(o=r.getGroups())||void 0===o?void 0:o.fields)||void 0===a?void 0:a[t]:VU(i.getOrient())?r.fieldX2?h(h([],c(r.fieldX),!1),[r.fieldX2],!1):r.fieldX:WU(i.getOrient())?r.fieldZ:r.fieldY,l=B(l)?gS(i._scale.type)?l:[l[0]]:[l],t||(i._dataFieldText=r.getFieldAlias(l[0])),l){var u=r.getViewData();if(e)l.forEach((function(t){n.push(r.getRawDataStatisticsByField(t,!1))}));else if(u&&u.latestData&&u.latestData.length){var d=null===(s=r.getViewDataStatistics)||void 0===s?void 0:s.call(r);l.forEach((function(t){var e;(null===(e=null==d?void 0:d.latestData)||void 0===e?void 0:e[t])&&n.push(d.latestData[t])}))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),n},i.prototype.updateSeriesScale=function(){var t=this,e=this.getOrient();tw(this._regions,(function(i){VU(e)?(i.setScaleX(t._scale),i.setXAxisHelper(t.axisHelper())):GU(e)?(i.setScaleY(t._scale),i.setYAxisHelper(t.axisHelper())):WU(e)&&(i.setScaleZ(t._scale),i.setZAxisHelper(t.axisHelper()))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getBoundsInRect=function(t){var e=this,i={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return i;this._verticalLimitSize=VU(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&B(this._tickData.getLatestData())||this.computeData("range");var n={skipLayout:!1},r=VU(this.getOrient());this.pluginService&&(r?this.callPlugin((function(t){t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(e.pluginService,n,e)})):this.callPlugin((function(t){t.onWillLayoutVertical&&t.onWillLayoutVertical(e.pluginService,n,e)})));var a=this._axisMark.getProduct(),s=this._getUpdateAttribute(!0),l=a.getGroupGraphicItem(),u=$W(o({},this.getLayoutStartPoint()),this._axisStyle,s,{line:{visible:!1}}),c=l.getBoundsWithoutRender(u);return!0,this._latestBounds=c,isFinite(c.width())&&(i=this._appendAxisUnit(c,r)),i},i.prototype.updateLayoutAttribute=function(){if(this.visible){var t=this.getLayoutStartPoint(),i=this._getUpdateAttribute(!1),n=i.grid,r=a(i,["grid"]),o=this._axisMark.getProduct(),s=$W({x:t.x,y:t.y},this._axisStyle,r);if(o.encode(s),this._gridMark)this._gridMark.getProduct().encode($W({x:t.x,y:t.y},this._getGridAttributes(),n));e.prototype.updateLayoutAttribute.call(this)}},i.prototype._getTitleLimit=function(t){var e,i,n,r,o;if(this._spec.title.visible&&w(null===(e=this._spec.title.style)||void 0===e?void 0:e.maxLineWidth)){var a=null!==(o=null!==(n=null===(i=this._axisStyle.title)||void 0===i?void 0:i.angle)&&void 0!==n?n:null===(r=this._spec.title.style)||void 0===r?void 0:r.angle)&&void 0!==o?o:0;if(t){var s=this.getLayoutRect().width,l=Math.abs(Math.cos(a));return l<1e-6?1/0:s/l}var u=this.getLayoutRect().height,c=Math.abs(Math.sin(a));return c<1e-6?1/0:u/c}return null},i.prototype._getUpdateAttribute=function(t){var e,i=0,n=0;if(!t){for(var r=this.getRegions(),o=r[0].getLayoutStartPoint(),a=o.x,s=o.y,l=a+r[0].getLayoutRect().width,u=s+r[0].getLayoutRect().height,c=1;c<r.length;c++){var h=r[c],d=h.getLayoutStartPoint(),f=d.x,p=d.y,v=h.getLayoutRect(),y=v.width,g=v.height;a=Math.min(a,f),l=Math.max(l,y+f),s=Math.min(s,p),u=Math.max(u,g+p)}i=Math.abs(u-s),n=Math.abs(l-a)}var m=this.getLayoutRect(),_=m.width,b=m.height,x=VU(this._orient),k=GU(this._orient),S=WU(this._orient),A={x:0,y:0},w=0,T=0,M=this.layout3dBox?this.layout3dBox.length:0;if(x?(A={x:_,y:0},w=i,T=_):k&&(A={x:0,y:b},w=n,T=b),S){var C=null!==(e=this.directionStr)&&void 0!==e?e:"r2l",E=this.layout3dBox?this.layout3dBox.width:0,R=[0,0],P=-Math.PI/2,B=0;"l2r"===C&&(B=this.layout3dBox.length,R=[0,0,0],P=Math.PI/2);var L=this.getLabelItems(_),O={start:{x:0,y:0},end:{x:M,y:0},z:B,alpha:P,anchor3d:R,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(x)},items:L};return t||(O.grid={type:"line",start:{x:0,y:0},end:{x:M,y:0},items:L[0],verticalFactor:this._axisStyle.verticalFactor,depth:E,length:i,z:B,alpha:P,anchor3d:R}),O}var I=x?this.layout.minHeight:this.layout.minWidth;(x&&9===this._layout.layoutRectLevelMap.height||k&&9===this._layout.layoutRectLevelMap.width)&&(I=this._verticalLimitSize);var D=this.getLabelItems(T),F={start:{x:0,y:0},end:A,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(x)},items:D,verticalLimitSize:this._verticalLimitSize,verticalMinSize:I};return t||(F.grid={type:"line",start:{x:0,y:0},end:A,items:D[0],verticalFactor:this._axisStyle.verticalFactor,depth:M,length:w}),F},i.prototype.initEvent=function(){var i=this;e.prototype.initEvent.call(this),this.visible&&(this.event.on(t.ChartEvent.layoutEnd,this._fixAxisOnZero),this.event.on(t.ChartEvent.layoutRectUpdate,(function(){i._clearLayoutCache()})))},i.prototype._layoutCacheProcessing=function(t){var e=this;return["width","height"].forEach((function(i){t[i]<e._layoutCache[i]?t[i]=e._layoutCache[i]:e._layoutCache[i]=t[i]})),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]})):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach((function(t){e.layout.getLastComputeOutBounds()[t]<e._layoutCache._lastComputeOutBounds[t]?e.layout.getLastComputeOutBounds()[t]=e._layoutCache._lastComputeOutBounds[t]:e._layoutCache._lastComputeOutBounds[t]=e.layout.getLastComputeOutBounds()[t]}))),t},i.prototype._clearLayoutCache=function(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}},i.prototype.onDataUpdate=function(){this._clearLayoutCache()},i.prototype._appendAxisUnit=function(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){var n=this._spec.unit,r=n.text,a=n.style,s=void 0,l=void 0;e?(s={x:t.x2,y:this.getLayoutStartPoint().y},l={textAlign:"left",textBaseline:"middle"}):(s={x:this.getLayoutStartPoint().x,y:t.y1},l={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),l=o(o(o({},l),a),{x:s.x,y:s.y,text:r}),this._unitText?this._unitText.setAttributes(l):(this._unitText=np(l),this._unitText.name="axis-unit",null===(i=this.getContainer())||void 0===i||i.add(this._unitText));var u=this._unitText.AABBBounds;e?(t.x2+=u.x2>t.x2?u.x2-t.x2:0,t.y2+=u.y2>t.y2?u.y2-t.y2:0):(t.x1+=u.x1<t.x1?u.x1-t.x1:0,t.y1+=u.y1<t.y1?u.y1-t.y1:0)}return t},i.prototype._getNeedClearVRenderComponents=function(){return this._unitText?[this._unitText]:[]},i.type=f.cartesianAxis,i.specKey="axes",i}(J3),e5=Math.sqrt(50),i5=Math.sqrt(10),n5=Math.sqrt(2),r5=function(){function e(){this._extend={}}return e.prototype.setExtraAttrFromSpec=function(){T(this._spec.nice)&&(this._nice=this._spec.nice),T(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=tq(this._spec)},e.prototype.transformScaleDomain=function(){this.setScaleNice()},e.prototype.setLinearScaleNice=function(){var t,e=5,i=this._spec.tick||{};if(F(i.forceTickCount))e=i.forceTickCount;else if(A(i.tickCount)){var n=this._scale.range(),r=Math.abs(n[n.length-1]-n[0]);if(1===r&&this._option)r=VU(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height;e=i.tickCount({rangeSize:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=F(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));var o=null!==(t=this._domain)&&void 0!==t?t:{},a=o.min,s=o.max;w(a)&&w(s)?this._nice&&this._scale.nice(e):T(a)&&w(s)?this._nice&&this._scale.niceMax(e):w(a)&&T(s)&&this._nice&&this._scale.niceMin(e)},e.prototype.setLogScaleNice=function(){var t,e=null!==(t=this._domain)&&void 0!==t?t:{},i=e.min,n=e.max;w(i)&&w(n)?this._nice&&this._scale.nice():T(i)&&w(n)?this._nice&&this._scale.niceMax():w(i)&&T(n)&&this._nice&&this._scale.niceMin()},e.prototype.setScaleNice=function(){"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()},e.prototype.dataToPosition=function(t,e){return this.valueToPosition(t[0])},e.prototype.valueToPosition=function(t){return"log"!==this._spec.type||w(t)||0!==t&&0!==t[0]?this._scale.scale(t):this._scale.range()[0]},e.prototype.computeLinearDomain=function(t){var e=[];return t.length?t.forEach((function(t){var i=t.min,n=t.max;e[0]=void 0===e[0]?i:Math.min(e[0],i),e[1]=void 0===e[1]?n:Math.max(e[1],n)})):(e[0]=0,e[1]=0),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e},e.prototype.expandDomain=function(t){if(this._expand){var e=t[0],i=t[t.length-1];e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),T(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),T(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}},e.prototype.niceDomain=function(t){var e=tq(this._spec),i=e.min,n=e.max;if(T(i)||T(n)||"linear"!==this._spec.type)return t;if(Math.abs(ht(t)-ct(t))<=1e-12){var r=t[0],o=r>=0?1:-1;if((r=Math.abs(r))<1)t[0]=0,t[1]=1;else{var a=r/5,s=Math.floor(Math.log(a)/Math.LN10),l=a/Math.pow(10,s);a=(l>=e5?10:l>=i5?5:l>=n5?2:1)*Math.pow(10,s),t[0]=0,t[1]=10*a}o<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t},e.prototype.includeZero=function(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))},e.prototype.setExtendDomain=function(e,i){if(void 0!==i){this._extend[e]=i;var n=this._scale.domain();this.extendDomain(n),this.includeZero(n),this.setDomainMinMax(n),this.niceDomain(n),this._scale.domain(n,this._nice),this.setScaleNice(),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}else delete this._extend[e]},e.prototype.extendDomain=function(t){var e,i=t.length-1,n=t[0]-t[i]>0,r=n?i:0,o=n?0:i;for(var a in this._extend)(e=this._extend[a])>t[o]&&(t[o]=e),e<t[r]&&(t[r]=e)},e.prototype.getDomainSpec=function(){return this._domain},e.prototype.setDomainMinMax=function(t){if(this._domain){var e=this._domain,i=e.min,n=e.max;T(i)&&(t[0]=i),T(n)&&(t[1]=n)}},e.prototype.setZero=function(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())},e.prototype.updateScaleDomain=function(){if(this.isSeriesDataEnable()){var t=this.collectData(),e=this.computeDomain(t);this.updateScaleDomainByModel(e)}},e.prototype.updateScaleDomainByModel=function(e){e=null!=e?e:this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this._nice),this.setScaleNice(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})},e}(),o5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.cartesianLinearAxis,e._zero=!0,e._nice=!0,e._extend={},e._scale=new pA,e}return r(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec()},e.prototype.initScales=function(){var e,i;t.prototype.initScales.call(this);var n=[0,1];T(null===(e=this._domain)||void 0===e?void 0:e.min)&&(n[0]=this._domain.min),T(null===(i=this._domain)||void 0===i?void 0:i.max)&&(n[1]=this._domain.max),this._scale.domain(n)},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return e.setExtendDomain=this.setExtendDomain.bind(this),e.valueToPosition=this.valueToPosition.bind(this),e},e.type=f.cartesianLinearAxis,e.specKey="axes",e}(t5);ot(o5,r5);var a5=function(){Q3(),FU.registerComponent(o5.type,o5)},s5=function(){function e(){this._rawDomainIndex=[]}return e.prototype.dataToPosition=function(t,e){var i,n;if(void 0===e&&(e={}),0===t.length||0===this._scales.length)return 0;var r=this.getPosition(t);return r.position+r.bandScale.bandwidth()*(null!==(n=null!==(i=e.bandPosition)&&void 0!==i?i:this._spec.bandPosition)&&void 0!==n?n:this._defaultBandPosition)},e.prototype.valueToPosition=function(t){return this._scale.scale(t)},e.prototype.updateGroupScaleRange=function(){var t=this._scale;this._scales.forEach((function(e,i){i>0&&(e.range([0,t.bandwidth()]),t=e)}))},e.prototype.getPosition=function(t){var e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{for(var n=Math.min(t.length,this._scales.length),r=0;r<n;r++)e+=this._scales[r].scale(t[r]);i=this._scales[n-1]}return{position:e,bandScale:i}},e.prototype.calcScales=function(t,e){for(var i,n,r=this._spec,o=r.bandPadding,a=r.paddingInner,s=r.paddingOuter,l=B(o),u=B(a),c=B(s),h=0;h<this._scales.length;h++){var d=l?o[h]:o,f=u?a[h]:a,p=c?s[h]:s;this._scales[h].paddingInner(null!==(i=null!=f?f:d)&&void 0!==i?i:t,!0).paddingOuter(null!==(n=null!=p?p:d)&&void 0!==n?n:e,!0)}},e.prototype.computeBandDomain=function(t){if(!t.length)return[];if(1===t.length)return t[0].values;for(var e=new Set,i=0;i<t.length;i++)for(var n=0;n<t[i].values.length;n++)e.add(t[i].values[n]);return Array.from(e)},e.prototype.updateScaleDomain=function(){var e,i=this;if(this.isSeriesDataEnable()){!(null===(e=this._rawDomainIndex)||void 0===e?void 0:e.length)&&this._scales.length&&this._updateRawDomain();for(var n=this._spec.domain,r=function(t){if(n&&n.length&&0===t)o._scales[t].domain(n);else{var e=o.collectData(t),r=o.computeDomain(e);o._scales[t].domain(r.sort((function(e,n){return i._rawDomainIndex[t][e]-i._rawDomainIndex[t][n]})))}},o=this,a=0;a<this._scales.length;a++)r(a);this.transformScaleDomain(),this.event.emit(t.ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"domain"})}},e.prototype._updateRawDomain=function(){var t=this;this._rawDomainIndex=[];for(var e=this._spec.domain,i=function(i){if(e&&e.length&&0===i)n._scales[i].domain(e);else{var r=n.collectData(i,!0),o=n.computeDomain(r);n._rawDomainIndex[i]={},o.forEach((function(e,n){return t._rawDomainIndex[i][e]=n}))}},n=this,r=0;r<this._scales.length;r++)i(r)},e.prototype._clearRawDomain=function(){this._rawDomainIndex=[]},e}(),l5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.cartesianBandAxis,e._scale=new YS,e}return r(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.axisHelper=function(){var t=this,e=function(e){return t._scales[e]};return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:e,getBandwidth:function(t){return e(t).bandwidth()},getAxisType:function(){return t.type},getAxisId:function(){return t.id},isInverse:function(){return t._inverse}}},e.prototype.transformScaleDomain=function(){this.updateFixedWholeLength()},e.prototype.updateFixedWholeLength=function(){var t;if(this._scale&&(this._spec.bandSize&&this._scale.bandwidth(this._spec.bandSize),this._spec.maxBandSize&&this._scale.maxBandwidth(this._spec.maxBandSize),this._spec.minBandSize&&this._scale.minBandwidth(this._spec.minBandSize),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(this._spec.bandSize||this._spec.maxBandSize))){var e=LS(this._scale.domain().length,null!==(t=this._spec.bandSize)&&void 0!==t?t:this._spec.maxBandSize,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach((function(t){return t.setMaxWidth(e)})):["left","right"].includes(this._orient)&&this._regions.forEach((function(t){return t.setMaxHeight(e)}))}},e.type=f.cartesianBandAxis,e.specKey="axes",e}(t5);ot(l5,s5);var u5=function(){Q3(),FU.registerComponent(l5.type,l5)},c5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.cartesianTimeAxis,e._zero=!1,e.effect={scaleUpdate:function(t){e.computeData(null==t?void 0:t.value),tw(e._regions,(function(t){VU(e.getOrient())?t.setXAxisHelper(e.axisHelper()):t.setYAxisHelper(e.axisHelper())}),{userId:e._seriesUserId,specIndex:e._seriesIndex})}},e}return r(e,t),e.prototype.setAttrFromSpec=function(){var e;t.prototype.setAttrFromSpec.call(this),this._tick=$W({},this._spec.tick,null===(e=this._spec.layers)||void 0===e?void 0:e[0])},e.prototype._initData=function(){var e;if(t.prototype._initData.call(this),null===(e=this._spec.layers)||void 0===e?void 0:e[1]){var i=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_layer_1_ticks")}).parse(this._scale,{type:"scale"}).transform({type:"ticks",options:o(o({},this._tickTransformOption("cartesian")),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new dK(this._option,i)}},e.prototype.computeData=function(e){t.prototype.computeData.call(this,e),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())},e.prototype.getLabelFormatMethod=function(){var t,e,i,n,r,o,a,s,l=this,u=Ca.getInstance(),c=(null===(e=null===(t=this._spec.layers)||void 0===t?void 0:t[1])||void 0===e?void 0:e.timeFormat)||"%Y%m%d",h="local"===((null===(n=null===(i=this._spec.layers)||void 0===i?void 0:i[1])||void 0===n?void 0:n.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat,d=(null===(o=null===(r=this._spec.layers)||void 0===r?void 0:r[0])||void 0===o?void 0:o.timeFormat)||"%Y%m%d",f="local"===((null===(s=null===(a=this._spec.layers)||void 0===a?void 0:a[0])||void 0===s?void 0:s.timeFormatMode)||"local")?u.timeFormat:u.timeUTCFormat;return function(t,e,i,n,r){var o,a;return a=0===r?f(d,t):h(c,t),(null===(o=l._spec.label)||void 0===o?void 0:o.formatMethod)?l._spec.label.formatMethod(a,e):a}},e.prototype.getLabelItems=function(t){var e=this,i=[];return B(this._tickData.getLatestData())&&i.push(this._tickData.getLatestData().map((function(i){return{id:i.value,label:i.value,value:0===t?0:e.dataToPosition([i.value])/t,rawValue:i.value}}))),this._layerTickData&&B(this._layerTickData.getLatestData())&&i.push(this._layerTickData.getLatestData().map((function(i){var n=e.dataToPosition([i.value]);return{id:i.value,label:i.value,value:n/t,rawValue:i.value}}))),i},e.prototype.transformScaleDomain=function(){},e.type=f.cartesianTimeAxis,e.specKey="axes",e}(o5),h5=function(){Q3(),FU.registerComponent(c5.type,c5)},d5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.cartesianLogAxis,e._zero=!1,e._scale=new mA,e}return r(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.base(null!==(e=this._spec.base)&&void 0!==e?e:10)},e.prototype.transformScaleDomain=function(){},e.type=f.cartesianLogAxis,e.specKey="axes",e}(o5);ot(d5,r5);var f5=function(){Q3(),FU.registerComponent(d5.type,d5)},p5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.cartesianSymlogAxis,e._zero=!1,e._scale=new AA,e}return r(e,t),e.prototype.initScales=function(){var e;t.prototype.initScales.call(this),this._scale.constant(null!==(e=this._spec.constant)&&void 0!==e?e:10)},e.prototype.transformScaleDomain=function(){},e.type=f.cartesianSymlogAxis,e.specKey="axes",e}(o5);ot(p5,r5);var v5=function(){Q3(),FU.registerComponent(p5.type,p5)},y5=function(t){var e,i=null!==(e=t.type)&&void 0!==e?e:"angle"===t.orient?"band":"linear";return{axisType:i,componentName:"".concat(f.polarAxis,"-").concat(i)}},g5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.polarAxis,i.name=f.polarAxis,i._defaultBandPosition=0,i._defaultBandInnerPadding=0,i._defaultBandOuterPadding=0,i.layoutType="absolute",i.layoutZIndex=t.LayoutZIndex.Axis,i._tick=void 0,i._center=null,i._startAngle=Fw,i._endAngle=zw,i._orient="radius",i._groupScales=[],i.effect={scaleUpdate:function(t){i.computeData(null==t?void 0:t.value),tw(i._regions,(function(t){"radius"===i.getOrient()?t.radiusAxisHelper=i.axisHelper():t.angleAxisHelper=i.axisHelper()}),{userId:i._seriesUserId,specIndex:i._seriesIndex})}},i._transformLayoutPosition=function(t){var e,n=null===(e=i.getRegions())||void 0===e?void 0:e[0];return n?n.getLayoutStartPoint():t},i}return r(i,e),Object.defineProperty(i.prototype,"center",{get:function(){return this._center},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._startAngle},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"endAngle",{get:function(){return this._endAngle},enumerable:!1,configurable:!0}),i.prototype.getOrient=function(){return this._orient},i.prototype.getGroupScales=function(){return this._groupScales},i.getSpecInfo=function(t){var e,i,n=this,r=t[this.specKey];if(!r)return null;if(!B(r)){if(!iq(r))return null;var o=y5(r),a=o.axisType,s=o.componentName;return r.center=t.center,r.startAngle=null!==(e=t.startAngle)&&void 0!==e?e:jw,r.endAngle=null!==(i=t.endAngle)&&void 0!==i?i:T(t.startAngle)?t.startAngle+360:Hw,r.type=a,[{spec:r,specPath:[this.specKey],type:s}]}var l,u=[],c=[];return r.forEach((function(e,i){var r,o,a,s,h;if(iq(e)){var d=y5(e),f=d.axisType,p=d.componentName;e.center=t.center,e.startAngle=null!==(r=t.startAngle)&&void 0!==r?r:jw,e.endAngle=null!==(o=t.endAngle)&&void 0!==o?o:T(t.startAngle)?t.startAngle+360:Hw,e.outerRadius=null!==(h=null!==(s=null!==(a=e.radius)&&void 0!==a?a:t.outerRadius)&&void 0!==s?s:t.radius)&&void 0!==h?h:Nw,e.type=f;var v={spec:e,specIndex:i,specPath:[n.specKey,i],type:p};u.push(v),"radius"===e.orient?c.push(v):l=i}})),c.forEach((function(t){t.angleAxisIndex=l})),u},i.createComponent=function(t,e){var i=t.spec,n=a(t,["spec"]),r=FU.getComponentInKey(n.type);return r?new r(i,o(o({},e),n)):(e.onError("Component ".concat(n.type," not found")),null)},i.prototype.setAttrFromSpec=function(){var t,i;e.prototype.setAttrFromSpec.call(this),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center;var n=this.getChart().getSpec(),r=null!==(t=this._spec.startAngle)&&void 0!==t?t:n.startAngle,o=null!==(i=this._spec.endAngle)&&void 0!==i?i:n.endAngle;this._startAngle=ge(null!=r?r:jw),this._endAngle=ge(null!=o?o:T(r)?r+360:Hw),this._inverse=this._spec.inverse},i.prototype.onLayoutEnd=function(i){this.updateScaleRange()&&(this.updateSeriesScale(),this.event.emit(t.ChartEvent.scaleUpdate,{model:this,value:"range"})),e.prototype.onLayoutEnd.call(this,i)},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(){},i.prototype._initData=function(){var t=this._initTickDataSet(this._tickTransformOption("polar"));t.target.addListener("change",this._forceLayout.bind(this)),this._tickData=new dK(this._option,t)},i.prototype._tickTransformOption=function(t){var i=this;return o(o({},e.prototype._tickTransformOption.call(this,t)),{noDecimal:this._tick.noDecimals,startAngle:this.startAngle,labelOffset:$Z(this._spec),getRadius:function(){return i.getOuterRadius()}})},i.prototype.afterCompile=function(){var e,i=this,n=null===(e=this._axisMark)||void 0===e?void 0:e.getProduct();n&&n.addEventListener(t.VGRAMMAR_HOOK_EVENT.AFTER_ELEMENT_ENCODE,(function(){!1===i._isLayout&&i._delegateAxisContainerEvent(n.getGroupGraphicItem())}))},i.prototype.updateScaleRange=function(){var t,e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)},i.prototype.collectData=function(t,e){var i=this,n=[];return tw(this._regions,(function(r){var o,a,s,l;if(l=t>0?null===(a=null===(o=r.getGroups())||void 0===o?void 0:o.fields)||void 0===a?void 0:a[t]:"radius"===i.getOrient()?r.getRadiusField():r.getAngleField(),l=B(l)?gS(i._scale.type)?l:[l[0]]:[l],t||(i._dataFieldText=r.getFieldAlias(l[0])),l){var u=r.getViewData();if(e)l.forEach((function(t){n.push(r.getRawDataStatisticsByField(t,!1))}));else if(u&&u.latestData&&u.latestData.length){var c=null===(s=r.getViewDataStatistics)||void 0===s?void 0:s.call(r);l.forEach((function(t){var e;(null===(e=null==c?void 0:c.latestData)||void 0===e?void 0:e[t])&&n.push(c.latestData[t])}))}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),n},i.prototype.updateSeriesScale=function(){var t=this;tw(this._regions,(function(e){"radius"===t.getOrient()?(e.setRadiusScale(t._scale),e.radiusAxisHelper=t.axisHelper()):(e.setAngleScale(t._scale),e.angleAxisHelper=t.axisHelper())}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.getSeriesStatisticsField=function(t){var e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return gS(this._scale.type)?e:[e[0]]},i.prototype.initGroupScales=function(){},i.prototype.axisHelper=function(){var t=this;return{isContinuous:gS(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),getScale:function(e){return t._scales[e]},getAxisId:function(){return t.id}}},i.prototype.positionToData=function(t){var e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)},i.prototype.coordToPoint=function(t){var e=t.angle,i=this.getCenter(),n=i.x,r=i.y,o=YA({angle:e,radius:t.radius});return{x:o.x+n,y:o.y+r}},i.prototype.pointToCoord=function(t){var e=this.getCenter(),i=e.x,n=e.y,r=t.x-i,o=t.y-n,a=this._startAngle,s=this._endAngle,l=Math.sqrt(r*r+o*o);r/=l,o/=l;var u=Math.atan2(o,r);if(u<a)for(;u<=a;)u+=2*Math.PI;if(u>s)for(;u>=s;)u-=2*Math.PI;return{radius:l,angle:u}},i.prototype.getCenter=function(){var t,e;return{x:(null===(t=this._center)||void 0===t?void 0:t.x)||this.getRefLayoutRect().width/2,y:(null===(e=this._center)||void 0===e?void 0:e.y)||this.getRefLayoutRect().height/2}},i.prototype.getOuterRadius=function(){return this.computeLayoutOuterRadius()},i.prototype.getInnerRadius=function(){return this.computeLayoutInnerRadius()},i.prototype.tickValues=function(){if(this._tickData){var t=this._tickData.getLatestData();if(!t||B(t))return t||[];this.computeData("force")}return this._scale.ticks()},i.prototype.updateLayoutAttribute=function(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),e.prototype.updateLayoutAttribute.call(this)},i.prototype._layoutAngleAxis=function(){var t=this,e=this.getCenter(),i=this.computeLayoutOuterRadius(),n=this.computeLayoutInnerRadius(),r=this._endAngle-this._startAngle,a=B(this._tickData.getLatestData())?this._tickData.getLatestData().map((function(e){var i=t.dataToPosition([e.value]);return{id:e.value,label:e.value,value:(i-t._startAngle)/r,rawValue:e.value}})):[],s=o(o({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:e,radius:i,innerRadius:n,startAngle:this._startAngle,endAngle:this._endAngle}),l=o(o({},s),{title:{text:this._spec.title.text||this._dataFieldText},items:a.length?[a]:[],orient:"angle"});this._spec.grid.visible&&(l.grid=o({type:"line",smoothLink:!0,items:a},s)),this._update(l)},i.prototype._layoutRadiusAxis=function(){var t,e,i,n=this,r=this.getCenter(),a=this.computeLayoutOuterRadius(),s=this.computeLayoutInnerRadius(),l=this.coordToPoint({angle:this._startAngle,radius:a}),u=this.coordToPoint({angle:this._startAngle,radius:s}),c=se.distancePP(u,l),h=B(this._tickData.getLatestData())?this._tickData.getLatestData().map((function(t){var e=n.dataToPosition([t.value]);return{id:t.value,label:t.value,value:(e-s)/c,rawValue:t.value}})):[],d=o(o({},this.getLayoutStartPoint()),{start:u,end:l,verticalFactor:-1}),f=o(o({},d),{title:{text:this._spec.title.text||this._dataFieldText},items:h.length?[h]:[],orient:"radius"});(null===(t=this._spec.grid)||void 0===t?void 0:t.visible)&&(f.grid=o({items:h,type:(null===(e=this._spec.grid)||void 0===e?void 0:e.smooth)?"circle":"polygon",center:r,closed:!0,sides:null===(i=this._getRelatedAngleAxis())||void 0===i?void 0:i.tickValues().length,startAngle:this._startAngle,endAngle:this._endAngle},d)),this._update(f)},i.prototype._getRelatedAngleAxis=function(){var t=this._option.angleAxisIndex;if(T(t))return this._option.getComponentByIndex(this.specKey,t)},i.prototype.computeLayoutOuterRadius=function(){var t,e=null!==(t=this._spec.outerRadius)&&void 0!==t?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius,n=this.getRefLayoutRect(),r=n.width,o=n.height;return Math.min(r,o)/2*i},i.prototype.computeLayoutInnerRadius=function(){var t,e=null!==(t=this._spec.innerRadius)&&void 0!==t?t:this.getRefSeriesRadius().innerRadius,i=this.getRefLayoutRect(),n=i.width,r=i.height;return Math.min(n,r)/2*e},i.prototype.getRefLayoutRect=function(){return this.getRegions()[0].getLayoutRect()},i.prototype.getRefSeriesRadius=function(){var e=Nw,i=0,n=this.getChart().getSpec();return tw(this.getRegions(),(function(r){var o,a=r;if(o=a.type,[t.SeriesTypeEnum.rose,t.SeriesTypeEnum.radar,t.SeriesTypeEnum.circularProgress].includes(o)){var s=a.outerRadius,l=void 0===s?n.outerRadius:s,u=a.innerRadius,c=void 0===u?n.innerRadius:u;F(l)&&(e=l),F(c)&&(i=c)}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:e,innerRadius:i}},i.prototype._update=function(t){var e=t.grid,i=a(t,["grid"]);(this._axisMark.getProduct().encode($W({},this._axisStyle,i)),this._gridMark)&&this._gridMark.getProduct().encode($W({},this._gridStyle,e))},i.prototype.invert=function(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){var i=this._scale.range(),n=i[i.length-1]-i[0],r=.5===(null!==(e=this.getSpec().bandPosition)&&void 0!==e?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){var o=(t+r+Math.abs(i[0]))%n-Math.abs(i[0]);return this._scale.invert(o)}return this._scale.invert((t+r)%n)}return this._scale.invert(t)},i.type=f.polarAxis,i.specKey="axes",i}(J3),m5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.polarLinearAxis,e._zero=!0,e._nice=!0,e._scale=new pA,e}return r(e,t),e.prototype.setAttrFromSpec=function(){t.prototype.setAttrFromSpec.call(this),this.setExtraAttrFromSpec()},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.setScaleNice()},e.prototype.computeDomain=function(t){return this.computeLinearDomain(t)},e.type=f.polarLinearAxis,e.specKey="axes",e}(g5);ot(m5,r5);var _5=function(){Q3(),FU.registerComponent(m5.type,m5)},b5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=f.polarBandAxis,e._scale=new YS,e}return r(e,t),e.prototype.computeDomain=function(t){return this.computeBandDomain(t)},e.prototype.updateScaleRange=function(){var e=t.prototype.updateScaleRange.call(this);return this.updateGroupScaleRange(),e},e.prototype.axisHelper=function(){var e=t.prototype.axisHelper.call(this);return o(o({},e),{getBandwidth:function(t){return e.getScale(t).bandwidth()}})},e.prototype.initScales=function(){t.prototype.initScales.call(this),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)},e.prototype.transformScaleDomain=function(){},e.type=f.polarBandAxis,e.specKey="axes",e}(g5);ot(b5,s5);var x5=function(){Q3(),FU.registerComponent(b5.type,b5)};var k5=function(t,e){var i=[],n={},r=e.series,o=e.seriesField;return r().forEach((function(t){var e=o(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach((function(t){n[t.key]||(n[t.key]=!0,i.push(t))}))})),i},S5=function(t,e){var i,n,r,o=e.selected,a=e.field,s=e.data,l=o(),u=s();if(0===l.length&&u.length)return[];if(l.length===u.length)return t;var c={};l.forEach((function(t){c[t]=!0}));var h=null!==(i=a())&&void 0!==i?i:uV;return B(t)&&(null===(n=t[0])||void 0===n?void 0:n.nodes)?(t[0].nodes=t[0].nodes.filter((function(t){return!0===c[t.key]})),(null===(r=t[0])||void 0===r?void 0:r.links)&&(t[0].links=t[0].links.filter((function(t){return!0===c[t.source]&&!0===c[t.target]})))):T(h)&&(t=t.filter((function(t){return!0===c[t[h]]}))),t},A5=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="normal",i.layoutZIndex=t.LayoutZIndex.Legend,i.layoutLevel=t.LayoutLevel.Legend,i.specKey="legends",i._orient="left",i._visible=!0,i._position="middle",i._preSelectedData=[],i._selectedData=[],i.effect={onSelectedDataChange:function(){tw(i._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:i._seriesUserId,specIndex:i._seriesIndex}),tw(i._regions,(function(t){t.reFilterViewData()}),{userId:i._seriesUserId,specIndex:i._seriesIndex})}},i}return r(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),i.prototype.getLegendData=function(){return this._legendData.getLatestData()},i.prototype.getSelectedData=function(){return this._selectedData},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),this._orient=lW(this._spec.orient)?this._spec.orient:"left",this._position=null!==(t=this._spec.position)&&void 0!==t?t:"middle",this._visible=!1!==this._spec.visible;var i=this._spec,n=i.regionId,r=i.regionIndex,o=i.seriesId,a=i.seriesIndex;T(o)&&(this._seriesUserId=lt(o)),T(n)&&(this._regionUserId=lt(n)),T(a)&&(this._seriesIndex=lt(a)),T(r)&&(this._regionUserIndex=lt(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)},i.prototype.created=function(){e.prototype.created.call(this),this.initData()},i.prototype.onRender=function(t){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,(null==t?void 0:t.orient)!==(null==i?void 0:i.orient)?(n.reMake=!0,n):(nt(i,t)||(n.reCompile=!0),n)},i.prototype.changeRegions=function(t){},i.prototype._bindLegendDataChange=function(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData()},i.prototype.initData=function(){var e=this,i=this._initLegendData();i.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new dK(this._option,i),this._initSelectedData(),tw(this._regions,(function(i){i.event.on(t.ChartEvent.rawDataUpdate,{filter:function(t){var e=t.model;return(null==e?void 0:e.id)===i.id}},(function(){e._legendData.getDataView().reRunAllTransform()}))}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype.setSelectedData=function(e){var i,n,r,o=this._selectedData;w(e)||JSON.stringify(o)===JSON.stringify(e)||(this._selectedData=h([],c(e),!1),null===(n=(i=this.effect).onSelectedDataChange)||void 0===n||n.call(i),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this}),null===(r=this._legendComponent)||void 0===r||r.setSelected(this._selectedData))},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),this._legendComponent){var i=t.x,n=t.y;F(i*n)&&this._legendComponent.setAttributes({x:i,y:n})}},i.prototype.getBoundsInRect=function(t,e){var i=this;if(!this._visible)return{x1:0,y1:0,x2:0,y2:0};var n={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)nt(r,this._cacheAttrs)||this._legendComponent.setAttributes($W({},r,{defaultSelected:this._selectedData}));else{var o=new(this._getLegendConstructor())($W({},r,{defaultSelected:this._selectedData}));o.name="legend",this._legendComponent=o,this.getContainer().add(o),this._option.disableTriggerEvent||this._initEvent(),o.on("*",(function(t,e){return i._delegateEvent(i._legendComponent,t,e)}))}this._cacheAttrs=r;var a=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){var l="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",u=this._position,c=e.width,h=e.height,d=0,f=0;"horizontal"===l?"middle"===u?d=(c-a)/2:"end"===u&&(d=c-a):"middle"===u?f=(h-s)/2:"end"===u&&(f=h-s),this._legendComponent.setAttributes({dx:d,dy:f})}return n.x2=n.x1+a,n.y2=n.y1+s,n},i.prototype.onDataUpdate=function(){var e,i;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){var n=this._getLegendAttributes(this.getLayoutRect());nt(n,this._cacheAttrs)||this._legendComponent.setAttributes($W({},n,{defaultSelected:this._selectedData}))}null===(i=(e=this.effect).onSelectedDataChange)||void 0===i||i.call(e),this.event.emit(t.ChartEvent.legendSelectedDataChange,{model:this})}},i.prototype._getNeedClearVRenderComponents=function(){return[this._legendComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null,this._preSelectedData=null},i.specKey="legends",i}(fq),w5=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=f.discreteLegend,t.name=f.discreteLegend,t}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(i){if(!B(i))return i.type&&"discrete"!==i.type?void 0:[{spec:i,specIndex:0,specPath:[this.specKey],type:f.discreteLegend}];var n=[];return i.forEach((function(t,i){t.type&&"discrete"!==t.type||n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.discreteLegend})})),n}},i.prototype.init=function(t){var i=this;e.prototype.init.call(this,t),tw(this._regions,(function(t){t.addViewDataFilter({type:"discreteLegendFilter",options:{selected:function(){return i._selectedData},field:function(){return i._getSeriesLegendField(t)},data:function(){return i._getLegendDefaultData()}},level:mY.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._initLegendData=function(){var t=this;hY(this._option.dataSet,"discreteLegendFilter",S5),hY(this._option.dataSet,"discreteLegendDataMake",k5);var e=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"discreteLegendDataMake",options:{series:function(){var e=[];return tw(t._regions,(function(t){e.push(t)}),{specIndex:t._spec.seriesIndex,userId:t._spec.seriesId}),e},seriesField:function(e){return t._getSeriesLegendField(e)}}}),e},i.prototype._getSeriesLegendField=function(t){var e,i,n=t.getSeriesField();if(!this._spec.scaleName)return n;if(!t.getRawData())return n;var r=this._option.globalScale.getScaleSpec(this._spec.scaleName);if(!r)return n;if(this._spec.field)return this._spec.field;if(!$k(r.domain))return n;var o=r.domain.find((function(e){return e.dataId===t.getRawData().name}));return o&&null!==(i=null===(e=o.fields)||void 0===e?void 0:e[0])&&void 0!==i?i:n},i.prototype._initSelectedData=function(){this._spec.defaultSelected?this._selectedData=h([],c(this._spec.defaultSelected),!1):this._selectedData=this._getLegendDefaultData()},i.prototype._getLegendDefaultData=function(){return A(this._spec.data)?this._getLegendItems().map((function(t){return t.label})):this._legendData.getLatestData().map((function(t){return t.key}))},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&w(t.title.text)&&w(null===(i=t.title.style)||void 0===i?void 0:i.text)){var o=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!o)return;t.title.text=wU(o.getRawData(),o.getSeriesField())}},i.prototype._getLegendAttributes=function(t){var e="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=o(o({layout:e,items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){var i=t.title,n=void 0===i?{}:i,r=t.item,o=void 0===r?{}:r,s=t.pager,l=void 0===s?{}:s,u=t.background,c=void 0===u?{}:u;t.type,t.id,t.visible,t.orient,t.position,t.data,t.filter,t.regionId,t.regionIndex,t.seriesIndex,t.seriesId,t.padding;var h=a(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible&&(h.title=cq(n)),W(o.focusIconStyle)||DU(o.focusIconStyle),o.shape=LU(o.shape),o.label=LU(o.label),o.value=LU(o.value),o.background=LU(o.background),uW(o.maxWidth)&&(o.maxWidth=Number(o.maxWidth.substring(0,o.maxWidth.length-1))*e.width/100),uW(o.width)&&(o.width=Number(o.width.substring(0,o.width.length-1))*e.width/100),uW(o.height)&&(o.height=Number(o.height.substring(0,o.height.length-1))*e.width/100),h.item=o,W(l.textStyle)||DU(l.textStyle),LU(l.handler),h.pager=l,c.visible&&!W(c.style)&&($W(h,c.style),T(c.padding)&&(h.padding=c.padding)),h}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(i),i},i.prototype._getLegendConstructor=function(){return lF},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener(QD.legendItemClick,(function(n){var r=U(n,"detail.currentSelected");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendItemClick,{model:e,value:r,event:n})})),this._legendComponent.addEventListener(QD.legendItemHover,(function(i){var n=U(i,"detail");e.event.emit(t.ChartEvent.legendItemHover,{model:e,value:n,event:i})})),this._legendComponent.addEventListener(QD.legendItemUnHover,(function(i){var n=U(i,"detail");e.event.emit(t.ChartEvent.legendItemUnHover,{model:e,value:n,event:i})}))}},i.prototype._getLegendItems=function(){var t=(this._legendData.getLatestData()||[]).map((function(t){var e,i,n=t.style("fillOpacity"),r=t.style("strokeOpacity"),o=t.style("opacity"),a=t.style("texture");return{label:t.key,shape:{symbolType:null!==(i=null!==(e=t.style("symbolType"))&&void 0!==e?e:t.shapeType)&&void 0!==i?i:"circle",fillOpacity:F(n)?n:1,strokeOpacity:F(r)?r:1,opacity:F(o)?o:1,texturePadding:a?1:null,textureSize:a?4:null,texture:a,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}}));return A(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t},i.specKey="legends",i.type=f.discreteLegend,i}(A5),T5=function(){FU.registerComponent(w5.type,w5)},M5=function(t,e){var i=e.series,n=e.field,r=e.scale,o=n();if(n&&o){var a=Number.MAX_VALUE,s=Number.MIN_VALUE;return i().forEach((function(t){var e=t.getRawDataStatisticsByField(o,!0),i=null==e?void 0:e.min,n=null==e?void 0:e.max;F(i)&&(a=i),F(n)&&(s=n)})),[a,s]}if(r){var l=r();return l?l.domain():[]}return[]},C5=function(t,e){var i=e.selected,n=e.field,r=e.data,o=i(),a=n();if(o===r())return t;if(a&&!W(o)){var s=c(o,2),l=s[0],u=s[1];return t.filter((function(t){return t[a]>=l&&t[a]<=u}))}return t};function E5(t){return"color"===t||"size"===t}var R5={color:pF,size:gF},P5=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],B5=[2,10],L5=function(e){function i(t,i){var n=e.call(this,t,i)||this;n.type=f.colorLegend,n.name=f.colorLegend;var r="color"===n._spec.type?f.colorLegend:f.sizeLegend;return n.type=r,n.name=r,n}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(i){if(!B(i))return E5(i.type)?[{spec:i,specIndex:0,specPath:[this.specKey],type:"color"===i.type?f.colorLegend:f.sizeLegend}]:void 0;var n=[];return i.forEach((function(t,i){E5(t.type)&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:"color"===t.type?f.colorLegend:f.sizeLegend})})),n}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._field=this._spec.field,this._legendType=this._spec.type},i.prototype.init=function(t){var i=this;e.prototype.init.call(this,t),tw(this._regions,(function(t){t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:function(){return i._selectedData},field:function(){return i._field},data:function(){return i._legendData.getLatestData()}},level:mY.legendFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex})},i.prototype._getScaleInGlobal=function(){var t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)},i.prototype._initLegendData=function(){var t=this;hY(this._option.dataSet,"continuousLegendFilter",C5),hY(this._option.dataSet,"continuousLegendDataMake",M5);var e=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});return e.transform({type:"continuousLegendDataMake",options:{series:function(){return t._regions.reduce((function(t,e){return t.push.apply(t,h([],c(e.getSeries()),!1)),t}),[])},field:function(){return t._field},scale:this._getScaleInGlobal.bind(this)}}),e},i.prototype._initSelectedData=function(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()},i.prototype._addDefaultTitleText=function(t){var e,i,n,r;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&w(t.title.text)&&w(null===(i=t.title.style)||void 0===i?void 0:i.text)){var o=this._field;if(o){var a=null===(r=null===(n=this._regions)||void 0===n?void 0:n[0])||void 0===r?void 0:r.getSeries()[0];if(!a)return;return void(t.title.text=wU(a.getRawData(),o))}var s=this._spec.scale;s||(s=this._legendType);var l=this._option.globalScale.getScaleSpec(s);if(!$k(null==l?void 0:l.domain))return;var u=l.domain[0];if(0===u.fields.length)return;t.title.text=wU(this._option.dataSet.getDataView(u.dataId),u.fields[0])}else;},i.prototype._getLegendAttributes=function(t){var e,i,n,r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",s="horizontal"===r?"bottom":this.layoutOrient,l=[],u=this._getScaleInGlobal();u&&"linear"===u.type&&(l=u.range()),W(l)&&(l="color"===this._legendType?P5:B5);var c=null!==(i=this._legendData.getLatestData()[0])&&void 0!==i?i:0,h=null!==(n=this._legendData.getLatestData()[1])&&void 0!==n?n:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(c=Math.min(0,this._legendData.getLatestData()[0]),h=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));var d=o(((e={layout:r,align:s,zIndex:this.layoutZIndex,min:c,max:h,value:this._spec.defaultSelected})["color"===this._legendType?"colors":"sizeRange"]=l,e),function(t){var e=$W({},t),i=e.title,n=void 0===i?{}:i,r=e.handler,o=void 0===r?{}:r,s=e.rail,l=void 0===s?{}:s,u=e.track,c=void 0===u?{}:u,h=e.startText,d=e.endText,f=e.handlerText,p=e.sizeBackground,v=e.background,y=void 0===v?{}:v;e.type,e.id,e.visible,e.orient,e.position,e.data,e.defaultSelected,e.field,e.filter,e.regionId,e.regionIndex,e.seriesIndex,e.seriesId,e.padding;var g=a(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible&&(g.title=cq(n)),g.showHandler=!1!==o.visible,W(o.style)||(g.handlerStyle=DU(o.style)),T(l.width)&&(g.railWidth=l.width),T(l.height)&&(g.railHeight=l.height),W(l.style)||(g.railStyle=DU(l.style)),W(c.style)||(g.trackStyle=DU(c.style)),g.startText=LU(h),g.endText=LU(d),g.handlerText=LU(f),W(p)||(g.sizeBackground=DU(p)),y.visible&&!W(y.style)&&($W(g,y.style),T(y.padding)&&(g.padding=y.padding)),g}(this._spec));return this._addDefaultTitleText(d),d},i.prototype._getLegendConstructor=function(){return R5[this._legendType]},i.prototype._initEvent=function(){var e=this;if(this._legendComponent){var i=!1!==this._spec.filter;this._legendComponent.addEventListener("change",Pt((function(n){var r=U(n,"detail.value");i&&e.setSelectedData(r),e.event.emit(t.ChartEvent.legendFilter,{model:e,value:r,event:n})}),30))}},i.specKey="legends",i.type=f.continuousLegend,i}(A5),O5=function(){FU.registerComponent(L5.type,L5)};var I5=function(t,e,i){return w(t)?t:A(t)?t(e,i):t},D5=function(t,e,i){if(w(t))return t;if(B(t)){var n=[];return t.forEach((function(t){if(A(t)){var r=t(e,i);T(r)&&n.push(r)}else n.push(t)})),n}return A(t)?t(e,i):t};var F5,z5,j5=function(t,e){return t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:e.height/t.offsetHeight):1},H5=function(t,e){var i,n,r;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),n=e.multiLine?(n=t.split("\n")).map((function(t,e){return e<n.length-1?t+"\n":t})):[t],r=n.map((function(t){return o(o({},e),{text:t})}))):(r=t.text,n=t);var a,s=(a={wordBreak:null!==(i=e.wordBreak)&&void 0!==i?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:r},xg||(xg=kg.CreateGraphic("richtext",{})),xg.setAttributes(a),xg.AABBBounds);return{width:s.width(),height:s.height(),text:n}},N5="vchart-tooltip-container",V5={key:"其他",value:"..."},G5={offsetX:10,offsetY:10,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}},W5=function(){function t(){}return t.dom="".concat(bw,"_TOOLTIP_HANDLER_DOM"),t.canvas="".concat(bw,"_TOOLTIP_HANDLER_CANVAS"),t}(),U5=function(t,e){var i;if(T(t))if(I(t))i=t;else if(A(t)){var n=t(e);I(n)&&(i=n)}return i},Y5=((F5={}).left=["left","middle"],F5.right=["right","middle"],F5.inside=["middle","middle"],F5.top=["middle","top"],F5.lt=["left","top"],F5.tl=["left","top"],F5.rt=["right","top"],F5.tr=["right","top"],F5.bottom=["middle","bottom"],F5.bl=["left","bottom"],F5.lb=["left","bottom"],F5.br=["right","bottom"],F5.rb=["right","bottom"],F5),K5=function(t,e){var i,n;return null!==(n=null===(i=Y5[t])||void 0===i?void 0:i[0])&&void 0!==n?n:e},X5=function(t,e){var i,n;return null!==(n=null===(i=Y5[t])||void 0===i?void 0:i[1])&&void 0!==n?n:e},Z5=function(t,e,i){var n,r,a,s,l,c,h,d,f,p,v;if(!e||"mouseout"===(null===(h=null==i?void 0:i.event)||void 0===h?void 0:h.type))return null;var y=D5(t.title,e,i),g=lt(D5(t.content,e,i)),m={title:{value:null===(d=null==y?void 0:y.value)||void 0===d?void 0:d.toString(),hasShape:!1,shapeType:void 0,shapeHollow:void 0},content:[]},_=t.maxLineCount,b=void 0===_?20:_,x=!1!==I5(null==y?void 0:y.visible,e,i);if(y&&x){var k=function(t){var e,i,n,r,o,a,s,l=(null===(s=t[0])||void 0===s?void 0:s.series)?[{data:t,value:""}]:t;try{for(var c=u(l),h=c.next();!h.done;h=c.next()){var d=h.value.data;try{for(var f=(n=void 0,u(d)),p=f.next();!p.done;p=f.next()){var v=p.value.datum;try{for(var y=(o=void 0,u(null!=v?v:[])),g=y.next();!g.done;g=y.next()){var m=g.value;if(m)return m}}catch(t){o={error:t}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}}(e);m.title={value:I5(null==y?void 0:y.value,k,i),valueStyle:I5(null==y?void 0:y.valueStyle,k,i),hasShape:y.hasShape}}else m.title={hasShape:!1,visible:!1};if("mark"===t.activeType)try{for(var S=u(null!=g?g:[]),A=S.next();!A.done;A=S.next()){var T=A.value,M=q5(null===(f=e[0])||void 0===f?void 0:f.datum[0],T,i);if(!1!==M.visible){if(m.content.length===b-1){m.content.push(o(o({},M),V5));break}if(!(m.content.length<b))break;m.content.push(M)}}}catch(t){n={error:t}}finally{try{A&&!A.done&&(r=S.return)&&r.call(S)}finally{if(n)throw n.error}}else if("dimension"===t.activeType)try{for(var C=u(e),E=C.next();!E.done;E=C.next()){var R=E.value.data,P=function(t,e){var n,r,a,s;if(!UK(null===(p=e.tooltipHelper)||void 0===p?void 0:p.spec).includes("dimension"))return"continue";var l=null!==(v=null==g?void 0:g.filter((function(t){return w(t.seriesId)||t.seriesId===e.id})))&&void 0!==v?v:[];try{for(var c=(n=void 0,u(t)),h=c.next();!h.done;h=c.next()){var d=h.value;try{for(var f=(a=void 0,u(l)),y=f.next();!y.done;y=f.next()){var _=y.value,x=q5(d,_,i);if(!1!==x.visible){if(m.content.length===b-1){m.content.push(o(o({},x),V5));break}if(!(m.content.length<b))break;m.content.push(x)}}}catch(t){a={error:t}}finally{try{y&&!y.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}if(m.content.length>=b)break}}catch(t){n={error:t}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return m.content.length>=b?"break":void 0};try{for(var B=(l=void 0,u(R)),L=B.next();!L.done;L=B.next()){var O=L.value;if("break"===P(k=O.datum,O.series))break}}catch(t){l={error:t}}finally{try{L&&!L.done&&(c=B.return)&&c.call(B)}finally{if(l)throw l.error}}if(m.content.length>=b)break}}catch(t){a={error:t}}finally{try{E&&!E.done&&(s=C.return)&&s.call(C)}finally{if(a)throw a.error}}return m.title&&(m.content.length>0&&m.content[0].shapeType?(w(m.title.shapeType)&&(m.title.shapeType=m.content[0].shapeType),w(m.title.shapeColor)&&(m.title.shapeColor=m.content[0].shapeColor)):m.title.hasShape=!1),m},q5=function(t,e,i){var n=I5(e.key,t,i),r=I5(e.value,t,i),o=!1!==I5(e.visible,t,i)&&(T(n)||T(r)),a=I5(e.isKeyAdaptive,t,i),s=I5(e.spaceRow,t,i),l=I5(e.shapeType,t,i),u=I5(e.shapeColor,t,i),c=I5(e.shapeFill,t,i),h=I5(e.shapeStroke,t,i),d=I5(e.shapeLineWidth,t,i),f=I5(e.keyStyle,t,i),p=I5(e.valueStyle,t,i);return{key:n,value:r,visible:o,isKeyAdaptive:a,hasShape:e.hasShape,shapeType:l,shapeFill:c,shapeStroke:h,shapeLineWidth:d,shapeHollow:e.shapeHollow,shapeColor:u,keyStyle:f,valueStyle:p,spaceRow:s,datum:t}},J5=function(t,e,i){var n,r;return null!==(r=null===(n=t.tooltipHelper)||void 0===n?void 0:n.getDefaultTooltipPattern(e,i))&&void 0!==r?r:null},Q5=function(t,e,i){var n,r={};if("mark"===t&&e)r=null!==(n=J5(e,"mark"))&&void 0!==n?n:{};else if("dimension"===t&&(null==i?void 0:i.length)){var a=[];i[0].data.forEach((function(t){var e=t.series,n=[o(o({},i[0]),{data:[t]})],r=J5(e,"dimension",n);r&&a.push(r)}));var s=[];a.forEach((function(t){var e=t.content;A(e)?s.push(e):s.push.apply(s,h([],c(lt(e)),!1))})),r=o(o({},a[0]),{content:s})}return r},$5=function(t,e,i){var n,r,a={};if("mark"===t&&e){var s=null!==(r=null===(n=e.tooltipHelper)||void 0===n?void 0:n.spec)&&void 0!==r?r:{};a=s.mark?X(s.mark):{}}else if("dimension"===t&&(null==i?void 0:i.length)){var l=t4(i).filter((function(t){var e,i=null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec;return T(null==i?void 0:i.dimension)&&UK(i).includes("dimension")})).map((function(t){return t.tooltipHelper.spec.dimension}));if(l.length){var u=[];l.every((function(t){var e=t.content;return w(e)}))?u=void 0:l.forEach((function(t){var e=t.content;w(e)||(A(e)?null==u||u.push(e):null==u||u.push.apply(u,h([],c(lt(e)),!1)))})),a=o(o({},l[0]),{content:u})}}return a},t4=wt((function(t){return t.reduce((function(t,e){return t.concat(e.data.map((function(t){return t.series})).filter(T))}),[])})),e4=function(t){var e={};return t.forEach((function(t){var i,n=null!==(i=t.seriesId)&&void 0!==i?i:0;e[n]||(e[n]=t)})),e},i4=function(t,e,i,n){var r,o,a=null!==(o=null==i?void 0:i[null!==(r=null==t?void 0:t.seriesId)&&void 0!==r?r:0])&&void 0!==o?o:null==i?void 0:i[0],s=new Set([].concat(Object.keys(null!=t?t:{}),Object.keys(null!=e?e:{}),Object.keys(null!=a?a:{}),Object.keys(null!=n?n:{})).filter((function(t){return t.toLowerCase().includes("shape")}))),l={};return s.forEach((function(i){var r,o,s,u=null!==(s=null!==(o=null!==(r=null==t?void 0:t[i])&&void 0!==r?r:null==e?void 0:e[i])&&void 0!==o?o:null==a?void 0:a[i])&&void 0!==s?s:null==n?void 0:n[i];void 0!==u&&(l[i]=u)})),l};!function(t){t[t.success=0]="success",t[t.failed=1]="failed"}(z5||(z5={}));var n4={fontFamily:gW,spacing:10,wordBreak:"break-word"};function r4(t,e,i){var n,r;return void 0===t&&(t={}),o(o({},null!=i?i:n4),{fill:null!==(n=t.fill)&&void 0!==n?n:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!==(r=t.fontFamily)&&void 0!==r?r:null==e?void 0:e.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}var o4=function(t){var e,i=t.backgroundColor,n=t.border,r=t.shadow,o={lineWidth:null!==(e=null==n?void 0:n.width)&&void 0!==e?e:0,shadow:!!r};(null==n?void 0:n.color)&&(o.stroke=n.color),i&&(o.fill=i),r&&(o.shadowColor=r.color,o.shadowBlur=r.blur,o.shadowOffsetX=r.x,o.shadowOffsetY=r.y,o.shadowSpread=r.spread);var a=(null!=n?n:{}).radius;return T(a)&&(o.cornerRadius=[a,a,a,a]),o},a4=function(){function t(t,e){var i=this;this._visible=!0,this._id="",this._attributes=null,this._isReleased=!1,this.showTooltip=function(t,e,n){var r,o=!!n.changePositionOnly;return n.changePositionOnly&&(null===(r=i._cacheActualTooltip)||void 0===r?void 0:r.activeType)===t||(o=!1,i._clearCacheOfContent()),o&&i._cacheViewSpec&&i._cacheActualTooltip?i.changeTooltipPosition(o,e,n):i.changeTooltip(!0,n,o,t,e)},this._changeTooltip=function(t,e,n,r,a){var s,l,u,c,h,d,f,p,v,y,g,m,_,b,x=i._component.getSpec();if(i._isReleased||!x)return z5.failed;if(!t)return i._clearAllCache(),x.handler?null!==(u=null===(l=(s=x.handler).hideTooltip)||void 0===l?void 0:l.call(s,e))&&void 0!==u?u:z5.success:(i._updateTooltip(!1,e),z5.success);if(w(r)||w(a))return z5.failed;if(n&&i._cacheViewSpec?b=i._cacheViewSpec:(b=function(t,e,i,n){var r,a,s,l,u,c,h,d=o(o({},e),{activeType:t});if("mark"===t&&i){var f=null!==(a=null===(r=i.tooltipHelper)||void 0===r?void 0:r.spec)&&void 0!==a?a:{};if(T(f.visible)||T(f.activeType)?d.visible=UK(f).includes("mark"):T(e.visible)||T(e.activeType)?d.visible=UK(e).includes("mark"):d.visible=!0,d.handler=null!==(l=null!==(s=f.handler)&&void 0!==s?s:e.handler)&&void 0!==l?l:void 0,null===(u=d.handler)||void 0===u?void 0:u.showTooltip)return d}else if("dimension"===t&&(null==n?void 0:n.length)&&(t4(n).every((function(t){var e;return!UK(null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec).includes("dimension")}))?d.visible=!1:T(e.visible)||T(e.activeType)?d.visible=UK(e).includes("dimension"):d.visible=!0,d.handler=null!==(c=e.handler)&&void 0!==c?c:void 0,null===(h=d.handler)||void 0===h?void 0:h.showTooltip))return d;var p=Q5(t,i,n),v=$5(t,i,n),y=$W({},X(e[t]),v),g=p.title,m=i4(void 0,y,void 0,g);if(T(y.title))if(A(y.title)){var _=y.title;y.title=function(t,e){var i,n=null!==(i=_(t,e))&&void 0!==i?i:{};return o(o({},m),n)}}else y.title=o(o(o({},p.title),m),y.title);else y.title=o(o({},p.title),m);var b=lt(p.content);if(T(y.content)){var x=e4(b);if(A(y.content)){var k=y.content;y.content=function(t,e){var i,n=[];return lt(null!==(i=k(t,e))&&void 0!==i?i:[]).forEach((function(t){n.push(o(o({},i4(t,y,x)),t))})),n}}else{var S=[];lt(y.content).forEach((function(t){S.push(o(o({},i4(t,y,x)),t))})),y.content=S}}else y.content=b.map((function(t){return o(o({},t),i4(void 0,y,void 0,t))}));return d[t]=o(o(o({},p),y),{activeType:t}),d}(r,x,e.model,e.dimensionInfo),i._cacheViewSpec=b),!1===b.visible)return z5.failed;if(b.handler)return null!==(d=null===(h=(c=b.handler).showTooltip)||void 0===h?void 0:h.call(c,r,a,e))&&void 0!==d?d:z5.success;var k,S=b[r];return S?(n&&i._cacheActualTooltip?k=i._cacheActualTooltip:((k=i._getActualTooltipContent(S,a,e)).title=null!==(p=null===(f=S.updateTitle)||void 0===f?void 0:f.call(S,k.title,a,e))&&void 0!==p?p:k.title,k.content=null!==(y=null===(v=S.updateContent)||void 0===v?void 0:v.call(S,k.content,a,e))&&void 0!==y?y:k.content),w(null===(g=k.title)||void 0===g?void 0:g.key)&&w(null===(m=k.title)||void 0===m?void 0:m.value)&&!(null===(_=k.content)||void 0===_?void 0:_.length)?z5.failed:(i._cacheActualTooltip=k,i._changeTooltipPosition(!!n,a,e))):z5.failed},this._changeTooltipPosition=function(t,e,n){var r,a,s;if(i._isReleased)return z5.failed;var l=n.event,u=i._cacheViewSpec,c=i._cacheActualTooltip;if(!u||!c)return z5.failed;if(u.enterable){if(!i._isPointerEscaped&&i._isPointerMovingToTooltip(n))return i._isTooltipPaused||(i._isTooltipPaused=!0,i._cachePointerTimer=setTimeout((function(){i._isPointerEscaped=!0}),300)),z5.success;i._isTooltipPaused=!1,i._isPointerEscaped=!1,clearTimeout(i._cachePointerTimer),i._cachePointerPosition=i._getPointerPositionRelativeToTooltipParent(n)}var h=c.activeType;if(u.handler)return null!==(s=null===(a=(r=u.handler).showTooltip)||void 0===a?void 0:a.call(r,h,e,n))&&void 0!==s?s:z5.success;var d=u[h];if(!d)return z5.failed;var f=i._getActualTooltipPosition(c,n,i._getTooltipBoxSize(c,t));c.position=f,d.updatePosition&&(c.position=d.updatePosition(c.position,e,n));var p=!1!==(null==d?void 0:d.visible);return e&&"pointerout"!==l.type&&c.visible&&(c.title||c.content)||(p=!1),i._updateTooltip(p,o(o({},n),{changePositionOnly:t}),c),z5.success},this._getActualTooltipContent=function(t,e,i){var n,r=D5(t.visible,e,i);return n=Z5(t,e,i),o(o({},n),{visible:!!T(n)&&!1!==r,activeType:t.activeType,data:e})},this._getActualTooltipPosition=function(t,e,n){var r,o,a,s,l,u=e.event,c={x:1/0,y:1/0},h=i._option,d=h.offsetX,f=h.offsetY,p=i._cacheViewSpec;if(!p)return i._cacheTooltipPosition=void 0,c;var v=t.activeType,y=t.data,g=p[v],m=D5(g.position,y,e),_=D5(g.positionMode,y,e),b=i._getParentElement(p),x=null!=n?n:{},k=x.width,S=void 0===k?0:k,A=x.height,w=void 0===A?0:A,C="canvas"===p.renderMode,E=null===(r=null==e?void 0:e.chart)||void 0===r?void 0:r.getCanvasRect(),R=null!==(o=null==E?void 0:E.width)&&void 0!==o?o:xw,P=null!==(a=null==E?void 0:E.height)&&void 0!==a?a:kw,B=!1,L={width:0,height:0},O={x:0,y:0},I={x:0,y:0},D=1,z=1;if(Kk(i._env)&&!p.confine){if(L.width=window.innerWidth,L.height=window.innerHeight,!C){I=null!==(s=null==b?void 0:b.getBoundingClientRect())&&void 0!==s?s:c;var j=null!==(l=i._compiler.getCanvas())&&void 0!==l?l:i._chartContainer,H=null==j?void 0:j.getBoundingClientRect();O={x:H.x-I.x,y:H.y-I.y},D=j5(j,H),z=j5(b,I)}}else L.width=R,L.height=P;var N,V,G,W,U,Y,K=z/D;if(M(m)){var X=m,Z=X.left,q=X.right,J=X.top,Q=X.bottom;N=U5(Z,u),V=U5(J,u),G=U5(q,u),W=U5(Q,u)}else if(T(m)&&"pointer"!==_&&"mark"===t.activeType){B=!0;var $=e.item,tt=e.model,et=null==$?void 0:$.getBounds(),it=null==tt?void 0:tt.getLayoutStartPoint();if(et&&it){var nt=et.x1,rt=et.y1,ot=et.x2,at=et.y2;switch(nt+=it.x,ot+=it.x,rt+=it.y,at+=it.y,K5(m)){case"left":N=nt-S*K-d;break;case"right":N=ot+d;break;case"middle":N=(nt+ot)/2-S*K/2}switch(X5(m)){case"top":V=rt-w*K-f;break;case"bottom":V=at+f;break;case"middle":V=(rt+at)/2-w*K/2}}}var st=u,lt=st.canvasX,ut=st.canvasY;if(F(N))U=N;else if(F(G))U=R-S*K-G;else{var ct=lt;switch(K5(m,"right")){case"middle":U=ct-S*K/2;break;case"left":U=ct-S*K-d;break;case"right":U=ct+d}}if(F(V))Y=V;else if(F(W))Y=P-w*K-W;else{var ht=ut;switch(X5(m,"bottom")){case"middle":Y=ht-w*K/2;break;case"top":Y=ht-w*K-f;break;case"bottom":Y=ht+f}}U*=D,Y*=D,Kk(i._env)&&(U+=O.x,Y+=O.y),U/=z,Y/=z;var dt=L.width,ft=L.height,pt=function(){return U*z+I.x<0},vt=function(){return(U+S)*z+I.x>dt},yt=function(){return Y*z+I.y<0},gt=function(){return(Y+w)*z+I.y>ft},mt=function(){pt()&&(B?U=-I.x/z:"middle"===K5(m,"right")?U+=d+S/2:U+=2*d+S)},_t=function(){pt()&&(U=-I.x/z)},bt=function(){vt()&&(B?U=(dt-I.x)/z-S:"middle"===K5(m,"right")?U-=d+S/2:U-=2*d+S)},xt=function(){vt()&&(U=(dt-I.x)/z-S)},kt=function(){yt()&&(B?Y=-I.y/z:"middle"===X5(m,"bottom")?Y+=f+w/2:Y+=2*f+w)},St=function(){yt()&&(Y=0-I.y/z)},At=function(){gt()&&(B?Y=(ft-I.y)/z-w:"middle"===X5(m,"bottom")?Y-=f+w/2:Y-=2*f+w)},wt=function(){gt()&&(Y=(ft-I.y)/z-w)};switch(K5(m,"right")){case"middle":pt()?(mt(),xt()):(bt(),_t());break;case"left":mt(),xt();break;case"right":bt(),_t()}switch(X5(m,"bottom")){case"middle":yt()?(kt(),wt()):(At(),St());break;case"top":kt(),wt();break;case"bottom":At(),St()}var Tt={x:U,y:Y};return i._cacheTooltipPosition=Tt,i._cacheTooltipSize={width:S,height:w},Tt},this._component=e,this._chartOption=e.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=e.getCompiler(),this._id=t,this._initFromSpec()}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"env",{get:function(){return this._env},enumerable:!1,configurable:!0}),t.prototype.hideTooltip=function(t){return this.changeTooltip(!1,t)},t.prototype.release=function(){var t,e,i;this._clearAllCache();var n=null!==(t=this._component.getSpec())&&void 0!==t?t:{};n.handler?null===(i=(e=n.handler).release)||void 0===i||i.call(e):(this._removeTooltip(),this._isReleased=!0)},t.prototype._clearAllCache=function(){this._clearCacheOfContent(),this._clearCacheOfPosition()},t.prototype._clearCacheOfContent=function(){this._cacheViewSpec=void 0,this._cacheActualTooltip=void 0},t.prototype._clearCacheOfPosition=function(){this._isTooltipPaused=!1,this._isPointerEscaped=!1,clearTimeout(this._cachePointerTimer),this._cachePointerTimer=-1,this._cachePointerPosition=void 0,this._cacheTooltipPosition=void 0,this._cacheTooltipSize=void 0},t.prototype._throttle=function(t){var e=this._component.getSpec();return Bt(t,I(e.throttleInterval)?e.throttleInterval:"html"===e.renderMode&&e.transitionDuration?50:10)},t.prototype._getDefaultOption=function(){var t,e,i=this._component.getSpec().offset;return o(o({},G5),{offsetX:null!==(t=null==i?void 0:i.x)&&void 0!==t?t:G5.offsetX,offsetY:null!==(e=null==i?void 0:i.y)&&void 0!==e?e:G5.offsetY})},t.prototype._getTooltipBoxSize=function(t,e){var i,n,r,a,s,l;if(!e||w(this._attributes)){var u=null!==(n=null===(i=this._chartOption)||void 0===i?void 0:i.getTheme())&&void 0!==n?n:{};this._attributes=function(t,e,i){var n,r,a,s,l,u=e.style,c=void 0===u?{}:u,h=e.enterable,d=e.transitionDuration,f=c.panel,p=void 0===f?{}:f,v=c.titleLabel,y=c.shape,g=c.keyLabel,m=c.valueLabel,_=c.spaceRow,b=mi(p.padding),x=dW(p.padding),k=r4(v,i),S=r4(g,i),A=r4(m,i),w={fill:!0,size:null!==(n=null==y?void 0:y.size)&&void 0!==n?n:8,spacing:null!==(r=null==y?void 0:y.spacing)&&void 0!==r?r:6},M={panel:o4(p),padding:b,title:{},content:[],titleStyle:{value:k,spaceRow:_},contentStyle:{shape:w,key:S,value:A,spaceRow:_},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:h,transitionDuration:d},C=t.title,E=void 0===C?{}:C,R=t.content,P=void 0===R?[]:R,B=x.left+x.right,L=x.top+x.bottom,O=0,I=P.filter((function(t){return(t.key||t.value)&&!1!==t.visible})),D=!!I.length,F=0,z=0,j=0,H=0;if(D){var N=[],V=[],G=[],W=[];M.content=I.map((function(t,e){var i=0,n=t.hasShape,r=t.key,a=t.shapeType,s=void 0===a?"":a,l=t.shapeFill,u=t.shapeStroke,c=t.shapeLineWidth,h=t.shapeSize,d=t.value,f=t.isKeyAdaptive,p=t.spaceRow,v=t.keyStyle,y=t.valueStyle,g=t.shapeColor,m=t.shapeHollow,b={height:0,spaceRow:null!=p?p:_};if(T(r)){var x=$W({},S,r4(v,void 0,{})),k=H5(r,x),M=k.width,C=k.height,E=k.text;b.key=o(o({width:M,height:C},x),{text:E}),f?V.push(M):N.push(M),i=Math.max(i,C)}if(T(d)){var R=$W({},A,r4(y,void 0,{})),P=H5(d,R);M=P.width,C=P.height,E=P.text,b.value=o(o({width:M,height:C},R),{text:E}),G.push(M),i=Math.max(i,C)}if(n){var B={visible:!0,symbolType:s},O=null!=l?l:g;m?B.stroke=O:B.fill=O,B.stroke=null!=u?u:O,B.lineWidth=c,b.shape=B;var D=null!=h?h:w.size;i=Math.max(D,i),W.push(D)}else b.shape={visible:!1};return b.height=i,L+=i,e<I.length-1&&(L+=b.spaceRow),b})),F=N.length?ct(N):0,z=V.length?ct(V):0,j=G.length?ct(G):0,H=W.length?ct(W)+w.spacing:0,O=Math.max(H+F+S.spacing+j+A.spacing,H+z,O),M.hasContentShape=!!W.length,M.keyWidth=F,M.valueWidth=j}var U=0,Y=0,K=E.visible,X=void 0===K||K,Z=E.value,q=void 0===Z?"":Z,J=E.valueStyle,Q=E.spaceRow;M.title.visible=X,M.title.spaceRow=null!=Q?Q:_;var $={},tt=function(){return $.autoWidth&&!1!==$.multiLine};if(X){$=$W({},k,r4(J,void 0,{})),tt()&&($.multiLine=null===(a=$.multiLine)||void 0===a||a,$.maxWidth=null!==(s=$.maxWidth)&&void 0!==s?s:D?Math.ceil(O):void 0);var et=H5(q,$),it=et.text,nt=et.width,rt=et.height;M.title.value=o(o({width:tt()?Math.min(nt,null!==(l=$.maxWidth)&&void 0!==l?l:Number.MAX_VALUE):nt,height:rt},$),{text:it}),U=M.title.value.width,Y=M.title.value.height,L+=Y+(D?M.title.spaceRow:0)}return M.title.width=U,M.title.height=Y,tt()?B+=O||U:B+=Math.max(U,O),D&&M.content.forEach((function(t){var e,i=t.value;i&&(null===(e=i.autoWidth)||void 0===e||e)&&(i.width=B-x.left-x.right-H-F-S.spacing-A.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),M.valueWidth=Math.max(M.valueWidth,i.width))})),M.panel.width=B,M.panel.height=L,M}(t,this._component.getSpec(),u)}return{width:null===(a=null===(r=this._attributes)||void 0===r?void 0:r.panel)||void 0===a?void 0:a.width,height:null===(l=null===(s=this._attributes)||void 0===s?void 0:s.panel)||void 0===l?void 0:l.height}},t.prototype._getPointerPositionRelativeToTooltipParent=function(t){var e,i,n=t.event,r=n.canvasX,o=n.canvasY,a={x:1/0,y:1/0},s=this._cacheViewSpec,l="canvas"===s.renderMode,u=this._getParentElement(s),c={x:0,y:0},h={x:0,y:0},d=1,f=1;if(Kk(this._env)&&!s.confine&&!l){h=null!==(e=null==u?void 0:u.getBoundingClientRect())&&void 0!==e?e:a;var p=null!==(i=this._compiler.getCanvas())&&void 0!==i?i:this._chartContainer,v=null==p?void 0:p.getBoundingClientRect();c={x:v.x-h.x,y:v.y-h.y},d=j5(p,v),f=j5(u,h)}return r*=d,o*=d,Kk(this._env)&&(r+=c.x,o+=c.y),{x:r/=f,y:o/=f}},t.prototype._isPointerMovingToTooltip=function(t){if(!this._cacheTooltipPosition||!this._cacheTooltipSize||!this._cachePointerPosition)return!1;var e=this._cacheTooltipSize,i=e.width,n=e.height,r=this._cacheTooltipPosition,o=r.x,a=void 0===o?0:o,s=r.y,l=this._getPointerPositionRelativeToTooltipParent(t);if($e(l,{x1:a,y1:s,x2:a+i,y2:s+n},!1))return!0;var u={x:a,y:s},c={x:u.x+i,y:u.y},h={x:u.x,y:u.y+n},d={x:c.x,y:h.y},f=this._cachePointerPosition;return li([f,u,c],l.x,l.y)||li([f,h,d],l.x,l.y)||li([f,u,d],l.x,l.y)||li([f,c,h],l.x,l.y)},t.prototype._getParentElement=function(t){return t.parentElement},t.prototype.getTooltipContainer=function(){return this._container},t.prototype._initFromSpec=function(){this._option=this._getDefaultOption(),this.changeTooltip=this._throttle(this._changeTooltip),this.changeTooltipPosition=this._throttle(this._changeTooltipPosition)},t.prototype.reInit=function(){this._initFromSpec()},t}(),s4=function(t,e){return T(t)?B(t)?t.map((function(t){return"".concat(t,"px")})).join(" "):"".concat(t,"px"):null!=e?e:"initial"};function l4(t){var e,i,n,r,a,s=null!=t?t:{},l=s.panel,u=void 0===l?{}:l,c=s.title,h=s.content,d=s.titleStyle,f=void 0===d?{}:d,p=s.contentStyle,v=void 0===p?{}:p,y=s.padding,g=s.keyWidth,m=s.valueWidth,_=s.enterable,b=s.transitionDuration,x=u.fill,k=u.shadow,S=u.shadowBlur,A=u.shadowColor,w=u.shadowOffsetX,T=u.shadowOffsetY,M=u.shadowSpread,C=u.cornerRadius,E=u.stroke,R=u.lineWidth,P=void 0===R?0:R,B=u.width,L=void 0===B?0:B,O=u.height,I=void 0===O?0:O,D=f.value,F=void 0===D?{}:D,z=v.shape,j=void 0===z?{}:z,H=v.key,N=void 0===H?{}:H,V=v.value,G=void 0===V?{}:V,W=function(t,e){if(!t)return;var i=$W({},e,t).size,n={};return n.width=s4(i),n}(j),U=u4(N),Y=u4(G),K=dW(y),X=K.bottom,Z=K.left,q=K.right,J=K.top,Q={panel:{width:s4(L+2*P),minHeight:s4(I+2*P),paddingBottom:s4(X),paddingLeft:s4(Z),paddingRight:s4(q),paddingTop:s4(J),borderColor:E,borderWidth:s4(P),borderRadius:s4(C),backgroundColor:x?"".concat(x):"transparent",boxShadow:k?"".concat(w,"px ").concat(T,"px ").concat(S,"px ").concat(M,"px ").concat(A):"initial",pointerEvents:_?"auto":"none",transitionDuration:b?"".concat(b,"ms"):"initial",transitionProperty:b?"transform":"initial",transitionTimingFunction:b?"ease-out":"initial"},title:o({marginTop:"0px",marginBottom:(null==h?void 0:h.length)?s4(null==c?void 0:c.spaceRow):"0px"},u4($W({},F,null==c?void 0:c.value))),content:{},shapeColumn:{common:W,items:[],width:s4(j.size),marginRight:s4(null!==(e=j.spacing)&&void 0!==e?e:8),marginBottom:s4(-(null!==(n=null===(i=null==h?void 0:h[(null==h?void 0:h.length)-1])||void 0===i?void 0:i.spaceRow)&&void 0!==n?n:0))},keyColumn:{common:U,items:null==h?void 0:h.map((function(t,e){var i=t.key,n=t.spaceRow;return o(o(o({marginTop:"0px",marginBottom:e<h.length-1?s4(n):"0px"},U),u4(i)),(null==i?void 0:i.multiLine)?{width:s4(Math.ceil(i.width))}:void 0)})),width:s4(g),marginRight:s4(null!==(r=N.spacing)&&void 0!==r?r:26)},valueColumn:{common:Y,items:null==h?void 0:h.map((function(t,e){var i=t.value,n=t.spaceRow;return o(o(o({marginTop:"0px",marginBottom:e<h.length-1?s4(n):"0px"},Y),u4(i)),(null==i?void 0:i.multiLine)?{width:s4(Math.ceil(i.width))}:void 0)})),width:s4(m),marginRight:s4(null!==(a=G.spacing)&&void 0!==a?a:0)}};return Q}function u4(t,e){if(t){var i=$W({},e,t),n=i.fontFamily,r=i.fontSize,o=i.fill,a=i.textAlign,s=i.lineHeight,l=i.fontWeight,u=i.multiLine,c=i.wordBreak,h=i.maxWidth,d={};return d.fontFamily=n,d.fontSize=s4(r),d.color=o,d.textAlign=a,d.lineHeight=s4(ph(s,r)),d.fontWeight=l,d.whiteSpace=u?"initial":"nowrap",d.wordBreak=u?null!=c?c:"break-word":"normal",d.maxWidth=s4(h),d}}var c4=function(){function t(e,i,n){this.type=t.type,this._renderContentCache=null,this.children={},this.parent=e,this._option=i,this.childIndex=null!=n?n:0}return t.isInstance=function(e){return!!e&&e.type===t.type},t.prototype.setOption=function(t){this._option=t,Object.values(this.children).forEach((function(e){return e.setOption(t)}))},t.prototype.getParentEl=function(){return t.isInstance(this.parent)?this.parent.product:this.parent},t.prototype.init=function(t,e){},t.prototype.initAll=function(){this.init(),Object.values(this.children).forEach((function(t){return t.initAll()}))},t.prototype.setStyle=function(t){var e=this;this.product&&t&&Object.keys(t).forEach((function(i){e.product.style[i]!==t[i]&&(e.product.style[i]=t[i])}))},t.prototype.setContent=function(t){},t.prototype.setVisibility=function(t){if(this.product){var e=this.product.style;e.visibility=t?"visible":"hidden",Object.values(this.children).forEach((function(e){return e.setVisibility(t)}))}},t.prototype.getVisibility=function(){var t,e;return!!(null===(e=null===(t=this.product)||void 0===t?void 0:t.style)||void 0===e?void 0:e.visibility)&&"hidden"!==this.product.style.visibility},t.prototype.release=function(){var t;if(Object.values(this.children).forEach((function(t){return t.release()})),this.children={},this.product){try{null===(t=this.getParentEl())||void 0===t||t.removeChild(this.product)}catch(t){}this.product=null}},t.prototype.createElement=function(e,i,n,r){var o,a=null==Yk?void 0:Yk.createElement(e),s=this.getParentEl();if(a&&s){i&&(o=a.classList).add.apply(o,h([],c(i),!1)),n&&Object.keys(n).forEach((function(t){a.style[t]=n[t]})),r&&(a.id=r);var l=this.childIndex;if(t.isInstance(this.parent))for(var u=Number.MAX_VALUE,d=function(t){var e=Object.values(f.parent.children).find((function(e){return e.product===s.children[t]}));e.childIndex>f.childIndex&&e.childIndex<u&&(u=e.childIndex,l=t)},f=this,p=0;p<s.children.length;p++)d(p);return l>=s.children.length?s.appendChild(a):s.insertBefore(a,s.children[l]),a}},t.type="tooltipModel",t}(),h4={fontSize:"13px",marginBottom:"0px",fontWeight:"normal"},d4={boxSizing:"border-box"},f4={display:"flex",whiteSpace:"nowrap"},p4={display:"flex",flexDirection:"column",justifyContent:"space-around",fontSize:"0"},v4={paddingTop:"0px",paddingBottom:"0px",textAlign:"left",fontWeight:"normal"},y4={paddingTop:"0px",paddingBottom:"0px",textAlign:"left",fontWeight:"normal"},g4={paddingTop:"0px",paddingBottom:"0px",textAlign:"right",fontWeight:"normal"},m4={lineHeight:"normal"},_4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,i){if(!this.product){var n=this.createElement(null!=i?i:"div",h(h([],c(null!=t?t:[]),!1),["shape"],!1),void 0,e);this.product=n}},e.prototype.setStyle=function(e,i){t.prototype.setStyle.call(this,e),this.setSvg(i)},e.prototype.setContent=function(t){this.setSvg(t)},e.prototype.setSvg=function(t){var e=function(t,e){var i,n,r,o,a,s,l;if(!(null==t?void 0:t.hasShape)||!t.symbolType)return"";var u=t.symbolType,h=t.fill,d=t.stroke,f=t.hollow,p=void 0!==f&&f,v=t.size?e(t.size):"8px",y=t.marginTop?e(t.marginTop):"0px",g=t.lineWidth?e(t.lineWidth)+"px":"0px",m="currentColor",_=function(){return d?e(d):m},b=(A=v,w=A.split(" ").map((function(t){return Number.isNaN(t)?Number.parseFloat(t.substring(0,t.length-2)):Number.parseFloat(t)})),1===w.length?w[0]:w),x=function(t){return new ny({symbolType:t,size:b,fill:!0})},k=x(null!==(i=b4[u])&&void 0!==i?i:u),S=k.getParsedPath();var A,w;S.path||(k=x(S.pathStr));var T=k.getParsedPath().path,C=T.toString(),E=T.bounds,R="".concat(E.x1," ").concat(E.y1," ").concat(E.width()," ").concat(E.height());if("0px"!==g){var B=c(R.split(" ").map((function(t){return Number(t)})),4),L=B[0],O=B[1],I=B[2],D=B[3],F=Number(g.slice(0,-2));R="".concat(L-F/2," ").concat(O-F/2," ").concat(I+F," ").concat(D+F)}if(!h||P(h)||p)return m=p?"none":h?e(h):"currentColor",'\n    <svg width="'.concat(v,'" height="').concat(v,'" viewBox="').concat(R,'"\n      style="display: inline-block; vertical-align: middle; margin-top: ').concat(y,';">\n      <path\n        d="').concat(C,'"\n        style="fill: ').concat(m,"; stroke: ").concat(_(),"; stroke-width: ").concat(g,'"\n      >\n      </path>\n    </svg>');if(M(h)){m=null!==(n="gradientColor"+t.index)&&void 0!==n?n:"";var z="",j=(null!==(r=h.stops)&&void 0!==r?r:[]).map((function(t){return'<stop offset="'.concat(e(t.offset.toString()),'" stop-color="').concat(e(t.color),'"/>')})).join("");return"radial"===h.gradient?z='<radialGradient id="'.concat(m,'" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">\n      ').concat(j,"\n      </radialGradient>"):"linear"===h.gradient&&(z='<linearGradient id="'.concat(m,'" x1="').concat(100*(null!==(o=h.x0)&&void 0!==o?o:0),'%" y1="').concat(100*(null!==(a=h.y0)&&void 0!==a?a:0),'%" x2="').concat(100*(null!==(s=h.x1)&&void 0!==s?s:0),'%" y2="').concat(100*(null!==(l=h.y1)&&void 0!==l?l:0),'%">\n      ').concat(j,"\n      </linearGradient>")),'\n    <svg width="'.concat(v,'" height="').concat(v,'" viewBox="-0.5 -0.5 1 1"\n      style="display: inline-block; vertical-align: middle; margin-top: ').concat(y,';">\n      ').concat(z,'\n      <path\n        d="').concat(C,'"\n        style="fill: url(#').concat(m,"); stroke: ").concat(_(),"; stroke-width: ").concat(g,'"\n      >\n      </path>\n    </svg>')}return""}(t,this._option.valueToHtml);this.product&&e!==this._svgHtmlCache&&(this._svgHtmlCache=e,this.product.innerHTML=e)},e.prototype.release=function(){t.prototype.release.call(this),this._svgHtmlCache=""},e}(c4),b4={star:"M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"};var x4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,i){this.product||(this.product=this.createElement(null!=i?i:"span",t,void 0,e))},e.prototype.setContent=function(t,e){if(this.product){var i=this._option.valueToHtml(t);e&&(i=i.replaceAll("\n","<br>")),i!==this.product.innerHTML&&(this.product.innerHTML=i)}},e}(c4),k4={overflowWrap:"normal",wordWrap:"normal"},S4=function(t){function e(e,i,n,r){var o=t.call(this,e,i,r)||this;return o.className=n,o}return r(e,t),e.prototype.init=function(){var t,e,i=this;this.product||(this.product=this.createElement("div",[this.className]));var n=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[];if("shape-box"!==this.className||n.some((function(t){return t.hasShape&&t.shapeType}))){Object.keys(this.children).forEach((function(t){var e=gt(t);e>=n.length&&(i.children[e].release(),delete i.children[e])}));for(var r=0;r<n.length;r++)if(!this.children[r])if("key-box"===this.className||"value-box"===this.className){var o=new x4(this.product,this._option,r);o.init([this.className.substring(0,this.className.indexOf("-"))],void 0,"div"),this.children[r]=o}else if("shape-box"===this.className){var a=new _4(this.product,this._option,r);a.init(["shape"],void 0,"div"),this.children[r]=a}}else Object.keys(this.children).forEach((function(t){var e=gt(t);i.children[e].release(),delete i.children[e]}))},e.prototype.setStyle=function(){var e,i,n,r,a=this,s=this._option.getTooltipStyle();t.prototype.setStyle.call(this,$W({},p4,s.content,this._getContentColumnStyle()));var l=null!==(i=null===(e=this._option.getTooltipActual())||void 0===e?void 0:e.content)&&void 0!==i?i:[],u=null!==(r=null===(n=this._option.getTooltipAttributes())||void 0===n?void 0:n.content)&&void 0!==r?r:[];l.forEach((function(t,e){var i,n,r,l,c,h={};if("key-box"===a.className){var d=t.key;h=$W({},t.isKeyAdaptive?y4:v4,o(o(o({height:s4(u[e].height)},k4),s.keyColumn.common),null===(i=s.keyColumn.items)||void 0===i?void 0:i[e])),P(d)&&""!==(null===(n=null==d?void 0:d.trim)||void 0===n?void 0:n.call(d))||I(d)||h.visibility?h.visibility="visible":h.visibility="hidden",a.children[e].setStyle(h)}else"value-box"===a.className?(h=$W({},g4,o(o(o({height:s4(u[e].height)},k4),s.valueColumn.common),null===(r=s.valueColumn.items)||void 0===r?void 0:r[e])),a.children[e].setStyle(h)):"shape-box"===a.className&&(h=$W({},m4,o(o({height:s4(u[e].height+u[e].spaceRow)},s.shapeColumn.common),null===(l=s.shapeColumn.items)||void 0===l?void 0:l[e])),null===(c=a.children[e])||void 0===c||c.setStyle(h,a._getShapeSvgOption(t,e)))}))},e.prototype.setContent=function(){var t,e,i,n,r=this,o=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[],a=null!==(n=null===(i=this._option.getTooltipAttributes())||void 0===i?void 0:i.content)&&void 0!==n?n:[];o.forEach((function(t,e){var i,n,o,s,l,u,c,h;if("key-box"===r.className){var d=t.key;h=P(d)&&""!==(null===(i=null==d?void 0:d.trim)||void 0===i?void 0:i.call(d))||I(d)?d:"",null===(n=r.children[e])||void 0===n||n.setContent(h,null===(o=a[e].key)||void 0===o?void 0:o.multiLine)}else if("value-box"===r.className){var f=t.value;h=P(f)&&""!==(null===(s=null==f?void 0:f.trim)||void 0===s?void 0:s.call(f))||I(f)?f:"",null===(l=r.children[e])||void 0===l||l.setContent(h,null===(u=a[e].value)||void 0===u?void 0:u.multiLine)}else"shape-box"===r.className&&(h=r._getShapeSvgOption(t,e),null===(c=r.children[e])||void 0===c||c.setContent(h))}))},e.prototype._getContentColumnStyle=function(){var t,e,i=this._option.getTooltipStyle();switch(this.className){case"shape-box":var n=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[];return o(o({},i.shapeColumn),"shape-box"!==this.className||n.some((function(t){return t.hasShape&&t.shapeType}))?{}:{display:"none"});case"key-box":return i.keyColumn;case"value-box":return i.valueColumn}},e.prototype._getShapeSvgOption=function(t,e){var i,n,r,a,s,l,u=this._option.getTooltipStyle(),c=o(o({},u.shapeColumn),null===(i=u.shapeColumn.items)||void 0===i?void 0:i[e]),h=o(o({},u.keyColumn),null===(n=u.keyColumn.items)||void 0===n?void 0:n[e]);return{hasShape:t.hasShape,symbolType:t.shapeType,size:c.width,fill:null!==(r=t.shapeFill)&&void 0!==r?r:t.shapeColor,stroke:t.shapeStroke,lineWidth:t.shapeLineWidth,hollow:t.shapeHollow,marginTop:"calc((".concat(null!==(s=null!==(a=h.lineHeight)&&void 0!==a?a:h.fontSize)&&void 0!==s?s:"18px"," - ").concat(null!==(l=c.width)&&void 0!==l?l:"8px",") / 2)"),index:e}},e}(c4),A4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){this.product||(this.product=this.createElement("div",["container-box"])),this.shapeBox||this._initShapeBox(),this.keyBox||this._initKeyBox(),this.valueBox||this._initValueBox()},e.prototype._initShapeBox=function(){var t=new S4(this.product,this._option,"shape-box",0);t.init(),this.shapeBox=t,this.children[t.childIndex]=t},e.prototype._initKeyBox=function(){var t=new S4(this.product,this._option,"key-box",1);t.init(),this.keyBox=t,this.children[t.childIndex]=t},e.prototype._initValueBox=function(){var t=new S4(this.product,this._option,"value-box",2);t.init(),this.valueBox=t,this.children[t.childIndex]=t},e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,$W({},f4,e)),Object.values(this.children).forEach((function(t){t.setStyle()}))},e.prototype.setContent=function(){Object.values(this.children).forEach((function(t){t.setContent()}))},e.prototype.release=function(){t.prototype.release.call(this),this.shapeBox=null,this.keyBox=null,this.valueBox=null},e}(c4),w4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){var t=this._option.getTooltipActual();this.product||(this.product=this.createElement("h2"));var e=t.title;(null==e?void 0:e.hasShape)&&(null==e?void 0:e.shapeType)?this.shape||this._initShape():this.shape&&this._releaseShape(),this.textSpan||this._initTextSpan()},e.prototype._initShape=function(){var t=new _4(this.product,this._option,0);t.init(),this.shape=t,this.children[t.childIndex]=t},e.prototype._releaseShape=function(){this.shape&&(this.shape.release(),delete this.children[this.shape.childIndex],this.shape=null)},e.prototype._initTextSpan=function(){var t=new x4(this.product,this._option,1);t.init(),this.textSpan=t,this.children[t.childIndex]=t},e.prototype.setStyle=function(e){var i,n,r,o,a=this._option.getTooltipStyle(),s=this._option.getTooltipActual().title;t.prototype.setStyle.call(this,$W({},h4,a.title,e)),null===(i=this.shape)||void 0===i||i.setStyle({paddingRight:null===(n=a.shapeColumn.common)||void 0===n?void 0:n.marginRight},{hasShape:null==s?void 0:s.hasShape,symbolType:null==s?void 0:s.shapeType,size:null===(r=a.shapeColumn.common)||void 0===r?void 0:r.width,fill:null==s?void 0:s.shapeColor,hollow:null==s?void 0:s.shapeHollow}),null===(o=this.textSpan)||void 0===o||o.setStyle({color:"inherit"})},e.prototype.setContent=function(){var t,e,i,n,r,o,a=this._option.getTooltipStyle(),s=this._option.getTooltipActual(),l=this._option.getTooltipAttributes(),u=s.title;this.init(),null===(t=this.shape)||void 0===t||t.setStyle(void 0,{hasShape:null==u?void 0:u.hasShape,symbolType:null==u?void 0:u.shapeType,size:null===(e=a.shapeColumn.common)||void 0===e?void 0:e.width,fill:null==u?void 0:u.shapeColor,hollow:null==u?void 0:u.shapeHollow}),null===(i=this.textSpan)||void 0===i||i.setStyle({color:"inherit"}),null===(n=this.textSpan)||void 0===n||n.setContent(null==u?void 0:u.value,null===(o=null===(r=l.title)||void 0===r?void 0:r.value)||void 0===o?void 0:o.multiLine)},e.prototype.release=function(){t.prototype.release.call(this),this.shape=null,this.textSpan=null},e}(c4),T4=function(t){function e(e,i,n,r){var o=t.call(this,e,i,0)||this;return o.title=null,o.content=null,o._classList=n,o._id=r,o}return r(e,t),e.prototype.setVisibility=function(e){if(t.prototype.setVisibility.call(this,e),this.product){var i=this.product.classList;e?i.add("visible"):i.remove("visible")}},e.prototype.init=function(){var t,e=this._option.getTooltipActual();this.product||this._initPanel(this._classList,this._id);var i=e.title;!1!==(null==i?void 0:i.visible)&&T(null==i?void 0:i.value)?this.title||this._initTitle():this.title&&this._releaseTitle(),(null!==(t=e.content)&&void 0!==t?t:[]).length>0?this.content||this._initContent():this.content&&this._releaseContent()},e.prototype._initPanel=function(t,e){var i=this.createElement("div",t,{left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:"99999999999999",fontFamily:"sans-serif",fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh"},e);this.product=i},e.prototype._initTitle=function(){var t=new w4(this.product,this._option,0);t.init(),this.title=t,this.children[t.childIndex]=t},e.prototype._releaseTitle=function(){this.title&&(this.title.release(),delete this.children[this.title.childIndex],this.title=null)},e.prototype._initContent=function(){var t=new A4(this.product,this._option,1);t.init(),this.content=t,this.children[t.childIndex]=t},e.prototype._releaseContent=function(){this.content&&(this.content.release(),delete this.children[this.content.childIndex],this.content=null)},e.prototype.setStyle=function(){var e=this._option.getTooltipStyle();t.prototype.setStyle.call(this,$W({},d4,e.panel)),Object.values(this.children).forEach((function(t){return t.setStyle()}))},e.prototype.setContent=function(){Object.values(this.children).forEach((function(t){t.setContent()}))},e.prototype.release=function(){t.prototype.release.call(this),this.title=null,this.content=null},e}(c4),M4=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=W5.dom,n._tooltipContainer=null==Yk?void 0:Yk.body,n._initStyle(),n.initEl(),n}return r(e,t),e.prototype.getVisibility=function(){var t;return!!(null===(t=this.model)||void 0===t?void 0:t.getVisibility())},e.prototype.setVisibility=function(t){var e;t!==this.getVisibility()&&(null===(e=this.model)||void 0===e||e.setVisibility(t))},e.prototype.initEl=function(){var t=this,e=this._component.getSpec(),i=e.parentElement;if(Yk&&i){for(var n=0;n<i.children.length;n++)if(i.children[n].classList.contains(N5)){this._container=i.children[n];break}this._container||(this._container=Yk.createElement("div"),this._container.style.position="relative",this._container.classList.add(N5),i.appendChild(this._container)),this.model=new T4(this._container,{valueToHtml:this._option.sanitize,getTooltipStyle:function(){return t._domStyle},getTooltipActual:function(){return t._tooltipActual},getTooltipAttributes:function(){return t._attributes}},[e.className],this.id)}},e.prototype._removeTooltip=function(){var t;null===(t=this.model)||void 0===t||t.release(),this._container=null},e.prototype._updateTooltip=function(t,e,i){var n,r;if(t&&this.model){e.changePositionOnly||(this._tooltipActual=i,this._initStyle(),this.model.initAll(),this.model.setStyle(),this.model.setContent()),this.setVisibility(t);var o=null!==(n=i.position)&&void 0!==n?n:{},a=o.x,s=void 0===a?0:a,l=o.y,u=void 0===l?0:l,c=this.model.product;if(c){if(null===(r=this._cacheViewSpec)||void 0===r?void 0:r.updateElement){this._cacheViewSpec.updateElement(c,i,e);var h=this._getActualTooltipPosition(i,e,{width:c.offsetWidth,height:c.offsetHeight});s=h.x,u=h.y}c.style.transform="translate3d(".concat(s,"px, ").concat(u,"px, 0)")}}else this.setVisibility(t)},e.prototype._initStyle=function(){this._domStyle=l4(this._attributes)},e.prototype._getParentElement=function(e){var i;return null!==(i=this._container)&&void 0!==i?i:t.prototype._getParentElement.call(this,e)},e.prototype.isTooltipShown=function(){return this.getVisibility()},e.prototype.reInit=function(){t.prototype.reInit.call(this),this._initStyle()},e}(a4),C4=function(t){function e(e,i){var n,r=this;return(r=t.call(this,e,i)||this).type=W5.canvas,r._tooltipCanvasId=null===(n=r._chartOption.modeParams)||void 0===n?void 0:n.tooltipCanvasId,r}return r(e,t),e.prototype._initTooltipComponent=function(t){var e=this._getLayer(t);this._tooltipComponent=new ez({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)},e.prototype._getLayer=function(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);var e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer},e.prototype._removeTooltip=function(){this._layer&&this._layer.removeAllChild(),this._attributes=null},e.prototype._updateTooltip=function(t,e,i){this._visible=t;var n=this._compiler.getStage();if(n)if(t){this._tooltipComponent||this._initTooltipComponent(n);var r=null==i?void 0:i.position;e.changePositionOnly?T(r)&&this._tooltipComponent.setAttributes(r):this._tooltipComponent.setAttributes(o(o({},this._attributes),r)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}else this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1}))},e.prototype.isTooltipShown=function(){var t;return null===(t=this._tooltipComponent)||void 0===t?void 0:t.attribute.visibleAll},e.prototype.release=function(){var e;t.prototype.release.call(this),null===(e=this._layer)||void 0===e||e.release()},e}(a4),E4=function(t,e){return T(e)?t.map((function(t){return e[t]})):void 0},R4=function(t,e){return function(i){return t.every((function(t,n){return i[t]===(null==e?void 0:e[n])}))}},P4=function(t){return!w(t)&&(B(t)?t.length>0&&t.every(T):Object.keys(t).length>0)};function B4(e,i,n,r){var a,s,l,u,d,f=o({regionIndex:0},i),p=r.getRegionsInUserIdOrIndex(T(f.regionId)?[f.regionId]:void 0,T(f.regionIndex)?[f.regionIndex]:void 0)[0];if(!p)return"none";var v=p.getSeries(),y=[];v.forEach((function(i){var n,r,o,a,s,l,u,h,d=i.getDimensionField(),f=i.getMeasureField(),p=i.getSeriesField(),v=T(p)?e[p]:void 0,g=T(p)&&null!==(a=null===(o=null===(r=null===(n=i.getViewDataStatistics)||void 0===n?void 0:n.call(i))||void 0===r?void 0:r.latestData[p])||void 0===o?void 0:o.values)&&void 0!==a?a:[],m=E4(d,e),_=E4(f,e),b=P4(_),x=!b&&T(p)&&w(v)&&g.length>0;if("cartesian"===i.coordinate){var k=i,S=d.map((function(t,e){return[t,e]})).filter((function(t){var e=c(t,2)[1];return w(null==m?void 0:m[e])})),A=[null!=m?m:[]];S.length>0&&S.forEach((function(t){var e,n,r,o,a=c(t,2),s=a[0],l=a[1],u=null!==(o=null===(r=null===(n=null===(e=i.getViewDataStatistics)||void 0===e?void 0:e.call(i))||void 0===n?void 0:n.latestData[s])||void 0===r?void 0:r.values)&&void 0!==o?o:[],h=[];A.forEach((function(t){u.forEach((function(e){var i,n=null!==(i=null==t?void 0:t.slice())&&void 0!==i?i:[];n[l]=e,h.push(n)}))})),A=h})),A.forEach((function(t){var e,n;if(x){var r=null===(e=k.getViewData())||void 0===e?void 0:e.latestData.filter(R4(d,t));g.forEach((function(e){var n=r.find((function(t){return t[p]===e}));if(_=E4(f,n),P4(_)){var o=k.dataToPosition(n);w(o)||isNaN(o.x)||isNaN(o.y)||y.push({pos:o,data:{dimensionFields:d,dimensionData:t,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:e},series:i})}}))}else{var o=null===(n=k.getViewData())||void 0===n?void 0:n.latestData.find(R4(d,t));if(!b&&(_=E4(f,o),!P4(_)))return;var a=k.dataToPosition(o);if(w(a)||isNaN(a.x)||isNaN(a.y))return;y.push({pos:a,data:{dimensionFields:d,dimensionData:t,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:v},series:i})}}))}else if("polar"===i.coordinate)if(i.type===t.SeriesTypeEnum.pie){var M=i,C=null===(s=M.getViewData())||void 0===s?void 0:s.latestData.find(R4(d,m));if(!b&&(_=E4(f,C),!P4(_)))return;var E=M.dataToCentralPosition(C);if(w(E)||isNaN(E.x)||isNaN(E.y))return;y.push({pos:E,data:{dimensionFields:d,dimensionData:m,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:v},series:i})}else{var R=i;if(x){var P=(null===(l=R.getViewData())||void 0===l?void 0:l.latestData.filter(R4(d,m))).find((function(t){return t[p]===v}));g.forEach((function(t){if(_=E4(f,P),P4(_)){var e=R.dataToPosition(P);w(e)||isNaN(e.x)||isNaN(e.y)||y.push({pos:e,data:{dimensionFields:d,dimensionData:m,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:t},series:i})}}))}else{C=null===(u=R.getViewData())||void 0===u?void 0:u.latestData.find(R4(d,m));if(!b&&(_=E4(f,C),!P4(_)))return;E=R.dataToPosition(C);if(w(E)||isNaN(E.x)||isNaN(E.y))return;y.push({pos:E,data:{dimensionFields:d,dimensionData:m,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:v},series:i})}}else if("geo"===i.coordinate){var B=i;C=null===(h=B.getViewData())||void 0===h?void 0:h.latestData.find(R4(d,m));if(!b&&(_=E4(f,C),!P4(_)))return;E=B.dataToPosition(C);if(w(E)||isNaN(E.x)||isNaN(E.y))return;y.push({pos:E,data:{dimensionFields:d,dimensionData:m,measureFields:f,measureData:_,hasMeasureData:b,groupField:p,groupData:v},series:i})}}));var g,m=null!==(a=f.activeType)&&void 0!==a?a:y.length>1?"dimension":"mark",_=p.getLayoutStartPoint(),b=p.getLayoutRect(),x=r.globalInstance.getContainer(),k=o({x:0,y:0},x?{x:(g=x.getBoundingClientRect()).x,y:g.y}:{}),S=function(t){var e,i=t.data,n=i.dimensionFields,r=i.dimensionData,o=i.measureFields,a=i.measureData,s=i.groupField,l=i.groupData,u=null===(e=t.series.getViewData())||void 0===e?void 0:e.latestData.find((function(t){return R4(n,r)(t)&&R4(o,a)(t)&&(w(s)||R4([s],[l])(t))}));return u},A=function(t){var e,i,n=function(t){return{x:Math.min(Math.max(t.x,0),b.width),y:Math.min(Math.max(t.y,0),b.height)}}(t),r=null!==(e=f.x)&&void 0!==e?e:_.x+n.x,o=null!==(i=f.y)&&void 0!==i?i:_.y+n.y;return{canvasX:r,canvasY:o,clientX:k.x+r,clientY:k.y+o}};if("dimension"===m){var M=y[0];if(!M)return"none";var C=new Map;y.forEach((function(t){var e;C.has(t.series)||C.set(t.series,[]),null===(e=C.get(t.series))||void 0===e||e.push(t)}));var E=[{value:e[M.data.dimensionFields[0]],data:h([],c(C.keys()),!1).map((function(t){var e,i;return{series:t,datum:null!==(i=null===(e=C.get(t))||void 0===e?void 0:e.map((function(t){return S(t)})))&&void 0!==i?i:[]}}))}],R={changePositionOnly:!1,dimensionInfo:E,chart:null!==(s=r.globalInstance.getChart())&&void 0!==s?s:void 0,datum:void 0,model:void 0,source:t.Event_Source_Type.chart,event:A({x:y.reduce((function(t,e){return t+e.pos.x}),0)/y.length,y:y.reduce((function(t,e){return t+e.pos.y}),0)/y.length}),item:void 0,itemMap:new Map};null===(l=null==n?void 0:n.showTooltip)||void 0===l||l.call(n,m,E,R);var P=r.globalInstance;return FK.globalConfig.uniqueTooltip&&FK.hideTooltip(P.id),m}if("mark"===m){var B=y[0];if(!B)return"none";var L=o(o({},S(B)),e);R={changePositionOnly:!1,chart:null!==(u=r.globalInstance.getChart())&&void 0!==u?u:void 0,datum:L,model:B.series,source:t.Event_Source_Type.chart,event:A(B.pos),item:void 0,itemMap:new Map};null===(d=null==n?void 0:n.showTooltip)||void 0===d||d.call(n,m,[{datum:[L],series:B.series}],R);P=r.globalInstance;return FK.globalConfig.uniqueTooltip&&FK.hideTooltip(P.id),m}return"none"}var L4,O4=function(){function e(e){var i=this;this._showTooltipByHandler=function(e,n){var r,a;return i.component.event.emit(t.ChartEvent.tooltipShow,o(o({},n),{tooltipData:e,activeType:i.activeType,tooltip:i.component})),(null===(r=i.component.tooltipHandler)||void 0===r?void 0:r.showTooltip)&&T(e)?null!==(a=i.component.tooltipHandler.showTooltip(i.activeType,e,n))&&void 0!==a?a:z5.success:z5.failed},this.component=e}return e.prototype._preprocessDimensionInfo=function(t){var e=[];if(null==t||t.forEach((function(t){var i=o(o({},t),{data:t.data.filter((function(t){var e,i;return!1!==(null===(i=null===(e=t.series.getSpec())||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.visible)}))});i.data.length>0&&e.push(i)})),e.length>0)return e},e.prototype._getDimensionInfo=function(t){var e,i,n,r=this.component.getChart(),o=r.getCompiler().getStage().getLayer(void 0),a={x:t.event.viewX,y:t.event.viewY};if(o.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},a),0===(n=h(h([],c(null!==(e=tY(r,a))&&void 0!==e?e:[]),!1),c(null!==(i=NU(r,a))&&void 0!==i?i:[]),!1)).length)n=void 0;else if(n.length>1){var s=n.filter((function(t){var e,i,n,r,o,a,s=t.axis;if(!_S(s.getScale().type))return!1;try{for(var l=u(null!==(o=null==s?void 0:s.getRegions())&&void 0!==o?o:[]),c=l.next();!c.done;c=l.next()){var h=c.value;try{for(var d=(n=void 0,u(h.getSeries())),f=d.next();!f.done;f=d.next()){var p=f.value;if("cartesian"===p.coordinate){a=p;break}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(T(a))break}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}return T(a)&&a.getDimensionField()[0]===a.fieldY[0]?"left"===s.getOrient()||"right"===s.getOrient():"bottom"===s.getOrient()||"top"===s.getOrient()}));n=s.length?s:n.slice(0,1)}return n},e}(),I4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="dimension",e}return r(e,t),e.prototype.showTooltip=function(t,e,i){var n=o(o({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i});return this._showTooltipByHandler(t,n)},e.prototype.shouldHandleTooltip=function(t,e){var i,n,r=e.tooltipInfo;if(w(r))return!1;var o=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper;return!!(null!==(n=null==o?void 0:o.activeType)&&void 0!==n?n:this.component.getSpec().activeType).includes("dimension")},e.prototype.getMouseEventData=function(t){var e;return{tooltipInfo:this._getDimensionInfo(t),ignore:h([],c(null!==(e=this.component.getOption().getAllSeries())&&void 0!==e?e:[]),!1).some((function(e){var i,n=null===(i=e.tooltipHelper)||void 0===i?void 0:i.ignoreTriggerSet.dimension;return t.model&&(null==n?void 0:n.has(t.model))||t.mark&&(null==n?void 0:n.has(t.mark))}))}},e}(O4),D4=function(t){return T(t)&&!B(t)},F4=function(t){return T(t)&&B(t)},z4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeType="mark",e}return r(e,t),e.prototype.showTooltip=function(t,e,i){var n=t.datum,r=t.series,a=t.dimensionInfo,s=[{datum:[n],series:r}],l=o(o({},e),{dimensionInfo:this._preprocessDimensionInfo(a),changePositionOnly:i});return this._showTooltipByHandler(s,l)},e.prototype.shouldHandleTooltip=function(t,e){var i,n=e.tooltipInfo;if(w(n))return!1;var r=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper;return!!(null==r?void 0:r.activeType.includes("mark"))},e.prototype.getMouseEventData=function(t){var e,i,n;if("series"===(null===(e=t.model)||void 0===e?void 0:e.modelType)){var r=t.model,o=r.tooltipHelper,a=null==o?void 0:o.activeTriggerSet.mark,s=null==o?void 0:o.ignoreTriggerSet.mark;(null==a?void 0:a.has(t.model))||(null==a?void 0:a.has(t.mark))?i={mark:t.mark,datum:t.datum,series:r,dimensionInfo:this._getDimensionInfo(t)}:((null==s?void 0:s.has(t.model))||(null==s?void 0:s.has(t.mark)))&&(n=!0)}return{tooltipInfo:i,ignore:n}},e}(O4),j4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._shouldMergeThemeToSpec=function(){return!1},e.prototype._initTheme=function(e,i){var n=t.prototype._initTheme.call(this,e,i),r=n.spec,o=n.theme;return r.style=$W({},this._theme,r.style),{spec:r,theme:o}},e}(dq),H4=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=1,i.type=f.tooltip,i.name=f.tooltip,i.transformerConstructor=j4,i.specKey="tooltip",i.layoutType="none",i._alwaysShow=!1,i._eventList=[],i._isTooltipShown=!1,i._mountEvent=function(t,e,n){i.event.on(t,e,n),i._eventList.push({eventType:t,handler:n})},i._getMouseOutHandler=function(t){return function(e){var n,r;if(!i._alwaysShow&&(i._isTooltipShown||(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))){var o=Kk(i._option.mode),a=e.event,s=a.clientX,l=a.clientY;o&&i._isPointerOnTooltip(e)||o&&t&&i._isPointerInChart({x:s,y:l})||i._handleChartMouseOut(e)}}},i._handleChartMouseOut=function(t){i._alwaysShow||"none"!==i._spec.triggerOff&&(i._hideTooltipByHandler(o({},t)),i._cacheInfo=void 0)},i._handleMouseMove=function(t){if(i.tooltipHandler||i._initHandler(),i._processor||i._initProcessor(),!i._alwaysShow&&!i._isPointerOnTooltip(t)){var e=i._getMouseEventData(t),n=e.tooltipInfo.dimension,r=e.ignore,o=r.mark,a=r.dimension,s=!1,l=!1;(s=i._showTooltipByMouseEvent("mark",e,t))||(l=i._showTooltipByMouseEvent("dimension",e,t)),s||l||function(t){return w(t.mark)&&w(t.model)&&w(t.datum)}(t)||(o&&D4(i._cacheInfo)?s=i._showTooltipByMouseEvent("mark",e,t,!0):a&&F4(i._cacheInfo)?l=i._showTooltipByMouseEvent("dimension",e,t,!0):T(n)&&(l=i._showTooltipByMouseEvent("dimension",e,t))),s||l&&!w(n)||i._handleChartMouseOut(t)}},i._showTooltipByMouseEvent=function(t,e,n,r){var o,a=i._processor[t];if(!a.shouldHandleTooltip(n,{tooltipInfo:e.tooltipInfo[t],ignore:e.ignore[t]}))return!1;if(r)o=!a.showTooltip(i._cacheInfo,n,!0);else{var s=e.tooltipInfo[t],l=i._isSameAsCacheInfo(s);(o=!a.showTooltip(s,n,l))&&(i._cacheInfo=s)}o&&(i._isTooltipShown=!0);var u=i._option.globalInstance;return o&&FK.globalConfig.uniqueTooltip&&FK.hideTooltip(u.id),o},i._getMouseEventData=function(t){var e={tooltipInfo:{},ignore:{}};return Object.keys(i._processor).forEach((function(n){var r=i._processor[n].getMouseEventData(t),o=r.tooltipInfo,a=r.ignore;e.tooltipInfo[n]=o,e.ignore[n]=a})),e},i._hideTooltipByHandler=function(e){var n,r,a;if(!i._isTooltipShown&&!(null===(r=null===(n=i.tooltipHandler)||void 0===n?void 0:n.isTooltipShown)||void 0===r?void 0:r.call(n)))return z5.success;if(i.event.emit(t.ChartEvent.tooltipHide,o(o({},e),{source:t.Event_Source_Type.chart,tooltip:i})),null===(a=i.tooltipHandler)||void 0===a?void 0:a.hideTooltip){var s=i.tooltipHandler.hideTooltip(e);return s||(i._isTooltipShown=!1),s}return z5.failed},i}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i)return null;if(!B(i))return[{spec:i,specPath:[this.specKey],type:f.tooltip}];var n=[];return i.forEach((function(t,i){n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.tooltip})})),n},i.prototype.isTooltipShown=function(){return this._isTooltipShown},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.prototype._registerEvent=function(){},i.prototype._releaseEvent=function(){},i.prototype.onLayout=function(t){},i.prototype.onLayoutEnd=function(t){},i.prototype.onRender=function(t){},i.prototype.created=function(){e.prototype.created.call(this),this._regions=this._option.getAllRegions(),this._initEvent()},i.prototype.release=function(){var t,i,n=this;e.prototype.release.call(this),this._eventList.forEach((function(t){var e=t.eventType,i=t.handler;n.event.off(e,i)})),this._eventList=[],null===(i=null===(t=this.tooltipHandler)||void 0===t?void 0:t.release)||void 0===i||i.call(t),this._isTooltipShown=!1},i.prototype.beforeRelease=function(){this.event.emit(t.ChartEvent.tooltipHide,{tooltip:this}),this.event.emit(t.ChartEvent.tooltipRelease,{tooltip:this})},i.prototype._initHandler=function(){var t,e,i,n=null!==(t=this._spec.renderMode)&&void 0!==t?t:"html",r=this._option.globalInstance.getTooltipHandlerByUser();if(r)this.tooltipHandler=r;else{var o="canvas"===n?C4:M4,a="".concat(this._spec.className,"-").concat(null!==(e=this._option.globalInstance.id)&&void 0!==e?e:0,"-").concat(null!==(i=this._option.specIndex)&&void 0!==i?i:0);this.tooltipHandler=new o(a,this)}},i.prototype._initProcessor=function(){this._processor={mark:new z4(this),dimension:new I4(this)}},i.prototype._initEvent=function(){var e;if(!this._option.disableTriggerEvent){var i=null!==(e=this._spec.trigger)&&void 0!==e?e:"hover",n=this._option.mode;"hover"===i?(this._mountEvent("pointermove",{level:t.Event_Bubble_Level.chart},this._handleMouseMove),(Xk(n)||Zk(n))&&(this._mountEvent("pointerdown",{level:t.Event_Bubble_Level.chart},this._handleMouseMove),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerout",{source:"canvas"},this._getMouseOutHandler(!1))):"click"===i&&(this._mountEvent("pointertap",{level:t.Event_Bubble_Level.chart},this._handleMouseMove),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0)))}},i.prototype.reInit=function(t){var i,n;e.prototype.reInit.call(this,t),this.tooltipHandler?null===(n=(i=this.tooltipHandler).reInit)||void 0===n||n.call(i):this._initHandler()},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this);var i=this._spec;this._spec=o(o({},i),{visible:!T(i.visible)||i.visible,activeType:UK(i),renderMode:"html",trigger:T(i.trigger)?i.trigger:"hover",className:T(i.className)?i.className:"vchart-tooltip-element",enterable:!!T(i.enterable)&&i.enterable,transitionDuration:T(i.transitionDuration)?i.transitionDuration:150}),this._spec.triggerOff=T(i.triggerOff)?i.triggerOff:this._spec.trigger,T(i.renderMode)?this._spec.renderMode=i.renderMode:Zk(this._option.mode)&&(this._spec.renderMode="canvas"),T(i.mark)&&(this._spec.mark=o(o({},X(i.mark)),{activeType:"mark"})),T(i.dimension)&&(this._spec.dimension=o(o({},X(i.dimension)),{activeType:"dimension"})),T(i.parentElement)?P(i.parentElement)?this._spec.parentElement=null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.document)||void 0===t?void 0:t.getElementById(i.parentElement):this._spec.parentElement=i.parentElement:Kk(this._option.mode)&&(this._spec.parentElement=null==Yk?void 0:Yk.body),T(i.confine)?this._spec.confine=i.confine:this._spec.confine="canvas"===this._spec.renderMode},i.prototype.showTooltip=function(t,e){var i;if(this.tooltipHandler||this._initHandler(),this._processor||this._initProcessor(),!(null===(i=this.tooltipHandler)||void 0===i?void 0:i.showTooltip))return!1;var n=B4(t,e,this.tooltipHandler,this._option);return"none"!==n&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),n},i.prototype.hideTooltip=function(){var e={changePositionOnly:!1,item:void 0,datum:void 0,source:t.Event_Source_Type.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(e)},i.prototype._isSameAsCacheInfo=function(t){if(t===this._cacheInfo)return!0;if(w(this._cacheInfo)||w(t))return!1;if(F4(t)){if(D4(this._cacheInfo))return!1;var e=this._cacheInfo;return e.length===t.length&&t.every((function(t,i){return zU(t,e[i])}))}if(F4(this._cacheInfo))return!1;var i=this._cacheInfo;return(null==t?void 0:t.datum)===i.datum&&(null==t?void 0:t.mark)===i.mark&&(null==t?void 0:t.series)===i.series},i.prototype._isPointerInChart=function(t){var e=this._option.globalInstance;if(!e.getChart())return!1;var i=t.x,n=t.y,r=e.getCanvas().getBoundingClientRect(),o=r.x,a=r.y,s=r.width,l=r.height;return i>=o&&i<=o+s&&n>=a&&n<=a+l},i.prototype._isPointerOnTooltip=function(t){var e,i;if(this._spec.enterable&&"html"===this._spec.renderMode){var n=t.event,r=void 0;if(T(n.nativeEvent)){var o=n.nativeEvent;r=o.relatedTarget,o.composedPath&&o.composedPath().length>0&&(r=o.composedPath()[0])}else r=n.relatedTarget;var a=null===(i=null===(e=this.tooltipHandler)||void 0===e?void 0:e.getTooltipContainer)||void 0===i?void 0:i.call(e);if(T(a)&&T(r)&&function(t,e){for(var i=t.parentNode;null!==i;){if(i===e)return!0;i=i.parentNode}return!1}(r,a))return!0}return!1},i.prototype.getVisible=function(){return!1!==this._spec.visible},i.type=f.tooltip,i.transformerConstructor=j4,i.specKey="tooltip",i}(fq),N4=function(){FU.registerComponent(H4.type,H4)};!function(t){t[t.ALL=3]="ALL",t[t.HORIZONTAL=2]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.NONE=0]="NONE"}(L4||(L4={}));var V4={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]},G4=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.specKey="crosshair",r.layoutType="none",r.gridZIndex=t.LayoutZIndex.CrossHair_Grid,r.labelZIndex=t.LayoutZIndex.CrossHair,r.trigger="hover",r.triggerOff="hover",r._handleEvent=Bt((function(t){if(r._option){var e=t.event,i=r._option.getCompiler().getStage().getLayer(void 0),n={x:e.viewX,y:e.viewY};i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},n);var o=n.x-r.getLayoutStartPoint().x,a=n.y-r.getLayoutStartPoint().y;r.showDefault=!1,r._layoutCrosshair(o,a)}}),10),r.enable=!0,r.showDefault=!0,r}return r(i,e),Object.defineProperty(i.prototype,"enableRemain",{get:function(){return"none"===this.triggerOff},enumerable:!1,configurable:!0}),i.prototype._getLimitBounds=function(){var t,e;if(!this._limitBounds){var i=null!==(e=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getCanvasRect())&&void 0!==e?e:{width:0,height:0},n=i.width,r=i.height;this._limitBounds={x1:0,y1:0,x2:n,y2:r}}return this._limitBounds},i.prototype._showDefaultCrosshair=function(){this.showDefault&&this._showDefaultCrosshairBySpec()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._parseCrosshairSpec()},i.prototype.created=function(){e.prototype.created.call(this),this._initEvent()},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||nt(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype._initEvent=function(){var t=this;if(!this._option.disableTriggerEvent){var e=this._getTriggerEvent();if(e){var i=e.in,n=e.out;lt(i).forEach((function(e,i){return t._registerEvent(e,B(n)?n[i]:n)}))}}},i.prototype._registerEvent=function(e,i){var n=this;this.event.on(e,{source:t.Event_Source_Type.chart},this._handleEvent),this.event.on(i,{level:t.Event_Bubble_Level.chart},(function(){n.enableRemain||n.hide()}))},i.prototype._eventOff=function(t){this.event.off(t,this._handleEvent)},i.prototype.updateLayoutAttribute=function(){this._limitBounds=null,this._showDefaultCrosshair()},i.prototype._getTriggerEvent=function(){var e=this._option.mode,i=function(e){return e===t.RenderModeEnum["desktop-browser"]||e===t.RenderModeEnum["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:Xk(e)||Zk(e)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null}(void 0===e?t.RenderModeEnum["desktop-browser"]:e);if(i){var n=this.trigger||"hover",r=function(t){return"click"===t?"clickOut":"hoverOut"};if(B(n)){var o=[],a=[];return n.forEach((function(t){o=o.concat(i[t]),a=a.concat(i[r(t)])})),{in:o,out:a}}return{in:i[n],out:i[r(n)]}}return null},i.prototype._getAxisInfoByField=function(t){var e,i,n=null===(i=null===(e=this._option)||void 0===e?void 0:e.getComponentsByKey)||void 0===i?void 0:i.call(e,"axes");if(!(null==n?void 0:n.length))return null;var r=U(this._spec,"".concat(t,"Field.bindingAxesIndex"));if(r||(r=[],n.forEach((function(e,i){V4[t].includes(e.getOrient())&&r.push(i)}))),!r.length)return null;var o=new Map,a=1/0,s=1/0,l=-1/0,u=-1/0,c=this.getLayoutStartPoint(),h=c.x,d=c.y;return r.forEach((function(t){a=1/0,s=1/0,l=-1/0,u=-1/0;var e=n.find((function(e){return e.getSpecIndex()===t}));e&&(e.getRegions().forEach((function(t){var e=t.getLayoutStartPoint(),i=e.x,n=e.y;a=Math.min(a,i-h),s=Math.min(s,n-d),l=Math.max(l,i+t.getLayoutRect().width-h),u=Math.max(u,n+t.getLayoutRect().height-d)})),o.set(t,{x1:a,y1:s,x2:l,y2:u,axis:e}))})),o},i.prototype.changeRegions=function(t){},i.prototype.onLayoutEnd=function(t){var i=this._regions[0];this.setLayoutRect(i.getLayoutRect()),this.setLayoutStartPosition(i.getLayoutStartPoint()),e.prototype.onLayoutEnd.call(this,t)},i.prototype.onRender=function(t){},i.prototype._releaseEvent=function(){var t=this,e=this._getTriggerEvent();if(e){var i=e.in,n=e.out;B(i)?i.forEach((function(e){return t._eventOff(e)})):this._eventOff(i),B(n)?n.forEach((function(e){return t._eventOff(e)})):this._eventOff(n)}},i.prototype._firstSeries=function(){for(var t=0;t<this._regions.length;t++)for(var e=this._regions[t].getSeries(),i=0;i<e.length;i++){var n=e[i];if(n)return n}return null},i.prototype._parseCrosshairSpec=function(){this._parseFieldInfo();var t=this._spec,e=t.trigger,i=t.triggerOff,n=t.labelZIndex,r=t.gridZIndex;e&&(this.trigger=e),this.triggerOff=i||this.trigger,void 0!==n&&(this.labelZIndex=n),void 0!==r&&(this.gridZIndex=r)},i.prototype._parseField=function(t,e){var i,n,r,s,l={},u=t.line,c=void 0===u?{}:u,h=t.label,d=void 0===h?{}:h,f=t.visible;l.visible=f,l.type=c.type||"line";var p=c.style||{},v=p.strokeOpacity,y=p.fillOpacity,g=p.opacity,m=p.stroke,_=p.fill,b=p.lineWidth,x=a(p,["strokeOpacity","fillOpacity","opacity","stroke","fill","lineWidth"]),k="line"===l.type,A=k?v:y;if(I(g)&&(A=(null!=A?A:1)*g),l.style=!1===(null==c?void 0:c.visible)?{visible:!1}:o({opacity:A,pickable:!1,visible:!0},x),k)l.style.stroke=m||_,l.style.lineWidth=U(c,"width",b||2);else{l.style.fill=_||m,(null===(r=null===(n=null===(i=this._spec[e])||void 0===i?void 0:i.line)||void 0===n?void 0:n.style)||void 0===r?void 0:r.stroke)&&(l.style.stroke=this._spec[e].line.style.stroke);var w=U(c,"width");if("string"==typeof w){var T=parseInt(w.substring(0,w.length-1),10)/100;l.style.sizePercent=T}else"number"!=typeof w&&"function"!=typeof w||(l.style.size=w)}var M=d.labelBackground||{},C=d.style||{},E=M.style||{},R=E.fill,P=void 0===R?"rgba(47, 59, 82, 0.9)":R,B=E.stroke,L=E.outerBorder,O=a(E,["fill","stroke","outerBorder"]);return l.label=(null==d?void 0:d.visible)?{visible:!0,formatMethod:d.formatMethod,minWidth:M.minWidth,maxWidth:M.maxWidth,padding:M.padding,textStyle:o(o({fontSize:14,pickable:!1},C),{fill:null!==(s=C.fill)&&void 0!==s?s:"#fff",stroke:U(C,"stroke")}),panel:(S(null==M?void 0:M.visible)?null==M?void 0:M.visible:M)?o({visible:!0,pickable:!1,fill:P,stroke:B,outerBorder:o({stroke:P,distance:0,lineWidth:3},L)},O):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}:{visible:!1},l},i.prototype._filterAxisByPoint=function(t,e,i){return t&&t.forEach((function(n){var r,o,a,s=n.axis;if(o=e,a=i,((r=n).x1>o||r.x2<o||r.y1>a||r.y2<a)&&t.delete(s.getSpecIndex()),s.type.startsWith("polarAxis")){var l=s.getCenter(),u=s.getInnerRadius(),c=s.getOuterRadius(),h=se.distancePP({x:e,y:i},l);(h>c||h<u)&&t.delete(s.getSpecIndex())}})),t},i.specKey="crosshair",i}(fq),W4=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=f.cartesianCrosshair,n.name=f.cartesianCrosshair,n._currValueX=new Map,n._currValueY=new Map,n}return r(e,t),e.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!w(i)){if(!B(i))return i.xField||i.yField?[{spec:i,specPath:[this.specKey],type:f.cartesianCrosshair}]:void 0;var n=[];return i.forEach((function(t,i){(t.xField||t.yField)&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.cartesianCrosshair})})),n}},e.prototype._showDefaultCrosshairBySpec=function(){var t=this._spec,e=t.xField,i=t.yField;if((null==e?void 0:e.visible)&&e.defaultSelect){var n=e.defaultSelect,r=n.axisIndex,o=n.datum;this._defaultCrosshair(r,o,1)}if((null==i?void 0:i.visible)&&i.defaultSelect){var a=i.defaultSelect;r=a.axisIndex,o=a.datum;this._defaultCrosshair(r,o,2)}},e.prototype._defaultCrosshair=function(t,e,i){var n=this._option.getComponentsByKey("axes").find((function(e){return e.getSpecIndex()===t}));n&&(1===i?(this._currValueX.clear(),this._currValueX.set(t,{axis:n,v:e})):(this._currValueY.clear(),this._currValueY.set(t,{axis:n,v:e})),this.layoutByValue(i))},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("x"),n=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getValueAt=function(t,e){var i=t.getScale().invert(e);return gS(t.getScale().type)&&F(+i)&&(i=(+i).toFixed(2)),i},e.prototype.clearAxisValue=function(){this._currValueX.clear(),this._currValueY.clear()},e.prototype.setAxisValue=function(t,e){VU(e.getOrient())?this._currValueX.set(e.getSpecIndex(),{v:t,axis:e}):this._currValueY.set(e.getSpecIndex(),{v:t,axis:e})},e.prototype._getAllAxisValues=function(t,e,i,n){var r=this,o=!1;return t.forEach((function(t){_S(t.axis.getScale().type)&&(o?r.enable=!1:o=!0)})),!!this.enable&&(t.forEach((function(t,o){var a=t.axis;i.set(o,{v:r._getValueAt(a,e-(n?a.getLayoutStartPoint().x-r.getLayoutStartPoint().x:a.getLayoutStartPoint().y-r.getLayoutStartPoint().y)),axis:a})})),!0)},e.prototype._layoutCrosshair=function(t,e){var i=this._findAllAxisContains(t,e),n=i.xAxisMap,r=i.yAxisMap;if(n&&0===n.size||r&&0===r.size){if(this.enableRemain)return;this.hide()}else this._currValueX.clear(),this._currValueY.clear(),n&&n.size&&this._getAllAxisValues(n,t,this._currValueX,!0),r&&r.size&&this._getAllAxisValues(r,e,this._currValueY,!1),this.layoutByValue(3)},e.prototype.hide=function(){this._xCrosshair&&this._xCrosshair.hideAll(),this._xTopLabel&&this._xTopLabel.hideAll(),this._xBottomLabel&&this._xBottomLabel.hideAll(),this._yCrosshair&&this._yCrosshair.hideAll(),this._yLeftLabel&&this._yLeftLabel.hideAll(),this._yRightLabel&&this._yRightLabel.hideAll()},e.prototype.layoutByValue=function(t){var e,i,n,r,a=this;if(void 0===t&&(t=3),this.enable){var s=this._firstSeries();if(s){var l={height:0,leftPos:0,rightPos:0,topPos:0,x:0,bottom:{visible:!1,text:"",dx:0,dy:0},top:{visible:!1,text:"",dx:0,dy:0},visible:!1,axis:null},u={width:0,leftPos:0,topPos:0,bottomPos:0,y:0,left:{visible:!1,text:"",dx:0,dy:0},right:{visible:!1,text:"",dx:0,dy:0},visible:!1,axis:null},c=function(t,e){e.forEach((function(e){e.axis.getRegions().forEach((function(e){t.x1=Math.min(t.x1,e.getLayoutStartPoint().x),t.y1=Math.min(t.y1,e.getLayoutStartPoint().y),t.x2=Math.max(t.x2,e.getLayoutStartPoint().x+e.getLayoutRect().width),t.y2=Math.max(t.y2,e.getLayoutStartPoint().y+e.getLayoutRect().height)}))}))},h=0,d=0;if(this._currValueX.size){var f=Array.from(this._currValueX.values())[0];h=f.axis.getScale().scale(f.v)+f.axis.getLayoutStartPoint().x-this.getLayoutStartPoint().x,l.axis=f.axis}if(this._currValueY.size){f=Array.from(this._currValueY.values())[0];d=f.axis.getScale().scale(f.v)+f.axis.getLayoutStartPoint().y-this.getLayoutStartPoint().y,u.axis=f.axis}l.visible=!!this._currValueX.size&&Number.isFinite(h),u.visible=!!this._currValueY.size&&Number.isFinite(d);var p,v={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0},y={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};c(v,this._currValueX),c(y,this._currValueY);var g,m=0,_=0;if(this._xHair&&this._currValueX.forEach((function(t){var e,i=t.axis,n=t.v;n=null!=n?n:"";var r=i.getScale();if(_S(r.type))0===(p=r.bandwidth())&&r.step&&(m=r.step());else if(gS(r.type)){var o=s.fieldX[0],u=s.fieldX2,c=sq(s.getViewData().latestData,+n,o,u);if(c){var d=s.dataToPositionX(c);u?(p=Math.abs(d-s.dataToPositionX1(c)),n="".concat(c[o]," ~ ").concat(c[u])):p=1,h=d}}if(null===(e=a._xHair.label)||void 0===e?void 0:e.visible){var f=$Z(i.getSpec());"bottom"===i.getOrient()?(l.bottom.visible=!0,l.bottom.text=n,l.bottom.dx=0,l.bottom.dy=f):"top"===i.getOrient()&&(l.top.visible=!0,l.top.text=n,l.top.dx=0,l.top.dy=-f)}})),this._yHair&&this._currValueY.forEach((function(t){var e,i=t.axis,n=t.v;n=null!=n?n:"";var r=i.getScale();if(_S(r.type))0===(g=r.bandwidth())&&r.step&&(_=r.step());else if(gS(r.type)){var o=s.fieldY[0],l=s.fieldY2,c=sq(s.getViewData().latestData,+n,o,l);if(c){var h=s.dataToPositionY(c);l?(g=Math.abs(h-s.dataToPositionY1(c)),n="".concat(c[o]," ~ ").concat(c[l])):g=1,d=h}}if(null===(e=a._yHair.label)||void 0===e?void 0:e.visible){var f=$Z(i.getSpec());"left"===i.getOrient()?(u.left.visible=!0,u.left.text=n,u.left.dx=-f,u.left.dy=0):"right"===i.getOrient()&&(u.right.visible=!0,u.right.text=n,u.right.dx=f,u.right.dy=0)}})),this.enableRemain&&!l.visible&&T(this._cacheXCrossHairInfo))l=this._cacheXCrossHairInfo;else if(l.leftPos=v.x1,l.rightPos=v.x2,l.topPos=v.y1,l.height=v.y2-v.y1,l.x=h+this.getLayoutStartPoint().x,null===(i=null===(e=this._xHair)||void 0===e?void 0:e.label)||void 0===i?void 0:i.formatMethod){var b=l.top,x=l.bottom;x.visible&&(x.text=this._xHair.label.formatMethod(x.text,"bottom")),b.visible&&(b.text=this._xHair.label.formatMethod(b.text,"top"))}if(this.enableRemain&&!u.visible&&T(this._cacheYCrossHairInfo))u=this._cacheYCrossHairInfo;else if(u.leftPos=y.x1,u.topPos=y.y1,u.bottomPos=y.y2,u.width=y.x2-y.x1,u.y=d+this.getLayoutStartPoint().y,null===(r=null===(n=this._yHair)||void 0===n?void 0:n.label)||void 0===r?void 0:r.formatMethod){var k=u.left,S=u.right;k.visible&&(k.text=this._yHair.label.formatMethod(k.text,"left")),S.visible&&(S.text=this._yHair.label.formatMethod(S.text,"right"))}t&&(this._layoutHorizontal(u,null!=g?g:0,_),this._layoutVertical(l,null!=p?p:0,m)),this.enableRemain&&(this._cacheXCrossHairInfo=o(o({},l),{_isCache:!0}),this._cacheYCrossHairInfo=o(o({},u),{_isCache:!0}))}}},e.prototype._layoutVertical=function(t,e,i){var n,r,a=this;if(!(t._isCache&&this.enableRemain||!this._xHair)){var s=t.x,l=t.topPos,u=t.height,c=t.top,h=t.bottom;if(t.visible){var d=this._xHair.type,f=void 0;if("line"===d)f={start:{x:s+e/2,y:l},end:{x:s+e/2,y:l+u}};else if("rect"===d){var p=this._getRectSize(this._xHair,e,t.axis),v=t.leftPos,y=t.rightPos;f={start:{x:Math.max(s-p/2-i/2,v),y:l},end:{x:Math.min(s+e+p/2+i/2,y),y:l+u}}}if(this._updateCrosshair("x",d,f),c.visible){var g=o(o(o({x:s+e/2,y:l},c),this._xHair.label),{textStyle:o(o({},null===(n=this._xHair.label)||void 0===n?void 0:n.textStyle),{textAlign:"center",textBaseline:"bottom"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._xTopLabel,g,(function(t){t.name="crosshair-x-top-label",a._xTopLabel=t}))}else this._xTopLabel&&this._xTopLabel.hideAll();if(h.visible){g=o(o(o({x:s+e/2,y:l+u},h),this._xHair.label),{textStyle:o(o({},null===(r=this._xHair.label)||void 0===r?void 0:r.textStyle),{textAlign:"center",textBaseline:"top"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._xBottomLabel,g,(function(t){t.name="crosshair-x-bottom-label",a._xBottomLabel=t}))}else this._xBottomLabel&&this._xBottomLabel.hideAll()}}},e.prototype._layoutHorizontal=function(t,e,i){var n,r,a=this;if(!(t._isCache&&this.enableRemain||!this._yHair)){var s=t.leftPos,l=t.width,u=t.y,c=t.left,h=t.right;if(t.visible){var d=this._yHair.type,f=void 0;if("line"===d)f={start:{x:s,y:u+e/2},end:{x:s+l,y:u+e/2}};else if("rect"===d){var p=this._getRectSize(this._yHair,e,t.axis),v=t.topPos,y=t.bottomPos;f={start:{x:s,y:Math.max(u-p/2-i/2,v)},end:{x:s+l,y:Math.min(u+e+p/2+i/2,y)}}}if(this._updateCrosshair("y",d,f),c.visible){var g=o(o(o({x:s,y:u+e/2},c),this._yHair.label),{textStyle:o(o({},null===(n=this._yHair.label)||void 0===n?void 0:n.textStyle),{textAlign:"right",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yLeftLabel,g,(function(t){t.name="crosshair-y-left-label",a._yLeftLabel=t}))}else this._yLeftLabel&&this._yLeftLabel.hideAll();if(h.visible){g=o(o(o({x:s+l,y:u+e},h),this._yHair.label),{textStyle:o(o({},null===(r=this._yHair.label)||void 0===r?void 0:r.textStyle),{textAlign:"left",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yRightLabel,g,(function(t){t.name="crosshair-y-right-label",a._yRightLabel=t}))}else this._yRightLabel&&this._yRightLabel.hideAll()}}},e.prototype._getRectSize=function(t,e,i){var n,r,o,a=0;if(null===(n=t.style)||void 0===n?void 0:n.sizePercent)a=(t.style.sizePercent-1)*e;else if("number"==typeof(null===(r=t.style)||void 0===r?void 0:r.size))a=t.style.size-e;else if("function"==typeof(null===(o=t.style)||void 0===o?void 0:o.size)){var s=i.getLayoutRect();a=t.style.size(s,i)-e}return a},e.prototype._parseFieldInfo=function(){var t=this._spec,e=t.xField,i=t.yField;e&&e.visible&&(this._xHair=this._parseField(e,"xField")),i&&i.visible&&(this._yHair=this._parseField(i,"yField"))},e.prototype._updateCrosshair=function(t,e,i){var n,r,a=this.getContainer();"x"===t?(n=this._xCrosshair,r=this._xHair.style):(n=this._yCrosshair,r=this._yHair.style),n?n.setAttributes(i):("line"===e?n=new BO(o(o({},i),{lineStyle:r,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent})):"rect"===e&&(n=new OO(o(o({},i),{rectStyle:r,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent}))),null==a||a.add(n),"x"===t?this._xCrosshair=n:this._yCrosshair=n)},e.prototype._updateCrosshairLabel=function(t,e,i){var n=this.getContainer();t?t.setAttributes(e):(i(t=new yO(e)),null==n||n.add(t)),aq(t,this._getLimitBounds())},e.prototype._getNeedClearVRenderComponents=function(){return[this._xCrosshair,this._xTopLabel,this._xBottomLabel,this._yCrosshair,this._yLeftLabel,this._yRightLabel]},e.specKey="crosshair",e.type=f.cartesianCrosshair,e}(G4),U4=function(){FU.registerComponent(W4.type,W4)},Y4=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.type=f.polarCrosshair,n.name=f.polarCrosshair,n._currValueAngle=new Map,n._currValueRadius=new Map,n}return r(e,t),e.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!w(i)){if(!B(i))return i.categoryField||i.valueField?[{spec:i,specPath:[this.specKey],type:f.polarCrosshair}]:void 0;var n=[];return i.forEach((function(t,i){(t.categoryField||t.valueField)&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.polarCrosshair})})),n}},e.prototype._showDefaultCrosshairBySpec=function(){var t=this._spec,e=t.categoryField,i=t.valueField;if((null==e?void 0:e.visible)&&e.defaultSelect){var n=e.defaultSelect,r=n.axisIndex,o=n.datum;this._defaultCrosshair(r,o,1)}if((null==i?void 0:i.visible)&&i.defaultSelect){var a=i.defaultSelect;r=a.axisIndex,o=a.datum;this._defaultCrosshair(r,o,2)}},e.prototype._defaultCrosshair=function(t,e,i){var n=this._option.getComponentsByKey("axes").find((function(e){return e.getSpecIndex()===t}));if(n){if(1===i){this._currValueAngle.clear();var r={angle:n.valueToPosition(e),radius:n.getOuterRadius()},o=n.coordToPoint(r);this._currValueAngle.set(t,this._getValueByAxis(n,o))}else{this._currValueRadius.clear();r={angle:n.startAngle,radius:n.valueToPosition(e)},o=n.coordToPoint(r);this._currValueRadius.set(t,this._getValueByAxis(n,o))}this.layoutByValue(3)}},e.prototype.hide=function(){this._radiusCrosshair&&this._radiusCrosshair.hideAll(),this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll(),this._angleCrosshair&&this._angleCrosshair.hideAll(),this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()},e.prototype._findAllAxisContains=function(t,e){var i=this._getAxisInfoByField("category"),n=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(n,t,e)}},e.prototype._getAllAxisValues=function(t,e,i){var n=this,r=!1;return t.forEach((function(t){_S(t.axis.getScale().type)&&(r?n.enable=!1:r=!0)})),!!this.enable&&(t.forEach((function(t,r){var o=t.axis;i.set(r,n._getValueByAxis(o,e))})),!0)},e.prototype._getValueByAxis=function(t,e){var i=t.getLayoutStartPoint(),n=i.x,r=i.y,o=this.getLayoutStartPoint(),a=o.x,s=o.y,l=t.positionToData({x:e.x-(n-a),y:e.y-(r-s)});gS(t.getScale().type)&&F(+l)&&(l=(+l).toFixed(2));var u={x:t.getCenter().x+this.getLayoutStartPoint().x,y:t.getCenter().y+this.getLayoutStartPoint().y};return{v:l,axis:t,center:u,innerRadius:t.getInnerRadius(),radius:t.getOuterRadius(),startAngle:t.startAngle,endAngle:t.endAngle,distance:se.distancePP(e,t.getCenter()),coord:t.pointToCoord(e),point:e}},e.prototype._layoutCrosshair=function(t,e){var i=this._findAllAxisContains(t,e),n=i.angleAxisMap,r=i.radiusAxisMap;if(0!==n.size||0!==r.size)this._currValueAngle.clear(),this._currValueRadius.clear(),n&&this._getAllAxisValues(n,{x:t,y:e},this._currValueAngle),r&&this._getAllAxisValues(r,{x:t,y:e},this._currValueRadius),this.layoutByValue(3);else{if(this.enableRemain)return;this.hide()}},e.prototype.layoutByValue=function(t){var e,i,n,r,s=this;if(void 0===t&&(t=3),this.enable){var l=this._firstSeries();if(l){var u,c={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,label:{visible:!1,text:"",offset:0}},h={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,sides:l.angleAxisHelper.getScale(0).ticks().length,label:{visible:!1,text:"",offset:0}};if(this._angleHair){c.visible=!!this._currValueAngle.size;var d=l.angleAxisHelper.getBandwidth(0);this._currValueAngle.forEach((function(t){var e,i=t.axis,n=t.v;t.coord;var r=a(t,["axis","v","coord"]);n=null!=n?n:"",$W(c,r);var o=l.angleAxisHelper.dataToPosition([n]);c.angle=o,(null===(e=s._angleHair.label)||void 0===e?void 0:e.visible)&&(c.label.visible=!0,c.label.text=n,c.label.offset=$Z(i.getSpec())),c.startAngle=o-d/2,c.endAngle=o+d/2}))}if(this._radiusHair&&(h.visible=!!this._currValueRadius.size,this._currValueRadius.forEach((function(t){var e,i=t.axis,n=t.v,r=t.coord,o=a(t,["axis","v","coord"]);n=null!=n?n:"",(null===(e=s._radiusHair.label)||void 0===e?void 0:e.visible)&&(h.label.visible=!0,h.label.text=n,h.label.offset=$Z(i.getSpec())),h.angle=r.angle,h.axis=i,$W(h,o)}))),this.enableRemain&&!c.visible&&T(this._cacheAngleCrossHairInfo))c=this._cacheAngleCrossHairInfo;else if((null===(i=null===(e=this._angleHair)||void 0===e?void 0:e.label)||void 0===i?void 0:i.formatMethod)&&c.label.visible)(u=c.label).text=this._angleHair.label.formatMethod(u.text,"angle");if(this.enableRemain&&!h.visible&&T(this._cacheRadiusCrossHairInfo))h=this._cacheRadiusCrossHairInfo;else if((null===(r=null===(n=this._radiusHair)||void 0===n?void 0:n.label)||void 0===r?void 0:r.formatMethod)&&h.label.visible)(u=h.label).text=this._radiusHair.label.formatMethod(u.text,"radius");t&&(this._layoutHorizontal(h),this._layoutVertical(c)),this.enableRemain&&(this._cacheAngleCrossHairInfo=o(o({},c),{_isCache:!0}),this._cacheRadiusCrossHairInfo=o(o({},h),{_isCache:!0}))}}},e.prototype._layoutVertical=function(t){var e,i=this;if(!t._isCache||!this.enableRemain){var n=this.getContainer(),r=t.angle,a=t.innerRadius,s=t.radius,l=t.label,u=t.startAngle,c=t.endAngle,h=t.center;if(t.visible){var d="rect"===this._angleHair.type?"sector":"line",f=void 0;if(f="sector"===d?{center:h,innerRadius:a,radius:s,startAngle:u,endAngle:c}:{start:be(h,a,r),end:be(h,s,r)},this._angleCrosshair)this._angleCrosshair.setAttributes(f);else{var p=void 0;"line"===d?p=new BO(o(o({},f),{lineStyle:this._angleHair.style,zIndex:this.gridZIndex})):"sector"===d&&(p=new zO(o(o({},f),{sectorStyle:this._angleHair.style,zIndex:this.gridZIndex}))),this._angleCrosshair=p,n.add(p)}if(l.visible){var v=CA(r),y=o(o(o(o({},be(h,s+l.offset,r)),this._angleHair.label),l),{textStyle:o(o({},null===(e=this._angleHair.label)||void 0===e?void 0:e.textStyle),{textAlign:v.align,textBaseline:v.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._angleLabelCrosshair,y,(function(t){t.name="crosshair-angle-label",i._angleLabelCrosshair=t}))}else this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()}}},e.prototype._layoutHorizontal=function(t){var e,i=this;if(!t._isCache||!this.enableRemain){var n=t.center,r=t.startAngle,a=t.endAngle,s=t.distance,l=t.sides,u=t.axis,c=t.label,h=t.point,d=t.radius,f=t.innerRadius,p=t.visible,v=this.getContainer();if(p){var y=this._radiusHair.smooth?"circle":"polygon",g=s;if("polygon"===y){var m=u.getCenter(),_=xe(m,h),b=(a-r)/l,x=Math.floor((_-r)/b),k=x*b+r,S=Math.min((x+1)*b+r,a),A=be(m,s,k),w=be(m,s,S),T=qe([w.x,w.y],[A.x,A.y],[m.x,m.y],[h.x,h.y]);T&&(g=Tt(se.distancePN(h,T[0],T[1])+s,f,d))}var M={center:n,startAngle:r,endAngle:a,radius:g,sides:l};if(this._radiusCrosshair)this._radiusCrosshair.setAttributes(M);else{var C=void 0;C="polygon"===y?new HO(o(o({},M),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex+1})):new DO(o(o({},M),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex})),this._radiusCrosshair=C,v.add(C)}if(c.visible){var E=function(t){return{align:(t=MA(t))>=Math.PI*(7/6)&&t<=Math.PI*(11/6)?"right":t>=Math.PI*(1/6)&&t<=Math.PI*(5/6)?"left":"center",baseline:t>=Math.PI*(5/3)||t<=Math.PI*(1/3)?"bottom":t>=Math.PI*(2/3)&&t<=Math.PI*(4/3)?"top":"middle"}}(r),R=o(o(o(o({},be(n,g,r)),this._radiusHair.label),c),{textStyle:o(o({},null===(e=this._radiusHair.label)||void 0===e?void 0:e.textStyle),{textAlign:E.align,textBaseline:E.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._radiusLabelCrosshair,R,(function(t){t.name="crosshair-radius-label",i._radiusLabelCrosshair=t}))}else this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll()}}},e.prototype._parseFieldInfo=function(){var t,e=this._spec,i=e.categoryField,n=e.valueField;i&&i.visible&&(this._angleHair=this._parseField(i,"categoryField")),n&&n.visible&&(this._radiusHair=this._parseField(n,"valueField"),this._radiusHair.smooth=null===(t=null==n?void 0:n.line)||void 0===t?void 0:t.smooth)},e.prototype._updateCrosshairLabel=function(t,e,i){var n=this.getContainer();t?t.setAttributes(e):(t=new yO(e),null==n||n.add(t),i(t)),aq(t,this._getLimitBounds())},e.prototype._getNeedClearVRenderComponents=function(){return[this._radiusCrosshair,this._radiusLabelCrosshair,this._angleCrosshair,this._angleLabelCrosshair]},e.specKey="crosshair",e.type=f.polarCrosshair,e}(G4),K4=function(){FU.registerComponent(Y4.type,Y4)},X4=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.layoutType="none",n._orient="left",n._cacheVisibility=void 0,n._stateField="x",n._activeRoam=!0,n._zoomAttr={enable:!0,rate:1,focus:!0},n._dragAttr={enable:!0,rate:1,reverse:!0},n._scrollAttr={enable:!0,rate:1,reverse:!0},n.effect={onZoomChange:function(t){var e,i,r=n._relatedAxisComponent;if(r&&"axis"===n._filterMode){var o=r.getScale(),a=r.getSpec();n._auto&&n._getAxisBandSize(a)&&n._spec.ignoreBandSize&&(o.bandwidth("auto"),o.maxBandwidth("auto"),o.minBandwidth("auto")),n._updateRangeFactor(t,"zoomChange"),null===(i=null===(e=n._component)||void 0===e?void 0:e.setStartAndEnd)||void 0===i||i.call(e,n._start,n._end),r.effect.scaleUpdate()}else tw(n._regions,(function(t){var e;null===(e=t.getViewData())||void 0===e||e.markRunning()}),{userId:n._seriesUserId,specIndex:n._seriesIndex}),tw(n._regions,(function(t){t.reFilterViewData()}),{userId:n._seriesUserId,specIndex:n._seriesIndex})}},n._visible=!0,n._handleStateChange=function(t,e,i){var r,o;return n._startValue=t,n._endValue=e,n._newDomain=n._parseDomainFromState(n._startValue,n._endValue),null===(o=(r=n.effect).onZoomChange)||void 0===o||o.call(r,i),!0},n._handleChartZoom=function(t){var e,i;if(n._activeRoam){var r=t.zoomDelta,o=t.zoomX,a=t.zoomY,s=n._regions[0].getLayoutStartPoint(),l=s.x,u=s.y,c=n._regions[0].getLayoutRect(),h=c.width,d=c.height,f=Math.abs(n._start-n._end),p=null!==(i=null===(e=n._spec.roamZoom)||void 0===e?void 0:e.rate)&&void 0!==i?i:1;if(!(f>=1&&r<1||f<=.01&&r>1)){var v=n._isHorizontal?o:a,y=f*(r-1)*p,g=y/2,m=y/2;if(v){var _=n._isHorizontal?l:u,b=n._isHorizontal?h:d;g=Math.abs(_-v)/Math.abs(b-_)*y,m=Math.abs(b-v)/Math.abs(b-_)*y}var x=Tt(n._start+g,0,1),k=Tt(n._end-m,0,1);n._handleChange(Math.min(x,k),Math.max(x,k),!0)}}},n._handleChartScroll=function(t,e){var i;if(!n._activeRoam)return!1;var r=t.scrollX,o=t.scrollY,a=n._isHorizontal?r:o,s=n._isHorizontal?Ut(r/o)>=.5:Ut(o/r)>=.5;return n._scrollAttr.reverse||(a=-a),s&&n._handleChartMove(a,null!==(i=n._scrollAttr.rate)&&void 0!==i?i:1),s},n._handleChartDrag=function(t,e){var i;if(n._activeRoam){var r=c(t,2),o=r[0],a=r[1],s=n._isHorizontal?o:a;n._dragAttr.reverse&&(s=-s),n._handleChartMove(s,null!==(i=n._dragAttr.rate)&&void 0!==i?i:1)}},n._handleChartMove=function(t,e){var i=n._isHorizontal?n.getLayoutRect().width:n.getLayoutRect().height;if(Math.abs(t)>=1e-6)if(t>0&&n._end<1){var r=Math.min(1-n._end,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}else if(t<0&&n._start>0){r=Math.max(-n._start,t/i)*e;n._handleChange(n._start+r,n._end+r,!0)}},n._orient=UU(t),n._isHorizontal="horizontal"===YU(n._orient),n}return r(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),i.prototype.setStartAndEnd=function(t,e,i){void 0===i&&(i=["percent","percent"]);var n=c(i,2),r=n[0],o=void 0===r?"percent":r,a=n[1],s=void 0===a?"percent":a,l="percent"===o?t:this._dataToStatePoint(t),u="percent"===s?e:this._dataToStatePoint(e);this._handleChange(l,u,!0)},i.prototype.enableInteraction=function(){this._activeRoam=!0},i.prototype.disableInteraction=function(){this._activeRoam=!1},i.prototype.zoomIn=function(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},i.prototype.zoomOut=function(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})},i.prototype._handleChange=function(t,e,i){var n,r;null!==(r=null===(n=this._spec)||void 0===n?void 0:n.zoomLock)&&void 0!==r&&r||e-t<this._minSpan||this._maxSpan},i.prototype._isReverse=function(){var t=this._relatedAxisComponent;if(!t)return!1;var e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)},i.prototype._updateRangeFactor=function(t,e){var i=this._relatedAxisComponent.getScale(),n=this._isReverse(),r=n?[1-this._end,1-this._start]:[this._start,this._end];if(n)switch(t){case"startHandler":i.rangeFactorEnd(r[1]);break;case"endHandler":i.rangeFactorStart(r[0]);break;default:i.rangeFactorStart(r[0],!0),i.rangeFactorEnd(r[1])}else switch(t){case"startHandler":i.rangeFactorStart(r[0]);break;case"endHandler":i.rangeFactorEnd(r[1]);break;default:i.rangeFactorEnd(r[1],!0),i.rangeFactorStart(r[0])}var o=i.rangeFactor();o?(this._start=n?1-o[1]:o[0],this._end=n?1-o[0]:o[1]):(this._start=0,this._end=1)},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!1,configurable:!0}),i.prototype.created=function(){e.prototype.created.call(this),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()},i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.prototype._setAxisFromSpec=function(){var t=this;if(T(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):T(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),w(this._spec.field)&&!this._relatedAxisComponent){var e=this._option.getComponentsByKey("axes"),i=e.find((function(e){return e._orient===t._orient}));if(i)this._relatedAxisComponent=i;else{var n=e.find((function(t){return!gS(t.getScale().type)}));this._relatedAxisComponent=n}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)},i.prototype._setRegionsFromSpec=function(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();var i=this._relatedAxisComponent?null===(e=(t=this._relatedAxisComponent).getBindSeriesFilter)||void 0===e?void 0:e.call(t):null;if(T(i)&&(T(i.userId)&&(this._seriesUserId=lt(i.userId)),T(i.specIndex)&&(this._seriesIndex=lt(i.specIndex))),T(this._spec.seriesId)){var n=lt(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter((function(t){return n.includes(t)})):this._seriesUserId=n}if(T(this._spec.seriesIndex)){var r=lt(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter((function(t){return r.includes(t)})):this._seriesIndex=r}if(T(this._spec.regionIndex)){var o=this._option.getRegionsInIndex(lt(this._spec.regionIndex));this._regions=this._regions.filter((function(t){return o.includes(t)}))}else if(T(this._spec.regionId)){var a=lt(this._spec.regionId);this._regions=a.length?this._regions.filter((function(t){return a.includes(t.id)})):[]}else;},i.prototype.onDataUpdate=function(){var t=this._computeDomainOfStateScale(gS(this._stateScale.type));this._stateScale.domain(t,!0),this._handleChange(this._start,this._end,!0)},i.prototype._computeDomainOfStateScale=function(t){var e=this,i=this._data.getLatestData().map((function(t){return t[e._stateField]}));if(t){var n=i.map((function(t){return 1*t}));return i.length?[ht(n),ct(n)]:[-1/0,1/0]}return i},i.prototype._initEvent=function(){this._initCommonEvent()},i.prototype._initData=function(){var t=this,e=[],i=[],n=[];if(this._relatedAxisComponent){var r={};tw(this._regions,(function(o){var a,s,l="cartesian"===o.coordinate?o.getXAxisHelper():"polar"===o.coordinate?o.angleAxisHelper:null,u="cartesian"===o.coordinate?o.getYAxisHelper():"polar"===o.coordinate?o.radiusAxisHelper:null;if(l&&u){var c=l.getAxisId()===t._relatedAxisComponent.id?l:u.getAxisId()===t._relatedAxisComponent.id?u:t._isHorizontal?l:u,h=c===l?u:l,d=gS(h.getScale(0).type);e.push(o.getRawData());var f=o.getSpec(),p=lt(f.xField),v=lt(f.yField),y="cartesian"===o.coordinate?p[0]:null!==(a=f.angleField)&&void 0!==a?a:f.categoryField,g="cartesian"===o.coordinate?v[0]:null!==(s=f.radiusField)&&void 0!==s?s:f.valueField;if(r[o.id]="link"===o.type?"from_xField":c===l?y:g,i.push(r[o.id]),t._valueField){var m="link"===o.type?"from_yField":h===l?y:g;n.push(d?m:null)}}}),{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=r}else w(this._spec.valueField),tw(this._regions,(function(r){e.push(r.getRawData()),i.push(t._field),t._valueField&&n.push(t._spec.valueField)}),{userId:this._seriesUserId,specIndex:this._seriesIndex});var o=this._option.dataSet;dY(o,"dataview",ka),hY(o,"dataFilterComputeDomain",uq);var a=new Ma(o,{name:"".concat(this.type,"_").concat(this.id,"_data")});a.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,stateFields:i,valueFields:n},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new dK(this._option,a),a.reRunAllTransform(),o.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))},i.prototype.setAttrFromSpec=function(){var t;e.prototype.setAttrFromSpec.call(this),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=Q({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=Q({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=Q({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null===(t=this._spec.visible)||void 0===t||t},i.prototype._statePointToData=function(t){var e=this._stateScale,i=e.range();this._isReverse()&&(i=i.slice().reverse());var n=i[0]+(i[1]-i[0])*t;return e.invert(n)},i.prototype._dataToStatePoint=function(t){var e=this._stateScale,i=e.scale(t),n=e.range();return!this._isHorizontal&&gS(e.type)&&(n=n.slice().reverse()),(i-n[0])/(n[1]-n[0])},i.prototype._modeCheck=function(t,e){return"start"===t?"percent"===e&&this._spec.start||"value"===e&&this._spec.startValue:"percent"===e&&this._spec.end||"value"===e&&this._spec.endValue},i.prototype._setStateFromSpec=function(){var t,e,i,n;if(this._auto=!!this._spec.auto,this._spec.rangeMode){var r=c(this._spec.rangeMode,2),o=r[0],a=r[1];this._modeCheck("start",o)&&this._modeCheck("end",a)&&(i="percent"===o?this._spec.start:this._dataToStatePoint(this._spec.startValue),n="percent"===a?this._spec.end:this._dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this._dataToStatePoint(this._spec.startValue):0,n=this._spec.end?this._spec.end:this._spec.endValue?this._dataToStatePoint(this._spec.endValue):1;this._startValue=this._statePointToData(i),this._endValue=this._statePointToData(n),this._start=i,this._end=n,this._minSpan=null!==(t=this._spec.minSpan)&&void 0!==t?t:0,this._maxSpan=null!==(e=this._spec.maxSpan)&&void 0!==e?e:1,gS(this._stateScale.type)&&this._stateScale.domain[0]!==this._stateScale.domain[1]&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(this._stateScale.domain()[1]-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(this._stateScale.domain()[1]-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))},i.prototype._parseFieldOfSeries=function(t){var e;return null===(e=this._originalStateFields)||void 0===e?void 0:e[t.id]},i.prototype._initStateScale=function(){var t=[0,1];if(this._relatedAxisComponent){var e=this._relatedAxisComponent.getScale(),i=gS(e.type),n=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){var r=n.map((function(t){return 1*t}));this._stateScale.domain(n.length?[ht(r),ct(r)]:[0,1],!0).range(t)}else this._stateScale.domain(n,!0).range(t)}else this._stateScale=new YS,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)},i.prototype.init=function(t){e.prototype.init.call(this,t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()},i.prototype._addTransformToSeries=function(){var t=this;this._relatedAxisComponent&&"axis"===this._filterMode||(hY(this._option.dataSet,"dataFilterWithNewDomain",lq),tw(this._regions,(function(e){e.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:function(){return t._newDomain},field:function(){var i;return null!==(i=t._field)&&void 0!==i?i:t._parseFieldOfSeries(e)},isContinuous:function(){return gS(t._stateScale.type)}},level:mY.dataZoomFilter})}),{userId:this._seriesUserId,specIndex:this._seriesIndex}))},i.prototype.onRender=function(t){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reMake||nt(i,t)||(n.reRender=!0,n.reMake=!0),n},i.prototype.reInit=function(t){var i=this;e.prototype.reInit.call(this,t),this._marks.forEach((function(t){t.getMarks().forEach((function(t){i.initMarkStyleWithSpec(t,i._spec[t.name])}))}))},i.prototype.changeRegions=function(){},i.prototype.update=function(t){},i.prototype.resize=function(t){},i.prototype._parseDomainFromState=function(t,e){if(gS(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];var i=this._stateScale.domain(),n=i.indexOf(t),r=i.indexOf(e);return i.slice(Math.min(n,r),Math.max(n,r)+1)},i.prototype._initCommonEvent=function(){var t,e,i,n,r,o,a,s={delayType:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.delayType)&&void 0!==e?e:"throttle",delayTime:T(null===(i=this._spec)||void 0===i?void 0:i.delayType)?null!==(r=null===(n=this._spec)||void 0===n?void 0:n.delayTime)&&void 0!==r?r:30:0,realTime:null===(a=null===(o=this._spec)||void 0===o?void 0:o.realTime)||void 0===a||a};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,s),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,s),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,s)},i.prototype.updateLayoutAttribute=function(){this._visible&&this._createOrUpdateComponent(),e.prototype.updateLayoutAttribute.call(this)},i.prototype.onLayoutStart=function(i,n,r){var o,a;e.prototype.onLayoutStart.call(this,i,n,r);var s=this._autoUpdate(i),l=this._isHorizontal?"height":"width";this.layout.setLayoutRect(((o={})[l]=s?this["_".concat(l)]:0,o),((a={})[l]=t.AttributeLevel.Built_In,a))},i.prototype.getBoundsInRect=function(t){var e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e},i.prototype.hide=function(){var t;null===(t=this._component)||void 0===t||t.hideAll()},i.prototype.show=function(){var t;null===(t=this._component)||void 0===t||t.showAll()},i.prototype._getAxisBandSize=function(t){var e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,n=null==t?void 0:t.minBandSize;if(e||n||i)return{bandSize:e,maxBandSize:i,minBandSize:n}},i.prototype._autoUpdate=function(t){var e,i,n,r,o,a;if(!this._auto)return this._cacheVisibility=void 0,!0;var s=this._relatedAxisComponent,l=null==s?void 0:s.getSpec(),u=null==s?void 0:s.getScale(),h=this._getAxisBandSize(l);if(_S(u.type)&&(null==t?void 0:t.height)===(null===(e=this._cacheRect)||void 0===e?void 0:e.height)&&(null==t?void 0:t.width)===(null===(i=this._cacheRect)||void 0===i?void 0:i.width)&&this._fixedBandSize===(null==h?void 0:h.bandSize))return this._cacheVisibility;var d=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null===(n=this._cacheRect)||void 0===n?void 0:n.width)?u.range(s.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null===(r=this._cacheRect)||void 0===r?void 0:r.height)&&u.range(s.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==h?void 0:h.bandSize,_S(u.type)){h&&(this._start||this._end)&&this._updateRangeFactor(null,"auto");var f=c(null!==(o=u.rangeFactor())&&void 0!==o?o:[],2),p=f[0],v=f[1];d=(!w(p)||!w(v))&&!(0===p&&1===v)}else{var y=c(null!==(a=u.rangeFactor())&&void 0!==a?a:[this._start,this._end],2);p=y[0],v=y[1];d=!(0===p&&1===v)}return this.setStartAndEnd(this._start,this._end),d?this.show():this.hide(),this._cacheVisibility=d,d},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i}(fq);ot(X4,mq);var Z4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._mergeThemeToSpec=function(t,e){var i=this,n=this._theme,r=t;if(this._shouldMergeThemeToSpec()){var a=function(t){var e=$W({selectedBackgroundChart:{line:{},area:{}}},i._theme,t),n=t.selectedBackgroundChart,r=void 0===n?{}:n,a=r.line,s=r.area;return a&&!1!==a.visible&&(e.selectedBackgroundChart.line.style=o(o({},e.selectedBackgroundChart.line.style),{visible:!0})),s&&!1!==s.visible&&(e.selectedBackgroundChart.area.style=o(o({},e.selectedBackgroundChart.area.style),{visible:!0})),e},s=t;r=B(s)?s.map((function(t){return a(t)})):a(s)}return this._adjustPadding(r),{spec:r,theme:n}},e}(dq),q4=function(e){function i(i,n){var r,o=this;return(o=e.call(this,i,n)||this).type=f.dataZoom,o.name=f.dataZoom,o.transformerConstructor=Z4,o.specKey="dataZoom",o.layoutZIndex=t.LayoutZIndex.DataZoom,o.layoutLevel=t.LayoutLevel.DataZoom,o.layoutType="region-relative",o._dataToPositionX=function(t){var e="left"===o._orient?o._middleHandlerSize:0,i=o._isHorizontal?o._startHandlerSize/2:0,n=o._isHorizontal?o._stateScale:o._valueScale,r=o._isHorizontal?o._stateField:o._valueField;return n.scale(t[r])+o.getLayoutStartPoint().x+e+i},o._dataToPositionX2=function(t){var e="left"===o._orient?o._middleHandlerSize:0,i=o._isHorizontal?o._startHandlerSize/2:0,n=o._isHorizontal?o._stateScale:o._valueScale,r=n.domain()[0];return n.scale(r)+o.getLayoutStartPoint().x+e+i},o._dataToPositionY=function(t){var e=o._isHorizontal?o._middleHandlerSize:0,i=o._isHorizontal?0:o._startHandlerSize/2,n=o._isHorizontal?o._valueScale:o._stateScale,r=o._isHorizontal?o._valueField:o._stateField;return n.scale(t[r])+o.getLayoutStartPoint().y+e+i},o._dataToPositionY2=function(t){var e=o._isHorizontal?o._middleHandlerSize:0,i=o._isHorizontal?0:o._startHandlerSize/2,n=o._isHorizontal?o._valueScale:o._stateScale,r=n.domain()[0];return n.scale(r)+o.getLayoutStartPoint().y+e+i},o._valueField="y",o._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"filter",o}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!w(i)){if(!B(i))return[{spec:i,specPath:[this.specKey],type:f.dataZoom}];var n=[];return i.forEach((function(t,i){n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.dataZoom})})),n}},i.prototype.created=function(){e.prototype.created.call(this),this._initValueScale()},i.prototype.setAttrFromSpec=function(){var t,i,n,r,o,a,s,l,u,c;e.prototype.setAttrFromSpec.call(this),S(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!==(i=null===(t=this._spec.background)||void 0===t?void 0:t.size)&&void 0!==i?i:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),w(null===(o=null===(r=null===(n=this._spec)||void 0===n?void 0:n.startHandler)||void 0===r?void 0:r.style)||void 0===o?void 0:o.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),w(null===(l=null===(s=null===(a=this._spec)||void 0===a?void 0:a.endHandler)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);var h=null===(u=this._spec.startHandler.style.visible)||void 0===u||u,d=null===(c=this._spec.endHandler.style.visible)||void 0===c||c;this._startHandlerSize=h?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0},i.prototype.onLayoutEnd=function(t){this._updateScaleRange(),!1!==this._cacheVisibility&&e.prototype.onLayoutEnd.call(this,t)},i.prototype._initValueScale=function(){var t=this._computeDomainOfValueScale();if(t){var e=new pA;e.domain(t),this._valueScale=e}},i.prototype._updateScaleRange=function(){var t,e,i=(this._startHandlerSize+this._endHandlerSize)/2;if(this._stateScale&&this._valueScale){var n,r=this._isHorizontal?this.getLayoutRect().width-i:this.getLayoutRect().height-i,o=null!==(e=null===(t=this._relatedAxisComponent)||void 0===t?void 0:t.getScale().range())&&void 0!==e?e:[0,r];this._isHorizontal?(n=this._visible?[0,this._computeWidth()-i]:o,this._stateScale.range(n),this._valueScale.range([this._computeHeight()-this._middleHandlerSize,0])):"left"===this.layoutOrient?(n=this._visible?[0,this._computeHeight()-i]:o,this._stateScale.range(n),this._valueScale.range([this._computeWidth()-this._middleHandlerSize,0])):(n=this._visible?[0,this._computeHeight()-i]:o,this._stateScale.range(n),this._valueScale.range([0,this._computeWidth()-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:this._computeWidth(),height:this._computeHeight()},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}},i.prototype._computeDomainOfValueScale=function(){var t=this,e=this._data.getLatestData().map((function(e){return e[t._valueField]})),i=e.map((function(t){return 1*t}));return e.length?[ht(i),ct(i)]:null},i.prototype._computeMiddleHandlerSize=function(){var t,e,i,n,r=0;if(null===(e=null===(t=this._spec)||void 0===t?void 0:t.middleHandler)||void 0===e?void 0:e.visible){var o=null!==(i=this._spec.middleHandler.icon.style.size)&&void 0!==i?i:8,a=null!==(n=this._spec.middleHandler.background.size)&&void 0!==n?n:40;r+=Math.max(o,a)}return r},i.prototype._computeWidth=function(){return!1===this._visible?0:I(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize},i.prototype._computeHeight=function(){return!1===this._visible?0:I(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height-(this._startHandlerSize+this._endHandlerSize)/2},i.prototype._isScaleValid=function(t){if(!t||!t.domain())return!1;var e,i=t.domain();return(!gS(t.type)||i[0]!==i[1])&&(!_S(t.type)||1!==(e=i,e&&B(e)?Array.from(new Set(lt(e))):e).length)},i.prototype._getAttrs=function(t){var e,i,n,r,a,s=null!==(e=this._spec)&&void 0!==e?e:{};return o({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this.getLayoutRect().width,height:this.getLayoutRect().height},showDetail:s.showDetail,brushSelect:null!==(i=s.brushSelect)&&void 0!==i&&i,zoomLock:null!==(n=s.zoomLock)&&void 0!==n&&n,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:s.delayType,delayTime:T(s.delayType)?null!==(r=s.delayTime)&&void 0!==r?r:30:0,realTime:null===(a=s.realTime)||void 0===a||a,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY},this._getComponentAttrs())},i.prototype._createOrUpdateComponent=function(){var t=this;if(this._visible){var e=this._isHorizontal?this._stateScale:this._valueScale,i=this._isHorizontal?this._valueScale:this._stateScale,n=this._isScaleValid(e)&&this._isScaleValid(i),r=this._getAttrs(n);if(this._component)this._component.setAttributes(r);else{var o=this.getContainer();this._component=new RD(r),this._isHorizontal?n&&this._component.setPreviewPointsY1(this._dataToPositionY2):n&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData((function(e){return t._statePointToData(e)})),this._component.addEventListener("change",(function(e){var i=e.detail,n=i.start,r=i.end,o=i.tag;t._handleChange(n,r,void 0,o)})),o.add(this._component),this._updateScaleRange()}}},i.prototype._handleChange=function(i,n,r,o){e.prototype._handleChange.call(this,i,n,r),r&&this._component&&this._component.setStartAndEnd(i,n),this._start=i,this._end=n,this._handleStateChange(this._statePointToData(i),this._statePointToData(n),o)&&this.event.emit(t.ChartEvent.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:i,end:n,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})},i.prototype._handleDataCollectionChange=function(){var t,e=this._data.getDataView();if(e.reRunAllTransform(),null===(t=this._component)||void 0===t||t.setPreviewData(e.latestData),this._valueScale){var i=this._computeDomainOfValueScale();i&&this._valueScale.domain(i)}},i.prototype._getComponentAttrs=function(){var t,e,i,n,r,a,s,l,u,c,h,d=this._spec,f=d.middleHandler,p=void 0===f?{}:f,v=d.startText,y=void 0===v?{}:v,g=d.endText,m=void 0===g?{}:g,_=d.backgroundChart,b=void 0===_?{}:_,x=d.selectedBackgroundChart,k=void 0===x?{}:x;return{backgroundStyle:DU(null===(t=this._spec.background)||void 0===t?void 0:t.style),startHandlerStyle:DU(null===(e=this._spec.startHandler)||void 0===e?void 0:e.style),middleHandlerStyle:p.visible?{visible:!0,icon:DU(null===(i=p.icon)||void 0===i?void 0:i.style),background:{size:null===(n=p.background)||void 0===n?void 0:n.size,style:DU(null===(r=p.background)||void 0===r?void 0:r.style)}}:{visible:!1},endHandlerStyle:DU(null===(a=this._spec.endHandler)||void 0===a?void 0:a.style),startTextStyle:{padding:y.padding,formatMethod:y.formatMethod,textStyle:DU(y.style)},endTextStyle:{padding:m.padding,formatMethod:m.formatMethod,textStyle:DU(m.style)},selectedBackgroundStyle:DU(this._spec.selectedBackground.style),dragMaskStyle:DU(null===(s=this._spec.dragMask)||void 0===s?void 0:s.style),backgroundChartStyle:{line:$W(DU(null===(l=b.line)||void 0===l?void 0:l.style),{fill:!1}),area:o({curveType:"basis",visible:!0},DU(null===(u=b.area)||void 0===u?void 0:u.style))},selectedBackgroundChartStyle:{line:$W(DU(null===(c=k.line)||void 0===c?void 0:c.style),{fill:!1}),area:o({curveType:"basis",visible:!0},DU(null===(h=k.area)||void 0===h?void 0:h.style))},disableTriggerEvent:this._option.disableTriggerEvent}},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.type=f.dataZoom,i.transformerConstructor=Z4,i.specKey="dataZoom",i}(X4),J4=function(){FU.registerComponent(q4.type,q4)},Q4=function(e){function i(i,n){var r,o=this;return(o=e.call(this,i,n)||this).type=f.scrollBar,o.name=f.scrollBar,o.specKey="scrollBar",o.layoutZIndex=t.LayoutZIndex.DataZoom,o.layoutLevel=t.LayoutLevel.DataZoom,o.layoutType="region-relative",o._filterMode=null!==(r=i.filterMode)&&void 0!==r?r:"axis",o}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!w(i)){if(!B(i))return[{spec:i,specPath:[this.specKey],type:f.scrollBar}];var n=[];return i.forEach((function(t,i){n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.scrollBar})})),n}},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),S(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)},i.prototype.onLayoutEnd=function(t){var i,n;this._updateScaleRange(),null===(n=(i=this.effect).onZoomChange)||void 0===n||n.call(i),e.prototype.onLayoutEnd.call(this,t)},i.prototype._updateScaleRange=function(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})},i.prototype._computeWidth=function(){return I(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12},i.prototype._computeHeight=function(){return I(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height},i.prototype._getAttrs=function(){var t,e,i,n,r,a;return o({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null===(t=this._spec)||void 0===t?void 0:t.delayType,delayTime:T(null===(e=this._spec)||void 0===e?void 0:e.delayType)?null!==(n=null===(i=this._spec)||void 0===i?void 0:i.delayTime)&&void 0!==n?n:30:0,realTime:null===(a=null===(r=this._spec)||void 0===r?void 0:r.realTime)||void 0===a||a},this._getComponentAttrs())},i.prototype._createOrUpdateComponent=function(){var t=this,e=this._getAttrs();if(this._component)this._component.setAttributes(e);else{var i=this.getContainer();this._component=new XL(e),this._component.addEventListener("scroll",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])})),i.add(this._component)}},i.prototype._handleChange=function(i,n,r){e.prototype._handleChange.call(this,i,n,r),r&&this._component&&this._component.setAttribute("range",[i,n]),this._start=i,this._end=n,this._handleStateChange(this._statePointToData(i),this._statePointToData(n))&&this.event.emit(t.ChartEvent.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})},i.prototype._handleDataCollectionChange=function(){},i.prototype._initCommonEvent=function(){var t=this;e.prototype._initCommonEvent.call(this),this._component&&this._component.on("scroll",(function(e){var i=e.detail.value;t._handleChange(i[0],i[1])}))},i.prototype._getComponentAttrs=function(){var t=this._spec,e=t.rail,i=t.slider,n=t.innerPadding,r={};return w(n)||(r.padding=n),W(null==e?void 0:e.style)||(r.railStyle=DU(e.style)),W(null==i?void 0:i.style)||(r.sliderStyle=DU(i.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r},i.prototype._getNeedClearVRenderComponents=function(){return[this._component]},i.type=f.scrollBar,i.specKey="scrollBar",i}(X4),$4=function(){FU.registerComponent(Q4.type,Q4)},t8=function(t,e){var i=e.datum,n=e.title,r=e.content,o=[],a=i.call(null);return n.visible&&o.push({type:"title",index:0,datum:a,spec:n}),lt(r).forEach((function(t,e){t.visible&&o.push({type:"content",index:e,datum:a,spec:t})})),o},e8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.indicator,i.name=f.indicator,i.specKey="indicator",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.Indicator,i.layoutLevel=t.LayoutLevel.Indicator,i._gap=0,i._activeDatum=null,i}return r(i,e),i.getSpecInfo=function(t){var e=this;if(this.type!==i.type)return null;var n=t[this.specKey];if(!B(n))return!1===n.visible?[]:[{spec:n,specPath:[this.specKey],type:f.indicator}];var r=[];return n.forEach((function(t,i){t&&!1!==t.visible&&r.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.indicator})})),r},i.prototype.created=function(){e.prototype.created.call(this),this.initData(),this.initEvent()},i.prototype.setAttrFromSpec=function(){e.prototype.setAttrFromSpec.call(this),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=lt(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(lt(this._spec.regionId),lt(this._spec.regionIndex))},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype.initEvent=function(){var t=this;this._option.disableTriggerEvent||"none"!==this._spec.trigger&&("hover"===this._spec.trigger?(this.event.on("hovered",(function(e){e.model&&!t.isRelativeModel(e.model)||t.updateDatum(e.value[0])})),this.event.on("unhovered",(function(e){e.model&&!t.isRelativeModel(e.model)||t.updateDatum(null)}))):(this.event.on("selected",(function(e){e.model&&!t.isRelativeModel(e.model)||t.updateDatum(e.value[0])})),this.event.on("unselected",(function(e){e.model&&!t.isRelativeModel(e.model)||t.updateDatum(null)}))))},i.prototype.updateDatum=function(t){this._activeDatum=t,this._displayData.updateData();var e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)},i.prototype.initData=function(){var t=this;hY(this._option.dataSet,"indicatorFilter",t8);var e=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});e.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:function(){return t._activeDatum}}}),e.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new dK(this._option,e)},i.prototype.updateLayoutAttribute=function(){var t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),e.prototype.updateLayoutAttribute.call(this)},i.prototype._getIndicatorAttrs=function(){var t=this,e=this._regions[0],i=e.getLayoutRect(),n=i.width,r=i.height,a=e.getLayoutStartPoint(),s=a.x,l=a.y,u=[];return lt(this._spec.content).forEach((function(e){var i=$W({},t._theme.content,e);u.push({visible:!1!==i.visible&&(!i.field||null!==t._activeDatum),space:i.space||t._gap,autoLimit:i.autoLimit,autoFit:i.autoFit,fitPercent:i.fitPercent,style:o(o({},DU(i.style)),{text:t._createText(i.field,i.style.text)})})})),{visible:!1!==this._spec.visible&&(!1!==this._spec.fixed||null!==this._activeDatum),size:{width:n,height:r},zIndex:this.layoutZIndex,x:s,y:l,dx:this._spec.offsetX?pW(this._spec.offsetX,this._computeLayoutRadius()):0,dy:this._spec.offsetY?pW(this._spec.offsetY,this._computeLayoutRadius()):0,limitRatio:this._spec.limitRatio||1/0,title:{visible:!1!==this._spec.title.visible&&(!T(this._spec.title.field)||null!==this._activeDatum),space:this._spec.title.space||this._gap,autoLimit:this._spec.title.autoLimit,autoFit:this._spec.title.autoFit,fitPercent:this._spec.title.fitPercent,style:o(o({},DU(this._spec.title.style)),{text:this._createText(this._spec.title.field,this._spec.title.style.text)})},content:u}},i.prototype._createOrUpdateIndicatorComponent=function(t){var e=this;if(this._indicatorComponent)nt(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{var i=this.getContainer(),n=new kF(t);n.name="indicator",i.add(n),this._indicatorComponent=n,this._indicatorComponent.on("*",(function(t,i){return e._delegateEvent(e._indicatorComponent,t,i)}))}return this._cacheAttrs=t,this._indicatorComponent},i.prototype._createText=function(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":A(e)?null!==(i=e(this._activeDatum,void 0))&&void 0!==i?i:"":null!=e?e:""},i.prototype._computeLayoutRadius=function(){var t=this._regions[0].getLayoutRect(),e=t.width,i=t.height;return Math.min(e/2,i/2)},i.prototype.isRelativeModel=function(t){return tw(this._regions,(function(e){return t===e}))||this._regions.includes(t)},i.prototype._getNeedClearVRenderComponents=function(){return[this._indicatorComponent]},i.prototype.clear=function(){this._cacheAttrs=null,e.prototype.clear.call(this)},i.type=f.indicator,i.specKey="indicator",i}(fq),i8=function(){FU.registerComponent(e8.type,e8)};function n8(t,e){var i=[];return e.forEach((function(e){var n={x:null,y:null};if(T(e.x)){var r=e.x;B(r)?n.x=r.map((function(i){return o8(i,t,e)})):n.x=o8(r,t,e)}if(T(e.y)){var o=e.y;B(o)?n.y=o.map((function(i){return o8(i,t,e)})):n.y=o8(o,t,e)}e.getRefRelativeSeries&&(n.getRefRelativeSeries=e.getRefRelativeSeries),i.push(n)})),i}var r8={min:function(t,e){return KA(t[0].latestData,e.field)},max:function(t,e){return XA(t[0].latestData,e.field)},sum:function(t,e){return ZA(t[0].latestData,e.field)},average:function(t,e){return qA(t[0].latestData,e.field)},variance:function(t,e){return JA(t[0].latestData,e.field)},standardDeviation:function(t,e){return function(t,e){return Math.sqrt(JA(t,e))}(t[0].latestData,e.field)},median:function(t,e){return function(t,e){return _t(t.map((function(t){return t[e]})))}(t[0].latestData,e.field)}};function o8(t,e,i){var n=i.getRelativeSeries(),r=i.getStartRelativeSeries(),o=i.getEndRelativeSeries(),a=n.getData().getLatestData(),s=r.getData().getLatestData(),l=o.getData().getLatestData();if(A(t))return t(a,s,l,n,r,o);if(E(t)){var u=t,c=u.aggrType,h=u.field;return r8[c](e,{field:h})}return t}var a8=["sum","average","min","max","variance","standardDeviation","median"];function s8(t,e,i){if(!i)return!1;var n=t.map((function(t){return 1*t})),r=ht(n),o=ct(n);return e<r||e>o}function l8(t,e,i,n,r,o){var a,s,l=n.relativeSeries;return I(t.x)&&s8(e,t.x,i)&&(null===(s=null==l?void 0:(a=l.getXAxisHelper()).setExtendDomain)||void 0===s||s.call(a,"marker_xAxis_extend",t.x)),uW(t.x)?c8(t.x,r)+o.x:l.getXAxisHelper().dataToPosition([t.x])+o.x}function u8(t,e,i,n,r,o){var a,s,l=n.relativeSeries;return I(t.y)&&s8(e,t.y,i)&&(null===(s=null===(a=l.getYAxisHelper())||void 0===a?void 0:a.setExtendDomain)||void 0===s||s.call(a,"marker_yAxis_extend",t.y)),uW(t.y)?c8(t.y,r)+o.y:l.getYAxisHelper().dataToPosition([t.y])+o.y}function c8(t,e){return Number(t.substring(0,t.length-1))*e/100}function h8(t){return a8.includes(t)}function d8(t,e,i,n,r){var o=e.getRegion(),a=o.getLayoutStartPoint(),s=i.getRegion(),l=s.getLayoutStartPoint(),u=Math.abs(Math.min(a.x,l.x)-Math.max(a.x+o.getLayoutRect().width,l.x+s.getLayoutRect().width)),c=Math.abs(Math.min(a.y,l.y)-Math.max(a.y+o.getLayoutRect().height,l.y+s.getLayoutRect().height)),h={relativeSeries:n,startRelativeSeries:e,endRelativeSeries:i},d=[],f=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,p=n.getXAxisHelper().getScale(0).domain(),v=n.getYAxisHelper().getScale(0).domain();return f.forEach((function(t){var e=T(t.x),i=T(t.y);if(e&&i){var n=l8(t,p,r,h,u,a),f=u8(t,v,r,h,c,a);d.push([{x:n,y:f}])}else if(T(t.x)){n=l8(t,p,r,h,u,a),f=Math.max(a.y+o.getLayoutRect().height,l.y+s.getLayoutRect().height);var y=Math.min(a.y,l.y);d.push([{x:n,y:f},{x:n,y:y}])}else if(T(t.y)){n=Math.min(a.x,l.x),f=u8(t,v,r,h,c,a);var g=Math.max(a.x+o.getLayoutRect().width,l.x+s.getLayoutRect().width);d.push([{x:n,y:f},{x:g,y:f}])}})),d}function f8(t,e,i,n){var r=[],o=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,a=B(n);return o.forEach((function(t,o){var s,l,u,c,h=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,d=h.getRegion(),f=d.getLayoutStartPoint(),p=d.getLayoutRect(),v=p.width,y=p.height,g=0,m=0;if(n){var _=a?n[o]:n,b=_.x,x=_.y;b&&(g=uW(b)?Number(b.substring(0,b.length-1))*v/100:b),x&&(m=uW(x)?Number(x.substring(0,x.length-1))*y/100:x)}var k=h.getXAxisHelper().getScale(0).domain(),S=h.getYAxisHelper().getScale(0).domain(),A=lt(t.x),w=lt(t.y);1===A.length&&I(A[0])&&s8(k,A[0],i)&&(null===(l=null===(s=h.getXAxisHelper())||void 0===s?void 0:s.setExtendDomain)||void 0===l||l.call(s,"marker_xAxis_extend",A[0])),1===w.length&&I(w[0])&&s8(S,w[0],i)&&(null===(c=null===(u=h.getYAxisHelper())||void 0===u?void 0:u.setExtendDomain)||void 0===c||c.call(u,"marker_yAxis_extend",w[0])),r.push({x:h.getXAxisHelper().dataToPosition(A)+f.x+g,y:h.getYAxisHelper().dataToPosition(w)+f.y+m})})),r}function p8(t,e,i){if(i){var n=e.getRegion(),r=n.getLayoutStartPoint(),o=r.x,a=r.y,s=n.getLayoutRect(),l=s.width,u=s.height;return t.map((function(t){var e=t.x,i=t.y;return uW(e)&&(e=c8(e,l)),e+=o,uW(i)&&(i=c8(i,u)),{x:e,y:i+=a}}))}var c=e.getOption().getChart().getCanvasRect(),h=c.width,d=c.height;return t.map((function(t){var e=t.x,i=t.y;return uW(e)&&(e=c8(e,h)),uW(i)&&(i=c8(i,d)),{x:e,y:i}}))}function v8(t){var e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((function(t){var o=t.getLayoutStartPoint(),a=t.getLayoutRect();o.x<e&&(e=o.x),o.x+a.width>i&&(i=o.x+a.width),o.y<n&&(n=o.y),o.y+a.height>r&&(r=o.y+a.height)})),{minX:e,maxX:i,minY:n,maxY:r}}function y8(t){var e=t.labelBackground,i=void 0===e?{}:e,n=t.style,r=t.shape,s=a(t,["labelBackground","style","shape"]);if(!1!==t.visible){var l=s;return(null==r?void 0:r.visible)?l.shape=o({visible:!0},DU(r.style)):l.shape={visible:!1},!1!==i.visible?(l.panel=o({visible:!0},DU(i.style)),T(i.padding)&&(l.padding=mi(i.padding))):(l.panel={visible:!1},l.padding=0),n&&(l.textStyle=DU(n)),l}return{visible:!1}}var g8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layoutType="none",e._layoutOffsetX=0,e._layoutOffsetY=0,e}return r(e,t),e.prototype.getRelativeSeries=function(){return this._relativeSeries},e.prototype.created=function(){t.prototype.created.call(this),this.initEvent(),this._bindSeries(),this._initDataView()},e.prototype._getAllRelativeSeries=function(){var t=this;return{getRelativeSeries:function(){return t._relativeSeries},getStartRelativeSeries:function(){return t._startRelativeSeries},getEndRelativeSeries:function(){return t._endRelativeSeries}}},e.prototype._getFieldInfoFromSpec=function(t,e,i){var n="x"===t?i.getSpec().xField:i.getSpec().yField;return P(e)&&h8(e)?{field:n,aggrType:e}:e},e.prototype._processSpecX=function(t){var e=this._relativeSeries;return o({x:this._getFieldInfoFromSpec("x",t,e)},this._getAllRelativeSeries())},e.prototype._processSpecY=function(t){var e=this._relativeSeries;return o({y:this._getFieldInfoFromSpec("y",t,e)},this._getAllRelativeSeries())},e.prototype._processSpecXY=function(t,e){var i=this._relativeSeries;return o({x:this._getFieldInfoFromSpec("x",t,i),y:this._getFieldInfoFromSpec("y",e,i)},this._getAllRelativeSeries())},e.prototype._processSpecCoo=function(t){var e,i=this;return(null!==(e=t.coordinates)&&void 0!==e?e:lt(t.coordinate)).map((function(t){var e=i._getSeriesByIdOrIndex(t.refRelativeSeriesId,t.refRelativeSeriesIndex),n=e.getSpec(),r=n.xField,a=n.yField,s=t.xFieldDim,l=t.xFieldIndex,u=t.yFieldDim,c=t.yFieldIndex,h=r;T(l)&&(h=lt(r)[l]),s&&lt(r).includes(s)&&(h=s);var d=a;T(c)&&(d=lt(a)[c]),u&&lt(a).includes(u)&&(d=u);var f=o({x:void 0,y:void 0},i._getAllRelativeSeries());return P(t[h])&&h8(t[h])?f.x={field:h,aggrType:t[h]}:f.x=lt(h).map((function(e){return t[e]})),P(t[d])&&h8(t[d])?f.y={field:d,aggrType:t[d]}:f.y=lt(d).map((function(e){return t[e]})),f.getRefRelativeSeries=function(){return e},f}))},e.prototype.updateLayoutAttribute=function(){var e,i,n,r=this;if(null===(e=this._spec.visible)||void 0===e||e){if(!this._markerComponent){var o=this._createMarkerComponent();o.name=null!==(i=this._spec.name)&&void 0!==i?i:this.type,o.id=null!==(n=this._spec.id)&&void 0!==n?n:"".concat(this.type,"-").concat(this.id),this._markerComponent=o,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(function(t,e){return r._delegateEvent(r._markerComponent,t,e)}))}this._markerLayout()}t.prototype.updateLayoutAttribute.call(this)},e.prototype._getSeriesByIdOrIndex=function(t,e){var i,n,r;return(r=null===(i=this._option.getSeriesInUserIdOrIndex(T(t)?[t]:[],[e]))||void 0===i?void 0:i[0])||(r=null!==(n=this._relativeSeries)&&void 0!==n?n:this._getFirstSeries()),r},e.prototype._bindSeries=function(){var t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex)},e.prototype.initEvent=function(){},e.prototype.onRender=function(t){},e.prototype.changeRegions=function(t){},e.prototype.clear=function(){t.prototype.clear.call(this),this._firstSeries=null},e.prototype._getFirstSeries=function(){var t;if(this._firstSeries)return this._firstSeries;var e=nw(this._regions);return e?(this._firstSeries=e,e):(null===(t=this._option)||void 0===t||t.onError("need at least one series"),null)},e.prototype._getNeedClearVRenderComponents=function(){return[this._markerComponent]},e.prototype.onLayoutStart=function(e,i,n){w(this._spec.offsetX)||(this._layoutOffsetX=cW(this._spec.offsetX,i.width,i)),w(this._spec.offsetY)||(this._layoutOffsetY=cW(this._spec.offsetY,i.height,i)),t.prototype.onLayoutStart.call(this,e,i,n)},e}(fq);function m8(t,e){return function(t,e,i){var n,r,o=fS(t,(function(t){return t[e]}),(function(t){return t[i]})).predict,a=KA(t,e),s=XA(t,e),l=o(a),u=o(s);return[(n={},n[e]=a,n[i]=l,n),(r={},r[e]=s,r[i]=u,r)]}(t[0].latestData,e.fieldX,e.fieldY)}function _8(t,e){if(e&&e.getRelativeSeries){var i=e.getRelativeSeries();if(i){var n=i.getViewData();return n&&n.latestData&&n.latestData.length?t:[]}}return t}var b8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.markLine,i.name=f.markLine,i.specKey="markLine",i.layoutZIndex=t.LayoutZIndex.MarkLine,i}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!W(i)){if(!B(i)&&!1!==i.visible)return[{spec:i,specPath:[this.specKey],type:f.markLine}];var n=[];return i.forEach((function(t,i){!1!==t.visible&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.markLine})})),n}},i.prototype._createMarkerComponent=function(){var t,e,i,n=this._spec,r=n.label,a=void 0===r?{}:r,s=n.startSymbol,l=void 0===s?{}:s,u=n.endSymbol,c=void 0===u?{}:u,h={zIndex:this.layoutZIndex,interactive:null!==(t=this._spec.interactive)&&void 0!==t&&t,points:[{x:0,y:0},{x:0,y:0}],lineStyle:null===(e=this._spec.line)||void 0===e?void 0:e.style,clipInRange:null!==(i=this._spec.clip)&&void 0!==i&&i,label:y8(a)};return l.visible?h.startSymbol=o(o({},l),{visible:!0,style:DU(l.style)}):h.startSymbol={visible:!1},c.visible?h.endSymbol=o(o({},c),{visible:!0,style:DU(c.style)}):h.endSymbol={visible:!1},new VD(h)},i.prototype._markerLayout=function(){var t,e,i,n,r,a,s,l=this._spec,u=this._markerData,c=this._startRelativeSeries,h=this._endRelativeSeries,d=this._relativeSeries,f=T(l.coordinates),p=T(l.process),v=p&&T(l.process.x),y=p&&T(l.process.y),g=f&&(!p||"process"in l&&"xy"in l.process),m=T(l.positions),_=null!==(t=l.autoRange)&&void 0!==t&&t,b=[];if(this._isXYLayout||f&&v||f&&y){var x=d8(u,c,h,d,_);b=1===x.length?x[0]:x.map((function(t){return t[0]}))}else g?b=f8(u,d,_,l.coordinatesOffset):m&&(b=p8(l.positions,d,l.regionRelative));var k,S=this._relativeSeries.getViewData().latestData,A=u.latestData[0]&&u.latestData[0].latestData?u.latestData[0].latestData:u.latestData;if(l.clip||(null===(e=l.label)||void 0===e?void 0:e.confine)){var w=v8([c.getRegion(),h.getRegion(),d.getRegion()]),M=w.minX,C=w.maxX,E=w.minY;k={x:M,y:E,width:C-M,height:w.maxY-E}}var R=null!==(n=null===(i=this._markerComponent)||void 0===i?void 0:i.attribute)&&void 0!==n?n:{},P=o(o({},R.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(A,S):null===(r=R.label)||void 0===r?void 0:r.text});if("type-step"===this._spec.type){var B=this._spec.line||{},L=B.multiSegment,O=B.mainSegmentIndex,I=this._spec,D=I.connectDirection,F=I.expandDistance,z=void 0===F?0:F,j=void 0;if(uW(z)){var H=c.getRegion(),N=H.getLayoutStartPoint(),V=h.getRegion(),G=V.getLayoutStartPoint();if("bottom"===D||"top"===D){var W=Math.abs(Math.min(N.y,G.y)-Math.max(N.y+H.getLayoutRect().height,G.y+V.getLayoutRect().height));j=Number(z.substring(0,z.length-1))*W/100}else{var U=Math.abs(Math.min(N.x,G.x)-Math.max(N.x+H.getLayoutRect().width,G.x+V.getLayoutRect().width));j=Number(z.substring(0,z.length-1))*U/100}}else j=z;var Y=function(t,e,i,n){void 0===n&&(n=0);var r=[],o=t.y-e.y,a=t.x-e.x;switch(i){case"top":r.push(t),r.push({x:t.x,y:o>0?t.y-n-Math.abs(o):t.y-n}),r.push({x:e.x,y:o>0?e.y-n:e.y-n-Math.abs(o)}),r.push(e);break;case"bottom":r.push(t),r.push({x:t.x,y:o<0?t.y+n+Math.abs(o):t.y+n}),r.push({x:e.x,y:o<0?e.y+n:e.y+n+Math.abs(o)}),r.push(e);break;case"left":r.push(t),r.push({x:a>0?t.x-n-Math.abs(a):t.x-n,y:t.y}),r.push({x:a>0?e.x-n:e.x-n-Math.abs(a),y:e.y}),r.push(e);break;case"right":r.push(t),r.push({x:a>0?t.x+n:t.x+n+Math.abs(a),y:t.y}),r.push({x:a>0?e.x+n+Math.abs(a):e.x+n,y:e.y}),r.push(e)}return r}(b[0],b[1],D,j),K=void 0;K=L&&T(O)?{position:"middle",autoRotate:!1,refX:0,refY:0}:o(o({position:"start",autoRotate:!1},function(t,e,i,n){void 0===n&&(n=0);var r=t.y-e.y,o=t.x-e.x;return"bottom"===i?{dx:o>0?-o/2:Math.abs(o/2),dy:r>0?n:Math.abs(r)+n}:"top"===i?{dx:o>0?-Math.abs(o/2):+Math.abs(o/2),dy:r>0?-(Math.abs(r)+n):-n}:"left"===i?{dx:o>0?-o-n:-n,dy:r>0?-r/2:Math.abs(r/2)}:"right"===i?{dx:o>0?n:Math.abs(o)+n,dy:r>0?-r/2:Math.abs(r/2)}:{}}(b[0],b[1],D,j)),{refX:0,refY:0}),null===(a=this._markerComponent)||void 0===a||a.setAttributes({points:L?[[Y[0],Y[1]],[Y[1],Y[2]],[Y[2],Y[3]]]:Y,label:o(o(o({},P),K),{textStyle:o(o({},R.label.textStyle),{textAlign:"center",textBaseline:"middle"})}),limitRect:k,multiSegment:L,mainSegmentIndex:O,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null===(s=this._markerComponent)||void 0===s||s.setAttributes({points:b,label:P,limitRect:k,dx:this._layoutOffsetX,dy:this._layoutOffsetY})},i.prototype._initDataView=function(){var t=this,e=this._spec,i=this._relativeSeries,n="x"in e,r="y"in e,o="x1"in e,a="y1"in e,s="coordinates"in e,l=n&&!r&&!a,u=n&&r&&a,c=r&&!n&&!o,h=r&&n&&o,d=n&&r&&o&&a;if(this._markerData=i.getViewData(),l||c||u||h||d||s){var f;hY(this._option.dataSet,"markerAggregation",n8),hY(this._option.dataSet,"markerRegression",m8),hY(this._option.dataSet,"markerFilter",_8),this._isXYLayout=l||u||c||h||d;var p=i.getViewData(),v=!0,y=!1;if(d){var g=e,m=g.x,_=g.x1,b=g.y,x=g.y1;f=[this._processSpecXY(m,b),this._processSpecXY(_,x)]}else if(l)f=[this._processSpecX(e.x)];else if(c)f=[this._processSpecY(e.y)];else if(u){var k=e;m=k.x,b=k.y,x=k.y1;f=[this._processSpecXY(m,b),this._processSpecXY(m,x)]}else if(h){var S=e;m=S.x,_=S.x1,b=S.y;f=[this._processSpecXY(m,b),this._processSpecXY(_,b)]}else if(s){if(f=this._processSpecCoo(e),v=!1,p=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")}).parse([i.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:f}),e.process&&"x"in e.process&&(f=[this._processSpecX(e.process.x)],v=!0),e.process&&"y"in e.process&&(f=[this._processSpecY(e.process.y)],v=!0),e.process&&"xy"in e.process){var A=i.getSpec();f={fieldX:A.xField,fieldY:A.yField},y=!0}}else v=!1;var w=new Ma(this._option.dataSet);w.parse([p],{type:"dataview"}),v&&w.transform({type:"markerAggregation",options:f}),y&&w.transform({type:"markerRegression",options:f}),(v||y)&&w.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),w.target.on("change",(function(){t._markerLayout()})),this._markerData=w}},i.type=f.markLine,i.specKey="markLine",i}(g8),x8=function(){FU.registerComponent(b8.type,b8)},k8=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=f.title,r.specKey=f.title,r.layoutType="normal",r.layoutZIndex=t.LayoutZIndex.Title,r.layoutLevel=t.LayoutLevel.Title,r._orient="top",r._orient=lW(i.orient)?i.orient:"top",r}return r(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),i.prototype.initLayout=function(){e.prototype.initLayout.call(this),this._layout&&(this._layout.layoutOrient=this._orient)},i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!i||!1===i.visible)return null;if(!B(i))return[{spec:i,specPath:[this.specKey],type:f.title}];var n=[];return i.forEach((function(t,i){!1!==t.visible&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.title})})),n},i.prototype.onRender=function(t){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return(null==i?void 0:i.orient)!==(null==t?void 0:t.orient)&&(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype.changeRegions=function(t){},i.prototype.update=function(t){},i.prototype.resize=function(t){},i.prototype.afterSetLayoutStartPoint=function(t){F(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),F(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),e.prototype.afterSetLayoutStartPoint.call(this,t)},i.prototype.getBoundsInRect=function(t){var e;this.setLayoutRect(t);var i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();var n=this.getLayoutStartPoint(),r=n.x,o=n.y;return{x1:r,y1:o,x2:r+e.width,y2:o+e.height}},i.prototype._getTitleLayoutRect=function(){var t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:F(t.width())?t.width():0,height:this._spec.height?this._spec.height:F(t.height())?t.height():0}},i.prototype._getTitleAttrs=function(){var t,e,i,n,r,a,s,l,u,c=Math.max(0,null!==(t=this._spec.width)&&void 0!==t?t:this.getLayoutRect().width);return o(o({},$(this._spec,["padding"])),{textType:null!==(e=this._spec.textType)&&void 0!==e?e:"text",text:null!==(i=this._spec.text)&&void 0!==i?i:"",subtextType:null!==(n=this._spec.subtextType)&&void 0!==n?n:"text",subtext:null!==(r=this._spec.subtext)&&void 0!==r?r:"",x:null!==(a=this._spec.x)&&void 0!==a?a:0,y:null!==(s=this._spec.y)&&void 0!==s?s:0,width:c,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:this._spec.maxWidth,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!==(l=this._spec.align)&&void 0!==l?l:"left",verticalAlign:null!==(u=this._spec.verticalAlign)&&void 0!==u?u:"top",textStyle:o({width:c},this._spec.textStyle),subtextStyle:o({width:c},this._spec.subtextStyle)})},i.prototype._createOrUpdateTitleComponent=function(t){var e=this;if(this._titleComponent)nt(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{var i=this.getContainer(),n=new _F(t);n.name="title",i.add(n),this._titleComponent=n,n.on("*",(function(t,i){return e._delegateEvent(n,t,i)}))}return this._cacheAttrs=t,this._titleComponent},i.prototype._getNeedClearVRenderComponents=function(){return[this._titleComponent]},i.prototype.clear=function(){e.prototype.clear.call(this),this._cacheAttrs=null},i.type=f.title,i.specKey=f.title,i}(fq),S8=function(){FU.registerComponent(k8.type,k8)},A8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.markArea,i.name=f.markArea,i.specKey="markArea",i.layoutZIndex=t.LayoutZIndex.MarkArea,i}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!W(i)){if(!B(i)&&!1!==i.visible)return[{spec:i,specPath:[this.specKey],type:f.markArea}];var n=[];return i.forEach((function(t,i){!1!==t.visible&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.markArea})})),n}},i.prototype._createMarkerComponent=function(){var t,e,i,n,r=null!==(t=this._spec.label)&&void 0!==t?t:{},o={zIndex:this.layoutZIndex,interactive:null!==(e=this._spec.interactive)&&void 0!==e&&e,points:[{x:0,y:0}],areaStyle:DU(null===(i=this._spec.area)||void 0===i?void 0:i.style),clipInRange:null!==(n=this._spec.clip)&&void 0!==n&&n,label:y8(r)};return new WD(o)},i.prototype._markerLayout=function(){var t,e,i,n,r,a=this._spec,s=this._markerData,l=this._startRelativeSeries,u=this._endRelativeSeries,d=this._relativeSeries,f=T(a.x)&&T(a.x1),p=T(a.y)&&T(a.y1),v=f&&p,y=T(a.coordinates),g=T(a.positions),m=null!==(t=a.autoRange)&&void 0!==t&&t,_=[],b=[];v?_=[{x:(b=d8(s,l,u,d,m))[0][0].x,y:b[1][0].y},b[0][0],{x:b[1][0].x,y:b[0][0].y},b[1][0]]:f||p?_=h(h([],c((b=d8(s,l,u,d,m))[0]),!1),[b[1][1],b[1][0]],!1):y?_=f8(s,d,m,a.coordinatesOffset):g&&(_=p8(a.positions,d,a.regionRelative));var x,k=this._relativeSeries.getViewData().latestData,S=s?s.latestData[0]&&s.latestData[0].latestData?s.latestData[0].latestData:s.latestData:k;if(a.clip||(null===(e=a.label)||void 0===e?void 0:e.confine)){var A=v8([l.getRegion(),u.getRegion(),d.getRegion()]),w=A.minX,M=A.maxX,C=A.minY;x={x:w,y:C,width:M-w,height:A.maxY-C}}this._markerComponent&&this._markerComponent.setAttributes({points:_,label:o(o({},null===(i=this._markerComponent.attribute)||void 0===i?void 0:i.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(S,k):null===(r=null===(n=this._markerComponent.attribute)||void 0===n?void 0:n.label)||void 0===r?void 0:r.text}),limitRect:x,dx:this._layoutOffsetX,dy:this._layoutOffsetY})},i.prototype._initDataView=function(){var t,e=this,i=this._spec,n=this._relativeSeries,r=T(i.x)&&T(i.x1),o=T(i.y)&&T(i.y1),a=r&&o,s=T(i.coordinates);if(!r&&!o&&!s)return null;a?t=[this._processSpecXY(i.x,i.y),this._processSpecXY(i.x1,i.y1)]:r?t=[this._processSpecX(i.x),this._processSpecX(i.x1)]:o?t=[this._processSpecY(i.y),this._processSpecY(i.y1)]:s&&(t=this._processSpecCoo(i));var l=n.getViewData();hY(this._option.dataSet,"markerAggregation",n8),hY(this._option.dataSet,"markerFilter",_8);var u=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});u.parse([l],{type:"dataview"}),u.transform({type:"markerAggregation",options:t}),t&&u.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),u.target.on("change",(function(){e._markerLayout()})),this._markerData=u},i.type=f.markArea,i.specKey="markArea",i}(g8),w8=function(){FU.registerComponent(A8.type,A8)},T8=function(t){return DU(o({},t))},M8=function(t){return o(o({},t),{style:o({},DU(t.style))})},C8=function(t){var e,i,n,r,a,s,l,u,c,h,d,f,p,v,y,g=T8(null!==(i=null===(e=null==t?void 0:t.slider)||void 0===e?void 0:e.trackStyle)&&void 0!==i?i:{}),m=T8(null!==(r=null===(n=null==t?void 0:t.slider)||void 0===n?void 0:n.railStyle)&&void 0!==r?r:{}),_=(y=null!==(s=null===(a=null==t?void 0:t.slider)||void 0===a?void 0:a.handlerStyle)&&void 0!==s?s:{},DU(o({},y))),b=M8(null!==(u=null===(l=null==t?void 0:t.controller)||void 0===l?void 0:l.start)&&void 0!==u?u:{}),x=M8(null!==(h=null===(c=null==t?void 0:t.controller)||void 0===c?void 0:c.pause)&&void 0!==h?h:{}),k=M8(null!==(f=null===(d=null==t?void 0:t.controller)||void 0===d?void 0:d.backward)&&void 0!==f?f:{}),S=M8(null!==(v=null===(p=null==t?void 0:t.controller)||void 0===p?void 0:p.forward)&&void 0!==v?v:{});return o(o({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:t.orient,slider:o(o({},t.slider),{trackStyle:g,railStyle:m,handlerStyle:_}),controller:o(o({},t.controller),{start:b,pause:x,backward:k,forward:S})})},E8=function(t){return"left"===t||"right"===t},R8=function(t){return"top"===t||"bottom"===t},P8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutZIndex=t.LayoutZIndex.Player,i.layoutLevel=t.LayoutLevel.Player,i.specKey="player",i.type=f.player,i._orient="bottom",i._getPlayerAttrs=function(){var t,e,n,r,a=i._spec.type,s={size:{width:i._width,height:i._height},dx:null!==(t=i._spec.dx)&&void 0!==t?t:0+i._dx,dy:null!==(e=i._spec.dy)&&void 0!==e?e:0+i._dy};return o(o(o({},"discrete"===a?(n=i._spec,r=i._specs,o(o({},C8(n)),{data:r,type:"discrete"})):function(t,e){return o(o({},C8(t)),{data:e,type:"continuous"})}(i._spec,i._specs)),s),{disableTriggerEvent:i._option.disableTriggerEvent})},i._createOrUpdatePlayerComponent=function(){var t=o({},i._getPlayerAttrs()),e=i.getContainer();i._playerComponent?nt(t,i._cacheAttrs)||(i._cacheAttrs=t,i._playerComponent.setAttributes(t),i._playerComponent._initAttributes(),i._playerComponent.render()):("discrete"===t.type?i._playerComponent=new HF(t):i._playerComponent=new UF(t),i._cacheAttrs=t,i._playerComponent.name="player",e.add(i._playerComponent),i._initEvent())},i._maxSize=function(){var t,e,n,r,o,a,s,l,u;return Math.max.apply(Math,h(h(h(h(h([],c(lt(null===(e=null===(t=i._spec.controller.start)||void 0===t?void 0:t.style)||void 0===e?void 0:e.size)),!1),c(lt(null===(r=null===(n=i._spec.controller.pause)||void 0===n?void 0:n.style)||void 0===r?void 0:r.size)),!1),c(lt(null===(a=null===(o=i._spec.controller.backward)||void 0===o?void 0:o.style)||void 0===a?void 0:a.size)),!1),c(lt(null===(l=null===(s=i._spec.controller.forward)||void 0===s?void 0:s.style)||void 0===l?void 0:l.size)),!1),[null!==(u=E8(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==u?u:10],!1))},i._sliderExceededSize=function(){var t,e,n,r,o,a,s,l,u,d=null!==(t=E8(i._orient)?i._spec.slider.railStyle.width:i._spec.slider.railStyle.height)&&void 0!==t?t:10,f=Math.max.apply(Math,h(h(h(h([],c(lt(null===(n=null===(e=i._spec.controller.start)||void 0===e?void 0:e.style)||void 0===n?void 0:n.size)),!1),c(lt(null===(o=null===(r=i._spec.controller.pause)||void 0===r?void 0:r.style)||void 0===o?void 0:o.size)),!1),c(lt(null===(s=null===(a=i._spec.controller.backward)||void 0===a?void 0:a.style)||void 0===s?void 0:s.size)),!1),c(lt(null===(u=null===(l=i._spec.controller.forward)||void 0===l?void 0:l.style)||void 0===u?void 0:u.size)),!1));return d>=f?d-f:0},i._initEvent=function(){i._option.disableTriggerEvent||(i._option.globalInstance.on(t.ChartEvent.rendered,(function(){var t;(null===(t=i._spec)||void 0===t?void 0:t.auto)&&i._playerComponent.play()})),i._playerComponent.addEventListener(RF.OnEnd,(function(){var e;i.event.emit(t.ChartEvent.playerEnd,{model:i}),i._alternate&&"discrete"===i._spec.type&&(i._direction="default"===i._direction?"reverse":"default",i._playerComponent.setAttributes({direction:i._direction,dataIndex:"reverse"===i._direction?i._specs.length-2:1})),(null===(e=i._spec)||void 0===e?void 0:e.loop)&&i._playerComponent.play()})),i._playerComponent.addEventListener(RF.OnChange,(function(e){var n=e.detail.index,r=i._specs[n];lt(r.data).forEach((function(t){var e,n;null===(n=null===(e=i._option)||void 0===e?void 0:e.globalInstance)||void 0===n||n.updateData(t.id,t.values)})),i.event.emit(t.ChartEvent.playerChange,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(RF.OnBackward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerBackward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(RF.OnForward,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerForward,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(RF.OnPlay,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPlay,{model:i,value:{spec:r,index:n,specs:i._specs}})})),i._playerComponent.addEventListener(RF.OnPause,(function(e){var n=e.detail.index,r=i._specs[n];i.event.emit(t.ChartEvent.playerPause,{model:i,value:{spec:r,index:n,specs:i._specs}})})))},i}return r(i,e),Object.defineProperty(i.prototype,"orient",{get:function(){return this._orient},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"layoutOrient",{set:function(t){this._orient=t},enumerable:!1,configurable:!0}),i.getSpecInfo=function(t){var e=t[this.specKey];return w(e)||!1===e.visible?null:[{spec:e,specPath:[this.specKey],type:f.player}]},i.prototype.setAttrFromSpec=function(){var t,i,n,r,o,a,s;e.prototype.setAttrFromSpec.call(this),this._orient=null!==(t=this._spec.orient)&&void 0!==t?t:"bottom",this._specs=null!==(i=this._spec.specs)&&void 0!==i?i:[],this._direction=null!==(n=this._spec.direction)&&void 0!==n?n:"default",this._alternate=null!==(r=this._spec.alternate)&&void 0!==r&&r,this._dx=null!==(o=this._spec.dx)&&void 0!==o?o:0,this._dy=null!==(a=this._spec.dy)&&void 0!==a?a:0,this._position=null!==(s=this._spec.position)&&void 0!==s?s:"middle"},i.prototype.afterSetLayoutStartPoint=function(t){if(e.prototype.afterSetLayoutStartPoint.call(this,t),F(t.x)){var i=E8(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",i)}if(F(t.y)){var n=R8(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",n)}},i.prototype.getBoundsInRect=function(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);var i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i},i.prototype.changeRegions=function(t){},i.prototype.onRender=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[this._playerComponent]},i.prototype._computeLayoutRect=function(t,e,i){switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}},i.prototype._computeWidth=function(t){return I(this._spec.width)?Math.min(t.width,Number(this._spec.width)):E8(this._orient)?this._maxSize():t.width},i.prototype._computeHeight=function(t){return I(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):R8(this._orient)?this._maxSize():t.height},i.prototype._computeDx=function(t){return E8(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width},i.prototype._computeDy=function(t){return R8(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height},i.specKey="player",i.type=f.player,i}(fq),B8=function(){FU.registerComponent(P8.type,P8)},L8={rect:F8,symbol:D8,arc:j8,point:function(t){var e;e=!1!==t.labelSpec.overlap&&{avoidBaseMark:!1};return{position:"center",overlap:e}},"line-data":function(t){var e=D8(t);S(e.overlap)||(e.overlap.avoidBaseMark=!1);return e},stackLabel:function(t){var e=t.series,i=t.labelSpec||{},n=e.getTotalData();return{customLayoutFunc:function(n){return n.map((function(n){var r=i.position||"withChange",a=i.offset||0,s=n.data,l=O8(t,s,i.formatMethod);return l.x=function(t){return"vertical"===e.direction?e.totalPositionX(t,"index",.5):"middle"===r?.5*(e.totalPositionX(t,"end")+e.totalPositionY(t,"start")):"max"===r?e.totalPositionX(t,t.end>=t.start?"end":"start")+a:"min"===r?e.totalPositionX(t,t.end>=t.start?"start":"end")-a:e.totalPositionX(t,"end")+(t.end>=t.start?a:-a)}(s),l.y=function(t){return"vertical"===e.direction?"middle"===r?.5*(e.totalPositionY(t,"end")+e.totalPositionY(t,"start")):"max"===r?e.totalPositionY(t,t.end>=t.start?"end":"start")-a:"min"===r?e.totalPositionY(t,t.end>=t.start?"start":"end")+a:e.totalPositionY(t,"end")+(t.end>=t.start?-a:a):e.totalPositionY(t,"index",.5)}(s),"vertical"===e.direction?l.textBaseline="middle"===r?r:"withChange"===r&&s.end-s.start>=0||"max"===r?"bottom":"top":l.textAlign="middle"===r?"center":"withChange"===r&&s.end-s.start>=0||"max"===r?"left":"right",np(o(o({},l),{id:n.id}))}))},dataFilter:function(t){var i=[];return n.forEach((function(n){var r=t.find((function(t){var i;return n.index===(null===(i=t.data)||void 0===i?void 0:i[e.getDimensionField()[0]])}));r&&(r.data=n,i.push(r))})),i},overlap:{strategy:[]}}},line:H8,area:H8,rect3d:F8,arc3d:j8,treemap:function(t){var e=t.labelSpec;return{customLayoutFunc:function(i){return i.map((function(i){var n=i.data,r=O8(t,n,e.formatMethod);return np(o(o({},r),{id:i.id,pickable:!1}))}))},overlap:!1}}};function O8(t,e,i,n){var r,o,a,s,l,c=t.labelMark,h=t.series,d={text:e[h.getMeasureField()[0]],data:e,textType:null!==(a=t.labelSpec.textType)&&void 0!==a?a:"text"},f=Object.keys(c.stateStyle.normal);try{for(var p=u(f),v=p.next();!v.done;v=p.next()){var y=v.value,g=c.getAttribute(y,e);d[y]=g}}catch(t){r={error:t}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return i&&(d.text=i(d.text,e,{series:h})),n&&("pie"===h.type?e._percent_=(100*e[Rw]).toFixed(2)+"%":e[yV]&&(e._percent_=(100*e[yV]).toFixed(2)+"%"),d.text=(l=e,(s=n)&&l?s.replace(/\\?\{([^{}]+)\}/g,(function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===l[e]?"":l[e]})):s)),d}function I8(t){return A(t)?function(e){return t(e.data)}:t}function D8(t){var e,i,n,r=t.series,o=t.labelSpec,a="horizontal"===r.direction?"right":"top",s=null!==(e=I8(o.position))&&void 0!==e?e:a;return{position:s,overlap:!1!==o.overlap&&{strategy:null!==(n=null===(i=o.overlap)||void 0===i?void 0:i.strategy)&&void 0!==n?n:([{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}],[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]),avoidBaseMark:"center"!==s}}}function F8(t){var e,i,n,r,o,a,s,l=t.series,u=t.labelSpec,c=void 0===u?{}:u,h=null!==(e=I8(c.position))&&void 0!==e?e:"outside",d=null!==(i=l.direction)&&void 0!==i?i:"vertical",f="horizontal"===l.direction?null===(n=l.getXAxisHelper())||void 0===n?void 0:n.isInverse():null===(r=l.getYAxisHelper())||void 0===r?void 0:r.isInverse(),p=h;P(h)&&"inside"!==p&&(p=function(t){var e=t.data,i=l.getMeasureField()[0];if("outside"===h){var n=(null==e?void 0:e[i])>=0&&f||(null==e?void 0:e[i])<0&&!f?1:0;return{vertical:["top","bottom"],horizontal:["right","left"]}[d][n]}return"inside-bottom"===h?"horizontal"===l.direction?"inside-left":"inside-bottom":"inside-top"===h?"horizontal"===l.direction?"inside-right":"inside-top":h}),s=!1!==c.overlap&&{strategy:null!==(a=null===(o=c.overlap)||void 0===o?void 0:o.strategy)&&void 0!==a?a:z8(l)};var v=!1;return P(h)&&h.includes("inside")&&(v=!0),{position:p,overlap:s,smartInvert:v}}function z8(t){var e=[{type:"position",position:function(e){var i,n,r=e.data,o=t.getMeasureField()[0];return("horizontal"===t.direction?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(n=t.getYAxisHelper())||void 0===n?void 0:n.isInverse())?(null==r?void 0:r[o])>=0?"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:(null==r?void 0:r[o])>=0?"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]}}];return e}function j8(t){var e,i=t.labelSpec,n=null!==(e=I8(i.position))&&void 0!==e?e:"outside";return{position:n,smartInvert:i.smartInvert?i.smartInvert:P(n)&&n.includes("inside")}}function H8(t){var e,i,n,r,o=t.labelSpec,a=t.series,s=null===(n=null===(i=null===(e=a.getViewDataStatistics)||void 0===e?void 0:e.call(a).latestData)||void 0===i?void 0:i[a.getSeriesField()])||void 0===n?void 0:n.values,l=s?s.map((function(t,e){var i;return(i={})[a.getSeriesField()]=t,i.index=e,i})):[];return{position:null!==(r=o.position)&&void 0!==r?r:"end",data:l}}var N8=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=f.label,r.name=f.label,r.layoutType="none",r.layoutZIndex=t.LayoutZIndex.Label,r._regions=n.getRegionsInIndex([n.specIndex]),r}return r(i,e),i.prototype._interactiveConfig=function(t){if(!0!==t.interactive)return{hover:!1,select:!1};var e={hover:!1,select:!1,state:t.state},i=this._option.getChart().getSpec(),n=i.hover,r=i.select;return!1===n&&!1===n.enable||(e.hover=!0),!1===r&&!1===r.enable||(e.select=!0),e},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return n.reRender=!0,nt(i,t)||(n.reMake=!0),n},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.type=f.label,i}(fq),V8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skipEncode=!1,e}return r(e,t),e.prototype.getRule=function(){return this._rule},e.prototype.setRule=function(t){this._rule=t},e.prototype.getTarget=function(){return this._target},e.prototype.setTarget=function(t){this._target=t,this._rule||this.setRule(t.type)},e.prototype.getComponent=function(){return this._component},e.prototype.setComponent=function(t){this._component=t},e.type="text",e.constructorType="label",e}(Yq),G8=function(){FU.registerMark(V8.constructorType,V8),eH()},W8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._initTheme=function(t,e){return{spec:t,theme:this._theme}},e}(dq),U8=function(e){function i(i,n){var r=e.call(this,i,n)||this;return r.type=f.label,r.name=f.label,r.specKey="label",r.transformerConstructor=W8,r.layoutZIndex=t.LayoutZIndex.Label,r._layoutRule=i.labelLayout||"series",r}return r(i,e),i.getSpecInfo=function(t,e){var i=[],n=(null==e?void 0:e.region)||[];return n.forEach((function(n,r){var o=(n.seriesIndexes||[]).some((function(t){var i=e.series[t].markLabelSpec,n=void 0===i?{}:i;return Object.values(n).some((function(t){return Array.isArray(t)&&function(t){return t.some((function(t){return t.visible}))}(t)}))}));("region"!==t.labelLayout||o)&&i.push({spec:t,type:f.label,specInfoPath:["region",r,"markLabel"],specIndex:r})})),i},i.prototype.init=function(t){e.prototype.init.call(this,t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()},i.prototype.reInit=function(t){e.prototype.reInit.call(this,t),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initTextMarkStyle()},i.prototype.initEvent=function(){var e=this;this.event.on(t.ChartEvent.dataZoomChange,(function(){e._labelComponentMap.forEach((function(t,e){var i=e.getProduct().getGroupGraphicItem();i&&i.disableAnimation()})),e.event.on(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_RENDER_END,i)}));var i=function(){e._labelComponentMap.forEach((function(t,e){var i=e.getProduct().getGroupGraphicItem();i&&i.enableAnimation()})),e.event.off(t.VGRAMMAR_HOOK_EVENT.AFTER_MARK_RENDER_END,i)};this.event.on("afterElementEncode",(function(t){var i,n=t.item;!1===e._option.getChart().getLayoutTag()&&(null===(i=n.getContext())||void 0===i?void 0:i.model)===e&&e._delegateLabelEvent(n.getGroupGraphicItem())}))},i.prototype._delegateLabelEvent=function(t){var e=this,i=null==t?void 0:t.findAll((function(t){return"text"===t.type}),!0).filter((function(t){return!t.__vchart_event}));i&&i.length>0&&i.forEach((function(i){i.__vchart_event=!0,i.addEventListener("*",(function(n,r){return e._delegateEvent(t,n,r,i,i.attribute.data)}))}))},i.prototype._initTextMark=function(){var t=this;this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),tw(this._regions,(function(e){var i=e.getSpecInfo().markLabelSpec,n=void 0===i?{}:i,r=Object.keys(n),o=e.getRegion();t._labelInfoMap.get(o)||t._labelInfoMap.set(o,[]);for(var a=function(i){var a=r[i],s=e.getMarkInName(a);if(!s)return"continue";n[a].forEach((function(i,n){if(i.visible){var r=t._labelInfoMap.get(o),l=t._createMark({type:"label",name:"".concat(a,"-label-").concat(n)},{noSeparateStyle:!0,attributeContext:e.getMarkAttributeContext()});l.setTarget(s),r.push({labelMark:l,baseMark:s,series:e,labelSpec:i})}}))},s=0;s<r.length;s++)a(s)}))},i.prototype._initLabelComponent=function(){var t=this;this._labelInfoMap.forEach((function(e,i){if("region"===t._layoutRule){var n=t._createMark({type:"component",name:"".concat(i.getGroupMark().name,"-label-component")},{componentType:"label",noSeparateStyle:!0,support3d:t._spec.support3d});n&&(n.setSkipBeforeLayouted(!0),t._marks.addMark(n),t._labelComponentMap.set(n,(function(){return t._labelInfoMap.get(i)})))}else e.forEach((function(e,n){var r=t._createMark({type:"component",name:"".concat(e.labelMark.name,"-component")},{componentType:"label",noSeparateStyle:!0,support3d:e.baseMark.getSupport3d()});r&&(r.setSkipBeforeLayouted(!0),t._marks.addMark(r),t._labelComponentMap.set(r,(function(){return t._labelInfoMap.get(i)[n]})),e.labelMark.setComponent(r))}))}))},i.prototype._initTextMarkStyle=function(){var e=this;this._labelInfoMap.forEach((function(i){i.forEach((function(i){var n,r,o=i.labelMark,a=i.labelSpec,s=i.series;if(e.initMarkStyleWithSpec(o,a,void 0),A(null==a?void 0:a.getStyleHandler)){var l=a.getStyleHandler(s);null==l||l.call(s,o)}(null===(r=null===(n=o.stateStyle)||void 0===n?void 0:n.normal)||void 0===r?void 0:r.lineWidth)&&o.setAttribute("stroke",s.getColorAttribute(),"normal",t.AttributeLevel.Base_Series)}))}))},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this),this._labelComponentMap.forEach((function(e,i){var n=e();B(n)?t._updateMultiLabelAttribute(n,i):t._updateSingleLabelAttribute(n,i)}))},i.prototype._updateMultiLabelAttribute=function(t,e){this._updateLabelComponentAttribute(e.getProduct(),t.map((function(t){return t.baseMark.getProduct()})),t)},i.prototype._updateSingleLabelAttribute=function(t,e){var i=t.baseMark;this._updateLabelComponentAttribute(e.getProduct(),i.getProduct(),[t])},i.prototype._updateLabelComponentAttribute=function(t,e,i){var n=this,r=this._option.getAllComponents().filter((function(t){return"totalLabel"===t.type}));t.target(e).configure({interactive:!1}).depend(r.map((function(t){return t.getMarks()[0].getProduct()}))).labelStyle((function(t,e){var r,a,s=i[e.labelIndex];if(s){var l=s.labelSpec,u=s.labelMark.getRule(),c=n._interactiveConfig(l),h=null!==(a=null===(r=n._spec)||void 0===r?void 0:r.centerOffset)&&void 0!==a?a:0,d=$W({textStyle:o({pickable:!0===l.interactive},l.style),overlap:{avoidMarks:n._option.getAllComponents().filter((function(t){return"totalLabel"===t.type})).map((function(t){return t.getMarks()[0].getProductId()}))},x:0,y:0},function(t,e){var i,n=e.labelSpec;return n.overlap&&!M(n.overlap)&&(n.overlap={}),(null!==(i=L8[t])&&void 0!==i?i:L8.point)(e)}(u,s),o(o(o({},$(l,["position","style","state","type"])),c),{centerOffset:h}));return"line"!==u&&"area"!==u||(d.type=u),d}})).encode((function(t,e,n){if(i[n.labelIndex]){var r=i[n.labelIndex],o=r.labelSpec;return r.labelMark.skipEncode?{data:t}:O8(i[n.labelIndex],t,o.formatMethod,o.formatter)}})).size((function(){return i[0].series.getRegion().getLayoutRect()}))},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i,n,r=t._labelComponentMap.get(e)();n=B(r)?r[0].series.getRegion().getGroupMark().getProduct():r.series.getRegion().getGroupMark().getProduct(),e.compile({group:n}),null===(i=e.getProduct())||void 0===i||i.configure({context:{model:t,labelInfo:r}})}))},i.prototype.getVRenderComponents=function(){var t=[];return this._labelComponentMap.forEach((function(e,i){var n=i.getProduct().getGroupGraphicItem();n&&t.push(n)})),t},i.type=f.label,i.specKey="label",i.transformerConstructor=W8,i}(N8),Y8=function(){TH(),G8(),Z3(),FU.registerComponent(U8.type,U8,!0)},K8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.totalLabel,i.name=f.totalLabel,i.specKey="totalLabel",i.layoutZIndex=t.LayoutZIndex.Label,i}return r(i,e),i.getSpecInfo=function(t,e){var i,n=this,r=[];return null===(i=null==e?void 0:e.region)||void 0===i||i.forEach((function(t,i){var o;null===(o=t.seriesIndexes)||void 0===o||o.forEach((function(t){var o=e.series[t].spec[n.specKey];(null==o?void 0:o.visible)&&r.push({spec:o,type:f.totalLabel,specPath:["series",t,n.specKey],specIndex:i})}))})),r},i.prototype.init=function(t){e.prototype.init.call(this,t),this._initTextMark(),this._initLabelComponent()},i.prototype._initTextMark=function(){var t,e=this._getSeries();if(null===(t=e.getSpec().totalLabel)||void 0===t?void 0:t.visible){var i=e.getMarksInType(["rect","symbol"])[0],n=this._createMark({type:"label",name:"".concat(i.name,"-total-label")});this._baseMark=i,this._textMark=n,this._initTextMarkStyle()}},i.prototype._initTextMarkStyle=function(){e.prototype.initMarkStyleWithSpec.call(this,this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:function(t){return t[_V]}},"normal",t.AttributeLevel.Default)},i.prototype._initLabelComponent=function(){var t=this._getSeries(),e=this._createMark({type:"component",name:"".concat(t.name,"-total-label-component")},{componentType:"label",noSeparateStyle:!0,support3d:this._spec.support3d});e&&this._marks.addMark(e)},i.prototype.updateLayoutAttribute=function(){var t=this;e.prototype.updateLayoutAttribute.call(this);var i=this._getSeries();this._marks.forEach((function(e,n){e.getProduct().target(t._baseMark.getProduct()).configure({interactive:!1}).labelStyle((function(){if(t._baseMark){var e=t._spec,n=e.offset,r=e.animation,a=e.overlap,s=t._interactiveConfig(t._spec);return $W({textStyle:{pickable:!0===t._spec.interactive},position:X8(i,t._baseMark.type),x:0,y:0},o({offset:n,animation:r,overlap:a,dataFilter:function(t){return t.filter((function(t){return t.data[xV]}))}},s))}})).encode((function(e){return O8({baseMark:t._baseMark,labelMark:t._textMark,series:i,labelSpec:i.getSpec().totalLabel},e,t._spec.formatMethod)})).size((function(){return t._regions[0].getLayoutRect()}))}))},i.prototype.compileMarks=function(){var t=this;this.getMarks().forEach((function(e){var i,n=t._regions[0].getGroupMark().getProduct();e.compile({group:n}),null===(i=e.getProduct())||void 0===i||i.configure({context:{model:t}})}))},i.prototype.getVRenderComponents=function(){var t=[];return this.getMarks().forEach((function(e){var i=e.getProduct().getGroupGraphicItem();i&&t.push(i)})),t},i.prototype._getSeries=function(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]},i.type=f.totalLabel,i.specKey="totalLabel",i}(N8);function X8(t,e){var i;if("rect"===e)i="horizontal"===t.direction?"right":"top";else i="top";return i}var Z8=function(){TH(),G8(),Z3(),FU.registerComponent(K8.type,K8,!0)},q8=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.markPoint,i.name=f.markPoint,i.specKey="markPoint",i.layoutZIndex=t.LayoutZIndex.MarkPoint,i}return r(i,e),i.getSpecInfo=function(t){var e=this,i=t[this.specKey];if(!W(i)){if(!B(i)&&!1!==i.visible)return[{spec:i,specPath:[this.specKey],type:f.markPoint}];var n=[];return i.forEach((function(t,i){!1!==t.visible&&n.push({spec:t,specIndex:i,specPath:[e.specKey,i],type:f.markPoint})})),n}},i.prototype._createMarkerComponent=function(){var t,e,i=this._spec,n=i.itemContent,r=void 0===n?{}:n,s=i.itemLine,l=void 0===s?{}:s,u=r.text,c=void 0===u?{}:u,h=r.symbol,d=r.image,f=r.richText,p=a(r,["text","symbol","image","richText"]),v={zIndex:this.layoutZIndex,interactive:null!==(t=this._spec.interactive)&&void 0!==t&&t,position:{x:0,y:0},clipInRange:null!==(e=this._spec.clip)&&void 0!==e&&e,itemContent:o({symbolStyle:DU(null==h?void 0:h.style),imageStyle:null==d?void 0:d.style,textStyle:y8(c),richTextStyle:null==f?void 0:f.style},p)},y=l.visible,g=l.line,m=void 0===g?{}:g,_=a(l,["visible","line"]);return v.itemLine=!1!==y?o(o({},_),{visible:!0,lineStyle:DU(m.style)}):{visible:!1},new YD(v)},i.prototype._markerLayout=function(){var t,e,i,n,r,a,s,l=this._spec,u=this._markerData,c=this._relativeSeries,h="x"in l&&"y"in l,d="coordinate"in l,f="position"in l,p=null!==(t=null==l?void 0:l.autoRange)&&void 0!==t&&t;h?s=d8(u,c,c,c,p)[0][0]:d?s=f8(u,c,p,l.coordinatesOffset)[0]:f&&(s=p8([l.position],c,l.regionRelative)[0]);var v,y=this._relativeSeries.getViewData().latestData,g=u?u.latestData[0]&&u.latestData[0].latestData?u.latestData[0].latestData:u.latestData:y;if(l.clip||(null===(e=l.itemContent)||void 0===e?void 0:e.confine)){var m=v8([c.getRegion()]),_=m.minX,b=m.maxX,x=m.minY;v={x:_,y:x,width:b-_,height:m.maxY-x}}if(this._markerComponent){var k=null!==(i=this._markerComponent.attribute)&&void 0!==i?i:{},S=null!==(r=null===(n=k.itemContent)||void 0===n?void 0:n.textStyle)&&void 0!==r?r:{};this._markerComponent.setAttributes({position:s,itemContent:o(o({},k.itemContent),{textStyle:o(o({},S),{text:(null===(a=this._spec.itemContent.text)||void 0===a?void 0:a.formatMethod)?this._spec.itemContent.text.formatMethod(g,y):S.text})}),limitRect:v,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}},i.prototype._initDataView=function(){var t=this,e=this._spec,i=this._relativeSeries,n=T(e.x)&&T(e.y),r=T(e.coordinate);if(r||n){var o;hY(this._option.dataSet,"markerAggregation",n8),hY(this._option.dataSet,"markerFilter",_8),n?o=[this._processSpecXY(e.x,e.y)]:r&&(o=this._processSpecCoo(e));var a=new Ma(this._option.dataSet,{name:"".concat(this.type,"_").concat(this.id,"_data")});a.parse([i.getViewData()],{type:"dataview"}),a.transform({type:"markerAggregation",options:o}),o&&a.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),a.target.on("change",(function(){t._markerLayout()})),this._markerData=a}},i.type=f.markPoint,i.specKey="markPoint",i}(g8),J8=function(){FU.registerComponent(q8.type,q8)},Q8="inBrush",$8="outOfBrush",t6=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.layoutType="none",i.type=f.brush,i.name=f.brush,i.specKey="brush",i.layoutZIndex=t.LayoutZIndex.Brush,i._linkedSeries=[],i._itemMap={},i._linkedItemMap={},i._inBrushElementsMap={},i._outOfBrushElementsMap={},i._linkedInBrushElementsMap={},i._linkedOutOfBrushElementsMap={},i._needInitOutState=!0,i._cacheInteractiveRangeAttrs=[],i._needDisablePickable=!1,i}return r(i,e),i.prototype.init=function(){var e=this._transformBrushedMarkAttr(this._spec.inBrush),i=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach((function(n){n.getActiveMarks().forEach((function(r){r&&(n.setMarkStyle(r,o({},e),Q8,t.AttributeLevel.Series),n.setMarkStyle(r,o({},i),$8,t.AttributeLevel.Series))}))}))},i.getSpecInfo=function(t){var e=t[this.specKey];if(!w(e)&&!1!==e.visible)return[{spec:e,specPath:[this.specKey],type:f.brush}]},i.prototype.created=function(){e.prototype.created.call(this),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initNeedOperatedItem()},i.prototype._extendDataInBrush=function(t){var e=[];for(var i in t)for(var n in t[i])e.push(t[i][n].data[0]);return e},i.prototype._extendDatumOutOfBrush=function(t){var e=[];for(var i in t)e.push(t[i].data[0]);return e},i.prototype._getBrushInteractiveAttr=function(t){var e=t.getLayoutStartPoint(),i=t.getLayoutRect(),n=e.x,r=n+i.width,o=e.y,a=o+i.height;return{interactiveRange:{minY:o,maxY:a,minX:n,maxX:r},xRange:[n,r],yRange:[o,a]}},i.prototype._updateBrushComponent=function(t,e){var i=this._getBrushInteractiveAttr(t),n=this._brushComponents[e];n.setAttributes(i),this._initMarkBrushState(e,""),n.children[0].removeAllChild(),this._needInitOutState=!0},i.prototype._createBrushComponent=function(e,i){var n,r,a=this,s=this._getBrushInteractiveAttr(e),l=new ZF(o(o(o({zIndex:this.layoutZIndex,brushStyle:DU(null===(n=this._spec)||void 0===n?void 0:n.style)},s),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));l.id=null!==(r=this._spec.id)&&void 0!==r?r:"brush-".concat(this.id),this.getContainer().add(l);var u=this._spec.brushMode,c=void 0===u?"single":u;this._brushComponents.push(l),this._cacheInteractiveRangeAttrs.push(s),l.addEventListener(WF.drawStart,(function(i){a._emitEvent(t.ChartEvent.brushStart,e)})),l.addEventListener(WF.moveStart,(function(i){a._emitEvent(t.ChartEvent.brushStart,e)})),l.addEventListener(WF.drawing,(function(n){a._needInitOutState&&"single"===c&&a._initMarkBrushState(i,$8),a._needInitOutState=!1,a._needDisablePickable=!0,a._handleBrushChange(t.ChartEvent.brushChange,e,n)})),l.addEventListener(WF.moving,(function(i){a._handleBrushChange(t.ChartEvent.brushChange,e,i)})),l.addEventListener(WF.brushClear,(function(n){a._initMarkBrushState(i,""),a._needInitOutState=!0,a._needDisablePickable=!1,a._handleBrushChange(t.ChartEvent.brushChange,e,n),a._handleBrushChange(t.ChartEvent.brushClear,e,n)})),l.addEventListener(WF.drawEnd,(function(i){a._needInitOutState=!0,a._needDisablePickable=!1,a._handleBrushChange(t.ChartEvent.brushEnd,e,i)})),l.addEventListener(WF.moveEnd,(function(i){a._handleBrushChange(t.ChartEvent.brushEnd,e,i)}))},i.prototype._handleBrushChange=function(t,e,i){var n=i.detail.operateMask;this._reconfigItem(n,e),this._reconfigLinkedItem(n,e),this._emitEvent(t,e)},i.prototype._emitEvent=function(t,e){this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap}})},i.prototype._transformBrushedMarkAttr=function(t){var e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),o(o({},DU(t)),e)},i.prototype._reconfigItem=function(t,e){var i=this;this._itemMap[e.id].forEach((function(e){var n=e.getProduct();n&&n.elements&&n.elements.length&&n.elements.forEach((function(n){var r,o,a,s=n.getGraphicItem(),l=e.id+"_"+n.key;(null===(r=i._outOfBrushElementsMap)||void 0===r?void 0:r[l])&&i._isBrushContainItem(t,s)?(n.addState(Q8),i._inBrushElementsMap[null==t?void 0:t.name]||(i._inBrushElementsMap[null==t?void 0:t.name]={}),i._inBrushElementsMap[null==t?void 0:t.name][l]=n,delete i._outOfBrushElementsMap[l]):(null===(a=null===(o=i._inBrushElementsMap)||void 0===o?void 0:o[null==t?void 0:t.name])||void 0===a?void 0:a[l])&&!i._isBrushContainItem(t,s)&&(n.removeState(Q8),n.addState($8),i._outOfBrushElementsMap[l]=n,delete i._inBrushElementsMap[t.name][l]),s.setAttribute("pickable",!i._needDisablePickable)}))}))},i.prototype._reconfigLinkedItem=function(t,e){var i=this,n=e.getLayoutStartPoint(),r=e.getSeries().map((function(t){return t.id}));this._linkedSeries.forEach((function(e){if(!r.includes(e.id)){var o=e.getRegion().getLayoutStartPoint(),a=o.x-n.x,s=o.y-n.y;i._linkedItemMap[e.id].forEach((function(e){var n=e.getProduct();n&&n.elements&&n.elements.length&&n.elements.forEach((function(n){var r,o,l,u=n.getGraphicItem(),c=e.id+"_"+n.key;(null===(r=i._linkedOutOfBrushElementsMap)||void 0===r?void 0:r[c])&&i._isBrushContainItem(t,u,{dx:a,dy:s})?(n.addState(Q8),i._linkedInBrushElementsMap[null==t?void 0:t.name]||(i._linkedInBrushElementsMap[null==t?void 0:t.name]={}),i._linkedInBrushElementsMap[null==t?void 0:t.name][c]=n,delete i._linkedOutOfBrushElementsMap[c]):(null===(l=null===(o=i._linkedInBrushElementsMap)||void 0===o?void 0:o[null==t?void 0:t.name])||void 0===l?void 0:l[c])&&!i._isBrushContainItem(t,u,{dx:a,dy:s})&&(n.removeState(Q8),n.addState($8),i._linkedOutOfBrushElementsMap[c]=n),u.setAttribute("pickable",!i._needDisablePickable)}))}))}}))},i.prototype._isBrushContainItem=function(t,e,i){var n,r,o;if(!(null==t?void 0:t.globalTransMatrix)||!(null===(n=null==t?void 0:t.attribute)||void 0===n?void 0:n.points))return!1;var a=null!==(o=null===(r=null==t?void 0:t.attribute)||void 0===r?void 0:r.points)&&void 0!==o?o:[],s=t.globalTransMatrix,l=s.a,u=s.b,c=s.c,h=s.d,d=s.e,f=s.f,p=(null==i?void 0:i.dx)||0,v=(null==i?void 0:i.dy)||0,y=a.map((function(t){return{x:l*t.x+c*t.y+d+p,y:u*t.x+h*t.y+f+v}}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+p,t.globalAABBBounds.y1+v,t.globalAABBBounds.x2+p,t.globalAABBBounds.y2+v);var g=e.globalTransMatrix.e,m=e.globalTransMatrix.f;if("symbol"===e.type){var _=(null==e?void 0:e.attribute).size,b=lt(void 0===_?0:_)[0]/2;return hi(y,[{x:g-b,y:m-b},{x:g+b,y:m-b},{x:g+b,y:m+b},{x:g-b,y:m+b}])}if("rect"===e.type){var x=null==e?void 0:e.AABBBounds,k=x.x1,S=x.x2,A=x.y1,w=x.y2,T=Math.abs(k-S),M=Math.abs(A-w);return hi(y,[{x:g,y:m},{x:g+T,y:m},{x:g+T,y:m+M},{x:g,y:m+M}])}return t.globalAABBBounds.intersects(e.globalAABBBounds)},i.prototype._bindRegions=function(){T(this._spec.regionId)&&T(this._spec.regionIndex)&&(this._relativeRegions=this._option.getAllRegions()),this._relativeRegions=this._option.getRegionsInUserIdOrIndex(lt(this._spec.regionId),lt(this._spec.regionIndex))},i.prototype._bindLinkedSeries=function(){T(this._spec.brushLinkSeriesId)&&T(this._spec.brushLinkSeriesIndex)||(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(lt(this._spec.brushLinkSeriesId),lt(this._spec.brushLinkSeriesIndex)))},i.prototype._initNeedOperatedItem=function(){var t=this,e=this._spec.seriesId,i=this._spec.seriesIndex;this._relativeRegions.forEach((function(n){var r=[];n.getSeries().forEach((function(o){(e&&lt(e).includes(o.userId.toString())||i&&lt(i).includes(o.getSpecIndex())||!i&&!e)&&r.push.apply(r,h([],c(o.getMarksWithoutRoot()),!1)),t._itemMap[n.id]=r}))})),this._linkedSeries.forEach((function(e){t._linkedItemMap[e.id]=e.getMarksWithoutRoot()}))},i.prototype._initMarkBrushState=function(t,e){var i=this;this._brushComponents.forEach((function(e,i){i!==t&&e.children[0].removeAllChild()})),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._option.getAllSeries().forEach((function(t){t.getMarksWithoutRoot().forEach((function(t){var n=t.getProduct();n&&n.elements&&n.elements.length&&n.elements.forEach((function(n){var r=t.id+"_"+n.key;n.removeState(Q8),n.removeState($8),n.addState(e),i._outOfBrushElementsMap[r]=n,i._linkedOutOfBrushElementsMap[r]=n}))}))}))},i.prototype.initEvent=function(){},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return this._brushComponents},i.prototype._compareSpec=function(t,i){var n=this;this._brushComponents&&this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)}));var r=e.prototype._compareSpec.call(this,t,i);return nt(i,t)||(r.reRender=!0,r.reMake=!0),r},i.prototype.onLayoutEnd=function(t){var i,n=this;(e.prototype.onLayoutEnd.call(this,t),this._option.disableTriggerEvent)||(null===(i=this._spec.visible)||void 0===i||i)&&(this._brushComponents?this._relativeRegions.forEach((function(t,e){n._updateBrushComponent(t,e)})):(this._brushComponents=[],this._relativeRegions.forEach((function(t,e){n._createBrushComponent(t,e)}))))},i.prototype.clearGraphic=function(){this._brushComponents&&this._brushComponents.forEach((function(t){t._container.incrementalClearChild()}))},i.prototype.clear=function(){var t;this._brushComponents&&(null===(t=this.getContainer())||void 0===t||t.removeChild(this._brushComponents),this._brushComponents.forEach((function(t){t.removeAllChild(),t.releaseBrushEvents()})),this._brushComponents=null),e.prototype.clear.call(this)},i.type=f.brush,i.specKey="brush",i}(fq),e6=function(){FU.registerComponent(t6.type,t6)},i6=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return r(e,t),e.prototype._getDefaultStyle=function(){return o(o({},t.prototype._getDefaultStyle.call(this)),{width:void 0,height:void 0,lineWidth:0})},e.type="image",e}(vK),n6=function(){FU.registerMark(i6.type,i6),jL(),SL(),gT.registerGraphic(sw.image,wy)},r6=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.customMark,i.specKey="customMark",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.CustomMark,i.layoutLevel=t.LayoutLevel.CustomMark,i}return r(i,e),i.getSpecInfo=function(t){var e=t[this.specKey];return e?[{spec:e,specIndex:0,specPath:[this.specKey],type:f.customMark}]:null},i.prototype.created=function(){e.prototype.created.call(this),this.initMarks(),this.initEvent()},i.prototype.initMarks=function(){var t=this;this._spec&&this._spec.forEach((function(e,i){t._createExtensionMark(e,null,"".concat(bw,"_series_").concat(t.id,"_extensionMark"),i)}))},i.prototype._createExtensionMark=function(t,e,i,n){var r,o=this,a=this._createMark({type:t.type,name:"".concat(bw,"_").concat(n)},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext()});if(a&&(w(e)?this._marks.addMark(a):e&&e.addMark(a),this.initMarkStyleWithSpec(a,t),"group"===t.type&&(i="".concat(i,"_").concat(n),null===(r=t.children)||void 0===r||r.forEach((function(t,e){o._createExtensionMark(t,a,i,e)}))),T(t.dataId)||F(t.dataIndex))){var s=this.getChart().getSeriesData(t.dataId,t.dataIndex);s&&(s.target.addListener("change",(function(){a.getData().updateData()})),a.setDataView(s))}},i.prototype.initEvent=function(){},i.prototype._compareSpec=function(t,i){var n=e.prototype._compareSpec.call(this,t,i);return nt(i,t)||(n.reMake=!0),n.change=!0,n.reRender=!0,n},i.prototype.changeRegions=function(t){},i.prototype._getNeedClearVRenderComponents=function(){return[]},i.prototype.onRender=function(t){},i.prototype._getMarkAttributeContext=function(){var t=this;return{vchart:this._option.globalInstance,globalScale:function(e,i){var n;return null===(n=t._option.globalScale.getScale(e))||void 0===n?void 0:n.scale(i)}}},i.type=f.customMark,i.specKey="customMark",i}(fq),o6=function(){n6(),FU.registerComponent(r6.type,r6)};function a6(t,e,i){return void 0===i&&(i=0),i>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}function s6(t){return{x1:t.x,x2:t.x+t.width,y1:t.y,y2:t.y+t.height}}function l6(t){var e;if(!t||0===t.length)return[];if(1===t.length)return[t[0].rect];var i=t.map((function(t){var e;return o(o({},t),{bound:s6(t.rect),anchorCandidates:p6(null!==(e=t.anchors)&&void 0!==e?e:[],t.point,t.rect,t.offset)})})),n=[];n.push(i[0].bound);for(var r=function(t){var r=i[t],o=r.bound,a=n.some((function(t){return a6(t,o)}));if(!r.anchorCandidates)return"continue";if(a&&(null===(e=r.anchorCandidates)||void 0===e?void 0:e.length)>0){for(var s=function(t){var e=r.anchorCandidates[t],i={x1:e.x,y1:e.y,x2:e.x+o.x2-o.x1,y2:e.y+o.y2-o.y1,anchor:e};if(!n.some((function(t){return a6(t,i)})))return n.push(i),a=!1,"break"},l=0;l<r.anchorCandidates.length;l++){if("break"===s(l))break}a&&n.push(r.bound)}else n.push(r.bound)},a=1;a<=i.length-1;a++)r(a);return n.map((function(t){return function(t){return{x:t.x1,y:t.y1,width:t.x2-t.x1,height:t.y2-t.y1}}(t)}))}function u6(t,e,i){var n=t.map((function(t){return t.pointCoord})),r=oi(n),o=r.x1,a=r.x2,s=r.y1,l=r.y2,u=i([(o+a)/2,(s+l)/2]);if(!u)return[];var c=t.map((function(t){var n=t.rect,r=d6(e,t.pointCoord)?i(function(t,e,i,n){void 0===n&&(n=200);for(var r=5621/n,o=e,a=1;a<=r;a++){var s=wi(o,n,i);if(!d6(t,s))return[s.x,s.y];o=[s.x,s.y]}return e}(e,[t.pointCoord.x,t.pointCoord.y],c6(h6(t.point,u)))):t.point;r&&(n.x=r.x,n.y=r.y);var o,a=c6(h6(t.point,u)),s=[];return a>=-45&&a<45?(o="top",s.push("left","right")):a>=45&&a<135?o="right":a>=-135&&a<-45?(o="left",s.push("left")):(o="bottom",s.push("left","right")),t.anchors=s,t.offset=20,t.rect=f6(t.rect,o,0),t}));return l6(c)}function c6(t){return t>180?t-360:t}function h6(t,e){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90}function d6(t,e){for(var i=0;i<t.length;i++){if(Ai(e,t[i]))return!0}return!1}function f6(t,e,i){void 0===i&&(i=0);var n=o({},t);return"top"===e?(n.x-=t.width/2,n.y-=i+t.height/2):"bottom"===e?(n.x-=t.width/2,n.y+=i-t.height/2):"left"===e?(n.x-=i+t.width,n.y-=t.height/2):"right"===e&&(n.x+=i,n.y-=t.height/2),n}function p6(t,e,i,n){void 0===n&&(n=0);var r=[];return t.forEach((function(t){var a=f6(o(o({},e),{width:i.width,height:i.height}),t,n),s=a.x,l=a.y;r.push({x:s,y:l})})),r}var v6=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=f.mapLabel,i.name=f.mapLabel,i.specKey="mapLabel",i.layoutType="none",i.layoutZIndex=t.LayoutZIndex.MarkPoint,i._activeDatum=[],i}return r(i,e),i.getSpecInfo=function(t){var e=t[this.specKey];return e&&e.visible&&!T(e.series)?[{spec:e,specPath:[this.specKey],type:f.mapLabel}]:null},i.prototype.setAttrFromSpec=function(){var t,e,i,n;this.nameField=null!==(t=this._spec.nameField)&&void 0!==t?t:null===(e=this._series)||void 0===e?void 0:e.getDimensionField()[0],this.valueField=null!==(i=this._spec.valueField)&&void 0!==i?i:null===(n=this._series)||void 0===n?void 0:n.getMeasureField()[0]},i.prototype.created=function(){e.prototype.created.call(this),!1!=!!this._spec.visible&&(this.initRelatedInfo(),this.initData(),this.initEvent())},i.prototype.initRelatedInfo=function(){var t,e,i,n,r,o,a,s;this._series=this._option.getSeriesInUserIdOrIndex([this._spec.seriesId])[0],"outer"===this._spec.position&&(this._map=null===(e=null===(t=this._regions[0].getSeriesInType("map")[0])||void 0===t?void 0:t.getMapViewData())||void 0===e?void 0:e.latestData,this._longitudeField=null===(r=null===(n=(i=this._regions[0]).getSpec)||void 0===n?void 0:n.call(i))||void 0===r?void 0:r.longitudeField,this._latitudeField=null===(s=null===(a=(o=this._regions[0]).getSpec)||void 0===a?void 0:a.call(o))||void 0===s?void 0:s.latitudeField)},i.prototype.initData=function(){var t=this,e=this._series;if(e){var i=e.getViewData();if(i){var n=new Ma(this._option.dataSet,{name:"".concat(this.name,"_data")});n.parse([i],{type:"dataview"}),n.transform({type:"copyDataView",level:mY.copyDataView},!1),this._data=new dK(this._option,n),n.target.addListener("change",(function(){"hover"!==t._spec.trigger&&"click"!==t._spec.trigger&&(t._activeDatum=t._data.getLatestData())}))}}},i.prototype.initEvent=function(){var t=this;this.event.on("zoom",{filter:function(e){return t._isRelativeModel(e.model)}},(function(e){return t.handleZoom(e),!0})),this.event.on("panmove",{filter:function(e){return t._isRelativeModel(e.model)}},(function(e){return t.handlePan(e),!0}));var e=this._spec.trigger;"none"!==e&&("hover"===e?(this.event.on("hovered",{filter:function(e){return t._isRelativeSeries(e.model)}},(function(e){t._updateDatum(e.value)})),this.event.on("unhovered",(function(){t._updateDatum([])}))):"click"===e&&(this.event.on("selected",{filter:function(e){return t._isRelativeSeries(e.model)}},(function(e){t._updateDatum(e.value)})),this.event.on("unselected",(function(){t._updateDatum([])}))))},i.prototype.handlePan=function(t){var e=t.delta;this._markerComponents.forEach((function(t){t.translate(e[0],e[1])}))},i.prototype.handleZoom=function(t){this._updateMarkerLayoutAttribute()},i.prototype._updateDatum=function(t){var e=this;this._activeDatum=t,this._markerComponents.forEach((function(t,i){var n,r=null===(n=e._data)||void 0===n?void 0:n.getLatestData()[i];e._activeDatum.includes(r)?t.setAttribute("visible",!0):t.setAttribute("visible",!1)}))},i.prototype.dataToPosition=function(t){return this._series.dataToPosition(t)},i.prototype.updateLayoutAttribute=function(){var t,i=null===(t=this._data)||void 0===t?void 0:t.getLatestData();i&&0!==i.length&&(e.prototype.updateLayoutAttribute.call(this),this._updateMarkerLayoutAttribute())},i.prototype._updateMarkerLayoutAttribute=function(){var t,e=this,i=[],n=[];this._markerComponents||(this._markerComponents=null===(t=this._data)||void 0===t?void 0:t.getLatestData().map((function(t,i){var n,r=new YD({position:void 0});return r&&(r.name="".concat(e.name,"_marker_").concat(i),r.id=null!==(n=e._spec.id)&&void 0!==n?n:"".concat(e.name,"_marker_").concat(e.id),r.setAttribute("zIndex",e.layoutZIndex)),r}))),this._markerComponents.forEach((function(t,r){t.removeAllChild();var o=e._evaluateMarker(e._data.getLatestData()[r],r),a=o.pairInfo,s=o.contentMarks;a&&i.push(a),s&&n.push(s)}));var r=this._layoutLabels(i);this._layoutMarkers(r,n),this._renderMarkers()},i.prototype._evaluateMarker=function(t,e){var i,n,r,a,s,l,u,c,h,d,f,p,v=0,y=0,g=0,m=0,_=0,b=this._spec.position||"top",x=this._spec.offset,k=dW(null===(i=this._spec.background)||void 0===i?void 0:i.padding),S=this._spec.space||0;y+=((null==k?void 0:k.left)||0)+((null==k?void 0:k.right)||0),g+=((null==k?void 0:k.top)||0)+((null==k?void 0:k.bottom)||0);var A={},w=this.dataToPosition(t),M=lf({});if(M.name="".concat(this.name,"_marker_itemContainer_").concat(e),A.container=M,null===(n=this._spec.background)||void 0===n?void 0:n.visible){var C=dy(DU(o({},this._spec.background.style)));C.setAttributes(w),A.labelBackground=C,M.appendChild(C)}if(null===(r=this._spec.icon)||void 0===r?void 0:r.visible){var E=ry(DU(o({},this._spec.icon.style)));E.setAttributes(w),E.setAttribute("symbolType",null===(a=this._spec.icon.style)||void 0===a?void 0:a.shape);var R=E.AABBBounds,P=null!==(s=(null==R?void 0:R.y2)-(null==R?void 0:R.y1))&&void 0!==s?s:0,B=null!==(l=(null==R?void 0:R.x2)-(null==R?void 0:R.x1))&&void 0!==l?l:0;A.icon=E,M.appendChild(E),_=P,m+=B,v++}if(null===(u=this._spec.nameLabel)||void 0===u?void 0:u.visible){var L=np(DU(o({},this._spec.nameLabel.style)));L.setAttributes(w),L.setAttribute("text",t[this.nameField]);var O=L.AABBBounds,I=null!==(c=(null==O?void 0:O.y2)-(null==O?void 0:O.y1))&&void 0!==c?c:0,D=null!==(h=(null==O?void 0:O.x2)-(null==O?void 0:O.x1))&&void 0!==h?h:0;A.nameLabel=L,M.appendChild(L),_=Math.max(_,I),m+=D,v++}if((null===(d=this._spec.valueLabel)||void 0===d?void 0:d.visible)&&T(t[this.valueField])){var F=np(DU(o({},this._spec.valueLabel.style)));F.setAttributes(w),F.setAttribute("text",t[this.valueField]);var z=F.AABBBounds,j=null!==(f=(null==z?void 0:z.y2)-(null==z?void 0:z.y1))&&void 0!==f?f:0,H=null!==(p=(null==z?void 0:z.x2)-(null==z?void 0:z.x1))&&void 0!==p?p:0;A.valueLabel=F,M.appendChild(F),_=Math.max(_,j),m+=H,v++}var N=Object.values(A).find((function(t){return!!t&&"group"!==t.type})),V={x:null==N?void 0:N.getComputedAttribute("x"),y:null==N?void 0:N.getComputedAttribute("y")},G={x:V.x,y:V.y,width:0,height:0};G.width=y+m+(v-1)*S,G.height=g+_;var W={rect:G,point:V,index:e};if("outer"!==b){var U=["top","right","left","bottom"].filter((function(t){return t!==b}));W.rect=f6(G,b,x),W.anchors=U,W.offset=x}else W.pointCoord={x:+(null==t?void 0:t[this._longitudeField]),y:+(null==t?void 0:t[this._latitudeField])};return{pairInfo:W,contentMarks:A}},i.prototype._layoutMarkers=function(t,e){for(var i,n,r,a=function(a){if(!t[a]||!e[a])return{value:void 0};var l=e[a],u=l.icon,c=l.nameLabel,h=l.valueLabel,d=l.labelBackground,f=l.container,p=t[a],v=dW(null===(i=s._spec.background)||void 0===i?void 0:i.padding),y=s._spec.space||0,g=p.height/2,m=(null==v?void 0:v.left)||0;[u,c,h].forEach((function(t,e){var i,n;if(t){var r=t.AABBBounds,o=0;"symbol"===t.type&&(o+=(null!==(i=r.x2-r.x1)&&void 0!==i?i:0)/2),t.setAttributes({x:m+o,y:g}),m+=null!==(n=r.x2-r.x1)&&void 0!==n?n:0,2!==e&&(m+=y)}})),null==d||d.setAttributes({x:0,y:0,width:p.width,height:p.height}),null==f||f.setAttributes({dx:-p.width/2,dy:-p.height/2});var _=s._data.getLatestData()[a],b=s.dataToPosition(_),x=s.getRegions()[0].getLayoutStartPoint(),k=!(!(null===(n=s._spec.leader)||void 0===n?void 0:n.visible)||!(u||c||h));s._markerComponents[a].setAttributes({x:x.x,y:x.y,position:b,visible:s._activeDatum.includes(_),itemContent:{refX:0,type:"custom",renderCustomCallback:function(){return f},autoRotate:!1,offsetX:p.x+p.width/2-b.x,offsetY:p.y+p.height/2-b.y},itemLine:{visible:k,type:"type-po",lineStyle:DU(o({},null===(r=s._spec.leader)||void 0===r?void 0:r.style)),startSymbol:{visible:!1}}})},s=this,l=0;l<e.length;l++){var u=a(l);if("object"==typeof u)return u.value}},i.prototype._renderMarkers=function(){if(this._markerComponents&&this._markerComponents.length)for(var t=0;t<this._markerComponents.length;t++)this.getContainer().add(this._markerComponents[t])},i.prototype._layoutLabels=function(t){var e=this,i="outer"===this._spec.position&&this._map?u6(t,this._map,(function(t){var i;return e._series.dataToPosition(((i={})[e._longitudeField]=t[0],i[e._latitudeField]=t[1],i))})):l6(t);return i},i.prototype._isRelativeModel=function(t){var e,i,n,r=null!==(i=null===(e=this._series.getXAxisHelper())||void 0===e?void 0:e.getAxisId())&&void 0!==i?i:null===(n=this._series.getCoordinateHelper())||void 0===n?void 0:n.getCoordinateId();return(null==t?void 0:t.id)===r},i.prototype._isRelativeSeries=function(t){return(null==t?void 0:t.id)===this._series.id},i.prototype.onRender=function(t){},i.prototype.changeRegions=function(){},i.prototype._getNeedClearVRenderComponents=function(){return this._markerComponents},i.type=f.mapLabel,i.specKey="mapLabel",i}(fq),y6=function(){FU.registerComponent(v6.type,v6)},g6=function(){function t(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=new Array(this._col).fill(null),this._rowSize=new Array(this._row).fill(null),this._colElements=new Array(this._col).fill([]),this._rowElements=new Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}return t.prototype.standardizationSpec=function(t){var e,i,n;t.col=null!==(e=t.col)&&void 0!==e?e:1,t.row=null!==(i=t.row)&&void 0!==i?i:1,t.elements=null!==(n=t.elements)&&void 0!==n?n:[]},t.prototype.initUserSetting=function(){var t=this;this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((function(e,i){e||(t._colSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})})),this._rowSize.forEach((function(e,i){e||(t._rowSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})}))},t.prototype.setSizeFromUserSetting=function(t,e,i,n){t.forEach((function(t){t.index<0&&t.index>=i||(F(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:A(t.size)&&(e[t.index]={value:t.size(n),isUserSetting:!0,isLayoutSetting:!1}))}))},t.prototype.clearLayoutSize=function(){this._colSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})),this._rowSize.forEach((function(t){t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}))},t.prototype.getItemGridInfo=function(t){var e,i,n=this._elementMap.get(t);return n||((i=null===(e=this._gridInfo.elements)||void 0===e?void 0:e.find((function(e){var i;if("modelId"in e&&T(e.modelId)){if(T(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&T(e.modelKey)&&"modelIndex"in e&&T(e.modelIndex)){if((null!==(i=t.model.specKey)&&void 0!==i?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0}return!1})))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)},t.prototype.getSizeFromGird=function(t,e){for(var i,n="col"===e?this._colSize:this._rowSize,r=0,o=t[e];o<t[e]+(null!==(i=t["".concat(e,"Span")])&&void 0!==i?i:1);o++)r+=n[o].value;return r},t.prototype.getSizeFromUser=function(t,e){var i,n,r="col"===e?this._colSize:this._rowSize;if(null===(i=r[t[e]])||void 0===i?void 0:i.isUserSetting){for(var o=0,a=t[e];a<t[e]+(null!==(n=t["".concat(e,"Span")])&&void 0!==n?n:1);a++){if(!r[a].isUserSetting)return;o+=r[a].value}return o}},t.prototype.setItemLayoutSizeToGrid=function(t,e){if(m6(t)){if(e.colSpan&&e.colSpan>1)return;if(this._colSize[e.col].isUserSetting)return;this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0}else{if(e.rowSpan&&e.rowSpan>1)return;if(this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}},t.prototype.layoutGrid=function(t){var e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,n=[];e.forEach((function(t){t.isUserSetting||t.isLayoutSetting?i-=t.value:n.push(t)})),i<0&&console.warn("layout content ".concat(t," size bigger than chart")),n.forEach((function(t){return t.value=i/n.length}))},t.prototype.getItemPosition=function(t){for(var e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y},n=0;n<e.col;n++)i.x+=this._colSize[n].value;for(var r=0;r<e.row;r++)i.y+=this._rowSize[r].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i},t.prototype.getItemLayoutRect=function(t){var e,i,n=this.getItemGridInfo(t);return{width:(null!==(e=this.getSizeFromGird(n,"col"))&&void 0!==e?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(i=this.getSizeFromGird(n,"row"))&&void 0!==i?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}},t.prototype.layoutItems=function(t,e,i,n){var r=this;this._chartLayoutRect=i,this._chartViewBox=n,this.clearLayoutSize(),e.sort((function(t,e){return e.layoutLevel-t.layoutLevel}));var o=e.filter((function(t){return"normal"===t.layoutType&&!1!==t.getModelVisible()})),a=o.filter((function(t){return m6(t)})),s=o.filter((function(t){return!m6(t)}));o.forEach((function(t){r.layoutOneItem(t,"user",!1)}));var l=e.filter((function(t){return"region-relative"===t.layoutType})),u=l.filter((function(t){return m6(t)})),c=l.filter((function(t){return!m6(t)}));u.forEach((function(t){return r.layoutOneItem(t,"user",!1)})),this.layoutGrid("col"),s.forEach((function(t){return r.layoutOneItem(t,"colGrid",!1)})),c.forEach((function(t){r.layoutOneItem(t,"colGrid",!1)})),this.layoutGrid("row"),c.forEach((function(t){r.layoutOneItem(t,"grid",!1)})),a.forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),u.forEach((function(t){r.layoutOneItem(t,"grid",!0)})),this.layoutGrid("col"),e.filter((function(t){return"region"===t.layoutType})).forEach((function(t){return r.layoutOneItem(t,"grid",!1)})),this.layoutAbsoluteItems(e.filter((function(t){return"absolute"===t.layoutType}))),e.filter((function(t){return"absolute"!==t.layoutType})).forEach((function(t){t.setLayoutStartPosition(r.getItemPosition(t))}))},t.prototype.layoutAbsoluteItems=function(t){var e=this;t.forEach((function(t){t.absoluteLayoutInRect(e._chartLayoutRect)}))},t.prototype.layoutOneItem=function(t,e,i){var n,r,o="rowGrid"===e||"grid"===e?this.getSizeFromGird.bind(this):this.getSizeFromUser.bind(this),a="colGrid"===e||"grid"===e?this.getSizeFromGird.bind(this):this.getSizeFromUser.bind(this),s=this.getItemGridInfo(t),l={width:(null!==(n=a(s,"col"))&&void 0!==n?n:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(r=o(s,"row"))&&void 0!==r?r:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},u=t.computeBoundsInRect(l);F(u.width)||(u.width=l.width),F(u.height)||(u.height=l.height),t.setLayoutRect("grid"!==e?u:l),this.setItemLayoutSizeToGrid(t,s)},t.type="grid",t}();function m6(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}var _6=function(){FU.registerLayout(g6.type,g6)},b6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.layoutItems=function(t,e,i,n){this._layoutInit(t,e,i,n),this._layoutNormalItems(e);var r={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},o=e.filter((function(t){return"absolute"===t.layoutType})),a=o.filter((function(t){return"z"===t.layoutOrient})),s={width:0,height:0};a.length&&(s=a[0].getLayoutRect());this.leftCurrent+=s.width/8,this.rightCurrent-=s.width/8,this.topCurrent+=s.height/8,this.bottomCurrent-=s.height/8;var l=this._groupItems(e),u=l.regionItems,c=l.relativeItems,h=l.relativeOverlapItems,d=l.allRelatives,f=l.overlapItems;this.layoutRegionItems(u,c,h,f),this._processAutoIndent(u,c,h,f,d,r);var p=o.filter((function(t){return"z"!==t.layoutOrient}));this.layoutAbsoluteItems(p);var v=c.filter((function(t){return"axes"===t.model.specKey&&VU(t.layoutOrient)}))[0],y=c.filter((function(t){return"axes"===t.model.specKey&&GU(t.layoutOrient)}))[0];if(v&&a.length){var g=v.getLayoutStartPoint(),m=v.getLayoutRect(),_={x:"left"===y.layoutOrient?g.x+m.width:g.x,y:g.y,width:this._chartLayoutRect.width,height:this._chartLayoutRect.height};a[0].model.directionStr="left"===y.layoutOrient?"r2l":"l2r";var b=v.getLayoutRect(),x=y.getLayoutRect(),k={length:a[0].getLayoutRect().width,width:b.width,height:x.height};v.model.setLayout3dBox&&v.model.setLayout3dBox(k),y.model.setLayout3dBox&&y.model.setLayout3dBox(k),a[0].model.setLayout3dBox&&a[0].model.setLayout3dBox(k),this.layoutZAxisItems(a,_)}},e.prototype.layoutZAxisItems=function(t,e){t.forEach((function(t){t.absoluteLayoutInRect(e)}))},e.prototype.getItemComputeLayoutRect=function(t,e){return e||(e={offsetLeft:0,offsetRight:0,offsetTop:0,offsetBottom:0}),{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight-(e.offsetLeft+e.offsetRight),height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom-(e.offsetTop+e.offsetBottom)}},e.prototype._checkAutoIndent=function(t){var e=this,i={top:0,left:0,bottom:0,right:0},n=this._chartViewBox.x2-this._chartViewBox.x1-this.rightCurrent,r=this._chartViewBox.y2-this._chartViewBox.y1-this.bottomCurrent;return t.forEach((function(t){if(t.getModelVisible()&&t.autoIndent){var o="left"===t.layoutOrient||"right"===t.layoutOrient,a=t.getLastComputeOutBounds();o?(i.top=Math.max(i.top,a.y1-e.topCurrent),i.bottom=Math.max(i.bottom,a.y2-r)):(i.left=Math.max(i.left,a.x1-e.leftCurrent),i.right=Math.max(i.right,a.x2-n))}})),i},e.type="layout3d",e}(lK),x6=function(){FU.registerLayout(b6.type,b6)},k6=function(){_u.load(CO)};FK.useRegisters([zX,qX,hZ,RZ,v2,x2,A2,I2,l2,G2,X2,function(){F$(),j$(),X2()},t3,S3,T3,H2,o3,l3,B3,p3,g3,b3,E3,I3,R2,z3,M2,mZ,m2,F2,i3,h3,J2,function(){F$(),N$(),J2()},a5,u5,h5,f5,v5,x5,_5,T5,O5,N4,U4,K4,J4,$4,i8,xq,J8,x8,w8,S8,B8,Y8,Z8,e6,o6,y6,k6,_6,x6]),t.ARC_END_ANGLE=Bw,t.ARC_K=Lw,t.ARC_MIDDLE_ANGLE=Ow,t.ARC_QUADRANT=Iw,t.ARC_RADIAN=Dw,t.ARC_RATIO=Rw,t.ARC_START_ANGLE=Pw,t.ARC_TRANSFORM_VALUE=Ew,t.Arc3dMark=AJ,t.ArcMark=mJ,t.AreaChart=ZX,t.AreaMark=jX,t.AreaSeries=YX,t.BASE_EVENTS=tV,t.Bar3dChart=gZ,t.Bar3dSeries=pZ,t.BarChart=cZ,t.BarSeries=sZ,t.BaseChart=LX,t.BaseMark=vK,t.BaseSeries=pX,t.BoxPlotChart=w3,t.BoxPlotMark=Vq,t.BoxPlotSeries=Wq,t.Brush=t6,t.CORRELATION_SIZE=oV,t.CORRELATION_X=nV,t.CORRELATION_Y=rV,t.CartesianAxis=t5,t.CartesianBandAxis=l5,t.CartesianCrossHair=W4,t.CartesianLinearAxis=o5,t.CartesianLogAxis=d5,t.CartesianSeries=gX,t.CartesianSymlogAxis=p5,t.CartesianTimeAxis=c5,t.CellMark=G1,t.CirclePackingChart=y3,t.CirclePackingSeries=o1,t.CircularProgressChart=j2,t.CircularProgressSeries=lQ,t.CommonChart=T2,t.ComponentMark=X3,t.ComposedEventMapper=aY,t.ContinuousLegend=L5,t.CorrelationChart=F3,t.CorrelationSeries=r2,t.CustomMark=r6,t.DEFAULT_CHART_HEIGHT=kw,t.DEFAULT_CHART_WIDTH=xw,t.DEFAULT_CONICAL_GRADIENT_CONFIG=aG,t.DEFAULT_DATA_INDEX=sV,t.DEFAULT_DATA_KEY=lV,t.DEFAULT_DATA_SERIES_FIELD=uV,t.DEFAULT_GRADIENT_CONFIG=sG,t.DEFAULT_LABEL_ALIGN=Aw,t.DEFAULT_LABEL_LIMIT=Sw,t.DEFAULT_LABEL_TEXT=ww,t.DEFAULT_LABEL_VISIBLE=Tw,t.DEFAULT_LABEL_X=Mw,t.DEFAULT_LABEL_Y=Cw,t.DEFAULT_LAYOUT_RECT_LEVEL=0,t.DEFAULT_LAYOUT_RECT_LEVEL_MIN=-1,t.DEFAULT_LINEAR_GRADIENT_CONFIG=rG,t.DEFAULT_MEASURE_CANVAS_ID=aV,t.DEFAULT_RADIAL_GRADIENT_CONFIG=oG,t.DEFAULT_SERIES_STYLE_NAME=cV,t.DataZoom=q4,t.DimensionClickEvent=rY,t.DimensionHoverEvent=oY,t.DiscreteLegend=w5,t.DotSeries=qJ,t.Event=sY,t.Factory=FU,t.Funnel3dChart=e3,t.Funnel3dSeries=h0,t.FunnelChart=$2,t.FunnelSeries=a0,t.GaugeChart=V2,t.GaugePointerSeries=z1,t.GaugeSeries=N1,t.GeoCoordinate=bq,t.GradientType=nG,t.GridLayout=g6,t.GroupMark=yK,t.HeatmapChart=O3,t.HeatmapSeries=X1,t.Histogram3dChart=D2,t.HistogramChart=O2,t.Indicator=e8,t.Label=U8,t.Layout=lK,t.Layout3d=b6,t.LineChart=FX,t.LineMark=kX,t.LineSeries=CX,t.LinearProgressChart=r3,t.LinearProgressSeries=vQ,t.LinkPathMark=w1,t.LinkSeries=tQ,t.MapChart=s2,t.MapLabelComponent=v6,t.MapSeries=Sq,t.MarkArea=A8,t.MarkLine=b8,t.MarkPoint=q8,t.MediaQuery=VK,t.POLAR_DEFAULT_RADIUS=Nw,t.POLAR_END_ANGLE=Hw,t.POLAR_END_RADIAN=zw,t.POLAR_START_ANGLE=jw,t.POLAR_START_RADIAN=Fw,t.PREFIX=bw,t.PathMark=KZ,t.Pie3dChart=g2,t.Pie3dSeries=MJ,t.PieChart=p2,t.PieSeries=kJ,t.Player=P8,t.PolarAxis=g5,t.PolarBandAxis=b5,t.PolarCrossHair=Y4,t.PolarLinearAxis=m5,t.PolarSeries=lJ,t.PolygonMark=n0,t.ProgressArcMark=nQ,t.ProgressLikeSeries=iQ,t.Pyramid3dMark=l0,t.RadarChart=S2,t.RadarSeries=UJ,t.RangeAreaChart=P3,t.RangeAreaSeries=aJ,t.RangeColumn3dChart=c3,t.RangeColumn3dSeries=nJ,t.RangeColumnChart=s3,t.RangeColumnSeries=eJ,t.Rect3dMark=dZ,t.RectMark=nZ,t.RippleMark=t2,t.RoseChart=b2,t.RoseLikeSeries=IJ,t.RoseSeries=FJ,t.RuleMark=Rq,t.SEGMENT_FIELD_END=SV,t.SEGMENT_FIELD_START=kV,t.STACK_FIELD_END=pV,t.STACK_FIELD_END_OffsetSilhouette=mV,t.STACK_FIELD_END_PERCENT=yV,t.STACK_FIELD_START=fV,t.STACK_FIELD_START_OffsetSilhouette=gV,t.STACK_FIELD_START_PERCENT=vV,t.STACK_FIELD_TOTAL=_V,t.STACK_FIELD_TOTAL_PERCENT=bV,t.STACK_FIELD_TOTAL_TOP=xV,t.SankeyChart=C3,t.SankeySeries=M1,t.ScatterChart=EZ,t.ScatterSeries=TZ,t.ScrollBar=Q4,t.SequenceChart=E2,t.SunburstChart=f3,t.SunburstSeries=t1,t.SymbolMark=wX,t.TextMark=Yq,t.ThemeManager=mU,t.Title=k8,t.Tooltip=H4,t.TotalLabel=K8,t.TreemapChart=_3,t.TreemapSeries=O1,t.USER_LAYOUT_RECT_LEVEL=9,t.VChart=FK,t.WaterfallChart=k3,t.WaterfallDefaultSeriesField=iV,t.WaterfallSeries=Fq,t.WordCloud3dChart=q2,t.WordCloud3dSeries=H$,t.WordCloudChart=K2,t.WordCloudSeries=z$,t.builtinThemes=sU,t.computeActualDataScheme=qG,t.darkTheme=ZW,t.dataScheme=vW,t.default=FK,t.defaultThemeName=lU,t.getActualColor=QG,t.getColorSchemeBySeries=iW,t.getDataScheme=ZG,t.getMergedTheme=yU,t.getTheme=fU,t.hasThemeMerged=hU,t.isColorKey=$G,t.isProgressiveDataColorScheme=tW,t.lightTheme=XW,t.queryColorFromColorScheme=JG,t.registerAllEnv=function(){aR()},t.registerAreaChart=qX,t.registerAreaSeries=KX,t.registerBar3dChart=mZ,t.registerBar3dSeries=vZ,t.registerBarChart=hZ,t.registerBarSeries=lZ,t.registerBoxplotChart=T3,t.registerBoxplotSeries=Uq,t.registerBrowserEnv=LK,t.registerBrush=e6,t.registerCartesianBandAxis=u5,t.registerCartesianCrossHair=U4,t.registerCartesianLinearAxis=a5,t.registerCartesianLogAxis=f5,t.registerCartesianSymlogAxis=v5,t.registerCartesianTimeAxis=h5,t.registerChartPlugin=NK,t.registerCirclePackingChart=g3,t.registerCirclePackingSeries=a1,t.registerCircularProgressChart=H2,t.registerCircularProgressSeries=uQ,t.registerCommonChart=M2,t.registerContinuousLegend=O5,t.registerCorrelationChart=z3,t.registerCustomMark=o6,t.registerDataZoom=J4,t.registerDiscreteLegend=T5,t.registerDotSeries=JJ,t.registerFunnel3dChart=i3,t.registerFunnel3dSeries=d0,t.registerFunnelChart=t3,t.registerFunnelSeries=s0,t.registerGaugeChart=G2,t.registerGaugePointerSeries=j1,t.registerGaugeSeries=V1,t.registerGeoCoordinate=xq,t.registerGridLayout=_6,t.registerHeatmapChart=I3,t.registerHeatmapSeries=Z1,t.registerHistogram3dChart=F2,t.registerHistogramChart=I2,t.registerIndicator=i8,t.registerLabel=Y8,t.registerLarkEnv=function(){TC(_u)},t.registerLayout3d=x6,t.registerLineChart=zX,t.registerLineSeries=EX,t.registerLinearProgressChart=o3,t.registerLinearProgressSeries=yQ,t.registerLinkSeries=eQ,t.registerLynxEnv=function(){XC(_u)},t.registerMapChart=l2,t.registerMapLabel=y6,t.registerMapSeries=Aq,t.registerMarkArea=w8,t.registerMarkLine=x8,t.registerMarkPoint=J8,t.registerMediaQuery=function(){NK(VK)},t.registerNodeEnv=OK,t.registerPie3dChart=m2,t.registerPie3dSeries=CJ,t.registerPieChart=v2,t.registerPieSeries=SJ,t.registerPlayer=B8,t.registerPolarBandAxis=x5,t.registerPolarCrossHair=K4,t.registerPolarLinearAxis=_5,t.registerPoptip=k6,t.registerRadarChart=A2,t.registerRadarSeries=YJ,t.registerRangeAreaChart=B3,t.registerRangeAreaSeries=sJ,t.registerRangeColumn3dChart=h3,t.registerRangeColumn3dSeries=rJ,t.registerRangeColumnChart=l3,t.registerRangeColumnSeries=iJ,t.registerRoseChart=x2,t.registerRoseSeries=zJ,t.registerSankeyChart=E3,t.registerSankeySeries=C1,t.registerScatterChart=RZ,t.registerScatterSeries=MZ,t.registerScrollBar=$4,t.registerSequenceChart=R2,t.registerSunBurstSeries=e1,t.registerSunburstChart=p3,t.registerTaroEnv=function(){IE(_u)},t.registerTheme=dU,t.registerTitle=S8,t.registerTooltip=N4,t.registerTotalLabel=Z8,t.registerTreemapChart=b3,t.registerTreemapSeries=I1,t.registerWXEnv=function(){rR(_u)},t.registerWaterfallChart=S3,t.registerWaterfallSeries=zq,t.registerWordCloud3dChart=J2,t.registerWordCloud3dSeries=N$,t.registerWordCloudChart=X2,t.registerWordCloudSeries=j$,t.removeTheme=pU,t.seriesMarkInfoMap=UG,t.themeExist=vU,t.themes=uU,t.transformColorSchemeToStandardStruct=eW,t.version="1.8.11",t.vglobal=ux,Object.defineProperty(t,"__esModule",{value:!0})}));
